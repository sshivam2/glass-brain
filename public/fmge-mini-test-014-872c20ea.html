<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 014 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 13-year-old boy presents with injury to the medial epicondyle of the humerus. Which of the following is least likely to be seen?",
    "choices": [
      {
        "id": 1,
        "text": "Weakness of the ulnar deviation and flexion"
      },
      {
        "id": 2,
        "text": "Complete paralysis of the IIIrd and IVth digits"
      },
      {
        "id": 3,
        "text": "Atrophy of the hypothenar eminence"
      },
      {
        "id": 4,
        "text": "Decreased sensation of the hypothenar eminence"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Injury to the&nbsp;<strong>medial epicondyle</strong> injures the <strong>ulnar nerve</strong>. Since flexor digitorum superficialis (supplied by median nerve) and extensor digitorum (supplied by the radial nerve) are still functional, complete paralysis of the third and fourth digits is not seen.&nbsp;</p>\n<p>Injury to the <strong>medial epicondyle</strong> damages the<strong>&nbsp;ulnar nerve</strong>. This causes:</p>\n<ul>\n<li>Paralysis of:\n<ul>\n<li>Flexor carpi ulnaris (<strong>FCU</strong>) -&nbsp;loss of ulnar deviation&nbsp;</li>\n<li>Medial half of flexor digitorum profundus (FDP) -&nbsp;loss of distal interphalangeal joint flexion</li>\n<li><strong>Hypothenar</strong> paralysis&nbsp;- lead to atrophy</li>\n</ul>\n</li>\n<li>Sensory loss over medial 1/3 of hand and medial 1 1/2 fingers</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The hormone secreted by the\u00a0acidophil cells of the anterior pituitary apart from prolactin is ______",
    "choices": [
      {
        "id": 1,
        "text": "Glucagon"
      },
      {
        "id": 2,
        "text": "GH"
      },
      {
        "id": 3,
        "text": "Oxytocin"
      },
      {
        "id": 4,
        "text": "Insulin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>GH</strong>&nbsp;and <strong>prolactin</strong> are <strong>both secreted</strong> by the&nbsp;<strong>acidophil cells</strong> of the anterior pituitary. They act on cytokine receptors and show JAK-STAT activity, and hence are called <strong>twin hormones</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following molecular analysis methods is used to detect RNA?",
    "choices": [
      {
        "id": 1,
        "text": "Sanger's method"
      },
      {
        "id": 2,
        "text": "G banding"
      },
      {
        "id": 3,
        "text": "Western blot"
      },
      {
        "id": 4,
        "text": "RT-PCR"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>RT PCR&nbsp;</strong>(Reverse Transcriptase PCR) is a molecular analysis method used for the detection of&nbsp;<strong>RNA.&nbsp;</strong>It can be used to <strong>quantitate mRNA levels</strong>&nbsp;by generating complementary DNA <strong>(cDNA) copies</strong> of the mRNA using the <strong>reverse transcriptase</strong> enzyme.&nbsp;</p>\n<p><strong>The northern blot </strong>technique can also be used to detect <strong>RNAs.</strong>&nbsp;Here, the mixture of <strong>mRNA</strong> molecules is separated by electrophoresis and then transferred to a nitrocellulose membrane and hybridized with radiolabeled probes.<strong><br /> </strong></p>\n<p><strong>Sanger&rsquo;s technique:</strong></p>\n<ul>\n<li>This was the first technique used to determine the <strong>sequence of proteins.</strong></li>\n<li>Sanger&rsquo;s reagent is<strong> 1- Flouro 2,4 Dinitro benzene.</strong></li>\n<li>The first protein to be sequenced by this method was&nbsp;<strong>insulin.</strong></li>\n</ul>\n<p><strong>G banding (Giemsa banding):</strong></p>\n<p>It&nbsp;is the most common technique used in cytogenetics to produce a visible karyotype by staining condensed chromosomes. It is useful for <strong>identifying genetic diseases</strong> through the<strong> photographic representation</strong> of the entire chromosome complement. The <strong>metaphase chromosomes</strong> are treated with <strong>trypsin</strong> (to partially digest the chromosome) and stained with <strong>Giemsa stain</strong>.&nbsp;</p>\n<p><strong>Heterochromatic regions,</strong> which tend to be rich with adenine and thymine <strong>(AT-rich)</strong> DNA and relatively gene-poor, stain darker and appear as <strong>d</strong><strong>ark bands</strong> in G-banding. In contrast, <strong>less condensed chromatin,&nbsp;</strong>which tends to be rich with guanine and cytosine <strong>(GC-rich)</strong> and more transcriptionally active incorporates less Giemsa stain, and these regions appear as <strong>light bands</strong> in G-banding.&nbsp;The image below shows a G-banding karyogram of a normal human male.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/171f4fe6637e4718ab94ab027de0a8bbx572x449.PNG"
    ]
  },
  {
    "text": "Arrange the following cellular events of inflammation in the correct sequence:",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3, 4"
      },
      {
        "id": 2,
        "text": "2, 1, 4, 3"
      },
      {
        "id": 3,
        "text": "4, 1, 2, 3"
      },
      {
        "id": 4,
        "text": "3, 4, 1, 2"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct sequence of cellular events that occur during inflammation is:</p>\n<ul>\n<li>Rolling</li>\n<li>Cytokine mediated integrin activation</li>\n<li>Adhesion</li>\n<li>Migration</li>\n</ul>\n<p>The recruitment of leukocytes to the site of inflammation is a multi-step process, that is mediated by adhesion molecules and cytokines called chemokines. This process can be divided into sequential phases:</p>\n<ol style=\"list-style-type: lower-roman;\">\n<li>In the lumen: <strong>margination</strong>, <strong>rolling</strong> and <strong>adhesion</strong> to the endothelium occurs.</li>\n<li><strong>Migration</strong> of the leukocytes across the endothelium and vessel wall</li>\n<li><strong>Migration</strong> in the tissues towards a chemotactic stimulus.</li>\n</ol>\n<p>The process of leukocyte recruitment is as follows:</p>\n<ul>\n<li><strong>Margination</strong>: Because of dilation of the inflamed postcapillary venues, there is stasis of blood flow and hence more leukocytes assume a peripheral position along the endothelial surface; this process of leukocyte redistribution is called margination.</li>\n<li><strong>Rolling</strong>: the slowed leukocytes then sense the signals from the endothelium and start rolling on the vessel wall.</li>\n<li><strong>Cytokine-mediated integrin activation</strong>: the attachment of leukocytes to the endothelial cells requires adhesion molecules that are activated by cytokines. The major families of proteins involved in adhesion and migration are <strong>selectins</strong> and <strong>integrins</strong> and their ligands.</li>\n<li><strong>Adhesions</strong>: the weak rolling interactions slow down the leukocytes and allow them to bind more firmly to the endothelium. <strong>Chemokines</strong> that were produced at the site of injury bind to the endothelial cell proteoglycans. These chemokines then bind to the rolling leukocytes and activate them. This is turn converts the ligands for&nbsp;&beta;1 and&nbsp;&beta;2 integrins, <strong>VLA-4</strong> and <strong>LFA-1 </strong>present on the leukocytes to a <strong>high-affinity state</strong>.</li>\n<li>This combination of cytokine-induced expression of integrin ligands on the endothelium and increased integrin affinity on the leukocytes leads to firm <strong>adhesion</strong> of leukocytes to the endothelium at the site of inflammation.</li>\n<li><strong>Leukocyte migration</strong>: this is the movement of leukocytes through intact endothelium, called transmigration or diapedesis. This occurs in postcapillary venules. This migration occurs through the inter endothelial gap towards the chemical concentration gradient created by the chemokines at the site of injury. This occurs with the help of adhesion molecules present in the intercellular junctions such as&nbsp;<strong>Platelet Endothelial Cell Adhesion Molecule</strong> (<strong>PECAM-1</strong>) or <strong>CD31</strong>.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6879d8edb739418f87417f5d33e373ddx1280x2359.JPEG"
    ]
  },
  {
    "text": "What is the method of choice for the diagnosis of kala-azar?",
    "choices": [
      {
        "id": 1,
        "text": "Rapid dipstick test"
      },
      {
        "id": 2,
        "text": "Aldehyde test of Napier"
      },
      {
        "id": 3,
        "text": "ELISA"
      },
      {
        "id": 4,
        "text": "Indirect fluorescent antibody test"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> rapid dipstick test&nbsp;</strong>is the method of choice for the diagnosis of <strong>kala</strong>-<strong>azar</strong>.</p>\n<p>The following tests are used for the laboratory diagnosis of kala-azar:</p>\n<ul>\n<li>Rapid diagnostic tests&nbsp;<strong>-</strong>&nbsp;<strong>rK39</strong>&nbsp;and dipstick test strip.</li>\n<li>Parasitological diagnosis - demonstration of <strong>LD bodies&nbsp;</strong>on microscopy is confirmatory</li>\n<li>Surveillance purposes - <strong>Aldehyde test of Napier</strong></li>\n<li>Serological diagnosis - Rapid dipstick test, direct agglutination test, ELISA, indirect fluorescent antibody test</li>\n<li>Assessing immune status - <strong>Leishmanin </strong>(Montenegro)<strong> test</strong>&nbsp;\n<ul>\n<li>Induration of &ge; 5 mm is considered positive</li>\n<li>Usually becomes positive 4-6 weeks after onset of cutaneous leishmaniasis</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old man admitted with ischemic stroke was given IV alteplase. After 8 hours, the ICU staff noticed decreasing mental status and acute hypertension in the patient. A repeat CT revealed the following, Which of the following drugs can be used to manage this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Protamine"
      },
      {
        "id": 2,
        "text": "Streptokinase"
      },
      {
        "id": 3,
        "text": "Heparin"
      },
      {
        "id": 4,
        "text": "\u03b5-Aminocaproic acid"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>post-thrombolytic hemorrhagic transformation</strong> of an ischemic stroke. <strong>&epsilon;-Aminocaproic acid</strong> can be used as an antidote for fibrinolytic therapy.</p>\n<p>It is a lysine analog that binds competitively to plasminogen, blocking plasminogen from binding to fibrin and the subsequent conversion to plasmin. This activity subsequently results in the <strong>inhibition of fibrinolysis.</strong></p>\n<p>It should not be given unless hemorrhage is life-threatening because it inhibits intrinsic fibrinolytic activity and <strong>can precipitate DIC.</strong>&nbsp;Fresh frozen plasma and cryoprecipitate may also be used to replenish fibrin and clotting factors.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5c7fd81e8e4d4a72aeb106de75ea4436.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/114b5293e3404eddbd69d440272edb0ex1280x1988.JPEG"
    ]
  },
  {
    "text": "During the clinical examination of a 33-year-old patient, you notice the following finding shown in the image. This is characteristic of :",
    "choices": [
      {
        "id": 1,
        "text": "Thallium poisoning"
      },
      {
        "id": 2,
        "text": "Arsenic poisoning"
      },
      {
        "id": 3,
        "text": "Lead poisoning"
      },
      {
        "id": 4,
        "text": "Manganese poisoning"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows <strong>Burtonian lines, seen in lead poisoning.&nbsp;</strong>With long term-exposure, patients of <strong>lead poisoning</strong> can develop bluish-gray gingival lead lines (called Burtonian lines).</p>\n<p>Burtonian lines can also be seen in <strong>mercury poisoning.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0b91437923c34ab398bc36efeb12bee8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 52-year-old woman presents to the ENT surgeon with a history of vertigo whenever she moves sideways on the bed while lying supine. She feels nauseous and as if the room is spinning. The symptoms subside after a few minutes but return when she moves her head. Which of the following tests is most appropriate to diagnose this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Dix-Hallpike\u2019s manoeuvre"
      },
      {
        "id": 2,
        "text": "Glycerol test"
      },
      {
        "id": 3,
        "text": "Caloric test"
      },
      {
        "id": 4,
        "text": "Epley\u2019s manoeuvre"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of <strong>benign paroxysmal positional vertigo</strong> (BPPV). The <strong>diagnostic</strong> maneuver used in BPPV is the <strong>Dix-Hallpike maneuver</strong>, the <strong>gold standard</strong> for diagnosing BPPV. The <strong>therapeutic</strong> maneuver is<strong> Epley's maneuver</strong>.</p>\n<p>BPPV is one of the common causes of <strong>recurrent vertigo</strong>, and the episodes are brief (&lt;1min) and are always <strong>provoked</strong> by <strong>changes</strong> in <strong>head position.</strong> The attacks are caused by free-floating calcium carbonate crystals usually dislodged from the posterior canal.</p>\n<p>A patient presenting with vertigo should be evaluated for ruling out the central lesions (like a tumor in the fourth ventricle, multiple sclerosis, etc) before confirming the diagnosis of BPPV. <strong>Dix-Hallpike maneuver</strong> helps <strong>rule out central lesions</strong> and also <strong>diagnose BPPV.</strong></p>\n<p><strong>Dix-Hallpike maneuver</strong>:</p>\n<ol>\n<li>The maneuver starts with the patient in a sitting position.</li>\n<li>Their head is turned 45 degrees towards the ear to be tested.</li>\n<li>The examiner quickly brings the patient to a supine position with their head 30 degrees below the horizontal.</li>\n<li>The 45-degree head rotation is maintained during the procedure.</li>\n<li>Now the examiner observes the patient for nystagmus.</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ff2597eeabe84b6a8a78d2048a416872x1280x2095.JPEG"
    ]
  },
  {
    "text": "Oil droplet cataract is seen in ______________.",
    "choices": [
      {
        "id": 1,
        "text": "Diabetes"
      },
      {
        "id": 2,
        "text": "Galactosemia"
      },
      {
        "id": 3,
        "text": "Wilson\u2019s disease"
      },
      {
        "id": 4,
        "text": "Homocystinuria"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Oil droplet cataract is</strong> seen in <strong>galactosemia</strong>.</p>\n<p><strong>Other options</strong>:</p>\n<ul>\n<li>Diabetes: Snow-flake cataract</li>\n<li>Wilson&rsquo;s disease: Sunflower cataract</li>\n<li>Homocystinuria: Bilateral inferonasal subluxation of the lens</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All the following are notifiable occupational diseases under the Factories act except ____________.",
    "choices": [
      {
        "id": 1,
        "text": "Asbestosis"
      },
      {
        "id": 2,
        "text": "Bagassossis"
      },
      {
        "id": 3,
        "text": "Noise induced hearing loss"
      },
      {
        "id": 4,
        "text": "Silicosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Bagassosis</strong> is <strong>not</strong> a notifiable disease.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a population of 5000, new cases of TB are 500 and old cases are 150. What is the prevalence of TB in this case?",
    "choices": [
      {
        "id": 1,
        "text": "13%"
      },
      {
        "id": 2,
        "text": "9%"
      },
      {
        "id": 3,
        "text": "18%"
      },
      {
        "id": 4,
        "text": "12%"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The prevalence of TB is <strong>13%</strong>.</p>\n<p>The calculation is as follows:</p>\n<ol>\n<li>The <strong>total number of cases</strong> at the given time is 500 new cases + 150 old cases, which equals <strong>650 </strong></li>\n<li>The <strong>total number of cases</strong> is <strong>divided by the total population </strong>which is <strong>5000\u00a0</strong></li>\n<li>The percentage is calculated by <strong>multiplying with 100</strong></li>\n</ol>\n<p>Thus, prevalence is the <strong>proportion of all cases</strong>, old and new, of a particular disease at a given point in time or over a period of time in a given population.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2f1d22e1b2fb43fa94518459d945bb4bx520x80.JPEG"
    ]
  },
  {
    "text": "A newly diagnosed HIV patient presented with fever, cough, and hemoptysis. His sputum sample showed acid-fast bacilli. What is the appropriate management for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Start ART if CD4<200"
      },
      {
        "id": 2,
        "text": "Start ART and then ATT after 2 weeks"
      },
      {
        "id": 3,
        "text": "Start ATT and then ART after 2 weeks"
      },
      {
        "id": 4,
        "text": "Start ATT and ART simultaneously"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In a patient with HIV and TB <strong>start</strong> <strong>ATT first</strong> and <strong>then start ART</strong> as soon as ATT is tolerated (between <strong>2 weeks</strong> and 2 months) by the patient. This is done in order to avoid immune reconstitution inflammatory syndrome&nbsp;<strong>(IRIS)</strong>.&nbsp;</p>\n<p><strong>Immune Reconstitution Inflammatory Syndrome</strong> <strong>(IRIS):</strong></p>\n<p>Patients with HIV-related TB may experience a temporary <strong>paradoxical exacerbation</strong> of symptoms and radiographic manifestations of TB after starting ATT. This occurs as a result of <strong>immune reconstitution</strong> due to <strong>simultaneous</strong> administration of <strong>ART and ATT</strong>.</p>\n<p>It is characterized by high fever, lymphadenopathy, expanding intra-thoracic lesions, and worsening of chest x-ray findings. Diagnosis should be made only after ruling out treatment failure and other infections. For severe cases, <strong>prednisone</strong> 1-2mg/kg is used for 1-2 weeks and then gradually tapered.</p>\n<p>However, in patients with <strong>CD4 &lt;50/&mu;L,</strong> the benefits of administering ART immediately after initiating ATT outweigh the risks of IRIS, and therefore <strong>ART</strong> should be <strong>started</strong> as<strong> early </strong>as possible.</p>\n<p>Note: As per RNTCP guidelines, <strong>CBNAAT</strong> is the <strong>preferred</strong> diagnostic technique for testing <strong>TB in PLHIV&nbsp;</strong>(people living with HIV). Smear microscopy has poor sensitivity in detecting TB in PLHIV due to fewer organisms in sputum, and hence is not preferred.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following is not a risk factor for severe illness in a patient with COVID-19?",
    "choices": [
      {
        "id": 1,
        "text": "Smoking"
      },
      {
        "id": 2,
        "text": "Chronic kidney disease"
      },
      {
        "id": 3,
        "text": "Cardiovascular disease"
      },
      {
        "id": 4,
        "text": "Young age"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Young age</strong> is not a risk factor for severe illness in a patient with COVID-19.</p>\n<p>Although severe illness can occur in otherwise healthy individuals of any age, it predominantly occurs in adults with advanced age or underlying medical comorbidities. The comorbidities associated with severe illness and mortality include:</p>\n<ul>\n<li>Cardiovascular disease</li>\n<li style=\"font-weight: 400;\">Diabetes mellitus</li>\n<li style=\"font-weight: 400;\">Hypertension</li>\n<li style=\"font-weight: 400;\">Chronic lung disease</li>\n<li style=\"font-weight: 400;\">Cancer</li>\n<li style=\"font-weight: 400;\">Chronic kidney disease</li>\n<li style=\"font-weight: 400;\">Obesity (body mass index &ge;30)</li>\n<li style=\"font-weight: 400;\">Smoking</li>\n</ul>\n<p>Immunosuppression is also presumed to be a risk factor for severe illness and mortality, but this has not yet been definitively demonstrated in studies.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which type of aphasia is seen in the lesions of the posterior part of the superior temporal gyrus?",
    "choices": [
      {
        "id": 1,
        "text": "Wernicke's"
      },
      {
        "id": 2,
        "text": "Broca's"
      },
      {
        "id": 3,
        "text": "Anomic"
      },
      {
        "id": 4,
        "text": "Conduction"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Wernicke's aphasia</strong> is seen in the lesions of the <strong>posterior part of the superior temporal gyrus</strong> due to the involvement of the <strong>Wernicke's area</strong>. The speech is full of jargon and neologisms that make little sense.</p>\n<p><strong>Other options:&nbsp;</strong></p>\n<p>Option B- <strong>Broca's or motor/non-fluent aphasia</strong> is seen in lesions of the <strong>inferior frontal gyrus</strong> which contains the motor speech area. Speech is non-fluent and interrupted, with a paucity of functional words.</p>\n<p>Option C- Comprehension of written language and the ability to name objects are compromised in <strong>anomic aphasia</strong>. This aphasia is caused by damage to the <strong>angular gyrus</strong> that disrupts visual information processing and transmission to the Wernicke area.</p>\n<p>Option D- <strong>Conduction aphasia</strong> is seen in lesions of the <strong>arcuate fasciculus</strong>, the bundle of nerve fibers connecting the Wernicke and Broca's areas. Repetition of words is impaired and paraphasias are observed, though not as much as in Wernicke aphasia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Gold standard diagnostic test in varicose vein is ______",
    "choices": [
      {
        "id": 1,
        "text": "Photoplethysmography"
      },
      {
        "id": 2,
        "text": "Duplex ultrasound imaging"
      },
      {
        "id": 3,
        "text": "Ultrasonography"
      },
      {
        "id": 4,
        "text": "Radiolabeled fibrinogen study"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Gold standard test</strong> for varicose veins is <strong>duplex ultrasound.</strong></p>\n<p>The aim of the duplex scan in patients with varicose veins is to establish:</p>\n<ul>\n<li>Which saphenous junctions are incompetent and their locations.</li>\n<li>Extent of reflux in the saphenous veins and their diameters.</li>\n<li>Number, location, and diameter of incompetent perforating veins; other relevant veins that demonstrate reflux.</li>\n<li>Source of all superficial varices if not from the veins already described.</li>\n<li>Competence and evidence of previous venous thrombosis in the deep venous system.</li>\n</ul>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">&nbsp;</p>\n<p><strong>Mickey Mouse sign</strong>&nbsp;is seen in transverse B mode image doppler ultrasound formed by:</p>\n<ul>\n<li>Common Femoral Vein (CFV)</li>\n<li>Common Femoral Artery (CFA)</li>\n<li>Greater Saphenous Vein (GSV) at the Saphenofemoral junction (SFJ).</li>\n</ul>\n<p>It&nbsp;represents the normal anatomy of the femoral vessels as seen in duplex ultrasound.&nbsp;</p>\n</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\"><img class=\"ng-scope\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/58bf22ae0133440ca616c4ee3b8c4194x630x517.JPEG\" width=\"313\" height=\"257\" /></div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a component of the Revised Trauma Score ?",
    "choices": [
      {
        "id": 1,
        "text": "Glasgow coma scale"
      },
      {
        "id": 2,
        "text": "Systolic BP"
      },
      {
        "id": 3,
        "text": "Respiratory rate"
      },
      {
        "id": 4,
        "text": "Pulse rate"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Pulse rate is not a component of Revised Trauma Score.</p>\n<p>Glasgow coma scale, Respiratory rate and Systolic BP are components of Revised Trauma Score (0-12).</p>\n<p>Various scoring systems are used to score the trauma are :</p>\n<ul>\n<li><strong>AIS</strong> \u2013 Abbreviated Injury Scale</li>\n<li><strong>ISS </strong>\u2013 Injury Severity Score</li>\n<li><strong>OIS </strong>\u2013 Organ Injury Scale</li>\n<li><strong>GCS </strong>\u2013 Glasgow Coma Scale</li>\n<li><strong>RTS </strong>\u2013 Revised Trauma Score</li>\n<li><strong>MESS</strong> \u2013 Mangled Extremity Severity Score</li>\n<li><strong>TRISS \u2013</strong> Trauma and Injury Severity Score</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During a cricket match, a batsman controls his urge to urinate as he is unable to take a break in-between. While batting, he suffers a sudden blow as the ball hits him in the suprapubic region. He presents to the emergency department with severe hypogastric pain and the inability to pass urine. He collapses suddenly during the examination. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Intraperitoneal rupture of the bladder"
      },
      {
        "id": 2,
        "text": "Extraperitoneal rupture of the bladder"
      },
      {
        "id": 3,
        "text": "Membranous urethra rupture"
      },
      {
        "id": 4,
        "text": "Pubic diastasis with bulbar urethra rupture"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario with a history of <strong>injury to a full bladder</strong>, inability to pass urine, and <strong>syncope</strong> are suggestive of <strong>intraperitoneal rupture of the bladder</strong>.</p>\n<p><strong>Bladder rupture\u00a0</strong>can be of two types:</p>\n<table style=\"width: 865.953px;\">\n<tbody>\n<tr>\n<td style=\"width: 105px;\">\u00a0</td>\n<td style=\"width: 204px;\"><strong>Extraperitoneal rupture</strong></td>\n<td style=\"width: 233.953px;\"><strong>Intraperitoneal rupture</strong></td>\n</tr>\n<tr>\n<td style=\"width: 105px;\">\u00a0</td>\n<td style=\"width: 204px;\"><strong>More common\u00a0</strong>(80%)</td>\n<td style=\"width: 233.953px;\">\u00a0Less common (20%)</td>\n</tr>\n<tr>\n<td style=\"width: 105px;\">Cause</td>\n<td style=\"width: 204px;\">\n<ul>\n<li>Penetrating trauma</li>\n<li>Pelvic fracture</li>\n<li>Surgical damage</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Associated with <strong>proximal urethral injury</strong></li>\n</ul>\n</td>\n<td style=\"width: 233.953px;\">\u00a0\n<ul>\n<li>Direct blow or fall on a\u00a0<strong>distended bladder</strong></li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 105px;\">Clinical features</td>\n<td style=\"width: 204px;\">\n<ul>\n<li><strong>Pelvic urinoma</strong> (encapsulated collection of extravasated urine) is seen</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Blood at the tip of the meatus</li>\n</ul>\n</td>\n<td style=\"width: 233.953px;\">\n<ul>\n<li>Sudden severe pain in the hypogastrium</li>\n<li><strong>Syncope</strong></li>\n<li>Peritonitis</li>\n</ul>\n\u00a0</td>\n</tr>\n<tr>\n<td style=\"width: 105px;\">Treatment</td>\n<td style=\"width: 204px;\">\n<ul>\n<li>Catheter drainage for 7\u201310 days</li>\n</ul>\n</td>\n<td style=\"width: 233.953px;\">\n<ul>\n<li>Laparotomy</li>\n<li>Repair of bladder</li>\n<li>Bladder drainage</li>\n</ul>\n\u00a0</td>\n</tr>\n</tbody>\n</table>\n<p><strong><br />Pubic diastasis</strong> refers to the <strong>separation of the pubic symphysis</strong> without concomitant fracture. Pubic diastasis with <strong>bulbar urethra rupture</strong> usually occurs due to <strong>straddle injury</strong> and presents with <strong>blood at the tip of the meatus</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "According to IADPSG, what is the cut-off value of fasting blood glucose for the diagnosis of gestational diabetes mellitus?",
    "choices": [
      {
        "id": 1,
        "text": ">92 mg/dl"
      },
      {
        "id": 2,
        "text": ">95 mg/dl"
      },
      {
        "id": 3,
        "text": ">106 mg/dl"
      },
      {
        "id": 4,
        "text": ">90 mg/dl"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>According to IADPSG, the cut-off value of fasting blood glucose for the diagnosis of gestational diabetes mellitus (GDM) is&nbsp;<strong>&gt;92 mg/dl.</strong></p>\n<p>Gestational Diabetes Mellitus (GDM) refers to any degree of glucose intolerance having its onset or first recognition during pregnancy.&nbsp;</p>\n<p>For IADPSG criteria, an oral glucose tolerance test (OGTT) is done in the fasting state using <strong>75 g of glucose,</strong>&nbsp;and gestational diabetes&nbsp;mellitus (GDM) is diagnosed if any one of the following cut-offs is met i.e.</p>\n<ul>\n<li><strong>Fasting: &gt;92 mg/dl&nbsp;</strong></li>\n<li>1 hour: &gt;180 mg/dl&nbsp;&nbsp;</li>\n<li>2 hour: &gt;153 mg/dl</li>\n</ul>\n<p><strong>Earlier, a two-step approach</strong>&nbsp;was being used to diagnose GDM. In this, the first step (screening) is a <strong>50-gram</strong> one-hour glucose challenge test (GCT). The patients having a positive result of &gt;140mg/dl, are candidates for the OGTT. A&nbsp;<strong>100-gram</strong>, three-hour&nbsp;<strong>oral glucose tolerance test</strong>&nbsp;(GTT), is the&nbsp;<strong>diagnostic test</strong>&nbsp;for gestational diabetes mellitus. GDM is diagnosed if two or more values are positive.</p>\n<p>Diabetes in Pregnancy Societies of India(DIPSI)&nbsp;<span style=\"font-size: 14px;\">recommends a 1-step procedure</span><span style=\"font-size: 14px;\">&nbsp;with <strong>75 g oral glucose</strong> <strong>without regard to the time of the last meal</strong>. A venous plasma glucose value at <strong>2 hours &gt;140 mg/dL</strong> is diagnosed as GDM.</span></p>\n<p>Some complications of GDM include:</p>\n<ul>\n<li>Maternal\n<ul>\n<li>Hypertension, preeclampsia</li>\n<li>Hydramnios</li>\n<li>Increased operative interventions</li>\n<li>Future development of diabetes mellitus</li>\n</ul>\n</li>\n<li>Fetal and neonatal\n<ul>\n<li>Fetal macrosomia</li>\n<li>Congenital anomalies</li>\n<li>Metabolic abnormalities such as hypocalcemia, hypomagnesemia, hyperbilirubinemia, and neonatal hypoglycemia.</li>\n<li>Respiratory distress syndrome</li>\n<li>Subsequent childhood and adolescent obesity</li>\n</ul>\n</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the most common cause of rectovaginal fistula?",
    "choices": [
      {
        "id": 1,
        "text": "Improper suturing of perineal tears"
      },
      {
        "id": 2,
        "text": "Tuberculosis of the anus"
      },
      {
        "id": 3,
        "text": "Carcinoma cervix"
      },
      {
        "id": 4,
        "text": "Radiotherapy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Improper suturing</strong> of complete perineal tears is the most common cause of <strong>rectovaginal fistula.</strong></p>\n<p>Rectovaginal fistulas occur most commonly due to&nbsp;<strong>obstetric causes</strong>&nbsp;such as perineal tears, obstructed labor, and instrumental deliveries. Other causes include:</p>\n<ul>\n<li><strong>Tuberculosis</strong></li>\n<li>Lymphogranuloma venerum</li>\n<li>Bartholinitis - rupture of an abscess into the rectum can cause a fistula</li>\n<li>Diverticulitis&nbsp;</li>\n<li><strong>Carcinoma cervix</strong></li>\n<li><strong>Radiotherapy</strong> - can cause ulceration which can develop into a fistula</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The risk of cancer that can be reduced with OCP use are all, except?",
    "choices": [
      {
        "id": 1,
        "text": "Ovary Cancer"
      },
      {
        "id": 2,
        "text": "Breast Cancer"
      },
      {
        "id": 3,
        "text": "Colorectal Cancer"
      },
      {
        "id": 4,
        "text": "Endometrial Cancer"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Oral contraceptive pills (<strong>OCP</strong>) are <strong>not protective</strong> against <strong>breast cancer</strong>.</p>\n<p>OCPs have no effect on the incidence of Breast Cancer.</p>\n<p><strong>OCPs </strong>protect against <strong>ovarian cancer (Option A)</strong>. Oral contraceptives cause prolonged suppression of gonadotropin stimulation of ovary on long term use. This may account for<strong> lower</strong> <strong>incidence</strong> of <strong>ovarian malignancy</strong> noted in contraceptive users.</p>\n<p>Other benefits of oral contraceptive pills:</p>\n<ul>\n<li><strong>Lesser</strong> incidence of<strong> endometrial carcinoma</strong> due to progestin component in OCP <strong>(Option D)</strong>.</li>\n<li><strong>Regularisation</strong> of <strong>menstrual cycles</strong> results in relief of dysmenorrhea and menorrhagia.</li>\n<li>Reduced incidence and relief of fibrocystic breast disease and ovarian cysts.</li>\n<li>Endometriosis and pelvic inflammatory disease are improved.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A karyotyping image is given below. What are the clinical features most likely to be expected in such patients?",
    "choices": [
      {
        "id": 1,
        "text": "Gynecomastia and long limbs"
      },
      {
        "id": 2,
        "text": "Flat occiput"
      },
      {
        "id": 3,
        "text": "Webbing of neck and lymphedema"
      },
      {
        "id": 4,
        "text": "Short stature and polydactyly"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given karyotyping image shows \u2018<strong>47,\u00a0</strong><strong>XXY</strong>\u2019 abnormality, which is seen in <strong>Klinefelter\u2019s</strong> <strong>syndrome</strong>. <strong>Gynecomastia</strong> and <strong>long limbs</strong> are seen in Klinefelter's syndrome.</p>\n<p>Other clinical features seen in Klinefelter\u2019s syndrome are:\u00a0</p>\n<ul>\n<li>Disproportionately <strong>long arms and legs</strong>,</li>\n<li><strong>Gynecomastia</strong></li>\n<li>Eunuchoid body habitus</li>\n<li>Mitral valve prolapse</li>\n<li>Mental retardation; <strong>IQ: 60-80</strong>,</li>\n<li>Minor developmental and learning disabilities,</li>\n<li>Lack of secondary sexual characteristics (due to a\u00a0decrease in androgen production)</li>\n<li>Higher risk of breast carcinoma</li>\n<li>Testicular dysgenesis with small penis</li>\n<li>Infertility/azoospermia</li>\n<li>Type 2 diabetes mellitus</li>\n<li>Metabolic syndrome</li>\n<li>Higher risk of extragonadal germ cell tumors</li>\n</ul>\n<p>Klinefelter syndrome:</p>\n<ul>\n<li>Most common sex aneuploidy in males</li>\n<li>Classically karyotype is <strong>47, XXY</strong>. Other variants can have <strong>48 XXXY; rarely, 49 XXXXY;</strong>\u00a0or mosaics with some cells containing normal 46, XY and others 47, XXY</li>\n<li>Results from <strong>meiotic nondisjunction</strong> of sex chromosomes (mostly during 1<sup>st</sup> meiotic division)</li>\n</ul>\n<p><strong>Note</strong>:</p>\n<p>A variant of Klinefelter\u2019s syndrome\u2014<strong>49, XXXXY</strong>\u2014presents with <strong>short stature</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b1427dc7df8e47fcb9034701df66ac46.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4fc0eccac7584880a6a8c763a4419085x720x511.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/59e815279c4c46d0bd0d19a8d0b2eebax268x469.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/12f5b541fb8841149505616a9c0608f5x720x603.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9b402d5b2c0044878106afd9044b166dx720x1531.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/904a6b59370f41059059971e6a4d70b0x720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f347e51387ed48dcb3fdc6341aa774cax720x844.JPEG"
    ]
  },
  {
    "text": "Which of the following is not a radiological finding of left heart failure?",
    "choices": [
      {
        "id": 1,
        "text": "Kerley b lines"
      },
      {
        "id": 2,
        "text": "Focal oligemia"
      },
      {
        "id": 3,
        "text": "Increased venous blood in lung"
      },
      {
        "id": 4,
        "text": "change in upper lobe circulation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Focal oligemia</strong> is not a radiological feature of left heart failure. Also known as <strong>Westermark's sign, </strong>it&nbsp;is seen in<strong> pulmonary embolism.</strong></p>\n<p><strong>Radiological signs of left heart failure include :</strong></p>\n<ul>\n<li>Cardiomegaly - enlargement of the cardiac silhouette</li>\n<li>Kerley B lines - horizontal lines in the periphery of the lower posterior lung fields</li>\n<li>upper lobe pulmonary venous congestion&nbsp;</li>\n<li>interstitial edema.</li>\n</ul>\n<div class=\"page\" title=\"Page 1958\">&nbsp;</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 28-year-old woman presents with mood lability, sadness, and tearfulness 5 days after delivery. She has no thoughts of harming the baby. There is no history of previous mood disorders. There is no family history of mood disorders. What is the preferred treatment for her?",
    "choices": [
      {
        "id": 1,
        "text": "Supportive treatment"
      },
      {
        "id": 2,
        "text": "Fluoxetine"
      },
      {
        "id": 3,
        "text": "Atypical antipsychotics"
      },
      {
        "id": 4,
        "text": "CBT and SSRIs"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical features are suggestive of <strong>postpartum blues</strong> and the preferred treatment is <strong>supportive therapy.</strong></p>\n<p>Mild depressive symptoms after a few days of delivery which resolve spontaneously are characteristic of <strong>postpartum blues</strong>.</p>\n<p class=\"p1\">During this period the patient may experience mood lability, sadness, dysphoria, subjective confusion, and tearfulness. These feelings have been ascribed to rapid changes in women's hormonal levels, the stress of childbirth, and the awareness of the increased responsibility that motherhood brings. This usually resolves spontaneously.\u00a0</p>\n<p class=\"p1\">If the symptoms persist <strong>longer than two weeks</strong>, evaluation is indicated for <strong>postpartum depression.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the drug of choice for rescue analgesia?",
    "choices": [
      {
        "id": 1,
        "text": "Morphine"
      },
      {
        "id": 2,
        "text": "Codeine"
      },
      {
        "id": 3,
        "text": "Oxycodone"
      },
      {
        "id": 4,
        "text": "Fentanyl"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Fentanyl</strong> is the drug of choice for providing <strong>rescue</strong> <strong>analgesia</strong>.</p>\n<p>Rescue analgesia involves the use of medications to minimize post-operative pain. Mild pain can be controlled with oral analgesics but severe pain requires opioids like fentanyl.</p>\n<p>Fentanyl is preferred over morphine or oxycodone due to its rapid onset of action, lesser incidence of postoperative nausea, vomiting, and other adverse effects.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Extracorporeal photopheresis is used in the management of which of the following malignancies?",
    "choices": [
      {
        "id": 1,
        "text": "Squamous cell carcinoma"
      },
      {
        "id": 2,
        "text": "Mycoses fungoides"
      },
      {
        "id": 3,
        "text": "Melanoma"
      },
      {
        "id": 4,
        "text": "Keratoacantoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Extracorporeal photopheresis</strong> is a <strong>systemic therapy</strong>&nbsp; used for mycosis fungoides.</p>\n<ul>\n<li>The choice of initial treatment for the Mycosis fungoides patient will depend on the stage of the disease as well as the patient&rsquo;s performance status.</li>\n<li><strong>Skin-Directed Therapy</strong> is preferred in the <strong>early stages</strong> whereas advanced stages requires systemic therapy.</li>\n</ul>\n<p>The various treatment modalities available for treatment of Mycosis fungoides is given below.</p>\n<table style=\"width: 460px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 196.747px; text-align: center;\"><strong>Skin-Directed Therapy</strong></td>\n<td style=\"width: 249.253px; text-align: center;\"><strong>Systemic Therapy</strong></td>\n</tr>\n<tr>\n<td style=\"width: 196.747px;\">\n<ul>\n<li>Topical Corticosteroids</li>\n<li>Topical Chemotherapy:&nbsp;nitrogen mustard (mechlorethamine) and carmustine (BCNU)</li>\n<li>Topical rexinoids</li>\n<li>Phototherapy and photochemotherapy (PUVA)</li>\n<li>Radiotherapy and electron beam therapy (Mycosis fungoides and variants are highly radiosensitive)</li>\n</ul>\n</td>\n<td style=\"width: 249.253px;\">\n<ul>\n<li>Immunotherapy:&nbsp;Pegylated IFN\u2010&alpha;</li>\n<li>Oral&nbsp;Retinoids and rexinoids</li>\n<li>Combination therapy</li>\n<li>Systemic chemotherapy</li>\n<li>Extracorporeal photopheresis (ECP)</li>\n<li>Toxin therapies:&nbsp;Denileukin diftitox</li>\n<li>Monoclonal antibody therapy</li>\n<li>Histone deacetylase inhibitors</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is not true about the device shown in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Smaller ones are given to PHCs and the larger ones to district vaccine stores"
      },
      {
        "id": 2,
        "text": "They have temperature zones for different vaccines"
      },
      {
        "id": 3,
        "text": "Kata thermometer is used to record temperature inside this device"
      },
      {
        "id": 4,
        "text": "These devices are provided with baskets to store vaccines"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shown in the question is of an<strong>\u00a0ice-lined refrigerator</strong> (ILR).\u00a0<strong>Dial</strong> or digital <strong>thermometers</strong> are used to <strong>record temperatures</strong> inside an ice-lined refrigerator.</p>\n<p>ILRs are the main method of <strong>vaccine storage</strong> in <strong>primary health centers</strong>. They are an important part of the cold chain and they maintain a temperature of <strong>2 to 8 \u00b0C</strong> for the storage of vaccines. <br /><br />They have different temperature zones for different vaccines.\u00a0The<strong> upper zone </strong>is for<strong> freeze-sensitive vaccines</strong> like cholera, hep B, rotavirus(liquid), etc while the <strong>lower zone</strong> is for<strong> heat-sensitive vaccines</strong> like OPV, measles, etc.</p>\n<p>All vaccines are kept in the basket provided with ILR. Vaccines like OPV, BCG, measles, and JE can be kept at the bottom of the basket while, DPT, TT, Hep B, IPV, and pentavalent vaccines and diluents are kept in the upper part of the basket.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2e32a2271f5443de85ffb2b0695504df.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The arterial blood gas findings of a patient are pH = 7.12, pCO2 = 50, HCO3 = 28. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Respiratory acidosis with metabolic compensation"
      },
      {
        "id": 2,
        "text": "Metabolic acidosis with respiratory compensation"
      },
      {
        "id": 3,
        "text": "Respiratory alkalosis with metabolic compensation"
      },
      {
        "id": 4,
        "text": "Metabolic alkalosis with respiratory compensation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above findings give the diagnosis of<strong>&nbsp;respiratory acidosis </strong>with<strong> metabolic compensation</strong>.</p>\n<p>Interpretation of the ABG:</p>\n<p>Step 1: pH is reduced (7.12), hence <strong>acidosis</strong>.</p>\n<p>Step 2: Since pCO2 is raised (50 mmHg),&nbsp;it is <strong>respiratory</strong> acidosis.</p>\n<p>Step 3: HCO<sub>3</sub>&nbsp;is raised&nbsp;(28 mEq/L) suggesting there is <strong>metabolic compensation</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the type of flap.",
    "choices": [
      {
        "id": 1,
        "text": "Axial flap"
      },
      {
        "id": 2,
        "text": "Islanded flap"
      },
      {
        "id": 3,
        "text": "Free flap"
      },
      {
        "id": 4,
        "text": "Random flap"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The picture shows a radial forearm free flap. In a free flap the <strong>blood supply is isolated</strong>, disconnected and then reconnected using micosurgery at the new site. Other eg: DIEP (Deep inferior epigastric perforators) flap, free fibular flap</p>\n<ul>\n<li>A <strong>random flap</strong> include three sides of a rectangle, bearing no specific relationship to where the blood supply enters.Eg:V-Y plasty, Z plasty, Limberg or rhomboid flap.</li>\n<li><strong>Axial flap</strong> is much longer and is based on known blood vessels. Eg: Latissmus dorsi flap,TRAM (Transverse rectus abdominis myocutaneous) flap</li>\n<li><strong>Islanded flap</strong> are those in which the axial blood supply is swung round on a stalk.</li>\n</ul>\n<p><strong>Note:</strong></p>\n<div class=\"page\" title=\"Page 1968\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Flap defines the tongue of tissue; pedicle is used to describe the base or stem with the vascular supply.</p>\n<p>Skin-bearing flaps are classified according to <strong>three basic characteristics</strong>&mdash;</p>\n<div class=\"page\" title=\"Page 1968\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><strong>Composition:&nbsp;</strong>refers to the tissue contained within the flap, such as cutaneous, musculocutaneous, fasciocutaneous etc</li>\n<li><strong>Method of movement</strong>:\n<ul>\n<li>Local transfer, eg. advancement or rotation flaps</li>\n<li>Distant transfer, eg. pedicle flaps from the abdomen to the perineum or micro-vascular free flaps.</li>\n</ul>\n</li>\n<li><strong>Blood supply</strong>\n<ul>\n<li>Musculocutaneous arteries travel perpendicularly through muscle to the overlying skin.</li>\n<li>Septocutaneous arteries travel with intermuscular fascial septa to supply the overlying skin.&nbsp;</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5074b024418540069fe8b7a0c986d2ee.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/38a465d7aeef48e38e7ebd9b07c4908ex1280x4958.JPEG"
    ]
  },
  {
    "text": "Which of the following parts of bones are not prone to avascular necrosis?",
    "choices": [
      {
        "id": 1,
        "text": "Neck of femur"
      },
      {
        "id": 2,
        "text": "Proximal pole of scaphoid"
      },
      {
        "id": 3,
        "text": "Body of talus"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Head of the femur</strong> is prone to avascular necrosis and not the neck of femur.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While performing a PET-CT scan, uptake in which of the following areas is likely to be a false positive?",
    "choices": [
      {
        "id": 1,
        "text": "Urinary bladder"
      },
      {
        "id": 2,
        "text": "Testes"
      },
      {
        "id": 3,
        "text": "Pancreas"
      },
      {
        "id": 4,
        "text": "Lymph nodes"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>On 18F-FDG <strong>PET-CT</strong> scan, the<strong> urinary bladder</strong> shows normal physiological uptake and&nbsp;is a <strong>potential</strong> source of <strong>false-positive </strong>in oncologic imaging.&nbsp;</p>\n<p>The following are areas of <strong>normal physiological uptake</strong> on PET CT:</p>\n<ul>\n<li>Brain tissue</li>\n<li>Skeletal muscle, especially after strenuous activity and laryngeal muscles following speech</li>\n<li>Myocardium</li>\n<li>Gastrointestinal tract - intestinal wall</li>\n<li>Genitourinary tract - as FDG is excreted via the renal system and passes into the collecting systems</li>\n<li>Brown fat - FDG accumulates here as glucose and ATP are required for heat production</li>\n<li>Thymus</li>\n<li>Bone marrow</li>\n</ul>\n<p>The following image shows supraclavicular uptake on a PET scan, due to the presence of brown adipose tissue.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/aa0e461783e34c3ca1afd3412feeadf3x512x130.PNG"
    ]
  }
];
        let quizName = 'Fmge Mini Test - 014';
        const quizFilename = 'fmge-mini-test-014-872c20ea.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>