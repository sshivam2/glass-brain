<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>07  Local Anaesthetics - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        DAMS / DQB / Anesthesia
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">36</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "id": 50000,
    "choices": [
      {
        "id": 200000,
        "text": "To reduce vagal tone"
      },
      {
        "id": 200001,
        "text": "To decrease needle phobia"
      },
      {
        "id": 200002,
        "text": "To increase gastric pH"
      },
      {
        "id": 200003,
        "text": "To decrease hypertensive response to intubation"
      }
    ],
    "text": "EMLA is used for",
    "unique_key": "Q2771910",
    "question_audio": null,
    "question_video": null,
    "map_id": 34430340,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) To decrease needle phobia EMLA (Eutectic Mixture of Local Anesthetics) is a topical anesthetic cream containing lidocaine and prilocaine, which work synergistically to numb the skin by inhibiting sodium channels in nerve endings. It is specifically used to reduce the pain associated with needle-related procedures, such as venipuncture, intravenous cannulation, or minor skin surgeries. By effectively numbing the skin, EMLA alleviates the sensation of pain, thereby reducing the anxiety or phobia commonly associated with needles. This makes it particularly valuable for pediatric patients, individuals with a low pain threshold, or those with needle phobia. Its widespread use highlights its effectiveness in providing localized pain relief and improving patient comfort during procedures. Incorrect Options: Option (A): To reduce vagal tone This option is incorrect because EMLA does not affect vagal tone or the autonomic nervous system. Reducing vagal tone typically requires pharmacological agents such as anticholinergics like atropine or physical interventions. EMLA only provides localized anesthetic effects at the site of application and has no impact on the systemic neural pathways that regulate vagal tone. Option (C): To increase gastric pH This is incorrect as EMLA has no role in modifying gastric pH. Medications such as antacids, H2-receptor antagonists (e.g., ranitidine), or proton pump inhibitors (e.g., omeprazole) are used for increasing gastric pH to manage acidity-related issues. EMLA, being a topical anesthetic, does not interact with the gastrointestinal system in any capacity. Option (D): To decrease hypertensive response to intubation This option is incorrect because EMLA does not influence blood pressure or the systemic cardiovascular response. Decreasing the hypertensive response to intubation typically involves agents like beta-blockers, opioids, or intravenous anesthetics such as propofol or lidocaine administered systemically. EMLA is limited to localized skin anesthesia and does not provide any systemic effects that could modulate the stress response to intubation.",
    "correct_choice_id": 200001,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/37442591698567179/37442591698567179.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/37442591698567179/37442591698567179.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50001,
    "choices": [
      {
        "id": 200004,
        "text": "Procaine"
      },
      {
        "id": 200005,
        "text": "Chlorprocaine"
      },
      {
        "id": 200006,
        "text": "Mepivacaine"
      },
      {
        "id": 200007,
        "text": "Levo bupivacaine"
      }
    ],
    "text": "All are short acting except",
    "unique_key": "Q2881284",
    "question_audio": null,
    "question_video": null,
    "map_id": 34538542,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Levo-bupivacaine Levo-bupivacaine is a long-acting local anesthetic, derived from bupivacaine. It provides prolonged anesthesia and analgesia due to its slow metabolism and sustained duration of action. It is commonly used in procedures requiring extended pain relief, such as epidural anesthesia during labor or postoperative pain management. Its duration of action can last up to several hours, making it distinct from other local anesthetics like procaine, chlorprocaine, and mepivacaine, which are classified as short-acting or intermediate-acting agents. This prolonged effect is due to its higher protein binding and lipid solubility compared to short-acting local anesthetics. Incorrect Options: Option (A): Procaine This option is incorrect because procaine is a short-acting local anesthetic. It is rapidly metabolized by plasma esterases (cholinesterases), resulting in a short duration of action. Procaine is often used for minor procedures requiring brief anesthesia. Option (B): Chlorprocaine This is incorrect as chlorprocaine is also a short-acting local anesthetic. It has a faster onset and shorter duration than procaine due to its rapid hydrolysis by plasma cholinesterase. Chlorprocaine is commonly used for outpatient procedures where quick recovery is desired. Option (C): Mepivacaine Mepivacaine is incorrect because it is classified as an intermediate-acting local anesthetic. Although it lasts longer than procaine and chlorprocaine, its duration of action is significantly shorter than that of levo-bupivacaine. It is used for procedures where moderate-duration anesthesia is needed. Levo-bupivacaine\u2019s long-acting nature sets it apart from the other options, which are short- or intermediate-acting anesthetics.",
    "correct_choice_id": 200007,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/5771341698567193/5771341698567193.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/5771341698567193/5771341698567193.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50002,
    "choices": [
      {
        "id": 200008,
        "text": "Are metabolized to PABA"
      },
      {
        "id": 200009,
        "text": "Cross placenta in large amounts"
      },
      {
        "id": 200010,
        "text": "Are hydrolyzed in plasma by pseudocholinesterase"
      },
      {
        "id": 200011,
        "text": "Allergic reactions are more common with them"
      }
    ],
    "text": "Esters local Anaesthetics, all are true except",
    "unique_key": "Q4293181",
    "question_audio": null,
    "question_video": null,
    "map_id": 34465014,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Cross placenta in large amounts This statement is incorrect because ester local anesthetics do not cross the placenta in large amounts. Ester local anesthetics, such as procaine and chlorprocaine, are rapidly metabolized in plasma by pseudocholinesterase, resulting in minimal systemic circulation and reduced placental transfer. Furthermore, the ionized form of ester anesthetics at physiological pH limits their ability to cross biological membranes, including the placenta. Therefore, their placental transfer is negligible, making them relatively safer for use during pregnancy compared to amide anesthetics, which are more likely to cross the placenta due to their slower metabolism. Incorrect Options: Option (A): Are metabolized to PABA This statement is correct. Ester local anesthetics are metabolized in plasma to para-aminobenzoic acid (PABA) by pseudocholinesterase. PABA is a known byproduct of ester anesthetic metabolism and is associated with a higher risk of allergic reactions. This rapid metabolism explains their short duration of action compared to amide anesthetics. Option (C): Are hydrolyzed in plasma by pseudocholinesterase This is correct. Ester local anesthetics are hydrolyzed in the plasma by the enzyme pseudocholinesterase. This process is efficient and rapid, leading to their short duration of action. The reliance on pseudocholinesterase for metabolism also makes individuals with pseudocholinesterase deficiency more susceptible to prolonged effects of ester local anesthetics. Option (D): Allergic reactions are more common with them This is also correct. Allergic reactions are more commonly associated with ester local anesthetics due to the formation of PABA, a known allergen. PABA can trigger hypersensitivity reactions in susceptible individuals, which is why ester anesthetics are avoided in patients with a history of such allergies. In contrast, allergic reactions to amide anesthetics are rare.",
    "correct_choice_id": 200009,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/64092981698567208/64092981698567208.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/64092981698567208/64092981698567208.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50003,
    "choices": [
      {
        "id": 200012,
        "text": "Penile nerve block"
      },
      {
        "id": 200013,
        "text": "Brachial plexus block"
      },
      {
        "id": 200014,
        "text": "Epidural block"
      },
      {
        "id": 200015,
        "text": "Subarchanoid block"
      }
    ],
    "text": "Adrenaline should not be given along with",
    "unique_key": "Q2174407",
    "question_audio": null,
    "question_video": null,
    "map_id": 34390007,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Penile nerve block Adrenaline (epinephrine) should not be given along with a penile nerve block because it causes vasoconstriction by stimulating alpha-adrenergic receptors in blood vessels. The penile tissue has an end-artery blood supply, meaning it is highly dependent on adequate blood flow through small vessels. Vasoconstriction in this area can result in ischemia and even tissue necrosis due to reduced blood flow. Therefore, the addition of adrenaline to local anesthetics in this setting is contraindicated to prevent serious complications like penile tissue damage. Incorrect Options: Option (B): Brachial plexus block This option is incorrect because adrenaline is commonly used with brachial plexus blocks. It prolongs the duration of anesthesia by decreasing systemic absorption of the local anesthetic and enhances its efficacy. Additionally, the blood supply to the upper limb is robust, reducing the risk of ischemia when adrenaline is used in this context. Option (C): Epidural block This is incorrect as adrenaline can safely be used with epidural blocks. Adding adrenaline helps to prolong the duration of the block by reducing systemic absorption and improving the localization of the anesthetic. The extensive vascular supply in the epidural region makes the risk of ischemia negligible when adrenaline is administered in recommended concentrations. Option (D): Subarachnoid block This option is also incorrect because adrenaline may be used in subarachnoid blocks (spinal anesthesia) to prolong the effect of local anesthetics and enhance their intensity. Its vasoconstrictive properties reduce systemic absorption and minimize the risk of toxicity. Since the spinal cord has a rich blood supply and is not an end-artery system, the use of adrenaline does not pose a significant risk of ischemia.",
    "correct_choice_id": 200012,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/30327221698567223/30327221698567223.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/30327221698567223/30327221698567223.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50004,
    "choices": [
      {
        "id": 200016,
        "text": "Intercostals> intraplueral> brachial>lumbar"
      },
      {
        "id": 200017,
        "text": "Intrapleural> Intercostals> brachial>lumbar"
      },
      {
        "id": 200018,
        "text": "Intercostals> intraplueral> lumbar>brachial"
      },
      {
        "id": 200019,
        "text": "Intrapleural> Intercostals>lumbar>brachial"
      }
    ],
    "text": "The plasma concentration with single shot of local anesthetic is highest with",
    "unique_key": "Q6965833",
    "question_audio": null,
    "question_video": null,
    "map_id": 34980398,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Intercostals > Intrapleural > Lumbar > Brachial The plasma concentration of a local anesthetic after a single shot depends on the vascularity of the site of injection. The more vascular the site, the faster the absorption of the anesthetic into the bloodstream, resulting in higher plasma concentrations. Intercostal injections produce the highest plasma concentrations because the intercostal region is highly vascular. Intrapleural injections result in slightly lower plasma concentrations than intercostal due to relatively less vascularity. Lumbar injections have moderate vascularity, leading to lower plasma concentrations compared to intercostal or intrapleural sites. Brachial plexus injections produce the lowest plasma concentrations among these options due to the relatively lower vascularity of the brachial plexus region. Incorrect Options: Option (A): Intercostals > Intrapleural > Brachial > Lumbar This option is incorrect because, although it correctly places intercostal and intrapleural injections at the top of the hierarchy, it incorrectly ranks brachial plexus injections higher than lumbar. The lumbar region is more vascular than the brachial plexus region, resulting in higher plasma concentrations for lumbar injections. Option (B): Intrapleural > Intercostals > Brachial > Lumbar This option is incorrect because intercostal injections produce higher plasma concentrations than intrapleural injections due to the greater vascularity of the intercostal area. Additionally, lumbar injections produce higher plasma concentrations than brachial plexus injections, so the order here is also incorrect. Option (D): Intrapleural > Intercostals > Lumbar > Brachial This is incorrect because intercostal injections result in the highest plasma concentrations, surpassing intrapleural injections. While the ranking of lumbar and brachial plexus concentrations is correct, the placement of intrapleural above intercostal is not accurate.",
    "correct_choice_id": 200018,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/10894101698567239/10894101698567239.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/10894101698567239/10894101698567239.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50005,
    "choices": [
      {
        "id": 200020,
        "text": "Adrenaline"
      },
      {
        "id": 200021,
        "text": "Soda bicarbonate"
      },
      {
        "id": 200022,
        "text": "Phenylephrine"
      },
      {
        "id": 200023,
        "text": "Mephentramine"
      }
    ],
    "text": "The following reduces the time to onset of local anaesthesia",
    "unique_key": "Q1538626",
    "question_audio": null,
    "question_video": null,
    "map_id": 34893987,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Soda bicarbonate Sodium bicarbonate reduces the time to onset of local anesthesia by alkalinizing the solution of the local anesthetic. Local anesthetics are weak bases, and in acidic environments, they exist predominantly in their ionized form, which is less capable of crossing cell membranes. Adding sodium bicarbonate increases the pH of the solution, shifting the balance toward the non-ionized form of the anesthetic. The non-ionized form penetrates nerve membranes more easily, leading to faster onset of action. This is particularly useful in situations where the tissue pH is low, such as infected or inflamed areas, as it offsets the acidic environment and improves the effectiveness of the anesthetic. Incorrect Options: Option (A): Adrenaline This option is incorrect because adrenaline (epinephrine) does not directly reduce the time to onset of local anesthesia. Instead, it is used to prolong the duration of anesthesia by causing vasoconstriction, which slows the absorption of the anesthetic into the systemic circulation. While adrenaline enhances the efficacy and duration of the block, it does not have a significant impact on the onset time. Option (C): Phenylephrine This is incorrect because phenylephrine, like adrenaline, is a vasoconstrictor. It reduces blood flow to the injection site, prolonging the duration of anesthesia by decreasing systemic absorption. However, it does not alkalinize the anesthetic solution or enhance the penetration of the anesthetic into nerve membranes, so it does not shorten the onset time. Option (D): Mephentermine This option is incorrect as mephentermine is a sympathomimetic agent used primarily for treating hypotension, particularly in anesthesia settings. It does not have any direct effect on the onset time or efficacy of local anesthetics. Unlike sodium bicarbonate, it does not modify the pH or alter the ionization state of local anesthetics.",
    "correct_choice_id": 200021,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/27035971698567255/27035971698567255.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/27035971698567255/27035971698567255.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50006,
    "choices": [
      {
        "id": 200024,
        "text": "Procaine"
      },
      {
        "id": 200025,
        "text": "Prilocaine"
      },
      {
        "id": 200026,
        "text": "Etiodicaine"
      },
      {
        "id": 200027,
        "text": "Ropivacaine"
      }
    ],
    "text": "Local anaesthesia causing methhemoglobinemia",
    "unique_key": "Q8953040",
    "question_audio": null,
    "question_video": null,
    "map_id": 34275504,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Prilocaine Prilocaine is known to cause methemoglobinemia, a condition in which hemoglobin is oxidized to methemoglobin, reducing its oxygen-carrying capacity. Prilocaine is metabolized in the liver to o-toluidine, a compound that can oxidize hemoglobin to methemoglobin. This side effect is dose-dependent and more common when large doses of prilocaine are administered. Methemoglobinemia manifests clinically as cyanosis and hypoxia that do not improve with oxygen supplementation. Prilocaine is often avoided in patients with conditions like anemia, respiratory disorders, or genetic predispositions to methemoglobinemia. Incorrect Options: Option (A): Procaine This option is incorrect because procaine does not typically cause methemoglobinemia. Procaine is an ester-type local anesthetic that is hydrolyzed in plasma to PABA. While it has its own risks, such as allergic reactions due to PABA formation, it does not produce the oxidative metabolites responsible for methemoglobinemia. Option (C): Etidocaine This is incorrect because etidocaine is an amide local anesthetic and is not associated with causing methemoglobinemia. It is primarily used for prolonged anesthesia in surgical procedures but does not have significant oxidative metabolism that leads to methemoglobin formation. Option (D): Ropivacaine This option is also incorrect. Ropivacaine is an amide local anesthetic, primarily used for regional anesthesia, including epidurals and nerve blocks. It has a favorable safety profile and is not known to induce methemoglobinemia. Its metabolism does not produce oxidative metabolites like those seen with prilocaine.",
    "correct_choice_id": 200025,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/17354611698567269/17354611698567269.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/17354611698567269/17354611698567269.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50007,
    "choices": [
      {
        "id": 200028,
        "text": "Secure airway"
      },
      {
        "id": 200029,
        "text": "Adrenaline"
      },
      {
        "id": 200030,
        "text": "IV short acting barbiturate"
      },
      {
        "id": 200031,
        "text": "Diazepam IV"
      }
    ],
    "text": "In acute convulsions due to toxicity to local anaesthetic most important step in immediate management is \u2013",
    "unique_key": "Q4068784",
    "question_audio": null,
    "question_video": null,
    "map_id": 34149377,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) IV short-acting barbiturate In the case of acute convulsions due to local anesthetic toxicity, the most important step in immediate management is to control the seizure activity quickly to prevent further complications, such as hypoxia or brain injury. IV short-acting barbiturates, such as thiopental, are effective in rapidly controlling seizures by depressing the central nervous system. Barbiturates work by enhancing GABAergic inhibition, which is crucial in stopping convulsions. The use of a short-acting barbiturate is favored because of its ability to quickly terminate the seizure while also allowing for effective management of any further complications. Incorrect Options: Option (A): Secure airway While securing the airway is critically important in any case of convulsions or loss of consciousness, it is not the most immediate intervention in this context. Once airway security is addressed, the priority shifts to controlling the seizure activity. However, securing the airway remains a vital step that cannot be overlooked and should be done concurrently or as soon as possible. Option (B): Adrenaline Adrenaline is not the primary treatment for local anesthetic-induced convulsions. It is more commonly used in cases of anaphylaxis, cardiac arrest, or severe hypotension. In the case of local anesthetic toxicity, the primary concern is controlling the seizure, not addressing cardiovascular collapse. Adrenaline could potentially worsen the situation by increasing the risk of arrhythmias in the setting of local anesthetic toxicity. Option (D): Diazepam IV While diazepam (a benzodiazepine) is commonly used to treat seizures, in the case of local anesthetic toxicity, IV short-acting barbiturates are preferred for more rapid seizure control. Diazepam can be effective, but barbiturates generally provide a quicker, more reliable cessation of convulsions in this context. Diazepam may be used if barbiturates are not available, but it is not the first-line treatment.",
    "correct_choice_id": 200030,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/12255971698567283/12255971698567283.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/12255971698567283/12255971698567283.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50008,
    "choices": [
      {
        "id": 200032,
        "text": "Cocaine"
      },
      {
        "id": 200033,
        "text": "Lidocaine"
      },
      {
        "id": 200034,
        "text": "Bupivacaine"
      },
      {
        "id": 200035,
        "text": "Dubicaine"
      }
    ],
    "text": "Which of the following is an ester linked local anaesthesia \u2013",
    "unique_key": "Q2802796",
    "question_audio": null,
    "question_video": null,
    "map_id": 34669555,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Cocaine Cocaine is an ester-linked local anesthetic. Ester local anesthetics are characterized by the ester bond in their chemical structure, which is hydrolyzed by plasma esterases (pseudocholinesterase) after administration. Cocaine, in addition to its anesthetic properties, also has stimulant effects due to its action on norepinephrine reuptake. Being an ester, it has a relatively shorter duration of action compared to amide-type local anesthetics, which are metabolized more slowly. Incorrect Options: Option (B): Lidocaine This option is incorrect because lidocaine is an amide-type local anesthetic, not an ester. Amide local anesthetics are characterized by the amide bond in their chemical structure, which is metabolized by the liver. Lidocaine has a longer duration of action compared to ester local anesthetics like cocaine and is commonly used for both local anesthesia and as an antiarrhythmic agent. Option (C): Bupivacaine This is incorrect because bupivacaine is also an amide-type local anesthetic. Like lidocaine, it is metabolized in the liver. Bupivacaine has a long duration of action and is used in regional anesthesia, such as epidural and spinal blocks, but it does not have the ester linkage that characterizes cocaine. Option (D): Dubicaine This option is incorrect because dubicaine is not a recognized local anesthetic agent. There may be confusion with \"dicaine,\" which is sometimes used as a name for a class of anesthetics, but \"dubicaine\" is not a standard or well-known local anesthetic. Thus, it does not fit the description of an ester-linked local anesthetic.",
    "correct_choice_id": 200032,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/47334511698567495/47334511698567495.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/47334511698567495/47334511698567495.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50009,
    "choices": [
      {
        "id": 200036,
        "text": "Cause depolarization of nerve membranes"
      },
      {
        "id": 200037,
        "text": "Has a shorter duration of action than lignocaine"
      },
      {
        "id": 200038,
        "text": "Is unsuitable for intrathecal use"
      },
      {
        "id": 200039,
        "text": "Is contraindicated for intravenous regional anaesthesia (IVRA)"
      }
    ],
    "text": "Bupivacaine has the following actions-",
    "unique_key": "Q5218904",
    "question_audio": null,
    "question_video": null,
    "map_id": 34096254,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Is contraindicated for intravenous regional anesthesia (IVRA) Bupivacaine is contraindicated for intravenous regional anesthesia (IVRA), also known as Bier\u2019s block, due to its potential for causing severe cardiovascular toxicity. Bupivacaine has a high affinity for cardiac sodium channels and, in the case of accidental intravascular injection, it can lead to life-threatening arrhythmias, especially in higher doses. IVRA involves injecting a local anesthetic into the venous system of a limb after the circulation is restricted by a tourniquet. Given the risk of systemic absorption in this setting, bupivacaine\u2019s cardiotoxicity makes it unsuitable for use in this technique, as it can cause severe arrhythmias or even cardiac arrest. Incorrect Options: Option (A): Cause depolarization of nerve membranes This option is incorrect because local anesthetics, including bupivacaine, work by inhibiting depolarization of nerve membranes. They block sodium channels, preventing the influx of sodium ions during an action potential, which results in a failure to depolarize the nerve membrane. This inhibition of depolarization prevents the transmission of nerve impulses, leading to anesthesia. Option (B): Has a shorter duration of action than lignocaine This is incorrect because bupivacaine has a longer duration of action than lignocaine (lidocaine). Bupivacaine is a highly lipid-soluble and protein-bound drug, which leads to its prolonged action compared to lignocaine, which has a shorter duration of action due to its lower lipid solubility and quicker systemic absorption. Option (C): Is unsuitable for intrathecal use This option is incorrect. Bupivacaine is commonly used for intrathecal (spinal) anesthesia because it provides a long duration of anesthesia with good sensory blockade. While there are some risks associated with its use, such as potential cardiovascular effects, it is still widely used in intrathecal anesthesia, especially for surgical procedures requiring prolonged anesthesia.",
    "correct_choice_id": 200039,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/20593031698567547/20593031698567547.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/20593031698567547/20593031698567547.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50010,
    "choices": [
      {
        "id": 200040,
        "text": "Increases speed and quality of anaesthesia"
      },
      {
        "id": 200041,
        "text": "Decreases diffusion of the anaesthetic drug"
      },
      {
        "id": 200042,
        "text": "Causes rapid elimination of the local anaesthetic"
      },
      {
        "id": 200043,
        "text": "Decreases speed and quality of anaesthesia"
      }
    ],
    "text": "Sodium bicarbonate when given with local anaesthetics has which of the following effect-",
    "unique_key": "Q2474499",
    "question_audio": null,
    "question_video": null,
    "map_id": 34044855,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Increases speed and quality of anaesthesia Sodium bicarbonate, when added to local anesthetics, increases the speed and quality of anesthesia by alkalinizing the solution. Local anesthetics are weak bases, and in acidic environments, they exist predominantly in their ionized form, which has a poor ability to diffuse across nerve membranes. By raising the pH of the anesthetic solution, sodium bicarbonate shifts the equilibrium towards the non-ionized (more lipid-soluble) form of the drug. This enhances the ability of the anesthetic to cross the nerve membrane, resulting in a faster onset and improved quality of anesthesia. It is particularly helpful in areas with low tissue pH, such as inflamed or infected tissue, where the anesthetic might otherwise be less effective. Incorrect Options: Option (B): Decreases diffusion of the anaesthetic drug This option is incorrect because sodium bicarbonate actually increases the diffusion of the anesthetic drug into nerve tissue. By increasing the proportion of the non-ionized form of the local anesthetic, it improves the drug's ability to cross nerve membranes, which enhances the diffusion of the drug into the nerve and accelerates the onset of anesthesia. Option (C): Causes rapid elimination of the local anaesthetic This option is incorrect because sodium bicarbonate does not affect the elimination of local anesthetics. The rate of elimination of local anesthetics is determined by factors such as hepatic metabolism (for amides) or plasma esterases (for esters), not by the pH of the anesthetic solution. The addition of sodium bicarbonate has no significant effect on the metabolic elimination of the drug. Option (D): Decreases speed and quality of anaesthesia This is incorrect because sodium bicarbonate does not decrease the speed or quality of anesthesia. On the contrary, it improves both the speed and quality by increasing the proportion of the non-ionized form of the local anesthetic, allowing for faster nerve membrane penetration and more effective blockade.",
    "correct_choice_id": 200040,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/51690031698567565/51690031698567565.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/51690031698567565/51690031698567565.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50011,
    "choices": [
      {
        "id": 200044,
        "text": "Procaine"
      },
      {
        "id": 200045,
        "text": "Lignocaine"
      },
      {
        "id": 200046,
        "text": "Bupivacaine"
      },
      {
        "id": 200047,
        "text": "Cocaine"
      }
    ],
    "text": "Local Anesthetic first used clinically-",
    "unique_key": "Q3345838",
    "question_audio": null,
    "question_video": null,
    "map_id": 34184187,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Cocaine Cocaine was the first local anesthetic to be used clinically. It was first used in the late 19th century, with Carl Koller, an Austrian ophthalmologist, demonstrating its efficacy as a local anesthetic in 1884. Koller used cocaine for ophthalmic surgery, and its use rapidly expanded to other surgical fields. Cocaine blocks nerve conduction by inhibiting sodium ion influx, leading to local anesthesia. Despite its effective anesthetic properties, it was eventually replaced by safer alternatives due to its potential for addiction, toxicity, and adverse systemic effects. Incorrect Options: Option (A): Procaine Procaine was introduced in 1905 and is an ester-type local anesthetic. While it was widely used in the 20th century, it was not the first local anesthetic used clinically. Procaine is a synthetic derivative of cocaine, developed to have fewer addictive properties and reduced toxicity compared to cocaine. It became popular for use in various procedures but was not the first local anesthetic to be clinically applied. Option (B): Lignocaine Lidocaine (also known as lignocaine) was introduced in 1943 and is an amide-type local anesthetic. It became one of the most widely used local anesthetics due to its potency, rapid onset, and lower toxicity compared to earlier agents like procaine and cocaine. However, it was not the first local anesthetic used in clinical practice. Option (C): Bupivacaine Bupivacaine, introduced in the 1950s, is an amide-type local anesthetic known for its long duration of action and potent anesthetic effects. It is commonly used for regional anesthesia, including epidural and spinal anesthesia. However, it was not the first local anesthetic, and it came much later than cocaine in the history of clinical anesthesiology.",
    "correct_choice_id": 200047,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/77796591698567581/77796591698567581.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/77796591698567581/77796591698567581.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50012,
    "choices": [
      {
        "id": 200048,
        "text": "Procaine"
      },
      {
        "id": 200049,
        "text": "Xylocaine"
      },
      {
        "id": 200050,
        "text": "Bupivacaine"
      },
      {
        "id": 200051,
        "text": "Chlorprocaine"
      }
    ],
    "text": "Shortest acting local anesthetic is",
    "unique_key": "Q9518692",
    "question_audio": null,
    "question_video": null,
    "map_id": 34035077,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Chlorprocaine is considered the shortest-acting local anesthetic. It is a rapidly metabolized ester and has a short duration of action, typically lasting 30 to 60 minutes. This makes it one of the fastest-acting and shortest-duration local anesthetics. Incorrect Options: A. Procaine While procaine is a short-acting local anesthetic, chlorprocaine is generally considered to have a shorter duration than procaine. Procaine typically lasts around 30 to 60 minutes, similar to chlorprocaine, but chlorprocaine is faster in onset and has an even shorter effective duration. B. Xylocaine (Lidocaine) Lidocaine (also known as Xylocaine) has a moderate duration of action, typically lasting 1 to 2 hours. It is longer-acting than both procaine and chlorprocaine, and although it is fast-acting, it is not the shortest. C. Bupivacaine Bupivacaine is a long-acting local anesthetic, with a duration of action that can last for several hours. It is used when a prolonged anesthetic effect is needed and is much longer-acting than both procaine and chlorprocaine.",
    "correct_choice_id": 200051,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/37543501698567599/37543501698567599.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/37543501698567599/37543501698567599.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50013,
    "choices": [
      {
        "id": 200052,
        "text": "Procaine"
      },
      {
        "id": 200053,
        "text": "Cocaine"
      },
      {
        "id": 200054,
        "text": "Lidocaine"
      },
      {
        "id": 200055,
        "text": "Bupivacaine"
      }
    ],
    "text": "Which local anesthesia causes vasoconstriction",
    "unique_key": "Q1537704",
    "question_audio": null,
    "question_video": null,
    "map_id": 34471768,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Cocaine Cocaine is the only local anesthetic among the options that causes vasoconstriction. This effect is due to its ability to inhibit the reuptake of norepinephrine, leading to increased sympathetic activity and vasoconstriction. Cocaine's vasoconstrictive property is beneficial in certain surgeries, such as nasal or ophthalmic procedures, where localized vasoconstriction helps reduce bleeding. However, due to its potential for abuse and serious systemic side effects, cocaine is rarely used today for local anesthesia. Incorrect Options: Option (A): Procaine Procaine, an ester-type local anesthetic, does not cause vasoconstriction. In fact, it can cause mild vasodilation. Unlike cocaine, procaine does not affect norepinephrine reuptake and does not have the vasoconstrictive properties seen with cocaine. In clinical practice, procaine is often combined with epinephrine to produce vasoconstriction and prolong the anesthetic effect. Option (C): Lidocaine Lidocaine is an amide-type local anesthetic that does not cause significant vasoconstriction. In fact, lidocaine tends to produce mild vasodilation, which can increase the rate of systemic absorption and reduce the duration of action. Similar to procaine, lidocaine is often combined with a vasoconstrictor like epinephrine to counteract this vasodilation and prolong its effects. Option (D): Bupivacaine Bupivacaine, like lidocaine, is an amide-type local anesthetic and does not cause vasoconstriction on its own. It can produce mild vasodilation, and similar to lidocaine and procaine, it is sometimes combined with epinephrine to reduce systemic absorption and extend the duration of anesthesia.",
    "correct_choice_id": 200053,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/75855031698567613/75855031698567613.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/75855031698567613/75855031698567613.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50014,
    "choices": [
      {
        "id": 200056,
        "text": "Spinal anaesthesia"
      },
      {
        "id": 200057,
        "text": "Epidural anaesthesia"
      },
      {
        "id": 200058,
        "text": "Digital nerve block"
      },
      {
        "id": 200059,
        "text": "Regional anaesthesia"
      }
    ],
    "text": "Contraindications to vasoconstrictors in local anaesthesia?",
    "unique_key": "Q3165111",
    "question_audio": null,
    "question_video": null,
    "map_id": 34287615,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Digital nerve block The use of vasoconstrictors in local anesthesia is contraindicated in digital nerve blocks. Vasoconstrictors, such as epinephrine, cause vasoconstriction, which can significantly reduce blood flow to distal tissues like the fingers and toes. In the case of a digital nerve block, this can lead to ischemia and necrosis of the tissue due to the already limited blood supply in the digits. Therefore, vasoconstrictors should not be used in these areas to avoid compromising circulation and causing tissue damage. Incorrect Options: Option (A): Spinal anaesthesia This option is incorrect because vasoconstrictors can be used in spinal anesthesia in certain situations, although caution is needed. For example, in spinal anesthesia, vasoconstrictors like epinephrine can help prolong the effect of the anesthetic and reduce systemic absorption. However, vasoconstrictors should be used carefully, especially in cases where there may be underlying cardiovascular issues or in high doses, as they can cause hypertension or arrhythmias. Option (B): Epidural anaesthesia This option is incorrect because vasoconstrictors can be used in epidural anesthesia as well. The use of vasoconstrictors in epidural blocks helps to limit the systemic absorption of the local anesthetic and prolongs its duration of action by constricting the blood vessels in the region of the block. The effect is typically localized and does not pose the same risks as it would in smaller, more distal areas like the fingers or toes. Option (D): Regional anaesthesia This option is incorrect because vasoconstrictors can be used safely in regional anesthesia, such as brachial plexus or femoral nerve blocks. In these cases, vasoconstrictors help to reduce the systemic absorption of the local anesthetic and increase the duration of action. However, caution should be exercised in areas where the vascular supply is already compromised or in patients with certain cardiovascular conditions, but it is generally considered safe.",
    "correct_choice_id": 200058,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/27885421698567813/27885421698567813.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/27885421698567813/27885421698567813.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50015,
    "choices": [
      {
        "id": 200060,
        "text": "Lignocaine"
      },
      {
        "id": 200061,
        "text": "Procaine"
      },
      {
        "id": 200062,
        "text": "Mepivacaine"
      },
      {
        "id": 200063,
        "text": "Bupivacaine"
      }
    ],
    "text": "which one of the following local anaesthetics is highly cardio-toxic?",
    "unique_key": "Q6739323",
    "question_audio": null,
    "question_video": null,
    "map_id": 34932735,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Bupivacaine Bupivacaine is highly cardio-toxic compared to other local anesthetics. It has a strong affinity for cardiac sodium channels, and in high concentrations or when injected intravascularly, it can lead to severe cardiac side effects, such as arrhythmias, bradycardia, or even cardiac arrest. The cardiotoxicity of bupivacaine is primarily related to its long duration of action and high potency, which can cause prolonged inhibition of the sodium channels in the heart. Therefore, it is essential to use bupivacaine with caution, especially in patients with pre-existing cardiovascular conditions. Incorrect Options: Option (A): Lignocaine Lignocaine (lidocaine) is less cardiotoxic than bupivacaine. While it can cause arrhythmias in cases of overdose or rapid intravenous administration, its cardiotoxicity is much lower than that of bupivacaine. Lidocaine is actually considered the standard local anesthetic for managing ventricular arrhythmias, and it has a safer profile for use in both local anesthesia and as an antiarrhythmic agent. Option (B): Procaine Procaine, an ester-type local anesthetic, is generally considered to have low cardiotoxicity. It can cause some cardiovascular side effects, such as hypotension or bradycardia, but it is not highly cardio-toxic compared to bupivacaine. Procaine is typically used for shorter procedures and has a lower risk of causing significant cardiac complications. Option (C): Mepivacaine Mepivacaine, an amide-type local anesthetic, is also less cardiotoxic than bupivacaine. While it can cause side effects like bradycardia and hypotension in large doses or inappropriate administration, its cardiotoxicity is not as pronounced as that of bupivacaine. Mepivacaine is often used in both dental and regional anesthesia with a relatively safe cardiovascular profile.",
    "correct_choice_id": 200063,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/7911601698567828/7911601698567828.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/7911601698567828/7911601698567828.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50016,
    "choices": [
      {
        "id": 200064,
        "text": "Prilocaine"
      },
      {
        "id": 200065,
        "text": "Ropivacaine"
      },
      {
        "id": 200066,
        "text": "Etidocaine"
      },
      {
        "id": 200067,
        "text": "Benzocaine"
      }
    ],
    "text": "which of the following local anaesthetic is most likely to produce an allergic reaction?",
    "unique_key": "Q2800342",
    "question_audio": null,
    "question_video": null,
    "map_id": 34012237,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Benzocaine Benzocaine is most likely to produce an allergic reaction among the local anesthetics listed. It is an ester-type local anesthetic, and ester anesthetics are known to be more likely to cause allergic reactions compared to amide anesthetics. Benzocaine is often used topically for minor pain relief, such as in throat lozenges or as a topical gel, and it can trigger allergic responses, especially in sensitive individuals. The allergic reactions can include skin rashes, anaphylaxis, or methemoglobinemia, a condition where the blood is unable to carry oxygen effectively. Ester-type anesthetics like benzocaine are metabolized to para-aminobenzoic acid (PABA), which is a known allergen, increasing the likelihood of allergic reactions. Incorrect Options: Option (A): Prilocaine Prilocaine, an amide-type local anesthetic, has a relatively low incidence of allergic reactions. While it can cause methemoglobinemia in some individuals (a condition where the blood is unable to carry oxygen properly), it is not as likely to cause typical allergic reactions like skin rashes or anaphylaxis. Amide-type anesthetics, such as prilocaine, are generally considered to have a lower potential for inducing allergic responses compared to ester-type anesthetics. Option (B): Ropivacaine Ropivacaine, also an amide-type local anesthetic, has a similar low incidence of allergic reactions as other amides like prilocaine and lidocaine. Allergic reactions to ropivacaine are rare and, when they occur, are typically mild. The primary side effects of ropivacaine are related to its pharmacologic effects, such as nerve blockade or cardiovascular toxicity, rather than allergic responses. Option (C): Etidocaine Etidocaine, another amide-type local anesthetic, is also not commonly associated with allergic reactions. As with prilocaine and ropivacaine, allergic reactions to etidocaine are rare. This makes it less likely to produce an allergic reaction compared to ester-type local anesthetics like benzocaine. Etidocaine's side effects are typically related to its potency and duration of action rather than allergic responses.",
    "correct_choice_id": 200067,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/6312281698567853/6312281698567853.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/6312281698567853/6312281698567853.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50017,
    "choices": [
      {
        "id": 200068,
        "text": "Lignocaine"
      },
      {
        "id": 200069,
        "text": "Bupivacaine"
      },
      {
        "id": 200070,
        "text": "Prilocaine"
      },
      {
        "id": 200071,
        "text": "Lignocaine + ketorolac"
      }
    ],
    "text": "A 30 year old lady is to undergo surgery under intravenous regional anaesthesia for her left trigger finger. Which of the following should not be used for this patient?",
    "unique_key": "Q7714337",
    "question_audio": null,
    "question_video": null,
    "map_id": 34931431,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Bupivacaine Bupivacaine should not be used in intravenous regional anesthesia (IVRA), also known as Bier's block, due to its high potential for systemic toxicity, especially when administered in the context of a tourniquet. IVRA involves injecting the local anesthetic into the venous system of an isolated limb that is occluded by a tourniquet to prevent the anesthetic from spreading systemically. Bupivacaine is highly cardiotoxic and has a long duration of action, which can be dangerous in IVRA, as the anesthetic may be released into the bloodstream after tourniquet deflation, leading to severe cardiovascular complications such as arrhythmias or even cardiac arrest. Therefore, short-acting anesthetics like lignocaine or prilocaine are preferred for Bier's block to minimize this risk. Incorrect Options: Option (A): Lignocaine Lignocaine (lidocaine) is commonly used in IVRA and is considered safe for this procedure. It is a short-acting, amide-type local anesthetic with a rapid onset and moderate duration of action, making it ideal for short procedures like trigger finger surgery. Lignocaine is less toxic than bupivacaine, and it is commonly combined with a vasoconstrictor like epinephrine to prolong its effect. Lignocaine is one of the standard anesthetics used for intravenous regional anesthesia. Option (C): Prilocaine Prilocaine is also a suitable anesthetic for IVRA. It is another short-acting amide-type anesthetic that is commonly used in regional blocks. Like lignocaine, prilocaine is safe for intravenous regional anesthesia, and it has a lower risk of toxicity compared to bupivacaine. However, caution is required with prilocaine in high doses, as it can cause methemoglobinemia, a condition that reduces the blood's ability to carry oxygen, though this is relatively rare in clinical use. Option (D): Lignocaine + Ketorolac The combination of lignocaine with ketorolac is sometimes used in regional anesthesia to provide both analgesia and anti-inflammatory effects. Ketorolac is a non-steroidal anti-inflammatory drug (NSAID) that can be used as an adjunct to local anesthetics to reduce postoperative pain. This combination is generally safe for IVRA and does not introduce additional risks compared to using lignocaine alone. The addition of ketorolac does not contraindicate the procedure.",
    "correct_choice_id": 200069,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/32148831698567868/32148831698567868.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/32148831698567868/32148831698567868.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50018,
    "choices": [
      {
        "id": 200072,
        "text": "10 ml"
      },
      {
        "id": 200073,
        "text": "20 ml"
      },
      {
        "id": 200074,
        "text": "30 ml"
      },
      {
        "id": 200075,
        "text": "40 ml"
      }
    ],
    "text": "VF following caudal anaethesia in 20Kg six year old child. The recommended dose of Intralipid 20% is:",
    "unique_key": "Q4892481",
    "question_audio": null,
    "question_video": null,
    "map_id": 34635456,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) 30 ml The recommended dose of Intralipid 20% for managing cardiovascular toxicity, including ventricular fibrillation (VF), following caudal anesthesia in a 20 kg child is 30 ml. Intralipid 20% is used to treat local anesthetic systemic toxicity (LAST), which may occur following regional anesthesia. The standard recommended dose for Intralipid in cases of LAST in pediatric patients is typically 3 mL/kg. For a 20 kg child, this equates to 60 mL of Intralipid 20%, but this dose should be given in a stepwise manner. The initial bolus dose is typically 1.5 mL/kg, which amounts to 30 mL for a 20 kg child. The dose can be repeated if necessary, according to clinical response, but starting with 30 mL is the correct initial approach for managing VF. Incorrect Options: Option (A): 10 ml A dose of 10 mL of Intralipid 20% would be too low for treating a pediatric patient with VF due to local anesthetic toxicity. The recommended initial dose for treating LAST is 1.5 mL/kg, which is higher than 10 mL for a 20 kg child. Administering only 10 mL could fail to provide adequate treatment, risking progression of the toxicity and potentially worsening the VF. Option (B): 20 ml A dose of 20 mL is also insufficient for a 20 kg child experiencing VF after caudal anesthesia. While it is closer to the correct dose than 10 mL, it still falls short of the recommended 1.5 mL/kg bolus (which would be 30 mL for a 20 kg child). Using this dose would not deliver the full therapeutic effect needed for successful management of LAST-induced VF. Option (D): 40 ml A dose of 40 mL of Intralipid 20% is excessive for a 20 kg child. While this volume is above the recommended starting bolus dose of 30 mL (1.5 mL/kg), it is unlikely to cause harm, but it exceeds the initial recommended dose and may lead to unnecessary over-treatment. Excessive doses could increase the risk of side effects without providing any additional therapeutic benefit over the correct initial dose of 30 mL.",
    "correct_choice_id": 200074,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/22413651698567882/22413651698567882.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/22413651698567882/22413651698567882.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50019,
    "choices": [
      {
        "id": 200076,
        "text": "Motor function"
      },
      {
        "id": 200077,
        "text": "Pain sensation"
      },
      {
        "id": 200078,
        "text": "Temperature sensation"
      },
      {
        "id": 200079,
        "text": "Sympathetic activity"
      }
    ],
    "text": "Which of the following function is blocked last when local anaesthetic is applied to mixed nerve",
    "unique_key": "Q2770436",
    "question_audio": null,
    "question_video": null,
    "map_id": 34039699,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Motor function Motor function is blocked last when a local anesthetic is applied to a mixed nerve. The order of nerve blockade is generally predictable and follows a specific pattern based on the size and myelination of the nerve fibers. Local anesthetics tend to block smaller, more myelinated fibers first, which are responsible for pain and temperature sensation. Larger, less myelinated fibers responsible for motor function are more resistant to blockade, meaning motor function is usually the last to be affected. This is why patients may lose pain and temperature sensations before motor function when local anesthetics are used in nerve blocks. Incorrect Options: Option (B): Pain sensation Pain sensation is typically blocked early in the process when a local anesthetic is applied to a mixed nerve. This is because pain fibers are smaller and more myelinated, making them more susceptible to the action of local anesthetics. These fibers are blocked first, resulting in the loss of pain sensation before other types of sensory or motor function are affected. Option (C): Temperature sensation Temperature sensation is blocked before motor function but after pain sensation. Like pain fibers, temperature fibers are small and myelinated, which makes them more easily blocked by local anesthetics. However, they are typically blocked after pain sensation, so temperature loss occurs prior to the loss of motor function. Option (D): Sympathetic activity Sympathetic activity is typically blocked earlier than motor function but later than pain and temperature sensations. The sympathetic fibers responsible for vasoconstriction and other autonomic functions are smaller and more easily blocked than motor fibers but not as sensitive as the fibers responsible for pain and temperature sensation.",
    "correct_choice_id": 200076,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/11352501698567896/11352501698567896.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/11352501698567896/11352501698567896.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50020,
    "choices": [
      {
        "id": 200080,
        "text": "Cocaine"
      },
      {
        "id": 200081,
        "text": "Procaine"
      },
      {
        "id": 200082,
        "text": "Tetracaine"
      },
      {
        "id": 200083,
        "text": "Benzocaine"
      }
    ],
    "text": "which of the following is mainly metabolized in liver",
    "unique_key": "Q6059110",
    "question_audio": null,
    "question_video": null,
    "map_id": 34370239,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Cocaine Cocaine is mainly metabolized in the liver. It is an ester-type local anesthetic, and its metabolism occurs primarily through ester hydrolysis in the liver by enzymes such as pseudocholinesterase. This metabolic process is relatively slower compared to some other local anesthetics, leading to a longer duration of action in some cases. Cocaine is unique because it also has sympathomimetic effects due to its inhibition of norepinephrine reuptake, which is an additional factor to consider in its clinical use. Incorrect Options: Option (B): Procaine Procaine is also an ester-type local anesthetic, but it is primarily metabolized by plasma pseudocholinesterase, not the liver. This enzyme hydrolyzes procaine rapidly, resulting in a relatively short duration of action. The metabolism of procaine occurs mostly in the plasma, and it is quickly broken down to para-aminobenzoic acid (PABA), a metabolite that can sometimes cause allergic reactions in susceptible individuals. Option (C): Tetracaine Tetracaine, another ester-type local anesthetic, is primarily metabolized in the plasma by pseudocholinesterase. While it has a longer duration of action compared to procaine, its metabolism also occurs predominantly in the plasma and not the liver. The hydrolysis of tetracaine in the plasma is relatively slow, contributing to its prolonged anesthetic effect, but it does not significantly rely on the liver for metabolism. Option (D): Benzocaine Benzocaine is an ester-type local anesthetic that is mainly metabolized in the plasma rather than the liver. It is rapidly broken down by esterases in the plasma to PABA, which can cause allergic reactions in some individuals. Benzocaine is typically used topically due to its low systemic absorption and short duration of action. It does not undergo significant liver metabolism.",
    "correct_choice_id": 200080,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/6223581698567912/6223581698567912.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/6223581698567912/6223581698567912.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50021,
    "choices": [
      {
        "id": 200084,
        "text": "They are weak bases"
      },
      {
        "id": 200085,
        "text": "Those with lower pka have faster onset of action"
      },
      {
        "id": 200086,
        "text": "Higher protein binding is associated with longer duration"
      },
      {
        "id": 200087,
        "text": "Bupivacaine is suitable anaesthetic for iv anaesthesia"
      }
    ],
    "text": "which is incorrect with regard to L.A",
    "unique_key": "Q1600656",
    "question_audio": null,
    "question_video": null,
    "map_id": 34699349,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Bupivacaine is suitable anaesthetic for IV anaesthesia Bupivacaine is not suitable for intravenous (IV) anesthesia due to its high cardiotoxicity and long duration of action. It is an amide-type local anesthetic, and while it is effective for regional anesthesia, it is not recommended for use in IV regional anesthesia (Bier's block) because of the risks associated with systemic absorption, especially after tourniquet deflation. The cardiotoxicity of bupivacaine can cause arrhythmias or even cardiac arrest, which is a significant safety concern when used in IV anesthesia. Therefore, bupivacaine is avoided in such scenarios, and shorter-acting anesthetics like lignocaine (lidocaine) or prilocaine are preferred. Incorrect Options: Option (A): They are weak bases Local anesthetics (LAs) are indeed weak bases. This means that they exist in equilibrium between their ionized and non-ionized forms, depending on the pH of the surrounding environment. The non-ionized form of the anesthetic is more lipid-soluble and can penetrate nerve membranes more easily, while the ionized form is more active in blocking the nerve conduction once inside the nerve. Option (B): Those with lower pKa have faster onset of action Local anesthetics with a lower pKa (which is the pH at which half of the molecules are ionized) have a faster onset of action. This is because the lower pKa results in a higher proportion of the anesthetic being in its non-ionized, lipid-soluble form at physiological pH, allowing it to penetrate the nerve membrane more quickly. As a result, the onset of action is faster for anesthetics with a lower pKa. Option (C): Higher protein binding is associated with longer duration Local anesthetics that have higher protein binding tend to have a longer duration of action. This is because the drug binds to plasma proteins, particularly alpha-1-acid glycoprotein, and is released slowly over time. The more the anesthetic is bound to proteins, the less it is available to diffuse away from the site of action, which results in prolonged effects. Bupivacaine, for example, has high protein binding and a long duration of action as a result.",
    "correct_choice_id": 200087,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/10687891698567927/10687891698567927.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/10687891698567927/10687891698567927.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50022,
    "choices": [
      {
        "id": 200088,
        "text": "August bier"
      },
      {
        "id": 200089,
        "text": "Karl koller"
      },
      {
        "id": 200090,
        "text": "Friedrich gaedcke"
      },
      {
        "id": 200091,
        "text": "Albert niemann"
      }
    ],
    "text": "The origin of modern local anaesthesia is credited to",
    "unique_key": "Q2021237",
    "question_audio": null,
    "question_video": null,
    "map_id": 34606771,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) August Bier August Bier is credited with the origin of modern local anesthesia. He is most famously known for performing the first spinal anesthesia using cocaine in 1898. While Bier did not invent local anesthesia, his pioneering work in the clinical application of local anesthetics, particularly in regional anesthesia, laid the foundation for its widespread use in surgery. His introduction of spinal anesthesia revolutionized surgical procedures by providing effective pain relief without the need for general anesthesia. Bier\u2019s work significantly advanced the field of anesthesiology and is considered a milestone in modern local anesthesia. Incorrect Options: Option (B): Karl Koller Karl Koller is credited with the discovery of cocaine as a local anesthetic. In 1884, Koller, an ophthalmologist, demonstrated that cocaine could be used to numb the eye, which marked the first use of a local anesthetic in medicine. While Koller\u2019s work was critical in establishing the concept of local anesthesia, it was Bier\u2019s later contributions that truly shaped modern local anesthesia, particularly in the field of regional anesthesia and its applications in surgery. Option (C): Friedrich Gaedcke Friedrich Gaedcke was a German chemist who contributed to the development of local anesthetics but is not credited with the origin of modern local anesthesia. Gaedcke's work focused on the synthesis of various chemicals, including those related to anesthetic compounds, but he did not play as significant a role in the clinical application or development of local anesthetics as August Bier or Karl Koller. Option (D): Albert Niemann Albert Niemann was the chemist who first isolated cocaine in its pure form in 1860, but he did not develop local anesthesia as a practice. His contribution was important in isolating the compound that would later be used as a local anesthetic, but it was the clinical work of Karl Koller and August Bier that truly defined and advanced local anesthetic use in medicine.",
    "correct_choice_id": 200088,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/77934221698567947/77934221698567947.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/77934221698567947/77934221698567947.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50023,
    "choices": [
      {
        "id": 200092,
        "text": "Increase duration of action"
      },
      {
        "id": 200093,
        "text": "Decreased pain on s/c injection"
      },
      {
        "id": 200094,
        "text": "Rapid onset"
      },
      {
        "id": 200095,
        "text": "Increase quality of block"
      }
    ],
    "text": "The following is not seen on addition of soda bi carbonate to L.A solution",
    "unique_key": "Q7880411",
    "question_audio": null,
    "question_video": null,
    "map_id": 34730930,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Increase duration of action Adding sodium bicarbonate to a local anesthetic solution does not increase the duration of action of the anesthetic. The primary effect of adding sodium bicarbonate is to increase the pH of the solution, which helps to convert more of the anesthetic into its non-ionized, lipid-soluble form. This enhances the drug's ability to penetrate nerve membranes, leading to a faster onset and improved quality of the block. However, this does not directly affect the duration of action of the anesthetic. The duration of action is typically determined by factors such as the drug\u2019s protein binding, metabolism, and vasoconstrictor properties, none of which are altered significantly by the addition of sodium bicarbonate. Incorrect Options: Option (B): Decreased pain on s/c injection Sodium bicarbonate can decrease the pain associated with subcutaneous (s/c) injection of local anesthetics. This is because increasing the pH of the solution reduces the acidity, making the injection less irritating to the tissues. A more neutral or slightly alkaline pH is less painful when injected, especially with acidic anesthetic solutions like lidocaine. Therefore, this is an effect seen when sodium bicarbonate is added. Option (C): Rapid onset The addition of sodium bicarbonate results in a faster onset of action of the local anesthetic. This occurs because sodium bicarbonate raises the pH of the anesthetic solution, converting more of the drug into its non-ionized, lipid-soluble form. This form can more easily cross the nerve membrane, allowing the anesthetic to take effect more quickly. Therefore, rapid onset is a well-known effect when sodium bicarbonate is added to local anesthetics. Option (D): Increase quality of block The quality of the block can be improved by adding sodium bicarbonate to local anesthetic solutions. By increasing the amount of non-ionized drug, the anesthetic is more effective at blocking nerve conduction. This typically results in a more consistent and complete block, improving the overall quality of anesthesia.",
    "correct_choice_id": 200092,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/19439801698567962/19439801698567962.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/19439801698567962/19439801698567962.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50024,
    "choices": [
      {
        "id": 200096,
        "text": "Local anesthetic systemic toxicity"
      },
      {
        "id": 200097,
        "text": "Injury of the adjuvant artery"
      },
      {
        "id": 200098,
        "text": "Injury of the bladder"
      },
      {
        "id": 200099,
        "text": "Injury of the abdominal aorta"
      }
    ],
    "text": "A 21-year-old female is requesting regional anesthesia during labor. The provider plans to perform a nerve block via the transvaginal approach. During the procedure, the patient develops arrhythmias and gets hypotensive. The patient is suffering from which of the complications of this specific procedure?",
    "unique_key": "Q1081654",
    "question_audio": null,
    "question_video": null,
    "map_id": 34261964,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) \u2022 This patient is undergoing a pudendal nerve block, and she is suffering from local anesthetic toxicity by injecting the local anesthetic in the pudendal artery. \u2022 A direct injury of the adjacent pudendal artery will not cause sudden arrhythmias. \u2022 Injury of the bladder during the pudendal nerve block is rare. An injury to the bladder will less likely cause abrupt arrhythmias. \u2022 The abdominal aorta is less likely to be injured during the pudendal nerve block.",
    "correct_choice_id": 200096,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50025,
    "choices": [
      {
        "id": 200100,
        "text": "Increased drug metabolite leading to neurotoxicity"
      },
      {
        "id": 200101,
        "text": "Blocking sodium channels and slowing conduction"
      },
      {
        "id": 200102,
        "text": "Increasing conduction through the Purkinje fibers"
      },
      {
        "id": 200103,
        "text": "Direct myocardial injury"
      }
    ],
    "text": "A 27-year-old otherwise healthy woman is being prepared for an open reduction internal fixation of a right radial fracture. A supraclavicular nerve block is performed with lidocaine by the anesthetist. Shortly afterward, she complains of anxiety and tinnitus and is noted to have a heart rate of 110/min. She soon sustains a generalized tonic-clonic seizure and ventricular tachycardia and rapidly becomes unresponsive. What is the most likely mechanism of the patient's condition?",
    "unique_key": "Q6413909",
    "question_audio": null,
    "question_video": null,
    "map_id": 34026613,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Blocking sodium channels and slowing conduction \u2022 Local anesthetic systemic toxicity (LAST) classically presents with neurological and cardiac symptoms. \u2022 Bupivacaine is often associated with LAST; however, other local anesthetics may also lead to toxicity. \u2022 Local anesthetic cardiotoxic effects occur through its sodium channel blockade in the cardiac myocytes. \u2022 Local anesthetic neurological effects occur through its sodium channel blockade in the brain. \u2022 Intravenous lipid emulsion (ILE) therapy (also known as lipid resuscitation therapy, LRT) is the current recommended treatment for local anesthetic systemic toxicity (LAST)",
    "correct_choice_id": 200101,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50026,
    "choices": [
      {
        "id": 200104,
        "text": "Order a stat potassium level"
      },
      {
        "id": 200105,
        "text": "Echocardiogram"
      },
      {
        "id": 200106,
        "text": "Electrocardiogram"
      },
      {
        "id": 200107,
        "text": "Head CT"
      }
    ],
    "text": "A 58-year-old man is about to undergo a lower extremity orthopedic surgery. He has an epidural indwelling catheter to manage his pain intraoperatively. It is also planned to leave in his epidural catheter after surgery and connect him to a patient-controlled analgesia machine to manage his pain postoperatively. During the procedure, the patient suddenly reports blurry vision, numbness and tingling around his mouth and a sense of impending doom. What is the next best step in the evaluation of this patient?",
    "unique_key": "Q8425969",
    "question_audio": null,
    "question_video": null,
    "map_id": 34941847,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Electrocardiogram \u2022 Local anesthetic systemic toxicity is a complication of any sodium channel blocker that is being injected. \u2022 Local anesthetic systemic toxicity occurs when the injection is placed into an artery or vein, or so much has been placed in the local tissue that toxic doses have been absorbed into the cardiovascular system. \u2022 Symptoms of local anesthetic systemic toxicity are tinnitus, blurred vision, dizziness, tongue parathesias, circumoral numbness, nervousness, agitation, restlessness, and muscle twitching. \u2022 High concentrations can lead to prolonged PR intervals and widened QRS complexes, and sinus/brady arrest. \u2022 When local anesthetic systemic toxicity presents in a patient, an electrocardiogram needs to be performed immediately to monitor the effects on the heart and help decide if treatment with Intralipid is necessary.",
    "correct_choice_id": 200106,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50027,
    "choices": [
      {
        "id": 200108,
        "text": "The use of a higher dose of anesthetic agent"
      },
      {
        "id": 200109,
        "text": "Premedication with an intravenous opioid such as nalbuphine"
      },
      {
        "id": 200110,
        "text": "Administration of a long-acting anesthetic agent such as bupivacaine"
      },
      {
        "id": 200111,
        "text": "Changing the position of the patient to jack-knife after only one minute of sitting"
      }
    ],
    "text": "A 31-year old primigravida, pregnant for 38 weeks, was brought to the emergency department. The patient was having labor pains for the past four hours, and her membranes had ruptured three hours ago. The clinician performed a per-vaginal examination, which revealed that her cervix was fully dilated, and the head of the fetus was at station 0. Detailed history taking showed that the patient had no history of any chronic disease or co-morbidity. Her total leukocyte count, platelet count, and coagulation profile were within the normal range. She was prepared to deliver, and saddle block anesthesia was planned as a method for labor analgesia. The duration of labor was prolonged, and the effect of analgesia wore off earlier than anticipated. What measure can be taken while performing the said neuraxial block to ensure a prolonged duration of analgesia without the added risk of narcotizing the baby?",
    "unique_key": "Q1794060",
    "question_audio": null,
    "question_video": null,
    "map_id": 34038390,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Administration of a long-acting anesthetic agent such as bupivacaine \u2022 Saddle block anesthesia has various disadvantages. Less than the desired duration of analgesia is one of them. \u2022 The use of longer-acting anesthetic agents such as bupivacaine can provide a more prolonged period of analgesia. \u2022 It a safer to use in labor as it allows a low dosage of the drug and yields a prolonged duration of analgesia without the risk of narcotizing the fetus. \u2022 This agent has been used in obstetrics with no increase in fetal or maternal morbidity and mortality. \u2022 The use of a higher dose of the anesthetic drugs may pose deteriorating effects on the fetus. \u2022 Intravenous administration of opioids can cause respiratory depression in the fetus. \u2022 Jack-knife position has no role in the duration of analgesia produced by the saddle block.",
    "correct_choice_id": 200110,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50028,
    "choices": [
      {
        "id": 200112,
        "text": "Action of lignocaine is increased in alkaline environment"
      },
      {
        "id": 200113,
        "text": "Dependent on uncharged molecules crossing the cell membrane"
      },
      {
        "id": 200114,
        "text": "Action of lignocaine is decreased in acidic environment"
      },
      {
        "id": 200115,
        "text": "Deeper block with increasing action potential frequency"
      }
    ],
    "text": "A 17-year-old female is suffering from large breast abscess. She has to be taken for incision and drainage. Due to unavailability of an anesthesiologist the surgeon decides to perform the procedure under local infiltration. After routine investigation and adequate preoperative fasting, the patient is taken up for surgery. The surgeon aspirates 15 ml of 2 % lignocaine for anesthesia and infiltrates the abscess all around the margins and the apex of the abscess as well. After waiting for 5 mins for the action of lignocaine to take effect he takes a stab knife and takes the incision. Immediately the patient winces in pain and becomes hypertensive and tachycardiac. Which ONE of the following statements best describes this local anaesthetic activity?",
    "unique_key": "Q6419445",
    "question_audio": null,
    "question_video": null,
    "map_id": 34446390,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Action of lignocaine is decreased in acidic environment \u2022 Local anesthetics act by inhibition of impulse transmission by blocking the sodium channels on the nerve membrane \u2022 The site of action of local anesthetic molecule is the inactivation gate which lies intracellularly \u2022 So for the onset of action the local anesthetic molecule has to be in an unionized form \u2022 All local anesthetic molecules are weak bases which are unionized in a basic medium and ionized in an acidic medium \u2022 Any area of inflammation eg an abscess cavity is highly acidic in nature and so the efficacy of local anesthesia will be decreased \u2022 Therefore one cannot perform a local infiltration anesthesia in an inflamed tissue.",
    "correct_choice_id": 200114,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50029,
    "choices": [
      {
        "id": 200116,
        "text": "Hypovolemia leading to hypotension and bradycardia"
      },
      {
        "id": 200117,
        "text": "High levels of block causing confusion and restlessness"
      },
      {
        "id": 200118,
        "text": "Intravascular injection of bupivacaine leading to local anesthetic systemic toxicity"
      },
      {
        "id": 200119,
        "text": "Intrathecal placement of the drug causing total spinal anesthesia"
      }
    ],
    "text": "A 30 years old, pregnant women weighing 65 kgs at term comes for a continuous lumbar epidural for labour analgesia. After through pre procedure workup the patient is taken up for the procedure. lumbar epidural catheter is inserted at L2-L3 level and fixed keeping 4 cms of catheter in epidural space. The anesthesiologist did not feel the need to check and confirm the correct position of the catheter. Soon after this he injected 20 mls of 0.5% Bupivacaine over 30 seconds without aspiration. 5 mins later the patient suddenly complained of restlessness, confusion and a feeling of impending doom which was soon followed by hypotension and bradycardia on ECG along with arrythmias. Which of the following statements best describes this situation?",
    "unique_key": "Q3616096",
    "question_audio": null,
    "question_video": null,
    "map_id": 34274405,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Confirmation of correct placement of the epidural catheter: \u2022 An epidural catheter can be misplaced either in intrathecal space ( sub arachnoid placement) or in an epidural vessel ( vascular placement) \u2022 To confirm the correct position of the catheter we use an epidural test dose which is 3 ml of 1.5 % lignocaine + adrenaline to be injected through the epidural catheter \u2022 In case of vascular placement of the catheter there will be sudden rise in heart rate and blood pressure due to adrenaline causing systemic effects \u2022 In case of intrathecal catheter there will be motor and sensory block in lower limb just like spinal. \u2022 Since in this case the anesthesiologist didn\u2019t confirm the position so the catheter can be in either of the places. \u2022 The history given is suggestive of vascular placement as the patient didn\u2019t complain of sensory loss in the limbs and also development of confusion and then quickly development of bradycardia and arrythmias suggest cardiovascular toxicity of bupivacaine.",
    "correct_choice_id": 200118,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50030,
    "choices": [
      {
        "id": 200120,
        "text": "Follow the ACLS guidelines"
      },
      {
        "id": 200121,
        "text": "Give 10 mg of lorazepam"
      },
      {
        "id": 200122,
        "text": "Secure the airway."
      },
      {
        "id": 200123,
        "text": "Give an initial intravenous bolus injection of 20 % lipid emulsion 1.5 mL/kg over 1 min."
      }
    ],
    "text": "A frail 75-year-old woman was brought to emergency with a Colle\u2019s fracture of the left wrist. A junior orthopaedic trainee manipulated the wrist using intravenous regional anaesthesia (Bier\u2019s block) with 30 mL of 0.25 % levobupivacaine. Shortly after the cuff was deflated, the patient had symptoms of confusion, seizure, and hypotension, without cardiorespiratory arrest. The most appropriate next step in the management would be:",
    "unique_key": "Q3379746",
    "question_audio": null,
    "question_video": null,
    "map_id": 34962166,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) This lady has Local Anaesthetic Systemic Toxicity (LAST) without cardiorespiratory arrest, as the local anaesthetic used was levo-bupivacaine rather than prilocaine, which is advised for Bier\u2019s block as is less cardiotoxic. This is a form of CNS toxicity due to release of large amounts of local anesthetic in systemic circulation after release of tourniquet in bier\u2019s block. Signs of severe toxicity include: \u2022 Sudden alteration in mental status, severe agitation, or loss of consciousness, with or without tonic-clonic convulsions. \u2022 Cardiovascular collapse: sinus bradycardia, conduction blocks, asystole, and ventricular tachyarrhythmias \u2022 Local anaesthetic (LA) toxicity may occur sometime after an initial injection. Immediate management steps are: Stop injecting the LA. 1. Call for help. 2. Maintain the airway and, if necessary, secure it with a tracheal tube. 3. Give 100 % oxygen and ensure adequate lung ventilation (hyperventilation may help by increasing plasma pH in the presence of metabolic acidosis). 4. Confirm or establish intravenous access. 5. Control seizures: give a benzodiazepine, thiopental, or propofol in small incremental doses. Assess cardiovascular status throughout. 6. Consider drawing blood for analysis, but do not delay definitive treatment to do this. Without circulatory arrest Use conventional therapies to treat: \u2022 Hypotension \u2022 Bradycardia \u2022 Tachyarrhythmia. \u2022 Use of intralipid is done in the management of cardiovascular toxicity associated with LAST.",
    "correct_choice_id": 200122,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50031,
    "choices": [
      {
        "id": 200124,
        "text": "Local anesthetic toxicity"
      },
      {
        "id": 200125,
        "text": "Pulmonary embolism"
      },
      {
        "id": 200126,
        "text": "Pneumothorax"
      },
      {
        "id": 200127,
        "text": "Myocardial infarction"
      }
    ],
    "text": "A 49-year-old woman is undergoing interscalene block for shoulder arthroscopy. The anesthesiologist uses a landmark based technique to give the block. After placement of needle and injection of the drug she suddenly complains of ringing in her ears, numbness around the mouth, and becomes tachypneic and tachycardic. What is the most likely cause of her symptoms?",
    "unique_key": "Q3203159",
    "question_audio": null,
    "question_video": null,
    "map_id": 34521436,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Local anesthetic toxicity \u2022 Early signs of local anesthetic systemic toxicity include periorbital numbness, tinnitus, tachycardia, hypertension. \u2022 It's important to be able to diagnose local anesthetic anesthesia quickly as it can quickly cause myocardial collapse and death. \u2022 Treatment of local anesthetic toxicity is supportive with lipid emulsion. \u2022 Pulmonary embolism is unlikely given patients other symptoms but should be included on the differential",
    "correct_choice_id": 200124,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50032,
    "choices": [
      {
        "id": 200128,
        "text": "Administration of intravenous protamine sulfate"
      },
      {
        "id": 200129,
        "text": "Administration of intravenous ondansetron"
      },
      {
        "id": 200130,
        "text": "Administration of intravenous ephedrine"
      },
      {
        "id": 200131,
        "text": "Administration of intravenous lidocaine"
      }
    ],
    "text": "A 30-year-old pregnant woman at term is undergoing induction of labor. An epidural catheter has just been placed for pain management, and a bolus of bupivacaine has been given. The patient complains of nausea ,10 minutes after the administration of the anesthetic. What is the most appropriate step in the management of this patient?",
    "unique_key": "Q1621945",
    "question_audio": null,
    "question_video": null,
    "map_id": 34280651,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Administration of intravenous ephedrine \u2022 Local anesthetics, when injected through an epidural, may cause hypotension and increased peristalsis. \u2022 In this scenario, the patient presents with nausea 10 minutes after bolus dose of local anesthetic. One may assume her symptoms could also be due to hypotension. \u2022 Usually, after epidural injections of local anesthetics, patients may present hypotension due to loss of vascular tone. The compensatory reaction would be tachycardia. \u2022 Hypotension usually leads to decreased cerebral perfusion that manifests as nausea and vomiting. \u2022 If this is the case, a medication that directly increases the vascular tone is indicated eg ephedrine \u2022 Protamine sulfate antagonizes the effects of heparin. It is specifically administered during the clinical scenario of heparin and low molecular weight heparin overdose. Moreover, it might be indicated in cases demanding reversal of anticoagulant effects during delivery and heart surgery. Ondansetron is indicated to prevent nausea and vomiting specifically during chemotherapy and radiation.",
    "correct_choice_id": 200130,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50033,
    "choices": [
      {
        "id": 200132,
        "text": "sodium bicarbonate"
      },
      {
        "id": 200133,
        "text": "IV calcium gluconate"
      },
      {
        "id": 200134,
        "text": "Intralipid solution"
      },
      {
        "id": 200135,
        "text": "Dopamine infusion"
      }
    ],
    "text": "A patient underwent cardiovascular collapse following a regional anesthetic block with bupivacaine, what would be the immediate management?",
    "unique_key": "Q1049120",
    "question_audio": null,
    "question_video": null,
    "map_id": 34857927,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Bupivacaine is the most cardiotoxic local anesthetic and since we have given large dose it will cause a complication known as local anesthetic systemic toxicity (LAST).when blood concentration of local anesthetic agent reaches beyond a certain unit, then it causes systemic toxicity k/a LAST.Treatment. for bupivacaine induced cardio toxicity is 20% Intralipid solution which increases rate of recovery of blocked Na+ Channels on cardiac myocyte.<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/6(569).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200134,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/53439481698572692/53439481698572692.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/53439481698572692/53439481698572692.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50034,
    "choices": [
      {
        "id": 200136,
        "text": "Decreasing K efflux"
      },
      {
        "id": 200137,
        "text": "Decreasing Ca efflux"
      },
      {
        "id": 200138,
        "text": "Altering RMP of cell"
      },
      {
        "id": 200139,
        "text": "Binding to sodium channels and causing their inactivation"
      }
    ],
    "text": "Mechanism of Action of local anaesthetics is?",
    "unique_key": "Q4688226",
    "question_audio": null,
    "question_video": null,
    "map_id": 34721802,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Option A,B-local anaesthetics do not Decreasing K or Ca efflux. Option C-RMP of cell is not changed on giving -local anaesthetics. Option D-local anaesthetics Binds to sodium channels, causing their inactivation.As a result,nerve won't be depolarised and hence,Patient won't feel the pain.",
    "correct_choice_id": 200139,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/2027841704707200/2027841704707200.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/2027841704707200/2027841704707200.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50035,
    "choices": [
      {
        "id": 200140,
        "text": "Local anaesthetic systemic toxicity"
      },
      {
        "id": 200141,
        "text": "Pulseless electrical activity"
      },
      {
        "id": 200142,
        "text": "Electrocution"
      },
      {
        "id": 200143,
        "text": "Asphyxia due to drowning"
      }
    ],
    "text": "20 % Intralipid bolus was administered during resuscitation. Why?",
    "unique_key": "Q1721972",
    "question_audio": null,
    "question_video": null,
    "map_id": 34480912,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Treatment of local anesthetic systemic toxicity [LAST]: LATE & GRAVE TOXICITY due to local anesthetics is cardio toxicity. \u2022 Most cardiotoxic LA - BUPIVACAINE [highly lipid soluble- doesn't dissociate from Na+ channels]. \u2022 Drug of choice for LAST is infusion of 20% INTRALIPID solution: bolus dose : 1.5 ml/kg followed by infusion of 0.25 ml \\kg\\min \u2022 Mechanism: it increases the rate of recovery of blocked sodium channels by decreasing cardiac bupivacaine concentration. \u2022 No other antiarrhythmic is useful. \u2022 Use of lignocaine is not recommended. \u2022 2 drugs useful are adrenaline and amiodarone as per ACLS guidelines for the management of cardiac arrest \u2022 Later in severe cases, extracorporeal membrane oxygenation (ECMO) can be used.",
    "correct_choice_id": 200140,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/11984251704707282/11984251704707282.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/11984251704707282/11984251704707282.m3u8",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '07  Local Anaesthetics';
        const quizFilename = '07-local-anaesthetics-7459aa81.html';
        let hierarchy = ["DAMS", "DQB", "Anesthesia"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on navigation
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>