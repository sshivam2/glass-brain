<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anaesthesia Test Ii - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2018 - 19
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 25-year-old woman was taken up for Cesarean section. Spinal anesthesia was given and the patient went into hypotension. Which of the following would be the vasopressor of choice for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Dopamine"
      },
      {
        "id": 2,
        "text": "Vasopressin"
      },
      {
        "id": 3,
        "text": "Ephedrine"
      },
      {
        "id": 4,
        "text": "Phenylephrine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Phenylephrine </strong>is the <strong>vasopressor of choice</strong> in pregnant patients developing hypotension following neuraxial anesthesia (spinal and epidural).</p>\n<p>Phenylephrine is preferred because besides effectively controlling hypotension, it has <strong>less placental transfer</strong> and <strong>lesser </strong>chances of<strong> fetal acidosis </strong>than ephedrine.</p>\n<p>The patient should receive an adequate intravenous fluid bolus of crystalloid like Ringer lactate solution (typically 1000\u20131500 mL) or colloid (typically 250\u2013500 mL) solution at the time of neural blockade to avoid hypotension. On developing hypotension even after adequate fluid management, vasopressors are administered for the further management.</p>\n<p>After the administration of the spinal anesthetic injection, the patient is placed supine with left uterine displacement (to prevent aortocaval compression) and supplemental oxygen (40\u201350%) is given.</p>\n<p>Blood pressure should be monitored every 1\u20132 min until it stabilizes.</p>\n<p>Hypotension following epidural anesthesia typically has a slower onset.</p>\n<p>Other options:</p>\n<p>Option A-<strong> Dopamine</strong>\u00a0is not used\u00a0in pregnant women developing hypotension because it lowers the\u00a0<strong>pO2 levels in umbilical vessels.</strong>\u00a0</p>\n<p>Option B- <strong>Vasopressin</strong> is reserved for <strong>circulatory collapse</strong> or patients who do not respond to volume infusion and catecholamines. Hence, it is not preferred here.</p>\n<p>Option C- <strong>Ephedrine</strong> has more placental transfer and there is a higher risk of <strong>fetal acidosis</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Muscle relaxant to be avoided in a hypertensive patient?",
    "choices": [
      {
        "id": 1,
        "text": "Pancuronium"
      },
      {
        "id": 2,
        "text": "Rocuronium"
      },
      {
        "id": 3,
        "text": "Vecuronium"
      },
      {
        "id": 4,
        "text": "Atracurium"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Pancuronium is avoided in hypertensive patients because it causes <strong>vagal blockade and sympathetic stimulation.</strong></li>\n<li>Sympathetic stimulation is due to ganglionic stimulation, neural release of catecholamines and inhibition of reuptake of catecholamines. Hence It can aggravate hypertension.</li>\n<li>But when it is used in small increments slowly, it doesn&rsquo;t produce significant changes in heart rate and blood pressure.</li>\n<li>For the same reason, it is to be <strong>cautiously used in patients with coronary artery disease, hypertrophic cardiomyopathy and aortic stenosis.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Normal hospital pipeline supply of air is?",
    "choices": [
      {
        "id": 1,
        "text": "50 psig"
      },
      {
        "id": 2,
        "text": "100 psig"
      },
      {
        "id": 3,
        "text": "500 psig"
      },
      {
        "id": 4,
        "text": "2000 psig"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Normal hospital pipeline supply pressure of all gases is at 50-55 psig</li>\n<li>But the Maximum pressure in the E-cylinders:\n<ul>\n<li>750 psig for nitrous oxide</li>\n<li>2000 psig for air</li>\n<li>2000 psig for oxygen</li>\n</ul>\n</li>\n<li>Since these pressures are much higher than the hospital pipeline supply pressure, each cylinder is pass&eacute;d through a high pressure regulator, which reduces the high pressures inside the cylinder to a lower, nearly constant pressure of 45 psig which is suitable for use in the anesthesia machine.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/1fbab817a4d5482d8090763062254c77x743x512.PNG"
    ]
  },
  {
    "text": "False statement about nausea and vomiting associated with neuraxial blockade is",
    "choices": [
      {
        "id": 1,
        "text": "Hyopotension following spinal anesthesia is a cause"
      },
      {
        "id": 2,
        "text": "Adding epinephrine to local anesthetic predisposes"
      },
      {
        "id": 3,
        "text": "Atropine may be effective in treatment"
      },
      {
        "id": 4,
        "text": "Among intrathecal opioids, morphine has the least incidence of nausea and vomiting"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Among the opioids commonly added to intrathecal or epidural local anesthetics, <strong>morphine</strong> administration has the <strong>most risk of nausea and vomiting&nbsp;</strong>whereas fentanyl&nbsp; and sufentanil carry the least frequent risk.</p>\n<p>Possible <strong>mechanisms</strong> that <strong>contribute to nausea and vomiting </strong>in the setting of neuraxial anesthesia:&nbsp;</p>\n<ul>\n<li>Direct exposure of the chemoreceptive trigger zone in the brain to emetogenic drugs (e.g., opioids)</li>\n<li>Hypotension associated with generalized vasodilation</li>\n<li>Gastrointestinal hyperperistalsis secondary to unopposed parasympathetic activity</li>\n</ul>\n<p>Factors associated with developing nausea or vomiting after spinal anesthesia include:</p>\n<ul>\n<li>Addition of phenylephrine or epinephrine to local anesthetics</li>\n<li>Peak block height greater than or equal to T5</li>\n<li>Baseline heart rate greater than 60 beats/min</li>\n<li>Use of procaine</li>\n<li>History of motion sickness</li>\n</ul>\n<p>Atropine is effective in treating nausea associated with high (T5) subarachnoid anesthesia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child was in the postoperative ward following a tonsillectomy. Pain needs to be assessed and the Children's Hospital of Eastern Ontario Pain Scale (CHEOPS) for rating postoperative pain was used. It includes all of the following, except _____.",
    "choices": [
      {
        "id": 1,
        "text": "Cry"
      },
      {
        "id": 2,
        "text": "Touch"
      },
      {
        "id": 3,
        "text": "Torso"
      },
      {
        "id": 4,
        "text": "Oxygen saturation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>Children's Hospital of Eastern Ontario Pain Scale</strong> (CHEOPS) includes all the options, except oxygen saturation.</p>\n<p>CHEOPS is a behavioral scale used to measure <strong>postoperative pain</strong> in young children. It helps in assessing the effectiveness of interventions to reduce pain and discomfort.</p>\n<p>It measures <strong>crying, facial expression, body position</strong> (torso), <strong>verbal expression, touch position,</strong> and <strong>leg position.</strong></p>\n<p>Other pain assessment scales in children include:</p>\n<ul>\n<li>Oucher face scale</li>\n<li>Visual analog scale (VAS)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "When carbon dioxide absorbing capacity of soda lime is exhausted, it changes color to  ___________",
    "choices": [
      {
        "id": 1,
        "text": "Pink"
      },
      {
        "id": 2,
        "text": "Yellow"
      },
      {
        "id": 3,
        "text": "Colourless"
      },
      {
        "id": 4,
        "text": "Purple"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>When carbon dioxide absorbing capacity of soda lime&nbsp;is exhausted, color changes from&nbsp;<strong>white to purple&nbsp;</strong>because of ethyl violet indicator.</p>\n<p>Ethyl violet is the most commonly used indicator, hence the answer is purple.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following capnographic waveform is suggestive of:",
    "choices": [
      {
        "id": 1,
        "text": "Malignant hyperthermia"
      },
      {
        "id": 2,
        "text": "Bronchospasm"
      },
      {
        "id": 3,
        "text": "Rebreathing"
      },
      {
        "id": 4,
        "text": "Accidental extubation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given capnographic waveform is suggestive of <strong>bronchospasm</strong>.</p>\n<p><strong>Capnography</strong> refers to the method of <strong>CO2</strong> measurement as a function of time or volume. <strong>Bronchospasms</strong> may be due to respiratory pathologies like <strong>asthma, chronic obstructive</strong> pulmonary disease (COPD), or <strong>acute lung injury.</strong> Another cause of this waveform is a <strong>partially obstructed endotracheal</strong> tube or breathing circuit. Capnographic changes in bronchospasm include:</p>\n<ul>\n<li>Loss of verticality of Phase II</li>\n<li>The opening of the angle between phases 2 and 3 (\u03b1 angle)</li>\n<li>Increased upslope of phase III</li>\n<li>No plateau before the next inspiration</li>\n<li><strong>Shark fin</strong> appearance - in severe cases</li>\n</ul>\n<p>\u00a0Normal capnography is shown in the image below:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fe66ce83cf0f49da855b5fec4985dce1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8341e8c2b6024c32aadcc20933fd2adex1280x1075.JPEG"
    ]
  },
  {
    "text": "A 70 kg athlete was posted for surgery and he was administered succinylcholine due to unavailability of vecuronium. It was administered in intermittent dosing (total 640 mg). During recovery, the patient was not able to respire spontaneously & move limbs. What is the reason for the same?",
    "choices": [
      {
        "id": 1,
        "text": "Muscular weakness due to fasciculation produced by succinylcholine"
      },
      {
        "id": 2,
        "text": "Undiagnosed muscular dystrophy and muscular weakness"
      },
      {
        "id": 3,
        "text": "Phase II blockade produced by succinyl choline"
      },
      {
        "id": 4,
        "text": "Pseudocholinesterase deficiency increasing action of succinylcholine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>The best answer to the above case scenario is <strong>phase II&nbsp;blockade</strong> produced by <strong>succinylcholine.</strong></p>\n<p><strong>Phase II block</strong>&nbsp;is clinically seen with the dose&nbsp;<strong>&gt;5 mg/kg.</strong></p>\n<p>Mechanism of action of succinylcholine:</p>\n<ul>\n<li><strong>Phase I block:</strong>&nbsp;continuous endplate depolarization and subsequent muscle relaxation.</li>\n<li><strong>Phase II block:</strong>&nbsp;seen with a large single dose, repeated doses, or a continuous infusion which can lead to desensitization of the receptors resulting in a prolonged neuromuscular blockade.</li>\n</ul>\n<p>Causes of prolonged apnea include:</p>\n<ul>\n<li>Atypical/pseudocholinesterase deficiency - can result in apnea even with a normal dose of succinylcholine</li>\n<li>The altered response of endplate to depolarizing relaxant (myasthenia gravis)</li>\n<li>Accumulation of succinylcholine leading to phase II blockade</li>\n</ul>\n<p>Although options B, C, and D can lead to prolonged apnea, in the above case scenario, the patient has received ~9mg/kg of succinylcholine. Hence the most probable diagnosis is phase II blockade leading to prolonged apnea.</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "True regarding succinyl choline are all except",
    "choices": [
      {
        "id": 1,
        "text": "Produces both phase I and phase II block"
      },
      {
        "id": 2,
        "text": "Rise in intracranial pressure seen"
      },
      {
        "id": 3,
        "text": "The rise in intracranial  pressure can be blocked by vecuronium"
      },
      {
        "id": 4,
        "text": "Non \u2013 depolarizing muscle relaxant"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>Succinyl choline is a <strong>depolarizing</strong> muscle relaxant</li>\n<li>It produces both phase I and phase II( which resembles non-depolarizing neuromuscular block)</li>\n<li>Succinylcholine can produce a rise in intracranial pressure as a result of cerebral activation and increased cerebral blood flow. This is because muscle fasciculations produced by succinyl choline leads to activation of muscle spindle which subsequently increase cerebral activity.</li>\n<li><strong>This increase in ICP is blocked by paralysis with a non-depolarising muscle relaxant&nbsp;&nbsp; like vecuronium </strong>and administering intravenous lidocaine (1.5&ndash;2.0 mg/kg) 2&ndash;3 min prior to intubation.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following are indications of mechanical ventilation except?",
    "choices": [
      {
        "id": 1,
        "text": "Arterial oxygen tension <50 mm Hg"
      },
      {
        "id": 2,
        "text": "Arterial CO2 tension < 50 mm Hg"
      },
      {
        "id": 3,
        "text": "Tidal volume < 5 ml/kg"
      },
      {
        "id": 4,
        "text": "Vital capacity < 15 ml/kg"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Arterial CO<sub>2</sub> tension &lt; 50 mm Hg is not a indication for mechanical indication.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Order of susceptibility of nerve fibers to local anesthetics is as follows",
    "choices": [
      {
        "id": 1,
        "text": "A\u03b1 > A\u03b2 > B >C"
      },
      {
        "id": 2,
        "text": "A\u03b2 > B > A\u03b1 >C"
      },
      {
        "id": 3,
        "text": "C > B > A\u03b2 >A\u03b1"
      },
      {
        "id": 4,
        "text": "B>A\u03b3>A\u03b4>C"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Order of susceptibility of nerve fibers to local anesthetics:&nbsp;<strong>B &gt;</strong>&nbsp;<strong>A gamma&gt; A delta&gt; A alpha=Abeta&gt;C</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Antihypertensive agents that is to be discontinued 24-48hrs prior to surgery",
    "choices": [
      {
        "id": 1,
        "text": "Calcium channel blocker"
      },
      {
        "id": 2,
        "text": "Centrally acting sympathomimetics"
      },
      {
        "id": 3,
        "text": "Beta blocker"
      },
      {
        "id": 4,
        "text": "ACE inhibitor"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>Antihypertensive agents that is to be discontinued 24-48hrs prior to surgery is ACE inhibitor.</li>\n<li>There is a risk that hemodynamic instability and hypotension will occur during anesthesia in patients receiving ACE inhibitors.</li>\n<li>Three systems exist to maintain normal blood pressure:\n<ul>\n<li>Autonomic system</li>\n<li>RAAS system</li>\n<li>Vasopressin system</li>\n</ul>\n</li>\n<li>Following blunting of autonomic responses by induction of anesthesia and blunting of the renin-angiotensin-aldosterone system by an ACE inhibitor, the only remaining system to support blood pressure is the vasopressin system, and so blood pressure is likely to be volume dependent.</li>\n<li>ACE inhibitors may also decrease cardiac output by attenuating the venoconstrictor effect of angiotensin on capacitance vessels. This will result in a decrease in venous return. Maintenance of intravascular fluid volume is crucial during surgery in patients on long-term treatment with these drugs.</li>\n<li>Surgical procedures involving major fluid shifts have been associated with refractory hypotension in patients being treated with ACE inhibitors.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 8-year old child is brought to the casualty in respiratory distress. In order to intubate this child, which is the appropriate size of endotracheal tube to be used?",
    "choices": [
      {
        "id": 1,
        "text": "5 mm"
      },
      {
        "id": 2,
        "text": "6 mm"
      },
      {
        "id": 3,
        "text": "6 cm"
      },
      {
        "id": 4,
        "text": "5 cm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The appropriate size of the endotracheal tube for a child is chosen by the <strong>formula:</strong>&nbsp;<strong>4 + age/4</strong>.</p>\n<p>&nbsp;</p>\n<p>So the correct sized tube for this child would be 6 mm.</p>\n<ul>\n<li>Size of an endotracheal tube usually refers to the <strong>internal diameter in mm</strong>. Rarely&nbsp; the French scale is used where the size corresponds to the external diameter multiplied by 3.</li>\n</ul>\n<ul>\n<li>For adults, usually a 7-mm is used for women and an 8-mm ETT is used for men.</li>\n</ul>\n<table style=\"height: 81px; width: 376.8px;\">\n<tbody>\n<tr style=\"height: 13.2px;\">\n<td style=\"width: 84px; height: 13.2px;\"><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Age</strong></td>\n<td style=\"width: 156px; height: 13.2px;\"><strong>&nbsp; Internal Diameter (mm)</strong></td>\n<td style=\"width: 119.8px; height: 13.2px;\"><strong>&nbsp; &nbsp; &nbsp; &nbsp;Length (cm)</strong></td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 84px; height: 13px;\">Full-term infant</td>\n<td style=\"width: 156px; height: 13px;\">3.5</td>\n<td style=\"width: 119.8px; height: 13px;\">12</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 84px; height: 13px;\">Child</td>\n<td style=\"width: 156px; height: 13px;\">4 &nbsp;+ Age/4</td>\n<td style=\"width: 119.8px; height: 13px;\">14 + Age/2</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 84px; height: 13px;\">Adult Female</td>\n<td style=\"width: 156px; height: 13px;\">7.0&ndash;7.5</td>\n<td style=\"width: 119.8px; height: 13px;\">21 (average)</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 84px; height: 13px;\">Male</td>\n<td style=\"width: 156px; height: 13px;\">7.5&ndash;9.0</td>\n<td style=\"width: 119.8px; height: 13px;\">23 (average)</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>Besides age, choice of an endotracheal tube also depends on the presence of airway pathologies and the reason behind placement of the tube.</li>\n<li>Smaller sized tubes lead to increase airway resistance and increased work of breathing.</li>\n<li>Larger tubes have higher risk of laryngeal and tracheal trauma and sore throat.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Dead space is increased in all except:",
    "choices": [
      {
        "id": 1,
        "text": "Anticholinergic drugs"
      },
      {
        "id": 2,
        "text": "Artificial airway"
      },
      {
        "id": 3,
        "text": "Standing"
      },
      {
        "id": 4,
        "text": "Hyperextension of neck"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Dead space</strong> is<strong> increased in all except artificial airway.&nbsp;</strong>Dead space is the <strong>volume</strong> of a breath that does <strong>not participate in gas exchange</strong>. It is <strong>ventilation without perfusion.</strong></p>\n<ul>\n<li>Total dead space (<strong>Physiological dead space</strong>) = Anatomical dead space+ alveolar dead space.</li>\n<li><strong>Anatomical dead space</strong> is the area in the tracheobronchial tree where the gaseous exchange between the lung and capillaries doesn&rsquo;t take place.&nbsp;It includes nasal cavity, larynx, trachea, bronchi, end of the terminal bronchiole.</li>\n<li><strong>Alveolar dead space</strong> is the volume of gas within unperfused alveoli (and thus not participating in gas exchange either)</li>\n</ul>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p><strong>Factors affecting dead space:</strong></p>\n<ul>\n<li>Posture:</li>\n</ul>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Upright -&nbsp;Increase</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Supine -&nbsp;Decrease</p>\n<ul>\n<li>Position of Airway:</li>\n</ul>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Neck Extension -&nbsp;Increase</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Neck Flexion - Decrease</p>\n<ul>\n<li>Others:</li>\n</ul>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; Age - Increase</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; Artificial airway - Decrease</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; Positive pressure ventilation - Increase</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; Drug anti-cholinergic - Increase</p>\n<ul>\n<li>Pulmonary perfusion:</li>\n</ul>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; Pulmonary embolism -&nbsp;Increase</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; Hypotension -&nbsp;Increase</p>\n<ul>\n<li>Pulmonary vascular disease:</li>\n</ul>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; Emphysema -&nbsp;Increase</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following anaesthetic should be avoided in acute porphyria?",
    "choices": [
      {
        "id": 1,
        "text": "Midazolam"
      },
      {
        "id": 2,
        "text": "Thiopentone"
      },
      {
        "id": 3,
        "text": "Prilocaine"
      },
      {
        "id": 4,
        "text": "Morphine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Thiopentone is the&nbsp;anaesthetic that should be avoided in acute porphyria.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is posted for posterior fossa decompression surgery. What is your inhalation anesthetic of choice?",
    "choices": [
      {
        "id": 1,
        "text": "Isoflurane"
      },
      {
        "id": 2,
        "text": "Nitrous oxide"
      },
      {
        "id": 3,
        "text": "Ether"
      },
      {
        "id": 4,
        "text": "Halothane"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Among the given options, isoflurane is best suited for neurosurgery.</li>\n<li>All of the <strong>inhalational anesthetics are cerebral vasodilators</strong>. The order of vasodilating potency is halothane &rarr; enflurane&rarr; desflurane &rarr; <strong>isoflurane </strong>&rarr; sevoflurane.</li>\n<li>Though isoflurane increases cerebral blood flow and intracranial pressure these effects are&nbsp; less pronounced than with halothane ,nitrous oxide and ether.</li>\n<li>Though inhalational anesthetics are used in neuroanesthesia, if the intracranial pressure is persistently raised, they should be replaced with intravenous agents.</li>\n<li>Earlier, it had been believed that isoflurane is cerebroprotective in the presence of ischemia, but now no such evidence of cerebral protection has been documented and there is no difference among the inhaled anesthetics in this respect.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "True statement regarding hypothermia during anaesthesia is",
    "choices": [
      {
        "id": 1,
        "text": "Occur irrespective of the type of anesthesia"
      },
      {
        "id": 2,
        "text": "Conduction is the primary means by which body loses heat"
      },
      {
        "id": 3,
        "text": "Prevented by giving warm fluids"
      },
      {
        "id": 4,
        "text": "It is always beneficial to the patient"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>True statement regarding hypothermia during anaesthesia is it occurs&nbsp;irrespective of the type of the type of anesthesia.</p>\n<p>During GA shivering is abolished by suppression of hypothalamus.</p>\n<ul>\n<li>Hypothermia is protective during cerebral or cardiac ischemia and it is used in neurosurgery, cardiac surgery, carotid artery surgery / prolonged surgeries, where tissue ischemia is anticipated, in <strong>recovery after cardiac arrest and for neonatal asphyxia.</strong></li>\n<li>As <strong>hypothermia is arrythmogenic it is C/I in arrhythmia.</strong></li>\n<li><strong>Hypothermia during anesthesia occur in nearly every patient during both general and regional (spinal/epidural) anesthesia, </strong>unless steps are taken to prevent this complication.</li>\n<li>Body loses heat mainly by internal re-distribution and radiation.</li>\n<li>It is <strong>beneficial (in ischemia) </strong>as well as <strong>deleterious </strong>(coagulopathy, cardiac arrhythmia, wound infection etc.) to patients.</li>\n<li>It can <strong>be prevented by giving warm fluids only if large amounts of IV fluids are to be administered.</strong> However, <strong>patients cannot be warmed by using heated fluids </strong>because the fluid cannot (much) exceed body temperature.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During a laser vocal cord surgery there is a fire break out. What is not to be done?",
    "choices": [
      {
        "id": 1,
        "text": "100% oxygen after discontinuing anesthetic gases"
      },
      {
        "id": 2,
        "text": "Pouring sterile water"
      },
      {
        "id": 3,
        "text": "Removing endotracheal tube"
      },
      {
        "id": 4,
        "text": "Treatment with steroid and antibiotics"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>If there is a fire break out during laser vocal cord surgery, oxygen should be turned off, ventilation should be stopped, endotracheal tube removed and submerged in water and patient should be ventilated with facemask. At a later stage bronchoscopy done to assess airway damage, bronchial lavage. Steroids can be used for treatment.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "TRUE statement concerning etomidate is",
    "choices": [
      {
        "id": 1,
        "text": "Reduces postoperative nausea and vomiting"
      },
      {
        "id": 2,
        "text": "Has been used to treat hypercortisolemia"
      },
      {
        "id": 3,
        "text": "Contraindicated in coronary artery disease"
      },
      {
        "id": 4,
        "text": "To be avoided in neurosurgical procedures due to risk of raised intracranial pressure"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>Etomidate can be used in the<strong> treatment of endogenous hypercortisolemia</strong>. This is due to its ability to inhibit the enzyme 11&beta;-hydroxylase, which results in decreased biosynthesis of cortisol.</li>\n<li>Etomidate has the highest incidence of Postoperative nausea and vomiting.</li>\n<li>Etomidate can be safely used in neurosurgical procedures such as giant aneurysm clipping. It is also the anesthetic induction agent of choice to reduce increased ICP when maintenance of cerebral or coronary perfusion pressure is important.</li>\n<li>Of all induction agents, etomidate is the most cardiac stable induction agent and is the agent of choice in <strong>CORONARY ARTERY DISEASE,</strong> cardiomyopathy, cerebral vascular disease or hypovolemia.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In Damage Control resuscitation (DCR), the ratio of RBCs, fresh frozen plasma and platelets is of the order:",
    "choices": [
      {
        "id": 1,
        "text": "4:2:1"
      },
      {
        "id": 2,
        "text": "1:2:4"
      },
      {
        "id": 3,
        "text": "2:1:2"
      },
      {
        "id": 4,
        "text": "1:1:1"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>In <strong>DCR</strong>, the ratio of <strong>RBC: FFP: Platelets</strong> is <strong>1:1:1</strong>.</li>\n<li>Administering blood products in the appropriate ratios in order to facilitate resuscitation from trauma and avert trauma induced coagulopathy is termed Damage Control Resuscitation (DCR).</li>\n<li>Red blood cell component will improve oxygen delivery to ischemic tissues.</li>\n<li>Fresh frozen plasma improves clotting by providing clotting factors V and VIII and fibrinogen.</li>\n<li>Platelet transfusion is required if the platelet count is below 50,000 / high power field, significant blood loss or prolonged resuscitation.</li>\n<li>Though the current hemostatic resuscitation ratio is 1:1:1, use of less fresh frozen plasma and more of antifibrinolytics is advocated by some experts.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is undergoing pulmonary artery catheterization. While introducing Swan-Ganz catheter, its placement in the pulmonary artery is characterized by which of the following pressure tracing?",
    "choices": [
      {
        "id": 1,
        "text": "Sudden decrease in diastolic pressure"
      },
      {
        "id": 2,
        "text": "Sudden increase in diastolic pressure"
      },
      {
        "id": 3,
        "text": "Sudden increase in systolic pressure"
      },
      {
        "id": 4,
        "text": "Sudden decrease in systolic pressure"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Placement of the Swan-Ganz catheter in the pulmonary artery is characterized by a&nbsp;<strong>sudden increase&nbsp;</strong>in&nbsp;<strong>diastolic pressure&nbsp;</strong>and a change in&nbsp;<strong>waveform morphology.&nbsp;</strong>Diastolic pressure initially is higher than that in the right ventricle(RV).</p>\n<p>Pulmonary artery catheterization is used to assess hemodynamic variables in sick patients undergoing major surgery. It is used to measure</p>\n<ul>\n<li><strong>Pulmonary capillary wedge pressure</strong> (PCWP). In the presence of mitral valve pathology or a previous transplant, trans-septal left atrial catheterization is done.</li>\n<li><strong>Left ventricular end-diastolic pressure</strong> (LVEDP)</li>\n<li>Ventricular volume.</li>\n<li>Cardiac output</li>\n<li>Stroke volume</li>\n<li>Confirm diagnosis of <strong>pulmonary artery hypertension</strong></li>\n<li>Assess <strong>severity</strong> of <strong>mitral stenosis</strong></li>\n</ul>\n<p>Absolute contraindications of pulmonary artery catheterization are right-sided endocarditis, tumors of the right heart, and lack of consent.&nbsp;Relative contraindications&nbsp;are left bundle branch block and pulmonary and tricuspid valve disorders.</p>\n<p>Technique for pulmonary artery catheterization - Central venous access via the <strong>right internal jugular vein</strong> is most commonly used and is achieved by using Seldinger's technique. The <strong>Swan-Ganz catheter</strong> is inserted and waveforms start to appear once the catheter is in the right atrium. Respiratory variations of the waveform confirm intrathoracic placement. Once the catheter is in the right ventricle, transient ectopy due to<strong> irritation</strong> of the right ventricle by the balloon and catheter tip is common and rarely requires treatment. <strong>Continuous ECG monitoring</strong> is required.</p>\n<div class=\"page\" title=\"Page 2\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The <strong>normal</strong> pulmonary capillary wedge pressure is between<strong> 4 to 12 mmHg</strong>. <strong>Elevated</strong> levels of PCWP might indicate <strong>severe left ventricular failure</strong> or <strong>severe mitral stenosis</strong>. The waveforms that can be observed are tabulated below:</p>\n</div>\n</div>\n</div>\n</div>\n<table style=\"width: 386px;\">\n<tbody>\n<tr>\n<td style=\"width: 143px;\"><strong>Location</strong></td>\n<td style=\"width: 138px;\"><strong>Pressure</strong> <strong>tracing</strong></td>\n</tr>\n<tr>\n<td style=\"width: 143px;\">Catheter passes via SVC to the right atrium&nbsp; <strong>(Right atrial pressure)</strong></td>\n<td style=\"width: 138px;\">Low-pressure waves in systole and diastole.</td>\n<td style=\"width: 100px;\"><strong>&lt;5 mm Hg</strong></td>\n</tr>\n<tr>\n<td style=\"width: 143px;\">The catheter enters the right ventricle&nbsp; through the tricuspid valve <strong>(Right ventricle pressure)</strong></td>\n<td style=\"width: 138px;\">A <strong>sudden increase</strong> in <strong>systolic pressure</strong> with the same diastolic pressure</td>\n<td style=\"width: 100px;\"><strong>25 mm Hg systolic </strong>and <strong>0-5 mm Hg diastolic</strong></td>\n</tr>\n<tr>\n<td style=\"width: 143px;\">Enter the pulmonary artery through the pulmonary valve <strong>(</strong><strong>Pulmonary artery pressure)</strong></td>\n<td style=\"width: 138px;\">\n<p><strong>A sudden increase in diastolic pressure </strong>(about 10 mm Hg). Systolic pressure remains the same&nbsp;&nbsp;</p>\n<p><strong>Dicrotic notch caused by the closure of the pulmonary valve</strong></p>\n</td>\n<td style=\"width: 100px;\"><strong>25mmHg systolic and 10-20 mm Hg diastolic pressure</strong></td>\n</tr>\n<tr>\n<td style=\"width: 143px;\">The catheter advances into a branch of the pulmonary artery where it wedges.&nbsp;<strong>Pulmonary capillary wedge pressure.&nbsp; </strong>This reflects left atrial pressure</td>\n<td style=\"width: 138px;\">Dampened pressure waveform</td>\n<td style=\"width: 100px;\"><strong>4-12 mm Hg</strong></td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>Complications of pulmonary artery catheterization:</p>\n<div class=\"page\" title=\"Page 1382\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Arrhythmias like ventricular fibrillation</li>\n<li>Right bundle branch block</li>\n<li>Complete heart block (if preexisting left bundle branch block)</li>\n<li>Pulmonary artery rupture</li>\n<li>Pulmonary artery pseudoaneurysm</li>\n<li>Catheter knots.</li>\n</ul>\n<p>Other Options:</p>\n<p>Option A:&nbsp;<strong>Sudden decrease in diastolic pressure&nbsp;</strong>is not the hallmark of entry into the pulmonary artery. After the initial increase in diastolic pressure in the pulmonary artery, during ventricular diastole, the RV diastolic pressure increases and the pulmonary artery diastolic pressure decreases due to the runoff of blood into the lungs.&nbsp;</p>\n<p>Options C and D: The&nbsp;<strong>systolic pressures</strong>&nbsp;of the pulmonary artery remain the&nbsp;<strong>same&nbsp;</strong>as those of the right ventricle in normal physiological conditions.&nbsp;</p>\n<p>&nbsp;</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Propofol infusion syndrome is associated with all except:",
    "choices": [
      {
        "id": 1,
        "text": "Acute cardiomyopathy"
      },
      {
        "id": 2,
        "text": "Nephropathy"
      },
      {
        "id": 3,
        "text": "Skeletal myopathy"
      },
      {
        "id": 4,
        "text": "Metabolic acidosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Propofol infusion syndrome is not associated with Nephropathy</p>\n<p>Propofol infusion syndrome is a rare but lethal syndrome seen when the dose of propofol infusion is greater than 4 mg/kg/hour for 48 hours or longer. It is common in children and critically ill adults.</p>\n<ul>\n<li>Clinical Features:\n<ul>\n<li>Acute refractory bradycardia leading to asystole in the presence of one or more of the following:\n<ul>\n<li><strong>Metabolic acidosis (base deficit &gt;10 mmol/L)</strong></li>\n<li>Rhabdomyolysis</li>\n<li>Hyperlipidemia</li>\n<li>Enlarged or fatty liver</li>\n<li>Other features include <strong>cardiomyopathy</strong> with acute cardiac failure, <strong>skeletal myopathy</strong>, hyperkalemia, hepatomegaly, and lipemia.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>The symptoms and signs are the results of muscle injury and the release of intracellular toxic contents.</li>\n<li>It is thought to be due to a defect in mitochondrial metabolism and electron transport chain function.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Irradiation of granulocytes before transfusion has the following advantages except?",
    "choices": [
      {
        "id": 1,
        "text": "Reduced incidence of graft versus host disease"
      },
      {
        "id": 2,
        "text": "Reduced incidence of Febrile reactions"
      },
      {
        "id": 3,
        "text": "Reduced pulmonary endothelial damage"
      },
      {
        "id": 4,
        "text": "Improved granulocyte function"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>Irradiation of granulocytes adversely affects granulocyte function and doesn&rsquo;t improve it.</li>\n<li>Irradiation of granulocytes or use of leuko reduced blood components has several advantages over the use of packed red blood cells:</li>\n<li>Decreased risk of graft versus host disease-which is due to engraftment of donor lymphocytes from the transfused blood products leading to an immune reaction against recipient tissues.</li>\n<li>Reduces chances of febrile reactions.</li>\n<li>Decreases pulmonary endothelial damage.</li>\n<li>Decreases transmission of cytomegalovirus.</li>\n<li>But the risk of bacterial contamination of platelets, transfusion related acute lung injury TRALI, and acute hemolytic reactions have not decreased with leukoreduction.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Stage of surgical anesthesia during ether administration is",
    "choices": [
      {
        "id": 1,
        "text": "Loss of consciousness"
      },
      {
        "id": 2,
        "text": "Failure of circulation"
      },
      {
        "id": 3,
        "text": "Regular respiration to cessation of breathing"
      },
      {
        "id": 4,
        "text": "Loss of consciousness to beginning of regular respiration"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Stages of Anesthesia:</p>\n<ul>\n<li>Stage I (stage of analgesia or disorientation): from beginning of induction of general anesthesia to loss of consciousness.</li>\n<li>Stage II (stage of excitement or delirium): from loss of consciousness to onset of automatic breathing.</li>\n<li>Stage III (stage of surgical anesthesia): from onset of automatic respiration to respiratory paralysis.</li>\n<li>Stage IV: from stoppage of respiration till death.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the range of value of Bispectral index (BIS) for a patient who is under general anesthesia?",
    "choices": [
      {
        "id": 1,
        "text": "20-40"
      },
      {
        "id": 2,
        "text": "40-60"
      },
      {
        "id": 3,
        "text": "60-80"
      },
      {
        "id": 4,
        "text": "80-100"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The Bispectral index value range of <strong>40-60</strong> is seen in a patient under <strong>general anesthesia</strong>.\u00a0</p>\n<p>The bispectral index (BIS) is an empirically derived scale that helps to <strong>monitor </strong>the<strong> depth of anesthesia</strong> and <strong>prevent intraoperative awareness</strong>. It processes the EEG and provides an index value between <strong>0 </strong>to<strong> 100</strong> that indicates the patient\u2019s level of consciousness.</p>\n<p>Bispectral index value range:\u00a0</p>\n<ul>\n<li><strong>100</strong> - <strong>Awake </strong>and<strong> response</strong> to normal voice present</li>\n<li>80 - Light/moderate sedation (May respond to loud commands or mild prodding/shaking)</li>\n<li><strong>60</strong> - <strong>General anesthesia</strong> (Low probability of explicit recall, Unresponsive to verbal stimulus)</li>\n<li>40 - Deep hypnotic state</li>\n<li>20 - Burst suppression</li>\n<li><strong>0 </strong>- <strong>Flatline\u00a0</strong><strong>EEG</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old male was brought to the casualty with complaints of palpitations and dizziness. His pulse rate was 130/min and blood pressure 120/70 mm Hg. His ECG is shown below. What is the line of management?",
    "choices": [
      {
        "id": 1,
        "text": "IV Procainamide"
      },
      {
        "id": 2,
        "text": "IV Lidocaine"
      },
      {
        "id": 3,
        "text": "Synchronised cardioversion"
      },
      {
        "id": 4,
        "text": "Defibrillation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The patient has <strong>monomorphic</strong>&nbsp;<strong>ventricular tachycardia </strong>but it hasn&rsquo;t caused hemodynamic deterioration.&nbsp; So pharmacological treatment is initiated with procainamide.</p>\n<p>Procainamide is a <strong>class Ia antiarrhythmic drug</strong>. The loading dose for procainamide is 20 to 50 mg/min which is given until the arrhythmia is suppressed, hypotension develops, the QRS prolongs by 50% or a total dose of 17 mg/kg is administered. The maintenance dose is 1 to 4 mg/min.</p>\n<p><strong>If the patient is unstable </strong>with any one of the following:</p>\n<ul>\n<li>Pulseless</li>\n<li>Hypotension</li>\n<li>Acutely altered mental status</li>\n<li>Signs of shock</li>\n<li>Ischemic chest discomfort</li>\n<li>Acute heart failure</li>\n</ul>\n<p><strong>&nbsp; &nbsp;Then immediate synchronized cardioversion should be given</strong></p>\n<p><strong>&nbsp; &nbsp;Monophasic &ndash; 360 J</strong></p>\n<p><strong>&nbsp; &nbsp;Biphasic - 120 J</strong></p>\n<p>It is essential to rule out the reversible causes of ventricular tachycardia like Hypoxemia, hypercapnia, hypokalemia or hypomagnesemia (or both), digitalis toxicity and acid-base disturbances.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/66f9ef2e192a4686aec73be5089ea0f6.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8d03b65b786843ebb833df53a7ffb4d2x1280x984.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c31c6c26984f44eab1f1538c8f6bf965x1280x1164.PNG"
    ]
  },
  {
    "text": "During surgery after inhalational anesthesia a patient suddenly developed fever, increased heart rate and BP, acidosis and arrhythmia. What will be your line of management?",
    "choices": [
      {
        "id": 1,
        "text": "Administer IV dantrolene"
      },
      {
        "id": 2,
        "text": "Sodium bicarbonate"
      },
      {
        "id": 3,
        "text": "Antipyretics"
      },
      {
        "id": 4,
        "text": "Procainamide"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Sudden development of fever, tachycardia, hypertension, arrhythmia and acidosis after inhalational anesthesia (most probably halogenated drug) or succinyl choline suggest an episode of malignant hyperthermia. Treatment include immediately stopping the triggering agent and administering dantrolene.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The induction agent of choice in a child with croup is:",
    "choices": [
      {
        "id": 1,
        "text": "Nitrous oxide"
      },
      {
        "id": 2,
        "text": "Sevoflurane"
      },
      {
        "id": 3,
        "text": "Isoflurane"
      },
      {
        "id": 4,
        "text": "Desflurane"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>induction agent of choice</strong> in a child with <strong>croup</strong> is&nbsp;<strong>sevoflurane.</strong></p>\n<p><strong>Viral croup</strong> (laryngotracheobronchitis) is responsible for the majority of cases of acute stridor in children. It occurs due to infection with <strong>parainfluenza</strong> <strong>viruses</strong> <strong>commonly</strong>, but it may also be caused by influenza viruses type A or B, respiratory syncytial virus, or rhinovirus. Children aged <strong>6 months to 3 years</strong> are commonly affected. Infection results in subglottic and tracheal swelling causing stridor and other signs of respiratory obstruction.</p>\n<p>In infants and young children, the upper and lower airways are small, prone to occlusion by secretions, and susceptible to edema and swelling. As a result, the resistance to laminar airflow increases in inverse proportion to the fourth power of the radius (<strong>Poiseuille's law</strong>). Therefore, a small decrease in the radius of the airway results in a marked increase in resistance to airflow and the work of breathing. Children are more reliant on the diaphragm for inspiration, due to the relative immaturity of the intercostal muscles and accessory muscles.</p>\n<p>Treatment includes <strong>humidification </strong>of<strong> respiratory gases, oxygen, steroids, </strong>and<strong> nebulized epinephrine</strong>.&nbsp;Steroids reduce symptoms and improve croup scores 6&ndash;24 h after initial dosing, thereby reducing the need for intubation or shortening the time to extubation.</p>\n<p>Severe respiratory obstruction, as indicated by a persistently high croup score of &gt;7, despite ongoing medical treatment, is an indication for tracheal intubation. Oxygen should be given by mask if required. Historically, <strong>halothane was </strong>the<strong> agent of choice</strong> for induction and maintenance of anesthesia in upper airway obstruction however, <strong>sevoflurane </strong>is<strong> safe </strong>and<strong> effective </strong>in this<strong> situation</strong>.&nbsp;</p>\n<div class=\"page\" title=\"Page 5\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Halothane has largely been replaced by sevoflurane</strong>, particularly for <strong>induction</strong>. Studies show that the incidence of complications in children with mild upper respiratory tract infection was similar between sevoflurane and halothane but that sevoflurane provided a more rapid recovery profile. Other studies, however, suggest that sevoflurane results in fewer complications than halothane, particularly when sevoflurane is used for both induction and maintenance.&nbsp;</p>\n<p>Other options:</p>\n<p>Option A -&nbsp;<strong>Nitrous oxide</strong> is odorless. It is also commonly used for inhalational induction in cooperative children but is not the agent of choice for induction in children with croup.</p>\n<p>Option C -&nbsp;<strong>Isoflurane</strong>&nbsp;has a relatively more noxious smell than sevoflurane, which makes an inhalational induction with it unacceptable for most children.</p>\n<p>Option D - <strong>Desflurane</strong> is not suitable for inhalational induction in children because of its pungent odor and the associated effects of laryngospasm.&nbsp;</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old male was brought to the casualty with multiple stab injuries over the abdomen. He was immediately prepared for emergency surgery and an endotracheal tube was inserted. Following intubation,  capnography was performed and end-tidal CO2 was detected. But his oxygen saturation dropped to 60 and there were no breath sounds audible over the left hemithorax. This is probably because of?",
    "choices": [
      {
        "id": 1,
        "text": "Circuit disconnection"
      },
      {
        "id": 2,
        "text": "Endotracheal tube blockage"
      },
      {
        "id": 3,
        "text": "Endobronchial intubation"
      },
      {
        "id": 4,
        "text": "Oesophageal intubation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li><strong>Detection of end-tidal CO<sub>2</sub></strong> but <strong>dropping oxygen saturation</strong> and hypoxia with <strong>absent breath sounds over the left hemithorax</strong> point to <strong>endobronchial intubation</strong> into the right main bronchus.</li>\n<li>Endobronchial intubation is first indicated by a <strong>sudden rise in peak inspiratory pressure</strong>.</li>\n<li><strong>Capnography</strong> and detection of end-tidal CO<sub>2</sub>&nbsp;is the surest confirmation for endotracheal intubation but it <strong>does not differentiate endotracheal from endobronchial</strong> intubation.</li>\n<li>Signs of endobronchial intubation.</li>\n<li>Elevated peak inspiratory pressure and other airway pressures</li>\n<li>Asymmetric chest expansion</li>\n<li>Unilateral breath sounds</li>\n<li>Hypoxemia</li>\n<li>Signs of correct endotracheal intubation:\n<ul>\n<li>Detection of end tidal CO<sub>2</sub> by capnography (SUREST CONFIRMATION)</li>\n<li>Symmetric chest rise</li>\n<li>Bilateral breath sounds</li>\n<li>Absence of breath sounds in the epigastrium</li>\n<li>Visible condensation in the endotracheal tube</li>\n<li>Large exhaled tidal volumes</li>\n<li>Appropriate compliance of the reservoir bag during manual ventilation</li>\n</ul>\n</li>\n<li>During an esophageal intubation, initial end tidal CO<sub>2</sub> may be detected due to swallowed air but later becomes zero and there would be absence of breath sounds bilaterally with presence of breath sounds in the epigastrium.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During laryngoscopy and endotracheal intubation which of the following maneuver is not performed:",
    "choices": [
      {
        "id": 1,
        "text": "Extension of the head at atlanto-occipital joint"
      },
      {
        "id": 2,
        "text": "During laryngoscopy with miller\u2019s blade, the epiglottis is lifted up by the tip"
      },
      {
        "id": 3,
        "text": "Flexion of the neck"
      },
      {
        "id": 4,
        "text": "The laryngoscope is lifted upward levering over the upper incisor"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The laryngoscope is lifted upward levering over the upper incisor.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/d9eacbc48f24465cb5728ce2e5dbd926x379x245.PNG"
    ]
  },
  {
    "text": "DIBUCAINE NUMBER is used to assess:",
    "choices": [
      {
        "id": 1,
        "text": "Concentration of butyryl cholinesterase"
      },
      {
        "id": 2,
        "text": "Concentration of acetyl cholinesterase"
      },
      {
        "id": 3,
        "text": "Genetic make up of an individual with respect to butyryl cholinesterase"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Dibucaine number indicates the <strong>genetic makeup</strong> of an individual with respect to <strong>butyrylcholinesterase</strong>, BUT it<strong> does not measure</strong> the <strong>concentration</strong> of the enzyme in the plasma substrate.</p>\n<p>Dibucaine is a local anesthetic which measures pseudocholinesterase function but not the amount of enzyme.</p>\n<p>It inhibits normal pseudocholinesterase activity by 80% but inhibits atypical enzyme activity by only 20%.</p>\n<p>Dibucaine number refers to the percentage of inhibition of pseudocholinesterase activity.</p>\n<p>A patient with normal pseudocholinesterase has a dibucaine number of 80; a homozygote will have a dibucaine number of 20.</p>\n<p>Therefore, adequacy of pseudocholinesterase can be determined</p>\n<ul>\n<li>quantitatively in units per liter (a minor factor) - in laboratory</li>\n<li>qualitatively-by dibucaine number (the major factor)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Venous air embolism (VAE) is a potential complication of surgery in the sitting position. Regarding VAE, the correct statement is:",
    "choices": [
      {
        "id": 1,
        "text": "All VAE can be detected clinically by a decrease in end tidal carbon dioxide"
      },
      {
        "id": 2,
        "text": "A decrease in oxygen saturation will not always be seen, even with larger emboli"
      },
      {
        "id": 3,
        "text": "Patients with left to right shunt, are susceptible to paradoxical air embolism"
      },
      {
        "id": 4,
        "text": "The surgeon has no role in the management of VAE"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The correct statement regarding VAE is&nbsp;decrease in oxygen saturation will not always be seen, even with larger emboli.</p>\n<p>Physiological monitors (heart rate, blood pressure, oxygen saturation and end tidal carbon dioxide) have poor sensitivity and specificity and the clinical signs are manifested late.&nbsp;</p>\n<p><strong>Trans esophageal echocardiogram</strong>&nbsp;(TEE) is the&nbsp;<strong>most sensitive</strong>&nbsp;monitor and can detect upto&nbsp;<strong>0.02ml/kg</strong>&nbsp;of air embolism.</p>\n<p>Patients with&nbsp;<strong>right to left shunt</strong>&nbsp;are susceptible to&nbsp;<strong>paradoxical emboli</strong>.</p>\n<p>Surgeons should be notified immediately in order to apply fluid to the surgical field to prevent further embolism.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient on tablet FLUOXETINE for depression for the past 2 months is posted for elective surgery. Advice regarding use of fluoxetine?",
    "choices": [
      {
        "id": 1,
        "text": "Withhold  Fluoxetine for 3 weeks prior to  surgery"
      },
      {
        "id": 2,
        "text": "Withhold fluoxetine  for 3 days prior to surgery"
      },
      {
        "id": 3,
        "text": "Withhold fluoxetine and replace with MonoAmine Oxidase inhibitors"
      },
      {
        "id": 4,
        "text": "Continue fluoxetine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>Fluoxetine is a Selective Serotonin Reuptake Inhibitor SSRI, an antidepressant, which is to be <strong>continued </strong>on the<strong> day of surgery</strong> to avoid exacerbation of symptoms</li>\n<li>Abrupt discontinuation of SSRIs can lead to dizziness, headache,nausea, irritability, visual disturbances, and sensation of electric shock</li>\n<li>All antidepressants, antipsychotics, and anxiolytics are to be continued on the day of surgery</li>\n<li>Earlier irreversible monoamine oxidase inhibitor MAOI antidepressants were discontinued 3 weeks preoperatively and reversible MAOI was discontinued 24 hrs prior to surgery. But discontinuing these drugs resulted in episodes of severe depression or even suicides. Thus it is now recommended <strong>to continue these drugs</strong> and adjust the anesthetic plan so as to avoid the use of meperidine and indirect-acting vasopressors.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Local anesthetic systemic toxicity (LAST) is increased by?",
    "choices": [
      {
        "id": 1,
        "text": "Hypoxia"
      },
      {
        "id": 2,
        "text": "Renal failure"
      },
      {
        "id": 3,
        "text": "Metabolic acidosis"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>LAST is increased by:</p>\n<ul>\n<li>Hypercapnia</li>\n<li><strong>Hypoxia</strong></li>\n<li><strong>Acidosis (metabolic and respiratory)</strong></li>\n<li>Decreased plasma protein binding of LA (due to increased PaCO<sub>2</sub> or decreased pH)</li>\n<li>Abnormally low protein concentration (in neonates increasing the proportion of free drug)</li>\n<li>Advanced age</li>\n<li>Hepatic failure leading to decreased clearance of amide LA</li>\n<li><strong>Renal failure</strong></li>\n<li>Cardiac failure (prolonged absorption and drug accumulation)</li>\n<li>Underlying cardiac pathology (IHD, CCF, conduction block)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While performing this block the patient experienced sudden pain in the eye, proptosis, diminished vision, and a sudden increase in intraocular pressure. What procedure-related complication would you suspect?",
    "choices": [
      {
        "id": 1,
        "text": "Retinal detachment"
      },
      {
        "id": 2,
        "text": "Subconjunctival hemorrhage"
      },
      {
        "id": 3,
        "text": "Optic neuritis"
      },
      {
        "id": 4,
        "text": "Retrobulbar hemorrhage"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image shown above is the technique of <strong>retrobulbar block</strong> and the complication that can be suspected in this patient is <strong>retrobulbar hemorrhage</strong>.</p>\n<p>A <strong>retrobulbar block</strong> is a regional anesthesia technique used in ophthalmic surgery which involves the injection of a local anesthetic into the <strong>extraocular muscle cone</strong>. The needle penetrates the lower lid at the junction of the&nbsp;<strong>outer and middle third</strong> of the orbit. After aspiration to rule out intravascular injection, <strong>2 to 5 mL of local anesthetic</strong> (lidocaine 2% or bupivacaine 0.75%) is injected, and the needle is removed.</p>\n<p><strong>Complications</strong> of retrobulbar block include:</p>\n<ul>\n<li><strong>Retrobulbar hemorrhage</strong> (most common complication) - Venous hemorrhage spreads slowly but <strong>arterial hemorrhage</strong> can produce a rapid swelling. This may compress surrounding vital structures and present with marked proptosis, immobility of the globe, inability to close the lids, and blood staining of the conjunctiva and the lids. Compression on the retinal vasculature can cause severe vision loss.&nbsp;</li>\n<li><strong>Postretrobulbar block apnea syndrome</strong>: This may occur if the anesthetic is injected into the optic nerve sheath.</li>\n<li>Perforation of the globe</li>\n<li>Oculocardiac reflex</li>\n<li>Accidental intravascular injection of the local anesthetic</li>\n<li>Respiratory arrest</li>\n</ul>\n<p><strong>Contraindications</strong> of retrobulbar block:</p>\n<ul>\n<li>Bleeding disorders - This is because of the risk of retrobulbar hemorrhage&nbsp;</li>\n<li>High myopia - Increased length of the globe increases the risk of perforation</li>\n<li>Open eye injury (penetrating eye injury) - injection of local anesthetic behind the globe could increase the intraocular pressure which could lead to extrusion of the orbital contents.</li>\n</ul>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Retinal detachment</strong>: Can present with non-specific symptoms initially, but later present with photopsia (transient flashes of light), floaters (small moving spots in the retinal field), or a gradually developing veil/ curtain obscuring field of vision.</p>\n<p>Option B:&nbsp;<strong>Subconjunctival haemorrhage</strong>: It is usually asymptomatic, but a momentary sharp pain or a snapping sensation can be felt. It is seen on elderly individuals and occurs either spontaneously or follows trauma, surgery or conjunctivitis.</p>\n<p>Option C:&nbsp;<strong>Optic neuritis</strong>: It is characterised by loss of vision, deteriorating in hours to days, along with local tenderness. Often the vision improves spontaneously.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/236ab54ba11743178153e6a37041439f.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Colloid used to decrease blood viscosity is?",
    "choices": [
      {
        "id": 1,
        "text": "Dextran 40"
      },
      {
        "id": 2,
        "text": "Dextran 70"
      },
      {
        "id": 3,
        "text": "Hydroxyethyl starch"
      },
      {
        "id": 4,
        "text": "Gelatin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Colloid used to decrease blood viscosity is dextran 40.</li>\n<li>DEXTRAN is a highly branched polysaccharide produced by the bacterium Leuconostoc mesenteroides.</li>\n<li>Dextran 40 has a molecular weight of 40,000 daltons.</li>\n<li>It can reduce blood viscosity and cellular aggregation and improve microcirculation during low-flow states and hence it may be used in microvascular surgery.</li>\n<li>It is given prophylactically to reduce the incidence of post-operative thromboembolism.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A poorly controlled diabetic with retinopathy would be placed under?",
    "choices": [
      {
        "id": 1,
        "text": "ASA 1"
      },
      {
        "id": 2,
        "text": "ASA 2"
      },
      {
        "id": 3,
        "text": "ASA 3"
      },
      {
        "id": 4,
        "text": "ASA 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>ASA GRADE 3: Patient with severe systemic disease (some functional limitations)</p>\n<ul>\n<li>Poorly controlled diabetes: <strong>Severe systemic disease</strong></li>\n<li>Retinopathy: <strong>Functional limitation </strong>due to poor vision or loss of vision</li>\n</ul>\n<p>- American Society of Anesthesiologists&rsquo;(ASA) classification is used to define relative risk prior to conscious sedation and surgical anesthesia.</p>\n<p>-&nbsp;It is simple, reproducible and strongly correlates to perioperative risk</p>\n<h3>American Society of Anesthesiologists&rsquo; physical status classification of patients -&nbsp; Class Definition</h3>\n<ul>\n<li>1 Normal healthy patient</li>\n<li>2 Patient with mild systemic disease (<strong>no</strong> functional limitations)</li>\n<li>3 Patient with severe systemic disease (<strong>some</strong> functional limitations)</li>\n<li>4 Patient with severe systemic disease that is a constant threat to life (functionality incapacitated)</li>\n<li>5 A moribund patient who is not expected to survive without the operation</li>\n<li>6 A brain-dead patient whose organs are being removed for donor purposes</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Nitrous oxide was first introduced by",
    "choices": [
      {
        "id": 1,
        "text": "Joseph Priestly"
      },
      {
        "id": 2,
        "text": "August Bier"
      },
      {
        "id": 3,
        "text": "Edmund boyle"
      },
      {
        "id": 4,
        "text": "Oliver Wendell"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Joseph Priestley produced nitrous oxide in 1772, and Humphry Davy fi rst noted its analgesic properties in 1800. Gardner Colton and Horace Wells are credited with having fi rst used nitrous oxide as an anesthetic for dental extractions in humans in 1844. Nitrous oxide&rsquo;s lack of potency (an 80% nitrous oxide concentration results in analgesia but not surgical anesthesia) led to clinical demonstrations that were less convincing than those with ether.</p>\n<ul>\n<li>August bier &ndash; performed the first spinal anesthesia in humans</li>\n<li>Edmund Boyle &ndash; discovered the anesthetic machine</li>\n<li>Oliver Wendell &ndash; coined the term anesthesia</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The maximum oxygen delivered by a nasal cannula is?",
    "choices": [
      {
        "id": 1,
        "text": "20%"
      },
      {
        "id": 2,
        "text": "60%"
      },
      {
        "id": 3,
        "text": "40%"
      },
      {
        "id": 4,
        "text": "100%"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The maximum oxygen delivered by a nasal cannula is 40%.</p>\n<p><strong>The nasal cannula </strong>is a<strong> low flow variable</strong> <strong>performance</strong> oxygen delivery system that can provide a maximum inspired oxygen concentration of <strong>40%</strong> at flow rates greater than 10 L/ min for short periods. It is usually limited to a <strong>flow of 5-6 L/min</strong> to reduce the discomfort resulting from inadequate humidification and high flow into the nasal cavity. It may also cause&nbsp;drying and crusting of the nasal mucosa.</p>\n<p>Oxygen delivery devices can be broadly divided into low flow oxygen devices (eg: nasal cannula, simple face mask, non-rebreathing mask) and high flow oxygen devices (eg: venturi mask).</p>\n<table width=\"620\">\n<tbody>\n<tr>\n<td><strong>Oxygen delivery devices</strong></td>\n<td><strong>Flow rate (liter/min)&nbsp;</strong></td>\n<td><strong>Approximate FiO2</strong></td>\n</tr>\n<tr>\n<td>Nasal cannula&nbsp;</td>\n<td>1-6&nbsp;</td>\n<td>0.24-0.44&nbsp;</td>\n</tr>\n<tr>\n<td>Simple face mask&nbsp;</td>\n<td>6-10</td>\n<td>0.40-0.60</td>\n</tr>\n<tr>\n<td>Non-rebreathing mask</td>\n<td>10-15</td>\n<td>0.90-1.00&nbsp;</td>\n</tr>\n<tr>\n<td>Venturi mask&nbsp;</td>\n<td>2-15&nbsp;</td>\n<td>0.24-0.60</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "True statement concerning compound A is _____",
    "choices": [
      {
        "id": 1,
        "text": "Degradation product of desflurane"
      },
      {
        "id": 2,
        "text": "Neurotoxicity is the major concern"
      },
      {
        "id": 3,
        "text": "Less common with Amsorb adsorbent"
      },
      {
        "id": 4,
        "text": "Seen predominantly with high flow techniques"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li>True statement concerning <strong>compound A is less common with Amsorb adsorbent.</strong></li>\n<li>Compound A is fluoromethyl-2,2-difluoro-1-(trifluoromethyl) vinyl ether which is the <strong>degradation product of sevoflurane by the strong bases like sodium hydroxide and potassium hydroxide</strong> present in calcium hydroxide&ndash;based carbon dioxide absorbents (soda lime)</li>\n<li>Compound A is <strong>nephrotoxic, not neurotoxic.</strong> It is also <strong>associated with transient albuminuria and glucosuria</strong></li>\n</ul>\n<p>Factors that increase the concentration of compound A include:</p>\n<ul>\n<li>Prolonged exposure to sevoflurane</li>\n<li>Higher concentrations of sevoflurane in the anesthetic circuit</li>\n<li>Low flow anesthetic technique</li>\n<li>The type of absorbent - baralyme and classic soda-lime had been with withdrawn due to a greater risk of compound A formation as they contain sodium hydroxide and potassium hydroxide. Potassium hydroxide produces a greater amount of compound A than sodium hydroxide. Newer soda-lime contains no potassium hydroxide.\n<ul>\n<li>Compound A formation is less or absent with amsorb due to its greater inertness.</li>\n</ul>\n</li>\n<li>Higher absorbent temperatures</li>\n<li>Fresh absorbent</li>\n</ul>\n<ul>\n<li>Desflurane on degradation with dry desiccated baralyme produces carbon monoxide. Although this phenomenon is seen with all halogenated inhalational anesthetics, it is maximum with desflurane ( desflurane &ge; enflurane &gt; isoflurane &gt;&gt; halothane = sevoflurane)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The Local anesthetic of choice for labor analgesia is?",
    "choices": [
      {
        "id": 1,
        "text": "Lidocaine"
      },
      {
        "id": 2,
        "text": "Bupivacaine"
      },
      {
        "id": 3,
        "text": "Chloroprocaine"
      },
      {
        "id": 4,
        "text": "Cocaine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Bupivacaine and ropivacaine are preferred </strong>over lidocaine and chloroprocaine for labor analgesia because of their <strong>differential blockade </strong>&nbsp;(they produce less motor blockade as compared to sensory blockade). This preferred motor function is useful as voluntary push down efforts by the patient may lead to better delivery outcomes</p>\n<p>Bupivacaine is preferred because of its long duration of action</p>\n<p>Ropivacaine and levobupivacaine were introduced to reduce the cardiotoxicity associated with bupivacaine. But since bupivacaine is used in small doses for labor analgesia, cardiotoxicity usually does not manifest</p>\n<p>The doses of local anesthetics can be reduced by a combination of local anesthetics with lipid-soluble opioids like fentanyl or sufentanil. The greater the concentration of opioid used, a lesser concentration of local anesthetic is required. The lesser concentration of local anesthetic used leads to greater preservation of motor function and makes ambulation of the&nbsp; patient possible(walking or mobile epidural)</p>\n<p><strong>Concentrations used for epidural:</strong></p>\n<ul>\n<li>Without opioid: bupivacaine: 0.25%,&nbsp;ropivacaine, 0.2%</li>\n<li>With opioid:&nbsp;bupivacaine (0.0625% to 0.125%),&nbsp;ropivacaine (0.0625% to 0.2%)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Inhalational agent of choice for a patient posted for liver transplantation?",
    "choices": [
      {
        "id": 1,
        "text": "Enflurane"
      },
      {
        "id": 2,
        "text": "Halothane"
      },
      {
        "id": 3,
        "text": "Sevoflurane"
      },
      {
        "id": 4,
        "text": "Isoflurane"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li>Liver transplantation is carried out under general anesthesia with an inhalational agent usually sevoflurane and isoflurane but sevoflurane may be the anesthetic of choice as it is considered equal to or better than isoflurane in preserving hepatic arterial blood flow and hepatic oxygen delivery.</li>\n<li>There is an autoregulatory mechanism in liver called the hepatic arterial buffer response(HABF)- when portal blood flow decreases due to decreased cardiac output or hypovolemia, the hepatic arterial blood flow increases in order to maintain total hepatic blood flow. This response is best preserved with sevoflurane and isoflurane but disrupted by halothane.</li>\n<li>Hepatic artery vasoconstriction is seen with halothane along with an increase in hepatic arterial resistance. There is also reduction in hepatic oxygen delivery and hepatic venous oxygen saturation. This is because of the greater reduction in cardiac output seen with halothane than the other volatile agents.</li>\n<li>In patients with severe encephalopathy the concentration of sevoflurane to be used is less than one minimum alveolar concentration.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which is the most common anaphylactic agent during anesthesia?",
    "choices": [
      {
        "id": 1,
        "text": "Antibiotics"
      },
      {
        "id": 2,
        "text": "Rocuronium"
      },
      {
        "id": 3,
        "text": "Latex"
      },
      {
        "id": 4,
        "text": "Chlorhexidine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most common anaphylactic agent during anesthesia is <strong>antibiotics</strong>.</p>\n<p>This is followed by neuromuscular blocking agents.</p>\n<p><strong>Penicillins</strong> and <strong>cephalosporins</strong> are the most common causes of anaphylaxis among antibiotics.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statement about halothane is incorrect?",
    "choices": [
      {
        "id": 1,
        "text": "It sensitizes the heart to catecholamine at 1MAC"
      },
      {
        "id": 2,
        "text": "20% metabolized"
      },
      {
        "id": 3,
        "text": "1% thymol is used as preservative"
      },
      {
        "id": 4,
        "text": "It is not usually given in same patient with in 3 months"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li>Halothane contains <strong>0.01% thymol </strong>for stability.</li>\n<li><strong>15-20% </strong>of absorbed halothane is metabolized.</li>\n<li>Halothane may persist in the liver for as long as 12days after administration and is usually not given in same patient within 3 months.</li>\n<li>It sensitizes heart to arrythmogenic action of epinephrine, so doses of 1.5microgram/kg should be avoided.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 47-year-old female patient was brought to the casualty in an unconscious state after having suddenly collapsed. Cardiopulmonary resuscitation was started as there was no pulse and the following rhythm was noted on the monitor. What is the next step?",
    "choices": [
      {
        "id": 1,
        "text": "Defibrillation"
      },
      {
        "id": 2,
        "text": "Amiodarone"
      },
      {
        "id": 3,
        "text": "1 mg epinephrine"
      },
      {
        "id": 4,
        "text": "0.5 mg atropine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given clinical scenario patient has an organized, apparently <strong>normal ECG without a palpable pulse,&nbsp;</strong>that is,&nbsp;the patient has <strong>pulseless electrical activity </strong>(PEA). Among the given options, the next step is to give <strong>1 mg </strong>of<strong> epinephrine.</strong></p>\n<p>The immediate treatment for pulseless electrical activity is to give<strong> chest compressions </strong>and<strong> 1 mg epinephrine</strong> at the earliest. Following that, <strong>definitive treatment</strong> for the <strong>cause</strong> of PEA should be initiated.</p>\n<p>It is essential to rule out the reversible causes of cardiac arrest.&nbsp;They include:</p>\n<p><strong>5 H&rsquo;s:</strong></p>\n<ul>\n<li>Hypovolemia</li>\n<li>Hypoxia</li>\n<li>Hydrogen ion (acidosis)</li>\n<li>Hypokalemia or hyperkalemia</li>\n<li>Hypothermia</li>\n</ul>\n<p><strong>5 T&rsquo;s:</strong></p>\n<ul>\n<li>Tension pneumothorax</li>\n<li>Tamponade (cardiac)</li>\n<li>Toxins</li>\n<li>Thrombosis (pulmonary)</li>\n<li>Thrombosis (coronary)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e7efa91727984362bd80f03bdef8fce2.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Mivacurium when given in high doses, all are true except",
    "choices": [
      {
        "id": 1,
        "text": "Increase in dose increases the rapidity of onset"
      },
      {
        "id": 2,
        "text": "flushing"
      },
      {
        "id": 3,
        "text": "Histamine release"
      },
      {
        "id": 4,
        "text": "Hypertension"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Mivacurium when given in high doses, all are true except hypertension.Mivacurium is BENZYLISOQUINOLINE derivative non- depolarizing muscle relaxant.</p>\n<ul>\n<li>It is the Shortest acting non-depolarizing muscle relaxant due to its metabolism by pseudocholinesterase(butyrlycholinesterase). It has an onset of action within 2-3 minutes and a duration of action of 10-20 minutes.</li>\n<li>Patients with atypical pseudocholinesterase will have prolonged duration of block of several hours following mivacuirum administration.</li>\n</ul>\n<ul>\n<li>Can cause histamine release but in lesser quantities as compared to tubocurarine. It is seen only when the intravenous injection is given rapidly. Histamine release leads to hypotension, tachycardia and flushing.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the most common complication of a celiac plexus block.",
    "choices": [
      {
        "id": 1,
        "text": "Pneumothorax"
      },
      {
        "id": 2,
        "text": "Postural hypotension"
      },
      {
        "id": 3,
        "text": "Retroperitoneal hemorrhage"
      },
      {
        "id": 4,
        "text": "Local anesthesia toxicity"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The<strong> most common </strong>complication of a celiac plexus block is <strong>postural hypotension</strong>.</p>\n<p>This occurs due to the resultant <strong>blockade</strong> of the <strong>lumbar sympathetic</strong> <strong>chain</strong> and the dilation of capacitance vessels in the splanchnic area. Therefore, patients should be adequately hydrated intravenously prior to this procedure and precautions should be taken to minimize the risk of orthostatic lightheadedness or syncope.</p>\n<div class=\"page\" title=\"Page 1859\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The celiac ganglia are found at the level of the <strong>body</strong> of the <strong>L1</strong> vertebra. They are located\u00a0<strong>lateral</strong> to the <strong>aorta</strong>, and\u00a0<strong>posterior</strong> to the <strong>vena cava</strong> and the<strong> pancrea</strong><strong>s</strong>.</p>\n<div class=\"page\" title=\"Page 1859\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>It is preferred when patients have pain originating from the abdominal viscera, as seen in intra-abdominal cancers.</p>\n<p>Due to its proximity to the vena cava, accidental intravascular injection into the vena cava can occur, which can produce a <strong>severe systemic reaction</strong>. Damage to the retroperitoneal lymph nodes can result in <strong>chylothorax</strong>.\u00a0Blocking the sympathetic chain leads to\u00a0increased gastrointestinal motility due to\u00a0<strong>unopposed parasympathetic activity,</strong>\u00a0resulting in\u00a0<strong>diarrhea</strong>.</p>\n<div class=\"page\" title=\"Page 1860\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>It may lead to other complications such as\u00a0<strong>pneumothorax</strong>,\u00a0injury to the <strong>kidneys</strong> or <strong>pancreas</strong>,<strong>\u00a0hemorrhage</strong>,\u00a0<strong>sexual dysfunction,\u00a0</strong><strong>paraplegia</strong> due to injury to the lumbar artery of Adamkiewicz, and back pain.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Traction on which of the following elicits the oculocardiac reflex:",
    "choices": [
      {
        "id": 1,
        "text": "Superior rectus"
      },
      {
        "id": 2,
        "text": "Inferior rectus"
      },
      {
        "id": 3,
        "text": "Medial rectus"
      },
      {
        "id": 4,
        "text": "Lateral rectus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Traction on&nbsp; medial rectus elicits the oculocardiac reflex.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following are criteria for brain death, except:",
    "choices": [
      {
        "id": 1,
        "text": "Absent deep tendon reflexes"
      },
      {
        "id": 2,
        "text": "Isoelectric EEG"
      },
      {
        "id": 3,
        "text": "Absent brainstem reflexes"
      },
      {
        "id": 4,
        "text": "Absent ventilatory effort"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>All the options are criteria for brain death, except absent deep tendon reflexes.<strong> Deep tendon reflexes</strong>/ spinal cord reflexes may be <strong>present</strong> in <strong>brain</strong> <strong>death</strong> as the spinal cord function below C1 is intact.\u00a0</p>\n<p><strong>Clinical criteria </strong>for brain death:</p>\n<ul>\n<li><strong>Coma</strong>-<strong>\u00a0</strong>Deep, unresponsiveness to noxious stimuli</li>\n<li><strong>Absent motor activity</strong>- No decerebrate or decorticate posturing</li>\n<li><strong>Absence of brainstem reflexes</strong>-<strong>\u00a0</strong>Pupillary, oculocephalic, corneal, gag reflex, etc.</li>\n<li><strong>Apnea</strong>-<strong>\u00a0</strong>Absence of spontaneous respiration at \u00a0arterial pCO<sub>2</sub>\u00a0tension of at least 50\u201360 mmHg</li>\n</ul>\n<p><strong>Confirmatory test</strong> findings (not mandatory but may assist in diagnosis)</p>\n<ul>\n<li><strong>Isoelectric electroencephalogram</strong></li>\n<li>Absence of somatosensory evoked potentials and brainstem evoked potentials\u00a0</li>\n<li>Absence of cerebral perfusion, as documented by angiographic, transcranial Doppler, or radioisotopic studies</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Supra MAC anaesthetic concentration changes EEG waves from:",
    "choices": [
      {
        "id": 1,
        "text": "Beta to delta"
      },
      {
        "id": 2,
        "text": "Alpha to beta"
      },
      {
        "id": 3,
        "text": "Delta to alpha"
      },
      {
        "id": 4,
        "text": "Delta to theta"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>EEG changes during induction:</p>\n<ul>\n<li>The EEG patterns of different anesthetic agents are similar when the concentrations are at sub-MAC level.</li>\n<li>At the beginning, lower doses of anesthetic essentially increase the amplitude of the beta band in the frontal regions and decrease the amplitude of the alpha band.</li>\n<li>When the anesthetic concentration is increased to the surgical level, the frequency of theta and delta bands decrease, whereas their amplitudes increase.</li>\n<li>Further increases in the anesthetic concentration generate a special EEG pattern known as burst suppression (BS).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Anaesthesia Test Ii';
        const quizFilename = 'anaesthesia-test-ii-d5df1fae.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2018 - 19"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>