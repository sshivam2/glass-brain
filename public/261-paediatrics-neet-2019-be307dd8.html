<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>261 Paediatrics Neet 2019 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Pediatrics
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">17</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Unconjugated hyperbilirubinemia, which did not subside even after 3 weeks of birth, was observed in a neonate. On investigating, liver enzymes, PT/INR and albumin levels were normal. No hemolysis was seen on a peripheral blood smear. A drop in bilirubin level was observed within a week after treating with phenobarbital. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rotor syndrome"
      },
      {
        "id": 2,
        "text": "Crigler Najjar type 2"
      },
      {
        "id": 3,
        "text": "Dubin Johnson syndrome"
      },
      {
        "id": 4,
        "text": "Crigler Najjar type 1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Jaundice persisiting <strong>3 weeks after birth</strong> is suggestive of&nbsp;<strong>pathological jaundice</strong>. Among the given options,&nbsp;<strong>Crigler Najjar type</strong>&nbsp;<strong>2&nbsp;</strong>presents with&nbsp;<strong>unconjugated</strong> hyperbilirubinemia which <strong>responds</strong> to&nbsp;<strong>p</strong><strong>henobarbital therapy</strong>.<strong>&nbsp;</strong>&nbsp;</p>\n<p><strong>Dubin Johnson</strong> (option C) and <strong>Rotor&nbsp;</strong>(option A) syndromes lead to <strong>conjugated hyperbilirubinemia</strong>.&nbsp;</p>\n<p><span class=\"fontstyle0\">Crigler Najjar type 2 is an <strong>autosomal recessive</strong> disease with <strong>non-hemolytic</strong>, <strong>unconjugated</strong> hyperbilirubinemia caused by homozygous missense mutations in the enzyme UDP <strong>UGT1A1</strong>&nbsp;resulting in reduced (partial) enzymatic activity.</span></p>\n<p>The differences between Crigler-Najjar type 1 and type 2 are described in the table below:</p>\n<table>\n<tbody>\n<tr>\n<td style=\"text-align: center;\"><strong>Crigler Najjar Type 1</strong></td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\"><strong>Crigler Najjar Type 2</strong></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">Autosomal recessive</td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">Autosomal recessive</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">UDPGT is <strong>absent</strong></td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">UDPGT is <strong>reduced</strong></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">Severe unconjugated hyperbilirubinemia</td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">Less severe</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">Pale stools</td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">Normal-coloured stools</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">May proceed to <strong>kernicterus&nbsp;</strong>and <strong>does not</strong><strong>&nbsp;respond to phenobarbitone</strong></td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">Does not proceed to kernicterus and <strong>is responsive to phenobarbitone</strong></td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which one of the following is not a feature in cerebral palsy?",
    "choices": [
      {
        "id": 1,
        "text": "Hypotonia"
      },
      {
        "id": 2,
        "text": "Microcephaly"
      },
      {
        "id": 3,
        "text": "Ataxia"
      },
      {
        "id": 4,
        "text": "Flaccid paralysis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<table style=\"height: 1137px; width: 646px;\">\n<tbody>\n<tr style=\"height: 41px;\">\n<td style=\"width: 211.047px; height: 41px;\" colspan=\"2\"><strong>Types</strong></td>\n<td style=\"width: 112.469px; height: 41px;\"><strong>Etiology</strong></td>\n<td style=\"width: 123.398px; height: 41px;\"><strong>Presentation</strong></td>\n<td style=\"width: 171.086px; height: 41px;\"><strong>MRI findings</strong></td>\n</tr>\n<tr style=\"height: 234px;\">\n<td style=\"width: 84.6875px; height: 483.492px;\" rowspan=\"3\">\n<p style=\"text-align: center;\"><strong>Spastic</strong></p>\n<p style=\"text-align: center;\">(m/c type)</p>\n</td>\n<td style=\"width: 120.359px; height: 234px;\">\n<p style=\"text-align: center;\"><strong>Diplegia</strong></p>\n<p style=\"text-align: center;\"><span style=\"font-size: 8pt;\">(second m/c in India)</span></p>\n</td>\n<td style=\"width: 112.469px; height: 234px;\">\n<p style=\"text-align: center;\"><strong>Prematurity</strong></p>\n<p style=\"text-align: center;\">Ischemia&nbsp;</p>\n<p style=\"text-align: center;\">Infection</p>\n</td>\n<td style=\"width: 123.398px; height: 234px;\">\n<p style=\"text-align: center;\">Bilateral spasticity (<strong>LL&gt;</strong>UL)</p>\n<p style=\"text-align: center;\"><strong>Scissoring gait</strong></p>\n<p style=\"text-align: center;\"><strong>Commando crawl</strong></p>\n<p style=\"text-align: center;\">Learning disabilities</p>\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 171.086px; height: 234px; text-align: center;\"><strong>Periventricular leukomalacia</strong></td>\n</tr>\n<tr style=\"height: 180px;\">\n<td style=\"width: 120.359px; height: 180px; text-align: center;\"><strong>Hemiplegia</strong></td>\n<td style=\"width: 112.469px; height: 180px;\">\n<p style=\"text-align: center;\"><strong>Vascular insult</strong></p>\n<p style=\"text-align: center;\">Infection</p>\n<p style=\"text-align: center;\">Genetic</p>\n<p style=\"text-align: center;\">&nbsp;</p>\n</td>\n<td style=\"width: 123.398px; height: 180px;\">\n<p style=\"text-align: center;\"><strong>Early hand preference</strong></p>\n<p style=\"text-align: center;\">(<strong>UL</strong>&gt;LL)</p>\n<p style=\"text-align: center;\">Walking delayed up to 18-24m</p>\n<p style=\"text-align: center;\"><strong>Equinovarus</strong> deformity of foot</p>\n<p style=\"text-align: center;\">Seizures (33%)</p>\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 171.086px; height: 180px;\">\n<p style=\"text-align: center;\"><strong>Porencephalic cyst</strong></p>\n<p style=\"text-align: center;\">Focal infarct changes</p>\n</td>\n</tr>\n<tr style=\"height: 69.4922px;\">\n<td style=\"width: 120.359px; height: 69.4922px;\">\n<p style=\"text-align: center;\"><strong>Quadriplegia</strong></p>\n<p style=\"text-align: center;\"><span style=\"font-size: 8pt;\">(most severe)</span></p>\n<p style=\"text-align: center;\"><span style=\"font-size: 8pt;\">(m/c type in India)</span></p>\n</td>\n<td style=\"width: 112.469px; height: 69.4922px;\">\n<p style=\"text-align: center;\"><strong>Ischemia</strong></p>\n<p style=\"text-align: center;\">Infection</p>\n</td>\n<td style=\"width: 123.398px; height: 69.4922px;\">\n<p style=\"text-align: center;\"><strong>Marked motor impairment</strong></p>\n<p style=\"text-align: center;\"><strong>Flexion </strong>contractures</p>\n<p style=\"text-align: center;\">Strong association with <strong>seizures</strong>&nbsp;</p>\n<p style=\"text-align: center;\"><strong>Severe</strong> intellectual impairment and <strong>GDD</strong></p>\n<p style=\"text-align: center;\">Difficulty swallowing (<strong>supranuclear palsy</strong>)</p>\n</td>\n<td style=\"width: 171.086px; height: 69.4922px;\">\n<p style=\"text-align: center;\"><strong>Multi-cystic encephalomalacia</strong></p>\n<p style=\"text-align: center;\"><strong>Severe periventricular leukomalacia</strong></p>\n</td>\n</tr>\n<tr style=\"height: 20px;\">\n<td style=\"width: 84.6875px; height: 20px;\">\n<p style=\"text-align: center;\"><strong>Dyskinetic</strong></p>\n<p style=\"text-align: center;\">(15-20%)</p>\n</td>\n<td style=\"width: 120.359px; height: 20px;\">\n<p style=\"text-align: center;\"><strong>Extrapyramidal</strong></p>\n<p style=\"text-align: center;\">Athetoid</p>\n<p style=\"text-align: center;\">Chorioathetoid</p>\n</td>\n<td style=\"width: 112.469px; height: 20px;\">\n<p style=\"text-align: center;\"><strong>Asphyxia</strong></p>\n<p style=\"text-align: center;\"><strong>Kernicterus</strong></p>\n<p style=\"text-align: center;\">Mitochondrial</p>\n<p style=\"text-align: center;\">Genetic</p>\n<p style=\"text-align: center;\">&nbsp;</p>\n</td>\n<td style=\"width: 123.398px; height: 20px;\">\n<p style=\"text-align: center;\">Rigidity/hypotonia, dystonia, athetosis, chorea</p>\n<p style=\"text-align: center;\">Cognitive disability</p>\n<p style=\"text-align: center;\">Hip displacement</p>\n<p style=\"text-align: center;\">Seizures</p>\n<p style=\"text-align: center;\">&nbsp;</p>\n</td>\n<td style=\"width: 171.086px; height: 20px;\">\n<p style=\"text-align: center;\"><strong>Basal ganglia scarring</strong></p>\n<p style=\"text-align: center;\"><strong>Thalamic scarring</strong></p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>UL - upper limb; LL - lower limb; GDD - global developmental delay</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cd480ee47cc947ccb1c31d18bad0e6aax510x520.GIF"
    ]
  },
  {
    "text": "Which of the following is not seen in a child with cystic fibrosis?",
    "choices": [
      {
        "id": 1,
        "text": "Sweat chloride test chloride conc of 70 mEq/L"
      },
      {
        "id": 2,
        "text": "Increase immunoreactive trypsinogen level"
      },
      {
        "id": 3,
        "text": "Hyperkalemia"
      },
      {
        "id": 4,
        "text": "Contraction alkalosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Patients with <strong>cystic fibrosis </strong>(CF) can present with <strong>hypokalemia</strong> and <strong>not hyperkalemia</strong>.</p>\n<p><strong>Excess production of sweat</strong> in CF leads to a significant<strong> loss</strong> of <strong>chloride</strong> ions from the extracellular fluid (ECF). The <strong>depletion of chloride</strong> from the ECF causes an&nbsp;<strong>intracellular shift&nbsp;</strong>of&nbsp;<strong>potassium</strong>&nbsp;and<strong>&nbsp;activation of renin-aldosterone</strong> system,<strong>&nbsp;</strong>leading to <strong>hypokalemia</strong>.</p>\n<p>The excessive depletion of sodium chloride in CF also affects the acid-base balance. It leads to <strong>increased reabsorption of bicarbonate</strong> by the kidneys through the chloride-bicarbonate exchanger on the intercalated cells. This process is known as <strong>contraction alkalosis&nbsp;</strong>(option D) and results in <strong>hyponatremic hypochloremic alkalosis.</strong></p>\n<p>Cystic fibrosis, also known as mucoviscidosis, is an <strong>autosomal recessive</strong> disorder caused by a mutation in the <strong>cystic fibrosis transmembrane regulator</strong> (CFTR) gene on <strong>chromosome</strong> <strong>7q</strong>. This gene is responsible for encoding <strong>ATP-gated chloride channels</strong> in the apical membranes of epithelial cells, which regulate the flow of ions across various epithelial membranes in the body, including sweat glands, respiratory airways, and pancreatic ducts. The defect in CFTR leads to<strong> elevated salt concentrations in sweat</strong> and the production of <strong>thick, viscous secretions</strong> in the respiratory and gastrointestinal tracts.</p>\n<p>Diagnostic tests for CF include the <strong>sweat chloride test&nbsp;</strong>(option A), where an increased chloride concentration<strong> (&gt;60 mEq/L)</strong> is considered <strong>diagnostic</strong>.&nbsp;<strong>Immunoreactive trypsinogen levels</strong> (option B) are also measured for newborn screening, as they tend to be<strong> elevated</strong>&nbsp;in CF. <strong>Genetic testing</strong> for CFTR gene mutations is considered the <strong>gold standard</strong> and should be performed for all <strong>suspected</strong> cases. In<strong> equivocal </strong>cases, <strong>nasal transepithelial potential difference</strong> can be estimated as an additional diagnostic test.</p>\n<p>The <strong>criteria for diagnosis</strong> is the presence of <strong>c</strong><strong>linical symptoms</strong>&nbsp;affecting at least <strong>one</strong> organ system (respiratory, gastrointestinal, or genitourinary)&nbsp;<strong>or </strong>a&nbsp;<strong>positive&nbsp;newborn screening</strong>&nbsp;<strong>or</strong><strong>&nbsp;</strong>a&nbsp;<strong>sibling</strong>&nbsp;with cystic fibrosis, along with evidence of&nbsp;<strong>dysfunction</strong>&nbsp;of the&nbsp;<strong>CFTR gene</strong>&nbsp;(<strong>t</strong><strong>wo positive sweat chloride test</strong> results obtained on separate days&nbsp;<strong>or </strong>identification of&nbsp;<strong>two CFTR mutations</strong>&nbsp;by genetic testing&nbsp;<strong>or </strong>an&nbsp;<strong>abnormal</strong>&nbsp;measurement of&nbsp;<strong>nasal potential</strong> <strong>difference</strong>).<strong>&nbsp;</strong></p>\n<p>The image below shows the organs involved in cystic fibrosis:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f05fc955e954de0b5e10544c2b5a402x480x342.PNG"
    ]
  },
  {
    "text": "A 9-year-old boy has swelling of knee joints and non-blanching rashes as seen in the picture. Urine exam reveals haematuria +++ and proteinuria +. Platelet levels are normal. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Systemic lupus erythematosus (SLE)"
      },
      {
        "id": 2,
        "text": "Henoch Schonlein purpura (HSP)"
      },
      {
        "id": 3,
        "text": "Immune thrombocytopenic purpura (ITP)"
      },
      {
        "id": 4,
        "text": "Polyarteritis Nodosa (PAN)"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario showing<strong> </strong>swelling of knee joints (<strong>arthritis</strong>),<strong> </strong>non-blanching rash in the lower limbs (<strong>palpable purpura</strong>), along with hematuria and proteinuria (<strong>renal involvement</strong>) in a <strong>child</strong> is suggestive of <strong>Henoch Schonlein purpura (HSP)</strong>.</p>\n<p>HSP (<strong>IgA vasculitis</strong>) is a small vessel vasculitis most commonly seen in the age group of <strong>3-8 years</strong>. It generally follows an <strong>upper respiratory tract infection</strong> and there is a history of <strong>atopy</strong> in one-third of the cases.</p>\n<p>The pathology of HSP involves <strong>leukocytoclastic vasculitis</strong> and the deposition of <strong>IgA</strong> in the affected blood vessels. IgA is deposited in the glomerular mesangium in a distribution similar to that of IgA nephropathy.</p>\n<p>Clinical manifestations include <strong>palpable</strong> <strong>purpura</strong>, the <strong>hallmark</strong> feature of HSP, which characteristically involves the&nbsp;<strong>extensor surfaces of arms and</strong> <strong>legs</strong>. Musculoskeletal symptoms such as <strong>arthritis</strong> and <strong>arthralgia</strong> are common. Gastrointestinal symptoms can include <strong>abdominal pain</strong>, vomiting, diarrhea, and <strong>bleeding</strong>. <strong>Renal involvement</strong> may lead to&nbsp;gross or microscopic<strong> hematuria</strong>, nephritic syndrome, or <strong>nephrotic syndrome</strong>. Renal manifestations are <strong>more severe in adults</strong>. A rapidly progressive form of glomerulonephritis is seen in some cases. Nephritis usually follows the appearance of the rash.&nbsp;</p>\n<p>Diagnosis of HSP is primarily based on <strong>clinical findings</strong>, including the palpable purpura, along with the presence of other symptoms. Laboratory tests are not specific to HSP but may show nonspecific markers of inflammation and sometimes elevated levels of IgA. Imaging studies and biopsies of affected tissues can provide additional diagnostic information</p>\n<p>Treatment of HSP is generally supportive, focusing on hydration, pain relief, and nutrition. <strong>Corticosteroids</strong> may be used in severe cases or for significant <strong>gastrointestinal involvement</strong>. Intravenous immune globulin (<strong>IVIG</strong>) and <strong>plasma exchange</strong> are occasionally employed for severe disease. <strong>Nephritis</strong>&nbsp;due to IgA vasculitis should be treated with immunosuppressants like&nbsp;<strong>prednisolone</strong>&nbsp;and&nbsp;<strong>azathioprine</strong>. Complications of HSP can include serious gastrointestinal problems, kidney disease, and recurrences, but overall, the prognosis for childhood HSP is <strong>favorable</strong>. Regular monitoring of blood pressure and urine is recommended to detect and manage potential complications.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/60d6777ee4e5429f9a80f48a86d6404c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A child in your unit is diagnosed with severe acute malnutrition (SAM). According  to the WHO criteria, SAM is defined best by:",
    "choices": [
      {
        "id": 1,
        "text": "Weight for age less than - 2SD"
      },
      {
        "id": 2,
        "text": "Weight for height less than + 2SD"
      },
      {
        "id": 3,
        "text": "Weight for age less than + 3SD"
      },
      {
        "id": 4,
        "text": "Weight for height less than - 3SD"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Severe acute malnutrition (SAM) is best defined as&nbsp;<strong>w</strong><strong>eight for height less than median minus -3SD</strong></p>\n<p>Severe acute malnutrition (SAM) in children of ages <strong>6 to 59 months</strong> is defined by the WHO as any of the following:</p>\n<ol>\n<li>Weight-for-length (or height) below &minus;3 SD of the median WHO child growth standards.</li>\n<li>Presence of bipedal edema</li>\n<li>Mid-upper arm circumference &lt;11.5 cm</li>\n</ol>\n<p>Once the child is diagnosed with severe acute malnutrition, the doctor must assess for <strong>severe edema</strong> (+++); <strong>l</strong><strong>ow appetite</strong> (failed appetite test); <strong>m</strong><strong>edical complications</strong> (severe anemia, pneumonia, diarrhea, dehydration, cerebral palsy, tuberculosis, HIV, heart disease, etc.) and <strong>one or more danger signs</strong> as per IMNCI</p>\n<div class=\"page\" title=\"Page 110\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>If<strong>&nbsp;any</strong>&nbsp;of the&nbsp;<strong>complications are present</strong>, the child is diagnosed with&nbsp;<strong>complicated SAM</strong>&nbsp;and is managed <strong>inpatient</strong> in the facility.&nbsp;</p>\n<p>If the above-mentioned signs&nbsp;<strong>are absent</strong>, the child is diagnosed with&nbsp;<strong>uncomplicated SAM</strong>&nbsp;and&nbsp;<strong>supervised management</strong> at home is given.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The most common manifestation of congenital toxoplasmosis is ______",
    "choices": [
      {
        "id": 1,
        "text": "Hydrocephalus"
      },
      {
        "id": 2,
        "text": "Chorioretinitis"
      },
      {
        "id": 3,
        "text": "Hepatosplenomegaly"
      },
      {
        "id": 4,
        "text": "Thrombocytopenia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Chorioretinitis</strong> is the <strong>most common</strong> manifestation of congenital toxoplasmosis.</p>\n<p>The characteristic <strong>triad</strong> of congenital toxoplasmosis is <strong>chorioretinitis</strong>, <strong>hydrocephalus,</strong> and <strong>diffuse</strong> <strong>intracranial&nbsp;calcifications.&nbsp;</strong>Clinical manifestations&nbsp;apart from the triad include hydrops fetalis, <strong>intrauterine growth retardation</strong>, <strong>prematurity</strong>, peripheral retinal scars, persistent jaundice, and mild thrombocytopenia.</p>\n<p><strong>Congenital toxoplasmosis&nbsp;</strong>occurs when a pregnant woman&nbsp;acquires the infection during gestation. The organism may cross to the&nbsp;<strong>fetus&nbsp;transplacentally</strong> or at the time of vaginal delivery. The severity of the disease in the neonate is<strong> greater</strong> if the woman gets infected <strong>early in her pregnancy</strong>.&nbsp;The causative agent is <em>Toxoplasma gondii</em>, an obligate intracellular protozoan.</p>\n<p>The <strong>diagnosis</strong> is made by the detection of <strong>IgM</strong> anti-toxoplasma antibodies. IgG can cross the placenta is hence, cannot confirm infection in the infant. IgM immunosorbent agglutination assay (<strong>ISAGA</strong>) and&nbsp;<strong>IgA ELISA</strong>&nbsp;are the most useful diagnostic tests.</p>\n<p><strong>Spiramycin </strong>can be administered for cases of <strong>acute infection</strong> in&nbsp;<strong>early pregnancy&nbsp;</strong>to reduce vertical transmission. It does&nbsp;<strong>not cross</strong> the placenta and therefore cannot be used to treat an infected fetus.&nbsp;<strong>Pyrimethamine-sulfonamide</strong>&nbsp;(to be avoided in the first trimester) is used when<strong> a fetal infection</strong>&nbsp;is<strong>&nbsp;confirmed</strong>&nbsp;or&nbsp;in maternal<strong> infections after 18 weeks.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Molecular defect causing liver disease in Dubin-Johnson syndrome is__________",
    "choices": [
      {
        "id": 1,
        "text": "ATP7A"
      },
      {
        "id": 2,
        "text": "ATP7B"
      },
      {
        "id": 3,
        "text": "ABCC2"
      },
      {
        "id": 4,
        "text": "SERPINA 1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"text-align: justify;\">The molecular defect causing liver disease in <strong>Dubin&ndash;Johnson syndrome</strong>&nbsp;is<strong> ABCC2</strong>.</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p><strong>Dubin-Johnson syndrome</strong>&nbsp;is an <strong>autosomal recessive</strong> disorder due to a defect in ABCC2.&nbsp;ABCC2 codes for<strong> canalicular protein with ATP-binding cassette</strong>. A defect in this gene leads to the <strong>mutation</strong> of the&nbsp;<strong>multiple drug-resistant protein 2 (MRP2) receptor</strong>. This in turn leads to a <strong>defective transfer</strong> of <strong>conjugated</strong> bilirubin from the<strong>&nbsp;liver to bile.&nbsp;</strong></p>\n<p>It presents with <strong>abdominal pain, mild icterus,</strong>&nbsp;and<strong>&nbsp;conjugated hyperbilirubinemia</strong>. Biopsy shows&nbsp;<strong>black liver</strong> due to an&nbsp;accumulation of epinephrine metabolite.</p>\n</div>\n</div>\n<p style=\"text-align: justify;\">Conditions causing <strong>conjugated hyperbilirubinemia&nbsp;</strong>are summarised in the table below:</p>\n<table style=\"height: 181px;\" width=\"374\">\n<tbody>\n<tr>\n<td style=\"width: 209.875px;\"><strong>Dubin-Johnson syndrome</strong></td>\n<td style=\"width: 148.140625px;\"><strong>Rotor syndrome</strong></td>\n</tr>\n<tr>\n<td style=\"width: 209.875px;\">Autosomal recessive</td>\n<td style=\"width: 148.140625px;\">Autosomal recessive</td>\n</tr>\n<tr>\n<td style=\"width: 209.875px;\">The absent function of<strong>&nbsp;multiple drug-resistant proteins (</strong><strong>MRP-2)</strong></td>\n<td style=\"width: 148.140625px;\">Defects in anion transport</td>\n</tr>\n<tr>\n<td style=\"width: 209.875px;\">Black liver on biopsy (due to accumulation of epinephrine metabolite)</td>\n<td style=\"width: 148.140625px;\">No abnormal liver pigmentation.</td>\n</tr>\n<tr>\n<td style=\"width: 209.875px;\">Normal levels of coproporphyrin in urine</td>\n<td style=\"width: 148.140625px;\">Increased levels of coproporphyrin in urine&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 209.875px;\">The gall bladder is not visualized on oral cholecystography</td>\n<td style=\"width: 148.140625px;\">The gall bladder is visualized on oral cholecystography</td>\n</tr>\n</tbody>\n</table>\n<p>Important diseases and their molecular defects:</p>\n<table style=\"width: 293px;\">\n<tbody>\n<tr>\n<td style=\"width: 111px; text-align: center;\">ATP7A&nbsp;</td>\n<td style=\"width: 170px; text-align: center;\">Menke&rsquo;s&nbsp;disease&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 111px; text-align: center;\">ATP7B&nbsp;</td>\n<td style=\"width: 170px; text-align: center;\">Wilson disease&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 111px; text-align: center;\">CFTR&nbsp;</td>\n<td style=\"width: 170px; text-align: center;\">Cystic fibrosis&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 111px; text-align: center;\">SERPINA 1&nbsp;</td>\n<td style=\"width: 170px; text-align: center;\">&alpha;-1 antitrypsin deficiency&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 111px; text-align: center;\">ABCC2&nbsp;(MRP2 protein defect)&nbsp;</td>\n<td style=\"width: 170px; text-align: center;\">Dubin&nbsp;Johnson syndrome&nbsp;</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Where would you place the pulse oximeter to measure pre-ductal oxygen saturation in an infant who was born 3 minutes ago?",
    "choices": [
      {
        "id": 1,
        "text": "Left upper limb"
      },
      {
        "id": 2,
        "text": "Left lower limb"
      },
      {
        "id": 3,
        "text": "Right upper limb"
      },
      {
        "id": 4,
        "text": "Right lower limb"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The<strong> right upper limb</strong> is the best area to check<strong> pre-ductal oxygen saturation </strong>in a newborn infant as it receives blood supply primarily from the <strong>right</strong>&nbsp;<strong>brachial artery</strong>, which arises from the aorta <strong>before </strong>the<strong> ductus</strong> <strong>arteriosus.</strong></p>\n<p>In routine neonatal screening for <strong>critical congenital heart diseases</strong> (CCHD), saturation probes are placed on the right upper limb (pre-ductal) and the right lower limb (post-ductal) respectively.</p>\n<p>If the <strong>difference</strong> between <strong>pre-ductal</strong> and <strong>post-ductal</strong> saturation is more than <strong>five percent,</strong> it confirms the presence of <strong>hypoxemia</strong>. Any reading showing an <strong>SpO2 &lt;90%</strong> or greater than a <strong>three percent</strong> difference between the right hand and right foot for <strong>three successive readings</strong> separated by an <strong>hour</strong> each would suggest the <strong>presence </strong>of a<strong> congenital cardiac disease.</strong></p>\n<p>Screening is done to<strong> </strong>identify critical conditions <strong>before they present symptomatically</strong>, and before the neonate <strong>leaves the hospital</strong> post-delivery. This would allow for early and effective treatment of an underlying disease.&nbsp;</p>\n<p>Critical congenital heart diseases include<strong>&nbsp;coarctation of the aorta</strong>, double outlet right ventricle, <strong>Ebstein anomaly</strong>, hypoplastic left heart syndrome, interrupted aortic arch, <strong>pulmonary atresia</strong>, single ventricle, tetralogy of Fallot (<strong>TOF</strong>), total anomalous pulmonary venous return (<strong>TAPVC</strong>), d-transposition of the great arteries (<strong>TGA</strong>), tricuspid atresia, and truncus arteriosus.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All among the following are clinical features of necrotizing enterocolitis except _________",
    "choices": [
      {
        "id": 1,
        "text": "Vomiting"
      },
      {
        "id": 2,
        "text": "Abdominal mass"
      },
      {
        "id": 3,
        "text": "Erythema of the abdominal wall"
      },
      {
        "id": 4,
        "text": "Metabolic alkalosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Necrotizing enterocolitis</strong>\u00a0(NEC) can cause<strong> metabolic or respiratory acidosis </strong>(not alkalosis).</p>\n<p><strong>Acidosis</strong> can be attributed to <strong>sepsis</strong>,<strong> lactic acidosis</strong> due to decreased perfusion of the abdominal wall, <strong>decreased reabsorption of bicarbonate</strong> from the intestine, and <strong>reduced respiratory compensation</strong> due to apnea.\u00a0</p>\n<p>NEC is the\u00a0<strong>most common</strong>\u00a0life-threatening\u00a0<strong>gastrointestinal disorder</strong>\u00a0in the newborn period. It is characterized by various degrees of<strong> mucosal or transmural inflammation</strong> and <strong>necrosis</strong> of the intestinal tract. It most commonly affects the distal\u00a0<strong>ileum\u00a0</strong>and<strong>\u00a0proximal colon</strong>.\u00a0</p>\n<p>Three major\u00a0<strong>risk factors</strong>\u00a0implicated are\u00a0<strong>p</strong><strong>rematurity</strong>\u00a0(greatest risk factor),\u00a0<strong>f</strong><strong>ormula feeding, </strong>and<strong> bacterial colonization</strong> of the intestine. Incidence and mortality increase with decreasing birth weight and gestational age.</p>\n<p>It usually presents within the\u00a0<strong>2nd\u00a0</strong>or<strong>\u00a03rd week</strong>\u00a0of life with\u00a0<strong>abdominal distension</strong>\u00a0and tenderness, feed intolerance, and\u00a0<strong>occult/gross blood</strong>\u00a0in the\u00a0<strong>stool</strong>. Systemic features include\u00a0<strong>hypotension, bradycardia</strong>,\u00a0<strong>lethargy</strong>, and\u00a0<strong>temperature instability</strong>.\u00a0Other signs and symptoms include vomiting, changes in stool pattern, <strong>abdominal mass</strong>, apnea, respiratory distress, hyponatremia, shock, and disseminated intravascular coagulation.\u00a0</p>\n<p><strong>Diagnosis</strong> can be made with a\u00a0<strong>plain abdominal X-ray.</strong>\u00a0<strong>Pneumatosis intestinalis</strong>\u00a0(air in the bowel wall) is diagnostic.<strong>\u00a0</strong><strong>Portal vein gas</strong>\u00a0is a sign of severe disease.\u00a0<strong>Pneumoperitoneum</strong>\u00a0indicates perforation of the intestinal wall.\u00a0</p>\n<p>Staging is done using the\u00a0<strong>modified Bell's staging criteria</strong>:</p>\n<table style=\"height: 883.583px; width: 815px;\">\n<tbody>\n<tr style=\"height: 44.8021px;\">\n<td style=\"width: 109.042px; text-align: center; height: 44.8021px;\">Stage</td>\n<td style=\"width: 173.667px; text-align: center; height: 44.8021px;\">Features</td>\n<td style=\"width: 197.375px; text-align: center; height: 44.8021px;\">Radiological signs</td>\n<td style=\"width: 134.042px; text-align: center; height: 44.8021px;\">Management</td>\n<td style=\"width: 132.917px; text-align: center; height: 44.8021px;\">Treatment</td>\n</tr>\n<tr style=\"height: 281.646px;\">\n<td style=\"width: 109.042px; text-align: center; height: 281.646px;\">\n<p><strong>I<br /></strong></p>\n<p>Suspected NEC<strong><br /></strong></p>\n</td>\n<td style=\"width: 173.667px; text-align: center; height: 281.646px;\">\n<p>Mild <br />abdominal distention, vomiting</p>\n<p>Temperature instability, apnea, bradycardia</p>\n<p>I A: <strong>Occult blood</strong> in stools</p>\n<p>I B: <strong>Gross blood</strong> in stools</p>\n</td>\n<td style=\"width: 197.375px; text-align: center; height: 281.646px;\">Normal or intestinal dilatation, mild ileus</td>\n<td style=\"width: 134.042px; text-align: center; height: 633.698px;\" rowspan=\"4\">\n<p><strong>Medical\u00a0</strong></p>\n<p>Nil per oral</p>\n<p>Total parenteral nutrition - IV fluids containing dextrose</p>\n<p>IV antibiotics -ampicillin, gentamycin, metronidazole</p>\n</td>\n<td style=\"width: 132.917px; text-align: center; height: 281.646px;\">Antibiotics for 3 days</td>\n</tr>\n<tr style=\"height: 67.2083px;\">\n<td style=\"width: 109.042px; text-align: center; height: 67.2083px;\"><strong>II A</strong><strong><br /></strong>Mildly ill<strong><br /></strong></td>\n<td style=\"width: 173.667px; text-align: center; height: 67.2083px;\"><strong>Absent <br />bowel sounds</strong></td>\n<td style=\"width: 197.375px; text-align: center; height: 67.2083px;\"><strong>Pneumatosis intestinalis</strong></td>\n<td style=\"width: 132.917px; text-align: center; height: 352.052px;\" rowspan=\"3\">Antibiotics for 14 days\u00a0 \u00a0</td>\n</tr>\n<tr style=\"height: 192.031px;\">\n<td style=\"width: 109.042px; text-align: center; height: 192.031px;\"><strong>II B<br /></strong>Moderately ill<strong><br /></strong></td>\n<td style=\"width: 173.667px; text-align: center; height: 192.031px;\">\n<p>\u00a0II A + abdominal wall edema</p>\n<p class=\"p1\">Thrombocytopenia</p>\n<p class=\"p1\">Hyponatremia</p>\n<p>Metabolic acidosis\u00a0\u00a0</p>\n</td>\n<td style=\"width: 197.375px; text-align: center; height: 192.031px;\">\u00a0II A + <br /><strong>portal venous gas</strong>, with or without ascites</td>\n</tr>\n<tr style=\"height: 92.8125px;\">\n<td style=\"width: 109.042px; text-align: center; height: 92.8125px;\"><strong>III A<br /></strong>Severely ill, bowel intact\u00a0<strong><br /></strong></td>\n<td style=\"width: 173.667px; text-align: center; height: 92.8125px;\">\n<p>Peritonitis</p>\n<p>Definite ascites</p>\n</td>\n<td style=\"width: 197.375px; text-align: center; height: 92.8125px;\">II B + <strong>definite ascites</strong>\u00a0</td>\n</tr>\n<tr style=\"height: 205.083px;\">\n<td style=\"width: 109.042px; text-align: center; height: 205.083px;\"><strong>III B<br /></strong>Severely ill, bowel<br />perforated<strong><br /></strong></td>\n<td style=\"width: 173.667px; text-align: center; height: 205.083px;\">\n<p>Intestinal perforation</p>\n</td>\n<td style=\"width: 197.375px; text-align: center; height: 205.083px;\">\u00a0<strong>Pneumoperitoneum</strong></td>\n<td style=\"width: 134.042px; text-align: center; height: 205.083px;\">\n<p><strong>Surgical</strong></p>\n<p>(due to bowel perforation)</p>\n</td>\n<td style=\"width: 132.917px; text-align: center; height: 205.083px;\">\n<p><strong>Stable</strong> - Laparotomy (resection of necrosed part, followed by anastomoses)</p>\n<p><strong>Unstable\u00a0</strong>-</p>\n<p>Primary peritoneal drainage, and once stabilized definitive surgery\u00a0</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Management</strong> of NEC includes supportive measures - nil per oral, nasogastric decompression, intravenous fluids, broad-spectrum antibiotics, and inotropic support if indicated.\u00a0<strong>Perforation</strong>\u00a0is an<strong> absolute indication</strong> for <strong>surgery.\u00a0</strong>The\u00a0<strong>most effective preventive</strong>\u00a0strategy is the use of\u00a0<strong>human milk</strong>. Prebiotics and probiotics can be used with variable efficacy.</p>\n<p>The images below show pneumatosis intestinalis (A), pneumoperitoneum (B), gasless abdomen (C), and distention of the abdomen with <strong>periumbilical erythema</strong> (D):\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0eca889923ad42119ce8c69bc2479324x512x512.PNG"
    ]
  },
  {
    "text": "The most common cause of HIV infection in a newborn is _________",
    "choices": [
      {
        "id": 1,
        "text": "Perinatal transmission"
      },
      {
        "id": 2,
        "text": "Breast milk"
      },
      {
        "id": 3,
        "text": "Transplacental"
      },
      {
        "id": 4,
        "text": "Exchange transfusion with infected blood"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>most common</strong> cause of <strong>HIV</strong> infection in a newborn is <strong>perinatal transmission</strong>.&nbsp;Around <strong>70 to 80%</strong> of affected children acquire the virus intrapartum.&nbsp;</p>\n<p>The <strong>mechanism</strong> of perinatal transmission has been postulated to be <strong>mucosal exposure</strong> to <strong>infected blood</strong> and <strong>cervicovaginal secretions</strong> in the <strong>birth canal</strong>. The <strong>intrauterine contractions</strong> during active labor/delivery could also <strong>increase the risk of late micro transfusions.</strong></p>\n<p>Vertical transmission of HIV can occur in utero (during pregnancy), <strong>during delivery (perinatal), </strong>and after birth by breastfeeding (least common).</p>\n<p><strong>The risk factors </strong>for vertical transmission are<strong>&nbsp;high maternal viremia, </strong>preterm delivery (&lt;34 weeks), vitamin A deficiency, prolonged rupture of membranes (&gt;4 hours) low birth weight, and low maternal CD4 count.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the main factor for the ductal closure postnatally?",
    "choices": [
      {
        "id": 1,
        "text": "Increase in partial pressure of oxygen (paO2)"
      },
      {
        "id": 2,
        "text": "Increase in systemic vascular resistance"
      },
      {
        "id": 3,
        "text": "Increase in circulating prostaglandin levels"
      },
      {
        "id": 4,
        "text": "Decrease in pulmonary venous resistance"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Gestational age also appears to play an important role; the <strong>ductus of a premature infant is less responsive to oxygen</strong>, even though its musculature is developed.&nbsp;Hence, <strong>patent&nbsp;ductus arteriosus (PDA) is more common in premature infants.</strong></p>\n<p>The fetal circulatory adjustments after birth are given below:</p>\n<table style=\"height: 171px; width: 458px;\">\n<tbody>\n<tr style=\"height: 40px;\">\n<td style=\"width: 151.318px; height: 40px; text-align: center;\">&nbsp;</td>\n<td style=\"width: 150.682px; text-align: center; height: 40px;\"><strong>&nbsp;Functional closure</strong></td>\n<td style=\"width: 146px; text-align: center; height: 40px;\"><strong>Anatomical closure</strong></td>\n</tr>\n<tr style=\"height: 40px;\">\n<td style=\"width: 151.318px; height: 40px;\"><strong>Ductus venosus</strong></td>\n<td style=\"width: 150.682px; text-align: center; height: 40px;\">After removal of the placenta</td>\n<td style=\"width: 146px; text-align: center; height: 40px;\">7 days&nbsp;</td>\n</tr>\n<tr style=\"height: 40px;\">\n<td style=\"width: 151.318px; height: 40px;\">\n<p class=\"p1\"><strong>Foramen ovale</strong></p>\n</td>\n<td style=\"width: 150.682px; text-align: center; height: 40px;\">\n<p class=\"p1\">At birth - after breathing is initiated</p>\n</td>\n<td style=\"width: 146px; text-align: center; height: 40px;\">Months to years&nbsp;</td>\n</tr>\n<tr style=\"height: 30.9318px;\">\n<td style=\"width: 151.318px; height: 30.9318px;\"><strong>Ductus arteriosus</strong></td>\n<td style=\"width: 150.682px; text-align: center; height: 30.9318px;\">10&ndash;15 hours&nbsp;</td>\n<td style=\"width: 146px; text-align: center; height: 30.9318px;\">10&ndash;21 days&nbsp;&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>The <strong>patency</strong> of ductus arteriosus may either provide an <strong>alternative route</strong> for blood to bypass congenital defects such as pulmonary atresia or coarctation of the aorta.</p>\n<p>Therapeutic medications can be used to either maintain the patency (<strong>prostaglandin E1</strong>) or promote closure (<strong>indomethacin</strong>). Drugs like indomethacin are not recommended during the third trimester of pregnancy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e5f5a2362b464d1392dc8a8c4461c1bbx1024x700.jpeg"
    ]
  },
  {
    "text": "Cardiac edema and neuropathy are seen in which of the following vitamin deficiencies?",
    "choices": [
      {
        "id": 1,
        "text": "Biotin"
      },
      {
        "id": 2,
        "text": "Thiamine"
      },
      {
        "id": 3,
        "text": "Pyridoxine"
      },
      {
        "id": 4,
        "text": "Riboflavin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Cardiac edema and neuropathy</strong> are associated with the<strong> deficiency of thiamine (vitamin B1)</strong>.\u00a0</p>\n<p>Early symptoms of thiamine deficiency include\u00a0<strong>peripheral neuropathy</strong>,<strong> irritability</strong>,<strong>\u00a0loss of deep tendon reflexes</strong>,\u00a0and\u00a0<strong>proprioception</strong>.\u00a0As the disease progresses, increased intracranial pressure, meningismus, and coma develop.</p>\n<p><strong>Wet beriberi (cardiac)</strong> is associated with tachycardia, cardiomegaly, cardiac failure, and edema. It is commonly seen in the\u00a0<strong>refugee camps</strong>\u00a0where people consume\u00a0<strong>polished rice\u00a0</strong>based monotonous diets. Diagnosis of thiamine deficiency can be established by\u00a0<strong>erythrocyte transketolase</strong>\u00a0activity assessment.</p>\n<p><strong>Dry beriberi</strong>\u00a0is associated with <strong>neurological</strong> deficits such as optic atrophy, ataxia, and irritability.</p>\n<p><strong>Complications</strong> include\u00a0lactic acidosis\u00a0and Wernicke encephalopathy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The commonest indication for liver transplantation in children is ______",
    "choices": [
      {
        "id": 1,
        "text": "Alagille syndrome"
      },
      {
        "id": 2,
        "text": "Biliary atresia"
      },
      {
        "id": 3,
        "text": "Caroli disease"
      },
      {
        "id": 4,
        "text": "Hepatcellular carcinoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Biliary atresia</strong> is the <strong>most common</strong> indication for<strong> liver transplantation in children</strong>.</p>\n<p>Extrahepatic biliary atresia&nbsp;(EHBA) is defined as a partial or total <strong>absence </strong>of permeable<strong> bile duct </strong>between the porta hepatis and the duodenum. It is due to <strong>inflammatory fibrosis</strong> of the biliary tree.&nbsp;It leads to obstruction to bile flow thereby causing the leaking of <strong>conjugated bilirubin</strong> into the circulation.</p>\n<p>Infants have symptoms of <strong>jaundice</strong>,<strong> pale stools</strong>, and <strong>dark urine</strong> right after birth. In advanced disease, infants present with failure to thrive, hepatomegaly, and ascites due to liver cirrhosis.</p>\n<p><strong>HIDA scan</strong>&nbsp;is the <strong>investigation of choice</strong> for extrahepatic biliary atresia. An<strong> intraoperative cholangiogram </strong>is a gold standard investigation for diagnosis.</p>\n<table style=\"height: 261px; width: 379.417px;\">\n<tbody>\n<tr style=\"height: 29.7656px;\">\n<td style=\"width: 587.417px; text-align: center; height: 29.7656px;\" colspan=\"3\"><strong>Management of extrahepatic biliary atresia</strong></td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 87px; height: 54px;\">Type I</td>\n<td style=\"width: 226px; height: 54px;\">\n<div class=\"page\" title=\"Page 1217\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Atresia restricted to the common bile duct</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 274.417px; height: 54px;\">\n<div class=\"page\" title=\"Page 1217\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Roux-en-Y hepaticojejunostomy</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 87px; height: 54px;\">Type II</td>\n<td style=\"width: 226px; height: 54px;\">\n<div class=\"page\" title=\"Page 1217\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Atresia of the common hepatic duct</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 274.417px; height: 54px;\" rowspan=\"2\"><strong>Kasai procedure</strong> (Roux-en-Y hepatoportoenterostomy)</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 87px; height: 54px;\">Type III</td>\n<td style=\"width: 226px; height: 54px;\">\n<div class=\"page\" title=\"Page 1217\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Atresia of the right and left hepatic duct</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Children with biliary atresia, who do not achieve successful drainage after hepatoportoenterostomy (<strong>Kasai's procedure</strong>), require liver transplantation within the first year of life.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While you are evaluating a baby, you show him a bright pink teddy bear, that he reaches out to with both hands. What is the earliest age by which this milestone is typically achieved?",
    "choices": [
      {
        "id": 1,
        "text": "4 months"
      },
      {
        "id": 2,
        "text": "5 months"
      },
      {
        "id": 3,
        "text": "6 months"
      },
      {
        "id": 4,
        "text": "7 months"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>earliest age </strong>of appearance <strong>of bidextrous reach</strong> is&nbsp;<strong>4 months.&nbsp;</strong></p>\n<p>Fine motor reflexes begin to appear only <strong>after</strong> the <strong>palmar grasp</strong> reflex <strong>disappears at 3-4 months.&nbsp;</strong>The development of <strong>unidextrous reach</strong> occurs by <strong>6 months</strong> of age.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A baby assessed 5 minutes after birth, is found to be cyanosed with irregular gasping respiration. Heart rate is 60 beats/min, and shows minimal response to stimulation with some flexion of extremities. The Apgar score for this newborn is ______",
    "choices": [
      {
        "id": 1,
        "text": "2"
      },
      {
        "id": 2,
        "text": "5"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Apgar score is <strong>not used</strong> to <strong>guide resuscitation</strong>, and resuscitation must be initiated before the 1-minute score. The <strong>change</strong> of score at sequential time points following birth <strong>reflects</strong> how well the baby is <strong>responding</strong> to <strong>resuscitative efforts</strong>.</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Causes for <strong>low Apgar score</strong>&nbsp;are:</p>\n<ul>\n<li>Fetal distress</li>\n<li>Prematurity</li>\n<li>Drugs like analgesics, narcotics, sedatives, magnesium sulfate</li>\n<li>Acute cerebral trauma</li>\n<li>Precipitous delivery</li>\n<li>Airway obstruction (choanal atresia)&nbsp;&nbsp;</li>\n<li>Congenital pneumonia or sepsis</li>\n<li>Haemorrhage- hypovolemia</li>\n</ul>\n<p><strong>False-negative</strong>&nbsp;Apgar score is seen in&nbsp;<strong>maternal acidosis</strong>&nbsp;and&nbsp;<strong>high fetal catecholamine levels.</strong></p>\n<p>A total score of <strong>10</strong> indicates that the infant is in the best possible condition. An infant with a&nbsp;<strong>score of 0-3 requires immediate resuscitation. </strong>If the score at 5 minutes remains <strong>less than 7,</strong> the infant should be assessed again <strong>every 5 minutes</strong> for the next <strong>20 minutes.</strong></p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b766f912ac324eef818798b4dfcd97adx1280x1714.JPEG"
    ]
  },
  {
    "text": "Most common heart defect in congenital rubella syndrome is:",
    "choices": [
      {
        "id": 1,
        "text": "ASD"
      },
      {
        "id": 2,
        "text": "VSD"
      },
      {
        "id": 3,
        "text": "PDA"
      },
      {
        "id": 4,
        "text": "PS"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Patent ductus arteriosus (PDA)</strong> is the <strong>most common</strong> congenital heart disease associated with rubella, followed by pulmonary artery stenosis (PS).</p>\n<p>Cardiac anomalies have been observed in 50% of children infected during the first 8 weeks of gestation.&nbsp;The incidence of heart disease in congenital rubella syndrome is: <strong>PDA</strong> &gt; <strong>PS</strong> (right &gt;left) &gt; <strong>ventricular septal defect</strong> &gt; <strong>atrial septal defect</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following options describes the chest x-ray image?",
    "choices": [
      {
        "id": 1,
        "text": "Egg on string appearance"
      },
      {
        "id": 2,
        "text": "Coeur en sabot"
      },
      {
        "id": 3,
        "text": "Scimitar sign"
      },
      {
        "id": 4,
        "text": "Snow man sign"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>TOF is cyanotic congenital heart disease with the following four components:</p>\n<ul>\n<li>Obstruction to right ventricular outflow (<strong>pulmonary stenosis</strong>)</li>\n<li>Malalignment type of ventricular septal defect (<strong>VSD</strong>)</li>\n<li>Dextroposition of the aorta so that it overrides the ventricular septum (<strong>overriding of the aorta</strong>)</li>\n<li>Right ventricular hypertrophy (<strong>RVH</strong>)</li>\n</ul>\n<p>The severity of symptoms depends on the degree of the right ventricular outflow obstruction. In mild degrees, the symptoms become pronounced as the baby grows due to&nbsp;<strong>RV infundibular hypertrophy</strong>&nbsp;and may present with <strong>heart failure</strong>. In severe degrees, pulmonary blood flow predominantly depends on the ductus arteriosus. As soon as the duct closes, the baby presents with&nbsp;<strong>cyanosis</strong>&nbsp;and&nbsp;<strong>circulatory collapse</strong>&nbsp;in the neonatal period.</p>\n<p>Clinical features include significant&nbsp;<strong>hypercyanotic spells</strong>&nbsp;in infants which are characterised by hyperpnea,&nbsp;<strong>cyanosis</strong>, and&nbsp;<strong>gasping&nbsp;</strong>followed by syncope. The spells occur most frequently in the morning on initially awakening or after episodes of&nbsp;<strong>vigorous crying</strong>. These spells are due to a prolonged reduction of pulmonary blood flow resulting in&nbsp;<strong>severe systemic hypoxia</strong>&nbsp;and metabolic acidosis.</p>\n<p>Older children present with&nbsp;<strong>exertional dyspnea</strong>&nbsp;and assume a&nbsp;<strong>squatting position</strong>&nbsp;to relieve the dyspneic episode after which the child is able to resume the activity.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8671fe49306b40cbadf43ad8cd39c8a9.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3246d13f08ef4516b790ccdf31c4adbdx510x558.GIF"
    ]
  }
];
        let quizName = '261 Paediatrics Neet 2019';
        let hierarchy = ["Marrow", "PYQs", "Pediatrics"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>