<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>80 Respiratory Physiology And Failure - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">8</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>A 72 y/o male, a k/c/o COPD presents to the ED with shortness of breath and confusion. He has been experiencing increased fatigue and worsening dyspnea over the past few days. O/E he has a respiratory rate of 30 bpm. Arterial blood gas analysis shows: PaO2: 58 mmHg, PaCO2: 52 mmHg and pH: 7.2. Which type of respiratory failure is most likely in this patient?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Type 1 Respiratory Failure"
      },
      {
        "id": 2,
        "text": "Type 2 Respiratory Failure"
      },
      {
        "id": 3,
        "text": "Type 3 Respiratory Failure"
      },
      {
        "id": 4,
        "text": "Type 4 Respiratory Failure"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The patient exhibits <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> (PaO2 < 60 mmHg), <span class=\"customMeta\" data-dictid=\"1f0bd058f91692777189f9a7c1992e\">hypercapnia</span> (PaCO2 > 45 mmHg), and <span class=\"customMeta\" data-dictid=\"6caf3a39f416927771807e122b9032\">acidosis</span> (pH < 7.35), which are indicative of <span class=\"customMeta\" data-dictid=\"05e8c1df0d1692777201c9acee8b1f\">Type 2</span> <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure.</p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:630px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Feature</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Type 1 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure</strong></p>\n\n\t\t\t<p><strong>(Option A ruled out)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Type 2 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Definition</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Hypoxemic <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Hypercapnic <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>PaO2 </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>PaO2 < 60 mmHg</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>May be normal or decreased</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>PaCO2 </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Normal or decreased</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>PaCO2 > 45 mmHg</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>pH</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Typically normal</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>< 7.35 due to acidosis</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>A-a Gradient</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Can be normal (low FiO\u2082/Patm, hypoventilation) or increased (V/Q mismatch, shunt, <span class=\"customMeta\" data-dictid=\"9c760dcb641692777186f4cda5dc95\">diffusion</span> defect)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Variable, depending on <span class=\"customMeta\" data-dictid=\"272d378524169277718972cc77dc98\">hypoventilation</span> or dead space</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Primary Causes</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\u00a0\n\t\t\t<ul>\n\t\t\t\t<li>V/Q mismatch</li>\n\t\t\t\t<li>Diffusion defect</li>\n\t\t\t\t<li>Right-to-left shunt</li>\n\t\t\t\t<li>Low FiO\u2082/Patm</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<ul>\n\t\t\t\t<li>Hypoventilation</li>\n\t\t\t\t<li>Respiratory pump failure</li>\n\t\t\t\t<li>Decreased central drive</li>\n\t\t\t\t<li>Neuromuscular impairment</li>\n\t\t\t\t<li>Increased CO\u2082 production</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Common Etiologies</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<ul>\n\t\t\t\t<li>ARDS</li>\n\t\t\t\t<li>COPD</li>\n\t\t\t\t<li>Congestive heart failure</li>\n\t\t\t\t<li>High altitude</li>\n\t\t\t\t<li>Pneumonia</li>\n\t\t\t\t<li>Pulmonary embolism</li>\n\t\t\t\t<li>AV malformation</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<ul>\n\t\t\t\t<li>CNS depression (e.g., sedatives)</li>\n\t\t\t\t<li>Neuromuscular diseases (e.g., ALS)</li>\n\t\t\t\t<li>Chest wall/pleural disorders (e.g., <span class=\"customMeta\" data-dictid=\"3dec14fe921692777202dc55958a46\">flail</span> chest, kyphoscoliosis)</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Type 3 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure (Option C): </strong>Type 3 is typically associated with <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure due to surgery or anaesthesia, often resulting in atelectasis. The patient's chronic <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> condition and current symptoms do not fit this scenario.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Type 4 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure (Option D): </strong>This type involves <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure due to <span class=\"customMeta\" data-dictid=\"8f2e7fd96116927771995b451b5c90\">systemic</span> conditions such as shock or severe sepsis, leading to inadequate oxygenation. The patient does not present with the clinical features indicative of <span class=\"customMeta\" data-dictid=\"26a46d0aaa169277720147f4f40f57\">Type 4</span> failure; he is primarily showing <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> <span class=\"customMeta\" data-dictid=\"afafb9026e1692777186e3dd168fa8\">distress</span> related to COPD.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 65 y/o female undergoes elective hip replacement surgery. Postoperatively, she develops shortness of breath and a decreased oxygen saturation level. She reports significant pain at the surgical site and is reluctant to take deep breaths due to discomfort. O/E, her respiratory rate is elevated, and auscultation reveals diminished breath sounds at the bases. A chest X-ray shows areas of atelectasis. What type of respiratory failure is most likely in this patient?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Type 1 Respiratory Failure"
      },
      {
        "id": 2,
        "text": "Type 2 Respiratory Failure"
      },
      {
        "id": 3,
        "text": "Type 3 Respiratory Failure"
      },
      {
        "id": 4,
        "text": "Type 4 Respiratory Failure"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The patient exhibits <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure due to atelectasis, which is common after surgery, especially with pain and <span class=\"customMeta\" data-dictid=\"b81cee1b5f16927771987099f651a0\">sedation</span> affecting her ability to breathe deeply. This scenario aligns with <span class=\"customMeta\" data-dictid=\"6f809a27121692777201d1ccde5ace\">Type 3</span> <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure.</p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:645px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Feature</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Type 3 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure </strong></p>\n\n\t\t\t<p><strong>(Postoperative)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Type 4 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure </strong></p>\n\n\t\t\t<p><strong>(Shock-Related) </strong><strong>(Option D ruled out)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Definition</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Respiratory failure due to <span class=\"customMeta\" data-dictid=\"7a5ca69ddf16927771829cd4e4d464\">atelectasis</span> from <span class=\"customMeta\" data-dictid=\"8f584900e71692777196a6e8943d4e\">postoperative</span> factors</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Respiratory failure due to high <span class=\"customMeta\" data-dictid=\"d92cbff33316927771927b4de10a5b\">metabolic</span> demands from shock</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Primary Cause</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Atelectasis</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Increased <span class=\"customMeta\" data-dictid=\"d92cbff33316927771927b4de10a5b\">metabolic</span> demands exceed <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> capacity.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Mechanism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Alveolar collapse prevents oxygen from entering the bloodstream</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>The <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> system cannot meet oxygen demands (e.g., sepsis, fever).</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Common Etiologies</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<ul>\n\t\t\t\t<li>Pain post-surgery</li>\n\t\t\t\t<li>Sedative use</li>\n\t\t\t\t<li>Anesthesia effects</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<ul>\n\t\t\t\t<li>Sepsis</li>\n\t\t\t\t<li>Fever</li>\n\t\t\t\t<li>Cardiac events (e.g., heart attack)</li>\n\t\t\t\t<li>Blood loss leading to shock</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Management Strategy</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Often involves supportive measures, pain management, Chest physiotherapy, Incentive spirometry, Continuous positive <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> pressure (CPAP), <span class=\"customMeta\" data-dictid=\"83e66fab2f1692777190a43a6e300f\">Intubation</span> and monitoring</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Intubation for <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> support and to reduce <span class=\"customMeta\" data-dictid=\"72d435bfb11692777194f88fdb0bf3\">oxygen consumption</span> during resuscitation.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Type 1 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure (Option A): </strong>This type involves <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> (PaO2 < 60 mmHg)<strong> without hypercapnia</strong> (PaCO2 normal or decreased). While the patient is hypoxemic, her symptoms are primarily due to <span class=\"customMeta\" data-dictid=\"7a5ca69ddf16927771829cd4e4d464\">atelectasis</span> rather than conditions causing isolated hypoxemia.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Type 2 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure (Option B): </strong>Characterized by <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> along <strong>with <span class=\"customMeta\" data-dictid=\"1f0bd058f91692777189f9a7c1992e\">hypercapnia</span> </strong>(PaCO2 > 45 mmHg) and <span class=\"customMeta\" data-dictid=\"6caf3a39f416927771807e122b9032\">acidosis</span> (pH < 7.35). The patient's condition is due to <span class=\"customMeta\" data-dictid=\"8f584900e71692777196a6e8943d4e\">postoperative</span> atelectasis, not <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> depression or impaired ventilation, leading to increased CO2.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 55 y/o male with h/o pneumonia is admitted to the hospital with severe shortness of breath. O/E, his oxygen saturation is 85%, and arterial blood gas analysis shows:</p>\n\n<ul>\n\t<li>PaO2: 55 mmHg</li>\n\t<li>PaCO2: 40 mmHg</li>\n\t<li>pH: 7.38</li>\n</ul>\n\n<p>He is anxious and struggling to breathe. What is the most appropriate initial treatment for this patient\u2019s respiratory failure?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Intubation and mechanical ventilation"
      },
      {
        "id": 2,
        "text": "Noninvasive ventilation (NIV)"
      },
      {
        "id": 3,
        "text": "Oxygen therapy via a nonrebreathing mask"
      },
      {
        "id": 4,
        "text": "Continuous positive airway pressure (CPAP)"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The patient is experiencing <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">Type 1</span> <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure, characterized by hypoxemia. The most appropriate initial treatment is oxygen therapy, specifically via a nonrebreathing mask. This approach is appropriate for rapidly addressing severe <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> (PaO2 < 60 mmHg) and improving <span class=\"customMeta\" data-dictid=\"b98c3a8ea216927771949889d9505f\">oxygen saturation</span> effectively.</p>\n\n<p><strong>NRBM Mask:</strong> Delivers between 60% to 80% oxygen at a flow rate of <strong>10 to 15 L/min</strong>.</p>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"289\" src=\"https://image.prepladder.com/content/L02nOV9otWQs4iIC556j1740746862.jpg\" width=\"220\" /></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Respiratory Failure</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Treatment</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type 1 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure (Hypoxemic)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><u>Correct Hypoxemia</u>: Aim to achieve PaO\u2082 \u2265 60 mmHg or SaO\u2082 90-94%.</li>\n\t\t\t\t<li><u>Oxygen Therapy</u>: Use <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> cannula, face mask, nonrebreathing mask, or high-flow <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> cannula.</li>\n\t\t\t\t<li><u>Avoid Oxygen Toxicity</u>: Monitor to avoid excessive oxygen, which may lead to <span class=\"customMeta\" data-dictid=\"6d4575770616927771945ebf87fe75\">oxygen toxicity</span> and CO\u2082 narcosis.</li>\n\t\t\t\t<li><u>Refractory Cases</u>: Consider <span class=\"customMeta\" data-dictid=\"75d87604771692777187612563865d\">extracorporeal</span> <span class=\"customMeta\" data-dictid=\"34cd707428169277719272942b7905\">membrane</span> <span class=\"customMeta\" data-dictid=\"db3aca8a9a16927771948a3ff7512d\">oxygenation</span> (ECMO) if <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> persists despite conventional oxygen therapy.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type 2 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure (Hypercapnic)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><u>Correct <span class=\"customMeta\" data-dictid=\"1f0bd058f91692777189f9a7c1992e\">Hypercapnia</span> and Acidosis</u>: Address the underlying cause and consider <span class=\"customMeta\" data-dictid=\"f14b6fe4d3169277720152885b1b38\">ventilatory</span> support if needed.</li>\n\t\t\t\t<li><u>Noninvasive <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">Ventilation</span> (NIV):</u> Preferred for conditions like <span class=\"customMeta\" data-dictid=\"6a75d857ea1692777185f9245b02b8\">COPD</span> exacerbation, <span class=\"customMeta\" data-dictid=\"25ec593008169277718360336a849a\">cardiogenic</span> <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> edema, and <span class=\"customMeta\" data-dictid=\"c5ff3f2d211692777194ddf14e24c4\">obesity</span> <span class=\"customMeta\" data-dictid=\"272d378524169277718972cc77dc98\">hypoventilation</span> syndrome. <strong>(Option B ruled out)</strong></li>\n\t\t\t\t<li><u>Ventilatory Support</u>: <span class=\"customMeta\" data-dictid=\"ec62425aa9169277719050edbb4d55\">Intubate</span> and provide <span class=\"customMeta\" data-dictid=\"b45075a0e1169277719252465ca5ba\">mechanical ventilation</span> if severe, with goals to:\n\t\t\t\t<ul>\n\t\t\t\t\t<li>Correct <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> and <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> acidosis</li>\n\t\t\t\t\t<li>Relieve <span class=\"customMeta\" data-dictid=\"f14b6fe4d3169277720152885b1b38\">ventilatory</span> muscle fatigue</li>\n\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t\t<li><u>Mechanical <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">Ventilation</span> Indications</u>: Apnea, <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> rate >30, impaired consciousness, <span class=\"customMeta\" data-dictid=\"cdf4a197dd16927771881a652c8328\">hemodynamic</span> instability, or arterial pH < 7.25.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type 3 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Pain management</li>\n\t\t\t\t<li>Chest physiotherapy</li>\n\t\t\t\t<li>Incentive spirometry</li>\n\t\t\t\t<li>Continuous positive <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> pressure (CPAP)</li>\n\t\t\t\t<li>Intubation</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type 4 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Intubation for <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> support</li>\n\t\t\t\t<li>Reduce <span class=\"customMeta\" data-dictid=\"72d435bfb11692777194f88fdb0bf3\">oxygen consumption</span> during resuscitation</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Intubation and <span class=\"customMeta\" data-dictid=\"b45075a0e1169277719252465ca5ba\">mechanical ventilation</span> (Option A): </strong>This is typically reserved for severe <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure with indications such as apnea, severe hypoxemia, or <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> acidosis. In this case, the patient may not yet require such <span class=\"customMeta\" data-dictid=\"1c5272ad3d1692777190e71409d07a\">invasive</span> measures.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Continuous positive <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> pressure (CPAP) (Option D): </strong>CPAP can help in certain cases of <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure but is not the first-line treatment for hypoxemic <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> failure. It is more suited for patients with obstructive sleep <span class=\"customMeta\" data-dictid=\"22b9ee5b2b16927771814b5d8d34ac\">apnea</span> or <span class=\"customMeta\" data-dictid=\"25ec593008169277718360336a849a\">cardiogenic</span> <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> oedema.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/L02nOV9otWQs4iIC556j1740746862.jpg"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 30 y/o female presents with h/o wheezing and shortness of breath. A pulmonary function test shows a flow-volume loop with a distinct \"scooped\" appearance during expiration, particularly at lower lung volumes. Which condition does this flow-volume loop most likely represent?</p>\n\n<p style=\"text-align:center\"><img alt=\"B\" data-author=\"\" data-hash=\"11434\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"399\" src=\"https://image.prepladder.com/notes/Lb95R002Mw1osU2j6KmE1746000101.png\" width=\"399\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary Fibrosis"
      },
      {
        "id": 2,
        "text": "Asthma"
      },
      {
        "id": 3,
        "text": "Retrosternal Goiter"
      },
      {
        "id": 4,
        "text": "Normal"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Asthma (Airflow Obstruction):</strong></p>\n\n<ul>\n\t<li>Narrowed airways due to smooth muscle <span class=\"customMeta\" data-dictid=\"4880e9b3761692777185e64eba797c\">constriction</span> and <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> reduce <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> airflow, causing a \u201cscooped\u201d appearance, especially at lower lung volumes.</li>\n\t<li>Flow may improve after <span class=\"customMeta\" data-dictid=\"16abe8467e16927771837550ea9798\">bronchodilator</span> use.</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"B\" data-author=\"\" data-hash=\"11434\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"338\" src=\"https://image.prepladder.com/notes/Lb95R002Mw1osU2j6KmE1746000101.png\" width=\"338\" /></p>\n\n<p><strong>Pulmonary <span class=\"customMeta\" data-dictid=\"21e2d5a70616927772021fcdec0ca9\">Fibrosis</span> (Option A): </strong></p>\n\n<ul>\n\t<li>High lung <span class=\"customMeta\" data-dictid=\"b45dda9ea71692777197cbb7b1cab1\">recoil</span> pressure increases <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> flow for any given lung volume, producing a loop that is shifted to lower volumes and shows high <span class=\"customMeta\" data-dictid=\"c678bddb1d1692777192d2ee1ebd92\">maximal</span> flow relative to volume.</li>\n\t<li>Overall lung volumes (TLC, FRC) are <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> due to increased stiffne</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"C\" data-author=\"\" data-hash=\"11433\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"912\" src=\"https://image.prepladder.com/notes/QxJpCviWWAetyPpYWiT91745999917.png\" width=\"912\" /></p>\n\n<p>\u00a0</p>\n\n<p><strong>Retrosternal <span class=\"customMeta\" data-dictid=\"2aa25c8cad1692777188842dd483eb\">Goiter</span> (Option C): </strong></p>\n\n<p>Extrathoracic <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> narrowing can limit inspiratory flow, causing <span class=\"customMeta\" data-dictid=\"13d0edf82916927772021bfc7f9aeb\">flattening</span> of the inspiratory portion of the loop.</p>\n\n<p style=\"text-align:center\"><img alt=\"D\" data-author=\"\" data-hash=\"11432\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"353\" src=\"https://image.prepladder.com/notes/0fecFhYEmUJTBUjHmVTj1745999871.png\" width=\"353\" /></p>\n\n<p>\u00a0</p>\n\n<p><strong>Normal Flow volume loop (Option D):</strong></p>\n\n<p>A normal flow-volume loop displays <span class=\"customMeta\" data-dictid=\"99caf903791692777180bc28743310\">airflow</span> (in L/second) related to lung volume (in L) during <span class=\"customMeta\" data-dictid=\"c678bddb1d1692777192d2ee1ebd92\">maximal</span> inspiration from complete <span class=\"customMeta\" data-dictid=\"b8e1ca39d61692777187254f3cc140\">exhalation</span> <span class=\"customMeta\" data-dictid=\"a459f313d9169277719789fdfb7ada\">residual</span> volume (RV) and maximum <span class=\"customMeta\" data-dictid=\"2cbabc42d21692777187c451566867\">expiration</span> from <span class=\"customMeta\" data-dictid=\"b0e95f9af21692777200e8a9faabe7\">total lung capacity</span> (TLC).</p>\n\n<p style=\"text-align:center\"><img alt=\"B\" data-author=\"\" data-hash=\"11431\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"513\" src=\"https://image.prepladder.com/notes/6zwM81wwJYB9T2tibLTw1745999743.png\" width=\"513\" /></p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p style=\"text-align:center\"><img alt=\"Flow volume Loops\" data-author=\"\" data-hash=\"11437\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"540\" src=\"https://image.prepladder.com/notes/7kcdpOWrURfQU2UAD7VZ1746001270.png\" width=\"540\" /></p>\n\n<p>\u00a0</p>\n\n<p style=\"text-align:center\"><img alt=\"FVL\" data-author=\"\" data-hash=\"11439\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/tE6GPv3lsexhsxcBLgcB1746001300.png\" /></p>",
    "question_images": [
      "https://image.prepladder.com/notes/Lb95R002Mw1osU2j6KmE1746000101.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/Lb95R002Mw1osU2j6KmE1746000101.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Match the following diseases with their respective flow volume curves:</p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:NaN\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>1. Asthma</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>a)\u00a0</p>\n\n\t\t\t<p style=\"text-align:center\"><img alt=\"A\" data-author=\"\" data-hash=\"11430\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"252\" src=\"https://image.prepladder.com/notes/1GOVMyXa1fGxJ08M4RSn1745999702.png\" width=\"252\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>2. Extrathoracic Obstruction</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>b)\u00a0</p>\n\n\t\t\t<p style=\"text-align:center\"><img alt=\"B\" data-author=\"\" data-hash=\"11434\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"323\" src=\"https://image.prepladder.com/notes/Lb95R002Mw1osU2j6KmE1746000101.png\" width=\"323\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>3. Fixed Obstruction</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>c)\u00a0</p>\n\n\t\t\t<p style=\"text-align:center\"><img alt=\"C\" data-author=\"\" data-hash=\"11433\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"338\" src=\"https://image.prepladder.com/notes/QxJpCviWWAetyPpYWiT91745999917.png\" width=\"338\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>4. Restrictive Airway Disorders</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>d)\u00a0</p>\n\n\t\t\t<p style=\"text-align:center\"><img alt=\"D\" data-author=\"\" data-hash=\"11432\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"334\" src=\"https://image.prepladder.com/notes/0fecFhYEmUJTBUjHmVTj1745999871.png\" width=\"334\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "choices": [
      {
        "id": 1,
        "text": "1-d, 2-a, 3-c, 4-b"
      },
      {
        "id": 2,
        "text": "1-a, 2-c, 3-d, 4-b"
      },
      {
        "id": 3,
        "text": "1-b, 2-d, 3-a, 4-c"
      },
      {
        "id": 4,
        "text": "1-c, 2-b, 3-d, 4-a"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<table cellspacing=\"0\" style=\"border-collapse:collapse; width:NaN\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Conditions</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Flow Volume Loops</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Normal (article)</strong></p>\n\n\t\t\t<p>A normal flow-volume loop displays <span class=\"customMeta\" data-dictid=\"99caf903791692777180bc28743310\">airflow</span> (in L/second) related to lung volume (in L) during <span class=\"customMeta\" data-dictid=\"c678bddb1d1692777192d2ee1ebd92\">maximal</span> inspiration from <span class=\"customMeta\" data-dictid=\"a459f313d9169277719789fdfb7ada\">residual</span> volume (RV) and maximum <span class=\"customMeta\" data-dictid=\"2cbabc42d21692777187c451566867\">expiration</span> from <span class=\"customMeta\" data-dictid=\"b0e95f9af21692777200e8a9faabe7\">total lung capacity</span> (TLC).</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\"><img alt=\"B\" data-author=\"\" data-hash=\"11431\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"650\" src=\"https://image.prepladder.com/notes/6zwM81wwJYB9T2tibLTw1745999743.png\" width=\"650\" /></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Asthma (Airflow Obstruction): </strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Narrowed airways due to smooth muscle <span class=\"customMeta\" data-dictid=\"4880e9b3761692777185e64eba797c\">constriction</span> and <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> reduce <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> airflow, causing a \u201cscooped\u201d appearance, especially at lower lung volumes.</li>\n\t\t\t\t<li>Flow may improve after <span class=\"customMeta\" data-dictid=\"16abe8467e16927771837550ea9798\">bronchodilator</span> use.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><img alt=\"B\" data-author=\"\" data-hash=\"11434\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/Lb95R002Mw1osU2j6KmE1746000101.png\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Retrosternal <span class=\"customMeta\" data-dictid=\"2aa25c8cad1692777188842dd483eb\">Goiter</span> (Extrathoracic Obstruction): </strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Extrathoracic <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> narrowing can limit inspiratory flow, causing <span class=\"customMeta\" data-dictid=\"13d0edf82916927772021bfc7f9aeb\">flattening</span> of the inspiratory portion of the loop.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><img alt=\"D\" data-author=\"\" data-hash=\"11432\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" height=\"594\" src=\"https://image.prepladder.com/notes/0fecFhYEmUJTBUjHmVTj1745999871.png\" width=\"594\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Intrathoracic Fixed Obstruction:</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Fixed <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> <span class=\"customMeta\" data-dictid=\"39f44b27bf169277719416f29a74ee\">obstruction</span> within the chest affects both inspiration and expiration, resulting in flattened, plateaued loops on both sides of the flow-volume curve.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><img alt=\"A\" data-author=\"\" data-hash=\"11430\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/1GOVMyXa1fGxJ08M4RSn1745999702.png\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Restrictive <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">Airway</span> Disorders (e.g., <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">Pulmonary</span> Fibrosis): </strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>High lung <span class=\"customMeta\" data-dictid=\"b45dda9ea71692777197cbb7b1cab1\">recoil</span> pressure increases <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">expiratory</span> flow for any given lung volume, producing a loop that is shifted to lower volumes and shows high <span class=\"customMeta\" data-dictid=\"c678bddb1d1692777192d2ee1ebd92\">maximal</span> flow relative to volume.</li>\n\t\t\t\t<li>Overall lung volumes (TLC, FRC) are <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> due to increased stiffness.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><img alt=\"C\" data-author=\"\" data-hash=\"11433\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/QxJpCviWWAetyPpYWiT91745999917.png\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [
      "https://image.prepladder.com/notes/1GOVMyXa1fGxJ08M4RSn1745999702.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/6zwM81wwJYB9T2tibLTw1745999743.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 72-year-old female patient presents with progressive shortness of breath and a persistent dry cough. She has a history of pulmonary fibrosis diagnosed two years ago. Spirometry shows reduced lung volumes. Which of the following is most likely true regarding this patient\u2019s spirometry results?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "FVC is likely to be increased."
      },
      {
        "id": 2,
        "text": "FEV1/FVC ratio is likely > 80%."
      },
      {
        "id": 3,
        "text": "TLC is likely normal or increased."
      },
      {
        "id": 4,
        "text": "RV is likely normal or increased."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient likely has restrictive lung disease due to <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> fibrosis, characterized by <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> lung volumes and an increased FEV1/FVC ratio on spirometry.</p>\n\n<p>Spirometric parameters are essential for evaluating lung function and diagnosing <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> conditions. Key parameters include:</p>\n\n<p><img alt=\"Lung Volumes\" data-author=\"\" data-hash=\"11459\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/jXTYr1WuQo1UtVDddlkS1746007663.png\" /></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:721px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Parameter</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Description</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Normal Value </strong></p>\n\n\t\t\t<p><strong>(Litres)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Tidal Volume (TV)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>The volume of air inhaled or exhaled in one cycle</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>0.5 - 0.7 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Inspiratory Reserve Volume (IRV)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Additional air that can be forcibly inhaled after normal inhalation</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>1.5 - 3.0 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Expiratory Reserve Volume (ERV)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Additional air that can be forcibly exhaled after normal exhalation</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>1.0 - 1.5 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Residual Volume (RV)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>The volume of air remaining in the lungs after maximum exhalation</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>1.0 - 1.5 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Total Lung Capacity (TLC)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Maximum volume the lungs can hold (TV + <span class=\"customMeta\" data-dictid=\"9cea17d64b16927771905278e8ea88\">IRV</span> + <span class=\"customMeta\" data-dictid=\"5a6905fdca16927771879daba1b8d2\">ERV</span> + RV)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>4.5 - 6.0 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Vital Capacity (VC)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Total air that can be exhaled after maximum <span class=\"customMeta\" data-dictid=\"0b1500fcd816927771900b59d16bde\">inhalation</span> (TV + <span class=\"customMeta\" data-dictid=\"9cea17d64b16927771905278e8ea88\">IRV</span> + ERV)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>3.0 - 5.0 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Functional <span class=\"customMeta\" data-dictid=\"a459f313d9169277719789fdfb7ada\">Residual</span> Capacity (FRC)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>The volume of air remaining after normal <span class=\"customMeta\" data-dictid=\"b8e1ca39d61692777187254f3cc140\">exhalation</span> (ERV + RV)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>2.0 - 2.5 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Forced <span class=\"customMeta\" data-dictid=\"632c0c215816927771878b6e818a11\">Expiratory</span> Volume in 1 second (FEV1)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>The volume of air forcefully exhaled in the first second of a forced expiration</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>3.0 - 4.0 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Forced <span class=\"customMeta\" data-dictid=\"187bb6b3f61692777201956c59ce72\">Vital Capacity</span> (FVC)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Total amount of air exhaled during a forced expiration</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>3.5 - 5.0 L</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Predicted <span class=\"customMeta\" data-dictid=\"8f584900e71692777196a6e8943d4e\">Postoperative</span> FEV1 (PPO FEV1)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Postoperative risk assessment <span class=\"customMeta\" data-dictid=\"9f524cc9601692777194d19de23a85\">parameter</span> for <span class=\"customMeta\" data-dictid=\"3c6021096816927772007954fcc158\">thoracic</span> surgery</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Varies based on patient's condition</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Restrictive Lung Disease:</strong></p>\n\n<ul>\n\t<li><strong>Decreased</strong>:\n\n\t<ul>\n\t\t<li>Total Lung Capacity (TLC) < 80% of predicted value <strong>(Option C ruled out)</strong></li>\n\t\t<li>Forced <span class=\"customMeta\" data-dictid=\"187bb6b3f61692777201956c59ce72\">Vital Capacity</span> (FVC) <strong>(Option A ruled out)</strong></li>\n\t\t<li>FEV1 (but <span class=\"customMeta\" data-dictid=\"321620bde416927772037669a00aa5\">FVC</span> decreases more than FEV1) <strong>(Option B)</strong></li>\n\t</ul>\n\t</li>\n\t<li><strong>Increased</strong>:\n\t<ul>\n\t\t<li>FEV1/FVC ratio > 80%</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>Obstructive Lung Disease:</strong></p>\n\n<ul>\n\t<li><strong>Decreased</strong>:\n\n\t<ul>\n\t\t<li>FEV1 (maximum <span class=\"customMeta\" data-dictid=\"99caf903791692777180bc28743310\">airflow</span> is reduced)</li>\n\t</ul>\n\t</li>\n\t<li><strong>Increased</strong>:\n\t<ul>\n\t\t<li>RV/TLC ratio (will increase regardless of changes in VC)</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>Obesity:</strong></p>\n\n<ul>\n\t<li><strong>Decreased</strong>:\n\n\t<ul>\n\t\t<li>Functional <span class=\"customMeta\" data-dictid=\"a459f313d9169277719789fdfb7ada\">Residual</span> Capacity (FRC)</li>\n\t</ul>\n\t</li>\n\t<li><strong>Increased:</strong>\n\t<ul>\n\t\t<li>Restrictive patterns due to mechanical effects on the lungs</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><br />\n<strong>RV is likely normal or increased. (Option D): </strong>RV is generally normal or decreased in restrictive lung disease.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/jXTYr1WuQo1UtVDddlkS1746007663.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 45 y/o man with a history of COPD presents with shortness of breath, cough, and increased sputum production. His arterial blood gas (ABG) analysis shows hypoxemia, and his calculated A-a gradient is elevated. Which of the following is the most likely cause for the elevated A-a gradient in this patient?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Ventilation-perfusion mismatch"
      },
      {
        "id": 2,
        "text": "Hypoventilation"
      },
      {
        "id": 3,
        "text": "Reduced cardiac output"
      },
      {
        "id": 4,
        "text": "Low-inspired oxygen (FiO2)"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>COPD causes a mismatch between <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">ventilation</span> and <span class=\"customMeta\" data-dictid=\"82cc227a1c169277718387905b50c6\">blood flow</span> in the lungs, leading to <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> and an elevated A-a gradient.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Alveolar-Arterial <span class=\"customMeta\" data-dictid=\"04136f692516927771888cf07d46a4\">Gradient</span> (A-a Gradient): </strong>The A-a <span class=\"customMeta\" data-dictid=\"04136f692516927771888cf07d46a4\">gradient</span> measures the difference in oxygen pressure between <span class=\"customMeta\" data-dictid=\"0dd428c12116927771819285c8849c\">alveoli</span> (PAO2) and <span class=\"customMeta\" data-dictid=\"b905d8d51416927771821f9cceb3a3\">arterial blood</span> (PaO2). It is useful in assessing <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> origins, and differentiating between alveolar-capillary unit <span class=\"customMeta\" data-dictid=\"3662597407169277718640a12868f5\">dysfunction</span> and <span class=\"customMeta\" data-dictid=\"728e7607f31692777187291e007a0b\">extrapulmonary</span> causes.</p>\n\n<p style=\"text-align:center\">A-a <span class=\"customMeta\" data-dictid=\"04136f692516927771888cf07d46a4\">Gradient</span> = PAO\u2082 - PaO\u2082</p>\n\n<p style=\"text-align:center\">Normal A-a <span class=\"customMeta\" data-dictid=\"04136f692516927771888cf07d46a4\">gradient</span> = (Age in years + 10) / 4</p>\n\n<p><img alt=\"IM801 Alveolar-Arterial <span class=\"customMeta\" data-dictid=\"04136f692516927771888cf07d46a4\">Gradient</span> (A-a Gradient)-01.png\" data-author=\"\" data-hash=\"11458\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/1QZcoQ2sQDwJKsjKR7n71746007562.png\" /></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type 1 <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">Respiratory</span> Failure Etiologies</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Normal A-a gradient</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Increased A-a gradient</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Alveolar hypoventilation</li>\n\t\t\t\t<li>Low atmospheric pressure/ <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">Fracture</span> of inspired oxygen</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Diffusion defect:</strong> Impaired gas exchange leading to \u2193PaO\u2082 due to thickened alveolar membrane. In <span class=\"customMeta\" data-dictid=\"279b1fbead1692777187ddfd24c257\">emphysema</span> and <span class=\"customMeta\" data-dictid=\"f46ba26d111692777190def3b1d80a\">Interstitial</span> Lung disease.</li>\n\t\t\t\t<li><strong>V/Q mismatch: </strong>Most common cause of Hypoxemia. Occurs when there is an <span class=\"customMeta\" data-dictid=\"2cc844bc9c1692777189739abf1dc5\">imbalance</span> between <span class=\"customMeta\" data-dictid=\"a58f1f33f81692777201ad5e0d60ca\">ventilation</span> and perfusion. Examples<strong> </strong>- <strong>COPD, <span class=\"customMeta\" data-dictid=\"76891bb6e91692777182cda16e1db6\">Asthma</span> </strong>pulmonary embolism, ARDS, CHF</li>\n\t\t\t\t<li>Right to left shunts - Blood bypasses the lungs without gas exchange.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Hypoventilation (Option B): </strong>Hypoventilation typically results in a normal A-a gradient, as both alveolar and arterial oxygen levels decrease simultaneously.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Reduced <span class=\"customMeta\" data-dictid=\"e1fb96fd2416927771830dfed40e14\">cardiac</span> output (Option C): </strong>While it can reduce overall oxygen delivery, it does not usually affect the A-a gradient.</p>\n\n<p><br />\n<strong>Low-inspired oxygen (FiO2) (Option D): </strong>Reduced FiO2 can lead to <span class=\"customMeta\" data-dictid=\"9f81027f0116927771892823259e5d\">hypoxemia</span> but typically does not result in an elevated A-a gradient.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 50 y/o male presents with worsening dyspnea. His pulmonary function test reveals a significant reduction in DLCO. Which of the following is the most likely cause for the low DLCO?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary hemorrhage"
      },
      {
        "id": 2,
        "text": "Obesity"
      },
      {
        "id": 3,
        "text": "Pulmonary fibrosis"
      },
      {
        "id": 4,
        "text": "Acute Congestive Heart Failure"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Pulmonary <span class=\"customMeta\" data-dictid=\"21e2d5a70616927772021fcdec0ca9\">fibrosis</span> involves <strong>scarring and thickening of the alveolar-capillary membrane</strong>, which <strong>impairs gas exchange</strong> and <strong>reduces the <span class=\"customMeta\" data-dictid=\"9c760dcb641692777186f4cda5dc95\">diffusion</span> capacity</strong> of the lung (DLCO). It is one of the <strong>causes of low DLCO</strong>. Patients typically present with progressive dyspnea, especially on exertion, and have <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> DLCO on PFTs.\u00a0</p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:NaN\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Diffusion Capacity of the Lung for <span class=\"customMeta\" data-dictid=\"bb021d26d3169277718336718849a5\">Carbon Monoxide</span> (DLCO)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>The DLCO test measures how much <span class=\"customMeta\" data-dictid=\"44758fcec31692777184e24fa84582\">CO</span> moves from the <span class=\"customMeta\" data-dictid=\"0dd428c12116927771819285c8849c\">alveoli</span> into the red blood cells each minute. This test is vital because it shows how efficiently the lungs can transfer oxygen from the air we breathe into the bloodstream, making it an important tool for diagnosing and <span class=\"customMeta\" data-dictid=\"ebb0986d331692777200ab09e1b2e8\">tracking</span> various lung conditions.</p>\n\n\t\t\t<p style=\"text-align:center\"><img alt=\"Spirometry\" data-author=\"\" data-hash=\"11456\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/W5v2ixsJNs5X7Ee3Icgg1746007427.png\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Increased DLCO</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Decreased DLCO</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Increases with increased availability of surface area and haemoglobin in capillaries</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Due to the thickened or destruction of the alveolar <span class=\"customMeta\" data-dictid=\"34cd707428169277719272942b7905\">membrane</span> and factors affecting vasculature.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Asthma</li>\n\t\t\t\t<li>Polycythemia</li>\n\t\t\t\t<li>Acute <span class=\"customMeta\" data-dictid=\"b0eb48bbf6169277718568c051e6ad\">congestive heart failure</span> <strong>(Option D ruled out)</strong></li>\n\t\t\t\t<li>Exercise</li>\n\t\t\t\t<li>Obesity <strong>(Option B ruled out)</strong></li>\n\t\t\t\t<li>Pulmonary haemorrhage <strong>(Option A ruled out)</strong></li>\n\t\t\t\t<li>Altitude</li>\n\t\t\t\t<li>Bronchodilator usage</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Pulmonary <span class=\"customMeta\" data-dictid=\"21e2d5a70616927772021fcdec0ca9\">fibrosis</span> (Option C)</strong></li>\n\t\t\t\t<li>Emphysema</li>\n\t\t\t\t<li>Pulmonary hypertension</li>\n\t\t\t\t<li>Anaemia</li>\n\t\t\t\t<li>COPD</li>\n\t\t\t\t<li>Bronchiolitis</li>\n\t\t\t\t<li>Cystic fibrosis</li>\n\t\t\t\t<li>Pleural effusion</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><img alt=\"FEV1-FVC ratio\" data-author=\"\" data-hash=\"11457\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/vztpnmBZA7rgLiOeBUuC1746007480.png\" /></p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/W5v2ixsJNs5X7Ee3Icgg1746007427.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  }
];
        let quizName = '80 Respiratory Physiology And Failure';
        let hierarchy = ["PrepLadder", "qBank", "Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>