<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 027 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The spinal cord develops from the______.",
    "choices": [
      {
        "id": 1,
        "text": "Neural tube"
      },
      {
        "id": 2,
        "text": "Notochord"
      },
      {
        "id": 3,
        "text": "Primitive streak"
      },
      {
        "id": 4,
        "text": "Rhombencephalon"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> spinal cord</strong> develops from the <strong>caudal part</strong> of the <strong>neural tube</strong>.</p>\n<p>The nervous system develops from the neurectoderm, the specialized ectoderm overlying the notochord. The neuroectoderm initially thickens to form the neural plate. The neural plate is then converted to a neural groove, followed by a neural tube.</p>\n<ul>\n<li>The <strong>enlarged cranial part</strong> of <strong>neural tube</strong> forms the&nbsp;<strong>brain</strong>. It has 3 primary vesicles that form forebrain (<strong>prosencephalon</strong>), midbrain (<strong>mesencephalon</strong>), and hindbrain (<strong>rhombencephalon</strong>).&nbsp;</li>\n<li>The <strong>narrow caudal part</strong> of the <strong>neural tube</strong> forms the&nbsp;<strong>spinal cord</strong>.&nbsp;&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/feed6fb23fa3410ebf3facb5d7b05954x651x525.JPEG"
    ]
  },
  {
    "text": "Following complete ileal and partial jejunal resection, the patient is most likely to have",
    "choices": [
      {
        "id": 1,
        "text": "Folic acid deficiency"
      },
      {
        "id": 2,
        "text": "Vitamin B12 deficiency"
      },
      {
        "id": 3,
        "text": "Gastric ulcer"
      },
      {
        "id": 4,
        "text": "Constipation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>After complete ileal and partial jejunal resection, the patient is likely to have <strong>vitamin B12 deficiency.</strong></p>\n<p>Vitamin B12 is absorbed in the ileum. Vitamin B12 binds to intrinsic factor, a protein secreted by the parietal cells of the stomach, and the complex is absorbed across the ileal mucosa. Hence after ileal resection, there is impaired absorption of vitamin B12.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 8 month-old baby is brought to the pediatric clinic with symptoms of diarrhea, hair loss and failure to thrive. On clinical examination, there is inflammation of the skin around the mouth and the perianal region. The mineral deficiency responsible for this disease is?",
    "choices": [
      {
        "id": 1,
        "text": "Zinc"
      },
      {
        "id": 2,
        "text": "Selenium"
      },
      {
        "id": 3,
        "text": "Chromium"
      },
      {
        "id": 4,
        "text": "Copper"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The symptoms and clinical findings, strongly suggest a diagnosis of&nbsp;<strong>Acrodermatitis enteropathica</strong> which is due to the <strong>deficiency of zinc.</strong></p>\n<p>It is an autosomal recessive disease due to a defect in <strong>zinc absorbing transmembrane protein.</strong></p>\n<p><strong>Symptoms:</strong></p>\n<ul>\n<li>Growth retardation</li>\n<li>Diarrhea</li>\n<li>Alopecia</li>\n<li>Rash involving the extremities, face, and perineum(rash is characterized by <strong>vesicular</strong> and <strong>pustular crusting </strong>with scaling and erythema)</li>\n<li>Gonadal atrophy</li>\n<li>Muscle wasting</li>\n<li>Impaired wound healing</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/31b2498bd4ef4579a913c4cd72c86a30x428x521.PNG"
    ]
  },
  {
    "text": "A 50-year-old HIV seropositive male presents with raised violaceous plaques over the distal portion of the lower limbs. Biopsy shows a lesion composed of proliferating spindle cells along with small vessels and spaces containing red cells. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cavernous hemangioma"
      },
      {
        "id": 2,
        "text": "Kaposi sarcoma"
      },
      {
        "id": 3,
        "text": "Dermatofibroma"
      },
      {
        "id": 4,
        "text": "Mycosis fungoides"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario and the histopathological findings are most suggestive of <strong>Kaposi sarcoma</strong>.</p>\n<p><strong>Kaposi sarcoma </strong>is a vascular neoplasm caused by<strong> human herpesvirus 8 </strong>(HHV8) and is <strong>highly associated with AIDS</strong> (acquired immunodeficiency syndrome).</p>\n<p><strong>Classic Kaposi sarcoma</strong> occurs in<strong>&nbsp;older men&nbsp;of </strong>Eastern European and Meditteranean descent and has the following three clinical stages:</p>\n<ul>\n<li><strong>Patches</strong>- red-purple macules on the distal lower extremities</li>\n<li><strong><strong>Plaques-&nbsp;</strong></strong>patches progress to large violaceous raised plaques. Lesions spread proximally.</li>\n<li><strong>Nodules- </strong>Lesions become nodular with more neoplastic features. This stage also progresses to involve nodes and viscera.</li>\n</ul>\n<p>The given images show coalescent red-purple macules and plaques of the skin and the histologic appearance of Kaposi sarcoma, demonstrating sheets of proliferating spindle cells:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/85daf75865344e4cae4f35186252c544x1012x675.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/985d8f3002fd466cbcf4c1e6182199f2x1280x880.JPEG"
    ]
  },
  {
    "text": "A 70-year-old woman was diagnosed with right leg cellulitis and was admitted to the hospital for 3 days. She was prescribed clindamycin. Two days after her discharge, she developed diarrhea and abdominal pain. Her temperature was 38.8 degrees Celcius. Her blood reports are given below. What is the most probable etiological agent?",
    "choices": [
      {
        "id": 1,
        "text": "Clostridium difficile"
      },
      {
        "id": 2,
        "text": "Escherichia coli"
      },
      {
        "id": 3,
        "text": "Norovirus"
      },
      {
        "id": 4,
        "text": "Rotavirus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical vignette of a patient with hospital-acquired diarrhea (nosocomial) following antibiotic administration is suggestive of <strong>pseudomembranous colitis</strong> due to\u00a0<strong><em>Clostridium difficile.</em>\u00a0</strong></p>\n<p>Clostridium difficile is the <strong>most common cause of infectious diarrhea</strong> in nosocomial infection.\u00a0</p>\n<p><span data-preserver-spaces=\"true\">It is the <strong>most common antibiotic-associated diarrhea</strong>. It is commonly seen in individuals who receive a prolonged antibiotic course, which causes a change in the composition of gastrointestinal microbial flora, leading to colonization of C. difficile.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Clinical features:</span></strong></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Lower abdominal pain with loose watery diarrhea.</span></li>\n<li>Fever, leukocytosis</li>\n<li><span data-preserver-spaces=\"true\">In some patients, the disease may progress to life-threatening pseudomembranous colitis</span></li>\n</ul>\n<p><strong><span data-preserver-spaces=\"true\">Investigations</span></strong><span data-preserver-spaces=\"true\">:</span></p>\n<ul>\n<li>Nucleic acid amplification tests, including polymerase chain reaction assays, for C. difficile toxin A or B gene in stool\u00a0</li>\n<li>Stool culture in selective media</li>\n<li>Demonstrating toxin by cell cytotoxin cultures</li>\n<li>Toxin gene identification by enzyme immunoassay</li>\n<li>Colonoscopy or sigmoidoscopy\u00a0<span data-preserver-spaces=\"true\">reveals a characteristic</span><strong><span data-preserver-spaces=\"true\">\u00a0pseudomembrane.</span></strong></li>\n</ul>\n<p>Nucleic acid amplification tests, including PCR assays, for C. difficile toxin A or B gene in stool, have now been approved for diagnostic purposes and appear to be both rapid and sensitive while retaining high specificity.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Maraviroc is a chemokine receptor antagonist against the following receptor _______",
    "choices": [
      {
        "id": 1,
        "text": "CCR5"
      },
      {
        "id": 2,
        "text": "CXCR4"
      },
      {
        "id": 3,
        "text": "CD4"
      },
      {
        "id": 4,
        "text": "CCR5 and CD4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Maraviroc </strong>is a<strong> chemokine receptor antagonist </strong>acting against the CCR5 receptor. It&nbsp;binds to host cell <strong>CCR-5 receptor</strong> and <strong>prevents binding of viral gp-120 </strong>to host cells. It is indicated in patients with evidence of <strong>infection with predominantly CCR-5 tropic virus.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents to the E.R. with a history of a gunshot wound sustained while on a hunting trip. X-ray findings are as given below. Which of the following weapons is most likely to produce this type of lesion?",
    "choices": [
      {
        "id": 1,
        "text": "Shotgun"
      },
      {
        "id": 2,
        "text": "Assault rifle"
      },
      {
        "id": 3,
        "text": "Sporting rifle"
      },
      {
        "id": 4,
        "text": "Machine gun"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given radiograph shows birdshot pellets within and around the shattered patella, distal femur, and proximal tibia. The wound shown in the image is most likely to have been caused by a close-range shotgun injury to the knee.</p>\n<p>The ammunition for the shotgun is a cartridge made of a <strong>cardboard or plastic cylinder</strong> fitted into a <strong>metal base</strong>. The base carries a <strong>percussion detonator</strong> that is struck by the spring-loaded firing pin when the trigger is pulled.\u00a0 The\u00a0<strong>primer\u00a0</strong>is located in the percussion cup and contains the detonator.\u00a0 The cartridge contains a charge of <strong>propellant (gunpowder)</strong>, above which are \u2018<strong>wads</strong>\u2019 or pistons of felt, and cardboard or plastic\u00a0discs, or both. Above these is the <strong>charge of shot (pellets)</strong>, which varies greatly in number and size, finally covered by a card or plastic disc.</p>\n<p>The image given below shows the entry wound in the case of a shotgun. There is a <strong>central round hole,</strong> with <strong>multiple pellet holes</strong> scattered around the central hole.\u00a0This wound is most likely to have been caused by a shotgun from a range of<strong> 1-5 m.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/38301d075bf54b12aea8ac0326954330.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da24e106f4db44e7bd1abbdbbb3b617ex720x683.JPEG"
    ]
  },
  {
    "text": "Symptoms of sinusitis includes all except",
    "choices": [
      {
        "id": 1,
        "text": "Headache"
      },
      {
        "id": 2,
        "text": "Nasal blockage"
      },
      {
        "id": 3,
        "text": "Diplopia"
      },
      {
        "id": 4,
        "text": "Nasal discharge"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Diplopia</strong> is <strong>not seen</strong> in sinusitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The corneal epithelium is composed of_______.",
    "choices": [
      {
        "id": 1,
        "text": "Stratified keratinized epithelium"
      },
      {
        "id": 2,
        "text": "Stratified non-keratinized epithelium"
      },
      {
        "id": 3,
        "text": "Columnar epithelium"
      },
      {
        "id": 4,
        "text": "Pseudostratified epithelium"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>The corneal epithelium</strong> is made up of <strong>stratified squamous non-keratinized epithelium.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/64c9d0650104451f93a76ed45bf371e7x1200x1471.JPEG"
    ]
  },
  {
    "text": "Which of the following steps of disaster management is in correct order?",
    "choices": [
      {
        "id": 1,
        "text": "Disaster impact \u2013 Mitigation \u2013 Rehabilitation \u2013 Response"
      },
      {
        "id": 2,
        "text": "Rehabilitation \u2013 Response \u2013 Disaster Impact \u2013 Mitigation"
      },
      {
        "id": 3,
        "text": "Disaster impact \u2013 Response \u2013 Rehabilitation \u2013 Mitigation"
      },
      {
        "id": 4,
        "text": "Response \u2013 Disaster impact \u2013 Rehabilitation \u2013 Mitigation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Disaster Management includes three aspects:</p>\n<p><strong>1. Disaster impact and response:</strong>&nbsp;</p>\n<p>&nbsp;&nbsp;Involves immediate management of mass casualties</p>\n<ul>\n<li>Search, rescue, and first-aid</li>\n<li>Field care</li>\n<li>Triage</li>\n<li>Tagging</li>\n<li>Identification of dead</li>\n</ul>\n<p><strong>2. Rehabilitation or recovery:</strong></p>\n<p><strong>&nbsp; &nbsp;</strong>Involves restoration of the pre-disaster conditions</p>\n<ul>\n<li>Water supply</li>\n<li>Basic sanitation and personal hygiene</li>\n<li>Food safety</li>\n<li>Vector control</li>\n</ul>\n<p><strong>3. Mitigation</strong>: Measures designed either to&nbsp;<strong>prevent hazards&nbsp;</strong>from causing disaster&nbsp;or to reduce the effects of the disaster. This also includes<strong>&nbsp;preparedness&nbsp;</strong>for any impending disasters or in disaster-prone areas.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/941cdb2b237749b8991ab1862d290506x421x391.JPEG"
    ]
  },
  {
    "text": "Below is a diagram depicting the natural history of the disease. Which point marks the onset of symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Point A"
      },
      {
        "id": 2,
        "text": "Point B"
      },
      {
        "id": 3,
        "text": "Point C"
      },
      {
        "id": 4,
        "text": "Point D"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Point C represents a point where signs and symptoms appear.</p>\n<p>Various points marked in the image represent the following:</p>\n<p>Point A: Entry of <strong>infectious agent</strong> into the host.</p>\n<p>Point B: <strong>Pathological</strong> and physiological changes occur in the stage of the<strong> s</strong><strong>ubclinical phase. </strong>These changes are&nbsp;induced by the causative agent but are not sufficient enough to cause clinical signs and symptoms.</p>\n<p>Point C: Marks <strong>onset</strong> of clinical <strong>signs</strong> and <strong>symptoms.</strong></p>\n<p>Point D: Usual <strong>time of diagnosis </strong>at which&nbsp;clinical&nbsp;signs&nbsp;and&nbsp;symptoms&nbsp;are well&nbsp;evident.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4457162496be4911811fe5d4cc1f6d18.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/286471cc5d894f4eb0c2b760ad0b91a0x1280x908.JPEG"
    ]
  },
  {
    "text": "In a population study, the value of the mean is 200. If the standard deviation is 20, 68% of the population will lie between?",
    "choices": [
      {
        "id": 1,
        "text": "180- 220"
      },
      {
        "id": 2,
        "text": "160- 240"
      },
      {
        "id": 3,
        "text": "170- 230"
      },
      {
        "id": 4,
        "text": "190- 210"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>68%</strong> of the population will lie between <strong>180- 220</strong>.</p>\n<p>In a normal distribution curve,&nbsp;<strong>68%</strong> of the values lie within the&nbsp;<strong>median +/- 1 standard deviation </strong>and the mean=median=mode<strong>.</strong> Since the mean = 200 and the standard deviation = 20:</p>\n<p><strong>68%</strong> of population will lie between&nbsp;<strong>Median +/- 1SD</strong>, that is,&nbsp;200 +/- 20 = 180-220</p>\n<p>95% of population lies between Median+/-2SD, 200+/- 2*20 = 160- 240</p>\n<p>99% of population lies between Median+/-3SD, 200+/- 3*20 = 140- 260</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a patient with suspected stable angina, which of the following findings are likely to be present?",
    "choices": [
      {
        "id": 1,
        "text": "CK-MB is elevated ; Troponin T is normal"
      },
      {
        "id": 2,
        "text": "Troponin I is elevated ; Myoglobin is normal"
      },
      {
        "id": 3,
        "text": "Myoglobin is elevated ; CK-MB is normal"
      },
      {
        "id": 4,
        "text": "Troponin I is normal ; CK-MB is normal"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The levels of <strong>cardiac</strong> <strong>markers</strong> remain <strong>unchanged</strong> in <strong>stable </strong>and <strong>unstable angina</strong> as there is no necrosis of cardiac myocytes.</p>\n<p>The clinical presentations of ischemic heart disease can be broadly classified into:\u00a0</p>\n<ul>\n<li><strong>Chronic coronary syndrome</strong>\u00a0(CCS) - this includes\n<ul>\n<li>Stable angina - this is an episodic angina that occurs with predictable severity, frequency, and threshold of precipitation by stressors, and is relieved by rest and nitrates\u00a0\u00a0</li>\n</ul>\n</li>\n<li><strong>Acute coronary syndrome</strong>\u00a0(ACS) - this includes\n<ul>\n<li>Unstable angina - this is diagnosed in patients with symptoms suggestive of an ACS with <strong>no elevation</strong> of<strong> biomarkers</strong></li>\n<li><strong>Myocardial infarction </strong>- it\u00a0is the necrosis and death of a portion of the myocardium due to prolonged ischemia. The cardiac <strong>biomarkers\u00a0</strong>are <strong>elevated</strong> in this condition</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 52-year-old man presents with oliguria, abdominal distension, and pedal edema.  His medical records show long-standing cirrhosis with multiple hospitalisations for ascites and hepatic encephalopathy. His lab reports are given below. What is the best treatment for his condition?",
    "choices": [
      {
        "id": 1,
        "text": "Midodrine"
      },
      {
        "id": 2,
        "text": "Liver transplant"
      },
      {
        "id": 3,
        "text": "Intravenous albumin"
      },
      {
        "id": 4,
        "text": "TIPS"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of <strong>hepatorenal syndrome</strong>. The best treatment modality for it is <strong>liver transplantation</strong>.</p>\n<p>Hepatorenal syndrome is characterised by a rise in:</p>\n<ul>\n<li>AST</li>\n<li>ALT</li>\n<li>Total bilirubin</li>\n<li>Serum creatinine</li>\n<li>Blood urea nitrogen (BUN).</li>\n</ul>\n<p><strong>Management of hepatorenal syndrome</strong> include:</p>\n<ul>\n<li>Norepinephrine</li>\n<li>Octreotide</li>\n<li>Terlipressin</li>\n<li><strong>Midodrine</strong></li>\n<li>Intravenous <strong>albumin</strong>\u00a0</li>\n<li>Liver transplantation- definitive treatment</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old woman came with a headache and decreased urine output. On examination her BP was 150/90mmhg and abdominal bruits were heard.  Renal angiography was done. Which of the following statements is not true regarding the condition shown in the image given below:",
    "choices": [
      {
        "id": 1,
        "text": "Most common site of involvement is renal artery"
      },
      {
        "id": 2,
        "text": "Predominantly affects females"
      },
      {
        "id": 3,
        "text": "Most commonly affected peripheral artery is subclavian artery"
      },
      {
        "id": 4,
        "text": "Segmental, non-atheromatous dysplastic angiopathy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows \"<strong>s</strong><strong>trings of beads appearance</strong>\" on CT angiography which is characteristic of <strong>fibromuscular dysplasia. </strong>The most common limb artery affected is <strong>iliac</strong> arteries.</p>\n<p>Fibromuscular dysplasia:</p>\n<ul>\n<li>Segmentally affected, non-atheromatous and dysplastic type of angiopathy</li>\n<li>Predominantly affects females</li>\n<li>The most common subtype is medial fibroplasia</li>\n<li>The most common site of involvement is renal &gt; carotid &gt; limb arteries</li>\n<li>The most common limb artery affected is the iliac arteries.</li>\n<li>CT&nbsp; angiography shows a &lsquo;string of beads&rsquo; appearance.</li>\n<li>Can also present as renal aneurysms.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2aa9b879b2e044faa73197e19c9f6988.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 71-year-old man presents to the OPD with high-grade fever, productive cough. On examination, the respiratory rate was found to be 32/ min, heart rate of 102/ min, and blood pressure of 90/60 mmHg. How will you manage this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Admit to ICU and treat with azithromycin and ceftriaxone"
      },
      {
        "id": 2,
        "text": "Admit to the ward and treat with levofloxacin and doxycycline"
      },
      {
        "id": 3,
        "text": "Treat him on OP basis with azithromycin and ceftriaxone"
      },
      {
        "id": 4,
        "text": "Admit to the ward and treat with azithromycin and levofloxacin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is highly suggestive of lobar pneumonia and the patient belongs to a <strong>CURB-65 score </strong>of <strong>3</strong>. The patient can be best managed by a <strong>combination of azithromycin and ceftriaxone </strong>in an <strong>ICU setting</strong>.\u00a0After culture sensitivity, specific management is done.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child presents with pain and swelling in the right side of his scrotum and testicular torsion is suspected. Which is the most appropriate management?",
    "choices": [
      {
        "id": 1,
        "text": "Immediate exploration on both symptomatic and asymptomatic side"
      },
      {
        "id": 2,
        "text": "Immediate exploration on symptomatic side only"
      },
      {
        "id": 3,
        "text": "Delayed exploration on both symptomatic and asymptomatic side"
      },
      {
        "id": 4,
        "text": "Delayed exploration on symptomatic side only"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In a case of suspected testicular torsion,<strong> immediate exploration </strong>needs to be done on both the<strong> symptomatic </strong>as well as the<strong> asymptomatic side.</strong></p>\n<p>In <strong>testicular torsion</strong>, the blood supply to the testicle is compromised due to the twisting of the spermatic cord within the tunica vaginalis, resulting in <strong>ischemia</strong> of the <strong>epididymis</strong> and the <strong>testis</strong>.</p>\n<p class=\"p1\">At the time of surgical exploration <strong>contralateral testes</strong> also must be explored and <strong>fixed to the dartos fascia</strong> due to the possibility that the same anatomic defect allowing torsion exists on the contralateral side.</p>\n<p class=\"p1\">More than 80% of <strong>testes</strong> can be <strong>salvaged</strong> if surgery is performed within <strong>6 hours</strong>. If the testis is found to be <strong>necrosed</strong> on scrotal exploration, <strong>orchidectomy</strong> of the <strong>necrosed testis</strong> and <strong>orchidopexy</strong> of the <strong>contralateral testis</strong> is done.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "True statement about intermittent claudication:",
    "choices": [
      {
        "id": 1,
        "text": "Felt at rest"
      },
      {
        "id": 2,
        "text": "Most commonly felt in the calf muscles"
      },
      {
        "id": 3,
        "text": "Day to day distance is variable"
      },
      {
        "id": 4,
        "text": "Relived after getting out of bed"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Intermittent claudication</strong> is most commonly felt in the <strong>calf</strong> muscles because of the involvement of the&nbsp;<strong>superficial femoral</strong> <strong>artery&nbsp;</strong>in chronic vascular occlusive disease.</p>\n<p>Intermittent claudication is the debilitating cramp-like pain felt in the leg muscles due to <strong>reduced blood flow</strong> brought on by peripheral arterial disease. It&nbsp;usually signifies <strong>mild </strong>to<strong> moderate chronic vascular occlusive disease.</strong></p>\n<p>The pain classically occurs during activity and is relieved with rest. The distance that a patient can walk without stopping till the pain is experienced in the muscles is known as <strong>claudication distance</strong>. This <strong>distance varies only slightly</strong> from day to day.</p>\n<p><strong>Rest pain</strong> signifies <strong>critical limb ischemia,</strong> occurring due to the worsening of perfusion to the muscle.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old male patient presents to the clinic with a history of pain during defecation for the past 2 months and the presence of blood-streaked stools. He has had a history of constipation for 5 months. On examination, there is a presence of a sentinel tag at the anal orifice. Due to extreme pain, a digital rectal examination is avoided. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Fistula in ano"
      },
      {
        "id": 2,
        "text": "Anal fissure"
      },
      {
        "id": 3,
        "text": "Hemorrhoids"
      },
      {
        "id": 4,
        "text": "Rectal prolapse"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely diagnosis in this patient is<strong> anal fissure.</strong></p>\n<p>This case scenario with a history of chronic constipation, and the presence of sentinel tags on examination, suggests a diagnosis of&nbsp;<strong>anal fissure</strong>.</p>\n<div class=\"page\" title=\"Page 1372\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>An anal fissure is a longitudinal split in the anoderm of the distal anal canal. A chronic anal fissure frequently is associated with :</p>\n</div>\n</div>\n</div>\n</div>\n<ul>\n<li><strong>Sentinel tag </strong>externally</li>\n<li>Hypertrophied <strong>anal papillae</strong>&nbsp;internally</li>\n<li>Anal ulcer overlying the internal sphincter</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d14f8c599baf44dc9dfa86d317a3f99cx1280x1429.JPEG"
    ]
  },
  {
    "text": "In the given picture of a Foley\u2019s catheter, what is the function of the tube marked \u2018A\u2019?",
    "choices": [
      {
        "id": 1,
        "text": "Suction"
      },
      {
        "id": 2,
        "text": "Irrigation"
      },
      {
        "id": 3,
        "text": "BCG Instillation"
      },
      {
        "id": 4,
        "text": "Cystoscope"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows a three-way Foley's catheter. The tube marked &lsquo;A&rsquo; is used for <strong>continuous irrigation of the bladder </strong>to remove debris &amp; blood clots<strong>.</strong> This is most commonly used after any prostate surgery or conditions with bleeding in the bladder.</p>\n<p>The <strong>central</strong> tube is used for the <strong>drainage</strong> of urine and the tube on the <strong>right</strong> is used for <strong>inflating</strong> the balloon.<span class=\"Apple-converted-space\">&nbsp;</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2cc3841b60594bd58a17ef5e0a4e2733.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Diagnostic laparoscopy was performed on a patient who presented with infertility. During the procedure, the surgeon notices powder burn spots over the pelvic viscera. The diagnosis would be?",
    "choices": [
      {
        "id": 1,
        "text": "Pelvic Inflammatory Disease"
      },
      {
        "id": 2,
        "text": "Germ cell tumours of ovary"
      },
      {
        "id": 3,
        "text": "Tuberculosis"
      },
      {
        "id": 4,
        "text": "Endometriosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Powder burn spots over pelvic viscera is seen in <strong>pelvic endometriosis.&nbsp;</strong></p>\n<p>Typically, there are small black dots, the so-called <strong>powder burns/gunshot appearance</strong>&nbsp;seen on the serosal surfaces of the peritoneum. They are black, dark brown, or bluish nodules or can be small cysts containing old hemorrhage surrounded by a variable degree of fibrosis.</p>\n<p>Other pathology in Endometriosis:</p>\n<ul>\n<li>Peritoneal cavity: contains yellowish-brown fluid which has prostaglandins responsible for the pain of endometriosis.</li>\n<li>Ovary: <strong>Chocolate cyst</strong>&nbsp;(True cyst with columnar epithelium lining)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/83e3bf72cfec4618a24e26b1fcc00afcx240x159.PNG"
    ]
  },
  {
    "text": "Pap smear is ________",
    "choices": [
      {
        "id": 1,
        "text": "Screening test"
      },
      {
        "id": 2,
        "text": "Diagnostic test"
      },
      {
        "id": 3,
        "text": "Confirmative test"
      },
      {
        "id": 4,
        "text": "Both a & b"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Pap smear is a <strong>screening</strong> test. In case of positive&nbsp;test further investigations should be done.</p>\n<p><strong>Pap Smear&nbsp;Schedule</strong></p>\n<ul>\n<li>Time for initiation: <strong>21 years</strong>, regardless of the age of first sexual intercourse.</li>\n<li>Women aged 21-29 years: Every <strong>3 years</strong>(earlier it was done annually)</li>\n<li>Women aged 30-65 years: Pap test + HPV testing every <strong>5 years</strong>.</li>\n<li>Women should stop having cervical cancer screening after the age of 65 years.&nbsp;If suspicious PAP, screening till 75 years.</li>\n<li>HIV+ women: annual checkup until three consecutive negative tests followed by testing every 3 years for life.</li>\n<li>HPV DNA testing in combination with PAP improves the sensitivity of screening.</li>\n</ul>\n<p>Ayres spatula and endocervical brush are the instruments used for the pap test.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea2611c6fd594b378534c87172d8620ex1280x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/632a126becc3436088ff92325108ae48x486x724.JPEG"
    ]
  },
  {
    "text": "A woman comes to your clinic for a follow-up. An obstetric scan was ordered which showed a 12-week intra-uterine pregnancy with a complete placenta previa. Which of the following is false about this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Painful recurrent vaginal bleeding can occur"
      },
      {
        "id": 2,
        "text": "The size of the uterus corresponds to gestational age"
      },
      {
        "id": 3,
        "text": "Fetal condition is generally good until bleeding is severe"
      },
      {
        "id": 4,
        "text": "Vaginal delivery cannot be tried in this lady"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Painless</strong> recurrent vaginal <strong>bleeding</strong> is seen in <strong>placenta previa</strong>.</p>\n<p>Clinical features<strong>&nbsp;</strong>of placenta&nbsp;previa:</p>\n<ul>\n<li>Bleeding&nbsp;per vaginum - sudden onset, painless, recurrent, bright red in colour, sometimes a history of warning haemorrhage is present</li>\n<li><strong>Uterus</strong> - <strong>relaxed</strong>,&nbsp;soft, no tenderness, size proportional to the period of gestation</li>\n<li><strong>Floating</strong> <strong>head</strong>&nbsp;i.e., persistent displacement of fetal head as it cannot be pushed down into the pelvis</li>\n<li><strong>Fetal heart sound - present</strong>. Fetal condition is generally good until&nbsp;bleeding is severe</li>\n<li><strong>Stallworthy</strong> <strong>sign</strong> - seen in the low-lying placenta, especially the posterior type. <strong>Slowing</strong> of fetal heart rate <strong>(FHR)</strong> on <strong>pressing</strong> the <strong>head</strong> down into the <strong>pelvis,</strong> which recovers promptly as pressure is relieved, is called the Stallworthy sign.</li>\n</ul>\n<p><strong>Central placenta previa</strong> is a <strong>contraindication</strong> for vaginal delivery. <strong>Cesarean</strong> delivery is recommended for all patients with placenta previa where it is located <strong>within 2 cm</strong> of the internal os. <strong>Vaginal delivery</strong> may be considered when the placental edge is located <strong>2-3 cm away</strong> from the internal os.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b3cb70104575488a96ecee7131c99997x1280x2004.JPEG"
    ]
  },
  {
    "text": "The most common soft tissue sarcoma in the pediatric age group is______.",
    "choices": [
      {
        "id": 1,
        "text": "Retinoblastoma"
      },
      {
        "id": 2,
        "text": "Rhabdomyosarcoma"
      },
      {
        "id": 3,
        "text": "Malignant melanoma"
      },
      {
        "id": 4,
        "text": "Cavernous hemangioma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Rhabdomyosarcoma</strong>, a tumor of striated skeletal muscle, is the <strong>most common</strong> pediatric<strong> soft tissue sarcoma.</strong></p>\n<p>The most common sites are-&nbsp;<strong>head and neck</strong> (25%) &gt; genitourinary tract (24%) &gt; extremities (19%) &gt; orbit (9%).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient has a history of a road traffic accident 2 years back, and has developed pain and swelling now at the same site. His X-ray image is shown in the image given below. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Osteogenic sarcoma"
      },
      {
        "id": 2,
        "text": "Ewing's sarcoma"
      },
      {
        "id": 3,
        "text": "Chronic osteomyelitis"
      },
      {
        "id": 4,
        "text": "Multiple myeloma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario and the X-ray image are suggestive of&nbsp;<strong>chronic osteomyelitis</strong> of the tibia.</p>\n<p>Chronic osteomyelitis may occur by direct inoculation of the infective organism during trauma (like road traffic accident). The infection continues to thrive within the bone leading to alternating quiescent and flare up stages of chronic osteomyelitis.</p>\n<p>The radiographic image shows <strong>oval-shaped sequestrum </strong>and periosteal new bone formation surrounding the sequestrum known as&nbsp;<strong>involucrum</strong>.&nbsp;</p>\n<p>The characteristic radiographic features of other conditions given are:</p>\n<p>Osteogenic sarcoma - Sun-burst appearance, Codman's triangle</p>\n<p>Ewing's sarcoma - Onion skin appearance</p>\n<p>Multiple myeloma - Punched out lesions</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/266614a9d43e4e9e8e47d19d7b494baf.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/11dc8cc0b6dc4f6c92b1a9112e2df478x724x401.JPEG"
    ]
  },
  {
    "text": "Sexual identity does not depend on which of the following factors?",
    "choices": [
      {
        "id": 1,
        "text": "Chromosomal pattern"
      },
      {
        "id": 2,
        "text": "Secondary sexual characters"
      },
      {
        "id": 3,
        "text": "Gonads"
      },
      {
        "id": 4,
        "text": "Upbringing"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Sexual identity does <strong>not</strong> depend on <strong>upbringing.</strong> Sexual identity is the pattern of a person&rsquo;s <strong>biological sexual characteristics</strong>.</p>\n<p>It depends on the following:</p>\n<ul>\n<li>Chromosomes</li>\n<li>External and internal genitalia</li>\n<li>Hormonal composition</li>\n<li>Gonads</li>\n<li>Secondary sex characteristics</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The device shown in the given image is used for the monitoring of:",
    "choices": [
      {
        "id": 1,
        "text": "Oxygen saturation"
      },
      {
        "id": 2,
        "text": "Oxygen content of the blood"
      },
      {
        "id": 3,
        "text": "Partial pressure of oxygen"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image depicts a <strong>pulse oximeter</strong>. Pulse oximetry is used for <strong>monitoring pulse rate and oxygen saturation</strong> of a patient.</p>\n<p>A small sensor is placed on the finger, toe, earlobe, or another convenient place.</p>\n<p>The <strong>relative absorption of light by oxyhemoglobin</strong> (HbO) and deoxyhemoglobin is assessed by <strong>measuring the amount of red and infrared light emerging from tissues</strong> traversed by light rays and processed by the device, producing an oxygen saturation level.</p>\n<p>Pulse oximetry does <strong>not measure the absolute content or the partial pressures of oxygen or carbon dioxide</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5fe2cfecd83946a0b52a71769eb540c6.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is not true regarding piebaldism?",
    "choices": [
      {
        "id": 1,
        "text": "It is autosomal dominant"
      },
      {
        "id": 2,
        "text": "Well-defined hypopigmented macules are seen"
      },
      {
        "id": 3,
        "text": "White forelock is rare"
      },
      {
        "id": 4,
        "text": "Small spots of hyperpigmentation can also be seen"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>White forelock</strong> is quite common<strong>&nbsp;</strong>in Piebaldism.</p>\n<p><strong>Piebaldism:</strong></p>\n<ul>\n<li><strong>Autosomal dominant</strong> benign&nbsp;condition, it has&nbsp;mutations in c\u2010KIT.</li>\n<li>Well-defined irregular&nbsp;<strong>hypopigmented macules</strong>&nbsp;with an absence of melnocytes.</li>\n<li>Small spots of hyperpigmentation are also seen within hypopigmented patches or on normal skin.&nbsp;</li>\n<li>It is often associated with a <strong>V-shaped leucoderma</strong> on mid-forehead.</li>\n<li><strong>Both sexes</strong> are equally affected.</li>\n<li>Piebaldism can be distinguished from vitiligo because of the<strong> neonatal presence of white patches.</strong></li>\n<li>Epidermal cell or skin grafting is the treatment.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/64f6f8375a5844ebbed9f5ce8ccecb18x512x510.PNG"
    ]
  },
  {
    "text": "A worker from the cement industry got a chest X-ray as a part of his routine health check-up. What could cause the findings in the given chest X-ray?",
    "choices": [
      {
        "id": 1,
        "text": "Berylliosis"
      },
      {
        "id": 2,
        "text": "Tuberculosis"
      },
      {
        "id": 3,
        "text": "Asbestosis"
      },
      {
        "id": 4,
        "text": "Silicosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"margin: 0cm 0cm 7.5pt 0cm;\"><span style=\"font-size: 10.5pt; font-family: 'Source Sans Pro',sans-serif;\">Asbestosis could cause the findings in the given chest X-ray.</span></p>\n<p style=\"margin: 0cm 0cm 7.5pt 0cm;\"><span style=\"font-size: 10.5pt; font-family: 'Source Sans Pro',sans-serif;\">The given X-ray shows irregular opacities, which appear to be <strong>pleural thickenings i.e., pleural plaques</strong>. The sign along with a history of working in the <strong>cement</strong> <strong>industry </strong>suggests a diagnosis of&nbsp;<strong><span style=\"font-family: 'Source Sans Pro',sans-serif;\">asbestosis</span></strong>. It predominantly affects the<strong> lower lobes </strong>of the lung, in contrast to other forms of pneumoconiosis, which affect the upper lobes.&nbsp;</span></p>\n<p style=\"margin: 0cm 0cm 7.5pt 0cm;\"><span style=\"font-size: 10.5pt; font-family: 'Source Sans Pro',sans-serif;\">Workers of the&nbsp;<strong><span style=\"font-family: 'Source Sans Pro',sans-serif;\">cement, shipping, and textile</span></strong>&nbsp;industries are at a higher risk of developing asbestosis. Asbestos tends to involve the pleura first.&nbsp;The earliest manifestation is benign asbestosis related pleural effusion. With time, the plaques are calcified resulting in the formation of thick pleural plaques. The pleural thickenings can be seen on the X-ray. This is the &ldquo;<strong><span style=\"font-family: 'Source Sans Pro',sans-serif;\">holly leaf sign</span></strong>&rdquo;.</span></p>\n<p style=\"margin: 0cm 0cm 7.5pt 0cm;\"><span style=\"font-size: 10.5pt; font-family: 'Source Sans Pro',sans-serif;\">Lung parenchymal involvement occurs after years of exposure (at least 10 years). They present with cough and exertional dyspnoea. Pulmonary function testing in asbestosis typically shows a&nbsp;<strong><span style=\"font-family: 'Source Sans Pro',sans-serif;\">restrictive pattern</span></strong>&nbsp;with a decrease in both lung volumes and diffusing capacity.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7f1725b6fd904220af928cce66384d17.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A woman diagnosed with DCIS underwent surgery and is now posted for adjuvant radiotherapy with external beam radiotherapy. Which of the following isotopes is commonly used for the same?",
    "choices": [
      {
        "id": 1,
        "text": "Cobalt-59"
      },
      {
        "id": 2,
        "text": "Cobalt -60"
      },
      {
        "id": 3,
        "text": "Radium-226"
      },
      {
        "id": 4,
        "text": "Strontium-89"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Cobalt-60</strong> isotope is used for <strong>external beam radiotherapy</strong> (EBRT).</p>\n<p>External beam radiotherapy is given as follows:</p>\n<ul>\n<li>Cobalt machine - Co-60 produces gamma rays. It emits radiation of energy 1.25 MeV.</li>\n<li>LINAC (linear accelator) - X-ray beams are generated to provide ionising radiation.</li>\n</ul>\n<p>The energy spectrum used in radiotehrapy is classified as follows:</p>\n<ul>\n<li>Orthovoltage - 200-500kV x-rays are produced. It is used to treat skin conditions.&nbsp;</li>\n<li>Megavoltage - 1-25 MV x-rays are produced. These are used in modern radiotherapy.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 027';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>