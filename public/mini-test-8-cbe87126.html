<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 8 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2022-23
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following statements is false about positron emission tomography-computed tomography(PET-CT)?",
    "choices": [
      {
        "id": 1,
        "text": "Enhanced whole body CT is followed by whole body PET imaging"
      },
      {
        "id": 2,
        "text": "It combines cross sectional anatomic information with metabolic information"
      },
      {
        "id": 3,
        "text": "Imaging is done after administration of oral glucose solution"
      },
      {
        "id": 4,
        "text": "Strenuous activity must be avoided prior to imaging"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Oral glucose solution is <strong>not given&nbsp;</strong>prior to PET-CT. <strong>Blood glucose should be in the normal range&nbsp;</strong>as FDG uptake is competitively inhibited by glucose. For this reason, the patient is asked to <strong>fast</strong> for 4-6 hrs prior to imaging.</p>\n<p><strong>Positron emission tomography - CT (PET-CT):</strong></p>\n<ul>\n<li>PET imaging is based on the detection of an injected <strong>positron-emitting radioactive tracer.</strong></li>\n<li>It relies on the <strong>coincidence detection of the annihilation photons (&gamma;)</strong>, which are released when a positron combines with an electron.</li>\n<li>A glucose analogue called <strong>fluorodeoxyglucose (FDG)&nbsp;</strong>is used in PET imaging. FDG is taken up by metabolically active cells, where it undergoes phosphorylation to form <strong>FDG-6-phosphate</strong>. Unlike glucose, FDG-6-phosphate cannot undergo further metabolism and becomes trapped within the cell.</li>\n<li>The trapped FDG-6-phosphate is detected by the PET scanner.</li>\n<li>The combination of PET imaging with CT (PET-CT) <strong>combines the metabolic information</strong> (PET) with the<strong>&nbsp;cross-sectional anatomic information</strong> (CT).</li>\n</ul>\n<p><strong>Indications of PET-CT:</strong></p>\n<ul>\n<li>PET-CT&nbsp;is used in oncology imaging to detect <strong>malignant cells</strong> as they demonstrate <strong>increased glucose metabolism</strong> relative to normal tissues.</li>\n<li>It is indicated for&nbsp;<strong>differentiation</strong> of a <strong>malignant</strong> from a <strong>benign</strong> lesion.</li>\n<li>It is indicated in <strong>tumor staging</strong> and evaluation of<strong> tumor recurrence.</strong></li>\n</ul>\n<p><strong>Technique</strong>:</p>\n<ul>\n<li>The patient must be <strong>fasted for 4-6 hrs</strong> prior to imaging.</li>\n<li><strong>Strenuous activity must be avoided</strong> prior to imaging and after radioisotope injection&nbsp;to avoid physiological muscle FDG uptake.</li>\n<li><strong>Bladder catheterization</strong> or voiding prior to imaging, bowel opacification, or IV contrast medium are optional.</li>\n<li>Before injecting FDG, the <strong>blood glucose level</strong> should be measured. It should be &lt; <strong>150 mg/dL.</strong>&nbsp;Good blood glucose control is essential as FDG uptake is competitively inhibited by glucose.</li>\n<li>Imaging is<strong> started 60 minutes following FDG injection.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During a postmortem examination, the forensic expert notices a cherry red discoloration over the dependent parts of the body. Which of the following conditions show this characteristic postmortem staining?",
    "choices": [
      {
        "id": 1,
        "text": "Hydrogen sulphide poisoning"
      },
      {
        "id": 2,
        "text": "Clostridium perfringens infection"
      },
      {
        "id": 3,
        "text": "Phosphorus poisoning"
      },
      {
        "id": 4,
        "text": "Carbon monoxide poisoning"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Carbon monoxide</strong>&nbsp;<strong>poisoning&nbsp;</strong>shows the characteristic&nbsp;<strong>postmortem</strong>&nbsp;<strong>staining</strong>&nbsp;with bright&nbsp;<strong>cherry red</strong>&nbsp;<strong>discoloration.</strong></p>\n<p><strong>Postmortem hypostasis/Postmortem staining/Postmortem lividity/Livor mortis/Suggilation</strong>&nbsp;refers to bluish-purple or reddish-purple discoloration&nbsp;of the superficial layers of the skin due to the collection of blood in toneless capillaries.&nbsp;</p>\n<p>It is an <strong>early</strong> postmortem change that occurs due to<strong>&nbsp;engorged vessels</strong> showing through the skin seen on the <strong>dependent parts</strong> due to the pooling of blood under the effect of gravity.&nbsp;</p>\n<p>This staining starts as<strong> mottled patches</strong><strong>&nbsp;</strong>1-3 hours&nbsp;following death and develops to a <strong>uniform area</strong> of staining in 3-6 hours.&nbsp;Full development and<strong> fixation of hypostasis </strong>occur within&nbsp;<strong>6-12 hours.&nbsp;</strong>This finding<span class=\"s1\">&nbsp;usually develops within 4 hours and&nbsp;<strong>persists until putrefaction.&nbsp;</strong>Fixation of hypostasis&nbsp;occurs&nbsp;<strong>earlier</strong>&nbsp;in&nbsp;<strong>summer.&nbsp;</strong>It&nbsp;is&nbsp;<strong>delayed&nbsp;</strong>in<strong>&nbsp;asphyxial deaths</strong>&nbsp;and in<strong>&nbsp;intracranial lesions</strong>.&nbsp;&nbsp;</span></p>\n<p>Other options</p>\n<p>Option A: <strong>Hydrogen sulphide</strong> poisoning shows characteristic <strong>blue-green</strong> staining.&nbsp;</p>\n<p>Option B: <strong>Clostridium perfringens</strong> infection shows <strong>pale bronze</strong> staining.</p>\n<p>Option C:&nbsp;<strong>Phosphorus</strong> poisoning shows <strong>dark brown</strong> staining.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old man comes with complaints of nasal stuffiness, watery discharge, and small grape-like masses protruding from both nostrils. He had similar complaints for which he was operated on  5 years ago. He has a history of dust allergy. On examination, multiple, pale masses are seen which do not bleed on probing. Which of these sites is unlikely to be the site of origin of these masses?",
    "choices": [
      {
        "id": 1,
        "text": "Uncinate process"
      },
      {
        "id": 2,
        "text": "Middle turbinate"
      },
      {
        "id": 3,
        "text": "Ethmoidal sinus"
      },
      {
        "id": 4,
        "text": "Maxillary sinus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>ethmoidal nasal polyposis</strong> which <strong>does not</strong> originate from the<strong> maxillary sinus</strong>.</p>\n<p>Ethmoidal polyps originate from the ethmoidal sinus, uncinate process, and the middle turbinate and middle meatus. Antrochoanal polyps are known to originate from the maxillary sinus.&nbsp;</p>\n<p>In the given scenario, the<strong> age</strong> of the patient, the presence of <strong>multiple, bilateral grape-like</strong> masses at the nostrils points towards the diagnosis of the ethmoidal polyp. The<strong> history of allergy</strong> on dust exposure and the history of <strong>recurrence</strong> are also more common in ethmoidal polyps.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old boy presents with lesions as shown in the image below. Which of the following is false regarding his condition?",
    "choices": [
      {
        "id": 1,
        "text": "There is perifollicular hyperkeratosis and keratotic papules"
      },
      {
        "id": 2,
        "text": "It is associated with liver cirrhosis and alcohol abuse"
      },
      {
        "id": 3,
        "text": "It can be seen in patients after bariatric surgery"
      },
      {
        "id": 4,
        "text": "It is\u00a0predominantly associated with a deficiency of\u00a0vitamin D"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above image shows <strong>phrynoderma</strong> or <strong>toad</strong> <strong>skin</strong>. All the statements except statement 4 are true. Phrynoderma is predominantly associated with a deficiency of&nbsp;<strong>Vitamin A</strong>.&nbsp;&nbsp;</p>\n<p>Phrynoderma (<strong>toad skin</strong>) is common in children in the 5 - 15 year age group. Phrynoderma is not specific to vitamin A deficiency, it is also seen in other nutritional deficiencies including&nbsp;<strong>B complex</strong>,&nbsp;<strong>ribofla&shy;vin, vitamin C, vitamin E, essential fatty acids,&nbsp;</strong>and<strong>&nbsp;malnutrition.</strong></p>\n<p>It is a non-specific finding that can be associated with:&nbsp;</p>\n<div class=\"page\" title=\"Page 2188\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>&bull; <strong>Liver cirrhosis.</strong><br />&bull; Malabsorption syndromes.<br />&bull; Anorexia nervosa.<br />&bull; <strong>Alcohol abuse</strong>.<br />&bull; Nutritional deficiency<strong> following bariatric surgery.</strong></p>\n</div>\n</div>\n</div>\n</div>\n<p>It manifests as&nbsp;<strong>groups of papules</strong>, with a&nbsp;<strong>central keratotic plug</strong>.&nbsp;The papules have a&nbsp;<strong>follicular distribution</strong>&nbsp;and give the skin a rough texture.&nbsp;The&nbsp;<strong>elbows</strong>&nbsp;and<strong>&nbsp;knees</strong>&nbsp;are the<strong>&nbsp;most commonly</strong>&nbsp;affected areas but the buttocks and extensor surfaces of the limbs may also be affected.</p>\n<p>All patients with phrynoderma should have their Vitamin A levels measured.&nbsp;</p>\n<p>Treatment involves the correction of poor diet and administration of&nbsp;<strong>multivitamin</strong>&nbsp;preparations containing Vitamin A.&nbsp;<br /><strong>For children above 8 years and adults</strong> - 100,000 units daily for 3 days, followed by 50,000 units daily for 2 weeks and then 10,000 units daily for 2 months till liver stores are replenished.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0a1bbd15ea4241249aa42e799d0ba839.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The histology slide of cartilage is given below.  Which of the following statements is incorrect about this type of cartilage?",
    "choices": [
      {
        "id": 1,
        "text": "It lacks perichondrium"
      },
      {
        "id": 2,
        "text": "It predominantly consists of type II collagen"
      },
      {
        "id": 3,
        "text": "Seen in pubic symphysis"
      },
      {
        "id": 4,
        "text": "It is white in color"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows&nbsp;<strong>fibrocartilage</strong>. The incorrect statement about this cartilage is that it mainly contains type 2 collagen. A fibrocartilage contains both type 1 and 2 collagen but&nbsp;is <strong>predominantly</strong>&nbsp;made of<strong> type I collagen</strong>.</p>\n<p>Fibrocartilage contains a&nbsp;<strong>mixture</strong>&nbsp;of&nbsp;<strong>white fibrous</strong>&nbsp;<strong>tissue</strong> and&nbsp;<strong>cartilaginous tissue</strong>.&nbsp;This mix of fibrous and cartilaginous components makes this tissue extremely tough and resilient. It consists of bundles of&nbsp;<strong>collagen fibres</strong>&nbsp;(both type I and II) with rows of&nbsp;<strong>chondrocytes</strong>&nbsp;present between the bundles. They are <strong>not covered</strong> by <strong>perichondrium</strong>.</p>\n<p>On microscopy, fibrocartilage can be identified by the presence of chondrocytes and the matrix containing abundant&nbsp;<strong>collagen fibres</strong>.&nbsp;</p>\n<p>Fibrocartilage is found in:</p>\n<ul>\n<li>Intervertebral discs</li>\n<li><strong>Pubic symphysis</strong></li>\n<li>Manubriosternal joint</li>\n<li>Menisci of the knee</li>\n<li>Glenoid and acetabular labra</li>\n<li>The lining of the bony grooves for tendons</li>\n<li>Articular disc of temporomandibular and sternoclavicular joint</li>\n</ul>\n<p>The image below shows - hyaline cartilage, fibrocartilage, and elastic cartilage respectively.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e1cc404e0759445b9ffd7aa7cd1b1b69.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/72da7d304dec41c1a887a94cc7361630x1280x1514.JPEG"
    ]
  },
  {
    "text": "A 48-year-old male patient is brought to the psychiatry OPD by his wife. He is convinced that the lead actress of a film he watched recently is deeply in love with him and wants to marry him. She also says that he is socially withdrawn and doesn't have many friends. Upon conducting a mental status examination, there are no other significant findings. What is the most likely diagnosis of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "De Cl\u00e9rambault syndrome"
      },
      {
        "id": 2,
        "text": "Capgras syndrome"
      },
      {
        "id": 3,
        "text": "Delusion of\u00a0reference"
      },
      {
        "id": 4,
        "text": "Othello syndrome"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given scenario, the man has a false belief that his chairman wants to marry him, which is a <strong>delusion </strong>of<strong>\u00a0love</strong>, also known as <strong>de Cl\u00e9rambault syndrome</strong>/<strong>erotomania</strong>\u00a0/psychose passionelle.</p>\n<p>Delusions are\u00a0<strong>false beliefs</strong> that are\u00a0<strong>firmly</strong>\u00a0held despite objective and obvious contradictory proof. It can be present in conditions like schizophrenia, mania, major depressive disorders, and delusional disorders.\u00a0</p>\n<p>The <strong>erotomania</strong>\u00a0is more common in women but can be seen in men as well. The patient feels that someone, who is usually of a <strong>higher status</strong>, is <strong>deeply in love with them</strong>. Patients with this delusion are usually <strong>solitary, withdrawn</strong>, dependent, and sexually inhibited. It is usually sudden in onset and runs a chronic course. It is seen in conditions like\u00a0schizophrenia, mood disorder, and other organic disorders.</p>\n<p class=\"p1\">Other options:\u00a0</p>\n<p class=\"p1\">Option B: <strong>Capgras syndrome</strong> is\u00a0a <strong>delusion </strong>of<strong> misidentification</strong>.<strong>\u00a0</strong>Here, the patient believes that a <strong>familiar person</strong> has been <strong>replaced</strong> by an exact double, i.e. an <strong>impostor</strong>.</p>\n<p class=\"p1\">Option C: In the <strong>delusion </strong>of<strong>\u00a0reference,</strong> the patient believes that events, objects, or behaviour of others have a special significance to him. For, when he comes across people talking, he might assume that the discussion is about them.</p>\n<p class=\"p1\">Option D: <strong>Othello syndrome </strong>is\u00a0the presence of\u00a0marked\u00a0morbid, pathological, or <strong>delusional jealousy</strong>. The patient here has\u00a0<strong>doubts </strong>of<strong> infidelity,</strong> which is also known as <strong>conjugal paranoia</strong>.\u00a0The person holds an\u00a0<strong>abnormal belief</strong>\u00a0that their\u00a0<strong>spouse </strong>or<strong> partner </strong>is <strong>being</strong>\u00a0<strong>unfaithful</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old female patient came with complaints of her hands turning very pale on exposure to cold for one month. The skin on her face and fingers is thickened and tight, and she has dilated capillaries over her face. She has a history of GERD. On investigation, she was found to have the following immunofluorescence pattern. Which of the following antibodies is most specific to this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Anti-histone"
      },
      {
        "id": 2,
        "text": "Anti-scl-70"
      },
      {
        "id": 3,
        "text": "Anti-centromere"
      },
      {
        "id": 4,
        "text": "Anti-Sm"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario featuring the Raynaud phenomenon, GERD, telangiectasias and tightening of the skin in the face and hands is suggestive of <strong>CREST</strong> syndrome<strong>/ limited cutaneous systemic sclerosis,\u00a0</strong>and<strong>\u00a0anti-centromere\u00a0antibodies\u00a0</strong>are<strong>\u00a0most specific</strong>\u00a0for this disease.\u00a0</p>\n<p>CREST syndrome consists of the following:</p>\n<ul>\n<li>Calcinosis cutis</li>\n<li><strong>Raynaud\u2019s phenomenon</strong></li>\n<li><strong>Esophageal dysmotility</strong></li>\n<li><strong>Sclerodactyly</strong></li>\n<li><strong>Telangiectasia</strong></li>\n</ul>\n<p>Systemic sclerosis (SSc) is a\u00a0<strong>chronic autoimmune disease</strong>.\u00a0<strong>Progressive fibrosis</strong> due to the deposition of extracellular matrix components in different tissues and organs is the prominent feature of SSc.\u00a0</p>\n<p>The characteristic features of SSc are\u00a0<strong>vascular damage, inflammation</strong>, and the presence of specific\u00a0<strong>autoantibodies</strong>.\u00a0</p>\n<p>SSc is classified into two based on the extent of skin involvement.</p>\n<ul>\n<li><strong>Limited cutaneous systemic sclerosis / CREST syndrome</strong></li>\n<li>Diffuse cutaneous systemic sclerosis</li>\n</ul>\n<p>In limited cutaneous systemic sclerosis (lcSSc),\u00a0<strong>fibrosis in the skin of acral parts of the body, like the face and limbs</strong> (distal to elbow and knee), takes place. Skin fibrosis in limited type has a slow progression, but microcirculation disturbances like Raynaud's phenomenon start long before the skin symptoms and are associated with the involvement of the lungs and esophagus.\u00a0</p>\n<p>Since it has late and slow organ involvement, it is associated with a\u00a0<strong>good prognosis</strong>\u00a0with a 10-year survival of over 90%.\u00a0</p>\n<p>Antinuclear antibodies (ANA) are present in 90 - 95% of cases with SSc.</p>\n<p>Autoantibodies specific to limited cutaneous systemic sclerosis include,</p>\n<ul>\n<li><strong>Anti- centromere</strong></li>\n<li>Anti-Th/To</li>\n<li>Anti-U1-RNP</li>\n<li>Anti-hUBF</li>\n</ul>\n<p>Management is based on disease-modifying and organ-specific drugs. For peripheral vasculopathy and digital ulcers, calcium channel blockers like\u00a0<strong>nifedipine amlodipine</strong> are used, and for refractory cases, phosphodiesterase 5 inhibitors are recommended.</p>\n<p><strong>Intravenous prostanoids</strong>\u00a0are used for the healing process of digital ulcers and the improvement of microcirculation. The commonly used immunosuppressants for skin fibrosis are\u00a0<strong>methotrexate, cyclophosphamide, and mycophenolate mofetil</strong>. When these drugs are ineffective or contraindicated, low-dose glucocorticosteroids or rituximab (anti-CD20) are used.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/65ada95851194cd1b9d01ffdccf7cd44.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old man from the eastern part of India presents with continuous fever, pallor, and splenomegaly. The bone marrow picture is shown below. Which of the following investigation would be the most appropriate in this case?",
    "choices": [
      {
        "id": 1,
        "text": "rk 39 antigen test"
      },
      {
        "id": 2,
        "text": "Plasmodium lactate dehydrogenase"
      },
      {
        "id": 3,
        "text": "Sabin-Feldman dye test"
      },
      {
        "id": 4,
        "text": "ProSpec T"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical vignette and the&nbsp;slide showing&nbsp;<strong>macrophages</strong> infested with <strong>intracellular Leishmania donovani bodies </strong>point towards a&nbsp;diagnosis is <strong>visceral</strong>&nbsp;<strong>leishmaniasis </strong>or<strong> kala-azar</strong>. It&nbsp;can be established by the&nbsp;<strong>rk 39 antigen test.</strong>&nbsp;</p>\n<p><strong>Leishmaniasis&nbsp;</strong>is a slowly progressing indigenous disease caused by a protozoan parasite of the genus Leishmania. It is transmitted by the bite of an infected <strong>female Phlebotomus sandfly&nbsp;</strong>which inoculates the flagellated promastigotes into the skin of the host in developing countries.</p>\n<p>In human beings, the disease presents in four different forms with a broad range of clinical manifestations:</p>\n<ul>\n<li>Visceral leishmaniasis, or kala-azar</li>\n<li>Cutaneous leishmaniasis</li>\n<li>Mucocutaneous leishmaniasis, and</li>\n<li>Diffuse cutaneous leishmaniasis</li>\n</ul>\n<p>The life cycle of Leishmania involves two forms,</p>\n<ul>\n<li>The <strong>promastigote</strong>&nbsp;<strong>develops </strong>and lives <strong>extracellularly</strong> in the <strong>sandfly</strong> vector and</li>\n<li>The <strong>amastigote</strong> multiplies<strong> intracellularly</strong> in the <strong>reticuloendothelial cells</strong> of the host.</li>\n</ul>\n<p>Kala-azar is characterized by <strong>persistent fever, anemia,</strong> liver and <strong>spleen enlargement</strong>, and lymphadenopathy.</p>\n<p>Diagnosis:</p>\n<ul>\n<li>The <strong>microscopic demonstration </strong>of<strong> amastigotes</strong> from bone marrow is the <strong>gold standard</strong> for the diagnosis of Kala-azar.</li>\n<li>Rapid diagnostic test: <strong>rk39 rapid diagnostic test</strong> and Kala-azar dipstick test strip. This is recommended by National Vector Borne Disease Control Programme (NVBDCP) in India.</li>\n<li>Parasitological diagnosis: Demonstration of <strong>LD bodies</strong> in buffy coat smear, bone marrow, lymph node, or splenic aspirate is<strong>&nbsp;confirmatory.</strong></li>\n<li>Aldehyde test of Napier: Widely used for surveillance.</li>\n<li>Serological tests for diagnosis: Rapid dipstick test, direct agglutination test, ELISA, indirect fluorescent antibody test, complement fixation test using Witebsky, Klingenstein and Kuhn (WKK) antigen.</li>\n<li><strong>Culture</strong> using <strong>NNN</strong> medium or <strong>Schneider's</strong> liquid medium to demonstrate <strong>promastigote</strong>.</li>\n<li>Leishmanin /<strong>Montenegro&nbsp;test</strong>: Induration of 5mm or more after 48-72 hours indicated prior exposure to leishmanial parasite. It is a delayed hypersensitivity test. In active kala-azar, this test is negative and becomes positive usually 6-8 weeks after curing the disease.</li>\n</ul>\n<p><strong>Option B</strong> - Plasmodium lactate dehydrogenase (<strong>pLDH</strong>) antigen test is used in the diagnosis of <strong>malaria.</strong></p>\n<p><strong>Option C</strong> -&nbsp;<strong>Sabin-Feldman dye</strong> test is a serological test done to detect<strong> toxoplasmosis</strong>.</p>\n<p><strong>Option D</strong> -&nbsp;<strong>ProSpec T</strong> is a commercially available ELISA test kit to detect&nbsp;<strong>Giardia</strong>-specific antigen 65.</p>\n<p>The given images show&nbsp;amastigotes in the bone marrow.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/664cc3b8665344fbb73d8a30261f4151.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/85b8c3a992cf4e17a36bb4f25411ddc6x720x540.JPEG"
    ]
  },
  {
    "text": "A 29-year-old man came with a history of jerky and hyperkinetic movements involving all parts of the body. His MRI shows marked atrophy of the caudate nucleus. There is a significant family history with successive generations having symptoms at earlier ages of onset. The pedigree chart is given below. Identify this genetic phenomenon.",
    "choices": [
      {
        "id": 1,
        "text": "Heteroplasmy"
      },
      {
        "id": 2,
        "text": "Genetic heterogeneity"
      },
      {
        "id": 3,
        "text": "Variable expressivity"
      },
      {
        "id": 4,
        "text": "Anticipation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given case scenario, with the family pedigree chart showing autosomal dominant inheritance points towards\u00a0<strong>Huntington\u2019s disease,\u00a0</strong>and the genetic phenomenon seen here is <strong>anticipation</strong>.\u00a0Anticipation refers to an earlier onset of disease in successive generations in a pedigree.\u00a0</p>\n<p>Huntington's disease (HD) is a degenerative disease of the striate neurons. It is<strong>\u00a0</strong>caused by<strong>\u00a0an autosomal dominant\u00a0</strong>inheritance of a<strong>\u00a0trinucleotide repeat (CAG)\u00a0</strong>in the<strong>\u00a0</strong>HTT gene located on <strong>chromosome 4</strong>. This results in<strong>\u00a0</strong>jerky, hyperkinetic movements called\u00a0<strong>chorea </strong>and<strong> dementia.\u00a0</strong>It is commonly seen in the\u00a04<sup>th</sup>\u00a0and 5<sup>th</sup> decades of life. Motor problems (the characteristic chorea) precede dementia. The HTT gene, on chromosome 4 encodes a protein called huntingtin. It has a stretch of <strong>repeats</strong> of the trinucleotide\u00a0<strong>CAG.</strong> When the number of repeats is increased beyond normal, it is associated with Huntington's disease. More the repeats, earlier is its onset.</p>\n<div class=\"page\" title=\"Page 1285\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The <strong>caudate</strong> nucleus is dramatically<strong> atrophied</strong>, with accompanying atrophy of the putamen, and cortex. The lateral and 3<sup>rd</sup> ventricles may be dilated. There is a loss of striatal neurons in the caudate nucleus on microscopic examination. The medium-sized, spiny neurons that use GABA as their neurotransmitter, along with enkephalin, dynorphin, and substance P are affected. Protein aggregates containing huntingtin can be seen in the neurons of the striatum and cerebral cortex. <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">The chorea can be treated with dopamine-blocking agents like tetrabenazine.</span></p>\n</div>\n</div>\n</div>\n</div>\n<p>Other options:</p>\n<p>Option A:<strong>\u00a0</strong>Each mitochondrion contains many copies of mtDNA, where deleterious mutations of mtDNA may affect a few, but not all the copies of mtDNA. Hence, individuals may <strong>harbor both wild-type and mutant mtDNA</strong>. This is known as <strong>heteroplasmy</strong>. Thus, when a cell containing both normal and mutant mtDNA divides, the proportion of the normal and mutant mtDNA in the daughter cells is variable. This explains why the expression of disorders resulting from mtDNA mutations is variable.</p>\n<p>Option B:<strong> Genetic heterogeneity </strong>refers to the phenomenon where mutations at several <strong>different loci</strong> produce the <strong>same trait</strong>.</p>\n<p>Option C: <strong>Variable expressivity</strong> refers to a <strong>similar genotype but a varying phenotype</strong>. The trait will be present in all individuals carrying the mutant gene but is expressed differently among individuals. Eg: varying severity of disease with NF1 mutation (neurofibromatosis).</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f33c805374bf4e87a055591aba4044f8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4c5d341ccac94c86a44d7548422748ccx1280x1944.JPEG"
    ]
  },
  {
    "text": "A 4-year-old boy presents with developmental delay, short stature, a tendency to sunburn easily, and dry, scaly skin.  He has short and brittle hair and sparse eyebrows. Under polarized light microscopy of the hair strand, a pattern of alternating light and dark \u2018tiger\u2010tail\u2019 bands is seen.  What can be the  DNA repair defect in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Defective Non-homologous End Joining Repair (NHEJ)"
      },
      {
        "id": 2,
        "text": "Defective Homologous Repair (HR)"
      },
      {
        "id": 3,
        "text": "Defective DNA Base Excision Repair (BER)"
      },
      {
        "id": 4,
        "text": "Defective DNA Nucleotide Excision Repair (NER)"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above clinical scenario is suggestive of <strong>trichothiodystrophy</strong> (TTD) which is caused by <strong>defective DNA Nucleotide Excision Repair (NER</strong>). Features like developmental delay, short stature, photosensitivity, and ichthyosis with short, brittle, and sparse hair are suggestive of<strong>&nbsp;</strong>the diagnosis.&nbsp;</p>\n<p>Trichothiodystrophy is an&nbsp;<strong>autosomal recessive</strong> disorder of DNA repair.&nbsp;Most patients carry mutations in the ERCC2 (XPD) gene of the <strong>nucleotide excision repair</strong> mechanism.</p>\n<p>It is a multisystem disorder characterized by <strong>short</strong>,<strong> brittle</strong>,<strong> sulfur-deficient hair</strong> with a pattern of <strong>alternating light and dark &lsquo;tiger\u2010tail&rsquo; bands</strong> under polarized light microscopy. Other features include&nbsp;<strong>photosensitivity</strong>,<strong> ichthyosis</strong>, developmental delay, and short stature.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b07d7de2bddd4304aec5aa893cfe60b0.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "After intubating a patient for the first time, an intern was asked to confirm that the tube was inserted correctly into the trachea. Which of the following is not a sign of correct endotracheal intubation?",
    "choices": [
      {
        "id": 1,
        "text": "Bilateral breath sounds"
      },
      {
        "id": 2,
        "text": "Detection of end tidal CO2 by capnography"
      },
      {
        "id": 3,
        "text": "Breath sounds in the epigastrium"
      },
      {
        "id": 4,
        "text": "Visible condensation in the endotracheal tube"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Breath sounds</strong> in the <strong>epigastrium</strong> is a sign of <strong>esophageal intubation</strong>. Endotracheal intubation is characterized by the absence of breath sounds in the epigastrium.</p>\n<p>Signs to confirm proper endotracheal intubation are:</p>\n<ul>\n<li>Symmetrical chest rise</li>\n<li>Presence of equal <strong>bilateral breath sounds</strong> over the chest</li>\n<li><strong>Absent</strong> <strong>breath sounds</strong> over the <strong>epigastrium</strong></li>\n<li><strong>Visible condensation</strong> in the endotracheal tube</li>\n<li>Large&nbsp;exhaled tidal volume</li>\n<li>Appropriate compliance of the reservoir bag during manual ventilation.</li>\n<li>Normal capnography</li>\n</ul>\n<p>The most important and objective method to confirm the position of the endotracheal tube is&nbsp;<strong>capnography.&nbsp;</strong></p>\n<p><strong>Capnography&nbsp;</strong>is a&nbsp;<strong>non-invasive method of measurement</strong>&nbsp;and&nbsp;<strong>graphical display</strong>&nbsp;of partial pressure of&nbsp;<strong>carbon dioxide (CO<sub>2</sub>)</strong>&nbsp;in exhaled breath or the&nbsp;<strong>end-tidal CO<sub>2</sub></strong><sub>.</sub>&nbsp;It&nbsp;is the<strong>&nbsp;most reliable indicator</strong>&nbsp;of proper placement of the endotracheal tube (ETT) following intubation. <strong>Capnograph</strong>&nbsp;is the device used for measurement and&nbsp;<strong>capnogram</strong>&nbsp;represents the<strong>&nbsp;CO2 waveform</strong>&nbsp;displayed on the capnograph.</p>\n<p>The given image shows the normal waveforms in a capnogram.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4c5ba11021e048f2b9d89f0ffed06887x1280x1075.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bb23ad4e94cd4843af6e0d76f077b9dex1279x839.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/87da407cc1eb4e34b87ee45b254631ebx1280x2439.JPEG"
    ]
  },
  {
    "text": "A 7-year-old boy was brought with the finding as shown in the image below. Further evaluation revealed a chalky white, grey retinal mass with vitreous and subretinal seeding measuring 2mm. Which of the following regimen is commonly used\u200b in the treatment of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Vincristine, carboplatin and etoposide"
      },
      {
        "id": 2,
        "text": "Vinblastine, carboplatin and etoposide"
      },
      {
        "id": 3,
        "text": "Vinblastine, bleomycin and etoposide"
      },
      {
        "id": 4,
        "text": "Vincristine, cisplatin and etoposide"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most probable diagnosis in a 7-year-old child with a <strong>whitish pupillary reflex</strong> with the presence of a chalky white, grey retinal mass&nbsp;on fundus examination is <strong>retinoblastoma</strong>. As the disease falls under <strong>group C</strong> (vitreous and subretinal seeding &lt;3 mm), it is treated with the commonly&nbsp;used three-drug&nbsp;<strong data-stringify-type=\"bold\">CVE regimen</strong>&nbsp;consisting of <strong>vincristine, carboplatin, </strong>and<strong data-stringify-type=\"bold\">&nbsp;etoposide.</strong></p>\n<p>Retinoblastoma is a <strong>malignant proliferation</strong> of immature <strong>retinal neural cells</strong> and is the <strong>most common</strong> <strong>intraocular malignancy</strong> in <strong>children</strong>. It is associated with mutations in the <strong>RB1 gene</strong> at chromosome <strong>13q14. </strong>It is a&nbsp;tumor of a group called small round blue cell tumors because the immature retinal neural cells are seen as small round cells with large nuclei.</p>\n<p><strong>White pupillary reflex</strong>&nbsp;or <strong>leukocoria</strong> is the most common presenting feature, followed by a <strong>squint</strong> which is usually convergent. Rarely, the child may present with nystagmus and defective vision.</p>\n<p>Image showing leukocoria of left eye.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0aa6a9a3ef3749dd9402d61201722700.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/df14a240df724365a0ab9d8046e809e7x720x331.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/520953bab5e9459eb251a6b384c78e27x510x525.GIF"
    ]
  },
  {
    "text": "A young man is brought to the emergency department following a road traffic accident. He was driving the car when the accident occurred. On examination, it is noted that the injured leg is shortened. The image of the pelvis radiograph is shown below. Which of the following nerve is most commonly damaged in the given condition?",
    "choices": [
      {
        "id": 1,
        "text": "Sciatic nerve"
      },
      {
        "id": 2,
        "text": "Posterior femoral cutaneous nerve"
      },
      {
        "id": 3,
        "text": "Inferior gluteal nerve"
      },
      {
        "id": 4,
        "text": "Femoral nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above radiograph shows that the <strong>femoral head</strong> of the left hip is <strong>displaced upwards and laterally</strong>, and the affected limb is in <strong>adduction.</strong> Also, the&nbsp;<strong>lesser trochanter is obscured</strong>. These features indicate&nbsp;<strong>posterior dislocation </strong>of the<strong> left hip&nbsp;joint</strong>. The <strong>nerve&nbsp;the most commonly injured</strong> in this type of dislocation is the <strong>sciatic nerve</strong>.</p>\n<p>Posterior hip dislocation occurs when the knee of the passenger strikes the <strong>dashboard.</strong>&nbsp;The affected leg is <strong>shortened</strong>, and lies in an <strong>adducted,</strong> <strong>internally rotated</strong> and slightly flexed position.</p>\n<p>Imaging shows the following features:</p>\n<ul>\n<li><strong>Upward dislocation</strong>&nbsp;of the femoral head</li>\n<li>The size of the <strong>femoral head</strong> appears <strong>smaller</strong> compared to the unaffected side</li>\n<li><strong>Adduction</strong> of the affected limb.</li>\n<li>The <strong>lesser trochanter</strong> may <strong>not</strong> be <strong>visible</strong> due to the internal rotation of the affected leg</li>\n</ul>\n<p>Treatment- A pure hip dislocation should be <strong>reduced</strong> as early as possible to reduce the risk of osteonecrosis and subsequent osteoarthritis. Important <strong>maneuvers</strong> to reduce posterior hip dislocation are:</p>\n<ul>\n<li>Rochester method</li>\n<li>East Baltimore lift</li>\n<li>Allis</li>\n<li>Bigelow</li>\n<li>Stimson</li>\n</ul>\n<p><strong>Complications</strong> of posterior hip dislocation are:</p>\n<ul>\n<li>Injury to the sciatic nerve</li>\n<li>Injury to the superior gluteal artery</li>\n<li>Osteonecrosis of the femoral head</li>\n<li>Secondary osteoarthritis</li>\n<li>Myositis ossificans</li>\n<li>Recurrent instability of the reduced dislocation</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/26dcf889047d472f963f646e034e9f52.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A baby presented with abdominal pain and red currant jelly stools. On examination, a mass is palpated in the right upper abdomen. Abdominal ultrasound showed the target sign. Which of the following is the most common location of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Ileocolic"
      },
      {
        "id": 2,
        "text": "Rectosigmoid"
      },
      {
        "id": 3,
        "text": "Colocolic"
      },
      {
        "id": 4,
        "text": "Ileoileal"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>The clinical scenario of<strong>&nbsp;abdominal pain, red currant jelly stool&nbsp;</strong>with a <strong>palpable mass </strong>along with the ultrasound showing the&nbsp;<strong>target sign</strong> is suggestive of <strong>intussusception.</strong>&nbsp;The most common location of intussusception is <strong>ileocolic.</strong></p>\n<p>Intussusception occurs when a portion of the bowel is<strong>&nbsp;telescoped</strong>&nbsp;into an adjacent segment.<strong>&nbsp;</strong></p>\n<p>It can be seen in infants during the weaning period following the introduction of new food, vaccination, or upper respiratory tract infection. The currently approved <strong>rotavirus vaccines</strong> are associated with very minimal risk of intussusception. An area of enlarged submucosal <strong>Payer's patch</strong> acts as a lead point for intussusception.</p>\n<p>Some lead points in children are <strong>Meckel's diverticulum,</strong>&nbsp;intestinal polyp, inflamed appendix, submucosal hemorrhage seen in <strong>Henoch-Schonlein purpura</strong>, and intestinal duplication cysts.</p>\n<p>Patients present with <strong>cramping abdominal pain</strong>, palpable <strong>sausage-shaped abdominal mass</strong>, vomiting, and passage of <strong>red currant jelly stools</strong>.</p>\n<p>Diagnosis is confirmed by <strong>abdominal ultrasound </strong>which shows<strong> t</strong><strong>arget sign/bull's eye sign </strong>(shown below)<strong>&nbsp;</strong>and<strong> p</strong><strong>seudokidney sign</strong> (seen longitudinally).</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d81d8af7dc2c42c1847e0212ef827ddfx720x598.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/322a6381b6a84dfd93a2fda7c2454257x1144x1136.PNG"
    ]
  },
  {
    "text": "In a presentation, you are explaining a cycle that depicts the management sequence of sudden disasters. Which step does number 5 in the image represent?",
    "choices": [
      {
        "id": 1,
        "text": "Mitigation"
      },
      {
        "id": 2,
        "text": "Reconstruction"
      },
      {
        "id": 3,
        "text": "Rehabilitation"
      },
      {
        "id": 4,
        "text": "Preparedness"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The number <strong>5</strong> in the image represents <strong>preparedness</strong> in the <strong>disaster management cycle</strong>.</p>\n<p>The correct sequence is:</p>\n<p>1 - Response<br />2 - Rehabilitation<br />3 - Reconstruction<br />4 - Mitigation<br />5 - Preparedness</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3b4b02dcb0284a149694eae43d259716.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4383f3577e7749808a8c62c2e104d46ax1280x1401.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9e1d1b94596647d39d4996c864bcf34cx600x866.JPEG"
    ]
  },
  {
    "text": "A 23-year-old primigravida at 25 weeks gestation, presents with right upper quadrant pain, nausea, and vomiting for the past 2 days. She was diagnosed with gestational hypertension 2 weeks back. Lab values are as follows. Which of the following other laboratory findings would be most likely seen in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Markedly elevated bilirubin"
      },
      {
        "id": 2,
        "text": "Decreased lactate dehydrogenase"
      },
      {
        "id": 3,
        "text": "Elevated aspartate transaminase"
      },
      {
        "id": 4,
        "text": "Elevated albumin levels"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The typical presentation of right upper quadrant pain, nausea, vomiting, lab findings of thrombocytopenia, low hematocrit, and peripheral smear finding of hemolysis, suggests a diagnosis of <strong>&nbsp;HELLP</strong> ( <strong>H</strong>emolysis, <strong>E</strong>levated <strong>L</strong>iver enzymes, <strong>L</strong>ow <strong>P</strong>latelets) syndrome.</p>\n<p>Elevated aspartate transaminase (AST) would be most likely seen in this patient with&nbsp;<strong>HELLP syndrome.</strong></p>\n<p>HELLP syndrome is an acronym that stands for:&nbsp;</p>\n<ul>\n<li><strong>H</strong>emolysis</li>\n<li><strong>E</strong>levated&nbsp;<strong>L</strong>iver enzymes&nbsp;</li>\n<li><strong>L</strong>ow&nbsp;<strong>P</strong>latelets</li>\n</ul>\n<p><strong>Microangiopathic hemolysis&nbsp;</strong>manifests as:</p>\n<ul>\n<li><strong>Elevated serum lactate dehydrogenase</strong>&nbsp;(LDH)<strong>&nbsp;</strong>levels (Option B)</li>\n<li>Reduced haptoglobin levels</li>\n<li>Schizocytosis,&nbsp;<strong>spherocytosis</strong>, and reticulocytosis on&nbsp;<strong>peripheral blood smear</strong></li>\n</ul>\n<p>Elevation&nbsp;of&nbsp;AST&nbsp;and&nbsp;ALT&nbsp;(liver enzymes) levels occurs due to&nbsp;periportal hemorrhagic necrosis&nbsp;in the liver. Furthermore, hemorrhagic infarcts can extend to form a&nbsp;subcapsular hematoma&nbsp;that&nbsp;stretches&nbsp;the&nbsp;Glisson capsule. This results in characteristic&nbsp;epigastric/right quadrant pain&nbsp;and tenderness. It can be&nbsp;diagnosed&nbsp;using a CT or&nbsp;MRI.<strong>&nbsp;</strong></p>\n<p>HELLP syndrome can also be associated with other&nbsp;<strong>complications</strong>&nbsp;such as&nbsp;<strong>eclampsia</strong>, placental abruption, stroke,&nbsp;<strong>coagulopathy</strong>, and pulmonary edema.&nbsp;</p>\n<p>Option A:&nbsp;<strong>Markedly elevated bilirubin levels</strong> are not likely seen in HELLP syndrome which characteristically does not present with marked hepatic dysfunction unlike <strong>acute fatty liver of pregnancy</strong>. Patients with acute fatty liver of pregnancy are likely to present with marked <strong>elevations of AST</strong> and <strong>bilirubin</strong>,<strong> hypoglycemia</strong> and <strong>hypocholesterolemia</strong>.</p>\n<p>The clinical and laboratory findings of acute liver diseases in pregnancy are as follows:</p>\n<table style=\"height: 538px; width: 407px;\">\n<tbody>\n<tr style=\"height: 7.74133px;\">\n<td style=\"width: 84.0712px; text-align: center; height: 7.74133px;\"><strong>Disorders&nbsp;</strong></td>\n<td style=\"width: 77.8646px; text-align: center; height: 7.74133px;\"><strong>HELLP syndrome</strong></td>\n<td style=\"width: 87.3438px; text-align: center; height: 7.74133px;\"><strong>Obstetric cholestasis</strong></td>\n<td style=\"width: 82.4826px; text-align: center; height: 7.74133px;\"><strong>Acute fatty liver of pregnancy</strong></td>\n<td style=\"width: 69.0451px; text-align: center; height: 7.74133px;\"><strong>Viral hepatitis</strong></td>\n</tr>\n<tr style=\"height: 19px;\">\n<td style=\"width: 84.0712px; height: 19px;\"><strong>Onset in pregnancy</strong></td>\n<td style=\"width: 77.8646px; height: 19px; text-align: center;\">Mid to late</td>\n<td style=\"width: 87.3438px; height: 19px; text-align: center;\">Late</td>\n<td style=\"width: 82.4826px; height: 19px; text-align: center;\">Late</td>\n<td style=\"width: 69.0451px; height: 19px; text-align: center;\">Variable</td>\n</tr>\n<tr style=\"height: 19px;\">\n<td style=\"width: 84.0712px; height: 19px;\"><strong>Differentiating features&nbsp;</strong></td>\n<td style=\"width: 77.8646px; height: 19px; text-align: center;\">&nbsp; &nbsp; &nbsp; -</td>\n<td style=\"width: 87.3438px; height: 19px; text-align: center;\"><strong>Pruritus&nbsp;</strong> (elevated <strong>serum bile acids</strong>)</td>\n<td style=\"width: 82.4826px; height: 19px; text-align: center;\">Signs of<strong> liver failure</strong>&nbsp;</td>\n<td style=\"width: 69.0451px; height: 19px; text-align: center;\"><strong>Fever</strong></td>\n</tr>\n<tr style=\"height: 23px;\">\n<td style=\"width: 84.0712px; height: 23px;\"><strong>AST (U/L)</strong></td>\n<td style=\"width: 77.8646px; height: 23px; text-align: center;\">&nbsp;&le;300</td>\n<td style=\"width: 87.3438px; height: 23px; text-align: center;\">&nbsp;&le;200</td>\n<td style=\"width: 82.4826px; height: 23px; text-align: center;\"><strong>200-800</strong></td>\n<td style=\"width: 69.0451px; height: 23px; text-align: center;\"><strong>2000+</strong></td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 84.0712px; height: 13px;\"><strong>Bilirubin (mg/dL)</strong></td>\n<td style=\"width: 77.8646px; height: 13px; text-align: center;\">1-4</td>\n<td style=\"width: 87.3438px; height: 13px; text-align: center;\">1-5</td>\n<td style=\"width: 82.4826px; height: 13px; text-align: center;\"><strong>4-10</strong></td>\n<td style=\"width: 69.0451px; height: 13px; text-align: center;\"><strong>5-20</strong></td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 84.0712px; height: 26px;\"><strong>Platelets</strong></td>\n<td style=\"width: 77.8646px; height: 26px; text-align: center;\">&darr;&darr;&nbsp;</td>\n<td style=\"width: 87.3438px; height: 26px; text-align: center;\"><strong>Normal</strong></td>\n<td style=\"width: 82.4826px; height: 26px; text-align: center;\">&darr;&darr;&nbsp;</td>\n<td style=\"width: 69.0451px; height: 26px; text-align: center;\">&darr;</td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 84.0712px; height: 26px;\"><strong>Fibrinogen</strong></td>\n<td style=\"width: 77.8646px; height: 26px; text-align: center;\"><strong>Normal</strong></td>\n<td style=\"width: 87.3438px; height: 26px; text-align: center;\"><strong>Normal</strong></td>\n<td style=\"width: 82.4826px; height: 26px; text-align: center;\"><strong>&darr;&darr;&darr;</strong></td>\n<td style=\"width: 69.0451px; height: 26px; text-align: center;\"><strong>Normal</strong></td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 84.0712px; height: 26px;\"><strong>D-dimer</strong></td>\n<td style=\"width: 77.8646px; height: 26px; text-align: center;\">&uarr;</td>\n<td style=\"width: 87.3438px; height: 26px; text-align: center;\"><strong>Normal</strong></td>\n<td style=\"width: 82.4826px; height: 26px; text-align: center;\"><strong>&uarr;</strong></td>\n<td style=\"width: 69.0451px; height: 26px; text-align: center;\"><strong>Normal</strong></td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 84.0712px; height: 26px;\"><strong>Prothrombin time</strong></td>\n<td style=\"width: 77.8646px; height: 26px; text-align: center;\"><strong>Normal</strong></td>\n<td style=\"width: 87.3438px; height: 26px; text-align: center;\"><strong>Normal</strong></td>\n<td style=\"width: 82.4826px; height: 26px; text-align: center;\"><strong>&uarr;</strong><strong>&uarr;</strong></td>\n<td style=\"width: 69.0451px; height: 26px; text-align: center;\">&nbsp;&uarr;</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 84.0712px; height: 18px;\"><strong>Hemolysis</strong></td>\n<td style=\"width: 77.8646px; height: 18px; text-align: center;\">&nbsp;&uarr;&uarr;</td>\n<td style=\"width: 87.3438px; height: 18px; text-align: center;\"><strong>No</strong></td>\n<td style=\"width: 82.4826px; height: 18px; text-align: center;\">&uarr;&uarr;&uarr;</td>\n<td style=\"width: 69.0451px; height: 18px; text-align: center;\">&nbsp;<strong>No</strong></td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 44-year-old man with primary hyperparathyroidism is undergoing a focused parathyroidectomy. How can one confirm that adequate parathyroid gland has been removed?",
    "choices": [
      {
        "id": 1,
        "text": "PTH falls >20% within 10 minutes of removal of gland"
      },
      {
        "id": 2,
        "text": "PTH falls >50% within 10 minutes of removal of gland"
      },
      {
        "id": 3,
        "text": "PTH falls >10% within 10 minutes of removal of gland"
      },
      {
        "id": 4,
        "text": "PTH falls >30% within 10 minutes of removal of gland"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>\u00a0<strong>Adequate removal </strong>of <strong>parthyroid gland</strong> can be confirmed by a <strong>fall of &gt;50%</strong> in <strong>PTH level</strong>s within <strong>10 mins</strong> of<strong> removal of the gland.</strong></p>\n<p>Most patients with <strong>primary hyperparathyroidism</strong> have a\u00a0<strong>single</strong>\u00a0<strong>adenoma</strong>. Therefore, they undergo a\u00a0<strong>focused</strong>\u00a0or\u00a0<strong>minimally invasive parathyroidectomy </strong>where the localized abnormal parathyroid gland is removed. Once the gland is removed, the surgeon can ensure that there is no other hyperactive gland remaining by performing an intraoperative PTH assay as suggested by\u00a0<strong>Miami criteria</strong>.</p>\n<p><strong>Miami criteria </strong>are<strong>\u00a0</strong>based on the principle that the\u00a0<strong>half-life</strong>\u00a0of the PTH is<strong>\u00a03-5 minutes</strong>. In a single-gland disease, once the gland is removed the PTH levels should drop to\u00a0<strong>&lt;50%</strong> of the<strong> preoperative PTH level </strong>within<strong> 10 minutes</strong>. However, if there is no drop in PTH level, then a multi-gland disease is suspected and the surgery is converted to a\u00a0<strong>bilateral neck exploration</strong>.</p>\n<p>The parathyroid is commonly transferred to the\u00a0<strong>brachioradialis</strong>\u00a0muscle post-surgery. When <strong>multiple parathyroids</strong> are resected, parathyroid tissue is transplanted to the <strong>non-dominant forearm</strong>. Pockets are made in the belly of the brachioradialis muscle, and one to two pieces of parathyroid tissue measuring 1 mm each are placed into each pocket. A total of 12 to 14 pieces are transplanted.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old woman is diagnosed to have cervical cancer. MRI and PET-CT imaging reveal tumour extension up to the pelvic wall and involvement of the para-aortic lymph nodes. It also shows features suggestive of hydronephrosis. What is the best plan of management in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Radical trachelectomy with pelvic lymphadenectomy"
      },
      {
        "id": 2,
        "text": "Radical hysterectomy with pelvic lymphadenectomy"
      },
      {
        "id": 3,
        "text": "Chemotherapy with radiation"
      },
      {
        "id": 4,
        "text": "Modified radical hysterectomy with pelvic lymphadenectomy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Cervical cancer involving the <strong>para-aortic lymph nodes</strong> is classified as <strong>Stage III C2</strong> according to FIGO staging.\u00a0<strong>Chemotherapy with radiation</strong>\u00a0is the best plan of management in this case.</p>\n<p>Note: If the patient just had carcinoma extension up to the pelvic wall and/or the presence of hydronephrosis, it would have been classified as Stage IIIB.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old boy with a history of cystic fibrosis is treated with an antibiotic for an infection in his lungs. This drug acts by inhibiting DNA gyrase and can cause tendon rupture. The prescribed antibiotic is?",
    "choices": [
      {
        "id": 1,
        "text": "Fluoroquinolones"
      },
      {
        "id": 2,
        "text": "Tetracyclines"
      },
      {
        "id": 3,
        "text": "Beta-lactam antibiotics"
      },
      {
        "id": 4,
        "text": "Sulfonamides"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The prescribed antibiotic in the above clinical scenario is <strong>fluoroquinolone</strong>. It acts by inhibiting <strong>DNA gyrase&nbsp;</strong>and has a propensity to cause <strong>tendon rupture</strong> and <strong>arthropathy.</strong></p>\n<p>Normally, during replication, to prevent excessive positive supercoiling of the strands, <strong>DNA gyrase</strong> nicks double-stranded DNA and introduces <strong>negative supercoils.&nbsp;</strong>Fluoroquinolones, by inhibiting DNA gyrase (in <strong>gram-negative</strong> bacteria), result in the production of damaged DNA. This is finally digested by exonucleases, resulting in <strong>bactericidal action.</strong></p>\n<p>Fluoroquinolones inhibit&nbsp;<strong>topoisomerase IV</strong> in <strong>gram-positive</strong> bacteria.</p>\n<p>Fluoroquinolones are used in the treatment of <strong>urinary tract infections</strong>, prostatitis, and gastrointestinal, and respiratory infections, and as a&nbsp;<strong>second-line</strong> drug in <strong>anti-tubercular therapy</strong>. They are <strong>avoided</strong> in <strong>children</strong> and <strong>pregnant women</strong>.</p>\n<p>Adverse effects of fluoroquinolones are <strong>arthralgia, t</strong><strong>endon rupture, </strong><em>Clostridium difficile</em> colitis, dysglycemia, prolonged QT interval, rashes, hallucinations, delirium, and seizures.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Tetracyclines </strong>binds to 30s ribosomes in susceptible organisms and<strong> inhibit protein synthesis</strong> in them.</p>\n<p>Option C: <strong>Beta-lactam</strong> antibiotics cause<strong> cell wall synthesis inhibition</strong>.</p>\n<p>Option D: <strong>Sulfonamides</strong> cause inhibition of<strong> folic acid synthesis</strong> in susceptible organisms.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A carpenter sustained a hit to his thumb by a hammer while working. Following this, he developed a poorly localised dull aching pain.  What is the type of nerve fibre carrying this pain?",
    "choices": [
      {
        "id": 1,
        "text": "A\u03b1 fibres"
      },
      {
        "id": 2,
        "text": "A\u03b2  fibres"
      },
      {
        "id": 3,
        "text": "B fibres"
      },
      {
        "id": 4,
        "text": "C fibres"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p style=\"text-align: left;\">The poorly localised <strong>dull aching pain</strong> experienced after a hit by a heavy object like a hammer is carried by\u00a0<strong>C fibres</strong>.</p>\n<p style=\"text-align: left;\"><strong>C-dorsal root fibres</strong>\u00a0are <strong>unmyelinated</strong> fibres found mainly in the deep somatic structures such as the <strong>muscles</strong> and <strong>joints</strong>. They are activated by thermal,<strong> mechanical</strong> or chemical stimuli that result in <strong>poor localization</strong> and <strong>slow, dull pain</strong>.\u00a0The\u00a0conducting rate of\u00a0these fibres is <strong>0.5 </strong>to <strong>2\u00a0m/s.</strong></p>\n<p style=\"text-align: left;\">Another type of nerve fibre responsible for pain sensation is A\u03b4 fibres.<strong>\u00a0</strong>They are\u00a0<strong>myelinated fibres</strong> responsible for first pain also called<strong> fast pain</strong> (conduction velocity <strong>6 to 30 m/s). </strong>These fibres get activated under thermal or<strong> mechanical stimuli </strong>and cause a <strong>short-lasting pricking type</strong> of pain that can be localized. They are mainly found in superficial structures such as the skin.</p>\n<p style=\"text-align: left;\">Other Options:</p>\n<p style=\"text-align: left;\">Option A:\u00a0<strong>A\u03b1</strong> fibre conducts <strong>proprioception\u00a0</strong>and <strong>somatic motor</strong> at a rate of\u00a0<strong>70\u2013120m/s</strong>.</p>\n<p style=\"text-align: left;\">Option B:\u00a0<strong>A\u03b2\u00a0</strong>fibre conducts<strong>\u00a0touch </strong>and <strong>pressure</strong>\u00a0at a rate of <strong>30-70\u00a0m/s</strong>.</p>\n<p style=\"text-align: left;\">Option C:<strong>\u00a0B\u00a0</strong>fibres are <strong>preganglionic autonomic fibres</strong> conducting at the rate of\u00a0<strong>3\u201315m/s</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test 8';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2022-23"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>