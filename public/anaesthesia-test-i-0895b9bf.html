<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anaesthesia Test I - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2018 - 19
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Father of modern anaesthesia is _________",
    "choices": [
      {
        "id": 1,
        "text": "John snow"
      },
      {
        "id": 2,
        "text": "August Bier"
      },
      {
        "id": 3,
        "text": "William Morton"
      },
      {
        "id": 4,
        "text": "Joseph Priestly"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>William Morton</strong> is the father of <strong>modern anaesthesia</strong>. He was the first person to indulge into the <strong>properties of ether and investigate ether</strong> as an anesthetic. He also studied the <strong>physiology of general anesthesia.</strong></p>\n<p><strong>John Snow</strong> is considered as the <strong>father of anaesthesia</strong>.<br />Note: John Snow is also considered the father of modern epidemiology.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A consultant asked a junior resident to assess the ease of endotracheal intubation in a patient to be operated. The findings were similar to the schematic image given below. The resident should grade the oral opening as Mallampati class ___________",
    "choices": [
      {
        "id": 1,
        "text": "II"
      },
      {
        "id": 2,
        "text": "III"
      },
      {
        "id": 3,
        "text": "IV"
      },
      {
        "id": 4,
        "text": "V"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Since the <strong>soft palate</strong>, the<strong> base of</strong> the <strong>uvula</strong>, and the hard palate are <strong>seen</strong>, this is graded as <strong>M</strong><strong>allampati class III</strong>.</p>\n<p>The&nbsp;<strong>Modified Mallampati&nbsp;</strong>classification is used to&nbsp;<strong>predict difficulty</strong>&nbsp;in&nbsp;<strong>tracheal intubation</strong>. It is based on the size of the base of the tongue. During the assessment, the <strong>patient</strong> has to be&nbsp;<strong>seated</strong>, with the&nbsp;<strong>head neutral, mouth open, tongue protruding, </strong>and<strong> no phonation</strong>. In this position, the <strong>visibility of</strong> the <strong>faucial pillars</strong>, <strong>uvula</strong>, and <strong>soft palate</strong> is <strong>assessed</strong> and assigned a class from I-IV.&nbsp;</p>\n<p>The <strong>initial</strong> Mallampati classification included <strong>only classes I-III</strong>. It was <strong>modified </strong>by <strong>Samsoon and Young</strong> to include <strong>class IV</strong>. In addition to classes I-IV, a <strong>fifth class</strong> also exists called <strong>class 0</strong>. In this, the <strong>epiglottis can be seen</strong> when the mouth is opened and the tongue is protruded.</p>\n<p>Higher scores indicate poor visibility of these structures due to the presence of a large tongue. Thus,&nbsp;Samsoon &amp; Young's Modified Mallampati&nbsp;<strong>classes</strong>&nbsp;<strong>III</strong>&nbsp;and&nbsp;<strong>IV</strong> are <strong>considered</strong> features of a&nbsp;<strong>difficult airway</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/780e0725a04e444589b8c155d8ae9a8b.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient on clopidogrel is scheduled to undergo an elective procedure. What would be your advice regarding the drug?",
    "choices": [
      {
        "id": 1,
        "text": "Continue as usual"
      },
      {
        "id": 2,
        "text": "Continue but omit the morning dose"
      },
      {
        "id": 3,
        "text": "Stop 1 day before surgery"
      },
      {
        "id": 4,
        "text": "Stop 1 week before surgery"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Clopidogrel</strong> is an antiplatelet drug and is <strong>stopped</strong> <strong>1 week </strong>prior to surgery to avoid the risk of increased surgical bleeding.</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Antiplatelets</strong></td>\n<td><strong>Waiting period</strong></td>\n</tr>\n<tr>\n<td>Ticlopidine</td>\n<td>10 days</td>\n</tr>\n<tr>\n<td>Clopidogrel</td>\n<td>5-7 days</td>\n</tr>\n<tr>\n<td>Abciximab</td>\n<td>48 hr</td>\n</tr>\n<tr>\n<td>Eptifibatide</td>\n<td>8 hr</td>\n</tr>\n</tbody>\n</table>\n<div class=\"layoutArea\">\u00a0</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Preoperative fasting recommendation is _________",
    "choices": [
      {
        "id": 1,
        "text": "4 hours for solids in adults"
      },
      {
        "id": 2,
        "text": "2 hours for liquids in adults"
      },
      {
        "id": 3,
        "text": "2 hours for breast milk in infants"
      },
      {
        "id": 4,
        "text": "4 hours for solids in infants"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Preoperative fasting recommendation is <strong>2 hours for liquids in adults</strong>.</p>\n<p><strong>Recommended Preoperative Fasting period</strong>:</p>\n<ul>\n<li>For neonates and infants:\n<ul>\n<li>2 hours for clear fluids</li>\n<li>4 hours for breast milk</li>\n<li>6 hours for solids and infant formula</li>\n</ul>\n</li>\n<li>For all above 1 year of age:\n<ul>\n<li><strong>2 hours for clear fluids</strong></li>\n<li>6 hours for a light meal</li>\n<li>8 hours if the meal contains fried, fatty food</li>\n</ul>\n</li>\n</ul>\n<p>Preoperative fasting is intended to reduce the risk of pulmonary aspiration.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are a junior resident conducting research on the efficacy of different methods to monitor the depth of anaesthesia. Which of the following methods will be not be considered for evaluation in your research?",
    "choices": [
      {
        "id": 1,
        "text": "EEG"
      },
      {
        "id": 2,
        "text": "Capnography"
      },
      {
        "id": 3,
        "text": "Bispectral index"
      },
      {
        "id": 4,
        "text": "Auditory evoked potential"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Capnography is not considered as it <strong>cannot</strong> be used to monitor the depth of anaesthesia.</p>\n<p>Capnography is a quantitative measure of <strong>end-tidal carbon dioxide</strong> that is used to assess <strong>ventilation</strong> in the perioperative period and confirm the correct placement of an endotracheal tube.</p>\n<p>Monitors used to assess the depth of anaesthesia:&nbsp;</p>\n<ol>\n<li>Electroencephalography (EEG)</li>\n<li>Bispectral index (BIS)</li>\n<li>Entropy</li>\n<li>Evoked responses (EP) - Motor EP, sensory EP (Auditory, visual, brain stem evoked potential)</li>\n<li>Patient state index</li>\n<li>Narcotrend.</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following conditions does this capnographic waveform appear?",
    "choices": [
      {
        "id": 1,
        "text": "Malignant hyperthermia"
      },
      {
        "id": 2,
        "text": "Esophageal intubation"
      },
      {
        "id": 3,
        "text": "Rebreathing"
      },
      {
        "id": 4,
        "text": "Tracheal intubation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image given in the question shows a capnograph with some carbon dioxide detected initially followed by absence of carbon dioxide- this is typical of<strong> esophageal intubation.</strong></p>\n<p>Swallowed air in the stomach would cause the initial detection of CO<sub>2</sub> which is soon washed out and the ETCO2 comes to zero.</p>\n<p>Option A: Malignant hyperthermia &ndash; progressive rise in CO<sub>2</sub>.&nbsp;</p>\n<p>Option C: Rebreathing of CO2 - elevated inspiratory baseline.</p>\n<p>Option D: Tracheal intubation - normal capnograph.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2c9b16ca56124fb682ad1f5b9b1fc28d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Size of the laryngeal mask airway that can be used in a child weighing 15 kgs is _________",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "1.5"
      },
      {
        "id": 3,
        "text": "2"
      },
      {
        "id": 4,
        "text": "2.5"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Size 2</strong> laryngeal mask airway can be used in a child weighing 15 kgs.</p>\n<p>Laryngeal mask airway is a supraglottic airway device which is placed in the hypopharynx and protects the larynx from laryngeal secretions. The largest possible size is chosen so as to ensure an airtight seal.</p>\n<p>Different sizes of the laryngeal mask airway</p>\n<table style=\"width: 378px;\">\n<tbody>\n<tr>\n<td style=\"width: 52px;\">Mask size</td>\n<td style=\"width: 100px;\">Patient Size</td>\n<td style=\"width: 92px;\">Weight (kg)</td>\n<td style=\"width: 122px;\">Cuff&nbsp;Volume (mL)</td>\n</tr>\n<tr>\n<td style=\"width: 52px;\">1</td>\n<td style=\"width: 100px;\">Infant</td>\n<td style=\"width: 92px;\">&lt;5</td>\n<td style=\"width: 122px;\">2-4</td>\n</tr>\n<tr>\n<td style=\"width: 52px;\">1.5</td>\n<td style=\"width: 100px;\">Infant</td>\n<td style=\"width: 92px;\">5-10</td>\n<td style=\"width: 122px;\">upto 7</td>\n</tr>\n<tr>\n<td style=\"width: 52px;\">2</td>\n<td style=\"width: 100px;\">Child</td>\n<td style=\"width: 92px;\">10-20</td>\n<td style=\"width: 122px;\">upto 10</td>\n</tr>\n<tr>\n<td style=\"width: 52px;\">2.5</td>\n<td style=\"width: 100px;\">Child</td>\n<td style=\"width: 92px;\">20-30</td>\n<td style=\"width: 122px;\">upto 14</td>\n</tr>\n<tr>\n<td style=\"width: 52px;\">3</td>\n<td style=\"width: 100px;\">Small Adult</td>\n<td style=\"width: 92px;\">30-50</td>\n<td style=\"width: 122px;\">upto 20</td>\n</tr>\n<tr>\n<td style=\"width: 52px;\">4</td>\n<td style=\"width: 100px;\">Normal adult (women)</td>\n<td style=\"width: 92px;\">50-70</td>\n<td style=\"width: 122px;\">upto 30</td>\n</tr>\n<tr>\n<td style=\"width: 52px;\">5</td>\n<td style=\"width: 100px;\">Normal adult</td>\n<td style=\"width: 92px;\">&gt;70</td>\n<td style=\"width: 122px;\">30-40</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following device is most suitable for?",
    "choices": [
      {
        "id": 1,
        "text": "Laryngeal surgery"
      },
      {
        "id": 2,
        "text": "Head and neck surgery"
      },
      {
        "id": 3,
        "text": "Nasal surgery"
      },
      {
        "id": 4,
        "text": "Thoracic surgery"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image given shows <strong>Microlaryngeal tube</strong>. It has smaller internal diameters and longer length which makes them useful for laryngeal surgeries.</p>\n<p>Other endotracheal tubes:</p>\n<p><strong>Armored or reinforced tubes</strong>: They are flexible, spiral wound tubes which are reinforced with an embedded coil so as to minimize kinking. They are useful in head and neck surgeries and when the patient is in prone position.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/eb813af8a4cd4a479e1049455da0b267.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e296bafb86874f949188d8345fafe5a5x1280x1715.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/23741f6fda4643b8bab122725e80705bx1280x1169.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0acfba0232c24d69ab9a8cacc2b767eex1280x1170.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7c144f44e5b7416c8e3d2cd596ca9642x1280x1817.JPEG"
    ]
  },
  {
    "text": "Ultra short acting non depolarising muscle relaxant is ________",
    "choices": [
      {
        "id": 1,
        "text": "Mivacurium"
      },
      {
        "id": 2,
        "text": "Gantacurium"
      },
      {
        "id": 3,
        "text": "Atracurium"
      },
      {
        "id": 4,
        "text": "Suxamethonium"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Gantacurium </strong>is ultra short acting (&lt;10minutes) non depolarising muscle relaxant.</p>\n<p>Gantacurium: It has two pathways of inactivation.</p>\n<ol>\n<li>Slower ester hydrolysis</li>\n<li>Adduction of cysteine to create a new compound that can no longer bind to the acetylcholine receptor of the neuromuscular junction. Therefore, it has ultrashort duration of action and fast recovery.</li>\n</ol>\n<p>Mivacurium is short acting non depolarising muscle relaxant. (10-20mins)</p>\n<p>Atracurium is intermediate acting non depolarising muscle relaxant. (20-50mins)</p>\n<p>Suxamethonium is the shortest acting <strong>depolarising</strong> muscle relaxant.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following adverse effects would you not expect while using succinylcholine as a muscle relaxant for a surgery being done under general anesthesia?",
    "choices": [
      {
        "id": 1,
        "text": "Increased intra ocular pressure"
      },
      {
        "id": 2,
        "text": "Increased intra cranial pressure"
      },
      {
        "id": 3,
        "text": "Hyperkalemia"
      },
      {
        "id": 4,
        "text": "Decreased intragastric pressure"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Succinylcholine\u00a0<strong>increases\u00a0intragastric pressure.\u00a0</strong>This is likely due to fasciculations of the abdominal skeletal muscle.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Dibucaine number < 30 indicates ______",
    "choices": [
      {
        "id": 1,
        "text": "High quantity of typical pseudocholinesterase"
      },
      {
        "id": 2,
        "text": "Low quantity of atypical pseudocholinesterase"
      },
      {
        "id": 3,
        "text": "Prolonged succinylcholine block"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Dibucaine number &lt; 30 indicates <strong>prolonged succinylcholine block</strong>.</p>\n<p>Dibucaine inhibits the typical pseudocholinesterase enzyme approximately 80% and the atypical enzyme approximately 20%. Dibucaine number&nbsp;<strong>refers to the percentage of inhibition of pseudocholinesterase activity.</strong></p>\n<p>A patient with normal pseudocholinesterase has a dibucaine number of 80, whereas a homozygote for atypical enzyme will have a dibucaine number of 20.</p>\n<p>Hence, at a low dibucaine number(&lt;30), there will be low quantity of typical pseudocholinesterase and high quantity of atypical pseudocholinesterase.</p>\n<p>Succinylcholine-induced neuromuscular blockade can be significantly prolonged if a patient has an abnormal genetic variant of pseudocholinesterase. Therefore there is a prolonged succinyl choline and mivacurium block in case of low dibucaine number.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an incorrect statement concerning rapacuronium?",
    "choices": [
      {
        "id": 1,
        "text": "Rapid onset and short duration of action"
      },
      {
        "id": 2,
        "text": "Minimal cardiovascular side effects"
      },
      {
        "id": 3,
        "text": "Safe in asthmatics"
      },
      {
        "id": 4,
        "text": "Non-depolarising muscle relaxant"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Rapacuronium is a non-depolarizing muscle relaxant that has a very high incidence of<strong> bronchospasm </strong>(&gt;9%) and so it is <strong>contraindicated</strong> in<strong> asthmatics</strong>.</p>\n<p>It has been <strong>withdrawn</strong> from the market due to this effect.</p>\n<p>Rapacuronium has a rapid onset and short duration of action and minimal cardiovascular side effects.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "On witnessing a cardiac arrest, what is the first thing you would do?",
    "choices": [
      {
        "id": 1,
        "text": "Check for victim\u2019s responsiveness"
      },
      {
        "id": 2,
        "text": "Check for a pulse"
      },
      {
        "id": 3,
        "text": "Check for breathing"
      },
      {
        "id": 4,
        "text": "Check for scene safety"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The first thing that needs to be done on witnessing a cardiac arrest is to<strong> verify </strong>the<strong> scene safety.</strong></p>\n<p>On ensuring that the scene is safe, the victim is<strong> checked for responsiveness</strong>. If unresponsive, call for help and then check for breathing and pulse simultaneously taking <strong>not more than 10 seconds.</strong></p>\n<p>If there is no breathing and no pulse, immediate <strong>chest compression</strong> and <strong>rescue breaths</strong> are started at a ratio of<strong> 30:2</strong>.</p>\n<p>If there is a pulse, but no breathing, give one rescue breath every 5-6 seconds or about 10-12 breaths/min.</p>\n<p>When an <strong>automated external defibrillator</strong> arrives, the rhythm is checked; if shockable, one shock is administered and CPR is resumed immediately.</p>\n<p>If not shockable, then CPR is resumed immediately.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old child is brought to the casualty after having suddenly collapsed while playing. Pulse is not recordable and CPR is started. After 2 minutes of CPR, the monitor shows ventricular fibrillation rhythm. What is the energy to be set for defibrillation?",
    "choices": [
      {
        "id": 1,
        "text": "1 J/kg"
      },
      {
        "id": 2,
        "text": "2 J/kg"
      },
      {
        "id": 3,
        "text": "4 J/kg"
      },
      {
        "id": 4,
        "text": "6J /kg"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In a <strong>pediatric cardiac arrest</strong>, the initial energy for defibrillation is set at <strong>2 J/kg</strong> for both\u00a0monophasic and biphasic waveforms.<strong>\u00a0</strong>It\u00a0is increased to 4 J/kg if a second shock is required<strong>.</strong></p>\n<p>If a pediatric defibrillator is not available, then an adult defibrillator can be used.</p>\n<p>In children the <strong>most common cause of cardiac arrest is asphyxia. </strong>However, a sudden witnessed collapse in a child is usually due to ventricular fibrillation.</p>\n<p>For adult defibrillation, the energy that must be applied is</p>\n<ul>\n<li>Monophasic defibrillator\u2013 360 J</li>\n<li>Biphasic defibrillator- 120-200 J (manufacturer recommended)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the maximum oxygen concentration delivered by a venturi mask?",
    "choices": [
      {
        "id": 1,
        "text": "20%"
      },
      {
        "id": 2,
        "text": "40%"
      },
      {
        "id": 3,
        "text": "60%"
      },
      {
        "id": 4,
        "text": "100%"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Venturi mask is a <strong>high-flow, fixed-performance</strong> oxygen delivery system and the&nbsp;highest oxygen concentration (<strong>FiO<sub>2</sub></strong>) delivered is&nbsp;<strong>60% at a flow rate of 15 L/min.</strong></p>\n<p>It is available in different colors, with the green valve venturi mask providing 60% FiO<sub>2.&nbsp;</sub></p>\n<p>This is useful with patients who require greater FiO<sub>2&nbsp;</sub>such as COPD patients, where it is important to provide controlled oxygenation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e3fad502374345ae88aecda0859dbb6ax1280x1224.JPEG"
    ]
  },
  {
    "text": "The most potent inhaled anaesthetic in use is _____________",
    "choices": [
      {
        "id": 1,
        "text": "Methoxyflurane"
      },
      {
        "id": 2,
        "text": "Halothane"
      },
      {
        "id": 3,
        "text": "Desflurane"
      },
      {
        "id": 4,
        "text": "Isoflurane"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Halothane (MAC - 0.75)</strong> is the most potent anaesthetic currently <strong>in use</strong>.&nbsp;<strong>Methoxyflurane </strong>with MAC of<strong> 0.2</strong>&nbsp;was the most potent inhaled anaesthetic. However, it is no longer in use.</p>\n<p><strong>Minimum alveolar concentration (MAC</strong>) of an inhaled anesthetic is the&nbsp;<strong>lowest concentration&nbsp;</strong>which is required to prevent movement in response to a defined noxious stimulus in 50% of subjects. It is a measure of potency of the inhalational anesthetics. So, lower the MAC value, lower is the concentration of anesthetic drug required which would imply the drug is more potent.</p>\n<p>Example:</p>\n<ul>\n<li><strong>Nitrous oxide</strong>&nbsp;with a MAC value of&nbsp;104&nbsp;is the <strong>least potent</strong> inhaled anesthetic</li>\n<li><strong>Methoxy flurane</strong> &ndash; MAC- 0.2 (<strong>most potent</strong>)</li>\n<li><strong>Desflurane</strong>: 6.0 (<strong>least potent among used</strong>)</li>\n<li>Sevoflurane&ndash; 2.05</li>\n<li>Isoflurane &ndash; 1.28</li>\n<li><strong>Halothane</strong> &ndash; 0.75<strong> (most potent among used)</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Second gas effect is related to _____________",
    "choices": [
      {
        "id": 1,
        "text": "Diffusion hypoxia"
      },
      {
        "id": 2,
        "text": "Concentration effect"
      },
      {
        "id": 3,
        "text": "Ether"
      },
      {
        "id": 4,
        "text": "Oxygen"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Second gas effect is related to <strong>concentration effect</strong>. It is seen when nitrous oxide is given in high concentration (66%). It refers to the principle that the&nbsp;<strong>concentration</strong>&nbsp;of inspired anesthetic gas influences:</p>\n<ul>\n<li>the alveolar&nbsp;<strong>concentration</strong>&nbsp;that may be attained</li>\n<li>the rate at which that&nbsp;<strong>concentration</strong>&nbsp;may be attained.</li>\n</ul>\n<p><strong>Second Gas Effect</strong>&nbsp;is seen when nitrous oxide is administered with another inhaled anesthetic.&nbsp;</p>\n<p>Uptake of nitrous oxide from the alveoli into the blood results in a gradient which draws in more nitrous oxide from the anesthetic machine (augmented inflow). If another gas is simultaneously administered, nitrous oxide enhances the uptake of that gas as well.&nbsp;</p>\n<p>Second gas effect is seen with <strong>nitrous oxide</strong>, not ether or oxygen.</p>\n<p><strong>Diffusion hypoxia: </strong>It occurs during recovery from nitrous oxide anesthesia when nitrous oxide is suddenly cut off. Nitrous oxide diffuses from the blood to the alveoli and replaces the oxygen which reduces alveolar O2 concentration, resulting in relative hypoxemia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following inhalational agents is suitable for neurosurgery?",
    "choices": [
      {
        "id": 1,
        "text": "Halothane"
      },
      {
        "id": 2,
        "text": "Isoflurane"
      },
      {
        "id": 3,
        "text": "Nitrous oxide"
      },
      {
        "id": 4,
        "text": "Ether"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given options, <strong>isoflurane</strong> is best suited for neurosurgery.</p>\n<p>All of the inhalational anesthetics are<strong> cerebral vasodilators</strong>. The order of vasodilating potency is:</p>\n<p>halothane &gt; enflurane &gt; desflurane &gt;&nbsp;<strong>isoflurane </strong>&gt;&nbsp;sevoflurane.&nbsp;</p>\n<p><strong>Note: </strong>Due to its lesser vasodilating property,&nbsp;<strong>sevoflurane</strong> is preferred to isoflurane for neurosurgery.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Fulminant hepatic necrosis  is least common with which of the following inhalational anaesthetics?",
    "choices": [
      {
        "id": 1,
        "text": "Halothane"
      },
      {
        "id": 2,
        "text": "Isoflurane"
      },
      {
        "id": 3,
        "text": "Sevoflurane"
      },
      {
        "id": 4,
        "text": "Desflurane"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Fulminant hepatic necrosis is least common with <strong>sevoflurane.&nbsp;</strong>Unlike other volatile anesthetics, sevoflurane is oxidized to form hexafluoroisopropanol which is&nbsp;stable and does not covalently bind to proteins and hence does not cause hepatic injury.&nbsp;</p>\n<p><strong>Sevoflurane</strong>&nbsp;is the agent of choice in a patient with a prior history of halothane hepatitis.</p>\n<p>Halothane hepatitis is due to antibodies against highly reactive trifluoroacetyl chloride which is a metabolite of halothane.</p>\n<p>Like Halothane, Enflurane, Desflurane and Isoflurane also undergo extensive metabolism to produce highly reactive intermediates that can covalently modify hepatic proteins which can cause severe hepatitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following inhalational agents produces a nephrotoxic substance called compound A?",
    "choices": [
      {
        "id": 1,
        "text": "Halothane"
      },
      {
        "id": 2,
        "text": "Methoxyflurane"
      },
      {
        "id": 3,
        "text": "Sevoflurane"
      },
      {
        "id": 4,
        "text": "Desflurane"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Sevoflurane</strong> reacts with strong bases like sodium hydroxide and potassium hydroxide present in <strong>soda-lime</strong> and <strong>baralyme</strong> leading to the formation of a <strong>haloalkene</strong> (fluoromethyl-2,2-difluoro-1-[trifluoromethyl] vinyl ether) known as <strong>compound A.</strong></p>\n<p>Compound A has the potential to cause<strong> proximal tubular necrosis.&nbsp;</strong></p>\n<p><strong>Risk factors </strong>for increased compound A production:</p>\n<ul>\n<li>Prolonged duration of anesthesia</li>\n<li>High concentration of sevoflurane</li>\n<li>Low flow techniques</li>\n<li>Dry baralyme</li>\n</ul>\n<p>A fresh gas flow of<strong> at least&nbsp;2L/ min</strong> can prevent the generation of compound A</p>\n<p><strong>Amsorb</strong> is a CO2 absorbent that is more inert than soda-lime and baralyme and so associated with lesser degradation of sevoflurane and&nbsp;<strong>less compound A</strong> production.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following barbiturates is not completely eliminated by the liver?",
    "choices": [
      {
        "id": 1,
        "text": "Thiopentone"
      },
      {
        "id": 2,
        "text": "Phenobarbitone"
      },
      {
        "id": 3,
        "text": "Thiamylal"
      },
      {
        "id": 4,
        "text": "Methohexital"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Phenobarbitone</strong> is not completely eliminated by the liver. 25% to 50% of the drug is excreted by the kidneys in an unchanged form.</p>\n<p>All <strong>barbiturates </strong>(thiopentone, thiamylal, methohexital)<strong>&nbsp;</strong>other than phenobarbitone are completely eliminated by<strong>&nbsp;</strong>the liver.&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A junior resident accidentally administered thiopentone intra-arterial to a patient. Management should involve all of the following except ___________",
    "choices": [
      {
        "id": 1,
        "text": "Removal of injection needle"
      },
      {
        "id": 2,
        "text": "Administration of heparin"
      },
      {
        "id": 3,
        "text": "Saline dilution of thiopentone"
      },
      {
        "id": 4,
        "text": "Blockage of stellate ganglion"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>injection</strong> needle <strong>should not be removed</strong> in case of intraarterial thiopentone injection.</p>\n<p>Treatment for intraarterial thiopentone injection:</p>\n<ul>\n<li>If thiopentone is administered intra-arterially <strong>stop the injection </strong><strong>immediately</strong> and further injection of the drug should not be done.</li>\n<li><strong>Injection needle should not be removed</strong>. This is done because saline can be administered via the same needle to dilute the drug.</li>\n<li><strong>Administer heparin</strong>&nbsp;to prevent thrombosis.</li>\n<li><strong>Brachial plexus block </strong>or stellate ganglion block</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Propofol infusion syndrome is seen when propofol infusion is __________",
    "choices": [
      {
        "id": 1,
        "text": "> 2mg/kg/hour for 24hours"
      },
      {
        "id": 2,
        "text": "> 2mg/kg/hour for 48hours"
      },
      {
        "id": 3,
        "text": "> 4mg/kg/hour for 24hours"
      },
      {
        "id": 4,
        "text": "> 4mg/kg/hour for 48hours"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Propofol infusion syndrome is seen when propofol infusion is <strong>&gt;4mg/kg/hour for 48hours.</strong></p>\n<p><strong>Propofol infusion syndrome:</strong></p>\n<ul>\n<li>It is a rare but lethal syndrome seen when the propofol&nbsp;<strong>infusion is greater than 4 mg/kg/ hour for 48 hours or longer</strong>. This syndrome is common in children and critically ill adults.</li>\n<li>Clinical features include\n<ul>\n<li><strong>acute refractory bradycardia</strong>&nbsp;leading to asystole,</li>\n<li>metabolic acidosis (base deficit &gt;10 mmol/L),</li>\n<li>rhabdomyolysis,</li>\n<li>hyperlipidemia,</li>\n<li>enlarged or fatty liver</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child was administered an anesthetic for fracture reduction in the ER. He could open his eyes, was blabbering and breathing spontaneously but did not feel any pain. Which anesthetic agent was administered?",
    "choices": [
      {
        "id": 1,
        "text": "Ketamine"
      },
      {
        "id": 2,
        "text": "Propofol"
      },
      {
        "id": 3,
        "text": "Etomidate"
      },
      {
        "id": 4,
        "text": "Thiopentone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given features suggest <strong>dissociative anaesthesia</strong>, which is a characteristic feature of <strong>ketamine</strong>.</p>\n<p>Ketamine produces dissociative anesthesia which is characterized by a state wherein the patient is <strong>conscious</strong> (eg., eye opening, swallowing, muscle contracture) but <strong>unable</strong> to <strong>process</strong> or <strong>respond</strong> to sensory input.</p>\n<p>Ketamine functionally &ldquo;<strong>dissociates&rdquo;</strong> the <strong>thalamus</strong> (which relays sensory impulses from the reticular activating system to the cerebral cortex) from the<strong> limbic cortex</strong> (which is involved with the awareness of sensation).&nbsp;It acts as an <strong>antagonist</strong> at the phencyclidine<strong>&nbsp;</strong>site of the <strong>NMDA receptor.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "True about the circuit given below is _________",
    "choices": [
      {
        "id": 1,
        "text": "Low fresh gas flow rate"
      },
      {
        "id": 2,
        "text": "Best in controlled ventilation"
      },
      {
        "id": 3,
        "text": "Also called Jackson Rees modification circuit"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The circuit given in the image is <strong>Mapleson A or Magill circuit</strong>. It has a <strong>low fresh gas flow rate</strong>&nbsp;requirement of 1 x minute ventilation to prevent rebreathing of carbon dioxide. Hence, it is considered the best for <strong>spontaneous ventilation.</strong></p>\n<p>In Mapleson circuits D, E, and F, the amount of fresh gas flow required is 2.5 times a minute ventilation and in mapleson circuits B and C, it is much higher.</p>\n<p>Mapleson circuit&nbsp;A is not very useful in controlled ventilation because minute ventilation as high as 20 L/minute (fresh gas flow rate should be greater than 3 times minute ventilation) is needed to prevent rebreathing. <strong>Mapleson circuit D is used for controlled ventilation.</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/66dd3f17a85440a693d782edd562ce93.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Mixtures of CO2 and O2 with less than 7% CO2 will have pin index ___________",
    "choices": [
      {
        "id": 1,
        "text": "1, 5"
      },
      {
        "id": 2,
        "text": "2, 5"
      },
      {
        "id": 3,
        "text": "1, 6"
      },
      {
        "id": 4,
        "text": "2, 6"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Mixtures of&nbsp;CO<sub>2</sub>&nbsp;and O<sub>2</sub>&nbsp;with less than 7% CO<sub>2 </sub>will have pin index <strong>2, 6</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Most common complication of the block shown in the image below is ___________",
    "choices": [
      {
        "id": 1,
        "text": "Recurrent laryngeal nerve palsy"
      },
      {
        "id": 2,
        "text": "Pneumothorax"
      },
      {
        "id": 3,
        "text": "Diaphragmatic paresis"
      },
      {
        "id": 4,
        "text": "Horners syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image depicts <strong>interscalene block</strong> which is performed between the anterior and middle scalene muscles in the interscalene groove at the level of C6. <strong>Diaphragmatic paresis</strong> is the <strong>most common complication</strong> seen in interscalene block (seen in 100%). It is due to ipsilateral phrenic nerve blockade.</p>\n<p>This can result in dyspnea, hypoxia, and hypercapnea especially if the patient has compromised lung function or pre existing contralateral phrenic nerve paralysis. It can be<strong> minimized by performing ultrasound guided blocks</strong>, using smaller volumes of local anaesthetic and blocking the brachial plexus at a lower level in the neck.</p>\n<p><strong>Other complications&nbsp;</strong>of interscalene block are:</p>\n<ul>\n<li>Horners syndrome &ndash; ptosis, myosis, anhydrosis. Due to involvement of the sympathetic nerves to the cervicothoracic ganglion</li>\n<li>Recurrent laryngeal nerve palsy</li>\n<li>Vagus nerve involvement</li>\n<li>Pneumothorax</li>\n<li>Bezold Jarisch reflex</li>\n<li>Accidental vertebral artery injection (immediate seizure is seen)</li>\n<li>Accidental spinal or epidural injection</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/522d6bb90b73484da8129e742452eec7.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A child presents with a dislocated fracture of the first metacarpal. What is the preferred regional anaesthesia technique for the surgery?",
    "choices": [
      {
        "id": 1,
        "text": "Supraclavicular block"
      },
      {
        "id": 2,
        "text": "Infraclavicular block"
      },
      {
        "id": 3,
        "text": "Interscalene block"
      },
      {
        "id": 4,
        "text": "Axillary block"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p style=\"text-align: justify;\">The <strong>axillary block</strong> is the <strong>most preferred approach</strong> to the brachial plexus in <strong>pediatric patients</strong> for surgeries of the elbow, forearm, and hand.</p>\n<p style=\"text-align: justify;\">It is a relatively easy and safe procedure.&nbsp;<strong>Complications</strong> include&nbsp;<strong>systemic toxicity</strong> due to accidental intraarterial injection and <strong>permanent nerve injury</strong> from the intraneural injection.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which receptor mediates supraspinal analgesia produced by opioids?",
    "choices": [
      {
        "id": 1,
        "text": "\u00b5"
      },
      {
        "id": 2,
        "text": "k"
      },
      {
        "id": 3,
        "text": "\u03b4"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>&micro;, k and &delta; receptors</strong> mediate both <strong>supraspinal </strong>and <strong>spinal </strong>analgesia produced by opioids.</p>\n<ul>\n<li><strong>Supraspinal</strong>&nbsp;analgesia is predominantly mediated by&nbsp;<strong>&micro;1</strong>&nbsp;receptor and&nbsp;<strong>spinal</strong>&nbsp;analgesia by <strong>k receptor.</strong></li>\n<li>&mu;-receptor agonists usually produce&nbsp;<strong>analgesia</strong>, whereas &kappa;-receptor agonists may produce analgesia or&nbsp;<strong>antianalgesia.</strong></li>\n<li>Within the spinal cord, opioids act on the opioid receptors in substantia gelatinosa and inhibit the release of substance P from the sensory neurons.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is false regarding tramadol?",
    "choices": [
      {
        "id": 1,
        "text": "Safe in epileptics"
      },
      {
        "id": 2,
        "text": "Less potent than morphine"
      },
      {
        "id": 3,
        "text": "Less respiratory depression"
      },
      {
        "id": 4,
        "text": "Synthetic analogue of codeine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Tramadol is <strong>contraindicated</strong> <strong>in epileptics</strong>.</p>\n<p>Tramadol is <strong>epileptogenic </strong>and can cause seizures in predisposed individuals and in those taking medications like monoamine oxidase inhibitors and neuroleptic drugs.</p>\n<p>It is a <strong>synthetic analogue</strong> of <strong>codeine</strong>&nbsp;and a weak opioid&nbsp;agonist with&nbsp;1/6000 affinity for&nbsp;&micro; receptors as that of morphine.</p>\n<p>Apart from opioid&nbsp;action, it also inhibits the&nbsp;<strong>reuptake of 5HT and NE.</strong> Due to&nbsp;non-opioid receptor-mediated actions, it produces <strong>less respiratory depression</strong> and less constipation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Opioid with highest water partition coefficient is ________",
    "choices": [
      {
        "id": 1,
        "text": "Morphine"
      },
      {
        "id": 2,
        "text": "Fentanyl"
      },
      {
        "id": 3,
        "text": "Sufentanyl"
      },
      {
        "id": 4,
        "text": "Remifentanyl"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Sufentanil</strong> has the highest water partition coefficient and hence is the <strong>most potent</strong> opioid.</p>\n<p>Fentanyl is 100 times more potent and sufentanil is 1000 times more potent than morphine.</p>\n<p>\u00a0</p>\n<p><strong class=\"ng-binding\">Octanol/ water partition coefficients of opioids</strong></p>\n<div class=\"panel-body ng-scope\">\n<p class=\"ng-binding ng-scope\">\u00a0</p>\n<ul>\n<li>Octanol/water partition coefficient is a measure of the<strong>\u00a0potency of a compound</strong>\u00a0and the ability to traverse lipid membranes.\n<ul>\n<li>Morphine \u2013 1.4</li>\n<li>Remifentanil \u2013 17.3</li>\n<li>Alfentanil -145</li>\n<li>Fentanyl \u2013 813</li>\n<li>Sufentanil-1778</li>\n</ul>\n</li>\n<li>As can be seen, sufentanil has the highest octanol/water partition coefficient making it the most potent opioid.</li>\n</ul>\n<p>\u00a0</p>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient has presented to your OPD with a sebaceous cyst on the scalp. You plan to excise it. Before making the first incision, you inject lidocaine around it. Which of the following effects does this drug have?",
    "choices": [
      {
        "id": 1,
        "text": "Only 1"
      },
      {
        "id": 2,
        "text": "1, 3 & 5"
      },
      {
        "id": 3,
        "text": "1, 2 & 4"
      },
      {
        "id": 4,
        "text": "1, 3, 4 & 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Local anesthetics <strong>inhibit</strong> <strong>potassium channels.</strong>&nbsp;</p>\n<p>The effects of local anesthetics include:</p>\n<ul>\n<li>Inhibition of voltage-gated Na channels</li>\n<li>Blockade of potassium and calcium channels</li>\n<li>Transient receptor potential vanilloid 1 (TRPV1)</li>\n<li>Interaction with cholinergic or N-methyl-D-aspartate (NMDA) receptors</li>\n<li>Interference with cellular metabolic processes (eg, oxidative phosphorylation, free fatty acid utilization)</li>\n</ul>\n<p>However, the <strong>main action</strong> of local anesthetics is mediated by <strong>inhibition of voltage-gated Na channels</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Methaemoglobinaemia is a side effect of ___________",
    "choices": [
      {
        "id": 1,
        "text": "Prilocaine"
      },
      {
        "id": 2,
        "text": "Benzocaine"
      },
      {
        "id": 3,
        "text": "Procaine"
      },
      {
        "id": 4,
        "text": "Both A and B"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Both prilocaine and benzocaine can cause methaemoglobinaemia.</p>\n<p><strong>Prilocaine</strong>&nbsp;is the only local anesthetic that is&nbsp;<strong>metabolized to&nbsp;<em>o&nbsp;</em>-toluidine</strong>, which&nbsp;converts hemoglobin to methemoglobin producing methemoglobinemia. This is usually significant with doses of prilocaine as large as 600mg.</p>\n<p><strong>Benzocaine</strong> and<strong> cetacaine</strong> used as topical local anesthetic sprays can also cause dangerous Methemoglobinemia.</p>\n<p>Treatment of medically important methemoglobinemia includes intravenous methylene blue (1&ndash;2 mg/kg of a 1% solution over 5 min). Methylene blue acts by reducing methemoglobin (Fe 3+ ) to hemoglobin (Fe 2+).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "When asked to administer a combination of lignocaine and epinephrine for a minor procedure under local anesthesia, what concentration of epinephrine will you use?",
    "choices": [
      {
        "id": 1,
        "text": "1 : 10,000"
      },
      {
        "id": 2,
        "text": "1 :20,000"
      },
      {
        "id": 3,
        "text": "1 : 1,00, 000"
      },
      {
        "id": 4,
        "text": "1 : 2,00,000"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Epinephrine is used along with local anesthetics at a concentration of <strong>5 &mu;g/mL </strong>or <strong>1:200,000.</strong> At this dose, epinephrine provides <strong>adequate vasoconstriction.</strong></p>\n<p><strong>Advantages of vasoconstrictors:</strong></p>\n<ul>\n<li>Increased duration of action</li>\n<li>Improved depth of anesthesia</li>\n<li>Decreased local anesthetic toxicity</li>\n<li>As a marker for inadvertent intravascular injection</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents with a foreign body in the right cornea. Which would be the topical anesthetic of choice to remove it?",
    "choices": [
      {
        "id": 1,
        "text": "Tetracaine"
      },
      {
        "id": 2,
        "text": "Cocaine"
      },
      {
        "id": 3,
        "text": "Bupivacaine"
      },
      {
        "id": 4,
        "text": "Prilocaine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Tetracaine</strong> is the topical anesthesia of choice for the <strong>removal</strong> of <strong>foreign bodies</strong> from the cornea.</p>\n<p>Topical anesthetics used in ophthalmology include:&nbsp;</p>\n<ul>\n<li>Tetracaine</li>\n<li>Proparacaine eye drops</li>\n<li>Lidocaine gel</li>\n<li>Intranasal cocaine</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 4-year-old child is observed to have difficulty in breathing along with bluish discolouration of his lips and fingers while playing. It improves on adopting a knee-chest position. Which is the ideal induction agent of choice used for surgical correction of the condition suffered by this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Thiopentone"
      },
      {
        "id": 2,
        "text": "Propofol"
      },
      {
        "id": 3,
        "text": "Etomidate"
      },
      {
        "id": 4,
        "text": "Ketamine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p style=\"text-align: justify;\"><strong>Ketamine</strong> is the induction agent of choice in this patient who is likely suffering from <strong>tetralogy of Fallot</strong> because it maintains or <strong>increases systemic vascular resistance </strong>and<strong> increases cardiac output. </strong></p>\n<p style=\"text-align: justify;\">Tetralogy of Fallot is characterized by sub pulmonic stenosis, right ventricular hypertrophy, ventricular septal defect and overriding of the aorta. This results in a <strong>right to left shunt</strong> through the ventricular septal defect and consequent cyanosis.</p>\n<p style=\"text-align: justify;\">The commonest symptoms are <strong>dyspnea on exertion</strong> and exercise intolerance and develop <strong>blue skin&nbsp;</strong>(cyanosis) when agitated and are known as <strong>tet spells</strong>. The patients assume a <strong>sitting posture (squatting) </strong>or <strong>knee-chest position</strong> as soon as they get dyspneic, which leads to <strong>temporary symptomatic relief.</strong></p>\n<p style=\"text-align: justify;\">Ketamine&nbsp;<strong>does not aggravate </strong>the<strong> right to left shunt</strong> seen in such cases. It also does not increase pulmonary vascular resistance in children as compared to adults and is hence safe to administer in children.</p>\n<p style=\"text-align: justify;\">Ketamine is the agent of choice in all cyanotic congenital heart diseases.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Regional anaesthesia is preferred over general anaesthesia in transurethral resection of prostate because ________",
    "choices": [
      {
        "id": 1,
        "text": "Low risk of DVT"
      },
      {
        "id": 2,
        "text": "Less blood loss"
      },
      {
        "id": 3,
        "text": "Less chance of masking TURP syndrome"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>All the above statements are true.</p>\n<p><strong>Regional anesthesia is preferred over general anesthesia in TURP</strong>&nbsp;because:</p>\n<ul>\n<li>Less likely to mask the symptoms of TURP syndrome: It helps to assess patients mental status. Alteration in mental status is an early sign of excess irrigation fluid absorption and TURP syndrome. Acute hyponatremia from TURP syndrome may delay or prevent emergence from general anesthesia.</li>\n<li>Lesser amount of operative blood loss.</li>\n<li>Lesser risk of deep vein thrombosis.</li>\n<li>Less likely to mask symptoms of bladder perforation.</li>\n<li>Decreased need for analgesics in the immediate post &ndash;operative period.</li>\n</ul>\n<p><strong>Spinal anesthesia is preferred over epidural anesthesia</strong>&nbsp;because:</p>\n<ul>\n<li>Easier to perform in elderly patients.</li>\n<li>Duration of surgery is not usually long.</li>\n<li>Epidural anesthesia may incompletely block the sacral nerve roots which can be avoided with spinal anesthesia.</li>\n</ul>\n<p><strong>Caudal anesthesia may be used in high-risk patients undergoing laser prostatectomy</strong>&nbsp;as it provides the advantage of hemodynamic stability.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a complication of retrobulbar block?",
    "choices": [
      {
        "id": 1,
        "text": "Subconjuctival haemorrhage"
      },
      {
        "id": 2,
        "text": "Proptosis"
      },
      {
        "id": 3,
        "text": "Both A and B"
      },
      {
        "id": 4,
        "text": "Hypermetropia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Both subconjunctival haemorrhage and proptosis are complications of retrobulbar anaesthesia.</p>\n<p><strong>Retrobulbar block</strong> is a regional anesthesia technique used in ophthalmic surgery which involves the injection of a local anesthetic into the extraocular muscle cone. The needle penetrates the lower lid at the junction of lateral one third and medial two third of the orbit.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following agents used in children has not been associated with a potential risk of drug-induced apoptosis?",
    "choices": [
      {
        "id": 1,
        "text": "Nitrous oxide"
      },
      {
        "id": 2,
        "text": "Fentanyl"
      },
      {
        "id": 3,
        "text": "Propofol"
      },
      {
        "id": 4,
        "text": "Thiopentone"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Opioids</strong> like fentanyl have not been associated with the phenomenon of <strong>drug-induced apoptosis.&nbsp;</strong></p>\n<p>Drugs that have <strong>not</strong> been associated with apoptosis:</p>\n<ul>\n<li>Dexmedetomidine</li>\n<li>Opioids</li>\n<li>Xenon</li>\n</ul>\n<p>Drugs that have been associated with apoptosis in laboratory animals:</p>\n<ul>\n<li>Nitrous oxide</li>\n<li>Ketamine</li>\n<li>Propofol</li>\n<li>Etomidate</li>\n<li>Barbiturates</li>\n<li>Benzodiazepines</li>\n<li>Chloral hydrate</li>\n<li>Ethanol</li>\n</ul>\n<p>The potential risks for apoptosis in children are seen especially in ages&nbsp;<strong>less than 3 years </strong>which is&nbsp;the period of rapid brain growth. But human studies regarding the potential for drug-induced apoptosis and its consequences like neurocognitive dysfunction are insufficient.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most common cause of perioperative vision loss?",
    "choices": [
      {
        "id": 1,
        "text": "Globe perforation"
      },
      {
        "id": 2,
        "text": "Angle closure glaucoma"
      },
      {
        "id": 3,
        "text": "Retinal emboli"
      },
      {
        "id": 4,
        "text": "Ischemic optic neuropathy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Ischemic optic neuropath</strong>y is the most common cause of perioperative vision loss.</p>\n<p>It is usually seen after <strong>spine</strong> <strong>surgeries</strong> in the prone position, <strong>radical neck dissections</strong> and following <strong>cardiopulmonary bypass.</strong></p>\n<p><strong>Symptoms:</strong>&nbsp;Reduced visual acuity, rarely complete blindness; usually presents on awakening from anesthesia.</p>\n<p><strong>Preoperative risk factors:</strong>&nbsp;</p>\n<ul>\n<li>Diabetes, hypertension</li>\n<li>Smoking</li>\n<li>Coronary artery disease.</li>\n</ul>\n<p><strong>Intraoperative risk factors:</strong>&nbsp;</p>\n<ul>\n<li>Anaemia</li>\n<li>Hypotension</li>\n<li>Prone position</li>\n<li>Prolonged duration of surgery&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following statements about post anaesthetic shivering are true except ___________",
    "choices": [
      {
        "id": 1,
        "text": "Peri operative hypothermia is the major cause"
      },
      {
        "id": 2,
        "text": "Intensity is more with spinal than epidural anaesthesia"
      },
      {
        "id": 3,
        "text": "Meperidine is used for treatment"
      },
      {
        "id": 4,
        "text": "The incidence is around 40%"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Intensity of shivering is more with epidural than spinal anaesthesia. This is because spinal anaesthesia causes more profound motor block and consequently, inability to shiver.</p>\n<p><strong>Post anaesthetic shivering:</strong></p>\n<ul>\n<li>Peri operative hypothermia is the major cause of post anaesthetic shivering.</li>\n<li>The incidence of post-anesthetic shivering is around 40%.</li>\n<li>It can increase oxygen consumption, catecholamine release, cardiac output, heart rate and blood pressure which can aggravate cardiovascular mortality especially in elderly patients.</li>\n<li>The most efficient way to reduce post-anesthetic shivering is to prevent hypothermia by avoiding cold epidural and intravenous fluids.</li>\n<li>Meperidine is the most effective treatment for post-anesthetic shivering.</li>\n<li>Other drugs:\n<ul>\n<li>Clonidine</li>\n<li>Ketanserin</li>\n<li>Tramadol</li>\n<li>Physostigmine</li>\n<li>Nefopam</li>\n<li>Dexmedetomidine</li>\n<li>Magnesium sulfate</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old male is posted for inguinal hernia surgery. In order to perform a fast-track surgical procedure, the anesthetic technique of choice is:",
    "choices": [
      {
        "id": 1,
        "text": "General anesthesia"
      },
      {
        "id": 2,
        "text": "Spinal anesthesia"
      },
      {
        "id": 3,
        "text": "Epidural anesthesia"
      },
      {
        "id": 4,
        "text": "Infiltration anesthesia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Infiltration anesthesia</strong> is ideal to perform inguinal hernia repair as a<strong> fast-track procedure.</strong></p>\n<p>It has a lesser incidence of complications than regional or general anesthesia. Other anesthetic techniques for hernia repair include intercostal block and ilioinguinal nerve block.</p>\n<p>Ambulatory/Outpatient anesthesia employs the use of fast - Track surgical techniques to provide adequate surgical anesthesia and minimize post-operative complications in order to reduce the duration of hospital stay.</p>\n<p><strong>Disadvantage of infiltration anesthesia</strong>&nbsp;- Short duration of anesthesia even when long-acting local anesthetics like bupivacaine are used. Extended- duration local anesthesia can be produced by encapsulating bupivacaine into a biodegradable carrier.</p>\n<p><strong>Regional anesthesia</strong> is contraindicated in patients with bleeding disorders, those on anticoagulants and with local infections.</p>\n<p><strong>Spinal anesthesia</strong> has the disadvantage over epidural anesthesia of delayed recovery due to profound motor blockade. Spinal opioids like fentanyl or sufentanil are added to prolong postoperative analgesia and minimize motor block without delaying recovery. But the adverse effects of spinal opioids like nausea, pruritus and postoperative urinary retention are additive.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "After neuraxial block, patient was unable to raise extended leg, but was able to move knees or feet. Motor block in this patient as per modified bromage scale is ________",
    "choices": [
      {
        "id": 1,
        "text": "Stage 1"
      },
      {
        "id": 2,
        "text": "Stage 2"
      },
      {
        "id": 3,
        "text": "Stage 3"
      },
      {
        "id": 4,
        "text": "Stage 4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Inability to raise extended leg but being able to move knees and feet, after a neuraxial block is graded as stage 1 as per <strong>modified</strong> <strong>bromage scale.</strong></p>\n<p><strong>Modified bromage </strong>scale is the most common method used for assessment of motor block following neuraxial anaesthesia. The disadvantage is it represents only lumbosacral motor fibers.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is set to undergo cesarean section under subarachnoid block. Upto which dermatome must the anaesthetist ensure adequate anaesthesia?",
    "choices": [
      {
        "id": 1,
        "text": "T4"
      },
      {
        "id": 2,
        "text": "T8"
      },
      {
        "id": 3,
        "text": "T10"
      },
      {
        "id": 4,
        "text": "T12"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>For a cesarean&nbsp;section, the sensory block should be achieved up to&nbsp;<strong>T4</strong> dermatomal level (motor T6), as the pain-sensitive&nbsp;peritoneum innervation starts from T4 level.</p>\n<p>The risk of high spinal and severe hypotension is higher because the block has to reach T4. Hence,&nbsp;consider prehydration with 20 ml/kg, proper positioning, and keeping phenylephrine or ephedrine on hand.</p>\n<p>Dermatomal Level required for Various Common Surgical Procedures:</p>\n<ul>\n<li>T4 - Upper abdominal surgery</li>\n<li>T10 - Transurethral resection of prostate</li>\n<li>T10 - Hip surgery</li>\n<li>L2 - Foot and ankle surgery</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is complaining of severe headache following hernia surgery under spinal anesthesia. The headache is occipital in location which worsens on standing and is relieved by lying flat. All of the following needles can be used to perform spinal anesthesia to reduce the incidence of the above condition except",
    "choices": [
      {
        "id": 1,
        "text": "Whitacre needle"
      },
      {
        "id": 2,
        "text": "Quincke needle"
      },
      {
        "id": 3,
        "text": "Tuohy needle"
      },
      {
        "id": 4,
        "text": "Sportte needle"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the given scenario, the patient complained of headache in the occiput which worsens on standing and is relieved by lying flat following spinal anesthesia is suggestive of post-dural puncture headache. <strong>Quincke</strong> needle <strong>increases</strong> the <strong>risk</strong> of <strong>post-dural</strong> puncture <strong>headache.</strong></p>\n<p>The <strong>Quincke</strong> needle is a cutting needle with an end injection. <strong>Whitacre and Tuohy</strong> are Pencil-point needles (blunt needles) which reduce the incidence of post\u2013dural puncture headaches.</p>\n<p>Types of needles based on tip shapes:</p>\n<ul>\n<li>\u00a0<strong>Dura cutting</strong> needles:\n<ul>\n<li><strong>Quincke-babcock</strong> needle</li>\n<li>Pitkin needle</li>\n</ul>\n</li>\n<li><strong>Pencil point</strong> needles (blunt):\n<ul>\n<li><strong>Whitacre</strong></li>\n<li>Sprotte - side-injection needle with a long opening</li>\n<li><strong>Tuohy</strong> - most commonly used needle for epidural anesthesia</li>\n<li>Greene</li>\n</ul>\n</li>\n</ul>\n<p><strong>PDPH</strong>\u00a0can occur after spinal or epidural anesthesia due to\u00a0<strong>loss of CSF</strong>\u00a0through the dura which causes traction on the pain-sensitive intracranial structures. It may also occur due to\u00a0<strong>compensatory</strong>, painful\u00a0<strong>intracranial</strong>\u00a0<strong>vasodilation</strong>\u00a0to offset the reduction in intracranial pressure.\u00a0Most cases occur<strong>\u00a0within 72 hours</strong>\u00a0of dural puncture.\u00a0</p>\n<p>The headache\u00a0<strong>worsens</strong>\u00a0with the\u00a0<strong>standing</strong>\u00a0or\u00a0<strong>seated\u00a0</strong>position\u00a0and is\u00a0<strong>relieved</strong>\u00a0by lying in the<strong>\u00a0supine position</strong>. It is typically\u00a0<strong>frontal</strong>\u00a0or<strong>\u00a0occipital\u00a0</strong>in distribution and the associated\u00a0symptoms include nausea, neck stiffness, low back pain, vertigo, vision changes, and auditory disturbances.\u00a0</p>\n<p>Diagnosis is based on typical history and imaging is only rarely performed to exclude other diagnoses.</p>\n<p>Management of PDPH: Most of the headaches\u00a0<strong>resolve spontaneously</strong>\u00a0within\u00a0<strong>7 days</strong>. Conservative management includes</p>\n<ul>\n<li><strong>Supine positioning</strong></li>\n<li>Hydration</li>\n<li><strong>Caffeine</strong></li>\n<li><strong>Oral analgesics</strong></li>\n<li>Sumatriptan</li>\n<li>An\u00a0<strong>epidural blood patch</strong>\u00a0is the\u00a0<strong>definitive</strong>\u00a0management.\n<ul>\n<li>It is ideally performed\u00a0<strong>24 hours</strong>\u00a0after dural puncture and the development of classic symptoms.</li>\n<li><strong>15-20 mL</strong>\u00a0of autologous blood is injected into the\u00a0<strong>epidural space</strong>\u00a0at the<strong>\u00a0same\u00a0</strong>or\u00a0<strong>one interspace below\u00a0</strong>the level of the dural puncture.</li>\n<li>It acts by stopping the CSF leak by either mass effect or coagulation.</li>\n<li>Most\u00a0<strong>patients\u00a0</strong>will respond to a<strong>\u00a0single blood patch</strong>, and 90% of initial nonresponders will obtain relief from a second injection (1 to 2 days after the first).</li>\n<li>A prophylactic epidural patch is not recommended.</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 18-month-old boy with CTEV is undergoing corrective treatment. He is scheduled for a posteromedial soft tissue release procedure. You see the anaesthesia resident mark out the points shown in the image on his back. In what anaesthetic procedure are these landmarks used?",
    "choices": [
      {
        "id": 1,
        "text": "Spinal anesthesia"
      },
      {
        "id": 2,
        "text": "Caudal anesthesia"
      },
      {
        "id": 3,
        "text": "Epidural anesthesia"
      },
      {
        "id": 4,
        "text": "Saddle block"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The landmarks depicted in the image are in reference to <strong>caudal anaesthesia.&nbsp;</strong>It is a common regional technique in&nbsp;paediatrics&nbsp;for procedures below the diaphragm, including urogenital, rectal, inguinal, and lower extremity surgery.&nbsp;</p>\n<p>Caudal anaesthesia involves deposition of local anaesthetic in the caudal epidural space, accessed through the sacral hiatus. Sacral hiatus is formed by the unfused S4 and S5 laminae and is covered by the sacrococcygeal ligament.</p>\n<p>The lines joining the <strong>posterior superior iliac spines</strong> and <strong>sacral hiatus</strong> make an equilateral triangle. The sacral hiatus is felt as a groove or notch above the coccyx and between two bony prominences, the sacral cornua.</p>\n<p>It is better&nbsp;appreciated in children than in adults and hence it is a common&nbsp;regional technique among pediatric patients.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5ecd2fe0d398452da490d5f09beeca95.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2be78b40ccbb43008e075d4a4c536dd7x1280x1890.JPEG"
    ]
  },
  {
    "text": "A patient had bilateral pain in buttocks radiating to legs within 24 hours after undergoing surgery under spinal anaesthesia. There is no other neurological abnormality. This is most likely due to which of the following anaesthetic?",
    "choices": [
      {
        "id": 1,
        "text": "Lidocaine"
      },
      {
        "id": 2,
        "text": "Bupivacaine"
      },
      {
        "id": 3,
        "text": "Prilocaine"
      },
      {
        "id": 4,
        "text": "Ropivacaine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Bilateral pain in buttocks radiating to legs within 24 hours after undergoing surgery under spinal anaesthesia, is suggestive of <strong>transient neurological symptoms</strong> which is seen in case of <strong>Lidocaine</strong> and <strong>mepivacaine</strong>. It is less frequent with bupivacaine.</p>\n<p><strong>Transient neurological symptoms:</strong></p>\n<ul>\n<li>It is commonly associated with spinal lidocaine (not commonly associated with epidural lidocaine)</li>\n<li>The phenomenon is related to the concentration of lidocaine, the addition of dextrose or epinephrine, or solution osmolarity.</li>\n<li>Symptoms are usually characterized by&nbsp;<strong>bilateral or unilateral pain in the buttocks radiating to the legs</strong>&nbsp;or, less commonly, isolated buttock or leg pain. Symptoms occur&nbsp;<strong>within 24 hours&nbsp;</strong>of the resolution of an otherwise uneventful spinal anesthetic and are not associated with any neurologic deficits or laboratory abnormalities.</li>\n<li>TNS occurs&nbsp;<strong>more commonly&nbsp;</strong>in patients who are placed in the&nbsp;<strong>lithotomy position&nbsp;</strong>for surgery.</li>\n<li>Nonsteroidal anti-inflammatory drugs are the first line of treatment, but pain can be severe and may even require opioids.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Anaphylactic reactions are least common with __________",
    "choices": [
      {
        "id": 1,
        "text": "Albumin"
      },
      {
        "id": 2,
        "text": "Gelatin"
      },
      {
        "id": 3,
        "text": "Hydroxyethyl starch"
      },
      {
        "id": 4,
        "text": "Dextran"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Anaphylactic reactions are least common (&lt;0.06%) with <strong>hydroxyethyl starch</strong> as it is non antigenic.</p>\n<ul>\n<li>The incidence of anaphylaxis and anaphylactoid reactions is maximum with gelatin (&lt;0.35%).</li>\n<li>The occurrence of anaphylaxis following dextran is intermediate (0.28%). This can be minimized by pretreatment with a hapten inhibitor dextran1.</li>\n<li>Albumin also results in allergic reactions.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old primigravida is screaming in pain while being wheeled into the labour room at 2 am. On examination, her cervix is well-effaced and is 4 cm dilated. What is the preferred anaesthetic technique to ensure this patient has a painless labour?",
    "choices": [
      {
        "id": 1,
        "text": "Pudendal nerve block"
      },
      {
        "id": 2,
        "text": "Spinal anesthesia"
      },
      {
        "id": 3,
        "text": "Caudal anesthesia"
      },
      {
        "id": 4,
        "text": "Lumbar epidural"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p style=\"text-align: justify;\"><strong>Lumbar epidural&nbsp;</strong>is the most commonly used technique to produce labour analgesia because it can provide analgesia during the first stage of labour and also provide anaesthesia during vaginal delivery or cesarean section if necessary.</p>\n<p style=\"text-align: justify;\">For adequate pain relief, the<strong> sensory block </strong>of <strong>T10-L1 i</strong>s required during the first stage of labour and <strong>S2-S4 </strong>is required during the&nbsp;second stage. The epidural catheter placed at L3-L4 or L4-L5 interspace sufficiently provides T10&ndash;S5 neural blockade.</p>\n<p style=\"text-align: justify;\">Option A<strong>: </strong>Pudendal nerve block&nbsp;is given in the <strong>second stage</strong> of&nbsp;labor&nbsp;just before delivery of the baby to provide analgesia to the vulva and anus\u200b. However, it has no effect on the pain of contractions. It is also given before repair of episiotomy or perineal lacerations.</p>\n<p style=\"text-align: justify;\">Option B<strong>: </strong>Spinal anaesthesia&nbsp;for labour analgesia has the advantage of a rapid and reliable onset of the neural blockade, and it is technically easier to administer&nbsp;compared to epidural analgesia. However, repeated intrathecal injections may be required for a prolonged labour, thus increasing the risk of <strong>post-dural puncture headache.</strong></p>\n<p style=\"text-align: justify;\">Option C<strong>: </strong>Caudal epidural&nbsp;is largely <strong>abandoned</strong> to provide pain relief in obstetrics.&nbsp;It requires large volumes of a local anaesthetic to anaesthetize upper lumbar and lower thoracic dermatomes to provide adequate labour analgesia. Though rare, accidental puncture of the fetus is a possibility.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following situations can bag and mask ventilation be performed?",
    "choices": [
      {
        "id": 1,
        "text": "Obese individual with a difficult airway"
      },
      {
        "id": 2,
        "text": "Emergency laparotomy requiring rapid sequence induction"
      },
      {
        "id": 3,
        "text": "Severe facial trauma"
      },
      {
        "id": 4,
        "text": "Diaphragmatic hernia following blunt trauma to chest"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Bag and mask ventilation <strong>can be performed</strong> in patients with <strong>difficult airway.<br /><br /></strong>Bag and mask ventilation serves as a rescue technique to provide oxygenation and ventilation in patients with difficult airway until tracheal intubation is achieved.</p>\n<p><br /><strong>Contraindications of bag and mask ventilation:&nbsp;</strong></p>\n<p>Patients at greater risk of aspiration such as patients with <strong>diaphragmatic</strong> <strong>hernia</strong> and those undergoing <strong>rapid sequence induction</strong> and intubation. This is because air can enter the stomach leading to raised intragastric pressure which increases the risk of aspiration.<br /><br /></p>\n<div class=\"page\" title=\"Page 1935\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Mask ventilation should also be performed with <strong>caution</strong> in patients with <strong>severe facial trauma</strong> and in patients in whom head and neck manipulation must be avoided (e.g., those with an unstable cervical spine fracture).</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Anaesthesia Test I';
        const quizFilename = 'anaesthesia-test-i-0895b9bf.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2018 - 19"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>