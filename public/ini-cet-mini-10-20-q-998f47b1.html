<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ini-Cet  Mini - 10 (20 Q) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "You are the Medical Officer-in-charge of a vaccination campaign in a District Hospital and you receive the vaccine given in the picture below. This vaccine can be stored in which of the following storage options?",
    "choices": [
      {
        "id": 1,
        "text": "2,4"
      },
      {
        "id": 2,
        "text": "2,3,4"
      },
      {
        "id": 3,
        "text": "1,3,5"
      },
      {
        "id": 4,
        "text": "1,2,3,5"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The vaccine portrayed in the image given is the <strong>Covishield vaccine</strong> which has to be <strong>stored between +2 to +8&deg;C</strong>. Walk-in cooler, Ice lined refrigerator and Domestic refrigerator maintains a temperature between +2 to +8&deg;C.</p>\n<p>Covid 19 AstraZeneca/Covishield vaccine storage and use guidelines :</p>\n<ul>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Shelf life of <strong>6 months</strong> stored in a refrigerator <strong>between 2 to 8&deg;C</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Once removed from the refrigerator, may be stored <strong>between 2 to 25&deg;C</strong> for up to&nbsp;<strong>6 hours</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Once punctured, the vial must be used <strong>within 6 hours</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Must not be frozen</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Keep vials in the outer carton to <strong>protect from light</strong></li>\n</ul>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/85bbf0d6369e423086f209069c8e818a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient diagnosed with type 2 neurofibromatosis was referred to the Department of Otorhinolaryngology for hearing rehabilitation after excision of bilateral acoustic neuromas. The surgery notes mentioned that the 8th nerve was severed during the surgery. After further evaluation, a decision to insert an implant to aid hearing was made. Where will the implant be placed?",
    "choices": [
      {
        "id": 1,
        "text": "Scala vestibuli"
      },
      {
        "id": 2,
        "text": "Incus bone"
      },
      {
        "id": 3,
        "text": "Scala tympani"
      },
      {
        "id": 4,
        "text": "Fourth ventricle"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The implant of choice, in this case, would be an <strong>auditory brainstem implant (ABI)</strong>, which is placed in the <strong>lateral recess of the 4th ventricle</strong>. It is designed to directly stimulate the cochlear nuclear complex in the brainstem.</p>\n<p>This type of implant is required when cranial nerve VIII has been severed in surgery for vestibular schwannomas. In unilateral acoustic neuromas, ABI is not necessary as hearing is possible from the contralateral side. The receiver or stimulator has a removable magnet so that MRI can be safely performed if required.</p>\n<p>ABIs help in communication, awareness, and recognition of environmental sounds, but are not as efficient as multichannel cochlear implants.\u00a0</p>\n<p><strong>Cochlear implants </strong>are electronic devices for\u00a0severe to profound SNHL<strong>\u00a0</strong>and those who cannot benefit from a hearing aid.\u00a0The electrode array is placed within the s<strong>cala tympani</strong>\u00a0of the cochlea. A prerequisite for this is that cranial nerve VIII\u00a0and the higher auditory pathway\u00a0should be intact.</p>\n<p>\u00a0</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/51bb14a7b2b64e1b98d13107998e2b93x1280x1808.JPEG"
    ]
  },
  {
    "text": "A 70-year-old patient was brought to you by his wife, who complains that he tends to collect unwanted things and does not allow these things to be thrown away. She shows you the following photograph of their house, which has gradually become this way over the last 8 years. Identify the incorrect statement about this condition.",
    "choices": [
      {
        "id": 1,
        "text": "Driven by an obsessive fear of losing important items"
      },
      {
        "id": 2,
        "text": "Patients do not perceive this as a problem"
      },
      {
        "id": 3,
        "text": "Full remission is achieved after treatment"
      },
      {
        "id": 4,
        "text": "CBT is the most effective management"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows the house of a person with <strong>hoarding disorder</strong>. Full remission is rarely achieved, as <strong>patients lack insight</strong> into their behavior.\u00a0</p>\n<div class=\"page\" title=\"Page 447\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The disorder is characterized by <strong>acquiring</strong> and <strong>not</strong> <strong>discard\u00ading</strong> things that are of <strong>little or no value</strong>, resulting in <strong>excessive clutter</strong> of living spaces, driven by an <strong>obsessive fear</strong> of <strong>losing</strong> <strong>important items</strong> that the person believes <strong>may be useful </strong>in the <strong>future.\u00a0</strong>It was con\u00adsidered a subtype of obsessive-compulsive disorder (OCD) but is now considered to be a separate diagnostic entity.\u00a0</p>\n<p>Most hoarders <strong>do not perceive</strong> their <strong>hoarding</strong> as <strong>a</strong> <strong>problem</strong> and believe it is a reasonable part of their identity. There is an <strong>inability</strong> <strong>to organize</strong> their possessions and they often hoard to <strong>avoid making decisions</strong> about discarding items. Patients with hoarding disorder <strong>overemphasize</strong> the <strong>importance</strong> of recall\u00ading <strong>information</strong> and <strong>possessions</strong>.</p>\n<p>Commonly hoarded items include <strong>newspapers</strong>, mail, magazines, <strong>clothes</strong>, bags, <strong>books</strong>, and <strong>notes</strong>. Clutter accumulated from hoarding can lead to <strong>deaths from fires</strong> or <strong>patients being crushed</strong> by their possessions. It may also attract <strong>pest infesta\u00adtions</strong>.</p>\n<p>The most effective <strong>treatment</strong> for the disorder is <strong>cognitive-behavioral therapy</strong> which involves training in <strong>decision making</strong> and <strong>categorizing exposure</strong> and habituation to discarding, and cognitive restructuring. This includes both office and in-home sessions. It is less\u00a0respon\u00adsive to classic treatments for OCD such as exposure therapy and selective serotonin reuptake inhibitors (SSRis).</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9cdee72f4dc54352855dc140471086cf.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "While collecting samples from a patient scheduled to undergo a blood transfusion, which of the following vacutainers will you use to collect blood for cross-matching, and which cannula will you use for blood transfusion?",
    "choices": [
      {
        "id": 1,
        "text": "Green vacutainer, Green cannula"
      },
      {
        "id": 2,
        "text": "Purple vacutainer, Green cannula"
      },
      {
        "id": 3,
        "text": "Purple vacutainer, Blue cannula"
      },
      {
        "id": 4,
        "text": "Green vacutainer, Blue cannula"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Lavender/purple vacutainer&nbsp;</strong>(EDTA) vacutainer is used for <strong>routine hematological studies</strong> and <strong>green cannula</strong> (18G) is used for <strong>blood transfusion</strong>.</p>\n<p><strong>EDTA</strong> is the additive present in purple vacutainer, which <strong>chelates</strong> calcium and other metal ions needed for the coagulation cascade. It is routinely used for most routine hematological investigations <strong>because it preserves the morphology</strong> of cellular components.</p>\n<p>Though green cannula(18G) can be used for blood transfusion. Grey (16G) is preferred in case multiple transfusion or rapid fluid infusion is necessary.</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Cap colour</strong></td>\n<td><strong>Additive present</strong></td>\n</tr>\n<tr>\n<td>Light blue top</td>\n<td>Sodium citrate</td>\n</tr>\n<tr>\n<td>Dark green top</td>\n<td>Heparin</td>\n</tr>\n<tr>\n<td>Purple top</td>\n<td>EDTA</td>\n</tr>\n<tr>\n<td>Pale yellow top</td>\n<td>Acid citrate dextrose</td>\n</tr>\n<tr>\n<td>Light grey top</td>\n<td>Sodium fluoride and potassium oxalate</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A three-year-old female child was brought by her mother with complaints of fever, vomiting, and poor sensorium.  At admission, the child was in early shock with a GCS of 8/15. She had multiple healed scars and fresh bruises all over her body. Her mother attributed each injury to a different event in the past and denies any recent injury. A CT scan of her head revealed an epidural hemorrhage and a fracture of the skull. Which type of fracture is most likely to be seen in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Ring fracture"
      },
      {
        "id": 2,
        "text": "Expressed fracture"
      },
      {
        "id": 3,
        "text": "Diastatic fracture"
      },
      {
        "id": 4,
        "text": "Gutter fracture"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical case suggests non-accidental injuries or child abuse, and the most likely fracture among the given options, that will be seen in a 3-year-old child with a history of abuse is a <strong>Diastatic fracture</strong>.</p>\n<div class=\"page\" title=\"Page 294\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Diastatic fractures refer to fractures in which the fracture line involves the <strong>separation</strong> of one or more <strong>cranial sutures</strong>. These are commonly seen in children and are often associated with epidural or subdural hemorrhage. The sagittal suture between the two parietal bones is the most common site of these fractures.</p>\n<p>They result from a <strong>large or broad impact</strong> to the head, as seen in blows, falls, industrial or vehicular accidents. It is also seen in circumstances where the victim is swung by their legs against a wall or an immovable object.</p>\n<div class=\"page\" title=\"Page 294\">&nbsp;</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d7e8b22e918c4bebb03108f89ff2ce39x1156x1108.PNG"
    ]
  },
  {
    "text": "A 50-year-old woman presents with episodes of intermittent right upper abdominal pain for the past few months. She underwent cholecystectomy a year back. Investigations showed elevated AST and ALT levels and imaging revealed a dilated common bile duct with prolonged biliary drainage time. What is the gold standard for diagnosing this condition?",
    "choices": [
      {
        "id": 1,
        "text": "CECT scan"
      },
      {
        "id": 2,
        "text": "HIDA scan"
      },
      {
        "id": 3,
        "text": "ERCP with manometry"
      },
      {
        "id": 4,
        "text": "Endoscopic ultrasound"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical vignette is suggestive of a <strong>Sphincter of Oddi dysfunction</strong>.\u00a0Endoscopic retrograde cholangiopancreatography<strong> (ERCP) </strong>with <strong>manometry</strong> of the biliary and pancreatic sphincters is the\u00a0<strong>gold standard </strong>for its diagnosis.</p>\n<p>Sphincter of Oddi dyskinesia or dysfunction (SOD) is characterized by abdominal pain, biliary or pancreatic duct dilatation due to abnormal function of the sphincter of Oddi.</p>\n<p>Clinical types include <strong>biliary</strong> and <strong>pancreatic</strong> SOD.</p>\n<p>Biliary type presents with biliary pain, raised <strong>liver enzymes,</strong> and/or <strong>dilation of the bile duct</strong> and/or evidence of <strong>delayed emptying</strong> on biliary imaging. It\u00a0should be excluded in patients with post-cholecystectomy syndrome.\u00a0Pancreatic SOD presents as recurrent episodes of unexplained acute pancreatitis.</p>\n<p>CT and magnetic resonance cholangiopancreatography (MRCP) can demonstrate <strong>dilatation </strong>of the<strong> biliary </strong>and<strong> pancreatic ducts</strong>. MRCP with intravenous secretin injection demonstrates <strong>dilatation</strong> of the <strong>pancreatic duct</strong> due to increased sphincter pressures. Endoscopic ultrasound can also be used. HIDA scan will show delayed biliary transit.</p>\n<p>The gold standard investigation is <strong>ERCP with manometry</strong> and is indicated in disabling pain, when\u00a0noninvasive investigations fail to demonstrate structural abnormalities and when conservative therapy fails. Basal sphincter pressure <strong>higher than 40 mm Hg</strong> is suggestive of SOD.<br /><br /><strong>ERCP</strong>\u00a0stands for Endoscopic Retrograde Cholangio Pancreaticography. It involves the use of a side-viewing<strong> endoscope</strong> which is passed through the pylorus of the stomach into the second part of the duodenum to visualize the papilla.</p>\n<p>It can be a\u00a0<strong>therapeutic</strong>\u00a0and\u00a0<strong>diagnostic</strong>\u00a0modality specifically for viewing the distal biliary tree.\u00a0The most common indication for therapeutic ERCP is the<strong> relief of biliary obstruction</strong> due to gallstone disease and benign or malignant biliary strictures.\u00a0\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man suffered a traumatic brain injury after a road traffic accident in which he fell from his motorcycle. He was brought to the emergency department where he was stabilized and a CT scan was performed which showed extensive damage to the medial undersides of both occipital lobes and the inferior medioventral surfaces of the temporal lobes. When he meets his family, which among the following is likely to happen?",
    "choices": [
      {
        "id": 1,
        "text": "Unable to understand what they are saying"
      },
      {
        "id": 2,
        "text": "Unable to recognise familiar voices"
      },
      {
        "id": 3,
        "text": "Unable to identify their faces"
      },
      {
        "id": 4,
        "text": "Unable to form words"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<div class=\"page\" title=\"Page 707\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Lesions to the medial underside of both occipital lobes and the inferior medioventral surfaces of the temporal lobes cause <strong>prosopagnosia</strong>, which is the inability to <strong>identify faces</strong>.</p>\n<p>The right <strong>inferior temporal</strong> lobe in right-handed individuals represents the&nbsp;storage and recognition of faces. Damage to this area can cause prosopagnosia. Patients with&nbsp;prosopagnosia can&nbsp;recognize people by their voices and also show autonomic&nbsp;responses when they see familiar faces. The left hemisphere is also involved, but the <strong>right hemisphere</strong> plays a major role.</p>\n<p>Other options:</p>\n<p>Option A: The inability<strong>&nbsp;</strong>to understand is seen in <strong>Wernicke's aphasia</strong>. The patient is not able to <strong>comprehend</strong> the meaning of spoken or written words.&nbsp;The speech is full of jargon and neologisms that do not make sense. It occurs due to a lesion in the <strong>superior temporal</strong> gyrus.</p>\n<p>Option B: The inability to recognize familiar voices is called <strong>phonagnosia</strong>. It is seen after damage to the inferior and lateral <strong>parietal</strong> regions of the right hemisphere.</p>\n<p>Option D: Difficulty in forming words(verbal or written) is seen in <strong>Broca's aphasia</strong> or motor aphasia. This occurs as a result of a lesion in Broca's area in the <strong>frontal lobe</strong>. Affected individuals have slow speech.</p>\n<p>&nbsp;</p>\n<div class=\"page\" title=\"Page 297\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>&nbsp;</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 16-year-old girl was taken to the emergency department with palpitations and restlessness after using a salbutamol inhaler 15 times in one hour following an asthma attack. Her chest examination was clear on auscultation, and cardiac examination showed tachycardia with a regular rhythm, without murmurs. What features are likely to be seen in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Tall T waves on ECG"
      },
      {
        "id": 2,
        "text": "Hypoglycemia"
      },
      {
        "id": 3,
        "text": "Hyperkalemia"
      },
      {
        "id": 4,
        "text": "Muscle tremors"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Salbutamol toxicity can cause <strong>muscle tremors</strong> due to stimulation of<strong>\u00a0\u03b22-adrenergic</strong> receptors in skeletal muscle. It is the most common side effect. The risk is higher with elderly patients and those with COPD.</p>\n<p>Salbutamol is a relatively selective \u03b22- adrenergic receptor agonist.\u00a0In overdose, receptor specificity may be lost and stimulation of cardiac \u03b22-receptors may cause <strong>tachycardia</strong>, cardiac ischemia, and arrhythmias. It causes <strong>hypokalemia\u00a0</strong>(option C)\u00a0by stimulating \u03b22-receptors of the Na<sup>+</sup>/K<sup>+</sup> ATPase pump in the skeletal muscle, shifting K<sup>+</sup> intracellularly. This can produce ECG changes such as<strong> flattening and inversion of T</strong> <strong>waves </strong>(option A), <strong>QT prolongation,</strong> and <strong>U waves</strong>.\u00a0</p>\n<p>Acute salbutamol toxicity may cause <strong>lactic acidosis</strong>. \u03b22-adrenergic stimulation increases gluconeogenesis and lipolysis. This causes increased plasma glucose, leading to increased conversion of pyruvate and lactate. Overdose can result in <strong>hyperglycemia </strong>(option B), <strong>lactic acidosis</strong>, and <strong>cardiac arrhythmias</strong>.\u00a0</p>\n<p>Other adverse effects include hypoxemia and metabolic effects such as an <strong>increase in free fatty acids </strong>and\u00a0insulin. Desensitization is noted in the long-term use of salbutamol.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Two brothers presented with bilateral painless progressive visual loss. After a thorough examination and investigation, the diagnosis of a rare inherited disease was made. The pedigree chart shown in the image below was drawn to explain which family members may be affected (colored red). Which among the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ocular albinism"
      },
      {
        "id": 2,
        "text": "Retinitis pigmentosa"
      },
      {
        "id": 3,
        "text": "Leber congenital amaurosis"
      },
      {
        "id": 4,
        "text": "Leber optic neuropathy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">The image shows&nbsp;</span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>mitochondrial&nbsp;</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>inheritance</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">, and the condition showing this pattern of inheritance is <strong>Leber optic neuropathy</strong>.</span></p>\n<p><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">The mitochondrial pattern of inheritance is when the&nbsp;<strong>mother is affected&nbsp;</strong>and the <strong>father is normal</strong>, which leads to&nbsp;<strong>all their children&nbsp;</strong><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z h-lparen\">(both&nbsp;</span>male and female) being<strong>&nbsp;affected</strong>. However, children born to an affected father and a normal mother will not be affected.</span></p>\n<p><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">The unique feature of mitochondrial inheritance is <strong>maternal inheritance</strong>, as the disease is transmitted through the affected <strong>mitochondrial DNA</strong>&nbsp;(mtDNA), which is derived from the maternal mitochondria. The ovum contains several mitochondria, while the spermatozoa have very few mitochondria, if present. Hence, the mitochondrial DNA of the zygote&nbsp;is entirely derived from the ovum.</span></p>\n<p><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">Therefore, while the affected mother transmits the disease to all the offspring (both&nbsp;male and female), only the daughters of the affected mother can further transmit the disease.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5a092a6695254f8697bce922b8fdf1a0.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e9d7f0e4ae96444d8fc4a952f9fd5c4bx1280x1242.9901269393513.JPEG"
    ]
  },
  {
    "text": "A mother brings her 3-month-old baby for a routine evaluation. On examination, a loud, harsh pan systolic murmur was heard on auscultation over the lower left sternal border. There was no cyanosis or finger clubbing. Echocardiography revealed a defect of 8 mm in the membranous part of the interventricular septum. The presence of which of the following would not be a valid indication for surgery?",
    "choices": [
      {
        "id": 1,
        "text": "Large defect not controlled by medication"
      },
      {
        "id": 2,
        "text": "Small supracristal defect"
      },
      {
        "id": 3,
        "text": "Eisenmenger syndrome"
      },
      {
        "id": 4,
        "text": "Large defect with failure to thrive"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above clinical scenario of a loud, harsh pansystolic murmur, with the given echocardiography findings, is suggestive of a <strong>ventricular septal defect </strong>(VSD). The presence of <strong>Eisenmenger syndrome</strong> is a contraindication for surgery.&nbsp;</p>\n<div class=\"page\" title=\"Page 420\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Ventricular septal defects</strong> are the most common congenital heart lesions. 90% are located in the <strong>membranous part</strong> of the septum with variable extension into the muscular part.&nbsp;</p>\n<p>Children may present at <strong>6&ndash;10 weeks of age</strong> with congestive cardiac failure, or with palpitations, exertional dyspnoea, and frequent chest infections when they are older. On examination, <strong>a loud pan systolic murmur</strong> is heard at the left sternal border with a systolic thrill. S2 may be widely split with P2 accentuation. S3 may be audible at the apex.</p>\n<p>Muscular VSDs are likely to close spontaneously.&nbsp;Medical management consists of control of cardiac failure, treatment of infections, treatment of anemia, and infective endocarditis.&nbsp;</p>\n<p>Surgery in VSD mainly <strong>helps to relieve congestive cardiac failure</strong> which manifests as a&nbsp;<strong>failure to thrive</strong> in an infant. The main aim of performing surgery in VSD is to get the symptoms of heart failure in control and to prevent the development of pulmonary vascular disease.</p>\n<div class=\"page\" title=\"Page 420\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Indications for surgical closure of a VSD:</p>\n<ul>\n<li>Large defects with clinical symptoms that cannot be controlled medically</li>\n<li>Large defects with pulmonary hypertension, controlled by medication</li>\n<li>Patients older than 2 years with a pulmonary flow of more than twice the systemic flow</li>\n<li>Patients with a supracristal VSD of any size (because of the high risk for aortic valve regurgitation)</li>\n<li>Associated pulmonary stenosis.</li>\n</ul>\n<p>Surgical treatment is not indicated in</p>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 420\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Patients with a small VSD (exception subpulmonic/supracristal VSD with aortic valve prolapse)</li>\n<li>Severe, uncontrolled pulmonary arterial hypertension with a significant right-to-left shunt (<strong>Eisenmenger syndrome</strong>)</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old lady presented with chronic pain in the lower back and knees. On physical examination, there were black pigmentary deposits on the sclera of both eyes and on the fingers and nailbeds. The urine turned black on exposure to Benedict's reagent and showed large amounts of a particular metabolite which is responsible. Identify the metabolite from the image below",
    "choices": [
      {
        "id": 1,
        "text": "2"
      },
      {
        "id": 2,
        "text": "1"
      },
      {
        "id": 3,
        "text": "4"
      },
      {
        "id": 4,
        "text": "3"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical vignette is suggestive of <strong>alkaptonuria,&nbsp;</strong>which is characterised by excretion of the metabolite&nbsp;<strong>homogentisate </strong>(marked as <strong>2&nbsp;</strong>in the flowchart)&nbsp;in urine.</p>\n<p>Alkaptonuria is an autosomal recessive disorder of <strong>tyrosine metabolism</strong>. It occurs due to a defect in <strong>homogentisate oxidase</strong>&nbsp;(which&nbsp;oxidizes homogentisate to maleylacetoacetate) leading to the <strong>accumulation of homogentisate</strong>. The&nbsp;excreted homogentisate in urine makes it appear black when it gets oxidized on exposure to air or an oxidizing agent.</p>\n<p>Accumulation of oxidized homogentisic acid pigment (benzoquinone acetate) in joints and connective tissues leads to arthritis and connective tissue pigmentation respectively. This is known as <strong>ochronosis</strong>.&nbsp;Pigmentation of heart valves, larynx, tympanic membranes, and skin, with occasional renal pigment calculi, can also be seen.</p>\n<p>Most patients are diagnosed early based on the<strong> darkening of urine</strong> with standing or the addition of alkali. Around the age of 30 years, gray-brown pigmentation of sclera and generalized darkening of the concha, anthelix and helix of the ear is seen.Some patients present in middle age with a <strong>degenerative joint disease</strong> (ochronotic arthritis) with pain, stiffness, and limitation of motion of the lower back, hips, knees, and shoulders. Small joints are usually spared.</p>\n<p>Treatment:</p>\n<div class=\"page\" title=\"Page 3065\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><strong>Symptomatic</strong> treatment with pain medications, spinal surgery, and arthroplasty&nbsp;</li>\n<li>Ascorbic acid and protein restriction&nbsp;</li>\n<li><strong>Nitisinone</strong> - reduces urinary excretion of homogentisic acid and delays progression of the disease.</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e9bc394fe9e74628864dabf89d358f30.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0fe5b17563d94403887314b8c37e2099x1280x2566.3187588152327.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/69bb0d10ce66436eb0e4e36807c443aex408x267.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/114c954855d74f0cbc4ab61cf0d8073fx972x1198.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/94e733d3439e40659d77dd54cc40ce9dx512x358.PNG"
    ]
  },
  {
    "text": "A 45-year-old lady presented to the outpatient department with complaints of burning pain and altered sensation in her right hand. She mentions that the pain worsens at night and in order to relieve it, she sleeps with her arm hanging over the side of the bed. On examination, symptoms are reproduced when the patient presses her wrists against each other in flexion for 60 seconds, and when direct pressure is applied for 30 seconds on the point shown in the image. Identify the other features that can be present as the condition progresses.",
    "choices": [
      {
        "id": 1,
        "text": "Weakness of thumb abduction"
      },
      {
        "id": 2,
        "text": "Inability to perform the 'OK sign'"
      },
      {
        "id": 3,
        "text": "Tingling on resisted elbow flexion"
      },
      {
        "id": 4,
        "text": "Tingling on resisted flexion of middle proximal interphalangeal joint"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario with pain and abnormal sensations in the hand, along with positive Phalen's test and Durkan's test suggest <strong>Carpal tunnel syndrome</strong>.\u00a0In late cases, there can be\u00a0<strong>weakness of thumb abduction.</strong>\u00a0</p>\n<p>Carpal tunnel syndrome(CTS) is a\u00a0condition in which the <strong>median nerve</strong> gets entrapped in the carpal tunnel. Patients present with burning pain and paresthesia of the first three digits, and the radial half of the fourth digit. The symptoms are worse at night and are relieved by shaking the arm or hanging it by the side of the bed. It may progress to weakness and clumsiness of the hand.</p>\n<p>Tests for CTS -</p>\n<ul>\n<li><strong>Durkan's test</strong> is the most <strong>specific</strong> test for the diagnosis of carpal tunnel syndrome. In Durkan's test, direct median nerve compression elicits paresthesias and pain.</li>\n<li><strong>Phalen's test</strong> - Elicited by holding the wrist flexed fully. The appearance of sensory symptoms within 60 seconds implies a positive test.</li>\n<li><strong>Tinel's sign</strong> - Sensory symptoms reproduced by percussing over the median nerve implies a positive test.</li>\n</ul>\n<p>In advanced cases, there is wasting of the thenar muscles, weakness of thumb abduction and decreased sensations in the median nerve territory.</p>\n<p>The diagnosis of carpal tunnel syndrome is usually clinical. Nerve conduction studies are done to confirm the diagnosis in case of atypical presentation of carpal tunnel syndrome.</p>\n<p>In cases of mild clinical symptoms, <strong>splinting</strong> or <strong>glucocorticoid injections</strong> may be first tried. Surgical division of the transverse carpal ligament is recommended for severe CTS or if non-surgical management fails.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c9d1731f2ca2474cb4629ed1b1151c5b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fff1b6e76f6f4388a7569e7456d76feex1280x1146.4033850493654.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0b6337d8e78d4a0d94068f550e549fc0x1279x1308.JPEG"
    ]
  },
  {
    "text": "A 22-year old man was admitted with complaints of recurrent abdominal pain, bloating, and vomiting. On examination, there was fullness in the epigastrium and hyper peristaltic bowel sounds. The upper GI barium study showed a dilated stomach and second part of the duodenum, with the third part of the duodenum cut off. There were no intrinsic mucosal abnormalities.  Intra-operatively,  it was seen that the third part of the duodenum was compressed between two blood vessels. Identify the vessels responsible for this condition from the image below.",
    "choices": [
      {
        "id": 1,
        "text": "A and B"
      },
      {
        "id": 2,
        "text": "B and D"
      },
      {
        "id": 3,
        "text": "C and D"
      },
      {
        "id": 4,
        "text": "C and E"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical vignette with intraoperative findings is suggestive of <strong>Superior mesenteric artery syndrome</strong>, where the third part of the duodenum gets compressed between the <strong>superior mesenteric artery</strong> (marked as <strong>B</strong>) and the <strong>abdominal aorta </strong>(marked as<strong> D</strong>).</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3a378cd046e848538ea580c18c70c089.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/afda40b1124e4e6e957ed96fc615a0e8x1280x1015.5148095909732.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9c9be90771c54ede9f39c22526700b69x485x290.JPEG"
    ]
  },
  {
    "text": "A child aged 10 years presented with perianal pruritus which is worse in night. Routine stool examination didn't reveal parasite cysts or eggs. The following examination is done to recover eggs which are non-bile stained. Identify the organism causing the infection.",
    "choices": [
      {
        "id": 1,
        "text": "Hookworm"
      },
      {
        "id": 2,
        "text": "Whipworm"
      },
      {
        "id": 3,
        "text": "Pinworm"
      },
      {
        "id": 4,
        "text": "Roundworm"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario and the image showing scotch tape method to collect perianal egg deposition by&nbsp;<strong>(Enterobius vermicularis) </strong>is&nbsp; suggestive of infestation with<strong>&nbsp;Pinworm&nbsp;</strong></p>\n<p><strong>Characteristics of&nbsp;</strong><strong>Pinworm egg:</strong></p>\n<ul>\n<li>It is colorless, non-bile stained.</li>\n<li>It&nbsp;floats in the saturated salt solution.</li>\n<li>The egg is planoconvex. Eggshell is double layered and relatively thick, though transparent.</li>\n</ul>\n<p>Since pinworms are not released in feces, the diagnosis cannot be made by conventional fecal ova and parasite tests. NIH swab method and Scotch tape method are used for the collection of specimens.</p>\n<p>Scotch tape method involves:</p>\n<ol>\n<li>Take a clear cellophane tape almost 4 cm long</li>\n<li>Hold it in such a way(or make a loop) so that sticky surface faces upwards or towards the perianal skin.</li>\n<li>Place the sticky surface of tap in the perianal area momentarily</li>\n<li>Place the sticky surface down on the glass slide. Examine under microscope.</li>\n</ol>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f34829b6aae2404ea18a3ea62cf08bda.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ede3623c572c437d8ff91e8291dbe392x435x497.GIF"
    ]
  },
  {
    "text": "Choose the correctly matched option with regard to congenital anomalies and results of the quadruple test:",
    "choices": [
      {
        "id": 1,
        "text": "1-D, 2-C, 3-B, 4-A"
      },
      {
        "id": 2,
        "text": "1-A, 2-B, 3-C, 4-D"
      },
      {
        "id": 3,
        "text": "1-B, 2-C, 3-D, 4-A"
      },
      {
        "id": 4,
        "text": "1-C, 2-D, 3-A, 4-B"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Quadruple testing is done in the <strong>second trimester between 15-21 weeks </strong>of gestation and involves the following parameters<strong>:</strong></p>\n<ul>\n<li><strong>Maternal serum alpha fetal protein(MSAFP),</strong>&nbsp;</li>\n<li><strong>&beta; hCG, </strong></li>\n<li><strong>Unconjugated estriol, </strong></li>\n<li><strong>Inhibin A.</strong></li>\n</ul>\n<p>&nbsp;</p>\n<table style=\"width: 819px;\">\n<tbody>\n<tr>\n<td style=\"width: 110px; text-align: center;\"><strong>Parameter</strong></td>\n<td style=\"width: 161px; text-align: center;\"><strong>Trisomy 21/ Downs syndrome</strong></td>\n<td style=\"width: 148px; text-align: center;\"><strong>Trisomy 18/ Edward syndrome</strong></td>\n<td style=\"width: 192px; text-align: center;\"><strong>Neural tube defect or abdominal wall defect</strong>&nbsp;</td>\n<td style=\"width: 174px; text-align: center;\"><strong>Trisomy 13/ Patau syndrome</strong></td>\n</tr>\n<tr>\n<td style=\"width: 110px; text-align: center;\"><strong>MSAFP</strong></td>\n<td style=\"width: 161px; text-align: center;\">Low</td>\n<td style=\"width: 148px; text-align: center;\">Low</td>\n<td style=\"width: 192px; text-align: center;\"><strong>High</strong></td>\n<td style=\"width: 174px; text-align: center;\">Normal</td>\n</tr>\n<tr>\n<td style=\"width: 110px; text-align: center;\"><strong>&beta; hCG</strong></td>\n<td style=\"width: 161px; text-align: center;\">High</td>\n<td style=\"width: 148px; text-align: center;\">Low</td>\n<td style=\"width: 192px; text-align: center;\">Normal</td>\n<td style=\"width: 174px; text-align: center;\">Normal</td>\n</tr>\n<tr>\n<td style=\"width: 110px; text-align: center;\"><strong>Unconjugated estriol</strong></td>\n<td style=\"width: 161px; text-align: center;\">Low</td>\n<td style=\"width: 148px; text-align: center;\">Low</td>\n<td style=\"width: 192px; text-align: center;\">Normal</td>\n<td style=\"width: 174px; text-align: center;\">Normal</td>\n</tr>\n<tr>\n<td style=\"width: 110px; text-align: center;\"><strong>Inhibin A</strong></td>\n<td style=\"width: 161px; text-align: center;\">High</td>\n<td style=\"width: 148px; text-align: center;\">Normal/Low</td>\n<td style=\"width: 192px; text-align: center;\">Normal</td>\n<td style=\"width: 174px; text-align: center;\"><strong>High</strong></td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/19575d0853c945d5829ef8a68865a3ab.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient presents to you with anhidrosis and enophthalmos. Examination reveals miosis along with mild ptosis. You decide to correct the ptosis by performing a Fasanella-Servat operation, by resecting which of the following muscles?",
    "choices": [
      {
        "id": 1,
        "text": "Levator palpebrae superioris muscle"
      },
      {
        "id": 2,
        "text": "Frontalis muscle"
      },
      {
        "id": 3,
        "text": "Superior rectus muscle"
      },
      {
        "id": 4,
        "text": "Muller's muscle"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>Horner's syndrome</strong> and the associated mild ptosis in this condition can be corrected by <strong>resecting Muller's muscle</strong>.</p>\n<p><strong>Ptosis</strong>\u00a0in Horner's syndrome is due to the paralysis of Muller's muscle.</p>\n<p><strong>Fasanella-Servat</strong>\u00a0operation\u00a0is indicated in cases having mild ptosis<strong>(&lt; 2 mm)\u00a0</strong>and good levator function. In this surgery, the upper\u00a0tarsal border along with its attached Muller\u2019s muscle and conjunctiva are resected.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old woman comes to the OPD with a history of a lump in the left breast. On clinical examination, the size of the lump in the left breast is 9\u00d710 cm with the following appearance and no axillary lymphadenopathy. The histopathology of the biopsy from the lump shows increased stromal cellularity and typical leaflike architecture. What is your likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cystosarcoma phyllodes"
      },
      {
        "id": 2,
        "text": "Giant fibroadenoma"
      },
      {
        "id": 3,
        "text": "Inflammatory carcinoma"
      },
      {
        "id": 4,
        "text": "Ductal carcinoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario and the image is suggestive of <strong>Phyllodes tumor or&nbsp;cystosarcoma phyllodes</strong>&nbsp;of the breast.</p>\n<p><strong>Phyllodes tumor,</strong>&nbsp;also known as&nbsp;cystosarcoma phyllodes,&nbsp;presents as a large tumor with an unevenly bosselated surface.&nbsp;This tumor <strong>does not infiltrate</strong> the skin though the overlying skin becomes thin and tense due to swelling. Nipple retraction is not seen in this condition.</p>\n<p>The histopathology of the biopsy of the lump shows&nbsp;<strong>increased stromal cellularity</strong>, overgrowth, and&nbsp;<strong>typical leaflike architecture</strong>&nbsp;which is suggestive of a&nbsp;<strong>phyllodes tumor</strong>. Axillary dissection is not done if malignant transformation occurs because the&nbsp;<strong>lymphatic spread is rare.</strong></p>\n<p>Phyllodes tumors usually occur in&nbsp;<strong>women</strong>&nbsp;<strong>over the age of 40 years</strong>&nbsp;but can appear in younger women. Phyllodes tumor is mostly benign even though it is also called&nbsp;<strong>cystosarcoma phyllodes or as serocystic disease of Brodie</strong>. They are usually&nbsp;<strong>mobile over the chest wall</strong>&nbsp;despite their large size.&nbsp;<strong>Histologically, there is a wide variation</strong>&nbsp;with some of the low malignant potential and others having a higher mitotic index.</p>\n<p>Treatment of phyllodes tumor:</p>\n<ul>\n<li>Benign type- Enucleation or wide local excision</li>\n<li>Massive tumors, recurrent tumors, and malignant type- Mastectomy</li>\n</ul>\n<p>The histopathology of the biopsy of the lump shows <strong>increased stromal cellularity</strong>, overgrowth, and <strong>typical leaflike architecture</strong> which is suggestive of a&nbsp;<strong>phyllodes tumor.</strong></p>\n<p class=\"p1\">&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2d97c469e91a441db2f4e86408c31320.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da9bbfec7a71455190ff7acc15d6b910x720x480.JPEG"
    ]
  },
  {
    "text": "A patient presents to you with palpitations and a heart rate of 150/minute. An ECG is done which is shown below. If the blood pressure is normal, what is the next best step in the management of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Perform emergency electrical cardioversion"
      },
      {
        "id": 2,
        "text": "Start therapeutic IV heparin"
      },
      {
        "id": 3,
        "text": "Administer IV beta-blocker"
      },
      {
        "id": 4,
        "text": "Administer IV dihydropyridine calcium channel blocker"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The ECG showing <strong>sawtooth flutter waves</strong> along with the clinical scenario suggests a diagnosis of <strong>atrial flutter</strong>. The next best step is to administer an <strong>intravenous (IV) beta-blocker</strong> for<strong> rate control</strong> as the patient is <strong>hemodynamically stable.</strong></p>\n<p>The initial management of atrial flutter targets rate control through IV atrioventricular (AV) nodal blocking agents. These include <strong>beta-blockers</strong> or <strong>non-dihydropyridine calcium channel blockers (CCB)</strong> such as <strong>verapamil</strong> and <strong>diltiazem</strong>. Intravenous <strong>ibutilide</strong>, a class III antiarrhythmic agent can be used for <strong>rhythm control</strong>.</p>\n<p>If the patient presents with severe symptoms or is hemodynamically unstable, <strong>electrical cardioversion</strong> is the first step.\u00a0If the episode <strong>duration is &gt; 48 hours</strong>,\u00a0or\u00a0if the patient has an increased risk of <strong>thromboembolic stroke</strong> based on the\u00a0<strong>CHAD2DS2 -VASc\u00a0</strong>scoring\u00a0system, <strong>anticoagulation</strong>\u00a0must be provided before the cardioversion. The drugs which can be used are<strong> direct oral anticoagulants</strong> (DOAC) such as <strong>apixaban</strong>, edoxaban, and <strong>rivaroxaban</strong>. <strong>Dabigatran</strong>, an antithrombin inhibitor, and <strong>warfarin</strong>, a vitamin K antagonist can also be used.\u00a0</p>\n<p>The first episode does not warrant the continuation of antiarrhythmic drugs after conversion to sinus rhythm. In recurrent episodes, sotalol or amiodarone may be used.</p>\n<p>At least 4 weeks of <strong>anticoagulation therapy</strong> is carried out after electrical or chemical cardioversion, as done in atrial fibrillation. Patients with risk factors for thromboembolism should continue it for longer. The definitive treatment is <strong>catheter ablation\u00a0</strong>for recurrent cases.</p>\n<p>The ECG shows characteristic sawtooth flutter waves due to the atrial activity in the inferior leads ( leads II, III, and aVF). Positive P waves are seen in lead V1. Conduction of more than 230 impulses/ minute through the AV node is not possible in adults. Hence a <strong>2:1</strong> or<strong> greater AV block</strong> is almost always associated. So patients present with tachycardia of <strong>130-150 beats/minute.\u00a0</strong>Typically, the\u00a0atrial rate\u00a0is around\u00a0<strong>240-300/minute</strong>.</p>\n<p>Atrial flutter is more commonly seen in patients with <strong>chronic obstructive pulmonary disease</strong> or structural heart disease. Symptoms include <strong>palpitations</strong>, dizziness, and fatigue.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7ba62333813b432f96db17aacf04e2a8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The type of laryngoscope blade shown in the given image is:",
    "choices": [
      {
        "id": 1,
        "text": "Miller laryngoscope blade"
      },
      {
        "id": 2,
        "text": "Magill laryngoscope blade"
      },
      {
        "id": 3,
        "text": "Macintosh laryngoscope blade"
      },
      {
        "id": 4,
        "text": "McCoy laryngoscope blade"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows a Miller laryngoscopic blade.\u00a0</p>\n<p>A laryngoscope is an instrument used for examination of the larynx and facilitation of tracheal intubation. It has three components: the handle, the blade, and the light source. The Macintosh and Miller blades are the most popularly used blades.</p>\n<p><strong>Miller's </strong>blade\u00a0is a\u00a0<strong>straight blade</strong>. Its curve begins 2 inches from the tip. It is inserted using the para-glossal technique. This technique avoids contact with the maxillary incisors and provides\u00a0maximal tongue control.</p>\n<p>It is used in:</p>\n<ul>\n<li>Neonates, infants, and young children</li>\n<li>Adults with short thyromental distance and long floppy epiglottis.</li>\n</ul>\n<div class=\"page\" title=\"Page 552\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Macintosh</strong> blade is a sharply <strong>curved</strong> blade with a large flange. It is inserted in the right side of the mouth, and the flange is used to sweep the tongue to the left. The blade is advanced and positioned in the vallecula. Advantages of a curved blade include:</p>\n</div>\n</div>\n</div>\n<ul>\n<li>Greater room available for the passage for an endotracheal tube</li>\n<li>Less damage to the teeth</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/536ce741692e4563a4ae137f13a08d0f.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/94f7e038c4754c97b5e546a52508b556x1024x700.jpeg"
    ]
  },
  {
    "text": "A 30-year-old female presents to dermatology OPD with the given condition. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Systemic lupus erythematosus"
      },
      {
        "id": 2,
        "text": "Melasma"
      },
      {
        "id": 3,
        "text": "Chloasma"
      },
      {
        "id": 4,
        "text": "Rosacea"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image showing hyperpigmented macules on the face is diagnostic of <strong>melasma.</strong></p>\n<p>Melasma is the most common cause of facial melanosis and is manifested by hyperpigmented macules on the face which become more pronounced after sun exposure.</p>\n<p>Hyper-melanosis affects mainly the upper lip, the malar regions, forehead, chin and mandible region.&nbsp;</p>\n<p>Melasma is more common in <strong>women </strong>(90%) and in ages between <strong>20-40 years</strong>.&nbsp;It is frequently seen in <strong>women on oral contraceptives.</strong></p>\n<p>Melasma is more <strong>chronic</strong> and requires treatment with <strong>depigmenting agents</strong> like:</p>\n<ul>\n<li>Hydroquinone (reduces tyrosinase activity)</li>\n<li>Kojic acid (tyrosinase inhibitor)</li>\n<li>Chemical peels</li>\n<li><strong>Kligman's triple combination</strong>- Topical hydroquinone + tretinoin + corticosteroid compound cream [First line]</li>\n</ul>\n<p>Other Options:</p>\n<p>Option A:&nbsp;Systemic lupus erythematosus is characterised by a well-demarcated erythematous <strong>butterfly rash</strong> over the malar eminences with <strong>sparing of the nasolabial folds</strong>.</p>\n<p>Option C: The&nbsp;<strong>same </strong>facial melanosis in <strong>pregnant </strong>women is called <strong>Chloasma </strong>or <strong>mask of pregnancy</strong>. Only the terms used differ. Chloasma is very common in the 3rd trimester of pregnancy. Chloasma usually resolves after pregnancy.</p>\n<p>Option D:&nbsp;<strong>Rosacea</strong>&nbsp;mainly involves the<strong> convexities of the face</strong> and presents as erythemato-telangiectatic type over the cheeks.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bc068d24d34947af82481e35d37a66c3.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Ini-Cet  Mini - 10 (20 Q)';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>