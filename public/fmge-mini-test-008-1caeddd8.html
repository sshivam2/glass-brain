<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 008 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Boundaries of Calot triangle are formed by all except:",
    "choices": [
      {
        "id": 1,
        "text": "Common hepatic duct"
      },
      {
        "id": 2,
        "text": "Cystic duct"
      },
      {
        "id": 3,
        "text": "Cystic artery"
      },
      {
        "id": 4,
        "text": "Gall bladder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Boundaries of the Calot&rsquo;s triangle&nbsp;is <strong>not formed</strong> by the&nbsp;<strong>gall bladder</strong>.</p>\n<p><strong>Calot's</strong> <strong>triangle </strong>is formed by<strong> 3C</strong>'s<strong>:</strong></p>\n<ul>\n<li>Medially&nbsp;&ndash; <strong>C</strong>ommon hepatic duct</li>\n<li>Inferiorly &ndash; <strong>C</strong>ystic duct</li>\n<li>Superior &ndash; <strong>C</strong>ystic artery&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Following complete ileal and partial jejunal resection, the patient is most likely to have",
    "choices": [
      {
        "id": 1,
        "text": "Folic acid deficiency"
      },
      {
        "id": 2,
        "text": "Vitamin B12 deficiency"
      },
      {
        "id": 3,
        "text": "Gastric ulcer"
      },
      {
        "id": 4,
        "text": "Constipation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>After complete ileal and partial jejunal resection, the patient is likely to have <strong>vitamin B12 deficiency.</strong></p>\n<p>Vitamin B12 is absorbed in the ileum. Vitamin B12 binds to intrinsic factor, a protein secreted by the parietal cells of the stomach, and the complex is absorbed across the ileal mucosa. Hence after ileal resection, there is impaired absorption of vitamin B12.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 4-year-old child presents with hyperuricemia and delayed developmental milestones. He also has the habit of biting his lips, fingers, and feet because of which he is always strapped to the bed. Urine examined showed orange sands. Which is the most probable enzyme deficiency?",
    "choices": [
      {
        "id": 1,
        "text": "Adenine phosphoribosyltransferase"
      },
      {
        "id": 2,
        "text": "Hypoxanthine-guanine phosphoribosyltransferase"
      },
      {
        "id": 3,
        "text": "Adenosine Deaminase"
      },
      {
        "id": 4,
        "text": "Purine nucleoside phosphorylase"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is highly suggestive of <strong>Lesch-Nyhan syndrome</strong>. It is caused due to the <strong>complete&nbsp;</strong>deficiency of<strong> Hypoxanthine-guanine phosphoribosyltransferase (HGPRT).</strong></p>\n<p><strong>Lesch-Nyhan syndrome</strong>&nbsp;is an X-linked recessive disorder. This deficiency results in an <strong>inability to salvage</strong> hypoxanthine or guanine, from which excessive amounts of<strong> uric acid </strong>is produced and excreted in urine as<strong> orange sands.</strong></p>\n<p>Clinical features include <strong>compulsive self-mutilation</strong>, <strong>hyperuricemia</strong>, intellectual disability, delayed milestones, dystonic movements and megaloblastic anemia.</p>\n<p>Diagnosis is made by deficient HGPRTase enzyme activity in the erythrocyte. <strong>Partial deficiency</strong> of HGPRTase cause <strong>Kelley-Seegmiller syndrome.</strong></p>\n<p>Option 1)&nbsp;Adenine phosphoribosyltransferase<strong>&nbsp;</strong>enzyme deficiency causes urinary <strong>calculus formation with crystalluria.</strong></p>\n<p>Option 3) Adenosine deaminase&nbsp;enzyme deficiency is one of the &nbsp;2nd major cause of <strong>SCID.</strong></p>\n<p>Option 4) Purine nucleoside phosphorylase&nbsp;causes<strong>&nbsp;a severe deficiency of T cells</strong> but B cells are normal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old HIV seropositive male presents with raised violaceous plaques over the distal portion of the lower limbs. Biopsy shows a lesion composed of proliferating spindle cells along with small vessels and spaces containing red cells. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cavernous hemangioma"
      },
      {
        "id": 2,
        "text": "Kaposi sarcoma"
      },
      {
        "id": 3,
        "text": "Dermatofibroma"
      },
      {
        "id": 4,
        "text": "Mycosis fungoides"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario and the histopathological findings are most suggestive of <strong>Kaposi sarcoma</strong>.</p>\n<p><strong>Kaposi sarcoma </strong>is a vascular neoplasm caused by<strong> human herpesvirus 8 </strong>(HHV8) and is <strong>highly associated with AIDS</strong> (acquired immunodeficiency syndrome).</p>\n<p><strong>Classic Kaposi sarcoma</strong> occurs in<strong>&nbsp;older men&nbsp;of </strong>Eastern European and Meditteranean descent and has the following three clinical stages:</p>\n<ul>\n<li><strong>Patches</strong>- red-purple macules on the distal lower extremities</li>\n<li><strong><strong>Plaques-&nbsp;</strong></strong>patches progress to large violaceous raised plaques. Lesions spread proximally.</li>\n<li><strong>Nodules- </strong>Lesions become nodular with more neoplastic features. This stage also progresses to involve nodes and viscera.</li>\n</ul>\n<p>The given images show coalescent red-purple macules and plaques of the skin and the histologic appearance of Kaposi sarcoma, demonstrating sheets of proliferating spindle cells:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/85daf75865344e4cae4f35186252c544x1012x675.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/985d8f3002fd466cbcf4c1e6182199f2x1280x880.JPEG"
    ]
  },
  {
    "text": "A 15-year-old boy presented with fever and chills for the last 3 days. A peripheral blood smear revealed the following. Which of the following is the most probable causative agent?",
    "choices": [
      {
        "id": 1,
        "text": "Plasmodium vivax"
      },
      {
        "id": 2,
        "text": "Plasmodium falciparum"
      },
      {
        "id": 3,
        "text": "Plasmodium malariae"
      },
      {
        "id": 4,
        "text": "Plasmodium ovale"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario and the peripheral smear showing the Maurer's dots are suggestive of <strong>malaria</strong> caused by&nbsp;<strong>Plasmodium falciparum.</strong></p>\n<p>Features of Plasmodium falciparum on peripheral smear are Maurer&rsquo;s dots,&nbsp;ring form,&nbsp;accole form,&nbsp;and&nbsp;banana-shaped gametocytes.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9827ac94e48f41979f67893471e7c4d6.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Apparent volume of distribution of a drug is very high (6L/kg). Which of the following is true regarding the distribution of that drug?",
    "choices": [
      {
        "id": 1,
        "text": "Highly bound to plasma proteins"
      },
      {
        "id": 2,
        "text": "Confined to vascular compartment"
      },
      {
        "id": 3,
        "text": "Sequestered in body tissues"
      },
      {
        "id": 4,
        "text": "Both A and B"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>If the volume of distribution exceeds total body fluid volume, then the drug has<strong> distribution in extravascular tissues</strong>.</p>\n<p>In the present case, the volume of distribution of the drug is 6L/kg (420 L in a normal adult with reference weight 70kg) that is very high when compared to the normal blood volume of 5 liters. Therefore, it can be implied that the drug is having<strong> high sequestration in tissues</strong>.</p>\n<p>The apparent volume of distribution <strong>(Vd) = dose administered I.V/ plasma concentration</strong></p>\n<p>A high aVd is due to the accumulation of a drug in extravascular tissues resulting in low plasma concentration.&nbsp;</p>\n<p>A <strong>high plasma protein binding</strong> usually results in the <strong>low volume of distribution</strong> which approximates around blood volume. (Option A)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While doing the hydrostatic test, an unrespired lung may float due to:",
    "choices": [
      {
        "id": 1,
        "text": "Lung edema"
      },
      {
        "id": 2,
        "text": "Lung collapse"
      },
      {
        "id": 3,
        "text": "Putrefaction"
      },
      {
        "id": 4,
        "text": "Congenital syphilis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>An unrespired lung (still birth) may float due to gases of decomposition, as seen in <strong>putrefaction</strong>.</p>\n<p>Hydrostatic test is done to determine whether the newborn has respired or not. It is also known as&nbsp;Floatation test/ Breslau&rsquo;s first life test/ Raygat&rsquo;s test.</p>\n<p>If the lung pieces float in water, it means that respiration has taken place, indicating a live birth.</p>\n<p>If the pieces sink, respiration has not taken place, which means it is a stillborn.</p>\n<p>A respired lung (live birth) may sink in water in the following conditions :</p>\n<ul>\n<li>Lung edema</li>\n<li>Lung collapse</li>\n<li>Pneumonia</li>\n<li>Congenital syphilis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the condition.",
    "choices": [
      {
        "id": 1,
        "text": "Cauliflower ear"
      },
      {
        "id": 2,
        "text": "Perichondritis"
      },
      {
        "id": 3,
        "text": "Chondrodermatitis chronica helicis"
      },
      {
        "id": 4,
        "text": "Otitis externa"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Image shown above is <strong>Perichondritis.</strong></p>\n<ul>\n<li><strong>MC cause is trauma</strong> either iatrogenic (surgical incision) or non iatrogenic (laceration, haematoma). It can be due to <strong>extension of infection</strong> from diffuse otitis externa or furuncle of meatus.</li>\n<li><strong>MC organism &ndash; </strong><em>Pseudomonas aeruginosa</em>.</li>\n<li>Pinna is <strong>red, hot, painful and stiff</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4167288405004197bee57bb7e74871a4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bd0e2622d6c64014a1a27c12dce6b06ax450x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c1e06ec75dc342c9bc75ab6388987b42x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/561f50a0c2204200a4ecc36e5e7022cax1024x768.JPEG"
    ]
  },
  {
    "text": "The cherry red spot seen in the image below is seen in _______.",
    "choices": [
      {
        "id": 1,
        "text": "Central retinal artery occlusion (CRAO)"
      },
      {
        "id": 2,
        "text": "Central retinal venous occlusion (CRVO)"
      },
      {
        "id": 3,
        "text": "Branched retinal artery occlusion (BRAO)"
      },
      {
        "id": 4,
        "text": "Branched  retinal vein  occlusion (BRVO)"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image&nbsp;shows a&nbsp;<strong>cherry-red spot,</strong> which is a feature of <strong>central retinal artery occlusion (CRAO).</strong></p>\n<p><strong>Pathophysiology of the&nbsp;cherry-red spot:</strong></p>\n<p>A cherry-red spot of the macula is typical and arises in this area because of the absence of ganglion cells at the foveola resulting in the transmission of the normal choroidal color. This in contrast to the surrounding area where intense retinal whitening blocks the transmission of the normal choroidal color.</p>\n<p>Risk factors of CRAO:</p>\n<ul>\n<li>Heart disease</li>\n<li>Carotid artery disease</li>\n<li>Mucormycosis</li>\n<li>Trauma</li>\n</ul>\n<p>Clinical features of CRAO:</p>\n<ul>\n<li><strong>Sudden painless loss of vision</strong></li>\n<li>Severe edema: The whole <strong>retina</strong> looks <strong>white</strong> in color.</li>\n<li>Marked attenuation of arteries: <strong>thread-like arteries</strong></li>\n<li><strong>Interrupted blood flow in the artery and veins: cattle-track appearance</strong></li>\n<li><strong>Cherry-red spot</strong></li>\n<li><strong>Hollenhorst plaques -&nbsp;cholesterol emboli&nbsp;seen in retinal arterioles.</strong></li>\n</ul>\n<p><strong>Treatment</strong> is to <strong>dislodge</strong> the <strong>emboli </strong>by <strong>suddenly decreasing</strong> the intraocular pressure <strong>(IOP)</strong> by intravenous mannitol&nbsp;or <strong>ocular massage</strong>.<strong>&nbsp;</strong>The<strong> time</strong> limit is only <strong>4 to 6 hours</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9d7ebd22671540e48111ff9b16bc704d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following gives the approximate magnitude of completed family size?",
    "choices": [
      {
        "id": 1,
        "text": "General fertility rate"
      },
      {
        "id": 2,
        "text": "Total fertility rate"
      },
      {
        "id": 3,
        "text": "Gross reproduction rate"
      },
      {
        "id": 4,
        "text": "Net reproduction rate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Total fertility</strong> rate gives the approximate magnitude of completed family size.</p>\n<p><strong>Total Fertility Rate</strong></p>\n<ul>\n<li>It represents the average number of children a woman would have if she were to pass through her reproductive years bearing children at the same rates as the women in each age group now.</li>\n<li>It is the&nbsp;<strong>sum of all age specific fertility rates multiplied by 5.</strong></li>\n<li>This measure gives the&nbsp;<strong>approximate magnitude of completed family size</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Endoscopes are sterilized by ______",
    "choices": [
      {
        "id": 1,
        "text": "Hypochlorite"
      },
      {
        "id": 2,
        "text": "Glutaraldehyde"
      },
      {
        "id": 3,
        "text": "Formaldehyde"
      },
      {
        "id": 4,
        "text": "Chlorhexidine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li><strong>2% glutaraldehyde </strong>is commonly used to disinfect and sterilize endoscopes, which includes <strong>fibreoptic scopes</strong>.</li>\n<li>Another aldehyde used in disinfection is <strong>formaldehyde</strong>.</li>\n<li>Aldehydes in 2% solutions achieve <strong>sporicidal activities.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following steps of disaster management is in correct order?",
    "choices": [
      {
        "id": 1,
        "text": "Disaster impact \u2013 Mitigation \u2013 Rehabilitation \u2013 Response"
      },
      {
        "id": 2,
        "text": "Rehabilitation \u2013 Response \u2013 Disaster Impact \u2013 Mitigation"
      },
      {
        "id": 3,
        "text": "Disaster impact \u2013 Response \u2013 Rehabilitation \u2013 Mitigation"
      },
      {
        "id": 4,
        "text": "Response \u2013 Disaster impact \u2013 Rehabilitation \u2013 Mitigation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Disaster Management includes three aspects:</p>\n<p><strong>1. Disaster impact and response:</strong>&nbsp;</p>\n<p>&nbsp;&nbsp;Involves immediate management of mass casualties</p>\n<ul>\n<li>Search, rescue, and first-aid</li>\n<li>Field care</li>\n<li>Triage</li>\n<li>Tagging</li>\n<li>Identification of dead</li>\n</ul>\n<p><strong>2. Rehabilitation or recovery:</strong></p>\n<p><strong>&nbsp; &nbsp;</strong>Involves restoration of the pre-disaster conditions</p>\n<ul>\n<li>Water supply</li>\n<li>Basic sanitation and personal hygiene</li>\n<li>Food safety</li>\n<li>Vector control</li>\n</ul>\n<p><strong>3. Mitigation</strong>: Measures designed either to&nbsp;<strong>prevent hazards&nbsp;</strong>from causing disaster&nbsp;or to reduce the effects of the disaster. This also includes<strong>&nbsp;preparedness&nbsp;</strong>for any impending disasters or in disaster-prone areas.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/941cdb2b237749b8991ab1862d290506x421x391.JPEG"
    ]
  },
  {
    "text": "A 15-year-old girl presented with fatigue, chronic diarrhea,  steatorrhea, weight loss, bone pain, and abdominal distension.  Investigations revealed iron deficiency anemia and osteoporosis. Which of the following is the single best test to be done for her evaluation?",
    "choices": [
      {
        "id": 1,
        "text": "TSH levels"
      },
      {
        "id": 2,
        "text": "C-peptide levels"
      },
      {
        "id": 3,
        "text": "Urine sugar and ketone"
      },
      {
        "id": 4,
        "text": "IgA tissue transglutaminase antibody"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical features are suggestive of <strong>celiac disease,</strong> and the single best investigation to diagnose the condition is&nbsp;<strong>IgA tissue trans-glutaminase antibodies.</strong></p>\n<p><strong>Celiac disease </strong>is a disorder characterized by an immunological response to gluten causing damage to the proximal intestinal mucosa, and malabsorption of nutrients.&nbsp;</p>\n<p>The typical symptoms include <strong>weight loss, chronic diarrhea,&nbsp;steatorrhea, abdominal distension,</strong> and <strong>growth retardation.</strong> The malabsorption of nutrients may cause the following conditions:</p>\n<ul>\n<li><strong>Iron-deficiency anemia</strong></li>\n<li>Bruising due to <strong>vitamin K deficiency</strong></li>\n<li>Bone pain due to <strong>osteomalacia</strong></li>\n<li>Hyperkeratosis due to <strong>vitamin A deficiency</strong></li>\n<li>Neurological signs like peripheral neuropathy and ataxia due to <strong>vitamin B12 deficiency</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 43-year-old obese man presents with loud chronic snoring and gasping episodes during sleep along with excessive daytime sleepiness. He is diagnosed with obstructive sleep apnea. Which of the following would be the ideal therapy for his symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Supplemental oxygenation therapy"
      },
      {
        "id": 2,
        "text": "Uvulopalatopharyngoplasty"
      },
      {
        "id": 3,
        "text": "Continuous positive airway pressure therapy (CPAP)"
      },
      {
        "id": 4,
        "text": "Implantable neuro-stimulation of the hypoglossal nerve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario suggests a diagnosis of <strong>obstructive sleep apnea/hypopnea syndrome (OSAHS)</strong>. The ideal therapy is <strong>continuous positive airway pressure therapy (CPAP).</strong></p>\n<p>Uvulopalatopharyngoplasty is the most common surgery done in OSAHS but it is reserved for patients who cannot tolerate CPAP.</p>\n<p>Supplemental oxygenation can improve oxygen saturation but there is little evidence that it improves OSAHS symptoms.</p>\n<p>Unilateral neuro-stimulation of the hypoglossal nerve through a surgically implanted device is a recently tested therapy for OSAHS. It can be used as an alternative in selected patients who cannot tolerate CPAP.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A worker from the cement industry got a chest X-ray as a part of his routine health check-up. What could cause the findings in the given chest X-ray?",
    "choices": [
      {
        "id": 1,
        "text": "Berylliosis"
      },
      {
        "id": 2,
        "text": "Tuberculosis"
      },
      {
        "id": 3,
        "text": "Asbestosis"
      },
      {
        "id": 4,
        "text": "Silicosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"margin: 0cm 0cm 7.5pt 0cm;\"><span style=\"font-size: 10.5pt; font-family: 'Source Sans Pro',sans-serif;\">Asbestosis could cause the findings in the given chest X-ray.</span></p>\n<p style=\"margin: 0cm 0cm 7.5pt 0cm;\"><span style=\"font-size: 10.5pt; font-family: 'Source Sans Pro',sans-serif;\">The given X-ray shows irregular opacities, which appear to be <strong>pleural thickenings i.e., pleural plaques</strong>. The sign along with a history of working in the <strong>cement</strong> <strong>industry </strong>suggests a diagnosis of&nbsp;<strong><span style=\"font-family: 'Source Sans Pro',sans-serif;\">asbestosis</span></strong>. It predominantly affects the<strong> lower lobes </strong>of the lung, in contrast to other forms of pneumoconiosis, which affect the upper lobes.&nbsp;</span></p>\n<p style=\"margin: 0cm 0cm 7.5pt 0cm;\"><span style=\"font-size: 10.5pt; font-family: 'Source Sans Pro',sans-serif;\">Workers of the&nbsp;<strong><span style=\"font-family: 'Source Sans Pro',sans-serif;\">cement, shipping, and textile</span></strong>&nbsp;industries are at a higher risk of developing asbestosis. Asbestos tends to involve the pleura first.&nbsp;The earliest manifestation is benign asbestosis related pleural effusion. With time, the plaques are calcified resulting in the formation of thick pleural plaques. The pleural thickenings can be seen on the X-ray. This is the &ldquo;<strong><span style=\"font-family: 'Source Sans Pro',sans-serif;\">holly leaf sign</span></strong>&rdquo;.</span></p>\n<p style=\"margin: 0cm 0cm 7.5pt 0cm;\"><span style=\"font-size: 10.5pt; font-family: 'Source Sans Pro',sans-serif;\">Lung parenchymal involvement occurs after years of exposure (at least 10 years). They present with cough and exertional dyspnoea. Pulmonary function testing in asbestosis typically shows a&nbsp;<strong><span style=\"font-family: 'Source Sans Pro',sans-serif;\">restrictive pattern</span></strong>&nbsp;with a decrease in both lung volumes and diffusing capacity.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a8b5b5c363084a89ad6265326b1006e8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 38-year-old female presents with a history of fever and cough since 3 days and hemoptysis since 1 day. She has no other comorbid illnesses. On examination, pulse rate is 96 bpm, BP is 118/70 mmHg, temperature is 100.4 degree F, RR is 15/min and SpO2 is 96%. CT scan shows localised ground-glass opacity in the left posterior lobe of the lung. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Tuberculosis"
      },
      {
        "id": 2,
        "text": "Necrotising pneumonia"
      },
      {
        "id": 3,
        "text": "COVID-19"
      },
      {
        "id": 4,
        "text": "Invasive aspergillosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given patient is suffering from COVID-19.</p>\n<p><strong>Hemoptysis</strong> is one of the atypical manifestations of COVID-19. It may be present with more common features such as <strong>fever and cough.</strong> CT-finding of <strong>localized ground-glass opacity</strong> is also supportive of the diagnosis.</p>\n<p>Other <strong>atypical manifestations</strong> of COVID-19 include:</p>\n<ul>\n<li style=\"font-weight: 400;\">Pulmonary embolism</li>\n<li style=\"font-weight: 400;\">Cardiac: <strong>Myocardial infarction</strong>, myocarditis, pericarditis, and pericardial effusion</li>\n<li style=\"font-weight: 400;\">Neurological: Stroke, Guillain\u2010Barre Syndrome, viral encephalitis, toxic encephalopathy, acute hemorrhagic necrotizing encephalopathy, olfactory and taste disorders</li>\n<li style=\"font-weight: 400;\">Gastrointestinal: Diarrhea, nausea, vomiting and abdominal pain</li>\n<li style=\"font-weight: 400;\">Ocular: conjunctivitis, epiphora</li>\n<li style=\"font-weight: 400;\">Cutaneous: erythematous rash, widespread urticaria, chickenpox\u2010like vesicles, localized pruritic lesions, and petechial skin rash</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Mrs. Latha presents to the clinic at 12 weeks of gestational age with a history of a lump in her right breast for the past 2 months. On examination, you find a lump of 2 X 1 cm in the upper outer quadrant of her right breast. Which of the following investigations would you initially advise her for the assessment of the breast lump?",
    "choices": [
      {
        "id": 1,
        "text": "Mammography"
      },
      {
        "id": 2,
        "text": "Ultrasonography"
      },
      {
        "id": 3,
        "text": "MRI"
      },
      {
        "id": 4,
        "text": "Fine needle aspiration cytology"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Ultrasonography </strong>(USG) is the preferred initial investigation in <strong>pregnant </strong>women who present with a\u00a0breast lump<strong>. </strong>It can differentiate between solid and cystic lesions of the breast and is able to detect abnormal axillary lymph nodes.</p>\n<p>USG is preferred in <strong>pregnant women</strong>, <strong>lactating women</strong>, and <strong>young women</strong>\u00a0(less than 40 years) since breast tissue is dense in these populations.</p>\n<p>Other options:</p>\n<p><strong>Option A- Mammography</strong> is less useful in pregnant women due to the increased density of breast tissue.</p>\n<p><strong>Option C- MRI</strong>\u00a0is not the initial investigation used for the assessment of breast lumps. It can be used in cases where metastasis or spread to other breast is suspected.</p>\n<p><strong>Option D- </strong>Fine needle aspiration cytology (<strong>FNAC</strong>)\u00a0 is not recommended in pregnant women. It is difficult to distinguish breast cancer from the normal cellular proliferation in the breast tissue due to hormonal changes.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which nerve is involved in Frey\u2019s syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Facial Nerve"
      },
      {
        "id": 2,
        "text": "Oculomotor nerve"
      },
      {
        "id": 3,
        "text": "Auriculotemporal nerve"
      },
      {
        "id": 4,
        "text": "Glossopharyngeal nerve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>The Auriculotemporal nerve&nbsp;</strong>(V3 nerve) is involved in Frey's syndrome.</p>\n<p><strong>Frey&rsquo;s syndrome/Gustatory sweating</strong> (auriculotemporal syndrome) commonly develops after parotid surgery or other surgery or trauma that results in the opening of the parotid capsule.</p>\n<p>It is thought to reflect <strong>abnormal&nbsp;innervation</strong> of sweat glands on the face by regrowing parasympathetic secretomotor axons that would previously have innervated the parotid gland.</p>\n<p>It is characterized by sweating, warmth, and redness of the face as a result of salivary stimulation by the smell or taste of food.</p>\n<p>&nbsp;</p>\n<p>Management:</p>\n<p>Denervation by a <strong>tympanic neurectomy</strong> or <strong>auriculotemporal nerve avulsion</strong> has been advocated but is often not curative. The symptoms can be managed by the subcutaneous infiltration of purified <strong>botulinum toxin</strong> into the affected area and the use of <strong>antiperspirant.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The given image shows a congenital bronchopulmonary malformation. Which of the following commonly supplies the marked structure?",
    "choices": [
      {
        "id": 1,
        "text": "Internal mammary artery"
      },
      {
        "id": 2,
        "text": "Bronchial artery"
      },
      {
        "id": 3,
        "text": "Pulmonary artery"
      },
      {
        "id": 4,
        "text": "Thoracic aorta"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given CT shows an <strong>intralobar pulmonary sequestration</strong>&nbsp;of the left lung.<strong> Thoracic aorta&nbsp;</strong>commonly supplies the sequestered lobe of the lung.</p>\n<ul>\n<li>Pulmonary Sequestration is an area of Embryonic Lung Tissue, separate from the lung, which receives blood supply from an <strong>anomalous systemic artery from the Aorta</strong>.</li>\n<li>Extralobar Sequestration occurs primarily on the left side and blood supply is usually from the Thoracic or upper Abdominal Aorta.</li>\n<li>Intralobar Sequestration occurs in the lower lobes predominantly (&gt;95%) and is equally distributed between the right and left lower lobe and blood supply is from the descending Thoracic aorta, venous drainage via pulmonary veins.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3c514311c54840e8b32e4a227d987422.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most common type of tracheo-esophageal fistula?",
    "choices": [
      {
        "id": 1,
        "text": "A"
      },
      {
        "id": 2,
        "text": "B"
      },
      {
        "id": 3,
        "text": "C"
      },
      {
        "id": 4,
        "text": "D"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Image&nbsp;C </strong>shows the commonest variety of Tracheo-esophageal fistula (TEF).</p>\n<p>TEF is an abnormal&nbsp;communication between Esophagus and Trachea. With each breath, the air enters the distal esophagus and the stomach causing gastric distention which presents as abdominal distention.&nbsp;</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p><strong>Type C </strong>is the<strong> </strong>most common - it has&nbsp;<strong>proximal esophageal atresia and distal TEF (</strong>the proximal blind pouch ends at the distance of one or two vertebral bodies from the distal TEF).</p>\n<p>Tracheoesophageal fistula is associated with <strong>VACTERL</strong> (vertebral, anorectal, cardiac, tracheal, esophageal, renal, and limb) anomalies.&nbsp;The inability to pass a nasogastric (NG) tube is a crucial pointer in the diagnosis of esophageal atresia.&nbsp;</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">&nbsp;</div>\n</div>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2f221c24f645475c8a107305894887fb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/95bd74f95fb84cd58124c38bb727e041x1280x1964.JPEG"
    ]
  },
  {
    "text": "Which among the following statements is false regarding the instrument shown below?",
    "choices": [
      {
        "id": 1,
        "text": "If used early reduces cardiac output"
      },
      {
        "id": 2,
        "text": "Delayed clamping should be avoided in Rh- pregnancy"
      },
      {
        "id": 3,
        "text": "It is to be removed 48 hours after birth"
      },
      {
        "id": 4,
        "text": "Increases iron stores in the baby"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows an <strong>umbilical cord clamp</strong>. It should be<strong> kept in place</strong> until it <strong>falls off</strong> with the detached stump of the umbilical cord.</p>\n<p>It is made of <strong>plastic</strong> and supplied in a sterile pack. It <strong>occludes the umbilical vessels</strong> effectively. In preterm infants, delayed clamping may improve transitional circulation, establish better red blood cell volume, reduce the need for blood transfusion and reduce the risk of necrotizing enterocolitis and intraventricular haemorrhage. It should be delayed by<strong> 30-60 seconds </strong>after birth.</p>\n<p>Other options:</p>\n<p>Option A: If performed early <strong>reduces cardiac output </strong>owing to reduced preload to the left ventricle whereas if performed late permits sufficient aeration of the lung and improved / smoother transitioning to a better cardiac output.</p>\n<p>Option B:<strong> Early cord clamping</strong> is advised in <strong>Rh-negative pregnancy,</strong> babies with asphyxia, or infants of diabetic mothers. Early clamping can also reduce the need for phototherapy due to hyperbilirubinemia.\u00a0</p>\n<p>Option D: <strong>Delayed umbilical cord clamping</strong> in term infants will increase haemoglobin levels at birth and<strong> improve iron stores</strong> for the first few months. This may have a favourable effect on developmental outcomes.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/209bacf953c14781a323c7ec4c67707d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the most common cause of consumptive coagulopathy in obstetrics?",
    "choices": [
      {
        "id": 1,
        "text": "Intrauterine death"
      },
      {
        "id": 2,
        "text": "Amniotic fluid embolism"
      },
      {
        "id": 3,
        "text": "Sepsis"
      },
      {
        "id": 4,
        "text": "Placental abruption"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Placental abruption</strong> is the most common cause of severe <strong>consumptive coagulopathy&nbsp;</strong>in obstetrics.</p>\n<div class=\"page\" title=\"Page 1\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Consumptive coagulopathy, also known as <strong>disseminated intravascular coagulation</strong> (DIC), is a pathologic disruption of hemostasis. It is characterized by systemic activation of blood coagulation, which results in <strong>thrombosis</strong> and <strong>fibrin</strong> deposition in the small blood vessels throughout the body.</p>\n</div>\n</div>\n</div>\n</div>\n<p>Other causes of DIC in pregnancy:</p>\n<ul>\n<li>Amniotic fluid embolism</li>\n<li>Sepsis</li>\n<li>Preeclampsia and HELLP syndrome</li>\n<li>Acute fatty liver of pregnancy</li>\n<li>Postpartum haemorrhage.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the type of ovarian tumor in the given image.",
    "choices": [
      {
        "id": 1,
        "text": "Epithelial tumor"
      },
      {
        "id": 2,
        "text": "Germ cell tumor"
      },
      {
        "id": 3,
        "text": "Sex cord stromal tumor"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows cut specimen of <strong>ovary with hair and sebum &ndash; Dermoid cyst which is a germ cell tumor.</strong></p>\n<p>Dermoid cyst</p>\n<ul>\n<li>A benign teratoma</li>\n<li>Most common benign tumor of ovary in reproductive age group</li>\n<li>Most common benign tumor of ovary diagnosed in pregnancy</li>\n<li>Most common germ cell tumor (overall)</li>\n<li>It is the commonest tumor to undergo torsion.</li>\n<li>It is bilateral in 10-15% cases.</li>\n<li class=\"li1\"><strong>Rokitansky&rsquo;s protuberance</strong>, which is a projection covered by skin, sebaceous glands, sweat glands along with teeth &amp; bones can be seen.</li>\n<li class=\"li1\">Sometimes <strong>thyroid tissue</strong> can be seen on histopathological study &ndash; known as&nbsp;<strong>Struma Ovarii.</strong></li>\n<li class=\"li1\">Most common tissue elements found are <strong>ectodermal derivatives.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f9690bb628c5452bb833c57da4b4d899.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 7-year-old child is brought to the OPD with a history of mental retardation, failure to walk or talk, failure to grow, seizures, hyperactivity, and tremors. On examination, there is microcephaly, fair hair, light skin color, and blue eyes. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Oculocutaneous albinism"
      },
      {
        "id": 2,
        "text": "Phenylketonuria"
      },
      {
        "id": 3,
        "text": "Alkaptonuria"
      },
      {
        "id": 4,
        "text": "Tyrosinemia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical manifestations point to the diagnosis of&nbsp;<strong>Phenylketonuria&nbsp;</strong>(PKU).</p>\n<p>Characteristic clinical findings in Phenylketonuria:</p>\n<ul>\n<li><strong>Mental retardation</strong></li>\n<li><strong>Failure to walk or talk</strong></li>\n<li><strong>Seizures</strong></li>\n<li>Hyperactivity</li>\n<li>Tremor</li>\n<li>Microcephaly</li>\n<li>Failure to grow</li>\n<li>Deficiency of pigmentation (fair hair, light skin color, and blue eyes)</li>\n<li><strong>Mousey/musty odor</strong> is characteristically seen in&nbsp;phenylketonuria.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the following correctly.",
    "choices": [
      {
        "id": 1,
        "text": "A - Simple bone cyst, B - Aneurysmal bone cyst, C - Giant cell tumor (GCT)"
      },
      {
        "id": 2,
        "text": "A - Aneurysmal bone cyst, B - GCT, C - Simple bone cyst"
      },
      {
        "id": 3,
        "text": "A - GCT, B - Aneurysmal bone cyst, C - Simple bone cyst"
      },
      {
        "id": 4,
        "text": "A - GCT, B - Simple bone cyst, C - Aneurysmal bone cyst"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Giant cell tumor (GCT):</p>\n<p>Appears on a <strong>mature skeleton</strong>.&nbsp;Well circumscribed<strong>, expansile,</strong> sub-articular<strong>, eccentric, lytic </strong>lesion.&nbsp;The lesion has characteristic <strong>soap-bubble</strong> appearance with minimal marginal sclerosis.&nbsp;<strong>Epiphyseal </strong>location.</p>\n<p>Aneurysmal bone cyst:</p>\n<p>Appears on an <strong>immature skeleton</strong> (we can see that the epiphysis is not fused).&nbsp;Highly expansile and <strong>eccentrically</strong> located, <strong>lytic</strong> lesion.&nbsp;Highly trabeculated and lobulated.&nbsp;<strong>Metaphyseal </strong>location.</p>\n<p>Simple bone cyst:</p>\n<p>Appears on an <strong>immature skeleton.&nbsp;</strong>Most commonly affects <strong>proximal humerus.&nbsp;</strong><strong>Centrally located, lytic </strong>lesion.&nbsp;<strong>Metaphyseal</strong> location</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a690ef6e8d1c40458e738db0a5820a21.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the diagnosis from the X-ray given below.",
    "choices": [
      {
        "id": 1,
        "text": "Perthes disease"
      },
      {
        "id": 2,
        "text": "DDH"
      },
      {
        "id": 3,
        "text": "SCFE"
      },
      {
        "id": 4,
        "text": "Achondroplasia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Achondroplasia</strong>&nbsp;is a congenital genetic disorder resulting in<strong>&nbsp;</strong>rhizomelic dwarfism&nbsp;(proximal limb shortening)<strong>&nbsp;</strong>and is the <strong>most common</strong><strong>&nbsp;</strong><strong>cause of disproportionate dwarfism</strong>.</p>\n<p>The&nbsp;<strong>champagne glass pelvis</strong>&nbsp;is a sign in&nbsp;achondroplasia&nbsp;in which the <strong>iliac blades are flattened</strong>, giving rise to a pelvic inlet that resembles a champagne glass. The&nbsp;acetabular angles&nbsp;are flattened (horizontal) and the sacrosciatic notch is small.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9bd169f3b45342e9964fef223dfad232.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a1a95ebfc3a749cebbc1191615c36978x718x901.GIF"
    ]
  },
  {
    "text": "A 50-year-old man has a fight with his neighbour. The next day he feels that his neighbours are following him and recording his movements and he fears that they are planning to kill him. What do his symptoms represent?",
    "choices": [
      {
        "id": 1,
        "text": "Thought insertion"
      },
      {
        "id": 2,
        "text": "Delusion of control"
      },
      {
        "id": 3,
        "text": "Delusion of persecution"
      },
      {
        "id": 4,
        "text": "Delusion of reference"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Thoughts of being harmed, followed by people around him represent <strong>delusion of persecution.&nbsp;</strong>It is the <strong>most common</strong> type of delusion.</p>\n<p>Delusion is a false, firm, fixed (unshakable) belief which is not in keeping with the patient&rsquo;s socio-cultural and educational background.</p>\n<p>Delusions are of two types based on their origin:</p>\n<ul>\n<li><strong>Primary</strong>: Arise de-novo and cannot be explained based on previous experiences, <strong>characteristic of schizophrenia.</strong></li>\n<li><strong>Secondary</strong>: Delusions that are secondary to other morbid psychological conditions like depressive moods and hallucinations.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following anesthetics is to be avoided in a hypertensive patient?",
    "choices": [
      {
        "id": 1,
        "text": "Thiopentone"
      },
      {
        "id": 2,
        "text": "Propofol"
      },
      {
        "id": 3,
        "text": "Ketamine"
      },
      {
        "id": 4,
        "text": "Etomidate"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Ketamine&nbsp;is avoided in hypertensive patients as it has <strong>intrinsic sympathomimetic properties </strong>and hence can aggravate hypertension.</p>\n<p>This is due to<strong> central stimulation </strong>of the <strong>sympathetic nervous system </strong>and<strong> inhibition </strong>of the <strong>reuptake </strong>of<strong> norepinephrine</strong>. And hence it should be cautiously used in patients with uncontrolled hypertension, coronary artery disease, congestive heart failure and arterial aneurysms.</p>\n<p>Other intravenous induction agents like <strong>propofol</strong> and <strong>thiopentone</strong> produce a <strong>fall in blood pressure</strong>. <strong>Etomidate</strong> is an induction agent that <strong>does not alter the blood pressure</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is not true regarding piebaldism?",
    "choices": [
      {
        "id": 1,
        "text": "It is autosomal dominant"
      },
      {
        "id": 2,
        "text": "Well-defined hypopigmented macules are seen"
      },
      {
        "id": 3,
        "text": "White forelock is rare"
      },
      {
        "id": 4,
        "text": "Small spots of hyperpigmentation can also be seen"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>White forelock</strong> is quite common<strong>&nbsp;</strong>in Piebaldism.</p>\n<p><strong>Piebaldism:</strong></p>\n<ul>\n<li><strong>Autosomal dominant</strong> benign&nbsp;condition, it has&nbsp;mutations in c\u2010KIT.</li>\n<li>Well-defined irregular&nbsp;<strong>hypopigmented macules</strong>&nbsp;with an absence of melnocytes.</li>\n<li>Small spots of hyperpigmentation are also seen within hypopigmented patches or on normal skin.&nbsp;</li>\n<li>It is often associated with a <strong>V-shaped leucoderma</strong> on mid-forehead.</li>\n<li><strong>Both sexes</strong> are equally affected.</li>\n<li>Piebaldism can be distinguished from vitiligo because of the<strong> neonatal presence of white patches.</strong></li>\n<li>Epidermal cell or skin grafting is the treatment.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/64f6f8375a5844ebbed9f5ce8ccecb18x512x510.PNG"
    ]
  },
  {
    "text": "Contrast used in CT____",
    "choices": [
      {
        "id": 1,
        "text": "Gadolinium"
      },
      {
        "id": 2,
        "text": "Technetium"
      },
      {
        "id": 3,
        "text": "Iodine"
      },
      {
        "id": 4,
        "text": "Chromium"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Iodinated contrast</strong> is used in CT, IVP, and angiography. All these are based on X-rays and iodine is a radio-opaque substance.</p>\n<p>In the contrast medium, Iodine provides the radiopacity; the other elements of the contrast medium molecule provide no radiopacity but act as carriers of the iodine, greatly increasing the solubility and markedly reducing the toxicity of the molecule.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 008';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>