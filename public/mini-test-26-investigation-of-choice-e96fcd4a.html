<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test- 26 (Investigation Of Choice) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2024
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 24-year-old man who presented with hepatomegaly and neuropsychiatric symptoms is found to have the following picture on ophthalmic examination. You suspect Wilson's disease. Which of the following is the gold standard for the clinical diagnosis of Wilson's disease?",
    "choices": [
      {
        "id": 1,
        "text": "Serum copper"
      },
      {
        "id": 2,
        "text": "Serum ceruloplasmin"
      },
      {
        "id": 3,
        "text": "Urinary copper"
      },
      {
        "id": 4,
        "text": "Liver copper"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>gold standard </strong>for the clinical diagnosis of<strong> Wilson's</strong> <strong>disease</strong>&nbsp;is&nbsp;<strong>liver biopsy</strong> with <strong>quantitative copper assays</strong>. The affected patients have values <strong>&gt;3.1 &mu;mol/g</strong> (&gt;200 &mu;g/g (dry weight) of liver).<strong>&nbsp;</strong></p>\n<p><strong>The urinary copper level</strong>&nbsp;is an important diagnostic tool and symptomatic patients have copper levels <strong>&gt;1.6 &mu;mol</strong> (&gt;100 &mu;g) per 24 hour.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/134e3187859640fe9922cfff61989c29.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 62-year-old patient with a history of diabetes and hypertension came with post-menopausal bleeding. Which of the following you will do to evaluate the cause?",
    "choices": [
      {
        "id": 1,
        "text": "Pap smear"
      },
      {
        "id": 2,
        "text": "Visual inspection with iodine"
      },
      {
        "id": 3,
        "text": "Colposcopy"
      },
      {
        "id": 4,
        "text": "Endometrial sampling"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Endometrial sampling&nbsp;</strong>is done to evaluate a patient presenting with&nbsp;postmenopausal bleeding.</p>\n<p>Postmenopausal bleeding is defined as bleeding from the genital tract, more than 12 months after the last menstrual period in a woman not on hormone replacement. All postmenopausal women with unexpected uterine bleeding should be evaluated for&nbsp;<strong>endometrial malignancy&nbsp;</strong>since age is a significant risk factor for this.</p>\n<p>Transvaginal ultrasound(TVS) is a better first-line investigation since TVS is not included in the options, endometrial sampling is the next best answer.</p>\n<p>Endometrial sampling is indicated if:</p>\n<ul>\n<li>The endometrial thickness is &gt;4 mm</li>\n<li>The endometrium shows diffuse or focal increased echogenicity (heterogeneity)</li>\n<li>The endometrium is not adequately visualized on transvaginal sonography</li>\n<li>The woman has persistent bleeding, as it can be a sign of endometrial cancer even when the endometrial thickness is less than 4mm.</li>\n</ul>\n<p>The image below gives a summary of the evaluation of postmenopausal bleeding, as per the FOGSI guidelines.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6689d28a0347473c955fdcd4c9f7521ax1280x2320.JPEG"
    ]
  },
  {
    "text": "A 60-year-old bedridden patient develops acute onset dyspnea and chest pain. A CT pulmonary angiography was done. Which screening test will be useful to determine the etiology of this patient's condition?",
    "choices": [
      {
        "id": 1,
        "text": "MR Angiogram"
      },
      {
        "id": 2,
        "text": "Echocardiography"
      },
      {
        "id": 3,
        "text": "D-dimer measurement"
      },
      {
        "id": 4,
        "text": "Coagulogram"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In a bedridden patient presenting with sudden onset dyspnea and chest pain, there is a concern for possible <strong>pulmonary embolism (PE). Deep vein thrombosis (DVT)</strong> can be suspected in this patient because of his bedridden status. The screening test used for DVT is the<strong> D-dimer measurement.</strong></p>\n<p>DVT of the leg is complicated by the immediate risk of pulmonary embolus and sudden death. Patients are at risk of developing a post-thrombotic limb and venous ulceration.\u00a0</p>\n<p><strong>Virchow's Triad:</strong>\u00a0three factors important in the development of venous thrombosis.\u00a0</p>\n<ul>\n<li>Endothelial injury (vascular Injury)</li>\n<li>Hypercoagulability of blood</li>\n<li>Stasia or turbulence of blood flow</li>\n</ul>\n<p>The most important predisposing factor is <strong>hospital admissions</strong>\u00a0for the\u00a0<strong>treatment of a medical or surgical condition</strong></p>\n<p>Diagnosis:</p>\n<p><strong>D-dimer </strong>measurement<strong>: </strong>If<strong> normal, </strong>no indication for further investigation\u00a0but\u00a0<strong>if raised, a duplex ultrasound examination</strong>\u00a0of the deep veins should be performed.</p>\n<p><strong>Duplex ultrasound</strong>\u00a0is the\u00a0<strong>investigation of choice</strong>\u00a0for diagnosis of DVT (<strong>Filling defects</strong>\u00a0in flow and\u00a0<strong>lack of compressibility</strong>\u00a0indicate the presence of a thrombosis)</p>\n<p><strong>Ascending venography</strong>\u00a0shows thrombus as\u00a0<strong>a filling defect,</strong>\u00a0which is now rarely required</p>\n<p><strong>Treatment</strong></p>\n<ul>\n<li>Rest, elevation of the limb, and bandaging the entire limb with a crepe bandage.</li>\n<li>Anticoagulants: Heparin/low molecular weight heparin, warfarin, phenindione.</li>\n<li>Palma operation</li>\n<li>May-Husni operation</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old woman with a history of hypertension presented to the emergency room with loss of consciousness, chest pain, and diaphoresis. On examination, she was grossly unstable and the bilateral pulses were unequal. ECG showed nonspecific ST-T changes. What is the next best investigation?",
    "choices": [
      {
        "id": 1,
        "text": "MRI"
      },
      {
        "id": 2,
        "text": "Transesophageal echocardiography"
      },
      {
        "id": 3,
        "text": "Cardiac enzymes"
      },
      {
        "id": 4,
        "text": "X-ray"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical presentation with <strong>acute onset chest pain</strong>, loss of consciousness and diaphoresis with bilaterally unequal pulses and ECG showing nonspecific <strong>ST-T </strong>changes is suggestive of <strong>aortic dissection, </strong>and<strong> </strong>as the patient is\u00a0hemodynamically<strong> unstable</strong>, the next best investigation is <strong>transesophageal ECHO</strong>.</p>\n<p><strong>Aortic dissection</strong> occurs when a defect or flap occurs in the<strong> intima</strong> of the <strong>aorta</strong>. Predisposing factors include mainly age, <strong>hypertension</strong>, <strong>Marfan syndrome,</strong> and pregnancy. The most typical presentation of aortic dissection is a<strong> tearing interscapular pain</strong>. The dissection may also result in aortic wall rupture into the pericardium (<strong>cardiac tamponade</strong>) or mediastinum (<strong>left haemothorax</strong>).</p>\n<p><strong>Contrast-enhanced CT</strong>(CECT) is currently the most preferred imaging modality for aortic dissection. A <strong>d</strong><strong>ouble-lumen aorta</strong> is seen on CECT. <strong>Transesophageal echocardiography</strong> is preferred for patients who are<strong> unstable</strong> for transportation.</p>\n<p>Acute aortic dissection can be classified by the original<strong> DeBakey</strong> system, based on the location of the proximal tear and distal extent of the dissection flap, or the <strong>Stanford system,</strong> which uses the location of the proximal tear alone.</p>\n<p>The classification and management of aortic dissection is explained in the images given below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d4668925fa3d4297b60f21f9059bfdc1x1280x1241.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b99f9978e8ee438bbd08eedad63b4d74x1280x3028.JPEG"
    ]
  },
  {
    "text": "Investigation of choice for acute pancreatitis is_______",
    "choices": [
      {
        "id": 1,
        "text": "Plain X-ray abdomen"
      },
      {
        "id": 2,
        "text": "CECT"
      },
      {
        "id": 3,
        "text": "MRI"
      },
      {
        "id": 4,
        "text": "USG"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li><strong>Contrast-enhanced CT scan</strong> is the <strong>investigation of choice</strong>.</li>\n<li>The <strong>optimal time</strong> for performing CECT is <strong>more&nbsp;than 72 h after the onset of symptoms&nbsp;</strong>(In the first 72 hours, CT may underestimate the extent of necrosis.).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The investigation of choice for localizing the cause in a patient presenting with nasal discharge following a skateboarding accident, which has the following appearance on a tissue paper is:",
    "choices": [
      {
        "id": 1,
        "text": "Beta 2-transferrin assay"
      },
      {
        "id": 2,
        "text": "HRCT"
      },
      {
        "id": 3,
        "text": "MRI"
      },
      {
        "id": 4,
        "text": "Gadolinium enhanced MRI"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image showing<strong>&nbsp;double target sign </strong>on tissue paper&nbsp;and the history is consistent with <strong>traumatic CSF rhinorrhea.&nbsp;HRCT</strong> is the<strong> investigation of choice for localizing the site of the leak in CSF rhinorrhea</strong>.</p>\n<p>Though Beta 2-transferrin assay is the best laboratory test for identifying the presence of CSF in the sinonasal fluid it does not provide information regarding the site or laterality of the defect.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b0cd9b29b9ff43b88e09ec6c365647cc.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old woman came with complaints of headache for 1 month. She also reports aching of the jaw during her meals. Over the last week, she has experienced episodes of painless visual loss which lasts for around 10 minutes. Which will be the best investigation for the diagnosis of the given condition?",
    "choices": [
      {
        "id": 1,
        "text": "Temporal artery biopsy"
      },
      {
        "id": 2,
        "text": "Colour Doppler of Temporal artery"
      },
      {
        "id": 3,
        "text": "CT angiography"
      },
      {
        "id": 4,
        "text": "MR angiography"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of giant cell arteritis. The best investigation for the diagnosis of giant cell arteritis is <strong>temporal artery biopsy</strong>.</p>\n<p>Histopathology shows panarteritis with the presence of mononuclear cells and giant cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old woman with a first-degree relative with BRCA1 gene mutation, presented to the OPD with a normal mammography report. The next investigation of choice to evaluate for breast disease would be _______",
    "choices": [
      {
        "id": 1,
        "text": "USG"
      },
      {
        "id": 2,
        "text": "MRI"
      },
      {
        "id": 3,
        "text": "Trucut biopsy"
      },
      {
        "id": 4,
        "text": "Excisional biopsy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>MRI</strong> is helpful in the&nbsp;<strong>screening of high-risk individuals,</strong> and it is the <strong>most sensitive</strong> imaging modality. However, it should be <strong>done after initial radiological evaluation,&nbsp;</strong>in which the results may be inconclusive.</p>\n<p>Here, the patient is a high-risk individual since there is family history of first-degree relative with BRCA1 gene mutation and&nbsp;initial radiological evaluation is normal. Hence, MRI is the next step to evaluate further. Trucut biopsy is the next step following MRI.</p>\n<div class=\"page\" title=\"Page 852\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>American Cancer Society Risk Criteria for Breast Magnetic Resonance Imaging Screening:</strong></p>\n<p>Women at <strong>high lifetime risk</strong> (&asymp;20%-25% or greater) of breast cancer</p>\n<ul>\n<li>\n<p>Known BRCA1 or BRCA2 gene mutation</p>\n</li>\n<li>\n<p>First-degree relative with BRCA1 or BRCA2 gene mutation, but have not had genetic testing themselves.</p>\n</li>\n<li>\n<p>Radiation therapy to the chest between the ages of 10 and 30</p>\n</li>\n<li>\n<p>Li-Fraumeni syndrome or Cowden syndrome or a first-degree relative with one of these syndromes</p>\n</li>\n</ul>\n<p>Women at <strong>moderately</strong> increased (15%-20%) <strong>lifetime risk</strong></p>\n<ul>\n<li>\n<p>Lifetime risk of breast cancer of 15%-20% according to risk assessment tools based mainly on family history</p>\n</li>\n<li>\n<p>Personal history of breast cancer, ductal carcinoma in situ, lobular carcinoma in situ, atypical ductal hyperplasia, or atypical lobular hyperplasia.</p>\n</li>\n<li>\n<p>Extremely dense breasts or unevenly dense breasts when viewed by mammograms</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young villager presents to the clinic with abdominal pain for the past 1 month. Personal history is notable for keeping goats and sheep in the home. On examination, you feel a firm mass in the right hypochondrium which moves with respiration. Blood investigations and serology is suggestive of the hepatic hydatid cyst. Which of the following will be the best investigation to assess the hydatid cyst in this person?",
    "choices": [
      {
        "id": 1,
        "text": "USG"
      },
      {
        "id": 2,
        "text": "Casoni\u2019s test"
      },
      {
        "id": 3,
        "text": "CT scan"
      },
      {
        "id": 4,
        "text": "ELISA"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Computed tomography (CT) scan is the<strong> best imaging modality </strong>for hydatid cyst. It shows the presence of a space-occupying lesion with a smooth outline with septa.</p>\n<p>CT scan has an accuracy of 98% in the detection of hydatid cysts and higher sensitivity to demonstrate the daughter cysts and extra-hepatic cysts.&nbsp;<br />The indirect hemagglutination test and enzyme-linked immunosorbent assay (ELISA) have a sensitivity of 80% overall and are the initial <strong>screening tests</strong> of choice.</p>\n<p>Hydatid cysts in CT scan with collapsed /detached membrane:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0edf95440dbe44208f2e84955973af91x767x600.JPEG"
    ]
  },
  {
    "text": "A patient presented with a high fever, altered sensorium, headache, neck rigidity, and seizures. He was diagnosed with HSV encephalitis. Which of the following tests can be used to confirm the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "IgM in CSF"
      },
      {
        "id": 2,
        "text": "Tzanck smear of CSF"
      },
      {
        "id": 3,
        "text": "CSF PCR for viral DNA"
      },
      {
        "id": 4,
        "text": "CSF culture on chick embryo lines"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>HSV-DNA </strong>demonstration in<strong> CSF by PCR </strong>is the<strong> investigation of choice</strong> for<strong> HSV encephalitis.\u00a0</strong></p>\n<p><strong>Herpes simplex virus (HSV)</strong>\u00a0encephalitis is defined as inflammation of brain parenchyma caused by the herpes virus, and it typically presents as an<strong> acute febrile illness</strong>.</p>\n<div class=\"page\" title=\"Page 1135\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Patients typically present with acute onset of <strong>fever</strong>,\u00a0<strong>altered levels of consciousness</strong>, personality changes, and evidence of either <strong>focal or diffuse neurologic signs and symptoms, </strong>especially in the<strong> temporal lobe.</strong>\u00a0<strong>Focal or generalized seizures</strong> occur in many patients with HSV encephalitis. Other most commonly encountered focal findings include aphasia, ataxia, upper motor neuron or lower motor neuron type lesions, and cranial nerve deficits.</p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>HSV-DNA</strong> demonstration in CSF by <strong>PCR </strong>is the investigation of choice for HSV encephalitis. Other investigations that can help include CSF examination, CSF culture, serological studies, MRI, CT, EEG, and brain biopsy.</p>\n<p>The <strong>T2-weighted MRI of the brain</strong> will show <strong>hyperintensity in the temporal lobe</strong> in most of the patients. <strong>Bilateral</strong> involvement of the temporal lobe is <strong>more common</strong> in HSV encephalitis.</p>\n<p>The image below is a<strong>\u00a0</strong><strong>coronal T2-weighted MR</strong> image showing a high signal intensity in the temporal lobes in a patient with HSV encephalitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e8c33e7dde164fd8adfa7d0badbcc4ddx480x512.JPEG"
    ]
  },
  {
    "text": "A 65-year-old male was brought to the emergency department with sudden onset breathlessness. He has undergone hip replacement one month back. As a physician, you are suspecting a pulmonary embolism. Which of the following is the investigation of choice for your diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ventilation perfusion scanning (V/Q scan) of lungs"
      },
      {
        "id": 2,
        "text": "Chest CT with intravenous contrast"
      },
      {
        "id": 3,
        "text": "MR pulmonary angiography"
      },
      {
        "id": 4,
        "text": "Echocardiography"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>CT chest with intravenous contrast</strong>&nbsp;is the investigation of choice for<strong> pulmonary embolism (PE).</strong></p>\n<p>Other options:</p>\n<ul>\n<li>Ventilation-perfusion (V/Q ) scanning has become a second-line diagnostic test for PE, used mostly for patients who cannot tolerate intravenous contrast or in whom the CT results are inconclusive.</li>\n<li>MR pulmonary angiography may detect large proximal PE but is not reliable for smaller segmental and subsegmental PE. It is used when neither CT angiography nor ventilation perfusion scan can be done.&nbsp;</li>\n<li>Echocardiography is not a reliable diagnostic imaging tool for acute PE because most patients with PE have normal echocardiograms. However, echocardiography is a very useful diagnostic tool for detecting conditions that may mimic PE, such as acute myocardial infarction, pericardial tamponade, and aortic dissection.</li>\n</ul>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>The arrows in the following images demonstrate a pulmonary embolus. Also the gross specimen image helps correlation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eb8d74e4d37547b6a6286f6fad9515bdx800x581.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/faa4e0ce5d3c4987a19a999a4fa1ec57x800x570.PNG"
    ]
  },
  {
    "text": "A young patient presents to the clinic with erythematous lesions over the exposed areas of the skin like hands, arms, chest, etc. She also complains of arthralgia and breathlessness. Which among the following antibodies will be useful in diagnosing this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Antihistone antibodies"
      },
      {
        "id": 2,
        "text": "Anti dsDNA antibodies"
      },
      {
        "id": 3,
        "text": "Anticentromere antibodies"
      },
      {
        "id": 4,
        "text": "Antinuclear antibodies"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario of a patient with a photosensitive rash, arthralgias, and shortness of breath is suggestive of&nbsp;<strong>systemic lupus erythematosus</strong>&nbsp;(SLE). Anti-dsDNA antibodies are specific for the diagnosis of SLE.</p>\n<p>SLE is an&nbsp;<strong>autoimmune disorder</strong>&nbsp;that results in damage to multiple organs and organ systems in the body most commonly seen in&nbsp;<strong>women</strong>&nbsp;of&nbsp;<strong>reproductive age</strong>.&nbsp;&nbsp;</p>\n<p><strong>Clinical</strong>&nbsp;and&nbsp;<strong>immunological manifestations&nbsp;</strong>of<strong>&nbsp;SLE</strong>:</p>\n<ol>\n<li>Skin\n<ul>\n<li>acute, subacute cutaneous manifestations (photosensitivity,&nbsp;<strong>malar</strong>&nbsp;or maculopapular rash)</li>\n<li>chronic cutaneous manifestations (discoid lupus, panniculitis, lichen planus-like)&nbsp;</li>\n</ul>\n</li>\n<li><strong>Oral</strong>&nbsp;or&nbsp;<strong>nasal ulcers</strong></li>\n<li>Non-scarring alopecia</li>\n<li><strong>Synovitis&nbsp;</strong>involving&nbsp;<strong>&ge;2</strong>&nbsp;<strong>joints</strong></li>\n<li>Serositis (pleurisy, pericarditis)</li>\n<li>Renal:&nbsp;\n<ul>\n<li>Protein/Creatinine ratio &gt;0.5</li>\n<li>RBC casts</li>\n</ul>\n</li>\n<li>Neurologic: seizures, psychosis, myelitis, neuropathy, confusional state</li>\n<li>Hemolytic anemia</li>\n<li>Leukopenia</li>\n<li>Thrombocytopenia</li>\n<li><strong>Immunological manifestations</strong>\n<ul>\n<li>Antinuclear antibodies &gt;reference value (positive in &gt;98% patients)</li>\n<li><strong>Anti-dsDNA &gt;reference value (specific)</strong></li>\n<li>Anti-Smith antibody (specific)</li>\n<li>Antiphospholipid antibody (lupus anticoagulant, false-positive rapid plasma reagin)</li>\n<li>Low serum complement</li>\n</ul>\n</li>\n</ol>\n<p>To&nbsp;<strong>diagnose</strong>&nbsp;SLE, at least<strong>&nbsp;4&nbsp;</strong>out of&nbsp;<strong>11&nbsp;</strong>of the above criteria must be positive. However, if a&nbsp;<strong>renal biopsy</strong>&nbsp;is suggestive of&nbsp;<strong>lupus nephritis</strong>&nbsp;and&nbsp;<strong>lupus autoantibodies</strong>&nbsp;are positive then four criteria are not required.&nbsp;</p>\n<p>Antinuclear antibody detection is sensitive for the screening of SLE but not specific to diagnose it.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1503aad5d0284a70b99ff5469c3ba2f3.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The gold standard for the diagnosis of endometriosis is _______",
    "choices": [
      {
        "id": 1,
        "text": "Ultrasound"
      },
      {
        "id": 2,
        "text": "Ct scan"
      },
      {
        "id": 3,
        "text": "Laparoscopy"
      },
      {
        "id": 4,
        "text": "Hysteroscopy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The gold standard for the diagnosis of endometriosis has been visual inspection by laparoscopy, preferably with histological confirmation.</p>\n<p>Laparoscopy is also the investigation of choice in endometriosis.</p>\n<p><strong>Role of laparoscopy in endometriosis:</strong></p>\n<ul>\n<li>To detect and diagnose pelvic endometriosis.</li>\n<li>Locate the site of endometriosis and staging.</li>\n<li>To take biopsy</li>\n<li>To surgically treat endometriosis by ablation, removal.</li>\n</ul>\n<p>Other investigations:</p>\n<ul>\n<li>CA-125 levels are raised in endometriosis.</li>\n<li>Monocyte chemotactic protein (MCP-1) levels are raised in peritoneal fluid of women with endometriosis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 16-year-old boy is admitted with fever, icterus, conjunctival suffusion and hematuria for 15 days. Which serological test should be done for diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Widal test"
      },
      {
        "id": 2,
        "text": "Microscopic agglutination test"
      },
      {
        "id": 3,
        "text": "Weil felix reaction"
      },
      {
        "id": 4,
        "text": "Paul Bunnell test"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Microscopic agglutination test</strong>&nbsp;is used for diagnosis <strong>of Leptospirosis</strong>.</p>\n<p>History of fever with liver(icterus) and kidney(hematuria) involvement should arouse suspicion for leptospirosis (Weil's disease).</p>\n<p>Serotype-specific tests:&nbsp;<em>&nbsp;</em></p>\n<ol>\n<li>Microscopic agglutination test&nbsp;</li>\n<li>Macroscopic agglutination test&nbsp;</li>\n</ol>\n<p>Regarding other options :</p>\n<ul>\n<li><strong> WIDAL test</strong> is used to screen for typhoid fever</li>\n<li><strong>Weil Felix reaction</strong> is used to diagnose rickettsial fevers &nbsp;</li>\n<li><strong>Paul Bunnell test</strong> is the investigation of choice for infectious mononucleosis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the investigation shown below which is the investigation of choice in distal bowel tumours.",
    "choices": [
      {
        "id": 1,
        "text": "Enteroclysis"
      },
      {
        "id": 2,
        "text": "Barium meal"
      },
      {
        "id": 3,
        "text": "Barium meal follow-through"
      },
      {
        "id": 4,
        "text": "Barium enema"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Enteroclysis, </strong>which&nbsp;is the <strong>investigation of choice</strong> in patients with <strong>small bowel tumors.</strong></p>\n<p>Enteroclysis is a <strong>barium study</strong>&nbsp;in which the <strong>contrast </strong>agent is put <strong>directly into the duodenum</strong> through a <strong>nasogastric tube.</strong></p>\n<p>Continued infusion of 500 to 1000 mL of thin barium sulfate and methylcellulose suspension is done and then viewed continuously with the use of either fluoroscopy or radiographs taken at frequent intervals. This technique is a <strong>double-contrast</strong> procedure that allows detailed imaging of the entire small intestine.</p>\n<p>Enteroclysis has a<strong> sensitivity </strong>of over <strong>90%</strong> in the detection of small bowel tumors and is the <strong>investigation of choice</strong>, particularly for<strong> tumors </strong>located in the <strong>distal small bowel.</strong></p>\n<p>Advantages of enteroclysis:</p>\n<ul>\n<li>The contrast is administered at a controlled rate directly in the small bowel, <strong>bypassing the regulatory action</strong> of the <strong>pylorus</strong>.</li>\n<li>The <strong>entire small bowel </strong>is demonstrated in a <strong>distended</strong> state, allowing <strong>better diagnosis</strong>. As a result of the dilatation, the following can be visualized:\n<ul>\n<li>Mild strictures</li>\n<li>Small sinus tracts and fistulas</li>\n<li>Minimal extrinsic compressions</li>\n<li>Skip lesions</li>\n<li>Proximal and distal extent of diffuse diseases.</li>\n</ul>\n</li>\n<li>The examination can be completed in <strong>15&ndash;30 minutes</strong>, thus reducing patient waiting time.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dec6089a80e24fd4929144518fe6c8af.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Dried blood spot (DBS) testing is commonly done in infants for:",
    "choices": [
      {
        "id": 1,
        "text": "Inborn errors of metabolism"
      },
      {
        "id": 2,
        "text": "Blood grouping"
      },
      {
        "id": 3,
        "text": "Bilirubin testing"
      },
      {
        "id": 4,
        "text": "Coombs Test"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Dried blood spots</strong>&nbsp;are taken from the <strong>heel</strong>&nbsp;to diagnose <strong>inborn errors of metabolism</strong>. It uses the principle of tandem mass spectroscopy (TMS).</p>\n<p>TMS employs 2 Mass Spectrometers in series to screen blood samples for the presence and to determine concentrations of various substances like amino acid, fatty acids, and other metabolites. The abnormalities in metabolite levels serve as the diagnostic indicator for various inborn errors of metabolism like:&nbsp;</p>\n<ul>\n<li style=\"font-weight: 400;\">Phenylketonuria</li>\n<li style=\"font-weight: 400;\">Ethylmalonic encephalopathy</li>\n<li style=\"font-weight: 400;\">Glutaric acidemia&nbsp;</li>\n</ul>\n<p>DBS is also used to detect profound T-cell lymphopenia in patients suspected to have severe combined immunodeficiency.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In aiding the diagnosis of a patient with suspected pneumoperitoneum, what is the most sensitive imaging modality among the given options:",
    "choices": [
      {
        "id": 1,
        "text": "Erect chest x-ray PA view"
      },
      {
        "id": 2,
        "text": "Supine abdomen x-ray AP view"
      },
      {
        "id": 3,
        "text": "Contrast-enhanced CT"
      },
      {
        "id": 4,
        "text": "Erect abdomen x-ray PA view"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Contrast-enhanced CT</strong> is the <strong>most sensitive imaging</strong> modality used in the diagnosis of minimal or suspected pneumoperitoneum. Free air as less as 1 ml can be detected. Small pockets of air trapped in peritoneal recesses can also be detected.&nbsp;</p>\n<p>An <strong>erect chest x-ray</strong> is the next most sensitive investigation, and also the <strong>initial investigation</strong> carried out to diagnose pneumoperitoneum. Free air under the diaphragm, also known as the <strong>crescent sign</strong> is seen here and it can detect around 3-4 ml of free air in the abdomen.&nbsp;</p>\n<p>If the patient is unable to stand, then an abdomen x-ray with <strong>left lateral decubitus view</strong> is more sensitive than supine or erect abdominal films to detect pneumoperitoneum.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most sensitive investigation for the condition shown in the following radiograph?",
    "choices": [
      {
        "id": 1,
        "text": "MRI"
      },
      {
        "id": 2,
        "text": "CT"
      },
      {
        "id": 3,
        "text": "DEXA"
      },
      {
        "id": 4,
        "text": "PET"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The radiograph shows flattening of the femoral head and degenerative changes associated with the <strong>avascular necrosis of femoral head</strong>. The <strong>most reliable </strong>investigation to diagnose avascular necrosis is<strong> MRI</strong>.</p>\n<p>MRI allows identification of avascular necrosis of femoral head in earlier stages and also determine the exact stage and extent of the pathologic process.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/65e9ded0e3e74ca0abd2a536cbb711be.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c0bb997857fa4c279345c49be55acf91x594x790.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/653c0cfd74e94f1090fc654f2d866aa4x742x842.JPEG"
    ]
  },
  {
    "text": "Investigation of choice for evaluation of bronchogenic carcinoma is:",
    "choices": [
      {
        "id": 1,
        "text": "CT"
      },
      {
        "id": 2,
        "text": "MRI"
      },
      {
        "id": 3,
        "text": "Bronchoscopy"
      },
      {
        "id": 4,
        "text": "None"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>CT</strong> is the investigation of choice for evaluation and diagnosis of bronchogenic carcinoma.</li>\n<li><strong>MRI &gt; CT</strong> is investigation of choice for superior sulcus tumor/ pan coast tumor.</li>\n<li>Bronchoscopy can be done in endobronchial tumors to obtain tissue diagnosis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The clinical investigation of choice in a patient with hypertension and hypokalemia is",
    "choices": [
      {
        "id": 1,
        "text": "ACTH Stimulation Test"
      },
      {
        "id": 2,
        "text": "24h Catecholamine Urine Testing"
      },
      {
        "id": 3,
        "text": "Octreoscan"
      },
      {
        "id": 4,
        "text": "Aldosterone-Renin Ratio"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical situation provided is symptomatic of <strong>hyperaldosteronism.</strong></p>\n<p>In this case, the&nbsp;<strong>screening test of choice</strong>&nbsp;should be the&nbsp;concurrent measurement of plasma renin and aldosterone level with a subsequent calculation of the <strong>aldosterone-renin ratio</strong> (ARR).</p>\n<p><strong>Determination of the aldosterone-renin ratio (ARR)</strong></p>\n<ul>\n<li>Continue blood pressure medication (stop intake of spironolactone alone for 4 weeks)</li>\n<li>Correct hypokalemia</li>\n</ul>\n<p><strong>ARR</strong> screen <strong>positive</strong> if</p>\n<ul>\n<li>ARR &gt; 750 pmol/L per ng/mL per hour</li>\n<li>Aldosterone &gt; 450 pmol/L</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Paul-Bunnell test is used to diagnose ______",
    "choices": [
      {
        "id": 1,
        "text": "Kissing disease"
      },
      {
        "id": 2,
        "text": "Herpes viral infection"
      },
      {
        "id": 3,
        "text": "CMV"
      },
      {
        "id": 4,
        "text": "Dengue viral infection"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Paul-Bunnell test is used to diagnose kissing disease (infectious mononucleosis) caused by Epstein&ndash;Barr virus (EBV).&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the investigation of choice for ureteropelvic junction (UPJ) obstruction in children?",
    "choices": [
      {
        "id": 1,
        "text": "Intravenous pyelogram (IVP)"
      },
      {
        "id": 2,
        "text": "99m Tc-MercaptoAcetyl-triGlycine (MAG3) scan"
      },
      {
        "id": 3,
        "text": "Micturating cystourethrogram (MCU)"
      },
      {
        "id": 4,
        "text": "Ultrasonography (USG)"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The investigation of choice for ureteropelvic junction (<strong>UPJ</strong>) obstruction is<strong>&nbsp;</strong><sup>99m</sup>Tc-MercaptoAcetyl-triGlycine<strong> (MAG3) scan.</strong></p>\n<p><strong>Nuclear scans</strong> (e.g.,&nbsp;<strong>MAG3 </strong>and&nbsp;diethylene-triamine-penta-acetic acid (DTPA)) have replaced intravenous pyelogram as the diagnostic modality of choice in UPJ obstruction.&nbsp;Delayed clearance of contrast or the radiotracer implies obstruction.</p>\n<p><strong>Option C:</strong> Micturating <strong>cystourethrogram</strong> is the&nbsp;investigation of choice in <strong>vesicoureteric reflux</strong>.&nbsp;</p>\n<div class=\"page\" title=\"Page 1581\">&nbsp;</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is used to diagnose the condition given in the below image?",
    "choices": [
      {
        "id": 1,
        "text": "Culture"
      },
      {
        "id": 2,
        "text": "Wood's lamp examination"
      },
      {
        "id": 3,
        "text": "Gram staining"
      },
      {
        "id": 4,
        "text": "Patch test"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows sharply demarcated hypopigmented macules coalescing into patches over the trunk, pointing to a likely diagnosis of <strong>tinea versicolor</strong> or pityriasis versicolor. A <strong>Wood's lamp</strong> is used to <strong>diagnose</strong> the condition. Lesions show a&nbsp;<strong>pale yellow fluorescence </strong>when examined under the lamp.</p>\n<p>Tinea versicolor is characterized by asymptomatic <strong>hypopigmented or hyperpigmented</strong> macules and patches and produces <strong>fine scales</strong> (branny/furfuraceous). The site most commonly affected is the <strong>upper trunk</strong>, but there is often spread to the upper arms, neck, and abdomen (seborrheic areas).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/02ef1a75b76741bc9c22157c9a523fbf.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 3-day-old neonate presents with abdominal distension and bilious vomiting. Among the following, which is the most appropriate investigation to diagnose the condition?",
    "choices": [
      {
        "id": 1,
        "text": "Barium Swallow"
      },
      {
        "id": 2,
        "text": "Barium Meal"
      },
      {
        "id": 3,
        "text": "Barium meal follow through"
      },
      {
        "id": 4,
        "text": "CECT abdomen"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario is suggestive of <strong>jejunoileal atresia</strong>, and among the options <strong>CECT abdomen</strong> is the most appropriate investigation to diagnose the condition.</p>\n<p>Small bowel atresias present with intestinal obstruction soon after birth. <strong>Bilious vomiting</strong> is the dominant feature in <strong>proximal bowel atresia</strong> such as <strong>duodenal atresia </strong>whereas <strong>abdominal distension</strong> with bilious vomiting is more with <strong>distal small bowel atresia</strong> such as\u00a0<strong>jejuno-ileal atresia</strong>. Jejuno-ileal atresia is the most GI atresia.</p>\n<p>Plain abdominal radiographs show a variable number of\u00a0<strong>dilated loops</strong>\u00a0of bowel and fluid levels according to the level of obstruction.</p>\n<ul>\n<li><strong>Jejunal/ileal</strong> atresia - <strong>Triple</strong> bubble appearance</li>\n<li><strong>Duodenal</strong> atresia - <strong>Double</strong> bubble appearance</li>\n</ul>\n<p>A <strong>contrast\u00a0study</strong>\u00a0is the\u00a0<strong>next best investigation</strong>\u00a0to exclude other bowel anomalies.\u00a0</p>\n<div class=\"page\" title=\"Page 1314\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 1314\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>\u00a0</p>\n<div class=\"page\" title=\"Page 1315\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>In jejunal/ileal atresia, the\u00a0<strong>distal end </strong>of the<strong> dilated proximal small bowel </strong>is<strong> resected</strong>\u00a0and a primary end-to-end anastomosis is possible. If the proximal bowel is extremely dilated, it may need to be tapered to the distal bowel before anastomosis.\u00a0</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dca6d08b92d6418a80b1c748c1028b3ax1280x4449.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/52089dbbb9a047a68a9be246dc192ad3x331x325.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9696e452d2fd46eea3e3456b4ec5fc54x720x1024.PNG"
    ]
  },
  {
    "text": "What is the most specific investigation of choice in bronchiectasis?",
    "choices": [
      {
        "id": 1,
        "text": "HRCT"
      },
      {
        "id": 2,
        "text": "CT-guided angiography"
      },
      {
        "id": 3,
        "text": "Angiography"
      },
      {
        "id": 4,
        "text": "Spiral CT"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>HRCT</strong>&nbsp;is the <strong>most specific </strong>investigation of choice in bronchiectasis.</p>\n<p>Bronchiectasis is abnormal irreversible dilatation of bronchi. It is caused by the destruction of smooth muscle and elastic tissue due to complications from infections, congenital conditions or autoimmune disorders.</p>\n<p>&nbsp;<strong>HRCT findings in bronchiectasis</strong></p>\n<ul>\n<li>The&nbsp;<strong>signet ring sign</strong>&nbsp;is seen when the dilated bronchus and accompanying pulmonary artery branch are seen in cross-section. The bronchus and artery should be the same size, whereas, in bronchiectasis, the bronchus is 1.5 times the size of the adjacent vessel. (As shown in the CT scan below)</li>\n<li><strong>Tree-in-bud&nbsp;pattern</strong> seen due to thickened secretions.</li>\n<li><strong>Tram track sign&nbsp;</strong>is seen due to lack of peripheral tapering of the bronchus.&nbsp;</li>\n<li><strong>String of beads appearance</strong>&nbsp;is seen as alternate dilatation and constriction in varicose bronchiectasis.&nbsp;</li>\n<li><strong>Cluster of grapes appearance&nbsp;</strong>is seen as cysts emanating from the bronchial wall in cystic bronchiectasis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/40862e3107164828aa776a7c38d7e47fx720x550.JPEG"
    ]
  },
  {
    "text": "Which of the following test is used to diagnose Meniere\u2019s disease?",
    "choices": [
      {
        "id": 1,
        "text": "Oto acoustic emission"
      },
      {
        "id": 2,
        "text": "Glycerol test"
      },
      {
        "id": 3,
        "text": "Caloric test"
      },
      {
        "id": 4,
        "text": "Dix Hallpike test"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The<strong> glycerol test </strong>is useful for the diagnosis of Meniere's disease</p>\n<p>Glycerol is an <strong>osmotic diuretic</strong> which when given orally <strong>reduces hydrops</strong> and <strong>improves symptoms</strong></p>\n<p><strong>Electrocochleography </strong>done along with a<strong> glycerol test (showing improvement after glycerol)</strong> is diagnostic of Meniere&rsquo;s disease.</p>\n<p>Other options</p>\n<div class=\"page\" title=\"Page 44\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 44\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Oto acoustic emissions&nbsp;</strong>(OAE) are low-intensity sounds produced by <strong>outer hair cells </strong>of a normal cochlea that can be elicited by a sensitive microphone. OAEs are present when outer hair cells are healthy and are absent when they are damaged and thus help to test the <strong>function of cochlea</strong>. They do not disappear in VIIIth nerve pathology as cochlear hair cells are normal.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p><strong>Caloric test</strong> though used in Meniere's disease is <strong>not diagnostic</strong> as it is abnormal in many other conditions like ototoxicity, vestibular schwannoma, vestibular neuritis, etc.</p>\n<p><strong>Dix Hallpike test</strong>&nbsp;is useful when a patient complains of <strong>vertigo</strong> in certain head positions. It also helps to differentiate a peripheral from a central lesion.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the best specimen to diagnose congenital cytomegalovirus infection?",
    "choices": [
      {
        "id": 1,
        "text": "Blood"
      },
      {
        "id": 2,
        "text": "Urine"
      },
      {
        "id": 3,
        "text": "Cerebrospinal fluid"
      },
      {
        "id": 4,
        "text": "Specimen of an organ such as liver, kidney"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Congenital CMV</strong> infection is diagnosed by <strong>detection of virus</strong> in the saliva or urine (<strong>saliva &gt; urine</strong>),<strong>\u00a0</strong>within the first two weeks of life.\u00a0</p>\n<p><strong>Congenital CMV </strong>infection occurs when a <strong>pregnant</strong> woman passes the cytomegalovirus to her <strong>unborn</strong> <strong>child</strong>. CMV is a common virus belonging to the <strong>herpesvirus</strong> family.</p>\n<p>Congenital CMV infection can occur when a pregnant woman is infected with CMV for the first time <strong>(primary infection)</strong> or when she experiences <strong>reactivation</strong> or <strong>reinfection</strong> with a different strain of the virus during pregnancy. The virus can be transmitted to the fetus through the placenta.</p>\n<p>The <strong>clinical manifestations </strong>are hepatosplenomegaly, petechial rashes, jaundice, chorioretinitis, and microcephaly. One of the long-term sequelae is sensorineural hearing loss.</p>\n<p><strong>Investigations:</strong></p>\n<ul>\n<li>Diagnosis can be made by the presence of <strong>IgM antibodies</strong> in the fetal blood. Isolation of the virus from the urine or blood by <strong>PCR</strong> is more sensitive.</li>\n<li>If <strong>culture</strong> is required then <strong>urine samples are better</strong> than saliva.</li>\n<li><strong>PCR</strong> assays\u00a0can be used to detect small amounts of <strong>CMV DNA</strong> in the urine.</li>\n</ul>\n<p>There is no definitive treatment for congenital CMV infection. Treatment with ganciclovir is indicated only in patients with progressive neurologic disease and deafness.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old male smoker presented with painless hematuria. The investigation of choice is ____.",
    "choices": [
      {
        "id": 1,
        "text": "Urine cytology"
      },
      {
        "id": 2,
        "text": "Plain X-ray KUB"
      },
      {
        "id": 3,
        "text": "USG KUB"
      },
      {
        "id": 4,
        "text": "Urine routine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Painless gross hematuria in an elderly man is indicative of<strong>&nbsp;</strong>benign prostatic hyperplasia (<strong>BPH</strong>). BPH is the <strong>most common cause of gross hematuria in the elderly</strong>. So, in this case, the&nbsp;investigation of choice is<strong>&nbsp;ultrasonography kidney-ureter-bladder (USG KUB)</strong>.</p>\n<p class=\"p1\">&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45 year old male presents with itchy papules over face, neck and V area of chest for last 3 years which are exacerbated in summers and improved in winters. What test can be done to confirm diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "IgE levels"
      },
      {
        "id": 2,
        "text": "Skin biopsy"
      },
      {
        "id": 3,
        "text": "Prick Test"
      },
      {
        "id": 4,
        "text": "Photopatch Test"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given history points towards <strong>Photoallergic Contact Dermatitis</strong>. <strong>Photopatch test</strong> is used to diagnose this.</p>\n<ul>\n<li>Photoallergic contact dermatitis is a <strong>delayed-type IV hypersensitivity</strong> reaction and has a similar presentation to other forms of allergic contact dermatitis but with a predilection for photo exposed&nbsp;sites, particularly during the initial stages.</li>\n<li>The dermatitis is localized to exposed areas of the skin, usually with <strong>well\u2010demarcated margins</strong> where the skin is covered by clothing, for example at the collar and &lsquo;V&rsquo; of the neck, below the end of sleeves on the backs of the hands and on the ankles below the trouser legs. Photo allergic contact dermatitis spares the skin behind earlobe (<strong>Wilkinson&rsquo;s triangle</strong>) since it is a photo-protected site.</li>\n</ul>\n<p><strong>Photopatch test:</strong>&nbsp;The main clinical indication includes the investigation of patients with <strong>eczematous rashes</strong> predominantly affecting<strong> light\u2010exposed sites</strong> and a <strong>history of worsening following sun exposure</strong>.</p>\n<ul>\n<li>Application of the allergens is done similar to conventional patch tests, except that they must be applied in<strong> duplicate</strong> &ndash; one set is irradiated and the other (the control) is not. Usually, the two sets of tests are applied on either side of the vertebral column at the same level.</li>\n<li>A <strong>positive reaction</strong> on the <strong>irradiated side</strong> only is an indication of photoallergy.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/2d3e4943a41c4015bf76b777a588a24dx340x185.JPEG"
    ]
  },
  {
    "text": "A 34-year-old HIV-positive male presented with low-grade fever, cough, night sweats, and weight loss for the past 3 weeks. In view of TB investigations, the Mantoux test was negative, chest X-ray showed non-specific findings and an adequate amount of sputum could not be collected for slide examination. Which of the following is used to diagnose latent TB infection in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "T-SPOT-TB"
      },
      {
        "id": 2,
        "text": "TrueNat TB test"
      },
      {
        "id": 3,
        "text": "Interferon gamma release assay"
      },
      {
        "id": 4,
        "text": "Lymph node biopsy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The test used to diagnose latent TB infection in this patient is<strong>&nbsp;</strong>the<strong> Interferon-gamma release assay(IGRA).</strong></p>\n<p>TB test done on a <strong>whole blood sample</strong> is IGRA. In this test, sensitized T lymphocytes (from whole blood) of suspected individuals, are exposed to highly specific M. tuberculosis antigens such as <strong>CFP &ndash;10</strong> and<strong> ESAT 6.</strong> This releases the cytokine IFN- gamma into the blood, which is then measured.&nbsp;It&nbsp;has been evaluated for the diagnosis of latent tuberculosis in HIV patients (who frequently have a negative Mantoux test.</p>\n<p>&nbsp;IGRAs that have been approved by the US (FDA) are</p>\n<ul>\n<li><strong>QuantiFERON-TB Gold In-Tube test (QFT-GIT):</strong> It quantitates the <strong>amount of interferon-gamma</strong> produced by CD4+ T cells in response to the antigens&nbsp;from&nbsp;Mycobacterium tuberculosis.</li>\n<li><strong>T-SPOT.TB test (T-Spot): </strong>It&nbsp;determines the total<strong> number of individual effector T cells</strong>&nbsp;expressing&nbsp;Interferon-gamma.</li>\n<li><strong>QuantiFERON-TB Gold Plus&nbsp;(QFT- Plus)</strong></li>\n</ul>\n<p><strong>IGRAs</strong>&nbsp;are&nbsp;<strong>more specific&nbsp;</strong>than Tuberculin Skin Testing (TST) because of less cross-reactivity to <strong>BCG vaccination</strong> and sensitization by&nbsp;<strong>nontuberculous mycobacteria</strong>.</p>\n<p>There are 3 described methods for tuberculin skin testing (TST):</p>\n<ul>\n<li>Mantoux test, also known as the Pirquet test (preferred method)</li>\n<li>Heaf test</li>\n<li>Tine test</li>\n</ul>\n<p>The <strong>TrueNat TB test</strong> is a new molecular test that can <strong>diagnose TB</strong>&nbsp;and&nbsp;<strong>resistance to rifampicin&nbsp;</strong>in one hour.&nbsp;This test uses a <strong>sputum</strong> sample and only about 0.5 ml of the sample is required.</p>\n<p><strong>Urine lipoarabinomannan (LAM) assay</strong> is used for the <strong>diagnosis of tuberculosis</strong>. Lipoarabinomannan (LAM) antigen is a lipopolysaccharide present in the mycobacterial cell wall, released from metabolically active cells or degenerating cells of patients having tuberculosis. Urine LAM is a useful tool in diagnosing tuberculosis, especially in patients with HIV and a low CD 4 count.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test- 26 (Investigation Of Choice)';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2024"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>