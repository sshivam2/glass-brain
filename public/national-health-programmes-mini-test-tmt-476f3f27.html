<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>National Health Programmes Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The provision of 100% biodegradable sanitary napkins for Rs.1 per pad at Janaushadhi Kendras under the Pradhan Mantri Bhartiya Janaushadhi Pariyojana is known as?",
    "choices": [
      {
        "id": 1,
        "text": "Suvidha"
      },
      {
        "id": 2,
        "text": "Freedays"
      },
      {
        "id": 3,
        "text": "Saathiya"
      },
      {
        "id": 4,
        "text": "Sabla"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Suvidha</strong>&nbsp;is the program aimed at the&nbsp;<strong>provision </strong>of<strong> 100% biodegradable sanitary napkins </strong>under&nbsp;<strong>Pradhan Mantri Bhartiya Janaushadhi Pariyojana</strong>.</p>\n<p>Low-cost hygienic oxy-biodegradable sanitary napkins were made available for <strong>Rs.1</strong>&nbsp;<strong>per pad</strong> at&nbsp;over 7,900<strong>&nbsp;Janaushadhi Kendras </strong>for the underprivileged women of India. The program aims to&nbsp;ensure &lsquo;<strong>Swachhta, Swasthya, and Suvidha</strong>' for underprivileged women and&nbsp;to <strong>improve menstrual hygiene practices</strong> throughout the country.</p>\n<p>Other options:</p>\n<p>Option B:&nbsp;<strong>Freedays&nbsp;</strong>is<strong>&nbsp;</strong>the provision of a pack of<strong> 6 sanitary napkins </strong>for<strong> 6 Rupees&nbsp;</strong>by the <strong>ASHA</strong> worker through the&nbsp;<strong>Menstrual Hygiene Scheme</strong>&nbsp;under the&nbsp;Rashtriya<strong> Kishor Swasthya Karyakram</strong> (RKSK).</p>\n<p>Option C:&nbsp;<strong>Saathiya</strong>&nbsp;is a government initiative launched to provide a platform for<strong> communication </strong>regarding<strong> adolescent age-related health issues.&nbsp;</strong>Saathiya, meaning <strong>a good friend</strong>, are <strong>peer educators</strong> trained by the government with the help of the <strong>Saathiya salah mobile application</strong>. These Saathiyas act as a catalyst for generating demand for adolescent health services and imparting age-appropriate knowledge on key adolescent health issues to their peer groups.</p>\n<div class=\"page\" title=\"Page 656\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Option D:&nbsp;<strong>Sabla</strong> is an <strong>empowerment</strong> scheme for <strong>adolescent girls</strong> of age group 11 to 18 years to improve their <strong>nutritional </strong>and<strong> health status</strong> under the&nbsp;<strong>Integrated child development services scheme </strong>(ICDS).</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "As a PHC medical officer, you learn that your region recorded an Annual parasite index (API) of 2.1. Which of the following measures would you take to ensure personal protection for the residents under the Integrated Vector Management (IVM) against malaria?",
    "choices": [
      {
        "id": 1,
        "text": "No need for any measures as the district is a low risk area"
      },
      {
        "id": 2,
        "text": "Larvivorous fish and larvicides along with Long Lasting Insecticide Nets provision"
      },
      {
        "id": 3,
        "text": "Conventional insecticide treated bed nets are supplied"
      },
      {
        "id": 4,
        "text": "Long Lasting Insecticide Nets are provided"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Under the Integrated Vector Management initiative, <strong>conventional</strong>&nbsp;<strong>insecticide-treated bed nets&nbsp;</strong>are supplied in <strong>endemic areas</strong> with Annual Parasite Index (<strong>API</strong>)&nbsp;<strong>&ge;2</strong>.</p>\n<p>The&nbsp;<strong>annual parasite index</strong>&nbsp;(API) is used to categorize<strong>&nbsp;</strong>regions&nbsp;under the&nbsp;<strong>national framework for malaria elimination</strong>&nbsp;in India.&nbsp;API&nbsp;is based on the number of&nbsp;<strong>slide-confirmed cases</strong>&nbsp;that are found through <strong>active </strong>and <strong>passive surveillance</strong>. It is a measure of&nbsp;<strong>malaria</strong>&nbsp;<strong>incidence</strong>&nbsp;in a community and helps in determining the <strong>burden</strong> of the disease.&nbsp;Each district should stratify its PHCs and sub-centers (with their population) into the following five strata:</p>\n<div class=\"page\" title=\"Page 456\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ol>\n<li>Zero cases</li>\n<li>API &gt; 0 to &lt; 1</li>\n<li>API 1 to &lt; 2</li>\n<li>API 2 to&lt;5</li>\n<li>API 5</li>\n</ol>\n</div>\n</div>\n</div>\n<p>Regions with <strong>API &ge;&nbsp;2</strong>&nbsp;are considered&nbsp;<strong>high-risk areas</strong> and are <strong>eligible </strong>for <strong>vector control</strong>.<strong> Conventional</strong>&nbsp;<strong>insecticide-treated bed nets&nbsp;</strong>are supplied in <strong>endemic areas</strong> with Annual Parasite Index (<strong>API</strong>)&nbsp;<strong>&ge;2</strong>. Long Lasting Insecticide Nets (<strong>LLIN</strong>) are provided in areas with Annual Parasite Index (<strong>API</strong>)&nbsp;<strong>&ge;5</strong>.</p>\n<p>Integrated Vector Management (IVM) for Malaria Elimination:</p>\n<p><strong>For adult mosquitoes:</strong></p>\n<ul>\n<li><strong>Indoor Residual Sprays</strong> (<strong>IRS</strong>) are used as the main method of vector control in <strong>rural</strong> areas.&nbsp;<strong>DDT</strong> is the insecticide of choice.</li>\n<li>Two rounds of spraying are done with DDT, and in DDT-resistant areas, three rounds of spraying are done with malathion.</li>\n</ul>\n<p><strong>For larvae:&nbsp;</strong></p>\n<ul>\n<li><strong>Larvivorous fish </strong>and<strong> larvicides</strong> are used.&nbsp;This is the main method of vector control in <strong>urban</strong> areas.</li>\n</ul>\n<p><strong>For personal protection:</strong>&nbsp;</p>\n<ul>\n<li><strong>Insecticide-treated bed nets</strong> are supplied in areas with <strong>API</strong>&nbsp;<strong>&ge;2</strong>.</li>\n<li><strong>Long-Lasting Insecticide Nets</strong> (LLIN) are provided in areas with <strong>API&nbsp;&ge;5</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which component of the National AIDS Control Program does the image signify?",
    "choices": [
      {
        "id": 1,
        "text": "ART (Anti-Retroviral Therapy)"
      },
      {
        "id": 2,
        "text": "PPTCT (Prevention of Parent To Child Transmission)"
      },
      {
        "id": 3,
        "text": "ICTC (Integrated Counselling and Testing Centre)"
      },
      {
        "id": 4,
        "text": "NACO ( National AIDS Control Organization)"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The logo signifies Prevention of <strong>Parent to Child Transmission(PPTCT).</strong> The program was launched in 2002</p>\n<p>Under this program <strong>pregnant women</strong> are provided with counselling and testing in the Integrated <strong>Counselling and Testing</strong> Centre (<strong>ICTC</strong>).</p>\n<p>This program aims to <strong>prevent perinatal transmission of HIV from an infected pregnant mother to her newborn baby.</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4c9fe7735f104d8ebf1e19303811dc05x720x775.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true about Pradhan Mantri Poshan Shakti Nirman (PM POSHAN)?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, and 3"
      },
      {
        "id": 2,
        "text": "1 and 2"
      },
      {
        "id": 3,
        "text": "4 and 5"
      },
      {
        "id": 4,
        "text": "1, 4, and 5"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Pradhan Mantri Poshan Shakti Nirman</strong> (PM POSHAN) previously known as <strong>Mid-Day Meal Scheme\u00a0</strong>(Statement 2), is a <strong>centrally sponsored</strong> scheme that provides <strong>one hot cooked meal</strong> in Government and Government-aided Schools (Statement 1).</p>\n<p>Under the Scheme, there is a provision of <strong>hot cooked meal</strong>\u00a0to all\u00a0<strong>preschool children</strong> and <strong>also</strong>\u00a0to children of<strong>\u00a0classes I to VIII </strong>(Statement 3).\u00a0The scheme is implemented across the country covering all the eligible children <strong>without any discrimination</strong> of <strong>gender</strong> and social class. The main objective is to improve <strong>hunger</strong> and <strong>education</strong> by:</p>\n<ul>\n<li>Providing\u00a0<strong>hot-cooked meals</strong> in <strong>government</strong> and <strong>government-aided schools.</strong></li>\n<li><strong>Attend school</strong> more <strong>regularly</strong> and concentrate on school activities.</li>\n</ul>\n<p><strong>Statements 4 </strong>and<strong> 5</strong> are related targets under <strong>POSHAN</strong>\u00a0<strong>Abhiyaan</strong> /<strong>National Nutrition Mission</strong>(\u00a0<strong>NNM</strong>) which is <strong>different</strong> from\u00a0Pradhan Mantri Poshan Shakti Nirman (PM POSHAN).\u00a0</p>\n<p><strong>Prime Minister\u2019s Overarching Scheme for Holistic Nourishment</strong>\u00a0(POSHAN) Abhiyaan\u00a0is a flagship program of the\u00a0Ministry of Women and Child Development (MWCD), with a goal to achieve an improvement in<strong>\u00a0</strong>the<strong>\u00a0nutritional status</strong>\u00a0of <strong>children</strong> in the first 1000 days of life, <strong>pregnant women</strong>, and <strong>lactating mothers</strong>. It targets to reduce\u00a0<strong>stunting, underweight,\u00a0</strong>and<strong>\u00a0low birth weight by 2% per annum\u00a0</strong>(Statement 4).\u00a0The target for the reduction in\u00a0<strong>anemia</strong>\u00a0among\u00a0<strong>young children</strong> (Statement 5),<strong>\u00a0</strong>and<strong>\u00a0adolescent girls </strong>is <strong>3% per annum</strong>.</p>\n<p>The following images depicts the logo and targets of\u00a0POSHAN\u00a0Abhiyaan:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/765005b4a22f4730a23b4cd9b45b4dfbx257x196.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fdd2a89171c0476594eb6407a2e72a06x928x649.PNG"
    ]
  },
  {
    "text": "Nischay kit provided by the government to ASHA under NRHM is used for?",
    "choices": [
      {
        "id": 1,
        "text": "Pregnancy testing"
      },
      {
        "id": 2,
        "text": "Safe delivery at home"
      },
      {
        "id": 3,
        "text": "Rapid sputum analysis for tuberculosis"
      },
      {
        "id": 4,
        "text": "Rapid diagnosis of malaria"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Nischay kit</strong> provided by the government to ASHA under NRHM is used for early <strong>pregnancy testing</strong>.</p>\n<p><strong>Nishchay</strong> is a <strong>home-based Pregnancy Test Kit</strong> (PTK) that was launched under <strong>NRHM</strong> across the country and was later anchored with the <strong>Family Planning Division</strong>.&nbsp;The pregnancy test kits are being made available at the <strong>sub-center level</strong> and are also distributed to&nbsp;<strong>ASHA</strong>.</p>\n<p>These pregnancy test kits are supplied<strong> free of cost</strong>&nbsp;and are home-based and easy to use. It facilitates&nbsp;<strong>early detection</strong> and also&nbsp;<strong>decision-making</strong> for the outcomes of pregnancy.&nbsp;Helping to detect pregnancy as early as one week after the missed period, provides an <strong>early opportunity </strong>for <strong>medical termination of pregnancy</strong>, thus saving lives lost to unsafe abortions.</p>\n<p>Note:<strong> NIKSHAY</strong> is an <strong>online tool</strong> launched by the government <strong>for RNTCP to monitor tuberculosis</strong> in the country.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is not true regarding the benefits under Ayushman Bharat - Pradhan Mantri Jan Arogya Yojana (PM-JAY)?",
    "choices": [
      {
        "id": 1,
        "text": "Pre-existing diseases are not covered"
      },
      {
        "id": 2,
        "text": "It provides health insurance of upto Rs. 5,00,000 per family per year"
      },
      {
        "id": 3,
        "text": "No cap on family size and age of members"
      },
      {
        "id": 4,
        "text": "Cashless and paperless access to quality health care services"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Under <strong>Ayushman Bharat - Pradhan Mantri Jan Arogya Yojana </strong>(PM-JAY), all&nbsp;<strong>pre-existing diseases </strong>are also&nbsp;<strong>covered. </strong>Hospitals <strong>cannot deny </strong>treatment.</p>\n<p><strong>Ayushman Bharat - Pradhan Mantri Jan Arogya Yojana </strong>(PM-JAY), the largest <strong>health assurance scheme</strong> in the world which aims at providing a health cover of <strong>Rs. 5 lakhs per family per year</strong> for<strong> secondary </strong>and<strong> tertiary care</strong>&nbsp;across public and private empanelled hospitals in India, to over 12 crores poor and vulnerable families&nbsp;</p>\n<p>Benefits under the scheme:</p>\n<ul>\n<li>The government provides health<strong> insurance</strong> <strong>coverage</strong> of up to <strong>Rs. 5,00,000</strong> per <strong>family per year</strong>(Option B).</li>\n<li>All families listed in the Socio-Economic Caste Census (SECC) database as per the defined criteria will be covered. <strong>No cap </strong>on<strong> family size </strong>and <strong>age of members&nbsp;</strong>(Option C).</li>\n<li>Priority is given to a girl child, women, and senior citizens.</li>\n<li><strong>Free treatment</strong> is available at<strong> all public </strong>and<strong> empaneled private hospitals </strong>in times of need.</li>\n<li>It covers <strong>secondary and tertiary care </strong>hospitalization.</li>\n<li><strong>1,929 procedures</strong>&nbsp;covering surgery, medical and daycare treatments, the cost of medicines, and diagnostics.</li>\n<li>It covers up to <strong>3 days</strong> of <strong>pre-hospitalization</strong> and <strong>15 days</strong>&nbsp;of&nbsp;<strong>post-hospitalization</strong> expenses such as diagnostics and medicines</li>\n<li>All <strong>pre-existing diseases </strong>are <strong>covered. </strong>Hospitals <strong>cannot deny </strong>treatment.</li>\n<li><strong>Cashless</strong> and <strong>paperless</strong> access to quality health care services (Option D).</li>\n<li>Hospitals will <strong>not</strong> be allowed to <strong>charge</strong> any<strong> additional money</strong> from beneficiaries for the treatment.</li>\n<li>A <strong>24X7 helpline</strong> number is available for information, assistance, complaints, and grievances.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2c91218fbfc947b5b10d7bc5c40d6599x814x470.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3a35c805d486404dba97c8ff60f2c680x720x386.JPEG"
    ]
  },
  {
    "text": "Which of the following measures are followed under NVBDCP (National vector-borne disease control program) to eliminate kala-azar?",
    "choices": [
      {
        "id": 1,
        "text": "1 only"
      },
      {
        "id": 2,
        "text": "4 and 5 only"
      },
      {
        "id": 3,
        "text": "2 and 4"
      },
      {
        "id": 4,
        "text": "2, 3 and 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Among the given options<strong>&nbsp;rK39 rapid diagnostic kits</strong> and&nbsp;<strong>spraying</strong>&nbsp;with insecticides such as<strong>&nbsp;pyrethroid&nbsp;</strong>are&nbsp;used&nbsp;to eliminate kala-azar under <strong>NVBDCP</strong>.</p>\n<p><strong>National Vector Borne Disease Control Programme (NVBDCP)</strong>&nbsp;is a national health program that comes under the ministry of health and family welfare headed by the director-general of health services&nbsp;(DGHS). It works for the<strong> prevention </strong>and <strong>control</strong> of the following vector-borne diseases:</p>\n<ul>\n<li><strong>Malaria</strong></li>\n<li><strong>Chikungunya</strong></li>\n<li><strong>Dengue</strong></li>\n<li><strong>Filariasis</strong></li>\n<li><strong>Japanese encephalitis</strong></li>\n<li><strong>Kala-azar&nbsp;</strong></li>\n</ul>\n<p>Strategies for prevention and control of Kala-azar under NVBDCP:</p>\n<div class=\"page\" title=\"Page 460\">\n<div class=\"page\" title=\"Page 460\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Enhanced case detection through the introduction of <strong>rK39 rapid diagnostic kits&nbsp;</strong>(Statement 2)</li>\n<li>Complete treatment by oral drug <strong>Miltefosine</strong>.&nbsp;</li>\n<li>Interruption of transmission through vector(sandfly) control by <strong>spraying</strong>/fogging with <strong>insecticides</strong> such as <strong>synthetic pyrethroid&nbsp;</strong>(Statement 4)</li>\n<li>Incentives to:\n<ul>\n<li><strong>ASHAs</strong> as Rs. 300 for identifying each case of kala-azar, Rs. 100 for ensuring one round, and Rs. 200 for two rounds of insecticide spraying.&nbsp;</li>\n<li><strong>The patient</strong> being treated in the hospital as Rs. 500 for compensation of daily wage for the time he spends in the hospital during the treatment for kala-azar and Rs. 2,000 for PKDL.</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 460\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Other options:</p>\n<p>Statements 1 &amp; 5: Distribution of <strong>mosquito&nbsp;nets</strong> is done to control <strong>mosquito-borne diseases</strong> and not&nbsp;<strong>kala-azar. Kala-azar</strong>&nbsp;is <strong>transmitted by</strong> the&nbsp;<strong>sand flies</strong>&nbsp;which are much<strong> smaller</strong> than mosquitoes and therefore <strong>can pass through</strong> smaller <strong>holes </strong>in the<strong>&nbsp;bed net</strong>.</p>\n<p>Statement 3: There is <strong>no available vaccine</strong> for kala-azar and hence mass immunization is not used in the control of kala-azar.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The Chest X-ray of a presumptive TB patient who presented with a dry cough and weight loss is suggestive of TB, but the sputum examination is negative. As per the National Tuberculosis Elimination Programme guidelines, what should be the next step in management?",
    "choices": [
      {
        "id": 1,
        "text": "Repeat Sputum smear"
      },
      {
        "id": 2,
        "text": "Start ATT empirically"
      },
      {
        "id": 3,
        "text": "Do CB-NAAT"
      },
      {
        "id": 4,
        "text": "Give antibiotics and repeat chest X-ray"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A patient with a<strong> suggestive CXR</strong> but<strong> sputum smear-negative</strong> should undergo a <strong>CB-NAAT</strong> as the next step in management.</p>\n<p><strong>CB NAAT </strong>(Cartridge Based Nucleic Acid Amplification Test)&nbsp;provides a&nbsp;<strong>rapid</strong> and accurate diagnosis of TB&nbsp;by&nbsp;detecting Mycobacterium tuberculosis and mutations responsible for rifampicin resistance. It can be used for&nbsp;<strong>sputum</strong> samples as well as samples from <strong>extrapulmonary</strong> sites.&nbsp;It is done when the <strong>smear </strong>is<strong> negative</strong> for TB but the <strong>chest X-ray </strong>is<strong> suggestive</strong> of tuberculosis and also in some cases smear is negative and the chest X-ray is not suggestive of TB but there is a <strong>high index of clinical suspicion</strong>.</p>\n<p>It is mainly used for diagnosis of<strong> DR-TB </strong>in presumptive DR-TB patients and TB preferentially in the key population such as children, PLHIV, extra-pulmonary TB, and in smear-negative TB as per the diagnostic algorithm.&nbsp;</p>\n<p>Diagnostic algorithm for pulmonary TB:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4dfd178c990b48ffaf876a6cb24cf77cx795x446.PNG"
    ]
  },
  {
    "text": "The given logo belongs to which of the following programmes?",
    "choices": [
      {
        "id": 1,
        "text": "Rashtriya Kishor Swasthya Karyakram"
      },
      {
        "id": 2,
        "text": "National Programme for Prevention and Control of Non-Communicable Diseases"
      },
      {
        "id": 3,
        "text": "Ayushman Bharat-National Health Protection Mission"
      },
      {
        "id": 4,
        "text": "Family Planning Campaign"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows the logo of the <strong>National Programme for Prevention &amp; Control of Non-Communicable Diseases (NP-NCD)</strong>, which was earlier called the National Programme for Prevention and Control of Cancer, Diabetes, Cardiovascular Disease, and Stroke (NPCDCS).</p>\n<p><strong>NPCDCS</strong> was launched in 2010 in order to prevent and control<strong> major</strong> <strong>NCDs </strong>(<span data-preserver-spaces=\"true\">non-communicable diseases). It</span>\u00a0focuses on strengthening infrastructure, human resource development, health promotion,<strong> early diagnosis</strong>, <strong>management,</strong> and <strong>referral</strong>. <strong>NCD Clinics</strong> are being set up at <strong>District</strong> and <strong>CHC levels</strong>, to provide services for early diagnosis, treatment, and follow-up for common NCD.\u00a0<span data-preserver-spaces=\"true\">NP-NCD has </span><strong><span data-preserver-spaces=\"true\">specialized facilities </span></strong>at the\u00a0<strong><span data-preserver-spaces=\"true\">district hospital </span></strong>level<span data-preserver-spaces=\"true\">.\u00a0</span>At the\u00a0<strong>subcentre</strong> level, <strong>screening</strong>\u00a0and\u00a0<strong>referral</strong>\u00a0are done.</p>\n<p><span data-preserver-spaces=\"true\">The NP-NCD has <strong>separate components</strong> for <strong>cancer</strong> and other non-communicable diseases like <strong>diabetes</strong>, and <strong>stroke</strong>. It has been implemented in over 100 districts in 21 states.\u00a0</span>For the <strong>cancer component</strong>, there is the <strong>Tertiary Care Cancer Centers (TCCC) scheme</strong>, which aims at setting up/strengthening <strong>State Cancer Institutes (SCI)</strong> and <strong>TCCCs</strong> all over the country, to provide <strong>comprehensive cancer care</strong> in the country.\u00a0</p>\n<p>Note: <strong>Non-alcoholic fatty liver disease</strong> (NAFLD) has been integrated with this programme in 2021.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a59e666df31b4b51aa05c9a14b4795c9.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f125b0e0719840d08bf9a6582cd90b7ex406x319.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/54c4c07df79241b9a8436e77e4e23da6x188x269.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5f910c2d4aab4bd4805d88d3e3215e01x814x470.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5be72571b06b44078b79d52070006dc9x720x491.JPEG"
    ]
  },
  {
    "text": "As a PHC officer, you received blue color tablets containing 60 mg of elemental iron and 500 mcg of folic acid under the Anemia Mukt Bharat scheme. These tablets can be given to which of the following beneficiaries under this programme?",
    "choices": [
      {
        "id": 1,
        "text": "Children of age 5-9 years"
      },
      {
        "id": 2,
        "text": "Out-of-school adolescent girls"
      },
      {
        "id": 3,
        "text": "Children 6-59 months of age"
      },
      {
        "id": 4,
        "text": "Lactating Mothers of 0-6 months child"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given beneficiaries, <strong>blue&nbsp;color</strong> tablets containing&nbsp;<strong>60 mg</strong> of elemental <strong>iron</strong> and <strong>500 mcg</strong> of <strong>folic acid</strong> can be given to&nbsp;<strong>out-of-school adolescent girls&nbsp;</strong>according to the <strong>Anemia Mukt Bharat scheme</strong>.</p>\n<p><strong>Blue&nbsp;color</strong> tablets containing&nbsp;<strong>60 mg</strong> of elemental <strong>iron</strong> and <strong>500 mcg</strong> of <strong>folic acid</strong> can be given to <strong>school-going</strong> adolescent <strong>girls</strong> and <strong>boys</strong> of 10-19 years and <strong>out-of-school adolescent girls</strong> of age 10-19 years. <strong>Out-of-school adolescent boys</strong> are <strong>not&nbsp;beneficiaries</strong> of the scheme.</p>\n<p><strong>Children&nbsp;</strong>between<strong>&nbsp;5-9 years of age</strong> (Option A)are given <strong>pink color</strong> sugar-coated tablets containing&nbsp;<strong>45 mg </strong>of elemental <strong>iron </strong>and<strong> 400 mcg </strong>of<strong> folic acid</strong>&nbsp;tablets&nbsp;<strong>once a&nbsp;week</strong>.</p>\n<p><strong>Children</strong> of age <strong>6-59 months</strong> are given <strong>bi-weekly syrup </strong>containing <strong>20 mg</strong>&nbsp;elemental<strong>&nbsp;iron&nbsp;</strong>+<strong>&nbsp;100 mcg</strong>&nbsp;of<strong> folic acid.&nbsp;</strong>(Option C)</p>\n<p><strong>Lactating mothers</strong> of 0-6 month-old children (Option D) are given a&nbsp;<strong>daily dose</strong>&nbsp;of <strong>60 mg</strong> of elemental iron and <strong>500</strong>&nbsp;<strong>mcg</strong> of folic acid.&nbsp;These&nbsp;<strong>tablets</strong>&nbsp;are&nbsp;sugar-coated and <strong>red</strong>&nbsp;in color.</p>\n<p>The <strong>Anemia Mukt Bharat scheme</strong>&nbsp;is an initiative that aims to <strong>strengthen</strong> the existing mechanisms and foster newer strategies for <strong>tackling anemia</strong>. It focuses on <strong>six</strong> <strong>target</strong> <strong>beneficiary</strong> <strong>groups</strong>, through <strong>six interventions</strong> and <strong>six institutional</strong> mechanisms to achieve their target by 2022.</p>\n<p>Interventions include:</p>\n<ul>\n<li>Prophylactic <strong>iron </strong>and<strong> folic acid</strong> supplementation.</li>\n<li><strong>Deworming.</strong></li>\n<li>Intensified year-round Behaviour Change Communication Campaign (Solid Body, Smart Mind) including ensuring<strong> delayed cord clamping</strong> in newborns.</li>\n<li><strong>Testing</strong> of <strong>anemia</strong> using digital methods and point-of-care treatment.</li>\n<li>Mandatory provision of Iron and Folic Acid <strong>fortified foods</strong> in government-funded health programs.</li>\n<li>Addressing <strong>non-nutritional</strong> <strong>causes</strong> of anemia in endemic pockets, with a special focus on malaria, hemoglobinopathies, and fluorosis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not included under the Janani Shishu Suraksha Karyakram (JSSK)?",
    "choices": [
      {
        "id": 1,
        "text": "Free treatment for sick newborns"
      },
      {
        "id": 2,
        "text": "Free vaccination for newborns"
      },
      {
        "id": 3,
        "text": "Free Transport between facilities in case of referral"
      },
      {
        "id": 4,
        "text": "Free provision of blood"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Free vaccination</strong> for <strong>newborns&nbsp;</strong>is <strong>not</strong> included&nbsp;under the <strong>Janani Shishu Suraksha Karyakram</strong> (JSSK). The JSSK includes provisions for <strong>pregnant women</strong> and <strong>sick newborns</strong> till <strong>30 days</strong> after birth.&nbsp;</p>\n<p>The JSSK provides&nbsp;<strong>free transport</strong>&nbsp;for&nbsp;<strong>pregnant women&nbsp;</strong>and<strong>&nbsp;sick infants</strong>&nbsp;from:</p>\n<ul>\n<li>home to the health facilities</li>\n<li>between facilities in case of a referral</li>\n<li>back home from the health facilities</li>\n</ul>\n<p>The provisions of JSSK include:</p>\n<ul>\n<li><strong>Free transport</strong> for pregnant women and sick infants</li>\n<li><strong>Free treatment</strong> for pregnant women and sick infants</li>\n<li>Free drugs and consumables for&nbsp;pregnant women and sick infants</li>\n<li>Free diagnostics for&nbsp;pregnant women and sick infants</li>\n<li>Free diet provisions for pregnant women</li>\n<li>Free and cashless delivery for&nbsp;pregnant women and sick infants</li>\n<li>Free C-Section for pregnant women</li>\n<li><strong>Free provision of blood</strong> for&nbsp;pregnant women and sick infants</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A newly pregnant woman from a rural area registered in the scheme shown below. Which of the following benefits would she receive under this scheme?",
    "choices": [
      {
        "id": 1,
        "text": "A cash incentive of 5000 rupees"
      },
      {
        "id": 2,
        "text": "At least 4 antenatal checkups and 6 homebased newborn care visits"
      },
      {
        "id": 3,
        "text": "Free checkup on 9th of every month"
      },
      {
        "id": 4,
        "text": "A cash incentive of 1400 rupees"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above image shows the logo of\u00a0<strong>Pradhan Mantri Surakshit Matritva Abhiyan</strong> (PMSMA). Under this scheme, all pregnant women will receive a <strong>free checkup</strong> on the <strong>9th </strong>of<strong> every month</strong>.</p>\n<p>PMSMA aims to improve the quality and coverage of antenatal care, diagnostics, and counseling services. This is undertaken as part of the <strong>reproductive maternal neonatal child and adolescent health</strong> (RMNCH+A) strategy. Under PMSMA, a pregnant woman receives<strong> at least 1 check-up</strong> in her <strong>second</strong> or <strong>third trimester</strong> by a doctor in the PMSMA clinic, on the 9th of every month.</p>\n<p>After routine examination, pregnant women are categorized according to the risk factors, and different <strong>colored</strong> <strong>stickers</strong> are given as follows:</p>\n<ul>\n<li><strong>Green</strong> sticker: For women with <strong>no</strong> detected <strong>risk factor</strong></li>\n<li><strong>Red </strong>sticker<strong>: </strong>For women with<strong> detected risk factor</strong></li>\n</ul>\n<p>Other options:</p>\n<p>Option A: A cash incentive of <strong>5000 rupees</strong> is provided to all pregnant women and lactating mothers under <strong>Pradhan Mantri Matru Vandana Yojana</strong> (PMMVY) for the first living child of the family. This is subject to fulfillment of specific conditions.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/527eee60bc6f4d25a950462d349ad1b2.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fb4ae2bda8f546c8a2ffd9e15602f705x102x100.PNG"
    ]
  },
  {
    "text": "Which of the following is not a component under the scheme shown in the logo below?",
    "choices": [
      {
        "id": 1,
        "text": "2 and 4"
      },
      {
        "id": 2,
        "text": "2, 3, and 4"
      },
      {
        "id": 3,
        "text": "3, 4, and 5"
      },
      {
        "id": 4,
        "text": "2 and 3"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The logo in the above image is of the&nbsp;<strong>Integrated child development services scheme (ICDS)</strong>.&nbsp;Rashtriya Kishor Swasthya Karyakram (RKSK)(Statement 2) and&nbsp;Rashtriya Bal Swasthya Karyakram (RBSK)(Statement 4) are interventions under the National Health Mission (NHM), not ICDS.</p>\n<p><strong>Integrated child development services</strong>&nbsp;was launched on the 2nd of October, 1975, and focuses on&nbsp;<strong>early childhood care </strong>and<strong> development</strong>. The scheme helps in providing&nbsp;<strong>preschool non-formal education</strong>&nbsp;(Statement 1) and breaking the vicious cycle of <strong>malnutrition</strong>, morbidity, reduced learning capacity, and mortality. Beneficiaries under the scheme include <strong>children</strong> in the age group of <strong>0-6</strong> years, <strong>pregnant</strong> women, and <strong>lactating</strong> mothers.</p>\n<p>The&nbsp;<strong>Kishori Shakti Yojana</strong> (KSY) (Statement 3) and <strong>Nutrition Programme for Adolescent Girls</strong> (Statement 4) are two schemes for <strong>adolescent girls</strong> under <strong>ICDS</strong>.</p>\n<p><strong>Kishori Shakti Yojana</strong> targets <strong>adolescent girls</strong> in the age group of <strong>11 to 18 years</strong> and addresses their needs of <strong>self-development</strong>, nutrition and health status, literacy and numerical skills, vocational skills, etc.</p>\n<p><strong>Nutrition Programme for Adolescent Girls</strong> targets <strong>undernourished adolescent girls</strong> in the age group of <strong>11 to 19 years</strong> (with body weight less than 30 kg in the age group of 11 to 15 years and 35 kg in the age group of 15 to 19 years). 6 kg of free food grain is provided to each beneficiary per month.</p>\n<p><strong>Rashtriya Bal Swasthya Karyakram</strong> (RBSK), an ambitious initiative, launched under the National Health Mission (NHM) launched envisages&nbsp;<strong>early screening</strong> and<strong> early intervention</strong> for children from <strong>birth to 18 years</strong>. It aims at the universal screening of the&nbsp;<strong>4 &lsquo;D&rsquo;s,&nbsp;</strong>i.e.<strong>&nbsp;Defects at birth, Deficiencies, Diseases, Developmental delays, including disabilities,&nbsp;</strong>that would lead to early identification, timely management, and ultimately a reduction in morbidity, mortality, and lifelong disability in children.</p>\n<p><strong>Rashtriya Kishor Swasthya Karyakram (RKSK) </strong>launched under <strong>NHM</strong> ensures holistic development of the <strong>adolescent</strong> population&nbsp;(<strong>10-19 years</strong>).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/40c8e3055155413e93e5b0cc928bef3b.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "During a rural health camp, a 21-year-old woman comes with a history of cough and breathlessness for a year. She gives a history of using firewood for cooking. No other significant co-morbidities were reported. You suspect the symptoms to be due to exposure to indoor pollution. Which among these initiatives, would be most appropriate for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "UJALA"
      },
      {
        "id": 2,
        "text": "Ujjawala"
      },
      {
        "id": 3,
        "text": "Ujjwala"
      },
      {
        "id": 4,
        "text": "INSPIRE"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most relevant scheme for this patient experiencing the ill effects of using firewood for cooking would be the <strong>Ujjwala Yojana</strong>.&nbsp;</p>\n<p>The&nbsp;<strong>Ujjwala Yojana</strong>&nbsp;(<strong>note spelling without \"a\"</strong>) is for providing 5 crore <strong>free cooking (LPG) connections</strong> to all families below the poverty line.</p>\n<p>The <strong>UJALA Scheme</strong> (Unnat Jyoti by Affordable LEDs for All) is the largest domestic lighting project, launched under the Ministry of Power. It aims at <strong>promoting</strong> the use of <strong>energy-efficient LED bulbs</strong> in every household in the country.</p>\n<p>The <strong>Ujjawala Scheme</strong> is for the&nbsp;<strong>prevention of</strong> <strong>trafficking</strong> and for the rescue, rehabilitation, and reintegration of victims of trafficking for commercial sexual exploitation.</p>\n<p><strong>INSPIRE&nbsp;</strong>strategy is a set of 7 evidence-based strategies introduced to select, implement, monitor, and evaluate effective policies, programs, and services to&nbsp;<strong>prevent</strong>&nbsp;and respond to&nbsp;<strong>violence against children.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of these vaccines is not covered in the programme mentioned below?",
    "choices": [
      {
        "id": 1,
        "text": "Diphtheria"
      },
      {
        "id": 2,
        "text": "Polio"
      },
      {
        "id": 3,
        "text": "Measles"
      },
      {
        "id": 4,
        "text": "Typhoid"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given logo represents<strong> Mission Indradhanush</strong>&nbsp;and it does <strong>not</strong> include the <strong>typhoid</strong> vaccine.</p>\n<p><strong>Mission Indradhanush</strong>&nbsp;was launched by the Ministry of Health and Family Welfare in 2014 to fully immunize children (&gt;90%) who are either partially immunized or completely unimmunized by 2020. It was later modified in 2017 to the Intensified Mission Indradhanush. The Intensified Mission Indradhanush (IMI) includes&nbsp;<strong>12 vaccine-preventable diseases</strong>&nbsp;(updated from the 7 diseases that Mission Indradhanush focussed on).&nbsp;<strong>4 rounds&nbsp;</strong>of immunization&nbsp;are proposed to be held for&nbsp;<strong>7 days each month</strong>&nbsp;(from the 7th- 13th of each month).</p>\n<p>The diseases included in&nbsp;<strong>Mission Indradhanush</strong>&nbsp;are:</p>\n<ul>\n<li>TB (BCG vaccine)</li>\n<li><strong>Polio</strong></li>\n<li>Hep B</li>\n<li><strong>Diphtheria</strong></li>\n<li>Pertussis</li>\n<li>Tetanus</li>\n<li><strong>Measles</strong></li>\n</ul>\n<p>The diseases included recently in&nbsp;<strong>Intensified Mission Indradhanush</strong>&nbsp;are:</p>\n<ul>\n<li><strong>Rotavirus</strong></li>\n<li><strong>Rubella </strong>(as <strong>MR </strong>vaccine)</li>\n<li><strong><em>Haemophilus influenzae</em>&nbsp;<em>B&nbsp;</em></strong>(as part of the <strong>pentavalent </strong>vaccine)</li>\n<li><strong>Pneumococcal meningitis</strong></li>\n<li><strong>Japanese encephalitis</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1b47712efb1a44f68ec83990d2178ccf.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not an initiative under the Employees' state insurance (ESI) scheme?",
    "choices": [
      {
        "id": 1,
        "text": "Abhiyan Indradhanush"
      },
      {
        "id": 2,
        "text": "Pradhan Mantri Awaas Yojana"
      },
      {
        "id": 3,
        "text": "Rajiv Gandhi Shramik Kalyan Yojana"
      },
      {
        "id": 4,
        "text": "Extended sickness benefit"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Pradhan Mantri Awaas Yojana</strong>&nbsp;is not an initiative under the Employees state insurance (ESI) scheme. It is a flagship social welfare program intended to <strong>provide housing</strong> for all in urban areas all over the India.</p>\n<p><strong>Abhiyan Indradhanush</strong>&nbsp;in relation to the <strong>ESI scheme</strong> refers to the&nbsp;<strong>change of bedsheets</strong>&nbsp;on a daily basis from Sunday to Saturday based on the <strong>VIBGYOR pattern</strong> for the color of the bedsheet.</p>\n<p><strong>Rajiv Gandhi Shramik Kalyan Yojana&nbsp;</strong>is an <strong>ESI scheme</strong> of <strong>unemployment allowance</strong>. As per this scheme, an insured person who becomes unemployed after being insured for three or more years, due to the closure of a factory/establishment, retrenchment, or permanent invalidity is entitled to:</p>\n<ul>\n<li>Unemployment allowance equal to&nbsp;<strong>50% of wage</strong> for a maximum&nbsp;period of up to<strong> 2 years.</strong></li>\n<li><strong>Medical care for self and family</strong>&nbsp;from ESI hospitals/dispensaries during the period of unemployment allowance.</li>\n<li><strong>Vocational training </strong>provided for upgrading skills&nbsp;- expenditure on fee/traveling allowance borne by ESIC.</li>\n</ul>\n<div class=\"ar\">\n<p><strong>Extended sickness benefit</strong>&nbsp;is offered to insured people of the <strong>ESI scheme</strong>, who are suffering from certain&nbsp;<strong>chronic diseases</strong>, for a maximum period of&nbsp;<strong>2 years</strong>, in addition to the 91 days of leave they are entitled to under the sickness benefit. During this period, they are paid about&nbsp;<strong>80%</strong>&nbsp;of the average daily wages. The insured person should have been working for a continuous period of 2 years. There are 34 listed diseases for which the extended sickness benefit can be availed.</p>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is targetted by the establishment bearing the logo shown below:",
    "choices": [
      {
        "id": 1,
        "text": "Family planning"
      },
      {
        "id": 2,
        "text": "Immunisation"
      },
      {
        "id": 3,
        "text": "Sexually Transmitted Diseases"
      },
      {
        "id": 4,
        "text": "Maternal and Child Health Services"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The logo shown represents\u00a0<strong>Suraksha Clinics </strong>which\u00a0are established for the management of <strong>sexually transmitted diseases</strong>\u00a0(STDs) where patients are given color-coded kits.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1d69affdd5634762b14708fd5335a989.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A community health officer is assessing a healthcare facility under the scheme shown in the image below. Which of the following is the main objective of this scheme?",
    "choices": [
      {
        "id": 1,
        "text": "To promote infection control practices in public health care facilities"
      },
      {
        "id": 2,
        "text": "To promote labor room quality and infrastructure"
      },
      {
        "id": 3,
        "text": "To provide physical aids and assisted-living devices for senior citizens"
      },
      {
        "id": 4,
        "text": "To improve the quality of care during the intrapartum and immediate postpartum period"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above image shows the <strong>Kayakalp scheme</strong>. The main objective of the program is to<strong> promote cleanliness</strong>,<strong> hygiene,</strong> and<strong> infection control</strong> practices in public healthcare facilities.&nbsp;</p>\n<p><strong>The Kayakalp</strong>&nbsp;scheme is a<strong>&nbsp;</strong>national initiative launched by the Ministry of Health and Family Welfare (MoHFW) under Swachh Bharat Abhiyan.</p>\n<p>Other main objectives:</p>\n<ul>\n<li>To incentivize and recognize public healthcare facilities that adhere to standard protocols of cleanliness and infection control</li>\n<li>To instill a culture of ongoing assessment and review of performance related to hygiene, cleanliness, and sanitation</li>\n<li>To create and share sustainable practices to improve cleanliness in public health facilities linked to positive health outcomes</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/455355081c9f4ea4890c62fe3f087e49.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6f4d02add97143129f8609b5dfaec8cdx192x200.PNG"
    ]
  },
  {
    "text": "A patient with leprosy comes from a remote village to the district hospital with multiple cuts and abrasions on his feet. He cannot remember how he acquired these wounds and does not feel any sensation in his foot. After addressing the wound, you provide him with Micro Cellular Rubber (MCR) footwear and advise him to follow up. What is the web-based system launched by the government that can help you track this patient?",
    "choices": [
      {
        "id": 1,
        "text": "NIKUSTH"
      },
      {
        "id": 2,
        "text": "NIKSHAY"
      },
      {
        "id": 3,
        "text": "NISHCHAY"
      },
      {
        "id": 4,
        "text": "AXSHYA"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Nikusth&nbsp;</strong>is a&nbsp;real-time leprosy reporting software for monitoring&nbsp;<strong>leprosy patients&nbsp;</strong>with a patient tracking mechanism launched by the Health &amp; Family Welfare Minister, Government of India.</p>\n<p>Sparsh leprosy awareness campaign and the Nikusth system are related to Hansen's disease/leprosy.</p>\n<p>\"<strong>Sparsh Leprosy Awareness Campaign</strong>\" (SLAC) was introduced in 2017 on the occasion of Anti-Leprosy day (observed on last Sunday of January) to promote awareness.&nbsp;NLEP introduced this campaign in order to address the issue of the high level of stigma attached to leprosy and to increase awareness about various aspects of leprosy.</p>\n<p>Other options:</p>\n<p><strong>NIKSHAY</strong>&nbsp;is a web-based solution for monitoring of <strong>TB</strong> <strong>patients. </strong>(The word is a combination of two Hindi words NI and KSHAY, meaning eradication of TB)</p>\n<p><strong>Axshya</strong> is the<strong>&nbsp;</strong>project that works to improve access to <strong>quality TB care</strong> and control through a partnership between government and civil society.</p>\n<p>Note:&nbsp;</p>\n<p><strong>Nikshay Poshan Yojana</strong></p>\n<p>Under <strong>Nikshay Poshan Yojana</strong>, a financial incentive of&nbsp;<strong>Rs. 500</strong>&nbsp;per month is provided for&nbsp;<strong>nutritional support</strong>&nbsp;to each notified TB patient for the duration of anti-TB treatment. For&nbsp;pediatric TB patients&nbsp;who do not have bank accounts, the money shall be deposited in&nbsp;parent's/guardian's accounts&nbsp;whose details are to be sought and entered in Nikshay against the patient&rsquo;s records. The processing of payment is on the&nbsp;7th of every month.</p>\n<p><strong>Nishchay</strong> is a pregnancy test kit introduced by the government.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d8bb6fd29e064068b1788337af1223ffx380x334.JPEG"
    ]
  },
  {
    "text": "You are working at an NGO eye hospital which provides affordable eye-care to people in need. Under the program whose logo is given below, NGO eye hospitals are considered ____________",
    "choices": [
      {
        "id": 1,
        "text": "Primary level"
      },
      {
        "id": 2,
        "text": "Secondary level"
      },
      {
        "id": 3,
        "text": "Tertiary level"
      },
      {
        "id": 4,
        "text": "Intermediate level"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Under the <strong>National Programme for the Control of Blindness and Visual Impairment (NPCBVI)</strong>, whose logo is shown above,&nbsp;NGO eye hospitals are considered secondary level.</p>\n<p>The levels of eye care, according to NPCBVI are:</p>\n<ul>\n<li>Primary level: Sub-district level hospitals, community health centers, mobile ophthalmic units, upgraded PHCs, link workers, Panchayats.</li>\n<li>Secondary level: District hospitals, <strong>NGO eye hospitals</strong></li>\n<li>Tertiary levels: Regional institutes of Ophthalmology, medical colleges.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6c7e71028fa94f8c829ff7902b018949.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/535327a629b74f60a3d6c1688fdee1e1x378x378.PNG"
    ]
  }
];
        let quizName = 'National Health Programmes Mini Test - -Tmt';
        const quizFilename = 'national-health-programmes-mini-test-tmt-476f3f27.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>