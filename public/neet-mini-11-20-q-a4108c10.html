<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neet  Mini - 11 (20 Q) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 40-year-old lady is undergoing treatment for post-traumatic stress disorder after she witnessed a shooting when she dropped her niece at school. During a session of psychotherapy, the therapist explains to her that reliving and re-visiting a painful experience often leads to a therapeutic release of emotions. This process can be brought about using certain drugs. Which among the following drugs are not used to bring about this?",
    "choices": [
      {
        "id": 1,
        "text": "Thiopentone Sodium"
      },
      {
        "id": 2,
        "text": "Sodium amobarbital"
      },
      {
        "id": 3,
        "text": "Ketamine"
      },
      {
        "id": 4,
        "text": "Intravenous amphetamines"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"page\" title=\"Page 230\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The process by which repressed material such as painful experiences or conflicts, are brought back to consciousness is called <strong>abreaction</strong>, and <strong>amphetamines</strong> and <strong>lysergic acid</strong> are <strong>no longer used</strong> in clinical practice, due to the risk of side effects and drug dependence.&nbsp;</p>\n<p>During this process, the person not only recalls but relives the experience, which is accompanied by the appropriate emotional response. This results in the patient gaining insight from the experience.&nbsp;</p>\n<p>Previously, intravenous amphetamines, ether, nitrous oxide, and lysergic acid diethylamide (LSD) were used for abreaction as they lead to a marked increase in speech, facilitating the release of unconscious ideas and emotions.</p>\n</div>\n<div class=\"column\">\n<p>Drugs used include:</p>\n<ul>\n<li>5% solution of sodium amobarbital (Amytal)</li>\n<li>Thiopentone sodium (pentothal) infused at a rate such that respiratory depression and sleep is avoided. This is done in the presence of an anesthetist.&nbsp;</li>\n<li>Diazepam</li>\n<li>Ketamine</li>\n</ul>\n<div class=\"page\" title=\"Page 230\">&nbsp;</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old male patient underwent gastric resection surgery for a gastrointestinal malignancy. Following the gastric resection, two Portex tube drains were placed- one in the Morrison's pouch and the other in the region of the gastrojejunostomy. Identify the true statements about the suture material used for securing the drains externally.",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 5"
      },
      {
        "id": 2,
        "text": "2, 3, 4"
      },
      {
        "id": 3,
        "text": "2, 4, 5"
      },
      {
        "id": 4,
        "text": "1, 3, 5"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The suture material used to secure abdominal drains is <strong>s</strong><strong>ilk</strong>. It is black-colored, multifilament, braided, and is derived from the cocoon of the silkworm larva.</p>\n<p>Silk is\u00a0<strong><span style=\"box-sizing: border-box; margin: 0px; padding: 0px;\">unsuitable</span></strong>\u00a0for use with a vascular prosthesis or in tissues requiring prolonged approximation under stress.\u00a0<span style=\"box-sizing: border-box; margin: 0px; padding: 0px;\">There is an\u00a0<strong>increased risk of infection</strong>\u00a0and\u00a0<strong>tissue reaction,\u00a0</strong>so </span>they are not used for routine skin closure.\u00a0It can be used\u00a0<span style=\"box-sizing: border-box; margin: 0px; padding: 0px;\">to\u00a0<strong>secure</strong></span><strong>\u00a0drains</strong> externally. Fibrous <strong>encapsulation</strong> of the suture occurs in 2 to 3 weeks and it is <strong>absorbed</strong> slowly over <strong>1 to 2 years</strong>.</p>\n<p>It is shown in the image below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/070c4a36525c468f927f1c1a977b7dd8x720x500.JPEG"
    ]
  },
  {
    "text": "A 34-year-old male patient was suspected to have a seminoma of the testis. The mass was surgically removed and the specimen was sent for histopathological analysis. Which among the following findings is most likely to be seen microscopically?",
    "choices": [
      {
        "id": 1,
        "text": "Fried egg appearance of cells"
      },
      {
        "id": 2,
        "text": "Schiller Duval bodies"
      },
      {
        "id": 3,
        "text": "Crystalloids of Reinke"
      },
      {
        "id": 4,
        "text": "Derivatives of all three germ layers"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Microscopically, seminomas show a <strong>fried egg appearance of cells.\u00a0</strong>This refers to\u00a0cells with clear cytoplasm and a nucleus with a prominent nucleolus.</p>\n<p><strong>Seminoma\u00a0</strong>is the\u00a0<strong>most common </strong>type of germ cell tumor<strong> (around 50% of GCTs).</strong><strong>\u00a0</strong>It is the\u00a0testicular\u00a0equivalent<strong>\u00a0</strong>of an<strong>\u00a0ovarian dysgerminoma</strong><strong>.\u00a0</strong>Immunohistochemistry is positive for<strong><strong>\u00a0KIT, OCT3/4, </strong></strong>and\u00a0<strong>placental alkaline phosphatase (PLAP)</strong><strong>.</strong></p>\n<p>Patients usually present with painless testicular enlargement. Heaviness may be felt if the size is 2-3 times normal. Rarely, it may present with symptoms of metastatic disease.</p>\n<p><strong>The gross specimen\u00a0</strong>shows\u00a0a homogeneous, grey-white, lobulated cut surface, devoid of hemorrhage or necrosis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c53c7fb0e97e439690b7774de66a1be2x800x531.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/76b4e33f9e6e42edaad2c96c2199a2e3x800x533.JPEG"
    ]
  },
  {
    "text": "A 12-year-old girl was brought to the hospital after a history of sexual abuse. Prior to the examination, stained portions of the girl's clothing were taken for analysis. The stain was extracted using 10% hydrochloric acid, following which a reagent containing potassium iodide, iodine, and water was added to it. Identify the correct statement about the test performed.",
    "choices": [
      {
        "id": 1,
        "text": "Dark brown crystals indicate the presence of semen"
      },
      {
        "id": 2,
        "text": "The reaction is based on presence of prostatic secretions"
      },
      {
        "id": 3,
        "text": "It is a confirmatory test for the presence of semen"
      },
      {
        "id": 4,
        "text": "It detects the presence of acid phosphatase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct statement here is that <strong>dark brown crystals indicate the presence of semen.</strong>&nbsp;The test described here is the Florence test. It is used to detect <strong>seminal fluid.</strong></p>\n<p>The <strong>suspected</strong>&nbsp;<strong>seminal</strong> <strong>stain</strong> is extracted with 10%&nbsp;<strong>hydrochloric</strong>&nbsp;<strong>acid</strong> and a drop of it is placed over a slide. A coverslip is placed over it and a drop of <strong>Florence</strong> <strong>solution </strong>(potassium iodide, iodine, and water) is made to run under the coverslip. If semen is present, <strong>dark</strong> <strong>brown</strong> rhombic or needle-shaped crystals of choline iodide appear immediately. <strong>Choline</strong> originates from the <strong>seminal vesicles.</strong>&nbsp;</p>\n<p>The test is <strong>not confirmatory</strong> for the presence of semen, however, a <strong>negative reaction rules out</strong> the presence of semen. Confirmation of the presence of semen can be done only if there is presence of at least one unbroken spermatozoon, or detection of&nbsp; sperms by electrophoretic LDH isoenzyme.</p>\n<p>Other tests for Semen detection include:</p>\n<ul>\n<li>Barberio's Test: Yellow needle-shaped crystals on addition of picric acid. Reaction is based on <strong>prostatic</strong> secretions.</li>\n<li>Acid Phosphatase Test: Detects presence of acid phosphatase (from prostatic secretions) in the seminal fluid.</li>\n<li>Creatine Phosphokinase: Spermatozoa contain a high level of creatinine phosphokinase, which can be detected.</li>\n<li>Immunological detection of P30, MHS 5 or MAB E6</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old man presented with sudden, progressive, painless loss of vision in the right eye. There was no history of associated photopsia. On examination, the retina appeared convex and detached with no evidence of breaks. Which among the following signs is likely to be present?",
    "choices": [
      {
        "id": 1,
        "text": "Shifting fluid sign"
      },
      {
        "id": 2,
        "text": "Schaffer sign"
      },
      {
        "id": 3,
        "text": "Relative afferent pupillary defect"
      },
      {
        "id": 4,
        "text": "Reduced retinal mobility"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The case is suggestive of\u00a0<strong>serous</strong> or <strong>exudative retinal detachment,</strong> and<strong>\u00a0the presence of shifting fluid </strong>is a hallmark feature.</p>\n<p><strong>Exudative RD</strong> is characterized by the accumulation of fluid beneath the retina in the absence of a retinal break or traction. <strong>Fluid</strong> leaks outside the vessels and accumulates <strong>under the retina</strong>. RD does not occur as long as the retinal pigment epithelium is pumping the leaking fluid into the choroidal circulation. The causes include:</p>\n<ul>\n<li>Inflammatory conditions like choroiditis, posterior scleritis</li>\n<li>Choroidal tumors like melanoma</li>\n<li>Toxemia of pregnancy</li>\n<li>Central serous retinopathy</li>\n<li>Coats disease</li>\n</ul>\n<p>Patients may present with painless progressive visual field defects without photopsia. Floaters may be present if there is an associated vitritis. Clinical signs include:</p>\n<ul>\n<li>Convex configuration of the retinal detachment, with a smooth surface</li>\n<li>Detached retina is very mobile</li>\n<li><strong>Shifting fluid sign</strong>- Subretinal fluid detaches the area of the retina under which it accumulates. In the upright position, it collects under the inferior retina. But in the supine position, the inferior retina flattens, the fluid shifts posteriorly which detaches the superior retina.</li>\n<li>The cause of the RD may be apparent.\u00a0</li>\n<li><strong>Leopard spots</strong>- Scattered areas of clumped subretinal pigment may be seen after the detachment has flattened.</li>\n</ul>\n<p><strong>Other options:</strong></p>\n<p>Options B and C: Relative afferent pupillary defect and Schaffer sign are seen in <strong>r</strong><strong>hegmatogenous</strong>\u00a0RD. Schaffer's sign refers to\u00a0<strong>tobacco dust</strong>\u00a0appearance in anterior vitreous with substantial vitreous blood or inflammatory cells.\u00a0</p>\n<p>Option D-\u00a0<strong>Reduced retinal mobility</strong> is seen in <strong>tractional retinal detachment.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/06ccd42341bc4781ac8cc982ef7b691ex1280x2441.7489421720734.JPEG"
    ]
  },
  {
    "text": "A 32-year-old man came with progressive difficulty in swallowing food. Barium study showed marked dilatation of the esophagus proximal to the obstruction. Further investigations reveal incomplete relaxation of the LES in response to swallowing, high resting LES pressure, and absent esophageal peristalsis. Which among the following is responsible for this?",
    "choices": [
      {
        "id": 1,
        "text": "Decreased VIP and  NO"
      },
      {
        "id": 2,
        "text": "Increased VIP and NO"
      },
      {
        "id": 3,
        "text": "Increased VIP and ACh"
      },
      {
        "id": 4,
        "text": "Decreased ACh and NO"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 499\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The clinical scenario points to a diagnosis of <strong>achalasia cardia</strong>.<strong> </strong>In this condition,\u00a0<strong>VIP </strong>and<strong> NO </strong>are<strong> decreased</strong> causing failure of the LES to relax.</p>\n<p>Achalasia cardia is a condition in which food accumulates in the esophagus. It leads to massive dilatation as a result of increased resting LES tone and incomplete relaxation on swallowing. The <strong>myenteric plexus</strong> of the esophagus is <strong>deficient at the LES</strong> and the release of NO and VIP is decreased.</p>\n<p>Normally, the tone of the LES is under neural control. The release of <strong>acetylcholine</strong> from vagal endings causes the intrinsic sphincter to <strong>contract</strong>, and the release of <strong>NO </strong>and<strong> VIP</strong> from interneurons causes it to\u00a0<strong>relax</strong>. The crural portion of the diaphragm is innervated by the phrenic nerves. Its contraction is coordinated with respiration and contractions of the chest and abdominal muscles. Thus, the intrinsic and extrinsic sphincters operate together. This permits the orderly flow of food into the stomach and prevents reflux of gastric contents into the esophagus.\u00a0</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cf32672ea3f64322b1101ef54476978bx600x657.JPEG"
    ]
  },
  {
    "text": "A 37-year-old woman was referred from the ophthalmology department with an examination report that revealed the presence of multiple fine brown deposits on the corneas bilaterally. A detailed drug history revealed that she was on the drugs mentioned below. You are requested to change or stop the one(s) responsible for the pigmentary changes. Which will you choose?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3"
      },
      {
        "id": 2,
        "text": "1 and 4"
      },
      {
        "id": 3,
        "text": "3, 4, 5"
      },
      {
        "id": 4,
        "text": "2 and 3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 1269\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Chlorpromazine and indomethacin (1 and 4) are known to cause pigmentary deposits in the cornea and should be stopped or changed.</p>\n<p>The cornea, conjunctiva, and eyelids can be affected with brownish pigmentary deposits due to systemic medications such as:</p>\n<ul>\n<li>Amiodarone</li>\n<li>Indomethacin</li>\n<li>Atovaquone</li>\n<li>Chloroquine</li>\n<li>Hydroxychloroquine</li>\n<li>Phenothiazines, such as chlorpromazine and thioridazine</li>\n</ul>\n<p>They deposit in the cornea in a whorl-like pattern termed cornea verticillata, and appear as fine tan or brown pigment deposits. The whorl-like pattern shows the direction in which corneal epithelial cells migrate. Occasionally, it might cause glare and surface discomfort but rarely affects the vision. The discomfort responds to topical lubricants.</p>\n</div>\n</div>\n</div>\n</div>\n<p>&nbsp;</p>\n<p>Cornea verticillata may also be seen in Fabry disease (seen below)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5a083b3a01e449a0a832708b2af83797x1200x719.JPEG"
    ]
  },
  {
    "text": "A 6-year-old boy was referred after a physician noticed yellowish discoloration of his eyes at a school health checkup. On examination, no signs of liver failure were seen, however, there was mild hepatosplenomegaly. Ultrasonography of the abdomen revealed no abnormality. Liver function tests are shown below.",
    "choices": [
      {
        "id": 1,
        "text": "Colour develops in the presence of methanol"
      },
      {
        "id": 2,
        "text": "Colour immediately on addition of the reagent"
      },
      {
        "id": 3,
        "text": "Colour produced immediately intensifies on addition of methanol"
      },
      {
        "id": 4,
        "text": "No colour produced on addition of the reagent"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario is suggestive of <strong>Gilbert's syndrome, </strong>and<strong>\u00a0</strong>Van den Bergh reaction gives <strong>indirect positive</strong> due to <strong>unconjugated</strong> hyperbilirubinemia.</p>\n<p>Van den Bergh reaction is a <strong>colorimetric method</strong> to measure the serum bilirubin level. The reagent diazotized sulfanilic acid (sulfanilic acid in HCl and sodium nitrite) reacts with bilirubin to form a purple-colored complex, azobilirubin. The reactions are shown below.</p>\n<table style=\"width: 484px;\">\n<tbody>\n<tr>\n<td style=\"width: 192px;\"><strong>Clinical condition</strong></td>\n<td style=\"width: 474.8958435058594px;\"><strong>Reaction with reagent</strong></td>\n<td style=\"width: 190.10415649414062px;\"><strong>Interpretation</strong></td>\n</tr>\n<tr>\n<td style=\"width: 192px;\"><strong>Normal</strong> serum</td>\n<td style=\"width: 474.8958435058594px;\">No reaction</td>\n<td style=\"width: 190.10415649414062px;\"><strong>Negative</strong></td>\n</tr>\n<tr>\n<td style=\"width: 192px;\">High <strong>conjugated</strong> bilirubin<br />eg: Obstructive jaundice</td>\n<td style=\"width: 474.8958435058594px;\">Colour produced immediately, without the addition of alcohol</td>\n<td style=\"width: 190.10415649414062px;\"><strong>Direct</strong> positive</td>\n</tr>\n<tr>\n<td style=\"width: 192px;\">High <strong>unconjugated</strong> bilirubin<br />eg: Hemolytic anemia</td>\n<td style=\"width: 474.8958435058594px;\">Colour produced only on the addition of alcohol\u00a0</td>\n<td style=\"width: 190.10415649414062px;\"><strong>Indirect</strong> positive</td>\n</tr>\n<tr>\n<td style=\"width: 192px;\">High <strong>conjugated and unconjugated</strong> bilirubin<br />eg: Hepatic jaundice</td>\n<td style=\"width: 474.8958435058594px;\">Colour produced immediately, intensifies on the addition of alcohol</td>\n<td style=\"width: 190.10415649414062px;\"><strong>Biphasic</strong> reaction</td>\n</tr>\n</tbody>\n</table>\n<div dir=\"ltr\" align=\"left\">\u00a0</div>\n<div dir=\"ltr\" align=\"left\">Gilbert\u2019s syndrome is the most common inherited disorder of bilirubin metabolism. It is inherited as an autosomal recessive trait where there is reduced UDP-glucuronyl transferase enzyme. The plasma bilirubin is usually less than 6 mg/ dL and the LFTs are otherwise normal. There is no bilirubinuria because the hyperbilirubinemia is predominantly <strong>unconjugated</strong>.\u00a0The condition is not associated with liver injury and thus has an excellent prognosis, needs no treatment.</div>\n<div dir=\"ltr\" align=\"left\">\u00a0</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man comes to the OPD with complaints of nasal congestion, nasal discharge, and frequent headaches for the past few weeks. During this time, he noticed increased mouth breathing, dry cough at night, and his wife told him that he started snoring. He has a history of asthma. One year ago, he had an asthma exacerbation while being treated for an ankle sprain. Two weeks ago, he had another asthma exacerbation after taking aspirin for his headaches.  Examination shows mild tenderness over the forehead bilaterally. Which of the following is the most likely cause of this patient's presenting symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Nasal polyps"
      },
      {
        "id": 2,
        "text": "Bronchial asthma"
      },
      {
        "id": 3,
        "text": "Angiofibroma"
      },
      {
        "id": 4,
        "text": "Adenoid hypertrophy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient with nasal congestion, watery nasal discharge, dry cough at night that is likely caused due to postnasal drip, and features of nasal obstruction suggested by mouth breathing and snoring are suggestive of <strong>nasal polyps</strong>.</p>\n<p>The nasal polyps in this clinical vignette along with asthma and aspirin intolerance are also suggestive of aspirin-exacerbated respiratory disease or AERD. This usually presents with features of the classical Samter's triad which consists of-</p>\n<ul>\n<li>Nasal polyposis</li>\n<li>Asthma</li>\n<li>Aspirin intolerance.</li>\n</ul>\n<p>&nbsp;</p>\n<p>&nbsp;Other options:</p>\n<p>Angiofibroma presents with a history of profuse recurrent epistaxis. It has a firm consistency and bleeds easily on probing.</p>\n<p>Adenoid hypertrophy can cause symptoms&nbsp;like snoring, mouth breathing, sleep apnoea syndrome or speech abnormalities (rhinolalia clausa), recurrent rhinosinusitis, chronic otitis media with effusion associated with adenoid hyperplasia, recurrent ear discharge and dental malocclusion. It is seen in a younger population and has not been associated with aspirin sensitivity.</p>\n<p>Bronchial asthma does not attribute to the other chronic symptoms seen in this patient like nasal discharge, or snoring.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 26-year-old primigravida developed fever and pruritic vesicular rashes one day after a full-term normal vaginal delivery. A diagnosis of varicella infection was made. How should the neonate be managed?",
    "choices": [
      {
        "id": 1,
        "text": "Immediate vaccination against Varicella"
      },
      {
        "id": 2,
        "text": "Wait and watch for 1 week"
      },
      {
        "id": 3,
        "text": "Varicella-Zoster immunoglobulin to be given"
      },
      {
        "id": 4,
        "text": "Acyclovir therapy should be started immediately"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Passive immunization with<strong> Varicella-Zoster immunoglobulin (VZIG)</strong> is administered to neonates whose mothers develop a varicella-zoster rash from <strong>five days before delivery</strong> up to <strong>two days after delivery.</strong></p>\n<p>If the fetus or neonate is exposed to active varicella infection just before or during delivery, they may develop <strong>a disseminated visceral </strong>and<strong> central nervous system disease,</strong> which can be fatal. Neonte is<strong> not at\u00a0risk</strong> of severe neonatal chicken pox, if mother contracts infection before and after this period (i.e 5 days before and 2 days after delivery),\u00a0in that case passive immunisation is not required.</p>\n<p><strong>VZIG</strong> may not prevent infection, but <strong>reduces the severity</strong> of neonatal infection. Monitoring of the neonate should be prolonged to <strong>28 days</strong>, as VZIG may prolong the incubation period.</p>\n<p>If signs of neonatal infection develop despite VZIG, the neonate should be treated with acyclovir.\u00a0</p>\n<p>Primary varicella infection presents with flu-like symptoms, followed by a pruritic vesicular rash. The fetus may develop congenital varicella syndrome if infection occurs in the first half of pregnancy, the <strong>highest risk</strong> is between <strong>13 and 20 weeks</strong>. Features of <strong>congenital varicella syndrome</strong> include:</p>\n<ul>\n<li>Chorioretinitis</li>\n<li>Microphthalmia</li>\n<li>Cerebral cortical atrophy</li>\n<li>Growth restriction</li>\n<li>Hydronephrosis</li>\n<li>Limb hypoplasia</li>\n<li>Cicatricial skin lesions</li>\n</ul>\n<p>Pregnant women who are exposed to varicella and are susceptible should be given VZIG. Infected women usually require only supportive care, but those who require intravenous (IV) fluids and or develop pneumonia should be hospitalized. Intravenous acyclovir therapy is given to women requiring hospitalization.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A factory worker with tuberculosis was started on DOTS (directly observed treatment short course) and is advised to rest. He earns Rs 20,000/- as a monthly income and is eligible for periodic payments under the Employees State Insurance Act scheme. Which benefit does this case fall under?",
    "choices": [
      {
        "id": 1,
        "text": "Enhanced sickness benefit"
      },
      {
        "id": 2,
        "text": "Extended sickness benefit"
      },
      {
        "id": 3,
        "text": "Medical benefit"
      },
      {
        "id": 4,
        "text": "Disablement benefit"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 886\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>In the given scenario, the patient is diagnosed to have <strong>tuberculosis,</strong> and thus he is eligible for the\u00a0<strong>extended sickness benefit\u00a0</strong>of the\u00a0<strong>ESI\u00a0</strong>scheme.\u00a0</p>\n<p><strong>Extended sickness benefit </strong>is the leave given up to a maximum period of <strong>two years</strong><strong>.</strong>\u00a0The diseases for which extended sickness benefits are applied are <strong>TB, leprosy, empyema,\u00a0</strong>HIV, malignancies, plegias, etc. During this period, <strong>80 per cent</strong>\u00a0of the wages are paid.</p>\n<p>ESI act was amended to provide <strong>cash</strong> and <strong>medical</strong> benefits to employees\u00a0during sickness, maternity, and employment injury. People with monthly earnings <strong>up to</strong> <strong>21,000 </strong>are covered under this scheme.\u00a0Cash benefits are made through branches and cash offices. The\u00a0<strong>medical benefits</strong>\u00a0are made available through ESI\u00a0dispensaries, clinics, hospitals, etc. The\u00a0<strong>benefits</strong> provided to the insured persons are:</p>\n<ul>\n<li><strong>Medical benefits\u00a0</strong>-<strong>\u00a0</strong>Complete medical care is provided to the insured person and his/ her family members.</li>\n<li><strong>Sickness benefits</strong>\u00a0- include a <strong>periodic cash payment</strong> for<strong> 91 days</strong> to the insured sick person. <strong>70%</strong> of the average daily wages is given as the daily rate if the person is under medical treatment.\u00a0</li>\n<li><strong>Enhanced sickness benefit </strong>-<strong>\u00a0</strong>includes\u00a0<strong>14 days </strong>of leave given for <strong>tubectomy</strong> and\u00a0<strong>7 days </strong>of leave\u00a0for <strong>vasectomy</strong>. The amount payable is equal to the full wages.</li>\n<li><strong>Maternity benefits </strong>-<strong>\u00a0</strong>cash payments equal to full wages are paid to the insured person for up to 26 weeks in cases of pregnancy.</li>\n<li><strong>Disablement</strong> <strong>benefit</strong> - cash payment and free medical treatment are given for temporary or permanent\u00a0disablements and\u00a0occupational diseases.</li>\n<li>Dependant's benefit - if an employment injury causes the <strong>death</strong> of the insured person, the <strong>dependants</strong> are eligible for periodic payments.</li>\n<li>Funeral expenses of Rs 15000 are payable to the dependants.</li>\n<li>Rehabilitation allowance - the insured person and the family members continue to get medical treatment after <strong>permanent disablement</strong> and <strong>retirement</strong>.</li>\n</ul>\n<p>Note: Directly observed treatment short course <strong>(DOTS)</strong>\u00a0is an effective treatment strategy used for <strong>tuberculosis.\u00a0</strong>In the <strong>intensive phase</strong> of the treatment, the patient swallows the drug in the <strong>presence</strong> of a healthcare worker. During the <strong>continuation phase,</strong> medicine is issued for a week and <strong>only</strong> the <strong>first dose</strong> is swallowed in the presence of a health worker.\u00a0</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 16-year-old boy presents with a history of chronic cough and wheezing. History taking reveals that he had a lower respiratory tract infection 15 months ago. After ruling out other causes, the pediatrician diagnoses this case as Swyer-James syndrome. This could be most likely due to the late sequelae of which of the following infections?",
    "choices": [
      {
        "id": 1,
        "text": "Parvovirus infection"
      },
      {
        "id": 2,
        "text": "Reovirus infection"
      },
      {
        "id": 3,
        "text": "Calicivirus infection"
      },
      {
        "id": 4,
        "text": "Adenovirus infection"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Swyer&ndash;James syndrome </strong>is most likely due to late sequelae of<strong>&nbsp;</strong><strong>adenovirus&nbsp;</strong>infection. This condition can also be due to respiratory syncytial virus, <em>Mycoplasma pneumoniae</em>, influenza A, or measles infections.</p>\n<p>This condition is also called<strong>&nbsp;MacLeod syndrome.&nbsp;</strong>The infection can produce pulmonary vascular hypoplasia with subsequent hypoperfusion leading to <strong>unilateral hyperlucent lung</strong> (refers to underdevelopment of the affected lung). Clinically, children with this syndrome frequently exhibit<strong> hemoptysis, wheezing, a chronic cough, </strong>and <strong>recurrent pneumonia.</strong> During exhalation, some individuals exhibit the characteristic mediastinal shift away from the lesion. Bronchography or CT scanning can frequently show bronchiectasis.</p>\n<p>Diagnosis is made based on the following triad of findings:</p>\n<ul>\n<li><strong>Unilateral hyperlucent lung-&nbsp;</strong>This occurs due to the trapping of expiratory air</li>\n<li>Diffusely decreased ventilation in the affected lung</li>\n<li>Affected lung shows decreased perfusion in angiography/ ventilation-perfusion scan</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-year-old man presented with a high fever, muscle aches, and easy fatigability. He gives history of diarrhoea and abdominal pain about 6 weeks ago. Dietary history reveals consumption of raw or undercooked pork. The blood investigations showed eosinophilia. His muscle biopsy shows the following finding. Which of the following statements is incorrect regarding the causative organism of this disease?",
    "choices": [
      {
        "id": 1,
        "text": "Pig acts as an intermediate host"
      },
      {
        "id": 2,
        "text": "Caused by a nematode"
      },
      {
        "id": 3,
        "text": "The larvae cause neurocysticercosis"
      },
      {
        "id": 4,
        "text": "The female worm is viviparous"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows an encysted spiral larvae in the muscle which is characteristic of&nbsp;<strong>Trichinella spiralis.&nbsp;</strong>The clinical presentation and eosinophilia further support the diagnosis. Neurocysticercosis&nbsp;is caused by <strong>Taenia solium</strong>&nbsp;<strong>(</strong>&nbsp;larval stage known as<strong> Cysticercosis cellulose). </strong></p>\n<p>Trichinella is viviparous i.e. produces larvae.&nbsp;The larvae enter the <strong>intestine</strong> and invade the epithelium developing into adult. Clinical features at this stage include nausea, vomiting, <strong>diarrhea,</strong> and <strong>abdominal pain.</strong> In the later phase of the infection, the larvae move from the <strong>intestines into</strong> the <strong>circulation</strong> and migrate <strong>into muscles</strong> where they are <strong>encysted.</strong> This causes symptoms like fever, myalgia, etc.</p>\n<p>Detection of <strong>spiral larvae</strong> in muscle tissue is done by performing a muscle biopsy. Deltoid, biceps, gastrocnemius, or pectoralis muscles are usually selected for biopsy. About 1 g of muscle tissue <strong>preferably near the tendon insertion</strong> is biopsied. Safranin staining is done.&nbsp;</p>\n<p>It can be treated using <strong>albendazole</strong> along with <strong>steroids</strong> to control inflammation.</p>\n<p>Note:</p>\n<p>Neurocysticercosis is caused by the&nbsp;CNS infection&nbsp;with the <strong>pork \"tapeworm\",</strong>&nbsp;<strong>Taenia solium</strong>. It typically presents with seizures. Infection leads to extra-intestinal disease (including neurocysticercosis) usually occurs as a result of eating food or drinking water contaminated by human feces containing&nbsp;T. solium&nbsp;eggs.</p>\n<p>Image: Trichinella Life Cycle.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bfb764519d464eb78f30e95884e50dd1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c5b2185ab6704339ac8b5e5979cbd072x551x548.GIF"
    ]
  },
  {
    "text": "A 58-year-old woman presents with a history of Raynaud\u2019s phenomenon that has worsened over the past 6 months. She noticed hard whitish bumps over her thumb, as shown in the image. She also reports joint pains involving her hands and wrists and difficulty in swallowing solid food. On examination, there is a hardening of the skin of the hands with claw-like appearance. Laboratory study reveals high titers of anticentromere antibodies. What is the most likely condition involving her hands?",
    "choices": [
      {
        "id": 1,
        "text": "Calcinosis cutis"
      },
      {
        "id": 2,
        "text": "Osteoma cutis"
      },
      {
        "id": 3,
        "text": "Xanthoma"
      },
      {
        "id": 4,
        "text": "Cutaneous mycetoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Calcinosis cutis </strong>is a condition in which calcium salts are deposited in the skin and subcutaneous tissue. The combination of <strong>calcinosis</strong> <strong>cutis</strong>, <strong>Raynaud's</strong> <strong>phenomenon</strong>, <strong>esophageal</strong> <strong>dysmotility</strong>, sclerodactyly, and telangiectasia, is termed <strong>CREST</strong> <strong>syndrome</strong>. This syndrome is a variant of systemic sclerosis.</p>\n<p><strong>Dystrophic calcification</strong> is the most common cause of calcinosis cutis and is associated with <strong>normal laboratory values of calcium and phosphorus.</strong> It may involve the skin, subcutaneous, and soft tissues and occur in about 40% of the patients, most commonly seen in patients with long-standing <strong>anti</strong>-<strong>centromere</strong> <strong>antibody</strong>-positive limited cutaneous systemic sclerosis (<strong>lcSSc</strong>).</p>\n<p>The calcific deposits are composed of <strong>calcium</strong> <strong>hydroxyapatite</strong> <strong>crystals</strong>&nbsp;and vary in size from small punctate lesions to large masses. The deposits usually occur in <strong>tissues</strong> <strong>damaged</strong> due to inflammation, hypoxia, and local trauma. They can be visualized on plain radiography and dual-energy CT.</p>\n<p>Calcinosis cutis is commonly seen over the finger pads, palms, extensor surfaces of the forearms, and the olecranon and prepatellar bursae. The lesions cause pain and nerve compression. They may ulcerate through the skin, cause drainage of chalky-white material, and lead to secondary infections.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1b75251bb7bc49a8958c20a039d26c9d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A senior resident working in an intensive care unit has assembled the following equipment to perform a procedure. Which of the following procedures he would be performing?",
    "choices": [
      {
        "id": 1,
        "text": "Radial artery catheterization"
      },
      {
        "id": 2,
        "text": "Central venous catheterization"
      },
      {
        "id": 3,
        "text": "Catheterization for peritoneal dialysis"
      },
      {
        "id": 4,
        "text": "Pigtail catheter insertion"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>From the materials which have been gathered by the senior resident, it can be inferred that he would be performing a <strong>central venous catheterization.</strong></p>\n<p>The image below shows the equipment for performing a central venous catheterization.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/beabb70f27dc4d29b104550f6ced89a1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/997e60e0dbb2446283b09e14e5e79635x1280x909.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4a36b6e9056e45c3b06c0555dc3de570x750x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2e8811dbf95c4d99af9478748eb1656bx1280x1134.JPEG"
    ]
  },
  {
    "text": "A cardiac surgeon demonstrates the following recess to his juniors and explains its importance that it allows surgeons to isolate and apply a temporary aortic cross-clamping. The sinus he is referring to lies anterior to the ____.",
    "choices": [
      {
        "id": 1,
        "text": "Superior venacava and left atrial appendage"
      },
      {
        "id": 2,
        "text": "Pulmonary trunk and aorta"
      },
      {
        "id": 3,
        "text": "Oblique sinus and pulmonary veins"
      },
      {
        "id": 4,
        "text": "Left atrium"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The sinus pointed out is the <strong>transverse sinus.</strong> It lies anterior to the<strong> superior vena cava </strong>and the<strong> left atrial appendage.</strong></p>\n<p>The <strong>reflections of the serous pericardium</strong> are arranged as <strong>two tubes</strong> &ndash; one enclosing the aorta and the pulmonary trunk and the other enclosing the vena cavae and the four pulmonary veins.&nbsp;</p>\n<p>The <strong>transverse sinus</strong> is a passage between the two 'tubes'. It lies <strong>superior</strong> to the <strong>left atrium</strong>. It lies <strong>posterior</strong> to the&nbsp;<strong>aorta and the pulmonary trunk&nbsp;</strong>and <strong>anterior</strong> to the <strong>superior vena cava </strong>and the<strong> left atrial appendage. Inferiorly</strong> it is related to the <strong>oblique sinus.</strong></p>\n<p>The zone of reflection surrounding the veins is J-shaped and the cul-de-sac formed within the J is the <strong>oblique pericardial sinus</strong>. This lies posterior to the left atrium</p>\n<p>The image below shows the posterior view of the heart demonstrating the oblique and the transverse sinus.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/34cc905772df479f8ac91af182ed519e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4b8d3e92d83b4627a4c5c28995e9dbccx1280x1390.JPEG"
    ]
  },
  {
    "text": "A newborn was born with the deformity as shown in the image below. You apply a cast as per Ponseti's technique and ask them to return for complete treatment. The patient is however lost to follow-up and is brought to you 2 years later. Which of the following will you do?",
    "choices": [
      {
        "id": 1,
        "text": "Dwyer's procedure"
      },
      {
        "id": 2,
        "text": "Dillwyn Evan's procedure"
      },
      {
        "id": 3,
        "text": "Posteromedial soft tissue release"
      },
      {
        "id": 4,
        "text": "Continue treatment with Ponseti's technique"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows <strong>congenital talipes equinovarus (CTEV)</strong>. Since the child is<strong> less than 3 years old</strong>, <strong>posteromedial soft tissue release</strong> procedures should be done as per the agewise management protocol of CTEV.</p>\n<p>The first line of management for CTEV is <strong>Ponseti's technique</strong> in which gradual correction of deformities is done by plaster cast. The sequence of correction is given as:</p>\n<p><strong>C</strong>- Cavus\u00a0</p>\n<p><strong>A</strong>- Adduction</p>\n<p><strong>V</strong>- Varus</p>\n<p><strong>E</strong>- Equinus</p>\n<p>In addition to the above procedure, we can provide the child with <strong>CTEV shoes</strong> as the child has started walking to retain the correction.</p>\n<p>Features of CTEV shoes:</p>\n<ul>\n<li><strong>Straight inner border</strong>\u00a0prevents\u00a0<strong>adduction</strong></li>\n<li><strong>Outer shoe raise</strong>\u00a0prevents\u00a0<strong>foot inversion</strong></li>\n<li><strong>Absence of heel</strong>\u00a0prevents\u00a0<strong>equinus</strong></li>\n<li>Used once the deformity is corrected and when the child starts walking, upto\u00a0<strong>5 years of age</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8be0985c15c142129000ce0fec09c423.jpg"
    ],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old woman who was operated for a femur fracture complains of shortness of breath on the fourth postoperative day. She has chest pain and tachycardia as well. Her chest X-ray is shown below. This finding is most probably suggestive of ________.",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary embolism"
      },
      {
        "id": 2,
        "text": "Pneumothorax"
      },
      {
        "id": 3,
        "text": "Emphysema"
      },
      {
        "id": 4,
        "text": "Pneumonic consolidation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong>&nbsp;</strong>given clinical features and the X-ray showing <strong>Hampton's hump</strong> is suggestive of <strong>pulmonary embolism</strong>.</p>\n<p><strong>Pulmonary embolism:</strong></p>\n<p>Pulmonary embolism&nbsp;refers to embolic occlusion of the pulmonary arterial system.</p>\n<p>Most patients present with pleuritic chest pain, dyspnoea, and tachypnoea. The classical clinical triad of sudden onset of chest pain, dyspnoea, and hemoptysis is present in only a few cases.</p>\n<p>Chest x-ray signs related to pulmonary embolism include:</p>\n<ul>\n<li><strong>Hampton's hump</strong> is a pleural-based, wedge-shaped opacity with the apex of the triangle pointed towards the occluding vessel or hilum and implies lung infarction.&nbsp;</li>\n<li><strong>Westermark sign</strong> is a chest X-ray finding in pulmonary embolism. It is defined by a hyperlucent area with decreased vascularity due to oligemia of the involved part of the lung.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3acaeb582e454eb49a5f0b36ad896346.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ec6967c1bec24a58899a16d107d9a194x402x371.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/71e560a4564a4b7b90d6697a8a5eec22x804x598.PNG"
    ]
  },
  {
    "text": "A professional violin player presents with well-defined plaques on his neck with comedones, lichenification, and pigmentation. The probable diagnosis is?",
    "choices": [
      {
        "id": 1,
        "text": "Acne mechanica"
      },
      {
        "id": 2,
        "text": "Acne fulminans"
      },
      {
        "id": 3,
        "text": "Acne conglobata"
      },
      {
        "id": 4,
        "text": "Acne excoriee"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The lesion consistent with the given clinical history is<strong>\u00a0acne mechanica</strong>, which is also known as<strong>\u00a0fiddler's neck.</strong></p>\n<p><strong>Acne mechanica</strong>\u00a0describes acne that occurs at the site of <strong>repeated mechanical trauma</strong> and/or <strong>frictional obstruction </strong>of the <strong>pilosebaceous outlet</strong> resulting in comedone formation. Examples include fiddler\u2019s neck, which may occur on the neck of violin players, and is characterized by well\u2010defined plaques with the presence of comedones, lichenification, and pigmentation.</p>\n<p><strong>Other Options:</strong></p>\n<p>Option B:<strong> Acne fulminans</strong> or acne maligna is a rare and severe <strong>destructive</strong> form of acne presenting primarily in <strong>adolescent males</strong>. It most frequently affects the<strong> trunk</strong> but can affect the face and presents acutely in association with systemic symptoms.</p>\n<p>Option C: <strong>Acne conglobata</strong> represents a rare and severe form of acne characterized by multiple and extensive <strong>inflammatory papules, tender nodules</strong>, and<strong> abscesses</strong> that commonly coalesce to form <strong>malodorous draining sinus tracts</strong>.</p>\n<p>Option D:\u00a0<strong>Acne excoriee</strong> is regarded as a <strong>self\u2010inflicted</strong> skin condition in which the<strong> sufferer compulsively picks real </strong>or<strong> imagined acne lesions</strong> predominantly on the face. It is predominantly seen in adolescent girls.\u00a0</p>\n<p>Other psychiatric disorders associated with acne are</p>\n<ul>\n<li>A small number of patients with <strong>body dysmorphic disorder</strong> have acne as their prime symptom. The perceived acne is out of proportion to physical signs.</li>\n<li>Acne has been reported in <strong>anorexia nervosa</strong>. Acne itself may be a <strong>predisposing factor </strong>for anorexia in vulnerable <strong>teenage age groups</strong> who adopt a diet in an attempt to control their acne.\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following options is incorrect regarding ROME IV criteria?",
    "choices": [
      {
        "id": 1,
        "text": "Recurrent abdominal pain, on average should be present for at least 1 day per week in the last 3 months"
      },
      {
        "id": 2,
        "text": "Associated with a change in stool form"
      },
      {
        "id": 3,
        "text": "Associated with a change in stool frequency"
      },
      {
        "id": 4,
        "text": "Abdominal pain for the last 3 weeks with symptom onset at least 6 months before diagnosis."
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The\u00a0<strong class=\"ng-binding\">ROME IV Diagnostic criteria for IBS\u00a0</strong>\u00a0must be fulfilled for the last\u00a0<strong>3 months</strong> with symptom\u00a0<strong>onset</strong>\u00a0at least\u00a0<strong>6 months</strong>\u00a0before diagnosis.</p>\n<p>The\u00a0<strong>onset</strong>\u00a0of symptoms during a period of\u00a0<strong>stress\u00a0</strong>or emotional upset is a feature that supports a diagnosis of irritable bowel syndrome (IBS).</p>\n<p>Based on bowel movement patterns, IBS is classified as:</p>\n<ul>\n<li><strong>IBS-C</strong>: Irritable bowel syndrome-constipation predominant</li>\n<li><strong>IBS-D</strong>: Irritable bowel syndrome-diarrhea predominant</li>\n<li><strong>IBS-M</strong>: Irritable bowel syndrome-mixed</li>\n</ul>\n<p>Alteration in bowel habits\u00a0(constipation/diarrhea) is the most consistent clinical feature in IBS. This means that a majority of people suffering from IBS have an alteration in bowel habits. The most common pattern is constipation alternating with diarrhea, usually with one of these symptoms predominating.</p>\n<p>IBS is a\u00a0<strong>clinical diagnosis</strong>\u00a0that can be made without performing many tests if the patient presents with typical symptoms. However, it is recommended to perform the following tests in most patients to\u00a0<strong>rule out</strong>\u00a0other conditions:</p>\n<ul>\n<li>Complete blood count</li>\n<li>Sigmoidoscopic examination</li>\n<li>Stool examination for ova and parasites</li>\n<li>3-week lactose-free diet</li>\n<li>Fecal calprotectin\u00a0levels help distinguish inflammatory bowel disease (IBD) from IBS</li>\n</ul>\n<p>In patients\u00a0<strong>&gt;40 years</strong>, air-contrast\u00a0<strong>barium enema</strong>\u00a0or\u00a0<strong>colonoscopy</strong>\u00a0should also be performed.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Neet  Mini - 11 (20 Q)';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>