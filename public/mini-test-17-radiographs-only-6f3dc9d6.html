<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 17- Radiographs Only - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "An 11-year old boy presented with pain and swelling around his knee. His radiograph is as shown below. Biopsy revealed blood-filled cystic spaces separated by fibrous septae. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Aneursymal bone cyst"
      },
      {
        "id": 2,
        "text": "Osteoclastoma"
      },
      {
        "id": 3,
        "text": "Osteochondroma"
      },
      {
        "id": 4,
        "text": "Simple bone cyst"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most likely diagnosis in this patient is an <strong>aneurysmal bone cyst.</strong></p>\n<p>The above clinical scenario of an 11-year old boy with pain and swelling and radiograph findings showing\u00a0lytic lesion of the metaphysis of the upper tibia and biopsy showing blood-filled cystic spaces leads to the diagnosis of an <strong>aneurysmal bone cyst.</strong></p>\n<p>An aneurysmal bone cyst is a benign, expansile lytic lesion of the metaphysis of the long bones that are comprised of blood-filled cystic spaces. It is more common between the age group of <strong>5-20 years</strong> with equal male: female distribution. They occur more commonly in the metaphysis of the long bones like the femur, tibia, and humerus. It may occur on the posterior elements of the spine.</p>\n<p>Patients usually present with pain and swelling. In cases of spinal involvement, neurologic manifestations can be seen due to nerve root impingement and neurological impairment.</p>\n<p>Diagnosis:</p>\n<p>A plain radiograph shows an expansile, lytic lesion in the metaphysis. <strong>MRI</strong> reveals a typical cystic lesion and numerous intralesional septations along with <strong>fluid-fluid levels</strong>. A biopsy would reveal <strong>blood-filled cystic spaces</strong> with fibrous septations which might consist of woven bone.</p>\n<p>Treatment:</p>\n<p><strong>Curettage</strong> and <strong>bone grafting</strong> are done in most cases. Arterial embolization is preferred in cases where curettage is extremely difficult. Low-dose radiation is also effective but avoided in view of potential malignant transformation.</p>\n<p>Other options:</p>\n<p>Option B-\u00a0<strong>Osteoclastoma</strong> (giant cell tumor) is a <strong>benign</strong> but <strong>locally aggressive</strong> tumor. It usually affects young adults with a peak incidence in the age group of <strong>20-45 years</strong>.<strong>\u00a0</strong>A plain radiograph reveals an eccentric, expansile, lobulated lytic lesion in the epiphysis. There is minimal\u00a0calcification within the tumor. Biopsy reveals <strong>osteoclast-like giant cells</strong> scattered among round or spindle-shaped mononuclear cells.\u00a0</p>\n<p>Below is the image showing <strong>osteoclastoma:</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0104fc912589492bab181c113e22b2e7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4d2d002a6b6e4851ad2e738bc1c59ae5x720x912.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/946a33a3ec2d4089af2ec6cc367d87cax720x1299.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/139910d7d0ad41ec94dc8b7598bbfceax432x906.JPEG"
    ]
  },
  {
    "text": "A 60-year-old male patient presented with frequently changing bowel habits. He noticed blood in the stools which were not associated with pain. There was no history of weight loss. Barium enema was done and the image is given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Colonic diverticulosis"
      },
      {
        "id": 2,
        "text": "Carcinoma colon"
      },
      {
        "id": 3,
        "text": "Crohn's disease"
      },
      {
        "id": 4,
        "text": "Intussusception"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most likely diagnosis is <strong>colonic diverticulosis.</strong></p>\n<p>The above clinical scenario with the barium enema image is suggestive of <strong>colonic diverticulosis</strong>. The barium enema given shows multiple outpouchings in the ascending, transverse, and descending colon resembling a <strong>saw-tooth.\u00a0</strong>\u00a0</p>\n<p>Diverticulosis refers to the condition where multiple outpouchings occur along the gastrointestinal tract without any inflammation. Colonic diverticulosis is more common among the age group of more than 50 years. Colonic diverticulosis is primarily <strong>false diverticula</strong> as only the mucosa and muscularis mucosa have herniated. Due to the high intraluminal pressure, they are referred to as the pulsion type of diverticula.\u00a0A low fibre diet results in smaller stool volume that increases intraluminal pressure for propulsion. The higher pressures get directed to the colonic wall resulting in<strong> pulsion diverticula.</strong> The <strong>sigmoid colon</strong> is the <strong>most</strong> <strong>common</strong> location.</p>\n<p>The majority of the patients with diverticulosis are usually <strong>asymptomatic.</strong> However, some patients may present with<strong> abdominal cramps,</strong> <strong>altered bowel habits,</strong> and <strong>painless rectal bleeding</strong>. Diverticulosis can present with complications like:</p>\n<ul>\n<li>Diverticulitis</li>\n<li>Abscess</li>\n<li>Peritonitis</li>\n<li>Intestinal obstruction</li>\n<li>Hemorrhage\u00a0</li>\n<li>Fistula formation</li>\n</ul>\n<p>Diagnosis:</p>\n<p>The diagnosis is confirmed by a colonoscopy or an X-ray barium enema. <strong>Barium enema radiograph</strong> shows multiple barium-coated outpouchings from the colonic wall and gives the appearance of a<strong> saw-tooth</strong>. In cases of severe abdominal pain, a CT scan is preferred to avoid the risk of intestinal perforation.</p>\n<p>Treatment:</p>\n<p>A <strong>high fibre diet</strong> reduces the incidence of diverticulosis. Antispasmodics can be prescribed to reduce intestinal spasms. Most cases of bleeding are self-limiting. If persistent bleeding is present, surgical, endoscopic or radiological interventions can be done to reduce the bleeding.</p>\n<p>Other options:</p>\n<p>Option B- <strong>Carcinoma colon</strong> shows <strong>apple-core sign</strong> on <strong>barium enema</strong> as shown below.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/75aded18903c4307a21b864687bae7f0.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9eb34c6de65640c59fc78cc87548d5a6x720x576.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/457fa35dc0c24f07b3ac5afc403f9eefx720x844.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f5e06d96bd1545f69d45221f0180eb63x720x339.JPEG"
    ]
  },
  {
    "text": "Identify the amputation done at the level shown in the below radiograph.",
    "choices": [
      {
        "id": 1,
        "text": "Pirogoff amputation"
      },
      {
        "id": 2,
        "text": "Syme amputation"
      },
      {
        "id": 3,
        "text": "Lisfranc amputation"
      },
      {
        "id": 4,
        "text": "Chopart amputation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Chopart amputation</strong> is done at the level shown in the above radiograph.</p>\n<p><strong>Chopart amputation</strong> is a type of midfoot amputation through the <strong>talonavicular joint</strong> and <strong>calcaneocuboid joint</strong>. One of the indications is diabetic foot. It can be done only if calcaneum and talus are free of infection.</p>\n<p>The image below shows X-ray foot after Chopart's amputation.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dfef7cc7aa814f02a327f24d9e9e6ace.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/72e9cab465b9488995478126059d61e2x1024x1344.JPEG"
    ]
  },
  {
    "text": "A cervical radiograph of a patient involved in a road traffic accident is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Dens fracture"
      },
      {
        "id": 2,
        "text": "Hangman's fracture"
      },
      {
        "id": 3,
        "text": "Clay-shoveler's fracture"
      },
      {
        "id": 4,
        "text": "Jefferson's fracture"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely diagnosis is <strong>hangman's fracture.</strong></p>\n<p>The given cervical radiograph shows fracture of the pedicles of the C<sub>2</sub> vertebra with an anterior translation of C<sub>2</sub> over the C<sub>3</sub> vertebra thus giving the diagnosis of hangman's fracture.</p>\n<p>The mechanism of a traumatic hangman's fracture is <strong>hyperextension</strong> due to force to the forehead along with axial loading. It was incorrectly referred to previously as hangman's fracture due to the distractive force and death from spinal cord injury in judicial hanging. This results in <strong>anterior translation</strong> of the C<sub>2</sub> vertebra over the C<sub>3</sub> vertebra associated with <strong>pars interarticularis fracture</strong> of <strong>C<sub>2</sub></strong> which may extend up to the posterior body wall. <strong>Neurologic injury</strong> is <strong>unusual.&nbsp;</strong></p>\n<p>Treatment:</p>\n<p>Undisplaced fractures can be treated using semi-rigid arthrosis until united. Reduction with in-line traction followed by a semi-rigid collar in fractures with dislocation more than 3.5mm without kyphotic angulation. In cases of C2/C3 facet dislocation, open reduction and stabilization are required.</p>\n<p>Other options:</p>\n<p>Option A-&nbsp;<strong>Dens fracture&nbsp;</strong>is the fracture of the&nbsp;<strong>odontoid process</strong> of the C2 vertebra.</p>\n<p>Option C-&nbsp;<strong>Clay shoveller&rsquo;s fracture </strong>is the <strong>avulsion</strong> of the <strong>spinous process</strong> of the <strong>seventh cervical vertebra.</strong></p>\n<p>Below is the radiograph showing <strong>Clay shoveller's fracture:</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/06ff576702674c7e840d97cd6759252c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/98ef863407684b44b51d2bc4cf4eea7ex838x1024.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4cad5d526a6548929f4e50689853babex955x405.JPEG"
    ]
  },
  {
    "text": "A newborn developed tachypnea and grunting immediately after birth. On examination, the baby was cyanotic, with a scaphoid abdomen. A chest radiograph was taken, which is shown below. Which of the following should be avoided in the management of this baby?",
    "choices": [
      {
        "id": 1,
        "text": "Extracorporeal membrane oxygenation"
      },
      {
        "id": 2,
        "text": "Endotracheal ventilation"
      },
      {
        "id": 3,
        "text": "Bag and mask ventilation"
      },
      {
        "id": 4,
        "text": "High-frequency oscillatory ventilation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario and the x-ray showing<strong>&nbsp;herniation of the bowel loops into the chest </strong>and absence of bowel loops in the abdomen are suggestive of <strong>congenital diaphragmatic hernia. Bag and mask ventilation</strong> is to be <strong>avoided</strong> in the management of this baby.</p>\n<p><strong>Congenital diaphragmatic hernia (CDH) </strong>is a birth defect of the diaphragm. Malformation of the diaphragm allows the abdominal organs to push into the chest cavity, hindering proper lung formation and resulting in pulmonary hypoplasia. The most common type of CDH is a <strong>Bochdalek</strong> <strong>hernia and </strong>in most cases involving the <strong>left side</strong>.<strong>&nbsp;</strong>CDH is a life-threatening pathology in infants and a major cause of morbidity and mortality due to two complications:&nbsp;<strong>pulmonary</strong> <strong>hypoplasia</strong> and <strong>pulmonary</strong> <strong>hypertension</strong>.</p>\n<p>Babies with CDH present with <strong>respiratory distress</strong> characterized by tachypnea, grunting, use of accessory muscles, and cyanosis. They may also have a scaphoid abdomen and increased chest wall diameter. Auscultation of the chest may reveal bowel sounds with reduced breath sounds.</p>\n<p>Diagnosis: A chest radiograph and nasogastric tube passage can confirm the diagnosis of CDH. Prenatal diagnosis can be made using ultrasonography between 16 to 24 weeks of gestation.</p>\n<p><strong>Treatment:</strong></p>\n<p>The immediate step in the management is the naso- or orogastric tube placement for decompression. The airway is to be secured with <strong>endotracheal intubation</strong> (option B) and respiratory distress is stabilised. Bag and mask ventilation may increase the abdominal distension and limit the expansion of the hypoplastic lungs. Hence, <strong>bag and mask ventilation</strong> should be<strong> avoided</strong>.</p>\n<p><strong>Extracorporeal membrane oxygenation (ECMO)</strong>&nbsp;(option A) and <strong>high-frequency oscillatory ventilation</strong> (Option D) have been used as a part of the ventilation strategy to support respiratory failure. The main goal is to maintain oxygenation to the lungs and carbon dioxide washout without causing volutrauma.</p>\n<p>Surgical repair of the defect is to be considered at least 48 hours after stabilization and resolution of pulmonary hypertension.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d72079ac2a0a447cb046639d05d4a567.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A young man complains of occasional cough and blood in the sputum, myalgia, and joint pains. He also reports having noticed blood in his urine for the past several days. He has a history of chronic sinusitis, and examination revealed nasal ulcerations. The investigations and the chest radiograph are given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Henoch-Sch\u00f6nlein purpura"
      },
      {
        "id": 2,
        "text": "Microscopic polyangiitis"
      },
      {
        "id": 3,
        "text": "Granulomatosis with polyangiitis"
      },
      {
        "id": 4,
        "text": "Takayasu arteritis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most likely diagnosis is\u00a0<strong>granulomatosis with polyangiitis\u00a0</strong>(Wegener's granulomatosis). The patient shows the involvement of the upper respiratory tract (chronic sinusitis), lower respiratory tract (occasional hemoptysis and cavity in the radiograph), renal system (blood in the urine), and the presence of <strong>ANCA antibodies</strong> and <strong>necrotizing granulomatous vasculitis</strong>.</p>\n<p>It is a\u00a0<strong>granulomatous, necrotizing vasculitis</strong>\u00a0of the small vessels that mainly affects both the upper and lower respiratory tracts and glomerulonephritis.</p>\n<ul>\n<li>Upper respiratory tract presents with\u00a0sinusitis, otitis media, and nasal septal perforation.</li>\n<li>Lower respiratory tract presents with hemoptysis, dyspnea, and cough.</li>\n<li>Glomerulonephritis presents with proteinuria, hematuria, and hypertension. Initially, it appears as focal or segmental <strong>glomerulonephritis </strong>on biopsy. If this is left untreated, it leads to rapidly progressive glomerulonephritis.</li>\n</ul>\n<p>Apart from these organs, the disease can also affect the eye and skin. Skin lesions present as palpable purpura or subcutaneous nodules.</p>\n<p>Laboratory investigations will show\u00a0<strong>anemia</strong>, leucocytosis, elevated ESR, and\u00a0<strong>ANCA positivity.\u00a0</strong>Chest radiograph will show multiple bilateral <strong>cavitating nodules</strong> and pulmonary <strong>infiltrates</strong>.\u00a0</p>\n<p>The diagnosis is confirmed by the presence of <strong>necrotizing granulomatous vasculitis</strong> on biopsy. <strong>Pulmonary tissue</strong> is preferred for biopsy other tissues are obtained from the skin and upper airways and rarely in the kidneys.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ae98ed51881a4cf2b97e29f150fbe410.jpeg"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d96048a027c146f7baa734dfd21c0f99x358x285.PNG"
    ]
  },
  {
    "text": "A 32-year-old lady underwent copper-T IUCD insertion 2 months after the delivery of her baby.  She has now presented with pain abdomen. The tail of the IUCD is not visible. Her pelvic radiograph is shown below. The most appropriate step in the management of this patient is:",
    "choices": [
      {
        "id": 1,
        "text": "Removal using Shirodkar's hook"
      },
      {
        "id": 2,
        "text": "Removal by hysteroscopy"
      },
      {
        "id": 3,
        "text": "Removal by laparotomy"
      },
      {
        "id": 4,
        "text": "Wait for spontaneous expulsion"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">The given radiograph shows the IUCD <strong>outside</strong> the <strong>uterine cavity</strong>, most likely due to <strong>perforation.\u00a0</strong>The most appropriate step in the management of this patient is the<strong> removal </strong>of the<strong> IUCD </strong>by<strong> laparotomy.\u00a0</strong></p>\n<p class=\"p1\">The\u00a0tail of the IUCD is not visible when the<strong>\u00a0IUCD is misplaced. </strong>The reasons for misplaced IUCD include:</p>\n<ul>\n<li class=\"p1\">Enlargement of the uterus due to pregnancy</li>\n<li class=\"p1\">Curling of the threads inside the uterus</li>\n<li class=\"p1\">Perforation of the uterus</li>\n<li class=\"p1\">IUCD buried in the myometrium</li>\n<li class=\"p1\">Spontaneous expulsion</li>\n</ul>\n<p class=\"p1\">A <strong>plain X-ray</strong>\u00a0or\u00a0<strong>pelvic ultrasound</strong>\u00a0is used in the localization of the IUCD when the IUCD threads cannot be visualized.\u00a0In this patient, the misplaced IUCD is seen laterally displaced in the pelvic cavity. An <strong>abnormal location</strong> or abnormal shape of IUCD indicates likely <strong>perforation</strong> of the uterus.\u00a0</p>\n<p class=\"p1\"><strong>Perforation</strong> can occur either\u00a0at the time of insertion (immediate traumatic perforation) or\u00a0due to gradual erosion of the myometrium (secondary perforation). The <strong>risk factors</strong> for uterine perforation include:</p>\n<ul>\n<li class=\"p1\">Insertion by less experienced clinicians</li>\n<li class=\"p1\"><strong>Post-partum insertion</strong> (&lt;6 months since delivery)</li>\n<li class=\"p1\">A higher number of previous abortions</li>\n<li class=\"p1\">Lower parity</li>\n<li class=\"p1\">Lactation</li>\n</ul>\n<p>Management:</p>\n<p>If the location of the <strong>IUCD</strong> is <strong>inside</strong> the <strong>uterine cavity</strong>, it can be removed using <strong>Shirodkar's hook</strong> (Option A), a curette, or a <strong>hysteroscope</strong> (option B) and ultrasound guidance.</p>\n<p>In perforation of the uterus, a <strong>laparotomy</strong> is done as copper-T gets adhered to the omentum or gut and will be difficult to be removed using a laparoscope.</p>\n<p class=\"p1\">Other options:</p>\n<p class=\"p1\">Option D- Spontaneous expulsion is one of the reasons for misplaced IUCD. It is not a management approach.\u00a0The factors that are associated with increased risk of spontaneous expulsion of the IUCD are age &lt;20 years and nulliparity. Expulsion tends to occur at the time of menstruation and is associated with cramping, bleeding, and vaginal discharge.</p>\n<p class=\"p1\">Here the IUCD has caused perforation of the uterus and is lodged outside the uterus, hence,\u00a0<strong>spontaneous expulsion</strong> will <strong>not </strong>be <strong>possible.\u00a0</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f17d5223c1d34665b86f1f30091eb0ca.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "An 18-year-old boy presents to the orthopedic unit with a cubitus valgus deformity. He gives a history of fracture at the elbow when he was a kid and showed the below radiograph that was taken at the time of fracture. Which of the following nerves will be at risk of palsy in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Median nerve"
      },
      {
        "id": 2,
        "text": "Ulnar nerve"
      },
      {
        "id": 3,
        "text": "Radial nerve"
      },
      {
        "id": 4,
        "text": "Anterior interosseous nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The<strong> ulnar nerve</strong> will be at risk of palsy in this patient.\u00a0</p>\n<p>The image shows<strong> lateral condyle fracture</strong> of the <strong>humerus</strong>. <strong>Non-union</strong> of this fracture results in <strong>cubitus valgus</strong> deformity. The cubitus valgus deformity leads to the stretching of the <strong>ulnar nerve</strong> resulting in classic neuropathic symptoms which is termed as <strong>tardy ulnar nerve palsy</strong>. Paresthesia in the ulnar nerve distribution with atrophy of the intrinsic hand muscles can be seen. It can be treated with ulnar nerve transposition and cubitus valgus correction.</p>\n<p>Lateral condyle fractures usually occur between the age group 4-6 years and are due to fall on an outstretched hand that results in avulsion of the lateral condyle of the humerus.\u00a0</p>\n<p>The elbow will be swollen and deformed with tenderness over the lateral condyle. Diagnosis is by the different views in a radiograph.</p>\n<p>Treatment: An <strong>undisplaced fracture</strong> can be treated with a<strong> long-arm cast</strong> for<strong> 4-6 weeks</strong> and monitored closely for any late displacements. A <strong>displaced fracture</strong> should be treated with <strong>open reduction</strong> and <strong>internal fixation.</strong></p>\n<p>The lateral condylar fracture can lead to various complications including physeal arrest, physeal stimulation, osteonecrosis, and non-union with resultant cubitus valgus. <strong>Osteonecrosis</strong> of the <strong>capitellum</strong> results in a <strong>fish-tail deformity</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/09a7560cfc534fe5afa722901bae769f.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3eba847b31994ddba6beb3350e8f4928x720x812.JPEG"
    ]
  },
  {
    "text": "The cystographic evaluation of a woman with recurrent urinary tract infection is given below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Thimble bladder"
      },
      {
        "id": 2,
        "text": "Neurogenic bladder"
      },
      {
        "id": 3,
        "text": "Bladder carcinoma"
      },
      {
        "id": 4,
        "text": "Schistosomiasis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given cystogram shows an <strong>elongated</strong> and <strong>pointed\u00a0bladder</strong> with a <strong>thickened trabeculated wall, </strong>called a <strong>Christmas tree </strong>or<strong> pine cone</strong> bladder<strong>. </strong>This is seen in patients with <strong>severe neurogenic bladder</strong> and\u00a0increased sphincter tone.</p>\n<p>Neurogenic bladder is a term applied to a <strong>dysfunctional</strong> urinary bladder that results from an injury to the <strong>central</strong> or <strong>peripheral nerves</strong> that control and regulate urination. It causes <strong>detrusor sphincter dyssynergia.</strong> Neurogenic bladder typically occurs due to suprasacral lesions (above S2-S4) or apical lesions (in and around S2-S4).</p>\n<p>Pine cone bladder is <strong>not</strong> pathognomonic of a neurogenic bladder. It may also be seen in patients with lesions anywhere along the sacral reflex arc.\u00a0Occasionally, it is also seen in bladder neck obstruction of a non-neurogenic cause.</p>\n<p>Other options:</p>\n<p>Option A: Tuberculous cystitis results in<strong> fibrosis </strong>and <strong>stiffening</strong> of the entire urinary bladder, leading to an inability to expand and a significant <strong>reduction</strong> in bladder <strong>capacity</strong>, as depicted in the image below. The medical term for this feature on micturating cystourethrogram (MCU) is a <strong>thimble bladder.\u00a0</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/64df5a840bea4971b64259812d65d8ca.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/35858ff4077946f6a25ee5ef4e6fcfa9x720x503.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/04603ce0c1df46bf941ca0d7610501f2x720x463.PNG"
    ]
  },
  {
    "text": "A 34-year-old female patient presents with complaints of chronic cough, fatigue, joint pains,  and swelling of both cheeks. She also complains of painful rashes on her knees which were diagnosed as erythema nodosum. On examination, the pulse rate is 90/min, respiratory rate is 19/min, and blood pressure is 120/80 mm Hg. Her chest X-Ray is shown below. Which of the following is likely to be seen in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Hypercalcemia"
      },
      {
        "id": 2,
        "text": "Positive tuberculin test"
      },
      {
        "id": 3,
        "text": "Stratosphere sign"
      },
      {
        "id": 4,
        "text": "Elevated ACTH"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical features, X-ray showing <strong>bilateral hilar lymphadenopathy,</strong> together with the presence of <strong>erythema nodosum</strong>, suggests the diagnosis of\u00a0<strong>sarcoidosis</strong>.\u00a0<strong>Hypercalcemia</strong> is seen in patients with sarcoidosis.\u00a0</p>\n<p><strong>Sarcoidosis</strong> is a granulomatous disorder of unknown etiology that is characterized by the presence of non-caseating granulomas.</p>\n<p>In acute cases, patients may typically present with\u00a0<strong>Lofgren\u2019s</strong> <strong>syndrome</strong>, consisting of<strong> arthritis, erythema nodosum</strong>,<strong>\u00a0</strong>uveitis,<strong>\u00a0bilateral hilar lymphadenopathy,\u00a0</strong>lethargy, and occasional fever. Patients may also present with insidious onset of cough, breathlessness, and radiographic infiltrates.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>An image of <strong>erythema nodosum</strong> is shown below:</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/625959ab15204ac0929042cc286bd697.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f81649b3dd884b65adfb6c8bee7f41e7x800x562.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6614d2b8cffc44f5b9f3e7f707fbd70bx1087x1754.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eaff5d6786fb4d90920eb2738bbd2e3ax720x496.PNG"
    ]
  },
  {
    "text": "The renal angiographic picture of a patient is given below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Fibromuscular dysplasia"
      },
      {
        "id": 2,
        "text": "Renal artery thrombosis"
      },
      {
        "id": 3,
        "text": "Hypertensive nephrosclerosis"
      },
      {
        "id": 4,
        "text": "Renal artery aneurysm"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given renal angiographic image depicts the '<strong>string of beads' </strong>sign, characterized by alternating areas of stenoses and small aneurysms in the renal arteries. This appearance is typical of <strong>fibromuscular dysplasia,</strong>\u00a0a renovascular cause of secondary hypertension.</p>\n<p>Fibromuscular dysplasia is a <strong>segmental</strong>, non-atheromatous, dysplastic type of <strong>angiopathy</strong> characterized by <strong>focal irregular thickening</strong> in medium and large muscular arteries predominantly affecting <strong>females</strong>. The most common subtype is <strong>medial fibroplasia</strong>. The most common sites of involvement in decreasing order of frequency are as follows:<strong> Renal arteries</strong> &gt; carotid arteries &gt; peripheral (limb) arteries - most commonly iliac arteries.</p>\n<p>The typical presentation is in the young person, commonly females with new-onset hypertension.\u00a0</p>\n<p>Medial fibroplasia is typically seen as a 'string of beads<strong>'</strong> appearance on <strong>CT angiography</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b90ad58c363940d88b92e277eda82cec.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old female patient came with complaints of backache. On radiography, the following image is obtained. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Eosinophilic granuloma"
      },
      {
        "id": 2,
        "text": "Hemangioma"
      },
      {
        "id": 3,
        "text": "Paget disease"
      },
      {
        "id": 4,
        "text": "Osteoporosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely diagnosis is&nbsp;<strong>hemangioma</strong>. The radiograph shows the vertebral body depicting vertical striations, giving a&nbsp;<strong>corduroy appearance.</strong></p>\n<p><strong>Hemangioma</strong> is typically a <strong>benign tumor</strong> of the vertebral body. This tumor is mostly clinically silent and is usually detected incidentally. The <strong>vertebral body</strong> is the most common location for hemangioma. The atypical location of hemangioma is the posterior elements of the vertebra and is indicative of an aggressive lesion. Symptomatic hemangiomas usually present with pain, neurologic compromise, or fractures.</p>\n<p><strong>Radiographs</strong> show large lesions with vertical striations and coarse, thick trabeculae, giving a <strong>corduroy appearance</strong>. On an <strong>axial computed tomography (CT) scan</strong>, hemangioma shows a classic <strong>polka dot appearance</strong>. Magnetic resonance imaging (MRI) is the standard for diagnosing hemangiomas.</p>\n<p>Treatment: Most hemangiomas do not require treatment. <strong>Vertebroplasty</strong> is useful in <strong>aggressive hemangiomas</strong>.&nbsp;</p>\n<p>The below CT image shows characteristic <strong>polka dot appearance</strong> (left) and&nbsp;<strong>corduroy appearance</strong> (right):</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4f6a66f560dd4c16b6c84a7ea237ecdc.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1fda8989273b4900a4f200de238455ccx720x397.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/29b5d022b2924403a29d656132629abax720x845.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9507ae845dc44d31be80a64230fc7fbdx720x860.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/30bc580af2a1459d914a55be54abfa43x720x1676.PNG"
    ]
  },
  {
    "text": "A middle-aged male patient presented with cough and hemoptysis. There is a history of loss of weight and appetite. On further evaluation, the patient is diagnosed with bronchogenic carcinoma. His chest X-ray is given below. Which of the following sign is seen in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Luftsichel sign"
      },
      {
        "id": 2,
        "text": "Westermark sign"
      },
      {
        "id": 3,
        "text": "Hampton's hump"
      },
      {
        "id": 4,
        "text": "Golden S sign"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>A Golden S sign</strong> is seen in this patient.</p>\n<p><strong>Golden S sign</strong> is a radiographical appearance seen in the <strong>right upper lobe collapse</strong> in <strong>bronchogenic carcinoma</strong>. Due to the central tumor mass associated with lobar collapse, the fissure will not be able to move as usual and it thus creates a bulge giving an S shape pattern on the radiograph. This S shape appearance is known as the <strong>Golden S sign</strong>. However, this sign is <strong>not specific</strong> to bronchogenic carcinoma and can occur in other etiologies involving lymphadenopathy or primary mediastinal tumors.</p>\n<p>Below is the radiograph showing the <strong>Golden S sign.\u00a0</strong>(The orange circle denotes the central tumor, and the green arrow represents the direction of expansion while inspiration)</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1d34d930bcd84873a642180cbca79110.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/65d86a3d2ff1454dbeae59b937988caex1024x1023.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3fde086af0234b53a6b5e7612dcc2d6dx720x598.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dbf9fe10a2a949baa04bcb334f63a740x402x371.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a13eaac176dc45029d7d39e0da370a61x1050x874.JPEG"
    ]
  },
  {
    "text": "A plain radiograph of a patient who was involved in a road traffic accident is as given below. During clinical examination his limb would be found to be:",
    "choices": [
      {
        "id": 1,
        "text": "Abducted and internally rotated"
      },
      {
        "id": 2,
        "text": "Adducted and externally rotated"
      },
      {
        "id": 3,
        "text": "Abducted and externally rotated"
      },
      {
        "id": 4,
        "text": "Adducted and internally rotated"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The plain radiograph of this patient shows&nbsp;<strong>anterior dislocation</strong> of the <strong>hip</strong>. On physical examination,&nbsp;the affected limb will be<strong>&nbsp;abducted </strong>and<strong> externally rotated.&nbsp;</strong></p>\n<p>Other findings in anterior dislocation of the hip joint include a slightly<strong> flexed</strong> limb and a prominent anterior bulge in the pubic or groin region.&nbsp;According to the position assumed by the femoral head, anterior dislocation of the hip can further be classified as -</p>\n<ul>\n<li>Type I - If the femoral head is felt anteriorly it is called as the&nbsp;<strong>superior/pubic&nbsp;type</strong></li>\n<li>Type II - If the femoral head is felt in the groin it is called as the&nbsp;<strong>inferior/obturator type</strong></li>\n</ul>\n<p>On an X-ray, the displaced <strong>femoral head</strong> will appear<strong> larger</strong> than the normal side. A lateral view X-ray will be confirmatory.&nbsp;</p>\n<p>The&nbsp;most common nerve&nbsp;injured in an anterior hip dislocation is the&nbsp;<strong>femoral nerve</strong>.</p>\n<p>Treatment of anterior dislocation includes a closed reduction under sedation or general anesthesia. If closed reduction fails, an open procedure may be planned.&nbsp;</p>\n<p>The image below shows, a patient with an externally rotated, abducted, and slightly flexed left leg due to <strong>anterior dislocation of the hip</strong>:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9dda8b971a7a485aa96aae38ab8f7e67.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c2fa78bf3f8d482f9adc155598c46553x285x174.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/68244c381a904bc789612797b4312f1ax781x600.PNG"
    ]
  },
  {
    "text": "A 5-year-old boy is brought to the emergency department with complaints of dysphagia, fever, stridor, drooling, and muffled voice. The following image is seen on a lateral x-ray of the neck. What is the finding seen in the given radiograph?",
    "choices": [
      {
        "id": 1,
        "text": "Steeple sign"
      },
      {
        "id": 2,
        "text": "Thumb sign"
      },
      {
        "id": 3,
        "text": "Adenoid hypertrophy"
      },
      {
        "id": 4,
        "text": "Omega shaped epiglottis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Thumb sign</strong> is seen on the given lateral view radiograph.</p>\n<p>The above clinical features of a&nbsp;toxic&nbsp;looking child with high-grade fever, tachypnea,&nbsp;stridor, dysphagia with salivary drooling are suggestive of&nbsp;<strong>acute epiglottitis</strong>.&nbsp;<strong>Thumb sign&nbsp;</strong>on lateral X-ray of neck is pathognomonic for <strong>acute epiglottitis</strong>.&nbsp;</p>\n<p><strong>Acute epiglottitis</strong> is an acute rapidly progressive confined to supraglottic structures i.e., epiglottis, aryepiglottic fold and arytenoids. It usually affects children of age <strong>2-7 years</strong>. It has a potentially fulminating course of fever, sore throat, dyspnea, and rapidly progressing respiratory obstruction.</p>\n<p>Management:</p>\n<p>Indirect laryngoscopy shows edema and congestion of supraglottic structures. A lateral X-ray of the neck shows swollen epiglottis giving an appearance called the thumb sign.</p>\n<p>Acute epiglottitis is a<strong>&nbsp;medical emergency</strong>&nbsp;due to sudden and unpredictable airway obstruction. The treatment includes the following:</p>\n<ul>\n<li>Admission to ICU</li>\n<li>Airway management - endotracheal intubation, tracheostomy for respiratory obstruction</li>\n<li>Antibiotics - <strong>Ampicillin </strong>or<strong> third-generation cephalosporin</strong>&nbsp;is indicated in the treatment of acute epiglottitis&nbsp;along with airway management.</li>\n<li>Dexamethasone may be given to reduce pharyngeal edema</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Steeple sign</strong> is seen in <strong>laryngotracheobronchitis</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3eacc64fcda04b78a60c7d9df5373f65.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8bc406afa34b45d29d8c64094b9a593cx1024x1024.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ed09b84243614f119ad9f3b956924fdax512x546.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b740e9204085422b8493441a102cf9fbx366x366.JPEG"
    ]
  },
  {
    "text": "A 23-year-old woman presents with a left-sided breast lump which she noticed only for the past 6 months but ignored. She has no other complaints. On palpation, the lump is mobile and firm. A mammogram revealed the following findings. What is the most probable diagnosis in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Duct ectasia"
      },
      {
        "id": 2,
        "text": "Fibroadenoma"
      },
      {
        "id": 3,
        "text": "Traumatic fat necrosis"
      },
      {
        "id": 4,
        "text": "Fibrocystic disease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p style=\"text-align: justify;\"><span style=\"font-size: 12pt;\">The most probable diagnosis is <strong>fibroadenoma.\u00a0</strong>The image shows <strong>popcorn calcifications</strong> in the breast mammogram which are characteristic of <strong>fibroadenoma</strong> of the breast.</span></p>\n<div class=\"page\" title=\"Page 863\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 12pt;\"><strong>Fibroadenomas</strong> are benign solid tumors composed of <strong>stromal</strong> and <strong>epithelial</strong> elements.</span></p>\n<p><span style=\"font-size: 12pt;\"><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Fibroadenomas present as <strong>firm masses</strong> that are easily <strong>movable</strong> and may <strong>increase</strong> in <strong>size</strong> over several months and <strong>wax</strong> and <strong>wane</strong> with the <strong>menstrual cycle. </strong></span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">They </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">slide</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> easily </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">under</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> the examining </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">fingers</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> and maybe </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">lobulated</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> or </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">smooth.</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> On <strong>excision,</strong> fibroadenomas are <strong>well-encapsulated</strong> masses.</span></span></p>\n<p><span style=\"font-size: 12pt;\"><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">On mammography, fibroadenomas show popcorn calcification. However, <strong>m</strong></span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">ammography cannot discriminate</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> between cysts and fibroadenomas. </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Ultrasonography</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> can be performed to distinguish between fibroadenoma and cysts.</span></span></p>\n<div class=\"page\" title=\"Page 863\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 863\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 863\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 863\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 12pt;\">Management includes <strong>reassurance</strong> of the patient. However, if the <strong>patient</strong> is <strong>bothered</strong> by the <strong>mass</strong> or if the <strong>mass</strong> continues to <strong>grow,</strong> it is removed with an <strong>open excisional biopsy</strong> or via a <strong>percutaneous approach.</strong></span></p>\n<p><span style=\"font-size: 12pt;\"><strong>Giant fibroadenoma</strong> is a type of fibroadenoma that attains an unusually large size (typically <strong>&gt;5 cm).</strong> The term <strong>juvenile fibroadenoma</strong> refers to a large fibroadenoma that occasionally occurs in adolescents and young adults and histologically is <strong>more cellular</strong> than the usual fibroadenoma.</span></p>\n<div class=\"page\" title=\"Page 863\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"text-align: justify; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; font-size: 12pt;\">Other types of calcifications on a mammogram:</span></p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p><span style=\"font-size: 12pt;\">A <strong>broken-needle</strong> type of calcification is seen in <strong>duct ectasia</strong> (option A)</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/76c52230189f41ef8107457d0f874c3d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/28779a15f1a54168b3c3e40ff8cfa9a8x841x1024.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2a91d423cf64414abf0b2862980f055dx172x227.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8229070771c64647a979e9ca2e3b86b9x512x559.PNG"
    ]
  },
  {
    "text": "A middle-aged patient with a duodenal diverticulum who underwent surgery the previous day and has been nil per os since the surgery complains of abdominal pain. The surgeon was wearing a bracelet with a coin attached during the surgery despite being warned by the nurse. The abdominal radiograph is shown below. Under which doctrine will the surgeon be held responsible?",
    "choices": [
      {
        "id": 1,
        "text": "Res indicata"
      },
      {
        "id": 2,
        "text": "Res ipsa loquitur"
      },
      {
        "id": 3,
        "text": "Contributory negligence"
      },
      {
        "id": 4,
        "text": "Medical maloccurrence"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows a&nbsp;<strong>coin in the abdomen</strong>&nbsp;that was absent before the surgery. As the patient was nil per os after the surgery, this implies that the coin from the bracelet had fallen inside the abdomen during the surgery and the surgeon completed the surgery without removing it. The surgeon will be held responsible under <strong>res ipsa loquitur.</strong></p>\n<p>Res ipsa loquitur means \"<strong>the thing or fact speaks for itself</strong>.\" It implies that the negligent act is so obvious that the patient need not prove the negligence. The patient has to only state the negligent act. This doctrine applies to both civil and criminal negligence. All of the following conditions should be fulfilled for this doctrine:</p>\n<ul>\n<li>In the absence of negligence, there would not have been any injury usually.</li>\n<li>The doctor had complete control over the injury-producing instrument or treatment.</li>\n<li>The patient was not a part of contributory negligence.</li>\n</ul>\n<p>Other options:</p>\n<p>Option A - <strong>Res&nbsp;indicata</strong>&nbsp;is a defense for the doctor against negligence. This specifies that a&nbsp;suit for damages for negligence should be filed against the doctor <strong>within two years</strong> from the date of alleged negligence. A suit&nbsp;filed beyond two years would be dismissed as it would be&nbsp;beyond the<strong> period of limitation.</strong></p>\n<p>Option C - <strong>Contributory negligence</strong> is the absence of ordinary care on the part of the patient or his personal attendant along with the doctor's negligence contributing to the injury without which the injury would not have occurred. It acts as a <strong>partial defense</strong> against negligence for the doctor. In the given scenario, the patient was nil per os, indicating that there was no provision for foreign body consumption and suggesting there is no contributory negligence by the patient.</p>\n<p>Option D - <strong>Medical maloccurrence</strong>&nbsp;occurs when the patient does not respond properly or faces adverse effects in spite of good attention and care by the doctor.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/be9fd77660de4aa7a5c109eee006333c.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "An elderly patient presented with easy fatiguability and backache. He has had recurrent infections in the past 3 months. Reports showed hypercalcemia. His skull x-ray is  below. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hyperparathyroidism"
      },
      {
        "id": 2,
        "text": "Multiple myeloma"
      },
      {
        "id": 3,
        "text": "Paget's disease"
      },
      {
        "id": 4,
        "text": "Eosinophilic granuloma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Multiple myeloma</strong> is the most likely diagnosis for this patient. The given radiograph represents the multiple well-defined,\u00a0<strong>punched-out lytic lesions</strong> of various sizes scattered throughout the skull, giving the<strong> raindrop skull appearance</strong>, which is seen in multiple myeloma.</p>\n<p>Multiple myeloma is the malignant production of\u00a0<strong>plasma cells</strong> that results in bone pain or fractures, renal failure, increased susceptibility to infections, anemia, hypercalcemia, and manifestations of hyperviscosity. The incidence of multiple myeloma increases with age, and it is more commonly seen in males than in females.</p>\n<p><strong>Bone pain</strong> is the most common symptom and is due to the proliferation of tumor cells, stimulation of osteoclasts that destroy the bone, and inhibition of osteoblast cells that form new bone resulting in osteolytic lesions. <strong>Recurrent infections</strong> in multiple myeloma are due to hypogammaglobulinemia. <strong>Hypercalcemia</strong> results from the chronic mobilization of calcium from bones.</p>\n<p><strong>Revised International Myeloma Working Group criteria for the diagnosis of multiple myeloma.</strong></p>\n<div class=\"page\" title=\"Page 844\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Clonal bone marrow plasma cells\u00a0<strong>\u226510%</strong>\u00a0(or) Biopsy-proven bony or extramedullary plasmacytoma</p>\n<p><strong>Plus</strong></p>\n<p>Any one<strong>\u00a0or more</strong>\u00a0of the following\u00a0<strong>myeloma-defining events</strong>:</p>\n<ul>\n<li><strong>Evidence of end-organ damage</strong>\u00a0attributable to the underlying plasma cell proliferative disorder: (specifically <strong>CRAB</strong>\u00a0features)\n<ul>\n<li>Hyper<strong>C</strong>alcemia: Serum calcium level &gt;1 mg/dL higher than the upper limit of normal or\u00a0<strong>&gt;11 mg/dL</strong></li>\n<li><strong>R</strong>enal insufficiency: Creatinine clearance of\u00a0<strong>&lt;40 mL/min</strong>\u00a0or serum creatinine level of\u00a0<strong>&gt;2 mg/dL</strong></li>\n<li><strong>A</strong>nemia: Hemoglobin level &gt;20 g/L (2 mg/dL) below the lowest limit of normal or hemoglobin level of\u00a0<strong>&lt;10 g/dL</strong></li>\n<li><strong>B</strong>one lesions:\u00a0<strong>One</strong>\u00a0or more osteolytic lesions on skeletal radiography, computed tomography (CT), or positron-emission tomography (PET)/CT</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li><strong>Any one or more</strong>\u00a0of the following biomarkers of malignancy:\n<ul>\n<li>Clonal bone marrow plasma cells\u00a0<strong>\u226560%</strong></li>\n<li>Serum involved/uninvolved free light-chain ratio of\u00a0<strong>100 or greater</strong></li>\n<li><strong>&gt;1</strong>\u00a0focal lesion on MRI that is\u00a0<strong>at least 5 mm</strong>\u00a0or greater in size</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<p>Option A - <strong>Hyperparathyroidism</strong> is characterized by multiple tiny, well-defined lucencies in the skull due to the resorption of trabecular bone, resulting in the\u00a0<strong>salt and pepper appearance</strong> or <strong>pepper pot skull.\u00a0</strong>The clinical features are mainly due to hypercalcemia and typically include anorexia, nausea, abdominal pain, depression, fatigue, and muscle weakness. Renal stones/nephrocalcinosis can occur due to hypercalciuria. Joint symptoms occur due to chondrocalcinosis.</p>\n<p>Other radiological findings in hyperparathyroidism:</p>\n<ul>\n<li><strong>Sub-periosteal resorption </strong>of<strong> middle phalanges </strong>-<strong>\u00a0</strong>Classical and pathognomonic feature of hyperparathyroidism</li>\n<li>Loss of lamina dura\u00a0</li>\n<li>An atypical cyst-like lytic lesion, otherwise known as <strong>brown tumor</strong>\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/71ad0b9aea114bee995de3cdc641c3cb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c3fbe8719a9f48b4889f01eb18d3cb6bx672x526.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/83d862ccf8c94ab3b1efba5eb13314acx720x555.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7e65a351f8d34cc8ba39fdd016b0a8e1x512x439.PNG"
    ]
  },
  {
    "text": "A 16-month-child is brought with a history of abdominal distension and delayed mental development. On examination, the cornea is cloudy and there appears to be hepatosplenomegaly. The radiograph of the child is given below. What is the probable diagnosis in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Tay-Sachs disease"
      },
      {
        "id": 2,
        "text": "Hurler\u2019s Syndrome"
      },
      {
        "id": 3,
        "text": "Gaucher\u2019s Disease"
      },
      {
        "id": 4,
        "text": "Hunter\u2019s Syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most probable diagnosis in this patient is <strong>Hurler's syndrome.</strong></p>\n<p>As the child presents with <strong>mental retardation, hepatosplenomegaly,</strong>&nbsp;<strong>cloudy cornea</strong> and given x-ray shows a <strong>J-shaped sella turcica and a thickened calvaria, </strong>the most likely diagnosis is<strong> Hurler's Syndrome.</strong></p>\n<p>Hurler's syndrome is also known as <strong>mucopolysaccharidosis&nbsp;1</strong>. This is due to the defect in the <strong>&alpha;-L iduronidase</strong> leading to the accumulation of <strong>heparan sulphate and dermatan sulphate</strong>.</p>\n<p>Radiological features in Hurler Syndrome:</p>\n<ul>\n<li>Macrocephaly</li>\n<li><strong>J-shaped sella </strong>(seen in above radiograph)</li>\n<li>Thickened calvaria (skull cap)</li>\n<li><strong>Oar-shaped ribs</strong> (seen below)</li>\n<li>Hook-shaped vertebral bodies</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d289ca70136741d29d1a17c8b8bc1a0e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e1359a7c84c8433a813aeb52cdb9de48x360x269.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/15fb810a4a3d4dd99ac927713e5ae7fbx360x265.JPEG"
    ]
  },
  {
    "text": "An elderly male patient is brought to the casualty with complaints of vomiting and severe abdominal pain. The abdomen appears grossly distended, is tender to touch, and percussion reveals hyper-resonance. His X-ray abdomen is shown in the image below. What is the next best step in the management of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Urgent colonoscopy"
      },
      {
        "id": 2,
        "text": "Laparotomy followed by sigmoid resection alone"
      },
      {
        "id": 3,
        "text": "Laparotomy followed by Hartmann\u2019s procedure"
      },
      {
        "id": 4,
        "text": "Insertion of a rectal tube through a flexible sigmoidoscope"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario and the X-ray radiograph showing characteristic <strong>coffee bean appearance&nbsp;</strong>are highly suggestive of&nbsp;<strong>sigmoid volvulus</strong>. Non-operative decompression followed by insertion of a<strong> rectal tube</strong> through a rigid proctoscope or a flexible sigmoidoscope is the next best step in the management of this patient.</p>\n<p><strong>Sigmoid volvulus</strong> is a cause of large bowel obstruction and occurs when the sigmoid colon twists on the sigmoid mesocolon. Symptoms<strong>&nbsp;</strong>include constipation, abdominal bloating, nausea, and/or vomiting. Onset may be acute or chronic. It occurs more commonly in patients with a history of mental illness and chronic constipation.</p>\n<p><strong>X-ray abdomen</strong>&nbsp;shows a large, dilated loop of the colon, often with a few air-fluid levels. Specific signs include the&nbsp;<strong>coffee bean sign </strong>and<strong>&nbsp;</strong>the<strong> absence of rectal gas.&nbsp;</strong><strong>CT</strong> may reveal large gas-filled loop without haustral markings, forming a closed-loop obstruction.</p>\n<p>Non-operative decompression is successful in treating 90% of the patients. The rectal tube should be left in place for 1-2 days to allow complete decompression and to prevent immediate recurrence of the volvulus. This should be followed by bowel cleansing with cathartics and a <strong>complete colonoscopic examination</strong>. In patients with signs of colonic necrosis or in whom endoscopic detorsion has failed, sigmoid colectomy with the closure of the rectum and end colostomy (<strong>Hartmann procedure</strong>) maybe required. Even if detorsion of the sigmoid is successful,<strong> elective sigmoid resection</strong> is indicated to prevent recurrence.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6c0d1607b1364176a72b38eb817f87d9.PNG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test 17- Radiographs Only';
        const quizFilename = 'mini-test-17-radiographs-only-6f3dc9d6.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>