<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharmacology Test - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Test Series Subject / 2024
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following is not an orphan drug?",
    "choices": [
      {
        "id": 1,
        "text": "Acetaminophen"
      },
      {
        "id": 2,
        "text": "Miltefosine"
      },
      {
        "id": 3,
        "text": "Succimer"
      },
      {
        "id": 4,
        "text": "Sodium nitrite"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Acetaminophen</strong> is not an orphan drug. It is an essential drug.</p>\n<p>Orphan drugs are <strong>drugs for rare diseases</strong>.</p>\n<p>Orphan drugs are for the treatment or prevention of rare diseases with little commercial value for pharmaceutical companies. Therefore, special incentives are given by the government for the pharmaceutical companies for the development and marketing of orphan drugs.</p>\n<p>Few examples of orphan drugs:</p>\n<ul>\n<li><strong>Miltefosine</strong></li>\n<li><strong>Sodium nitrite</strong></li>\n<li><strong>Succimer</strong></li>\n<li>Rifabutin</li>\n<li>Liposomal amphotericin B</li>\n<li>Fomepizole</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs is effective in the delayed phase of post-chemotherapy nausea and vomiting?",
    "choices": [
      {
        "id": 1,
        "text": "Granisetron"
      },
      {
        "id": 2,
        "text": "Aprepitant"
      },
      {
        "id": 3,
        "text": "Domperidone"
      },
      {
        "id": 4,
        "text": "Metoclopramide"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Aprepitant </strong>is the drug preferred for <strong>delayed onset vomiting after cancer chemotherapy</strong>.</p>\n<p><strong>Nausea and vomiting</strong> associated with <strong>chemotherapy</strong> occur in<strong> two phases</strong>:</p>\n<ul>\n<li><strong>The</strong> <strong>acute</strong> <strong>phase</strong> is seen <strong>within 24 hours</strong> and occurs in almost <strong>all patients</strong> receiving chemotherapy. In response to chemotherapeutic agents, the <strong>enterochromaffin</strong> <strong>cells</strong> in the small intestine secrete <strong>serotonin</strong>, which acts on the 5HT3 receptors and causes vomiting. This phase is treated by <strong>5HT3 antagonists\u00a0</strong>such as ondansetron, granisetron, and palanosetron.\n<div class=\"page\" title=\"Page 941\">\u00a0</div>\n</li>\n<li><strong>The</strong> <strong>delayed</strong> <strong>phase</strong> is seen on <strong>days 2-5</strong> and occurs only in <strong>some patients</strong>. It occurs in response to stimulation of <strong>NK-1</strong> receptors by <strong>substance P</strong>. <strong>5HT3 antagonists are not effective</strong> against the delayed phase, and <strong>NK-1 receptor antagonists</strong>\u00a0<strong>are used</strong> in these patients.\u00a0</li>\n</ul>\n<p><strong>NK-1 receptor antagonists</strong> include <strong>aprepitant</strong> and its parenteral formulation, <strong>fosaprepitant</strong>, <strong>rolapitant,</strong> and <strong>netupitant</strong>. These drugs are usually administered in combination with 5HT3 antagonists and dexamethasone for highly emetogenic chemotherapy. A <strong>fixed-dose combination of netupitant and palanosetron</strong> has been <strong>approved</strong> to cover both the acute and delayed phase of post-chemotherapy nausea and vomiting.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient experienced two acute asthma exacerbations within one month despite ongoing therapy. Which of the following systemic steroids is suitable for her treatment?",
    "choices": [
      {
        "id": 1,
        "text": "Ciclesonide"
      },
      {
        "id": 2,
        "text": "Beclomethasone"
      },
      {
        "id": 3,
        "text": "Prednisolone"
      },
      {
        "id": 4,
        "text": "Budesonide"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"text-align: left;\"><strong>Prednisolone </strong>is a <strong>systemic steroid </strong>used for <strong>maintenance therapy </strong>after an acute exacerbation of asthma.</p>\n<p style=\"text-align: left;\">Intravenous corticosteroids such as hydrocortisone are indicated if the lung function is predicted to be &lt;30% or if there's poor response to nebulized \u03b2<sub>2\u00a0</sub>agonists. After the exacerbation, oral predisolone can be substituted with maximal beneficial effect at 30-40mg daily.</p>\n<p><strong>Inhaled corticosteroids</strong> commonly used in asthma are:</p>\n<ul>\n<li style=\"text-align: justify;\">Beclomethasone dipropionate</li>\n<li style=\"text-align: justify;\">Budesonide</li>\n<li style=\"text-align: justify;\">Ciclesonide</li>\n<li style=\"text-align: justify;\">Fluticasone</li>\n<li style=\"text-align: justify;\">Mometasone</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the mechanism of action of exenatide, that is used in the treatment of type 2 diabetes mellitus?",
    "choices": [
      {
        "id": 1,
        "text": "It is a DPP-4 inhibitor"
      },
      {
        "id": 2,
        "text": "It is a GLP 1 analogue"
      },
      {
        "id": 3,
        "text": "It inhibits SGLT-2"
      },
      {
        "id": 4,
        "text": "It is an amylin analogue"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Exenatide is a GLP-1 (glucagon-like peptide-1) receptor agonist. It stimulates insulin secretion, inhibits glucagon release, delays gastric emptying, reduces food intake, and normalizes fasting and postprandial insulin secretion. It is given subcutaneously. It can also cause pancreatitis, and therefore is not used in patients with a history or risk of developing pancreatitis.\\n\\nGLP-1 analogs are peptides and generally given other than oral routes due to degradation by intestinal peptidases. But semaglutide was synthesized by adding sodium caprylate which increases its permeability and leads to its absorption before it gets degraded. Hence, it enabled oral usage of a GLP-1 analog.\\n\\nThe American Diabetes Association recommends GLP-1 receptor agonists with proven cardiovascular benefit for add-on therapy in patients with type 2 diabetes and established atherosclerotic cardiovascular disease after metformin and lifestyle intervention.\\n\\nMechanism of Action:\\n\\nGLP-1 receptor agonists stimulate glucose-dependent insulin secretion from pancreatic \u03b2-cells, suppress glucagon secretion from pancreatic \u03b1-cells, and delay of gastric emptying.&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:4737,&quot;3&quot;:{&quot;1&quot;:0},&quot;10&quot;:2,&quot;12&quot;:0,&quot;15&quot;:&quot;Arial&quot;}\"><strong>Exenatide </strong>is a <strong>GLP-1</strong> (glucagon-like peptide-1) <strong>receptor agonist.</strong> It stimulates <strong>insulin secretion</strong>, inhibits glucagon release, delays gastric emptying, reduces food intake, and normalizes fasting and postprandial insulin secretion. It is given subcutaneously. It can also cause <strong>pancreatitis</strong>, and therefore is not used in patients with a history or risk of developing pancreatitis.<br /><br /><strong>GLP-1 analogs</strong> are peptides and are generally given other than oral routes due to degradation by intestinal peptidases. But semaglutide was synthesized by adding sodium caprylate which increases its permeability and leads to its absorption before it gets degraded. Hence, it enabled oral usage of a GLP-1 analog.<br /><br /><strong>Mechanism of Action:\u00a0</strong></span><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Exenatide is a GLP-1 (glucagon-like peptide-1) receptor agonist. It stimulates insulin secretion, inhibits glucagon release, delays gastric emptying, reduces food intake, and normalizes fasting and postprandial insulin secretion. It is given subcutaneously. It can also cause pancreatitis, and therefore is not used in patients with a history or risk of developing pancreatitis.\\n\\nGLP-1 analogs are peptides and generally given other than oral routes due to degradation by intestinal peptidases. But semaglutide was synthesized by adding sodium caprylate which increases its permeability and leads to its absorption before it gets degraded. Hence, it enabled oral usage of a GLP-1 analog.\\n\\nThe American Diabetes Association recommends GLP-1 receptor agonists with proven cardiovascular benefit for add-on therapy in patients with type 2 diabetes and established atherosclerotic cardiovascular disease after metformin and lifestyle intervention.\\n\\nMechanism of Action:\\n\\nGLP-1 receptor agonists stimulate glucose-dependent insulin secretion from pancreatic \u03b2-cells, suppress glucagon secretion from pancreatic \u03b1-cells, and delay of gastric emptying.&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:4737,&quot;3&quot;:{&quot;1&quot;:0},&quot;10&quot;:2,&quot;12&quot;:0,&quot;15&quot;:&quot;Arial&quot;}\">GLP-1 receptor agonists <strong>stimulate glucose-dependent insulin secretion</strong> from pancreatic \u03b2-cells, suppress glucagon secretion from pancreatic \u03b1-cells, and delay gastric emptying.</span></p>\n<p><strong>GLP-1 analogs: Exenatide</strong> ,<strong>Liraglutide</strong> ,Albiglutide ,Dulaglutide, <strong>Lixisenatide</strong> ,<strong>Semaglutide</strong></p>\n<p><strong>Other options:</strong></p>\n<p><strong>Option A:\u00a0Linagliptin\u00a0</strong>is a\u00a0d<strong>ipeptidyl-peptidase-4\u00a0(DPP-4)\u00a0inhibitor. </strong>It is used in type 2 diabetes as monotherapy or in combination therapy when metformin is not tolerated or contraindicated. It\u00a0binds extensively to plasma proteins and is cleared\u00a0primarily by the hepatobiliary system.\u00a0Hence, no dosage adjustment is needed in renal failure.</p>\n<p><strong>Option C: Canagliflozin </strong>is a<strong>\u00a0sodium-glucose transporter 2\u00a0(SGLT-2)\u00a0inhibitor. </strong>Other SGLT-2 inhibitors include dapagliflozin and empagliflozin. They act by\u00a0inhibiting the\u00a0SGLT-2 transporter which is present on the\u00a0proximal\u00a0segment of the\u00a0renal tubule. It is responsible for the reabsorption of 80-90% of filtered glucose.\u00a0It\u00a0inhibits glucose reabsorption resulting in glycosuria and a change in the renal threshold.</p>\n<p><strong>Option D: Pramlintide\u00a0</strong>is an islet amyloid polypeptide (IAPP) or<strong> amylin analog.\u00a0</strong>Amylin analogs reduce glucagon secretion, slow gastric emptying, and centrally decrease appetite.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs come under Schedule H of the Drugs and Cosmetics Act, 1945?",
    "choices": [
      {
        "id": 1,
        "text": "Biologicals and special products like insulin, toxin and antitoxins"
      },
      {
        "id": 2,
        "text": "Bacterial vaccines"
      },
      {
        "id": 3,
        "text": "Drugs  purchased with the prescription of a qualified doctor"
      },
      {
        "id": 4,
        "text": "Drugs with a warning label  \u201cCaution: it is dangerous to take this preparation except under medical supervision\u201d"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Schedule H</strong> includes drugs purchased over the counter with the prescription of a qualified doctor.</p>\n<p><strong>The Drugs and Cosmetics Rules</strong>, classify drugs under different schedules based on their potential for abuse, their therapeutic value, and other factors. The rules provide guidelines for the storage, sale, display, and prescription of each schedule.</p>\n<p>Other options:</p>\n<p>Option A- Biological and special products like insulin, toxin, and antitoxins are included under\u00a0<strong>Schedule C.</strong></p>\n<p>Option B- Bacterial vaccines are included under\u00a0<strong>Schedule F I.</strong></p>\n<p>Option D- Drugs that should be labelled with the words \u201cCaution: it is dangerous to take this preparation except under medical supervision\u201d are included under\u00a0<strong>Schedule G.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements about methotrexate is false?",
    "choices": [
      {
        "id": 1,
        "text": "Folinic acid enhances its action"
      },
      {
        "id": 2,
        "text": "It inhibits dihydrofolate reductase"
      },
      {
        "id": 3,
        "text": "Non-proliferative cells are resistant to it"
      },
      {
        "id": 4,
        "text": "It targets the S-phase of the cell cycle"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Folinic acid,\u00a0</strong>also known as\u00a0leucovorin, the active form of folic acid,<strong>\u00a0</strong>is administered <strong>with methotrexate</strong> to <strong>reduce the toxicity</strong> associated with higher doses. It does not enhance the action of methotrexate.</p>\n<p><strong>Methotrexate</strong> is an antimetabolite that <strong>inhibits dihydrofolate reductase</strong>.\u00a0It is a cell cycle (S-phase) specific antineoplastic agent and non-proliferative cells are relatively resistant to it.\u00a0</p>\n<p><strong>Bone marrow suppression</strong> and\u00a0gastrointestinal mucosa inflammation (<strong>mucositis</strong>) are the common <strong>side effects</strong> seen due to inhibition of DNA synthesis.\u00a0</p>\n<p><strong>Methotrexate toxicity:</strong></p>\n<ul>\n<li><strong>Prevention -</strong>\u00a0administration of <strong>leucovorin/folinic acid</strong>.</li>\n<li><strong>Treatment -</strong>\u00a0maintaining<strong> adequate hydration</strong> and <strong>forced alkaline diuresis</strong> in patients with normal renal function.</li>\n<li>Glucarpidase\u00a0is an intravenous drug administered in patients\u00a0who have<strong>\u00a0</strong>impaired renal function.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "High-ceiling diuretics are used in the treatment of all of the following conditions except:",
    "choices": [
      {
        "id": 1,
        "text": "Generalised edema"
      },
      {
        "id": 2,
        "text": "Cerebral edema"
      },
      {
        "id": 3,
        "text": "Acute pulmonary edema"
      },
      {
        "id": 4,
        "text": "Pulmonary hypertension"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>High-ceiling diuretics</strong>\u00a0or loop diuretics are not used in pulmonary hypertension.</p>\n<p>Their <strong>diuretic property</strong> helps in removing the excess fluid in hepatic, renal, and cardiac diseases and their<strong> vasodilatory</strong> and diuretic action is helpful for the quick relief of symptoms in <strong>LVF</strong> and <strong>acute</strong>\u00a0<strong>pulmonary edema</strong>. They are also used for the treatment of <strong>chronic CHF.</strong></p>\n<p>Pulmonary artery hypertension\u00a0is a condition where there is increased pulmonary vascular resistance. Since nitric oxide is an important regulator of pulmonary vascular resistance, <strong>PDE5 inhibitors like sildenafil, vardenafil, or tadalafil</strong> are primarily used in the treatment of pulmonary arterial hypertension.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Generalized edema </strong>occurs due to fluid retention in systemic tissues, commonly seen in conditions like heart failure, nephrotic syndrome, or chronic kidney disease. High-ceiling diuretics are effective here as they can rapidly reduce extracellular fluid volume by promoting diuresis.</p>\n<p>Option B: Although loop diuretics are not the first-line treatment for <strong>cerebral edema</strong>, they may be used in conjunction with other therapies like mannitol to reduce intracranial pressure by decreasing overall fluid volume</p>\n<p>Option C: Loop diuretics help reduce <strong>pulmonary congestion</strong> by decreasing preload and promoting diuresis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The given image shows the synthesis and release of GABA in the nerve terminal. Identify the drug that acts at site A.",
    "choices": [
      {
        "id": 1,
        "text": "Benzodiazepines"
      },
      {
        "id": 2,
        "text": "Tiagabine"
      },
      {
        "id": 3,
        "text": "Baclofen"
      },
      {
        "id": 4,
        "text": "Gabapentin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The drug that acts at the site 'A' is <strong>baclofen.</strong></p>\n<p>Baclofen is a\u00a0<strong>centrally-acting muscle relaxant.\u00a0</strong>It is an analog of the <strong>inhibitory transmitter GABA</strong> and acts as a selective\u00a0<strong>GABA<sub>B</sub></strong>\u00a0receptor agonist. It also acts at the spinal cord where it decreases excitatory transmitter release of excitatory neurotransmitter release.</p>\n<p>Baclofen is used for the treatment of\u00a0<strong>spasticity</strong>\u00a0in <strong>multiple sclerosis</strong>, amyotrophic lateral sclerosis, <strong>spinal injuries</strong>, and flexor spasm. In these conditions, baclofen is the preferred drug for symptomatic relief.</p>\n<p>It can also be administered intrathecally around the spinal cord through a catheter placed surgically. Side effects of baclofen include drowsiness, mental confusion, weakness, and ataxia.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f834ef19d22443a591b20771ab352c7d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/95307c7a27034d05a36b41bce22bda52x1280x1618.JPEG"
    ]
  },
  {
    "text": "What is the mechanism of action of doxycycline?",
    "choices": [
      {
        "id": 1,
        "text": "Cell wall synthesis inhibitor"
      },
      {
        "id": 2,
        "text": "Protein synthesis inhibitor"
      },
      {
        "id": 3,
        "text": "DNA gyrase inhibitor"
      },
      {
        "id": 4,
        "text": "Leucyl-tRNA synthetase inhibitor"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Doxycycline</strong> is a <strong>tetracycline</strong> that acts by <strong>inhibiting protein synthesis</strong>.</p>\n<p>Protein synthesis Inhibitors:</p>\n<p><span data-preserver-spaces=\"true\">Antibacterial drugs which bind to the\u00a0<strong>30s</strong>\u00a0subunit of the 70s ribosome are given below:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Tetracyclines</span></li>\n<li><span data-preserver-spaces=\"true\">Aminoglycosides</span></li>\n</ul>\n<p><span data-preserver-spaces=\"true\">Antibacterial drugs which bind to<strong>\u00a0the 50s</strong>\u00a0subunit of 70s ribosome are given below:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Macrolides</span></li>\n<li><span data-preserver-spaces=\"true\">Clindamycin</span></li>\n<li><span data-preserver-spaces=\"true\">Streptogramins</span></li>\n<li><span data-preserver-spaces=\"true\">Chloramphenicol</span></li>\n<li><span data-preserver-spaces=\"true\">Linezolid</span></li>\n</ul>\n<p><strong>Other options:</strong></p>\n<p><strong>Options A:</strong>\u00a0<strong>Cefotetan</strong> and oxacillin are beta-lactam antibiotics that act by inhibiting <strong>cell wall synthesis.</strong></p>\n<p><strong>Option C:</strong>\u00a0<strong>Ciprofloxacin</strong> is a fluoroquinolone that acts by<strong> inhibiting DNA gyrase.</strong></p>\n<p><strong>Option D: Tavaborole inhibits</strong> fungal <strong>leucyl-tRNA synthetase,</strong> thereby inhibiting fungal protein synthesis and finally resulting in fungal cell death.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient scheduled for a CABG procedure receives preoperative heparin for anticoagulation. During the surgery, the patient starts bleeding massively and there is a drop in BP. Which of the following would you use to manage this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Protamine sulfate"
      },
      {
        "id": 2,
        "text": "Prothrombin complex concentrate"
      },
      {
        "id": 3,
        "text": "Aminocaproic acid"
      },
      {
        "id": 4,
        "text": "Tranexamic acid"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p style=\"text-align: justify;\"><strong>Protamine sulfate </strong>is the drug used to treat life-threatening, <strong>heparin-induced bleeding</strong>.</p>\n<p style=\"text-align: justify;\">It is a mixture of basic polypeptides isolated from <strong>salmon sperm</strong>.\u00a0It binds to acidic heparin with high affinity and neutralizes anticoagulant activity. The resultant protamine-heparin complexes are cleared. Protamine binds only to <strong>long heparin </strong>molecules (UFH). Therefore, protamine only <strong>partially reverses</strong>\u00a0the activity of <strong>LMWH</strong> and has <strong>no effect</strong> on\u00a0<strong>fondaparinux</strong>.\u00a0</p>\n<p class=\"p1\" style=\"text-align: justify;\">It is most commonly used to neutralize heparin-induced anticoagulation after separation from cardiopulmonary bypass. It is also utilized in the setting of dialysis, invasive vascular procedures, and acute ischemic strokes.</p>\n<p class=\"p1\" style=\"text-align: justify;\">Note: Protamine sulfate has<strong> anticoagulant activity</strong> at <strong>higher doses</strong> and hence, only small amounts of protamine (1mg/100 units of heparin) are used for heparin-induced bleeding.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient on long-term anticoagulation therapy with warfarin, would need an increase in dosage when coadministered with which of the following drugs?",
    "choices": [
      {
        "id": 1,
        "text": "Captopril"
      },
      {
        "id": 2,
        "text": "Erythromycin"
      },
      {
        "id": 3,
        "text": "Rifampicin"
      },
      {
        "id": 4,
        "text": "Cimetidine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A patient on long-term anticoagulation therapy with <strong>warfarin</strong> would need an <strong>increased in dosage&nbsp;</strong>when coadministered with <strong>rifampicin</strong>.&nbsp;This is because <strong>rifampicin</strong> is a potent <strong>microsomal enzyme inducer&nbsp;</strong>and can decrease the effect of warfarin.</p>\n<p>Warfarin is cleared <strong>hepatically</strong> primarily via the CYP2C9 enzyme.</p>\n<p>Rifampicin induces <strong>CYP3A</strong> and <strong>CYP2D6</strong> enzymes.&nbsp;</p>\n<p>Enzyme inducers:</p>\n<ul>\n<li>CYP3A\n<ul>\n<li>Carbamazepine</li>\n<li>Phenobarbitone (CYP2B1)</li>\n<li>Rifampicin (CYP2D6)</li>\n<li>Phenytoin</li>\n<li>Glucocorticoids</li>\n</ul>\n</li>\n<li>CYP2E1\n<ul>\n<li>Isoniazid</li>\n<li>Chronic alcoholism</li>\n</ul>\n</li>\n</ul>\n<p>Note:&nbsp;Isoniazid is an inducer for CYP2E1 but an inhibitor for CYP3A4</p>\n<p>&nbsp;</p>\n<table style=\"height: 150px;\" width=\"453\">\n<tbody>\n<tr>\n<td style=\"width: 180.547px; text-align: center;\"><strong>Enzyme inducers</strong></td>\n<td style=\"width: 256.453px; text-align: center;\"><strong>Enzyme inhibitors</strong></td>\n</tr>\n<tr>\n<td style=\"width: 180.547px;\">\n<p>Mnemonic: CRAP GPS</p>\n<ul>\n<li><strong>C</strong>arbamezepine</li>\n<li><strong>R</strong>ifampicin</li>\n<li><strong>A</strong>lcohol (chronic)</li>\n<li><strong>P</strong>henytoin</li>\n<li><strong>G</strong>riseofulvin</li>\n<li><strong>P</strong>henobarbitone</li>\n<li><strong>S</strong>ulfonylureas</li>\n</ul>\n</td>\n<td style=\"width: 256.453px;\">\n<p>Mnemonic:&nbsp;RED VICK</p>\n<ul>\n<li><strong>R</strong>itonavir</li>\n<li><strong>E</strong>rythromycin</li>\n<li><strong>D</strong>iltiazem</li>\n<li><strong>V</strong>erapamil,&nbsp;Valproate</li>\n<li><strong>I</strong>traconazole</li>\n<li><strong>C</strong>larithromycin,&nbsp;Cimetidine</li>\n<li><strong>K</strong>etoconazole</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While working as a resident in a hospital, you are asked by the consultant to prescribe a certain proton-pump inhibitor (PPI). It should be given only orally once daily before breakfast, even though it has a half-life of no more than 3 hours. What is the rationale behind this once-daily dosing?",
    "choices": [
      {
        "id": 1,
        "text": "The drug can inhibit all gastric pumps."
      },
      {
        "id": 2,
        "text": "The drug irreversibly inactivates the pump molecule."
      },
      {
        "id": 3,
        "text": "The drug is gradually released irrespective of its formulation."
      },
      {
        "id": 4,
        "text": "The drug suppresses basal but not stimulated acid production."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The rationale behind the once-daily dosing is that the drug&nbsp;<strong>irreversibly inactivates</strong> the pump molecule.</p>\n<p>Proton-pump inhibitors (PPIs) are <strong>prodrugs</strong> that are activated only after undergoing an acid-catalyzed cleavage in the canaliculi of the parietal cells of the stomach.</p>\n<p>On administration, they are absorbed in the proximal small bowel and eventually, block the&nbsp;H<sup>+</sup>/K<sup>+</sup> ATPase enzyme, the \"proton pump\" in the parietal cells of the stomach. The <strong>secretion</strong> of<strong> protons</strong> by an activated <strong>H<sup>+</sup>/K<sup>+</sup>- ATPase</strong> (proton pump) in the <strong>parietal cells</strong> into the gastric lumen is the <strong>final step</strong> involved in the production of<strong> gastric acid</strong>&nbsp;and inhibition of this enzyme prevents acid secretion into the stomach.</p>\n<p>Once PPIs irreversibly inactivate the H<sup>+</sup>K<sup>+</sup>-ATPase pump, acid secretion resumes only after new pump molecules are synthesized and inserted into the luminal membrane. This leads to <strong>prolonged suppression of acid secretion</strong> for up to 24-48 hours, despite having a shorter plasma half-life of only 30 minutes to 3 hours.</p>\n<p>In most individuals, once-daily dosing is enough to achieve effective acid inhibition. If necessary, a second dose can be given before an evening meal.</p>\n<p>The number of H<sup>+</sup>K<sup>+</sup>-ATPase pump molecules increases after fasting and food decreases the oral bioavailability of the drug. Hence, PPIs are given around 30 minutes before the first meal of the day.</p>\n<p>PPIs <strong>cannot inhibit</strong> all gastric acid pumps with oral dosing because <strong>not all pumps are active</strong> during the short half-life of the PPI in the blood.&nbsp;</p>\n<p>PPIs cause maximum suppression of gastric acid. They reduce the daily production of <strong>both basal</strong> and <strong>stimulated acid secretion</strong> by 85&ndash;90%.&nbsp;<br /><br />There are available in the form of <strong>delayed-release</strong> tablets, capsules, and oral suspension packets and for immediate acid suppression, there are <strong>intravenous formulations</strong> for PPIs like lansoprazole, pantoprazole, and esomeprazole. Therefore, the <strong>release of the drug</strong> depends upon the drug <strong>formulation.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/79f8d7a356254942ac77ef98dbd915b6x912x630.PNG"
    ]
  },
  {
    "text": "Which of the following is a penicillinase-resistant penicillin?",
    "choices": [
      {
        "id": 1,
        "text": "Penicillin V"
      },
      {
        "id": 2,
        "text": "Cloxacillin"
      },
      {
        "id": 3,
        "text": "Benzathine penicillin"
      },
      {
        "id": 4,
        "text": "Ampicillin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Cloxacillin&nbsp;</strong>is penicillinase-resistant penicillin.</p>\n<p>Penicillinase is a <strong>beta-lactamase</strong> enzyme that <strong>inactivates penicillin</strong>&nbsp;by destroying the beta-lactam ring. This enzyme is produced by <strong>most staphylococci</strong>, some gonococci strains, Bacillus subtilis, E.coli, Hemophilus influenza etc..,</p>\n<p>Penicillinase-resistant penicillins are not inactivated by penicillinase. But, they are less efficient than penicillin G against penicillin-sensitive pathogens. They are used to treat staphylococcal infections that are<strong> sensitive to methicillin.&nbsp;</strong>Penicillinase-resistant penicillins are:</p>\n<ul>\n<li>Cloxacillin</li>\n<li>Dicloxacillin</li>\n<li>Flucloxacillin</li>\n<li>Methicillin</li>\n<li>Nafcillin</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Penicillin V</strong> is an acid-resistant penicillin preparation that is administered orally. But it has limited use against penicillinase-producing organisms.</p>\n<p>Option C:<strong> Benzathine penicillin G </strong>and procaine penicillin G are repository preparations of penicillin G and are long-acting. They are given as deep I.M. injections. <strong>Benzathine penicillin</strong> has the longest half-life and is administered every 2-4 weeks. It is sensitive to penicillinase.&nbsp;</p>\n<p>Option D:<strong> Ampicillin</strong>&nbsp;is an extended-spectrum penicillin but is not resistant to beta-lactamases.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old female, a known case of sickle disease came with complaints of unprovoked pain in the extremities and torso. A thromboembolic episode was suspected. What is the first drug to be started for prophylaxis of thromboembolic events in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Heparin"
      },
      {
        "id": 2,
        "text": "Warfarin"
      },
      {
        "id": 3,
        "text": "Aspirin"
      },
      {
        "id": 4,
        "text": "Dabigatran"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario is suggestive of a <strong>sickle cell crisis</strong>. This patient with unprovoked pain in the extremities and torso most likely has a thromboembolic episode. The first drug to be started for prophylaxis of thromboembolic events is heparin.</p>\n<p>The mainstay of prophylaxis of thromboembolic events lies in <strong>anticoagulant medication.</strong> The <strong>initial</strong> <strong>parenteral</strong> therapy with <strong>heparin</strong>, LMWH, or fondaparinux <strong>shifted</strong> to a novel <strong>oral</strong> <strong>anticoagulant</strong> like <strong>dabigatran</strong> with warfarin acting as a bridge drug, <strong>followed</strong> by a <strong>long</strong> <strong>oral</strong> monotherapy with <strong>rivaroxaban</strong> or apixaban for a few weeks.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly male patient is diagnosed with benign prostatic hypertrophy. The physician starts him on tamsulosin. What is the mechanism of action of this drug?",
    "choices": [
      {
        "id": 1,
        "text": "Selective \u03b11 receptor antagonism"
      },
      {
        "id": 2,
        "text": "Selective \u03b11 receptor agonism"
      },
      {
        "id": 3,
        "text": "Nonselective \u03b1 receptor antagonism"
      },
      {
        "id": 4,
        "text": "Selective \u03b12 receptor agonism"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Tamsulosin</strong> acts by <strong>selective&nbsp;&alpha;<sub>1&nbsp;</sub>receptor&nbsp;antagonism</strong>.</p>\n<p>Tamsulosin&nbsp;is<strong>&nbsp;a uroselective &alpha;<sub>1&nbsp;</sub>blocker that&nbsp;</strong>acts by decreasing the tone of prostatic/ bladder neck muscles. This reduces the <strong>dynamic obstruction</strong> and increases the urinary flow rate. It is used in the treatment of BPH and <strong>acute urinary retention</strong>. It is taken<strong> once a day</strong> and preferred in cases with postural hypotension as it has very little effect on BP.</p>\n<p><strong>Retrograde ejaculation&nbsp;</strong>and floppy iris during cataract surgery are the side effects of this drug.</p>\n<p>&nbsp; Other &alpha;<sub>1&nbsp;</sub>antagonists used in BPH include</p>\n<ul>\n<li>Terazosin&nbsp;</li>\n<li>Doxazosin&nbsp;</li>\n<li><strong>Alfuzosin</strong>&nbsp;</li>\n</ul>\n<p>Other options:</p>\n<p>Option B:&nbsp;<strong>&nbsp;Selective</strong> <strong>&alpha;1</strong> receptor <strong>agonists </strong>such as <strong>phenylephrine </strong>are&nbsp;used as <strong>nasal decongestants</strong> and also as a <strong>mydriatic agent</strong>.&nbsp;<strong>Midodrine&nbsp;</strong>has been used to treat patients with autonomic insufficiency and <strong>postural hypotension</strong>.&nbsp;</p>\n<p>Option C:&nbsp;<strong>Nonselective &alpha;</strong> receptor <strong>antagonism</strong> can be seen in drugs such as&nbsp;<strong>phenoxybenzamine</strong> and <strong>phentolamine</strong>. They are administered prior to the surgical removal of <strong>pheochromocytoma </strong>to control the episodes of severe hypertension. They have also been used to manage the <strong>cheese reaction</strong> occurring in patients who take MAO inhibitors.</p>\n<p>Option D:&nbsp;<strong>Selective</strong> <strong>&alpha;2</strong>&nbsp;receptor <strong>agonists </strong>such as <strong>clonidine </strong>have been used in treating hypertension.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly patient with ventricular tachycardia has been started on amiodarone. Which of the following is the most important adverse event associated with this drug's use?",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary fibrosis"
      },
      {
        "id": 2,
        "text": "Central nervous system toxicity"
      },
      {
        "id": 3,
        "text": "Renal dysfunction"
      },
      {
        "id": 4,
        "text": "Ototoxicity"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most important adverse event associated with the use of amiodarone is <strong>pulmonary fibrosis.\u00a0</strong></p>\n<p>Amiodarone is a <strong>class three anti-arrhythmic</strong> that is primarily used in the treatment of <strong>supraventricular arrhythmias</strong>, <strong>ventricular tachycardia</strong> and <strong>ventricular fibrillation</strong>.</p>\n<p>Pulmonary fibrosis is usually seen in patients who take <strong>prolonged</strong> courses of amiodarone and in<strong> high doses.</strong></p>\n<p>Pulmonary fibrosis can be potentially <strong>life-threatening</strong> and requires immediate discontinuation of the amiodarone and initiation of <strong>high-dose corticosteroids.</strong></p>\n<p>Other adverse events associated with amiodarone use are nausea, photosensitivity, corneal microdeposits and thyroid dysfunction.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Central nervous system toxicity.\u00a0</strong>There are no significant central nervous system-related adverse events. In a minority of patients, peripheral neuropathy presenting as shoulder and pelvic muscle weakness is seen.</p>\n<p>Option C: <strong>Renal dysfunction</strong>\u00a0is not seen with Amiodarone since it is hepatically cleared.</p>\n<p>Option D: <strong>Ototoxicity</strong> is associated with prolonged aminoglycoside use and is not a feature of amiodarone toxicity.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the drugs marked as A, B, and C.",
    "choices": [
      {
        "id": 1,
        "text": "A - Aspirin, B -Vorapaxar, C - Prasugrel"
      },
      {
        "id": 2,
        "text": "A - Aspirin, B - Eptifibatide, C - Vorapaxar"
      },
      {
        "id": 3,
        "text": "A - Aspirin, B - Eptifibatide, C - Prasugrel"
      },
      {
        "id": 4,
        "text": "A - Aspirin, B - Prasugrel, C - Eptifibatide"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The drugs marked A, B and C are <strong>aspirin</strong>, <strong>eptifibatide</strong>, and <strong>vorapaxar</strong>,<strong>\u00a0</strong>respectively.</p>\n<p><strong>Aspirin</strong> causes inhibition of <strong>cyclooxygenase-1 (COX-1)</strong>,<strong>\u00a0</strong>which would inhibit the formation of <strong>thromboxane A2</strong>. Thromboxane A2 is an inducer of platelet aggregation and is a potent vasoconstrictor. Hence, inhibition of its formation is responsible for antiplatelet action.</p>\n<p>Aspirin is a <strong>non-competitive, irreversible inhibitor</strong> of the cyclooxygenase (COX) enzyme. It is a <strong>nonselective COX inhibitor</strong> and inhibits both COX-1 and COX-2.\u00a0</p>\n<p>Abciximab, tirofiban, and <strong>eptifibatide</strong> act by\u00a0<strong>blocking Gp IIb/IIIa receptors</strong>. They are mainly used during\u00a0<strong>percutaneous coronary intervention</strong>\u00a0for acute coronary syndrome. They carry a\u00a0<strong>high risk of bleeding</strong>\u00a0and can cause\u00a0<strong>thrombocytopenia</strong>.</p>\n<p><strong>Vorapaxar\u00a0</strong>primarily inhibits platelet aggregation caused by\u00a0<strong>thrombin.\u00a0</strong>PAR-1 activation by thrombin contributes to platelet aggregation. Vorapaxar is a competitive antagonist of protease-activated receptor-1 (PAR-1). Vorapaxar is\u00a0<strong>indicated in combination</strong>\u00a0with aspirin and/or clopidogrel to reduce thromboembolic events in patients with MI or peripheral vascular disease.</p>\n<p><strong>Prasugrel\u00a0</strong>is an<strong>\u00a0irreversible P2Y12\u00a0inhibitor </strong>and lasts for the entire lifetime of a platelet.</p>\n<div class=\"page\" title=\"Page 606\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Prasugrel is a\u00a0<strong>prodrug</strong>\u00a0that is used in patients with acute coronary syndrome who have undergone\u00a0<strong>percutaneous coronary intervention.</strong>\u00a0It<strong>\u00a0reduces</strong>\u00a0the rate of\u00a0<strong>thrombotic cardiovascular events</strong>\u00a0in such patients.\u00a0</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/327039f8d40444938142af3a6e51ae47.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/672ca9540c3b4fe7b9d71a5ec95b1f1dx1280x1585.JPEG"
    ]
  },
  {
    "text": "Gynecomastia is an adverse effect of which of the following drugs?",
    "choices": [
      {
        "id": 1,
        "text": "Spironolactone"
      },
      {
        "id": 2,
        "text": "Furosemide"
      },
      {
        "id": 3,
        "text": "Both A and B"
      },
      {
        "id": 4,
        "text": "Amiloride"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Spironolactone has an additional affinity towards progesterone and androgen receptors</strong> resulting in gynecomastia, loss of libido, menstrual irregularities, and other adverse effects.</p>\n<p><strong>Eplerenone</strong> has a lower affinity to progesterone and androgen receptors due to its 9,11 epoxide group. The incidence of gynecomastia and other effects are minimal with eplerenone.</p>\n<p>Other options: Amiloride and furosemide are not associated with gynecomastia\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the mechanism of action of the drug allopurinol?",
    "choices": [
      {
        "id": 1,
        "text": "Converts uric acid into allantoi"
      },
      {
        "id": 2,
        "text": "Inhibition of cyclooxygenase enzyme"
      },
      {
        "id": 3,
        "text": "Increase uric acid excretion"
      },
      {
        "id": 4,
        "text": "Xanthine oxidase inhibitor"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p style=\"text-align: justify;\"><strong>Allopurinol </strong>is recommended as the <strong>first-line</strong> urate-lowering agent in all patients with <strong>chronic</strong> gout. It is a<strong>\u00a0purine antimetabolite </strong>and an<strong> inhibitor of the xanthine oxidase </strong>enzyme.</p>\n<p style=\"text-align: justify;\">It prevents the conversion of hypoxanthine and xanthine to uric acid <strong>reducing plasma uric acid</strong> levels. Allopurinol is also a substrate for xanthine oxidase. The <strong>metabolite </strong>of allopurinol called<strong> oxypurinol</strong> is a <strong>non-competitive inhibitor </strong>of xanthine oxidase.\u00a0\u00a0</p>\n<p style=\"text-align: justify;\"><strong>Febuxostat\u00a0</strong>is a uric acid synthesis inhibitor that acts by<strong>\u00a0inhibiting\u00a0</strong>the enzyme<strong>\u00a0xanthine oxidase</strong>\u00a0and it is indicated in gout management.</p>\n<p style=\"text-align: justify;\">Both Febuxostat and Allopurinol are Xanthine Oxidase inhibitors, of which Allopurinol is a hypoxanthine analog.</p>\n<p>Drugs used in the<strong> management of gout</strong> can be classified as:</p>\n<p>Drugs that\u00a0<strong>relieve inflammation and pain</strong>- These drugs are useful in the management of\u00a0<strong>acute attacks of gout</strong>. They are:</p>\n<ul>\n<li><strong>NSAIDs:</strong>\u00a0They mainly exert their antiinflammatory action by\u00a0<strong>inhibiting cyclooxygenase enzyme</strong>\u00a0(COX).\u00a0This enzyme converts arachidonic acid to\u00a0prostanoids, thromboxane A2, and other prostaglandins</li>\n<li><strong>Colchicine:</strong>\u00a0It arrests the cell division by interfering with microtubule and spindle formation. This results in decreased neutrophil recruitment decreased neutrophil motility and decreased release of chemotactic factors.\u00a0</li>\n<li><strong>Glucocorticoids:</strong>\u00a0These drugs bind to the nuclear receptors and decrease the transcription of genes for\u00a0COX-2, inducible NOS (NOS2), inflammatory cytokines, collagenase, etc, that are responsible for inflammation.</li>\n</ul>\n<p>Drugs that\u00a0<strong>inhibit urate formation</strong>- These drugs inhibit urate formation by inhibiting the enzyme xanthine oxidase. Eg. allopurinol and febuxostat.\u00a0The most common adverse effect of allopurinol is\u00a0<strong>hypersensitivity reactions</strong>.\u00a0<strong>Oxypurinol</strong>\u00a0is a metabolite of allopurinol and inhibits xanthine oxidase thus reducing uric acid production. It is an\u00a0<strong>orphan drug</strong>\u00a0and is used in patients intolerant to allopurinol.\u00a0\u00a0</p>\n<p><strong>Other options:</strong></p>\n<p><strong>Option A:</strong> Pegloticase and rasburicase catalyze the enzymatic oxidation of uric acid into allantoin. This product is soluble and inactive.\u00a0</p>\n<p><strong>Option B:</strong>\u00a0<strong>NSAIDs:</strong>\u00a0They mainly exert their antiinflammatory action by\u00a0<strong>inhibiting cyclooxygenase enzyme</strong>\u00a0(COX).\u00a0This enzyme converts arachidonic acid to\u00a0prostanoids, thromboxane A2, and other prostaglandins</p>\n<p><strong>Option C: U</strong>ricosuric drugs: These drugs<strong> increase the excretion of uric acid.</strong> Important ones are:</p>\n<ul>\n<li><strong>Probenecid-</strong>\u00a0it\u00a0inhibits the reabsorption of uric acid by inhibiting organic acid transporter (OATs), principally URAT-1.</li>\n<li><strong>Benzbromarone</strong>- It increases uric acid secretion by\u00a0reversibly inhibiting urate\u2013anion exchanger in the proximal tubule</li>\n<li><strong>Lesinurad</strong>- It\u00a0inhibits the URAT-1 and OAT-4 transporters, thereby reducing renal uric acid reabsorption.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following is the most potent opioid analgesic from the options given below?",
    "choices": [
      {
        "id": 1,
        "text": "Morphine"
      },
      {
        "id": 2,
        "text": "Fentanyl"
      },
      {
        "id": 3,
        "text": "Pentazocine"
      },
      {
        "id": 4,
        "text": "Pethidine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given options, <strong>fentanyl </strong>is the <strong>most potent</strong> opioid.</p>\n<p><strong>Opioid potency:</strong></p>\n<p>Sufentanil &gt;<strong> Fentanyl</strong> &gt; Morphine &gt; Pentazocin and pethidine.</p>\n<p>Note: Overall, Sufentanil is the most potent opioid. It is 1000 times more potent than morphine.</p>\n<p>Other high-yield points on opioids:</p>\n<ul>\n<li>Post-thoracotomy pain managed by: <strong>IV fentanyl</strong></li>\n<li>Drug of choice for controlling severe pain in cancer patients: <strong>Morphine</strong></li>\n<li>Drug of choice for OPD analgesia: <strong>Alfentanyl</strong></li>\n<li><strong>Most potent: Sufentanyl</strong></li>\n<li>Shortest-acting opioid: <strong>Remifentanyl</strong></li>\n</ul>\n<p>Other options:</p>\n<p>Option A:<strong> Fentanyl</strong> is around <strong>100 times </strong>more potent than <strong>morphine.</strong></p>\n<p>Options C &amp; D: The potency of <strong>pentazocin </strong>and<strong> pethidine</strong> is lower than that of <strong>morphine</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The antiviral agent that is active against all herpes viruses and HIV is:",
    "choices": [
      {
        "id": 1,
        "text": "Foscarnet"
      },
      {
        "id": 2,
        "text": "Trifluridine"
      },
      {
        "id": 3,
        "text": "Acyclovir"
      },
      {
        "id": 4,
        "text": "Famciclovir"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Foscarnet</strong> is the antiviral agent that is active against <strong>all herpes viruses</strong> and <strong>HIV.</strong></p>\n<p><strong>Foscarnet</strong> is an inorganic pyrophosphate analog. It does not require activation by viral thymidine kinase for antiviral activity. It<strong>&nbsp;</strong>inhibits viral nucleic acid synthesis<strong>&nbsp;</strong>by <strong>directly&nbsp;inhibiting HSV DNA polymerase</strong> and HIV reverse transcriptase.</p>\n<p>Foscarnet is used to treat <strong>acyclovir-resistant</strong> <strong>herpes simplex virus</strong> (genital herpes) and <strong>varicella-zoster virus</strong> infections and <strong>ganciclovir-resistant </strong>cytomegalovirus (CMV) infections. It is also used as an alternative agent in CMV retinitis in AIDS, and CMV viremia in bone marrow transplant recipients.</p>\n<p>Common side effects of foscarnet include <strong>nephrotoxicity</strong> and <strong>hypocalcemia.</strong></p>\n<p>Foscarnet is mainly <strong>excreted</strong> by the <strong>kidneys</strong>.&nbsp;Therefore,<strong> dose reduction</strong> is <strong>necessary</strong> for renal impairment to avoid the accumulation of the drug and associated toxicity.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Trifluridine </strong>is a pyrimidine antimetabolite antiviral drug. It acts against <strong>herpes simplex virus -1, 2,</strong> and<strong> CMV</strong>. It is approved for use in herpes simplex keratitis.</p>\n<p>Option C: <strong>Acyclovir </strong>is active against <strong>herpes simplex virus -1, 2,</strong> varicella-zoster virus, Ebstein Barr virus, and partially against<strong> CMV. </strong>It is useful against a variety of herpes simplex infections like genital herpes, mucocutaneous herpes, herpes simplex encephalitis, keratitis, and chickenpox.</p>\n<p>Option D: <strong>Famcyclovir</strong> is active against <strong>herpes simplex</strong> and <strong>herpes zoster virus.</strong> It is used as a second-line agent for genital or orolabial herpes.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient undergoing chemotherapy was given an antiemetic, after which he developed symptoms like acute dystonia, bradykinesia, and tremors. Which of the following drugs would have caused these symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Ondansetron"
      },
      {
        "id": 2,
        "text": "Metoclopramide"
      },
      {
        "id": 3,
        "text": "Meclizine"
      },
      {
        "id": 4,
        "text": "Scopolamine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the above scenario, the patient has developed&nbsp;<strong>extrapyramidal</strong> adverse effects like <strong>acute dystonia,</strong> <strong>bradykinesia</strong>, and<strong> tremors. </strong>This is likely due to<strong>&nbsp;</strong>the&nbsp;<strong>antagonist</strong> action on <strong>dopamine receptors</strong> by <strong>metoclopramide.</strong></p>\n<p>Metoclopramide is a <strong>prokinetic</strong> and <strong>antiemetic.</strong> It has the following <strong>pharmacological actions:</strong></p>\n<ul>\n<li><strong>Dopamine</strong> receptor <strong>antagonist</strong>&nbsp;</li>\n<li>Serotonin (<strong>5HT4</strong>) receptor <strong>agonist</strong>&nbsp;</li>\n<li>Serotonin (<strong>5HT3</strong>) <strong>antagonist</strong></li>\n<li><strong>Sensitization</strong> of <strong>muscarinic receptors</strong> on <strong>smooth muscle.</strong> This results in <strong>increased</strong> lower <strong>esophageal sphincter tone</strong> and stimulates gastric antral contractions.</li>\n</ul>\n<p>Metoclopramide acts on both the gastrointestinal system and central nervous system. It is used as an upper antiemetic for many types of vomiting, especially migraine, drug-induced, and<strong> chemotherapy-induced</strong>. It is also used as a prokinetic in <strong>gastroparesis</strong> to increase gastric emptying.</p>\n<p>Adverse effects of metoclopramide are mainly extrapyramidal effects, and these include <strong>acute dystonia, Parkinson</strong><strong>-like</strong> symptoms (tremors, bradykinesia, rigidity), tardive dyskinesia,<strong> galactorrhea </strong>due to hyperprolactinemia, and methemoglobinemia in neonates.</p>\n<p>Extrapyramidal symptoms can be <strong>treated</strong> by <strong>discontinuation</strong> of metoclopramide and administration of anticholinergics or antihistaminics.</p>\n<p>Other options:</p>\n<p>Option A: <span data-preserver-spaces=\"true\">Ondansetron is a</span><strong><span data-preserver-spaces=\"true\">&nbsp;5-HT<sub>3</sub> receptor antagonist</span></strong>. It blocks impulses at the peripheral origin in GIT. <span data-preserver-spaces=\"true\">It is most commonly indicated for the treatment of&nbsp;</span><strong><span data-preserver-spaces=\"true\">postoperative&nbsp;</span></strong><span data-preserver-spaces=\"true\">and <strong>chemotherapy</strong>-<strong>induced</strong></span><strong><span data-preserver-spaces=\"true\">&nbsp;nausea </span></strong>and <strong><span data-preserver-spaces=\"true\">vomiting. </span></strong><span data-preserver-spaces=\"true\">Headache and dizziness are the common adverse effects.<br /></span></p>\n<p>Option C:<strong> Meclizine</strong> is a&nbsp;long-acting <strong>H1 antihistaminic</strong> drug.&nbsp;It is used for <strong>seasickness</strong>. It is less sedative and less anticholinergic.</p>\n<p>Option D: <strong>Scopolamine (hyoscine)</strong> is a <strong>muscarinic antagonist.</strong> It blocks neural pathways from the vestibular apparatus in the inner ear to the emetic center in the brainstem. A <strong>transdermal patch</strong> of scopolamine is used as an antiemetic in <strong>motion sickness</strong>. Constipation, drowsiness, dry mouth, and blurred vision are the common adverse effects.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Cardiotoxicity is an adverse effect of which of the following anti-cancer drugs?",
    "choices": [
      {
        "id": 1,
        "text": "Doxorubicin"
      },
      {
        "id": 2,
        "text": "Cladribine"
      },
      {
        "id": 3,
        "text": "Cyclophosphamide"
      },
      {
        "id": 4,
        "text": "Tamoxifen"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Cardiotoxicity</strong> is a unique adverse effect of <strong>doxorubicin</strong>. It is an <strong>anthracycline group</strong> of anticancer antibiotics.</p>\n<p><strong>Anthracyclines:</strong></p>\n<p>They work by interacting with DNA directly and\u00a0<strong>affecting transcription and replication</strong>. They have the potential to\u00a0<strong>create free radicals</strong>\u00a0which cause\u00a0<strong>irreversible cardiotoxicity</strong>\u00a0and\u00a0<strong>cardiomyopathy</strong>\u00a0which is dose-dependent.</p>\n<p>Adverse effects:</p>\n<ul>\n<li><strong>Cardiomyopathy</strong>\u00a0is the most common adverse effect and it can be either<strong>\u00a0acute,</strong>\u00a0in the form of\u00a0<strong>myocardial damage(\"pericarditis-myocarditis syndrome\"),</strong>\u00a0or a\u00a0<strong>chronic</strong>\u00a0form of\u00a0<strong>dose-dependent cardiomyopathy</strong>\u00a0leading to heart failure.</li>\n<li>Alopecia, anemia, amenorrhea, leukopenia, nausea, vomiting.</li>\n<li>Mucositis, diarrhea, thrombocytopenia.</li>\n<li>Less common: acute lymphoid leukemia,acute myelogenous leukemia,atrioventricular block,esophagitis,hyperpigmentation,myelodysplastic syndrome</li>\n</ul>\n<p><strong>Anthracycline-induced cardiomyopathy</strong> takes two forms:</p>\n<ul>\n<li><strong>Acute:</strong>\u00a0pericarditis-myocarditis syndrome,\u00a0arrhythmias, ST and T wave changes in ECG.</li>\n<li><strong>Chronic:</strong> dilated cardiomyopathy.</li>\n</ul>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;ANTI-CANCER DRUGS AND THEIR TOXICITIES\\n\\nDRUG\\tTOXICITY\\nCyclophosphamide &amp; Ifosfamide\\tHemorrhagic cystitis, SIADH\\nBusulfan\\tPulmonary fibrosis\\nProcarbazine\\t\\nSecondary leukemias\\n\\nDisulfiram-like reaction\\n\\nCisplatin\\t\\nNephrotoxicity\\n\\nNeurotoxicity\\n\\nOtotoxicity\\n\\nCapecitabine\\tDiarrhea, hand-foot syndrome,\\nmyelosuppression\\nCytarabine\\tCerebellar ataxia\\nIrinotecan\\tDiarrhea\\nBleomycin\\tPulmonary fibrosis\\nAnthracyclines\\tCardiotoxicity\\nMitomycin\\tHemolytic-uremic syndrome\\nCladribine\\tMyelosuppression, nausea\\nand vomiting, and\\nimmunosuppression\\n&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:4737,&quot;3&quot;:{&quot;1&quot;:0},&quot;10&quot;:2,&quot;12&quot;:0,&quot;15&quot;:&quot;Arial&quot;}\">Anti-cancer drugs and their toxicities:</span></p>\n<table>\n<tbody>\n<tr>\n<td><strong>Drug</strong></td>\n<td><strong>Toxicity</strong></td>\n</tr>\n<tr>\n<td><strong>Cyclophosphamide\u00a0</strong>&amp; Ifosfamide</td>\n<td>Hemorrhagic cystitis, SIADH</td>\n</tr>\n<tr>\n<td>Busulfan</td>\n<td>Pulmonary fibrosis</td>\n</tr>\n<tr>\n<td>Procarbazine</td>\n<td>\n<p>Secondary leukemias</p>\n<p>Disulfiram-like reaction</p>\n</td>\n</tr>\n<tr>\n<td>Cisplatin</td>\n<td>\n<p>Nephrotoxicity</p>\n<p>Neurotoxicity</p>\n<p>Ototoxicity</p>\n</td>\n</tr>\n<tr>\n<td>Capecitabine</td>\n<td>Diarrhea, hand-foot syndrome,<br />myelosuppression</td>\n</tr>\n<tr>\n<td>Cytarabine</td>\n<td>Cerebellar ataxia</td>\n</tr>\n<tr>\n<td>Irinotecan</td>\n<td>Diarrhea</td>\n</tr>\n<tr>\n<td>Bleomycin</td>\n<td>Pulmonary fibrosis</td>\n</tr>\n<tr>\n<td><strong>Anthracyclines</strong></td>\n<td><strong>Cardiotoxicity</strong></td>\n</tr>\n<tr>\n<td>Mitomycin</td>\n<td>Hemolytic-uremic syndrome</td>\n</tr>\n<tr>\n<td><strong>Cladribine</strong></td>\n<td>Myelosuppression, nausea<br />and vomiting, and<br />immunosuppression</td>\n</tr>\n<tr>\n<td><strong>Tamoxifen</strong></td>\n<td>Endometrial cancer, osteoporosis</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The drug of choice for the management of hyperthyroidism in the third trimester of pregnancy is?",
    "choices": [
      {
        "id": 1,
        "text": "Methimazole"
      },
      {
        "id": 2,
        "text": "Propylthiouracil"
      },
      {
        "id": 3,
        "text": "Levothyroxine"
      },
      {
        "id": 4,
        "text": "Lugol's iodine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>drug of choice</strong> for the management of hyperthyroidism in the<strong> third trimester of pregnancy</strong>\u00a0is <strong>methimazole.</strong></p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>Hyperthyroidism in pregnancy:</p>\n<p><strong>Pre-pregnancy</strong> and <strong>first trimester:</strong> <strong>Propylthiouracil\u00a0</strong></p>\n<p><strong>2nd, 3rd trimester</strong> + <strong>post-pregnancy: </strong></p>\n<ul>\n<li><strong>Methimazole</strong></li>\n<li>Partial thyroidectomy (in 2nd trimester if\u00a0methimazole is not effective)</li>\n</ul>\n<p>Methimazole and its prodrug (carbimazole) are usually avoided in the first trimester due to\u00a0<strong>teratogenic risk.</strong>\u00a0However, methimazole is used for the remainder of the pregnancy due to the concern for\u00a0<strong>PTU-associated liver failure.</strong>\u00a0</p>\n<p><strong>Subtotal thyroidectomy</strong>\u00a0can be performed during the\u00a0<strong>mid-trimester.</strong></p>\n<p><strong>Radioactive iodine\u00a0</strong>crosses the placenta and causes the destruction of the fetal thyroid. Therefore, it\u00a0is<strong>\u00a0contraindicated</strong>\u00a0during pregnancy and lactation.</p>\n<p><strong>Propranolol</strong> will help with her heart rate (is the patient is symptomatic), but will not help with the overactive thyroid.</p>\n<p>If a pregnant woman is on propylthiouracil in her first trimester, she should be switched to<strong> methimazole</strong> in her<strong> 2nd trimester.</strong></p>\n<p>Note (in pregnancy):</p>\n<ul>\n<li><strong>Lowest possible</strong> dose should be prescribed</li>\n<li>Radioiodine therapy contraindicated</li>\n</ul>\n<table>\n<tbody>\n<tr>\n<td><strong>Trimester</strong></td>\n<td><strong>Treatment for thyrotoxicosis</strong></td>\n</tr>\n<tr>\n<td><strong>First trimester</strong></td>\n<td>\n<ul>\n<li>Propylthiouracil</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>Second trimester</strong></td>\n<td>\n<ul>\n<li>Methimazole</li>\n<li>Subtotal thyroidectomy</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>Third trimester</strong></td>\n<td>\n<ul>\n<li>Methimazole</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Abnormalities</strong> associated with methimazole (when used in 1st trimester):</p>\n<ul>\n<li>Choanal atresia</li>\n<li>Aplasia cutis</li>\n<li>Fetal goiter</li>\n<li>Esophageal atresia</li>\n<li>Scalp defects</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old female patient presented with the following finding. Her medical history includes hypertension for which she has been taking regular medications for the past 3 months. Which of the following medication is most likely to be associated with this finding?",
    "choices": [
      {
        "id": 1,
        "text": "Enalapril"
      },
      {
        "id": 2,
        "text": "Telmisartan"
      },
      {
        "id": 3,
        "text": "Amlodipine"
      },
      {
        "id": 4,
        "text": "Hydrochlorthiazide"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows<strong> pitting pedal edema</strong> in a hypertensive patient. <strong>Calcium channel blockers (CCBs)</strong> like <strong>amlodipine</strong> are most likely to be associated with peripheral edema.</p>\n<p>The frequency of CCB- induced peripheral edema is both <strong>drug-specific</strong> (i.e more potent drugs like amlodipine will be associated with higher rates of developing edema) and <strong>dose-dependent</strong> (i.e incidence of edema increases with an increase in drug dosage and chronicity of its usage). It is more common among <strong>females.</strong></p>\n<p>CCB-induced peripheral edema occurs due to a disproportionate decrease in the&nbsp;arteriolar resistance than in the venous circulation, resulting in increased&nbsp;hydrostatic pressure in the precapillary circulation. This leads to a fluid shift&nbsp;into the interstitial compartment causing edema.</p>\n<p>Treatment:</p>\n<ul>\n<li>Dose reduction.</li>\n<li>Interclass switching of CCB - switch to non-dihydropyridines like verapamil, and diltiazem.</li>\n<li>Addition of a venodilator - ACE inhibitor, ARBs, Nitrates.</li>\n<li>Others - compression stockings, avoiding prolonged upright position.</li>\n<li>Definitive treatment would be discontinuation of the CCB and switching to another class of antihypertensives.</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: Common side effects of <strong>ACE inhibitors</strong> like <strong>enalapril </strong>include hypotension, hyperkalemia, dry cough, rashes, urticaria, dysgeusia, gastrointestinal upset, headache, and dizziness.</p>\n<p>Option B:<strong>&nbsp;Telmisartan</strong>, an angiotensin receptor blocker (<strong>ARBs)</strong>, causes adverse effects such as hypotension, hyperkalemia, headache, gastrointestinal upset, and dizziness.</p>\n<p>Option D: Adverse effects of <strong>thiazide diuretics</strong> like <strong>hydrochlorothiazide</strong> are hypokalemia, hyponatremia, hyperglycemia, hyperuricemia, hypercalcemia, rashes,&nbsp;headache, gastrointestinal upset, and dizziness.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0a404cea4a154c8d89713520faedfb97.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient started on an antihypertensive presented with the following picture. Which of the following drugs is the most likely cause?",
    "choices": [
      {
        "id": 1,
        "text": "Lisinopril"
      },
      {
        "id": 2,
        "text": "Nifedipine"
      },
      {
        "id": 3,
        "text": "Atenolol"
      },
      {
        "id": 4,
        "text": "Clonidine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows edema over the lips and face and its occurrence following intake of an antihypertensive is suggestive of <strong>drug-induced angioedema</strong>. <strong>Lisinopril, an angiotensin-converting enzyme inhibitor (ACE inhibitor), </strong>is most likely<strong>\u00a0</strong>responsible for this condition.</p>\n<p>Angioedema with ACE inhibitors:</p>\n<p>In very few patients(0.1%-0.5%), ACE inhibitors cause rapid swelling\u00a0in the nose, throat, mouth, glottis, larynx, lips, or tongue.\u00a0Once the\u00a0drug is stopped\u00a0symptoms improve drastically over hours. Angioedema of the intestine can occur very rarely.\u00a0</p>\n<p><strong>ACE inhibitor-associated angioedema</strong>\u00a0is a\u00a0<strong>class effect</strong>, and patients who develop this adverse event should\u00a0not be prescribed\u00a0any other drugs within the ACE inhibitor class.</p>\n<p>Other adverse effects of ACE inhibitors:</p>\n<ul>\n<li>A sudden fall in blood pressure can occur following the first dose of ACE inhibitors.</li>\n<li>It can produce a bothersome <strong>dry cough</strong> due to the accumulation of bradykinin, substance P, or prostaglandins in the lungs. The cough usually disappears within 4 days of the stoppage of the drug.</li>\n<li>Hyperkalemia due to K+ retention can occur.</li>\n<li>Acute renal failure can occur with ACE inhibitors in patients with\u00a0<strong>bilateral renal artery stenosis</strong>, stenosis of the artery to a single remaining kidney, heart failure,\u00a0or volume depletion due to\u00a0diarrhea or diuretics.</li>\n<li>It should be discontinued in pregnant women as it can cause <strong>developmental defects</strong>.</li>\n<li>It can also cause maculopapular skin rash in some cases.</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: <strong>Nifedipine</strong> is a calcium channel blocker. Common adverse effects include <strong>headache,</strong> <strong>flushing</strong>, and dizziness. Peripheral edema (pedal edema) may rarely occur.</p>\n<p>Option C: <strong>Atenolol</strong> is a beta-1 selective antagonist. <strong>Bradycardia</strong>, fatigue, and cold extremities are common adverse effects. CNS side effects like nightmares and depression are less frequent with atenolol than other beta-blockers.</p>\n<p>Option D: <strong>Clonidine</strong> is an alpha-2 adrenergic agonist. The main adverse effects of clonidine are <strong>dry mouth</strong> and <strong>sedation</strong>. Bradycardia and sexual dysfunction are other effects.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/812a90a3fc9d420da8f4d8d10f726283.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Postural hypotension is a side effect of which of the following classes of drugs?",
    "choices": [
      {
        "id": 1,
        "text": "Angiotensin-Converting Enzyme (ACE) Inhibitors"
      },
      {
        "id": 2,
        "text": "Angiotensin II receptor blockers (ARB)"
      },
      {
        "id": 3,
        "text": "Thiazide diuretics"
      },
      {
        "id": 4,
        "text": "Alpha blockers"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Drug-induced orthostatic/postural hypotension </strong>is\u00a0caused by the <strong>effect</strong> of alpha-blocker (<strong>alpha<span style=\"font-size: 11.6667px;\">1</span>\u00a0- selective receptor blocker)</strong>.</p>\n<p>Alpha1 receptor blockers, such as <strong>prazosin</strong>, cause a reduction of peripheral resistance as well as venous pooling of blood. This causes a <strong>decrease </strong>in venous return and <strong>cardiac output</strong> leading to a fall in blood pressure. Postural reflex causes <strong>marked</strong> <strong>postural hypotension</strong> which leads to syncope. This dizziness and fainting are known as the\u00a0<strong>first dose effect</strong>\u00a0and can be minimized by starting with a minimal dose and titrating it thereafter. Other side effects include <strong>reflex tachycardia</strong>, miosis, nasal congestion, and<strong> impotence</strong>.\u00a0</p>\n<p>They are used as an antihypertensive agent and in<strong> benign hypertrophy</strong> of the <strong>prostate</strong> to decrease prostatic tone.</p>\n<p>The<strong>\u00a0prostate stroma\u00a0</strong>has a maximum concentration of<strong>\u00a0\u03b1<sub>1A</sub>\u00a0</strong>receptors over other \u03b1<sub>1</sub>\u00a0receptor subtypes.\u00a0<strong>\u03b1<sub>1B</sub></strong>\u00a0receptors are present on\u00a0<strong>blood vessels</strong>\u00a0which play a role in\u00a0<strong>vasoconstriction.</strong>\u00a0Hence, selective\u00a0\u03b1<sub>1A\u00a0</sub>receptor antagonists have minimal effect on blood pressure as compared to non-selective \u03b1<sub>1\u00a0</sub>antagonists like prazosin.</p>\n<p>\u03b1<sub>1</sub>\u00a0receptor antagonists can be classified as:</p>\n<ul>\n<li>Selective antagonists\n<ul>\n<li>Silodosin (\u03b1<sub>1A</sub>)</li>\n<li>Tamsulosin (\u03b1<sub>1A</sub>\u00a0+ \u03b1<sub>1D</sub>)</li>\n</ul>\n</li>\n<li>Non-selective\u00a0\n<ul>\n<li>Prazosin</li>\n<li>Terazosin</li>\n<li>Doxazosin</li>\n<li>Alfuzosin</li>\n</ul>\n</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: Side effects of Angiotensin-Converting Enzyme (ACE) Inhibitors include - dry cough, hyperkalemia, angioedema, renal Impairment</p>\n<p>Option B: Side effects of Angiotensin II Receptor Blockers (ARB) - hyperkalemia, dizziness</p>\n<p>Option C: Side effects of thiazide diuretics include- hypokalemia, hyponatremia, hyperuricemia, hyperglycemia</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While conducting animal studies, a scientist is experimenting with a drug called vesamicol that causes skeletal muscle relaxation. What is the mechanism by which the drug causes muscle relaxation?",
    "choices": [
      {
        "id": 1,
        "text": "Breakdown of acetylcholine after its release into the synaptic cleft"
      },
      {
        "id": 2,
        "text": "Blocks the transport of acetylcholine into its storage vesicle"
      },
      {
        "id": 3,
        "text": "Inhibits the uptake of choline into nerve terminals"
      },
      {
        "id": 4,
        "text": "Prevents the release of  acetylcholine from nerve terminals."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Vesamicol\u00a0causes skeletal muscle relaxation by\u00a0<strong>blocking</strong> the <strong>transport of acetylcholine</strong> into its <strong>storage vesicle.</strong></p>\n<p>It acts on the cholinergic nerve terminals and blocks the transport, thus preventing the repletion of acetylcholinesterase following transmitter release.\u00a0</p>\n<p>Other options:</p>\n<p>Option A: <strong>Acetylcholine esterase</strong> is involved in the <strong>breakdown of acetylcholine</strong> after it is released into the synaptic cleft to acetate and choline.</p>\n<p>Option C:<strong> Hemicholinum</strong> inhibits the <strong>uptake of choline</strong> into nerve terminals.</p>\n<p>Option D:\u00a0<strong>Botulinum toxin</strong> inhibits the <strong>release of acetylcholine</strong> from nerve terminals.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b9ed96eddfa54713a858cabf28623fb1x1280x2234.JPEG"
    ]
  },
  {
    "text": "Contraceptive failure while on oral contraceptive pills is unlikely to occur with which of the following drugs?",
    "choices": [
      {
        "id": 1,
        "text": "Valproate"
      },
      {
        "id": 2,
        "text": "Rifampicin"
      },
      {
        "id": 3,
        "text": "Phenytoin"
      },
      {
        "id": 4,
        "text": "Phenobarbitone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Contraceptive failure</strong> in patients on the oral contraceptive pill is <strong>unlikely</strong> to occur with <strong>valproate.</strong> It is an <strong>enzyme inhibitor</strong> that inhibits the degradation of OCPs and <strong>increases</strong> their <strong>duration</strong> of <strong>action.</strong></p>\n<p>Rifampicin, phenytoin, and phenobarbitone are enzyme inducers and can cause increased metabolism of OCPs leading to contraceptive failure.</p>\n<table style=\"height: 150px;\" width=\"453\">\n<tbody>\n<tr>\n<td style=\"width: 180.547px; text-align: center;\"><strong>Enzyme inducers</strong></td>\n<td style=\"width: 256.453px; text-align: center;\"><strong>Enzyme inhibitors</strong></td>\n</tr>\n<tr>\n<td style=\"width: 180.547px;\">\n<p>Mnemonic: CRAP GPS</p>\n<ul>\n<li><strong>C</strong>arbamezepine</li>\n<li><strong>R</strong>ifampicin</li>\n<li><strong>A</strong>lcohol (chronic)</li>\n<li><strong>P</strong>henytoin</li>\n<li><strong>G</strong>riseofulvin</li>\n<li><strong>P</strong>henobarbitone</li>\n<li><strong>S</strong>ulfonylureas</li>\n</ul>\n</td>\n<td style=\"width: 256.453px;\">\n<p>Mnemonic:&nbsp;RED VICK</p>\n<ul>\n<li><strong>R</strong>itonavir</li>\n<li><strong>E</strong>rythromycin</li>\n<li><strong>D</strong>iltiazem</li>\n<li><strong>V</strong>erapamil,&nbsp;Valproate</li>\n<li><strong>I</strong>traconazole</li>\n<li><strong>C</strong>larithromycin,&nbsp;Cimetidine</li>\n<li><strong>K</strong>etoconazole</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A farmer presents to the emergency department with diarrhea, sweating, excessive lacrimation, and salivation. Which of the following statements is incorrect regarding the treatment of the condition?",
    "choices": [
      {
        "id": 1,
        "text": "Carbamates bind to acetylcholinesterases reversibly"
      },
      {
        "id": 2,
        "text": "Atropine is used as an antidote for OP poisoning"
      },
      {
        "id": 3,
        "text": "Pralidoxime has a role in reversing the enzyme in carbamate poisoning"
      },
      {
        "id": 4,
        "text": "Succinylcholine use is avoided in rapid sequence intubation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The&nbsp;clinical scenario is suggestive of&nbsp;<strong>organophosphate</strong>&nbsp;poisoning. Pralidoxime is used to counter the&nbsp;<strong>nicotinic</strong>&nbsp;effects of organophosphates. It&nbsp;<strong>reactivates</strong>&nbsp;the&nbsp;<strong>acetylcholinesterase,&nbsp;</strong>which&nbsp;had been deactivated in organophosphate poisoning.&nbsp;</p>\n<p><strong>Atropine</strong>&nbsp;is useful in&nbsp;<strong>organophosphate poisoning</strong>&nbsp;because it is a competitive antagonist of acetylcholine.&nbsp;An acetylcholinesterase enzyme has an active and anionic site. The&nbsp;<strong>organophosphates</strong>&nbsp;<strong>bind to</strong>&nbsp;the <strong>active</strong>&nbsp;<strong>site of AChEs</strong>&nbsp;(acetylcholine esterases) and<strong>&nbsp;deactivate</strong>&nbsp;it. This results in excessive Ach causing excessive muscarinic activity. It has relatively insignificant action on nicotinic receptors.&nbsp;</p>\n<p>Organophosphates and carbamates are powerful acetylcholinesterase&nbsp;inhibitors. While carbamates bind reversibly, organophosphates bind irreversibly.&nbsp;&nbsp;</p>\n<p>The predominant initial signs are of&nbsp;<strong>muscarinic</strong>&nbsp;excess which includes:&nbsp;<strong>(DUMBBELSS)</strong></p>\n<ul>\n<li><strong>Diarrhea</strong></li>\n<li><strong>U</strong>rination</li>\n<li><strong>M</strong>iosis</li>\n<li><strong>B</strong>ronchospasm</li>\n<li><strong>B</strong>radycardia</li>\n<li><strong>E</strong>mesis</li>\n<li><strong>L</strong>acrimation</li>\n<li><strong>S</strong>alivation</li>\n<li><strong>S</strong>weating</li>\n</ul>\n<p><strong>Nicotinic manifestations</strong>&nbsp;include twitching of eyelids, tongue, and facial muscles which then leads to paralysis.&nbsp;<strong>CNS stimulation</strong>&nbsp;results in headaches, tremors, ataxia, coma, and death.&nbsp;</p>\n<p>Patients who present with organophosphate and carbamate poisoning require early endotracheal intubation to avoid respiratory depression, which is a common complication. Succinylcholine is avoided due to its metabolism by acetylcholinesterase which leads to prolonged neuromuscular blockade.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Pharmacology Test';
        const quizFilename = 'pharmacology-test-54f0c927.html';
        let hierarchy = ["Marrow", "FMGE Test Series Subject", "2024"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>