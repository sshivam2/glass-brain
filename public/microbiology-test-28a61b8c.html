<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microbiology Test - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Test Series Subject / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 30-year-old man comes with multiple circular, dry, scaly, itchy lesions on the scalp.  On further examination, it is seen that hair is involved but nails are spared. Scrapings from the lesion are inoculated and examined microscopically. Identify the dermatophyte based on the macroconidia seen in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Trichophyton rubrum"
      },
      {
        "id": 2,
        "text": "Microsporum gypseum"
      },
      {
        "id": 3,
        "text": "Epidermophyton"
      },
      {
        "id": 4,
        "text": "Trichophyton mentagrophytes"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of infection involving <strong>skin and hair, sparing the nails</strong> and the image showing <strong>large</strong>\u00a0<strong>spindle-shaped macroconidia</strong>\u00a0is a feature of\u00a0<strong>Microsporum</strong>.</p>\n<div class=\"page\" title=\"Page 609\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Dermatophytosis</strong> (commonly called tinea or ringworm) refers to infection of keratinized structures (the skin, hair, and nails) caused by a group of keratinophilic fungi, called the <strong>dermatophytes</strong>.</p>\n<p>Dermatophytes are classified into 3 types:</p>\n<ul>\n<li><strong>Trichophyton</strong>\u00a0infects <strong>skin, hair,</strong> and<strong> nails</strong>. The species include T. rubrum, T. mentagrophytes, T. tonsurans, T. schoenleinii, T. violaceum, etc. Microconidia &gt; Macroconidia</li>\n<li><strong>Microsporum</strong>\u00a0infects <strong>only hair</strong> and<strong> skin</strong> but, not the nails. The species include M. gypseum, M. canis, and M. nanum. <strong>Macroconidia&gt; Microconidia.</strong></li>\n<li><strong>Epidermophyton</strong>\u00a0infects <strong>only skin</strong> and<strong> nails</strong>,\u00a0not hair.\u00a0Floccosum is the only species in this genus. Only Macroconidia.</li>\n</ul>\n<p>Clinical features of infection by Microsporum include:</p>\n<ul>\n<li><strong>Skin lesions</strong> in the skin tend to be <strong>circular, dry, erythematous, scaly,</strong> and <strong>itchy</strong>.</li>\n<li>Hair lesions include kerion, scarring, and alopecia.</li>\n</ul>\n<div class=\"page\" title=\"Page 610\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Diagnosis is established by clinical features, the use of <strong>Wood's lamp</strong>, and laboratory investigations such as <strong>microscopic examination </strong>and<strong> culture characteristics</strong>.</p>\n<div class=\"page\" title=\"Page 611\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 611\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Microscopic examination</strong> of material teased out from the fungal colony (culture mount) or material taken on cellotape (cellotape mount) is observed for identification of the species. It is observed for the presence and type of<strong> hyphae and conidia</strong>. Conidia (asexual spores) are of two types: small unicellular <strong>microconidia</strong> and larger septate <strong>macroconidia</strong>.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/66a8379c18a44cc0818d13f5056fe5a3.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 21-year-old student presents with ocular redness, foreign body sensation, and excessive tearing following the use of a contact lens. An interface contrast microscopy from his corneal scraping is shown below. What would be the most probable cause?",
    "choices": [
      {
        "id": 1,
        "text": "Acanthamoeba"
      },
      {
        "id": 2,
        "text": "Naegleria fowleri"
      },
      {
        "id": 3,
        "text": "Entamoeba histolytica"
      },
      {
        "id": 4,
        "text": "Balamuthia Mandrillaris"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical history and the demonstration of polygonal cysts in interface contrast microscopy are suggestive of <strong>amoebic keratitis</strong> caused by <strong>acanthamoeba.</strong></p>\n<p><em>Acanthamoeba culbertsoni</em> is an opportunistic protozoan pathogen. It exists as <strong>trophozoite</strong> form and resistant <strong>cystic</strong> form. <strong>Both</strong> these forms are <strong>infective.</strong>&nbsp;The trophozoite is large and characterized by spine-like pseudopodia (acanthopodia).</p>\n<p>Human beings acquire the infection by <strong>inhalation</strong> of cysts or trophozoites,&nbsp;directly through traumatized <strong>skin</strong> or <strong>eyes</strong>, or&nbsp;<strong>ingestion</strong> of cysts.</p>\n<p>It chiefly presents as two chronic conditions:</p>\n<ul>\n<li><strong>Acanthamoeba keratitis</strong></li>\n<li><strong>Granulomatous amoebic encephalitis</strong></li>\n</ul>\n<p>Acanthamoeba keratitis is an infection of the eyes that typically develops from the entry of the amebic cyst through abrasions on the cornea. Most of the cases are associated with the use of contact lenses.&nbsp;</p>\n<p>Patients usually present with photophobia, <strong>excessive tearing, redness, </strong>and <strong>foreign body sensation</strong> and it can be<strong> bilateral in contact lens</strong> users.</p>\n<p>Diagnosis of amoebic keratitis is made by the demonstration of the cyst in corneal scrapings by wet mount, histology,&nbsp;and culture. The cysts are smaller (12-25 micrometer) and <strong>polygonal</strong> or star-shaped.</p>\n<p>Topical administration of <strong>biguanides or chlorhexidine</strong> with or without diamidine agents can be used for the management of acanthamoeba keratitis. In severe cases <strong>penetrating keratoplasty</strong> can be done.</p>\n<p>The below image shows the ring lesion seen in acanthamoeba keratitis.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/688926533f0449a99555253fdba94198.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/31760f83cf9745cface31b4d7e1bc0bbx720x488.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/353da175d0de461196894e475f942b89x720x458.JPEG"
    ]
  },
  {
    "text": "In which of the following situations will you use a sanitizer?",
    "choices": [
      {
        "id": 1,
        "text": "A, B & C only"
      },
      {
        "id": 2,
        "text": "A & B only"
      },
      {
        "id": 3,
        "text": "A, B C & D"
      },
      {
        "id": 4,
        "text": "C & D only"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>You should use sanitiser <strong>before</strong> and <strong>after examining the patient</strong> and <strong>after touching the patient's surroundings</strong>.</p>\n<p>The most significant precaution that is effective in preventing infection transmission is <strong>hand hygiene</strong>. This is achieved by <strong>washing hands</strong> with soap and water and/or by hand rubbing with alcohol or non-alcohol-based <strong>hand sanitizer</strong>.&nbsp;The <strong>most effective</strong> and <strong>least expensive</strong> way is by washing hands before and after any patient interaction.</p>\n<p>Perform hand hygiene</p>\n<ul>\n<li class=\"offset-1\">When hands are visibly soiled.</li>\n<li class=\"offset-1\">After barehanded touching of instruments, equipment, materials, and other objects likely to be contaminated by blood, saliva, or respiratory secretions.</li>\n<li class=\"offset-1\">Before and after treating each patient.</li>\n<li class=\"offset-1\">Before putting on gloves and again immediately after removing gloves.</li>\n</ul>\n<p>First use <strong>soap and water</strong> when hands are <strong>visibly soiled</strong> (e.g., blood, body fluids). When they are not soiled, an alcohol-based hand rub may be used.</p>\n<p>Disinfectants like chlorhexidine and alexidine have a biguanide functional group. They are mostly used as <strong>oral disinfectants and hand products</strong>. They are <strong>bactericidal but not sporicidal. Mycobacteria are also resistant</strong> to these compounds.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ed49ba92c81c422786618535b1224e46x1280x1901.JPEG"
    ]
  },
  {
    "text": "Which of the following organism is not a cause of atypical pneumonia?",
    "choices": [
      {
        "id": 1,
        "text": "Legionella"
      },
      {
        "id": 2,
        "text": "Mycoplasma pneumoniae"
      },
      {
        "id": 3,
        "text": "Streptococcus pneumoniae"
      },
      {
        "id": 4,
        "text": "Chlamydia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Among the given organisms,<em><strong>&nbsp;Streptococcus pneumoniae</strong> </em>is not a cause of atypical pneumonia</p>\n<p>Pneumonia due to <em><strong>Mycoplasma pneumonia&nbsp;</strong></em>(Eaton agent),&nbsp;<em><strong>Chlamydia</strong></em>&nbsp;and <strong><em>Legionella </em></strong>are considered atypical pneumonia. Where as&nbsp;<em>Streptococcus pneumoniae&nbsp;</em>caused <strong>typical pneumonia</strong> in the form of <strong>lobar pneumonia</strong></p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>The below chest X-ray shows patchy consolidation at the hilum and fanning to the periphery.</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ec32bead186a4eedab6f2e1399b015bdx720x476.PNG"
    ]
  },
  {
    "text": "Which of the following reactions are positive for Clostridium perfringens",
    "choices": [
      {
        "id": 1,
        "text": "M'fadyean reaction, Elek's test"
      },
      {
        "id": 2,
        "text": "Reverse CAMP test, M'fadyean reaction"
      },
      {
        "id": 3,
        "text": "Target hemolysis, Reverse CAMP test"
      },
      {
        "id": 4,
        "text": "Stormy fermentation, Elek's test"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Target hemolysis and reverse CAMP test are positive for&nbsp;Clostridium perfringens.</p>\n<p>A narrow zone of <strong>complete hemolysis</strong> due to <strong>theta toxin</strong> and a wider zone of <strong>incomplete hemolysis</strong> due to<strong> alpha toxin</strong> results in target hemolysis on blood agar.</p>\n<p>In reverse CAMP test, C.perfringens is streaked&nbsp;over the centre of the plate, Streptococcus agalactiae&nbsp;is streaked at right angles to it. A positive reverse&nbsp;CAMP test shows the presence of an arrow-shaped&nbsp;zone of enhanced hemolysis pointing towards&nbsp;C.perfringens.&nbsp;<strong>A</strong><strong>lpha toxin</strong> produced by Clostridium perfringens interacts with <strong>CAMP factor</strong> and produce <strong>synergistic hemolysis</strong>.</p>\n<p style=\"text-align: left;\">&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3f2af663a69b41528f10a510e9ca804ex600x563.JPEG"
    ]
  },
  {
    "text": "A 24-year-old female presents with a history of progressive breathlessness and difficulty in breathing since 3 months. A chest X-ray shows a cavitary lesion in the lower lobe of the lung. Lobectomy was done and the histopathology image is given below. What is the most probable causative agent?",
    "choices": [
      {
        "id": 1,
        "text": "Strongyloides stercoralis"
      },
      {
        "id": 2,
        "text": "Fasciola hepatica"
      },
      {
        "id": 3,
        "text": "Echinococcus granulosus"
      },
      {
        "id": 4,
        "text": "Taenia Saginata"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario and the histological slide are suggestive of&nbsp;<strong>hydatid disease </strong>of the<strong> lung</strong>&nbsp;caused by&nbsp;<strong><em>Echinococcus granulosus</em></strong>.</p>\n<p><strong>Hydatid disease&nbsp;</strong>most commonly occurs in the <strong>liver</strong>, the second most common being the <strong>lungs</strong>. The clinical features of <strong>hydatid disease </strong>of the<strong> lung</strong>&nbsp;include&nbsp;<strong>breathlessness, cough, hemoptysis</strong>,&nbsp;<strong>chest pain</strong>, and<strong>&nbsp;</strong>even<strong>&nbsp;pneumothorax</strong>. Treatment includes <strong>wedge resection</strong> or <strong>lobectomy</strong> and administration of albendazole. <strong>Pre</strong> and <strong>postoperative</strong> chemotherapy with <strong>albendazole</strong> is recommended for <strong>2 years</strong> after curative surgery.</p>\n<p><strong>Casoni&rsquo;s test&nbsp;</strong>is a&nbsp;<strong>type I hypersensitivity&nbsp;</strong>reaction<strong>&nbsp;</strong>used in the diagnosis of&nbsp;<strong>hydatid</strong>&nbsp;<strong>disease</strong>. It&nbsp;involves the <strong>intradermal</strong> injection of 0.25 ml of sterilized fluid from hydatid cysts/human cysts on the forearm. An equal volume of saline is injected into the other forearm as control. It is observed for the next 30 minutes and again after 1-2 days. The fluid used for the test is sterilized by&nbsp;<strong>Seitz</strong>&nbsp;<strong>filtration.&nbsp;</strong>A&nbsp;<strong>wheal</strong>&nbsp;response at the injection site occurring within 20 minutes is considered&nbsp;<strong>positive.&nbsp;</strong>It is followed by a secondary reaction 8 hours later. The test is not often used nowadays due to its non-specificity.</p>\n<p>The hydatid cyst wall consists of<strong> 3 layers</strong>:</p>\n<ul>\n<li><strong>Pericyst</strong>- the outer dense fibrous capsule that is formed as a result of host inflammatory response.</li>\n<li><strong>Ectocyst</strong>- the intermediate layer consisting of acellular, chitinous, laminated hyaline material.</li>\n<li><strong>Endocyst</strong>- the inner germinal layer that is cellular and consists of a number of nuclei embedded in protoplasmic mass and is extremely thin. It is the vital layer of the cyst and it is the site of asexual reproduction giving rise to brood capsules with scolices.</li>\n</ul>\n<p>The below image shows the histology of hydatid cyst.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e626a7d9b9f34b70a92c7c5939c1cb93.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7fba0f063f3942da8957d599586cc02ex960x540.JPEG"
    ]
  },
  {
    "text": "A patients plasma has high levels of interferon beta. He most likely has an infection due to _____ ?",
    "choices": [
      {
        "id": 1,
        "text": "Virus"
      },
      {
        "id": 2,
        "text": "Bacteria"
      },
      {
        "id": 3,
        "text": "Fungi"
      },
      {
        "id": 4,
        "text": "Mycoplasma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Interferon beta is secreted during infection due to viruses. It is produced by fibroblasts.&nbsp;</p>\n<p>Types of interferons:&nbsp;</p>\n<ul>\n<li><strong>Alpha Interferon (Leukocyte interferon)&nbsp;</strong>is produced by leucocytes. It has antiviral activity.&nbsp;</li>\n<li><strong>Beta Interferon (Fibroblast interferon)&nbsp;</strong>is produced by fibroblasts and epithelial cells. It has antiviral activity.&nbsp;</li>\n<li><strong>Gamma Interferon (Immune interferon)&nbsp;</strong>is produced by T-lymphocytes.&nbsp;It is concerned with immuno-modulatory and anti-proliferative functions.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following are acid-fast staining organisms?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3, 4, 5"
      },
      {
        "id": 2,
        "text": "1, 3 , 6"
      },
      {
        "id": 3,
        "text": "1, 2, 3"
      },
      {
        "id": 4,
        "text": "3, 4, 5, 6"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Nocardia</strong>, <em><strong>Mycobacterium leprae</strong></em>, and <em><strong>Cytoisospora belli</strong></em>&nbsp;are <strong>acid-fast staining</strong> organisms.</p>\n<p>Acid-fast staining is based on the principle that tubercle bacilli <strong>resist decolourization</strong> with acids after staining with <strong>aniline dyes</strong>. Acid fastness is attributed to the variety of fatty acids, alcohols, and lipids in the tubercle bacilli. Acid-fast organisms usually contain <strong>mycolic acid</strong>, which is acid-fast in the free state.&nbsp; The steps to carry out acid-fast staining as modified by Ziehl and Neelsen are:</p>\n<ol>\n<li>The slide is stained with <strong>carbolfuchsin</strong> along with the application of <strong>heat</strong>.</li>\n<li>It is then decolourized with <strong>20% sulphuric acid</strong>. Later <strong>methylene blue</strong> is used for <strong>counterstaining</strong>.</li>\n<li>The acid-fast bacteria <strong>retain</strong> the fuchsin colour, while other organisms take up the counterstain.</li>\n</ol>\n<p>The genus <strong>Nocardia</strong> are aerobic organisms and <strong>weakly acid-fast</strong> positive rods. They stain with carbolfuchsin and retain it when <strong>1-4% sulfuric acid</strong> is used.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d5bb84dc9a0c4e39802ca0afeb4d0249x720x666.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cb75f30561ca485c9793ec774800981dx1200x900.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cb1583706fb345659bde2abfd203dafex700x714.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ef882a995b5141d6a7c6cbfcf9f5632dx512x296.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8c914253098548b18a673a6414d4a5ebx800x600.JPEG"
    ]
  },
  {
    "text": "Which of the following complement deficiency leads to an increased risk of Neisseria meningitidis infection?",
    "choices": [
      {
        "id": 1,
        "text": "C5-C9 deficiency"
      },
      {
        "id": 2,
        "text": "C1 esterase inhibitor deficiency"
      },
      {
        "id": 3,
        "text": "C1, C2, C4 deficiency"
      },
      {
        "id": 4,
        "text": "C2 deficiency"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Complements <strong>C5-C9 deficiency</strong> (Terminal complement pathway deficiency) increases the risk of disseminated&nbsp;<strong>Neisseria meningitidis</strong> infection.</p>\n<table style=\"height: 339px;\" width=\"490\">\n<tbody>\n<tr>\n<td style=\"width: 173.333px;\">Complement protein deficiency</td>\n<td style=\"width: 301.333px;\">Diseases associated</td>\n</tr>\n<tr>\n<td style=\"width: 173.333px;\"><strong>C1, C2, C4</strong></td>\n<td style=\"width: 301.333px;\">Immune-complex disease (Eg:<strong>SLE</strong>)</td>\n</tr>\n<tr>\n<td style=\"width: 173.333px;\">C3, Factor I</td>\n<td style=\"width: 301.333px;\">Susceptibility to capsulated bacteria</td>\n</tr>\n<tr>\n<td style=\"width: 173.333px;\"><strong>C5-C9</strong></td>\n<td style=\"width: 301.333px;\">Susceptibility to <strong>Neisseria</strong></td>\n</tr>\n<tr>\n<td style=\"width: 173.333px;\">Factor D. properdin (factor P)</td>\n<td style=\"width: 301.333px;\">Susceptibility to capsulated bacteria and Neisseria.</td>\n</tr>\n<tr>\n<td style=\"width: 173.333px;\">\n<p>DAF (Decay accelerating factor)</p>\n<p>CD 59</p>\n</td>\n<td style=\"width: 301.333px;\">Paroxysmal nocturnal hemoglobinuria</td>\n</tr>\n<tr>\n<td style=\"width: 173.333px;\"><strong>C1 esterase inhibitor</strong></td>\n<td style=\"width: 301.333px;\">Hereditary angioneurotic edema(HAE)</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/be92cae731ab4913839f4cc8a460f15cx1280x2382.JPEG"
    ]
  },
  {
    "text": "Waterhouse-Friderichsen syndrome is caused by",
    "choices": [
      {
        "id": 1,
        "text": "Pneumococci"
      },
      {
        "id": 2,
        "text": "Gonococci"
      },
      {
        "id": 3,
        "text": "Meningococci"
      },
      {
        "id": 4,
        "text": "Pseudomonas"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Waterhouse-Friderichsen Syndrome</strong> also known as <strong>hemorrhagic adrenalitis</strong>&nbsp;or&nbsp;<strong>fulminant meningococcemia</strong> is a complication seen in infection with <strong>meningococci</strong>, characterized by <strong>bilateral adrenal gland hemorrhage</strong>.</p>\n<p><strong>Complications :&nbsp;</strong></p>\n<ul>\n<li><strong>Shock</strong>, extensive haemorrhage within the skin and fall into coma.</li>\n<li>Death usually after a few hours, <strong>adrenal insufficiency</strong> being the immediate cause.</li>\n</ul>\n<p><strong>TREATMENT</strong></p>\n<ul>\n<li>Fulminant meningococcemia is a <strong>medical emergency</strong> and needs to be treated with adequate antibiotics as fast as possible.</li>\n<li><strong>Ceftriaxone</strong> is an antibiotic commonly employed today.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old boy returned from a birthday party and began vomiting 4-5 hours later, followed by a few episodes of loose stools but had no fever. Other children who had attended the party reported a similar illness. Food samples were collected and sent for toxin detection by a test based on the following principle. This test is known as:",
    "choices": [
      {
        "id": 1,
        "text": "Cassette ELISA"
      },
      {
        "id": 2,
        "text": "Sandwich ELISA"
      },
      {
        "id": 3,
        "text": "Competitive ELISA"
      },
      {
        "id": 4,
        "text": "Indirect ELISA"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows <strong>Sandwich<span id=\"Reverse_ELISA\" class=\"mw-headline\">&nbsp;ELISA</span></strong><span id=\"Reverse_ELISA\" class=\"mw-headline\">.&nbsp;</span>The above clinical scenario is suggestive of <strong>food poisoning</strong> caused by <em><strong>Staphylococcus aureus</strong></em>.</p>\n<p>The symptoms of&nbsp;food poisoning caused by <em>S&nbsp;aureus</em> appear within 1-8 hours. Multiple people are exposed to the pathogen from a common source and present with vomiting, loose stools but no fever. Foods from outbreaks of food poisoning is examined for the presence of <strong>staphylococcal enterotoxin A (SEA)</strong> by a <strong>sandwich ELISA</strong>.</p>\n<p><strong><span id=\"Reverse_ELISA\" class=\"mw-headline\">ELISA</span></strong>&nbsp;<span id=\"Reverse_ELISA\" class=\"mw-headline\">(</span><span id=\"Reverse_ELISA\" class=\"mw-headline\">Enzyme-linked immunosorbent assay)&nbsp;</span>involves the use of an <strong>immunosorbent</strong>, which is an absorbing material that is specific for one of the components of the reaction, either the <strong>antigen or antibody</strong>. This may be a <strong>particulate</strong> phase (cellulose or agarose), or a <strong>solid</strong> phase (polystyrene, polyvinyl, or polycarbonate tubes or microwells). ELISA is done using <strong>96-well microtitre plates</strong> suitable for automation.</p>\n<p><strong>Sandwich ELISA</strong> is used for antigen detection in the patient samples. The <strong>antigen is sandwiched between two layers of antibodies</strong> - capture and detection antibodies.</p>\n<p><span class=\"mw-headline\">The following <strong>steps</strong> are followed in <strong>Sandwich ELISA</strong>:</span></p>\n<div class=\"page\" title=\"Page 149\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ol>\n<li>The<strong> capture</strong>&nbsp;<strong>antibody</strong> is immobilized on a microtiter well.</li>\n<li>A sample containing <strong>antigen</strong> is added and allowed to react with the immobilized antibody.</li>\n<li>After the well is washed, a second <strong>enzyme-linked antibody</strong> (Detecting antibody) specific to the antigen is added and allowed to react with the bound antigen.</li>\n<li>After any free second antibody is removed by washing, the&nbsp;<strong>substrate</strong> is added. This substrate is converted by the enzyme to detectable colored form and the <strong>colored reaction product</strong> is measured.</li>\n</ol>\n</div>\n</div>\n</div>\n</div>\n<p>Other options:</p>\n<p><strong>Cassette ELISA</strong>: Here, each specimen is tested in a separate disposable cassette and gives rapid results (10-15 minutes). There is no need for microplate washers or readers and the result can be read visually. Example: Dot Blot Assay used for the detection of HIV type 1 and 2 antibodies.</p>\n<p><strong>Competitive ELISA</strong>: Both the unknown antigen (sample) and the known antigen (standard) compete with each other for a fixed amount of antibody.</p>\n<p><strong>Indirect ELISA</strong>: Antibody in the sample can be detected or quantitatively measured using this method.&nbsp;Serum or some other sample containing primary antibody (Ab1) is added to an antigen-coated microtiter well and allowed to react. Enzyme-conjugated secondary anti-isotype antibody (Ab2) is added which binds to the primary antibody.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b3f3baa0943b4ff8aceba98d57edfd13.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/57b1a572d7fe4fca99c30005e0b633d1x1280x2225.JPEG"
    ]
  },
  {
    "text": "Two days after penicillin administration, a patient developed antibodies that resulted in hemolysis. Which type of hypersensitivity reaction is this?",
    "choices": [
      {
        "id": 1,
        "text": "Type I"
      },
      {
        "id": 2,
        "text": "Type II"
      },
      {
        "id": 3,
        "text": "Type III"
      },
      {
        "id": 4,
        "text": "Type IV"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Development</strong> of<strong> antibodies</strong> resulting in hemolysis <strong>after penicillin</strong> administration is an example of a <strong>type II reaction.&nbsp;</strong>This is a&nbsp;<strong>drug-induced</strong> type II hypersensitivity reaction.</p>\n<p>Penicillin in high doses can result in <strong>immune-mediated hemolysis</strong> via the hapten mechanism. In this, the drug attaches to surface of RBC membrane. Antibodies are produced that are targeted against this combination of penicillin and RBCs.&nbsp;</p>\n<p><strong>Complement</strong> is <strong>activated</strong> by the attached antibody leading to the removal of red blood cells by the spleen.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fbde3e7d7b9e49e9876890bf5fde33bfx1280x2090.JPEG"
    ]
  },
  {
    "text": "A 2 year old child is brought to the OPD with oral and perioral lesions as seen in the image below. Similar lesions were also found on his palms and soles. What is the probable causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Coxsackie virus"
      },
      {
        "id": 2,
        "text": "Molluscum contagiosum"
      },
      {
        "id": 3,
        "text": "Parvovirus B19"
      },
      {
        "id": 4,
        "text": "Streptococcus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario and the image are suggestive of<strong> hand, foot, and mouth disease</strong> that is caused by <strong>coxsackie A virus</strong>.</p>\n<p><strong>Hand, foot, and mouth disease </strong>initially begins with fever and sore throat following which blisters develop over the oral cavity, hands and feet.</p>\n<p>It usually occurs in children but may also occur in adults. It is a self limiting disease and subsides in 1-2 weeks.</p>\n<p>The following images show lesions affecting hands and feet:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/46f8d758d5734e71be82126c8dac8dbb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/21b9868b8519401c8f7bc78bdf97c16dx186x179.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/98a06a09e79840a2b3d3b7556a80c6f5x202x270.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ec51305e7b54855b34a3f459969cc2fx381x150.JPEG"
    ]
  },
  {
    "text": "Which of the following is not used as an immediate test in the screening of urinary tract infections (UTI)?",
    "choices": [
      {
        "id": 1,
        "text": "Pour plate culture"
      },
      {
        "id": 2,
        "text": "Griess Nitrite test"
      },
      {
        "id": 3,
        "text": "Leukocyte esterase test"
      },
      {
        "id": 4,
        "text": "Wet mount examination"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Pour plate culture </strong>(quantitative test) is not used as an immediate test for screening of UTI.&nbsp;However it is considered the <strong>best</strong> diagnostic test for confirmation of UTI due it&rsquo;s high sensitivity and specificity.</p>\n<p>The screening tests for UTI are as follows:</p>\n<ul>\n<li><strong>Wet mount examination:</strong> It is done to demonstrate pus cells in urine.&nbsp;</li>\n<li><strong>Leukocyte esterase test</strong>: It is a rapid and cheaper method, and detects leukocyte esterases secreted by pus cells present in urine.</li>\n<li><strong>Nitrate reduction test </strong>(Griess test): Nitrate reducing bacteria like E. coli give a positive result.</li>\n<li><strong>Catalase test</strong>: E. coli and other bacteria that produce the enzyme catalase give a positive result.</li>\n</ul>\n<p>Quantitative Culture:</p>\n<ul>\n<li>Standardized loop technique</li>\n<li>Pour plate method</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A microbiologist performs the following test and observes swelling of the capsule. In which of the following organisms will this phenomenon not be observed in?",
    "choices": [
      {
        "id": 1,
        "text": "Bacillus anthracis"
      },
      {
        "id": 2,
        "text": "Klebsiella pneumoniae"
      },
      {
        "id": 3,
        "text": "Neisseria gonorrheae"
      },
      {
        "id": 4,
        "text": "Hemophilus influenzae"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows <strong>Quellung</strong> reaction and is seen in <strong>capsulated bacteria</strong>.&nbsp;<strong><em>Neisseria</em> </strong><em><strong>gonorrhoeae</strong>&nbsp;</em>is <strong>not capsulated,&nbsp;</strong>therefore Quellung reaction will not be observed in it.&nbsp;</p>\n<p>In Quellung reaction, a suspension of a capsulated bacterium is mixed with its specific anticapsular serum and examined under the microscope, the capsule becomes very prominent and appears swollen.</p>\n<p>Mnemonic for capsulated organisms:</p>\n<p><strong>Some</strong>-<em><strong> S</strong>treptococcus pneumoniae</em></p>\n<p><strong>Killers</strong>- <em><strong>K</strong>lebsiella pneumoniae</em></p>\n<p><strong>Have</strong>- <em><strong>H</strong>aemophilus influenzae</em></p>\n<p><strong>Nice</strong>-<em><strong> N</strong>eisseria meningitidis</em></p>\n<p><strong>Capsules</strong>- <em><strong>C</strong>ryptococcus neoformans</em></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3991e0a3e2654d6e990f2152d817dfaa.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following virus is bullet shaped?",
    "choices": [
      {
        "id": 1,
        "text": "Rabies virus"
      },
      {
        "id": 2,
        "text": "Corona virus"
      },
      {
        "id": 3,
        "text": "Rota virus"
      },
      {
        "id": 4,
        "text": "Influenza virus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The virus with a bullet shape is the&nbsp;<strong>rabies virus.&nbsp;</strong>Rabies viruses&nbsp;belonging to the family Rhabdoviridae are&nbsp;<strong>bullet-shaped</strong>&nbsp;viruses with&nbsp;<strong>nonsegmented single-stranded RNA</strong>.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7ecb24932479498e9a6ca9d85e46c8b7x1279x1179.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d41581cc91154398a4320168f2c9679dx1280x1155.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5b294c5602bd4221a2c91739a64cfd49x1280x1177.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4b9edab8c716431eb6f4d316fc374f9cx1279x1476.JPEG"
    ]
  },
  {
    "text": "A patient presented with a high fever, altered sensorium, headache, neck rigidity, and seizures. He was diagnosed with HSV encephalitis. Which of the following tests can be used to confirm the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "IgM in CSF"
      },
      {
        "id": 2,
        "text": "Tzanck smear of CSF"
      },
      {
        "id": 3,
        "text": "CSF PCR for viral DNA"
      },
      {
        "id": 4,
        "text": "CSF culture on chick embryo lines"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>HSV-DNA </strong>demonstration in<strong> CSF by PCR </strong>is the<strong> investigation of choice</strong> for<strong> HSV encephalitis.\u00a0</strong></p>\n<p><strong>Herpes simplex virus (HSV)</strong>\u00a0encephalitis is defined as inflammation of brain parenchyma caused by the herpes virus, and it typically presents as an<strong> acute febrile illness</strong>.</p>\n<div class=\"page\" title=\"Page 1135\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Patients typically present with acute onset of <strong>fever</strong>,\u00a0<strong>altered levels of consciousness</strong>, personality changes, and evidence of either <strong>focal or diffuse neurologic signs and symptoms, </strong>especially in the<strong> temporal lobe.</strong>\u00a0<strong>Focal or generalized seizures</strong> occur in many patients with HSV encephalitis. Other most commonly encountered focal findings include aphasia, ataxia, upper motor neuron or lower motor neuron type lesions, and cranial nerve deficits.</p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>HSV-DNA</strong> demonstration in CSF by <strong>PCR </strong>is the investigation of choice for HSV encephalitis. Other investigations that can help include CSF examination, CSF culture, serological studies, MRI, CT, EEG, and brain biopsy.</p>\n<p>The <strong>T2-weighted MRI of the brain</strong> will show <strong>hyperintensity in the temporal lobe</strong> in most of the patients. <strong>Bilateral</strong> involvement of the temporal lobe is <strong>more common</strong> in HSV encephalitis.</p>\n<p>The image below is a<strong>\u00a0</strong><strong>coronal T2-weighted MR</strong> image showing a high signal intensity in the temporal lobes in a patient with HSV encephalitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e8c33e7dde164fd8adfa7d0badbcc4ddx480x512.JPEG"
    ]
  },
  {
    "text": "A child presented with umbilicated pearly white nodules in the skin. Which of the following will be seen on biopsy of these lesions?",
    "choices": [
      {
        "id": 1,
        "text": "Warthin-Finkeldey cells"
      },
      {
        "id": 2,
        "text": "Henderson-Paterson bodies"
      },
      {
        "id": 3,
        "text": "Guarnieri bodies"
      },
      {
        "id": 4,
        "text": "Negri bodies"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The lesions in this child are suggestive of <em><strong>Molluscum contagiosum </strong></em>virus&nbsp;infection. They show&nbsp;<strong>Henderson-Paterson bodies.</strong></p>\n<p>Double-stranded DNA virus causes molluscum contagiosum. Lesions are firm, white to flesh-coloured, <strong>dome-shaped, pearly nodules</strong>, having&nbsp;a <strong>central umbilication</strong> from which one can express a cheesy material.</p>\n<p>Inclusion bodies are the most characteristic histological features seen in virus-infected cells. Inclusion bodies can be demonstrated under a light microscope.&nbsp;</p>\n<p>Inclusion bodies can be situated in the:</p>\n<ul>\n<li>Cytoplasm as in poxviruses, rabies.&nbsp;</li>\n<li>Nucleus as in herpesviruses</li>\n<li>Both cytoplasm and nucleus as in the measles virus</li>\n</ul>\n<p>Inclusion bodies are generally acidophilic and appear as pink structures when stained with Giemsa stain or eosin methylene blue but some viruses like adenovirus have basophilic inclusions.&nbsp;<br /><br />Other options:</p>\n<p>Option A- In <strong>measles</strong>, infected cells show acidophilic nuclear and cytoplasmic inclusions. The lymphoid tissues of measles patients show multinucleated giant cells named <strong>Warthin-Finkeldey cells</strong>.&nbsp;</p>\n<p>Option C- <strong>Vaccinia</strong>-infected&nbsp;cells have small multiple-inclusion bodies named <strong>Guarnieri bodies</strong>.&nbsp;</p>\n<p>Option D- In <strong>rabies</strong>-infected&nbsp;brain cells, intracytoplasmic eosinophilic inclusions named <strong>Negri bodies</strong> are seen.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The 8-year-old child with delayed development, whose picture is given below, was referred for evaluation of recurrent infections. History is notable for the presence of congenital heart defects. Further examination reveals the presence of a cleft palate and workup reveals the presence of hypocalcemia.  Which component of the immune system is likely to be affected in this child?",
    "choices": [
      {
        "id": 1,
        "text": "Humoral immunity"
      },
      {
        "id": 2,
        "text": "Complement fixation"
      },
      {
        "id": 3,
        "text": "Cell-mediated immunity"
      },
      {
        "id": 4,
        "text": "Phagocytosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical features point towards the diagnosis of<strong> DiGeorge syndrome</strong>. <strong>Cell-mediated immunity</strong> is affected in DiGeorge syndrome.</p>\n<p>DiGeorge syndrome is a complex embryopathy with an&nbsp;<strong>autosomal dominant</strong> inheritance that is caused by <strong>microdeletions</strong>&nbsp;in&nbsp;<strong>chromosome 22</strong>, leading to multiple developmental defects (involving the 3rd and 4th pharyngeal pouches), including hypoparathyroidism, and dysmorphic facies.</p>\n<p>Children with DiGeorge syndrome are <strong>born without </strong>a <strong>thymus</strong> and therefore <strong>lack the T-cell component</strong> of the cell-mediated immune system. The disease may range from mildly increased susceptibility to infections to a severe disease requiring thymic or hematopoietic stem cell transplant. Patients are generally able to cope with extracellular bacterial infections because their innate and T cell-independent antibody responses are intact, but they <strong>cannot</strong> effectively <strong>eliminate</strong> <strong>intracellular pathogens</strong> such as viruses, intracellular bacteria, and fungi.</p>\n<p>The <strong>clinical features</strong> of this syndrome include:</p>\n<ul>\n<li><strong>Congenital heart disease-&nbsp;</strong>aortic arch anomalies</li>\n<li>Abnormalities of the palate like cleft palate.</li>\n<li><strong>Facial dysmorphism</strong> such as hypertelorism, antimongoloid slant, low set ears, micrognathia, short philtrum, bifid uvula.</li>\n<li><strong>Thymic hypoplasia</strong> with impaired T cell immunity.&nbsp;</li>\n<li><strong>Parathyroid hypoplasia</strong> resulting in hypocalcemia (tetany).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1b621ce3340c425d85a280b91d209875.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A pregnant woman who underwent syphilis testing showed positive results for VDRL but negative for specific treponemal tests. Interpret the results",
    "choices": [
      {
        "id": 1,
        "text": "Positive for syphilis"
      },
      {
        "id": 2,
        "text": "False negative"
      },
      {
        "id": 3,
        "text": "Positive for non pathogenic treponema"
      },
      {
        "id": 4,
        "text": "Biological false positive"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This pregnant woman with a positive VDRL and negative for&nbsp;specific treponemal tests is most likely to have a biological<strong> false positive test.</strong></p>\n<p>&nbsp;The serological tests for syphilis use either nontreponemal or treponemal antigens.</p>\n<div class=\"page\" title=\"Page 346\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><strong>Nontreponemal tests</strong>- Are used as <strong>screening tests</strong> for syphilis and follow the efficacy of therapy. They are not very sensitive in early syphilis, and false-positive results can occur with many other diseases. Examples- VDRL(Venereal Disease Research Laboratory)&nbsp;and RPR (Rapid plasma reagin).</li>\n<li><strong>Treponemal antibody tests</strong>- Are used to <strong>confirm</strong> if a <strong>positive</strong> result from a <strong>nontreponemal</strong> <strong>test</strong> is truly positive or falsely positive. They are less useful as screening tests because once positive after initial syphilitic infection the tests remain positive for life independent of therapy for syphilis. Examples- T. pallidum&ndash;particle agglutination(TPPA)test, Fluorescent treponemal antibody absorbed (FTA-ABS), etc.</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old man presents to the OPD with complaints of fever chills, abdominal pain, and diarrhoea. He gives a history of consuming raw refrigerated cucumbers the previous day. What is the most likely etiologic organism?",
    "choices": [
      {
        "id": 1,
        "text": "Staphylococcus aureus"
      },
      {
        "id": 2,
        "text": "Bacillus cereus"
      },
      {
        "id": 3,
        "text": "Listeria monocytogenes"
      },
      {
        "id": 4,
        "text": "Vibrio cholerae"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical picture is suggestive of <strong>food poisoning</strong>&nbsp;caused by<strong>&nbsp;<em>Listeria monocytogenes.</em></strong></p>\n<p>It can <strong>survive at</strong> refrigerator temperatures (<strong>4&deg;C</strong>), under conditions of low pH and high salt. So&nbsp;it is able to overcome food preservation and safety barriers, making it an important foodborne pathogen.</p>\n<p><strong>Healthy persons</strong> exposed to<em> L. monocytogenes</em> in food may not become ill or may develop a mild, self-limiting <strong>febrile gastroenteritis</strong> lasting 1&ndash;3 days.&nbsp;Symptoms include fever, chills, headache, myalgias, abdominal pain, and diarrhea. Infection of <strong>pregnant women</strong> may lead to <strong>abortion</strong> or <strong>stillbirth</strong>. It may cause <strong>meningitis </strong>or<strong> sepsis</strong> in <strong>neonates</strong> due to perinatal transmission through an infected birth canal.&nbsp;<strong>Immunocompromised</strong> individuals can develop Listeria <strong>meningoencephalitis, bacteremia</strong>, and (rarely) focal infections.</p>\n<p>The&nbsp;drug of choice is high dose&nbsp;<strong>intravenous ampicillin.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old child presents with fever, sore throat, and dyspnea. The findings of oral cavity examination are shown below. What is the mechanism of action of the toxin produced by the causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Increase in cAMP"
      },
      {
        "id": 2,
        "text": "Inhibition of elongation factor-2 (EF-2)"
      },
      {
        "id": 3,
        "text": "Inhibition of 60S"
      },
      {
        "id": 4,
        "text": "Increase in cGMP"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This child with pseudomembrane over tonsil has<strong> diphtheria, </strong>in which the&nbsp;toxin<strong> inactivates the elongation factor EF-2.</strong></p>\n<p>Diphtheria toxin is an <strong>exotoxin </strong>that consists of two fragments - A and B. It<strong> acts by inhibiting protein synthesis</strong>. Fragment B helps in binding the toxin to the cells while fragment A <strong>inactivates the elongation factor (EF-2) </strong>responsible for protein synthesis.&nbsp;<em>Pseudomonas aeruginosa</em> also produces toxins with a similar mechanism of action.</p>\n<p>This infection presents as fever and sore throat, which progresses to dyspnea due to obstruction by the pseudomembrane. Bull's neck appearance is seen due to cervical lymphadenitis. Complications like damage to the heart (myocarditis), kidney (tubular necrosis), liver, and adrenal glands can develop due to the toxin.</p>\n<div class=\"page\" title=\"Page 251\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neisser's or Albert's stain will show the bacilli with metachromatic granules situated at the poles of the bacilli. Tellurite blood agar is the selective culture medium.</p>\n</div>\n</div>\n</div>\n<p>It is treated mainly by neutralizing with antitoxin and antibiotics to arrest more toxin production.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cb831f1d20db43fb85deed69120d5de4.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs acts on the following stage of malarial parasite?",
    "choices": [
      {
        "id": 1,
        "text": "Halofantrine"
      },
      {
        "id": 2,
        "text": "Primaquine"
      },
      {
        "id": 3,
        "text": "Clindamycin"
      },
      {
        "id": 4,
        "text": "Atovaquone"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows <strong>banana</strong>&nbsp;shaped <strong>gametocyte</strong> stage <strong>of <em>Plasmodium Falciparum.</em></strong></p>\n<p>The antimalarial drugs which have gametocidal properties include <strong>chloroquine and primaquine.</strong></p>\n<p>Primaquine is used for <strong>14 days</strong> as a tissue <strong>schizonticide</strong> for the purpose of reducing the likelihood of relapse due to hypnozoites of <em><strong>Plasmodium&nbsp;vivax </strong></em>and<em><strong> Plasmodium ovale</strong></em>. It is also a potent <strong>gametocidal</strong> drug and is given as a single dose on&nbsp;<strong>day 2</strong> for its<strong> gametocidal </strong>property in<em><strong> Plasmodium Falciparum.</strong></em></p>\n<p><strong>Chloroquine</strong> acts primarily against erythrocytic asexual stages, although it has gametocidal properties.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7200bb4f087d4a2698271ce5c226a03b.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Match the respective organisms with their periodicity.",
    "choices": [
      {
        "id": 1,
        "text": "1-a , 2-b, 3-c, 4-b"
      },
      {
        "id": 2,
        "text": "1-b, 2-a, 3-c, 4-b"
      },
      {
        "id": 3,
        "text": "1-c , 2-a, 3-b, 4-a"
      },
      {
        "id": 4,
        "text": "1-a , 2-c, 3-b, 4-a"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<table style=\"height: 134px;\" width=\"458\">\n<tbody>\n<tr>\n<td style=\"width: 221.754px;\">1.&nbsp;Wuchereria bancrofti</td>\n<td style=\"width: 221.357px;\">b. Nocturnal&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 221.754px;\">2.&nbsp;Loa loa</td>\n<td style=\"width: 221.357px;\">a.&nbsp;Diurnal</td>\n</tr>\n<tr>\n<td style=\"width: 221.754px;\">3.&nbsp;Onchocerca volvulus</td>\n<td style=\"width: 221.357px;\">c.&nbsp;Nonperiodic</td>\n</tr>\n<tr>\n<td style=\"width: 221.754px;\">4.&nbsp;&nbsp;Brugia malayi</td>\n<td style=\"width: 221.357px;\">b. Nocturnal</td>\n</tr>\n</tbody>\n</table>\n<p>The microfilariae are found in <strong>large numbers</strong> in the peripheral blood during <strong>specific times</strong> of the day, depending on the blood-feeding habits of their insect vector. This is known as <strong>periodicity</strong>. Filarial worms can exhibit nocturnal, diurnal periodicity, or no periodicity at all.</p>\n<ul>\n<li><strong>Nocturnal periodicity</strong>: When the largest number of microfilariae are present in the blood at night. Eg-&nbsp;<strong>Wuchereria bancrofti,&nbsp;Brugia malayi,&nbsp;Brugia timori</strong></li>\n<li><strong>Diurnal periodicity</strong>: When the largest number of microfilariae occur in blood during the day. Eg-&nbsp;<strong>Loa loa</strong></li>\n<li><strong>Nonperiodic:</strong> When the number of microfilariae maintains a <strong>constant level</strong> during the day and night. Eg-&nbsp;<strong>Onchocerca volvulus</strong></li>\n<li><strong>Subperiodic</strong> or nocturnally subperiodic: When the microfilariae can be detected in the blood throughout the day but are detected in larger numbers in the late afternoon or at night. Eg-&nbsp;Wuchereria bancrofti in the eastern Pacific and&nbsp;Brugia malayi in Indonesia and southeast Asia.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following infection is caused by the organism shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Diphtheria"
      },
      {
        "id": 2,
        "text": "Gas gangrene"
      },
      {
        "id": 3,
        "text": "Botulism"
      },
      {
        "id": 4,
        "text": "Tetanus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given image shows &nbsp;<strong>spherical</strong> and <strong>terminal</strong> <strong>spores&nbsp;</strong>with<strong>&nbsp;</strong>a<strong> drumstick appearance</strong> suggestive of <strong><em>Clostridium tetani.&nbsp;</em></strong>It causes <strong>tetany</strong>.&nbsp;</p>\n<ul>\n<li>The genus <em>Clostridium</em> consists of <strong>gram-positive, anaerobic, spore-forming bacilli.</strong></li>\n<li>The spores are wider than the bacillary bodies, giving the bacillus a swollen appearance, resembling a <strong>spindle</strong>. Hence, the name <em>Clostridium</em>.</li>\n</ul>\n<p>The shape and position of spores vary in different species and these are used in the identification and classification of <em>Clostridium</em> as follows:</p>\n<ol>\n<li><strong>Central or equatorial: </strong>&nbsp;<em>Clostridium bifermentans</em></li>\n<li><strong>Subterminal:</strong><em> Clostridium perfringens, Clostridium novyi, </em>and<em> Clostridium botulinum</em></li>\n<li><strong>Oval and terminal (tennis racket shaped)</strong>:<em> Clostridium tertium </em>and<em> Clostridium difficle</em></li>\n<li><strong>Spherical and terminal (drumstick appearance)</strong>: <em>Clostridium tetani</em></li>\n</ol>\n<p>The image given below shows&nbsp;<strong><em>Corynebacterium diphtheriae&nbsp;</em></strong>which causes <strong>diphtheria.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9a0ea4080f7242ba8ae1d034ea669f4f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a4af94639e08448fa7425ef69bcb1e2ex1280x2413.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/614fcc16995646a98ea3a2664c264d9dx634x600.PNG"
    ]
  },
  {
    "text": "Which of the following is the best diagnostic method to diagnose typhoid after starting antibiotics?",
    "choices": [
      {
        "id": 1,
        "text": "Widal test"
      },
      {
        "id": 2,
        "text": "Bone marrow culture"
      },
      {
        "id": 3,
        "text": "Blood culture"
      },
      {
        "id": 4,
        "text": "Urine culture"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The best diagnostic method to diagnose typhoid after starting antibiotics is a&nbsp;<strong>bone marrow culture.</strong></p>\n<p>Enteric fever&nbsp;(typhoid fever) is caused by&nbsp;<strong>Salmonella</strong>&nbsp;species. The patient presents with&nbsp;<strong>stepladder pyrexia&nbsp;</strong>(fever), <strong>abdominal pain</strong>, <strong>diarrhoea</strong>,&nbsp;<strong>headache</strong>, and <strong>malaise</strong>.</p>\n<div>\n<p>Diagnosis of enteric fever:</p>\n<ul>\n<li>\n<p><strong>Blood culture</strong>: It is more&nbsp;<strong>sensitive during 1st week</strong>. It rapidly becomes negative on treatment with antibiotics.</p>\n</li>\n<li><strong>Antibody testing</strong>: <strong>WIDAL test</strong> to detect rising titers of H and O agglutinins against salmonella typhi and paratyphi. Agglutinins <strong>appear </strong>by the<strong> end of the first week</strong> and rise steadily <strong>up to the 3rd or 4th week</strong>, after which they disappear.</li>\n<li>\n<p><strong>Stool culture:</strong>&nbsp;It yields positive results <strong>from the 3rd week</strong> onwards.</p>\n</li>\n<li>\n<p><strong>Urine culture</strong>: Results may be positive <strong>after the 2nd week</strong>.</p>\n</li>\n<li><strong>Bone marrow culture</strong>&nbsp;remains <strong>positive for</strong>&nbsp;<strong>5 days&nbsp;</strong>even after the start of&nbsp;<strong>antibiotics&nbsp;</strong>and is the <strong>most sensitive</strong> test <strong>in the</strong> <strong>first week.&nbsp;</strong>The culture of&nbsp;<strong>duodenal aspirate</strong>&nbsp;may yield positive results when bone marrow culture is inconclusive.</li>\n</ul>\n</div>\n<div>Widal Test:&nbsp;This is a test for the <strong>measurement of&nbsp;H&nbsp;and O agglutinins</strong> for typhoid and paratyphoid bacilli&nbsp;in the patient's <strong>serum</strong>. In this test, the&nbsp;agglutination titer depends on the stage of the disease. It is performed by mixing equal volumes (0.4 ml) of&nbsp;serial dilutions of the serum&nbsp;(from 1/10 to 1/640) with <strong>fixed volumes of&nbsp;H and O antigens</strong>&nbsp;in the&nbsp;<strong>Dreyer's and Felix</strong> agglutination tubes, respectively. These tubes are incubated overnight and the agglutination titres are read. <strong>H agglutination</strong> leads to the formation of&nbsp;<strong>cotton woolly clumps</strong>&nbsp;while&nbsp;<strong>O agglutination</strong>&nbsp;is seen as a&nbsp;<strong>disc-like pattern</strong>&nbsp;at the <strong>bottom of the tube</strong>.<br />The&nbsp;antigens used in Widal's test&nbsp;include:</div>\n<ul>\n<li>O antigens of&nbsp;S. typhi&nbsp;(TO)</li>\n<li>H antigens of&nbsp;S. typhi&nbsp;(TH)</li>\n<li>H antigens of&nbsp;S. paratyphi A&nbsp;(AH)</li>\n<li>H antigens of&nbsp;S. paratyphi B&nbsp;(BH)</li>\n</ul>\n<p>Interpretation:&nbsp;</p>\n<ul>\n<li>The agglutination titer will <strong>depend on the stage of&nbsp;the disease</strong>:\n<ul>\n<li>Agglutinins usually appear by the <strong>end of&nbsp;the first week</strong>.&nbsp;</li>\n<li>The&nbsp;titer <strong>increases&nbsp;steadily&nbsp;till the third&nbsp;or fourth week</strong>,&nbsp;after which it declines gradually.</li>\n</ul>\n</li>\n<li>The<strong> H agglutinins persist longer than O</strong> agglutinins.\n<ul>\n<li>H antibodies appear&nbsp;earliest&nbsp;after infection and persist for several months.</li>\n<li>The O antibodies follow the appearance of H antibodies and disappear in a few weeks.&nbsp;</li>\n</ul>\n</li>\n<li>The&nbsp;<strong>4-fold rise</strong> in titers&nbsp;<strong>between 1st and 3rd week</strong>&nbsp;is highly <strong>significant</strong> as compared to a single high titer:\n<ul>\n<li>This is&nbsp;because,&nbsp;in persons with a prior enteric fever, there is a&nbsp;transient rise of titer&nbsp;due to unrelated infections (malaria, dengue), known as an&nbsp;anamnestic reaction.</li>\n<li>Therefore, after a&nbsp;one-week interval, if the titer increases, it indicates true infection. If the&nbsp;titer decreases, it indicates an&nbsp;anamnestic reaction.&nbsp;</li>\n</ul>\n</li>\n<li><strong>Cases&nbsp;treated early</strong> with antibiotics&nbsp;may show&nbsp;<strong>poor&nbsp;agglutinin response</strong>.</li>\n<li>Interpretation&nbsp;of Widal test:&nbsp;\n<ul>\n<li>Demonstration of a&nbsp;<strong>rise in titre&nbsp;of antibodies</strong> by testing <strong>two or more serum samples</strong> is more meaningful than a single test.</li>\n<li><strong>H&nbsp;agglutinin&nbsp;titer&nbsp;&gt; 1/160</strong>&nbsp;and&nbsp;<strong>O&nbsp;agglutinin&nbsp;titer&nbsp;&gt;1/80&nbsp;</strong>is considered&nbsp;significant.</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the class of immunoglobulin\u200b shown in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Ig A"
      },
      {
        "id": 2,
        "text": "Ig G"
      },
      {
        "id": 3,
        "text": "Ig M"
      },
      {
        "id": 4,
        "text": "Ig E"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above image shows a <strong>dimeric</strong> <strong>structure,&nbsp;</strong>characteristic of <strong>secretory</strong>&nbsp;<strong>IgA.</strong></p>\n<p><strong>IgA</strong> immunoglobulin&nbsp;is the major antibody responsible for <strong>mucosal</strong> immunity. Its serum levels are usually&nbsp;low. It is predominantly present in the <strong>extravascular secretions.</strong> It is present in <strong>secretions</strong> such as milk, saliva, and tears, and in secretions of the respiratory, intestinal, and genital tracts.</p>\n<p>When present in the<strong> serum</strong>, it exists as a <strong>monomer</strong> similar to IgG. However, when it is <strong>secreted,</strong>&nbsp;it exists as a <strong>dimer</strong>. The dimeric structure consists of two monomers, which are stabilized by two additional polypeptides:</p>\n<ul>\n<li>J chain,&nbsp;which stabilizes the molecule.</li>\n<li><strong>Secretory component</strong>,&nbsp;which is incorporated into the IgA when transported through the epithelial cell.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5a9a55c13cfb453d948929e1a1543c97.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/286886ccd1b44f4197c7951c3dfc3e2ax1280x2093.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7bb14eb08e624a19b8f9b6ce492b396ax382x501.PNG"
    ]
  },
  {
    "text": "The following egg belongs to which of the following parasite?",
    "choices": [
      {
        "id": 1,
        "text": "Schistosoma mansoni"
      },
      {
        "id": 2,
        "text": "Schistosoma hematobium"
      },
      {
        "id": 3,
        "text": "Schistosoma japonicum"
      },
      {
        "id": 4,
        "text": "Strongyloides stercoralis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows a non-operculated, yellowish-brown egg with a <strong>lateral spine</strong> near the rounded posterior end is suggestive of&nbsp;<strong><em>Schistosoma mansoni</em>.</strong></p>\n<p>Adult worms of <em>S. mansoni</em> live in the <strong>inferior mesenteric vein</strong> and their infective form is fork-tailed cercaria.</p>\n<p>Following skin penetration by cercariae, a pruritic rash termed cercarial dermatitis or <strong>swimmers itch</strong> develops locally which is self-limiting.</p>\n<p>After 4- 8 weeks of the cercarial invasion, high worm load, and egg antigen stimuli lead to the formation of immune complexes which result in serum sickness-like illness termed <strong>Katayama fever</strong>. They present with high-grade fever, rash, arthralgia, hepatosplenomegaly. lymphadenopathy and eosinophilia.&nbsp;</p>\n<p>When eggs get deposited in the small intestine, patients develop abdominal pain and blood dysentery for a long time called <strong>intestinal bilharziasis</strong>. The eggs deposited in the intestinal wall lead to microabscesses, granulomas, hyperplasia, and fibrosis.&nbsp;</p>\n<p>The <strong>drug of choice</strong> is<strong> praziquantel</strong> 40mg/kg single oral dose. <strong>Oxamniquine</strong> 15mg/kg single oral dose is also an effective dose. It distorts the tegument of the male worm and makes the worm more susceptible to the lethal action of the immune system.</p>\n<p>In <strong><em>Schistosoma&nbsp;hematobium</em></strong>, the egg has a <strong>terminal spine</strong>.</p>\n<p>In&nbsp;<em><strong>Schistosoma japonicum</strong></em>, the egg has no spine but shows a <strong>lateral small rudimentary knob</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2f80d8538c4e4424b78ac590a5fcc421.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/adf9c285638b4df69669e84d13b5323dx624x528.JPEG"
    ]
  },
  {
    "text": "A 32-year-old woman is admitted to the ICU with fever and hypotension. She has rigours, nausea, vomiting, and diarrhoea. Her BP is 70/50 mmHg, with a pulse of 140 bpm, and a temperature of 39.5\u00b0C. She is minimally responsive. Skin examination reveals generalized erythroderma but no signs of skin infection. Examination per vagina reveals a retained tampon that is immediately removed. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rocky Mountain spotted fever"
      },
      {
        "id": 2,
        "text": "Invasive meningococcal diasease"
      },
      {
        "id": 3,
        "text": "Staphylococcal toxic shock syndrome"
      },
      {
        "id": 4,
        "text": "Staphylococcal scalded skin syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above presentation of fever, hypotension, erythroderma, vomiting, and the finding of a&nbsp;<strong>retained vaginal tampon,</strong>&nbsp;point towards a likely diagnosis of<strong>&nbsp;staphylococcal</strong>&nbsp;<strong>toxic shock syndrome.</strong></p>\n<p><strong>Toxic shock syndrome (TSS)&nbsp;</strong>is a&nbsp;<strong>toxin-mediated</strong>&nbsp;disease that is most commonly associated with&nbsp;<strong>staphylococcal</strong>&nbsp;and&nbsp;<strong>group A streptococcal</strong>&nbsp;infections.&nbsp;<strong>Staphylococcal</strong>&nbsp;TSS on the other hand is associated with the toxic shock syndrome toxin-1&nbsp;<strong>(TSST-1)</strong>, which binds directly to the MHC II complex and T-cell receptors. This results in a massive increase in&nbsp;cytokines interleukin-2 (IL-2), interferon &gamma;, and tumour necrosis factor (TNF), leading to a&nbsp;<strong>cytokine storm</strong>.&nbsp;</p>\n<p><strong>Staphylococcal</strong>&nbsp;<strong>TSS </strong>is&nbsp;associated with the use of a<strong> highly absorbent tampon</strong>. Nonmenstrual cases are seen in patients with surgical or postpartum wound infections, with <strong>nasal and wound packing.</strong></p>\n<p>Clinical featires include include&nbsp;<strong>fever &gt;102 &deg;F,&nbsp;</strong>diffuse macular&nbsp;<strong>erythroderma</strong>&nbsp;with desquamation after 1-2 weeks,<strong>&nbsp;hypotension</strong>, and the&nbsp;<strong>involvement</strong>&nbsp;of&nbsp;<strong>multiple organ systems(</strong>liver, kidneys, gastrointestinal tract, and/or CNS)<strong>.&nbsp;</strong></p>\n<p>The T-cell activation which produces the cytokine storm in TSS can be seen in the image below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ab3afbf5e24f426f9224b099766e29e5x1279x1284.JPEG"
    ]
  },
  {
    "text": "The following image depicts:",
    "choices": [
      {
        "id": 1,
        "text": "Production of monoclonal antibodies"
      },
      {
        "id": 2,
        "text": "Cell lines for viral culture"
      },
      {
        "id": 3,
        "text": "Vaccine synthesis"
      },
      {
        "id": 4,
        "text": "Process of genetic engineering"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image depicts the production of <strong>monoclonal antibodies</strong> by<strong> hybridoma technology</strong>.</p>\n<p>The following are the <strong>steps</strong> involved in hybridoma technology:</p>\n<ul>\n<li><strong>Mice</strong> are <strong>immunized</strong> with an antigen. After several weeks of immunization, blood samples are obtained from mice for measurement of serum antibodies.</li>\n<li>When the antibody titer is high enough, mice are commonly boosted by injecting antigen without adjuvant intraperitoneally or intravenously. Then the mice are euthanized and their <strong>spleens removed</strong> for in vitro hybridoma cell production.</li>\n<li><strong>Fusing antibody-producing spleen cells</strong>, which have a limited life span <strong>with myeloma cells</strong> (derived from an immortal tumor of lymphocytes) results in a hybridoma that is capable of unlimited growth.</li>\n<li>The cells are <strong>cultured in</strong> a medium containing hypoxanthine, aminopterin, and thymidine <strong>(HAT medium)</strong>&nbsp;which allows only the fused cells to survive in culture.</li>\n<li><strong>Monoclonal antibodies</strong> are then <strong>harvested.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2bbc1d4caa89434a83e05473df77a3c7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/58ad7b35fb474d5da75002501c78702fx1280x2037.JPEG"
    ]
  }
];
        let quizName = 'Microbiology Test';
        const quizFilename = 'microbiology-test-28a61b8c.html';
        let hierarchy = ["Marrow", "FMGE Test Series Subject", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>