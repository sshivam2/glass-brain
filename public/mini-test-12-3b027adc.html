<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 12 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 58-year-old male patient was posted for elective appendicectomy. He has a history of myocardial infarction and his echocardiography revealed a reduced ejection fraction.  Which of the following induction agents is most appropriate for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Ketamine"
      },
      {
        "id": 2,
        "text": "Etomidate"
      },
      {
        "id": 3,
        "text": "Propofol"
      },
      {
        "id": 4,
        "text": "Thiopentone"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the above clinical scenario with a history of myocardial infarction and reduced ejection fraction,&nbsp;<strong>etomidate</strong>&nbsp;is considered the most appropriate induction agent.</p>\n<p><strong>Etomidate</strong> is a rapid onset, intravenous anesthetic agent used for induction in patients with <strong>cardiovascular disease, reactive airway disease</strong>, and <strong>intracranial hypertension</strong>. Etomidate&nbsp;has minimal effect on cardiovascular function due to its lack of effect on the sympathetic nervous system and on the function of the baroreceptors. They act on alpha 2 adrenoreceptors and increase blood pressure which helps to<strong>&nbsp;maintain cardiovascular stability</strong>&nbsp;after the induction.&nbsp;</p>\n<p>It is used as a<strong>&nbsp;short-term sedative</strong>&nbsp;in hemodynamically unstable patients, like those requiring cardioversion or patients with unstable angina, for minor operative procedures.&nbsp;<strong>Long-term use</strong>&nbsp;of etomidate in trauma or terminally ill patients is not advised as there is associated&nbsp;<strong>adrenocortical suppression&nbsp;</strong>leading to reduced blood pressure.</p>\n<p>Other options:</p>\n<p>Option A-&nbsp;<strong>Ketamine</strong>&nbsp;has a&nbsp;stimulatory effect on the sympathetic nervous system&nbsp;and results in increased blood pressure, heart rate, and cardiac output. This leads to an<strong>&nbsp;increase in myocardial oxygen consumption</strong>&nbsp;and so it is <strong>contraindicated in ischemic heart disease</strong>.</p>\n<p>Option C-<strong>&nbsp;Propofol</strong>&nbsp;is a&nbsp;<strong>myocardial depressant agent</strong>. It&nbsp;reduces sympathetic activity, leading to vasodilatation that results in a reduction of blood pressure and a decrease in cardiac output.</p>\n<p>Option D-&nbsp;<strong>Thiopentone</strong>&nbsp;is also a&nbsp;<strong>myocardial depressant </strong>agent. It causes peripheral vasodilatation, reduction in ventricular filling, and decreased cardiac contractility. This results in a reduction in blood pressure and a decrease in cardiac output.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A  post-cataract surgery patient came with complaints of blurring of vision for the past 2 weeks. His cataract surgery was done 3 months back. His optical coherence tomography (OCT) image is given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cystoid macular edema"
      },
      {
        "id": 2,
        "text": "Macular hole"
      },
      {
        "id": 3,
        "text": "Central serous retinopathy"
      },
      {
        "id": 4,
        "text": "Senile macular degeneration"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario of a\u00a0<strong>post-cataract surgery</strong> patient presenting with a blurring of vision and an\u00a0OCT image showing <strong>intraretinal cystoid spaces</strong>\u00a0is suggestive of\u00a0<strong>cystoid macular edema</strong> (CME).</p>\n<p>Common causes of CME include previous <strong>cataract surgery</strong>, uveitis, central retinal vein occlusions, <strong>diabetic retinopathy</strong>, retinitis pigmentosa, and retinopathy of prematurity, and topical <strong>prostaglandins</strong>. Cystoid macular edema in post-cataract surgery patients is termed as <strong>Irvine-Gass</strong> syndrome.\u00a0</p>\n<p>In CME, OCT shows foveal depression, <strong>intraretinal cystoid spaces</strong>, and retinal thickening.</p>\n<p>CME occurs due to a break in the <strong>inner and outer blood-retinal barrier</strong>. Due to retinal vessel leak fluid or exudate comes out and forms cystic space in the central retina. Mostly it gets <strong>accumulated</strong> in the <strong>outer plexiform</strong> (Henle's layer) and <strong>inner nuclear layers</strong> of the retina.\u00a0</p>\n<p>On fundoscopy, the multiple cystoid oval spaces in CME appear as a\u00a0 <strong>\"honeycomb appearance\"</strong>.</p>\n<p>In Fundus fluorescein angiography fluid accumulation in outer plexiform, layer shows a characteristic\u00a0<strong>flower petal pattern</strong> (<strong>petaloid appearance</strong>) as shown below:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/29c7e52da981464eba28abdeb9fc0f9f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/75f339fe6bc94e2eb96be8fd4804c332x204x136.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/07394bd891a14ccc920a99f2a2b06eb9x338x106.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1abc1b9b97c648928ab85cd932d22189x800x502.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6eb066eba435403f93d482edd84137b8x259x157.PNG"
    ]
  },
  {
    "text": "A 2-year-old child was brought with complaints of regression of milestones and repeated wringing hand movements. On examination, there is microcephaly and a characteristic mousy odor in skin and urine. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hawkinsinuria"
      },
      {
        "id": 2,
        "text": "Phenylketonuria"
      },
      {
        "id": 3,
        "text": "Alkaptonuria"
      },
      {
        "id": 4,
        "text": "Tyrosinemia type 1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario of a child presenting with <strong>regression of development</strong>, repetitive stereotypic behavior,<strong> microcephaly</strong>, and typical<strong> mousy</strong> <strong>odor</strong> in skin and urine is suggestive of\u00a0<strong>p</strong><strong>henylketonuria\u00a0</strong>(PKU).</p>\n<p><strong>Phenylketonuria </strong>is an inborn error of metabolism, due to the deficiency of an enzyme\u00a0<strong>phenylalanine hydroxylase </strong>or its cofactor <strong>tetrahydrobiopterin</strong>.\u00a0The deficiency of this enzyme leads to the accumulation of phenylalanine in the body fluids and the brain.</p>\n<p>The\u00a0excess phenylalanine in the blood is metabolized to phenyl ketones, namely,\u00a0<strong>phenylpyruvate</strong>\u00a0and\u00a0<strong>phenylacetate</strong>, which are excreted in the urine and are termed phenylketonuria.\u00a0<strong>Phenylacetate</strong>\u00a0gives rise to the characteristic\u00a0<strong>mousy odor\u00a0</strong>in the skin and urine in PKU.</p>\n<p>Infants appear normal at birth. They gradually develop an <strong>intellectual disability</strong>, and hyperactivity with <strong>autistic behavior</strong> as age progress.\u00a0</p>\n<p>Other characteristic clinical findings are:</p>\n<ul>\n<li>Seizures</li>\n<li>Tremor</li>\n<li><strong>Microcephaly</strong></li>\n<li>Deficiency of pigmentation</li>\n</ul>\n<p><strong>Tandem mass spectroscopy\u00a0</strong>is the screening method of choice. A <strong>low phenylalanine diet</strong> is the mainstay of treatment and keeping serum phenylalanine <strong>under 6 mg/dl</strong>.</p>\n<p>Other options:</p>\n<p>Option A- <strong>Alkaptonuria</strong> is an inborn error of metabolism due to the deficiency of an enzyme<strong> homogentisate 1,2 dioxygenase</strong>, leading to the accumulation of <strong>homogentisic acid</strong> in connective tissue resulting in ochronosis. Due to the oxidation and polymerization of homogenetic acid, it shows a characteristic <strong>blackening of urine</strong> on standing for a long time or black stain in diapers. They often present in the third to the fourth decade of life.\u00a0</p>\n<p>Option C-\u00a0<strong>Hawkinsinuria\u00a0</strong>is an\u00a0<strong>autosomal-dominant</strong>\u00a0condition due to deficiency of an enzyme <strong>4-hydroxyphenylpyruvate dioxygenase</strong> which\u00a0catalyzes the reaction of 4-hydroxyphenylpyruvate to homogentisic acid in the tyrosine catabolism pathway. It leads to the accumulation of the metabolite hawkinsin. Most of the patients present during the weaning period with features of persistent metabolic acidosis and failure to thrive. The <strong>swimming pool odor\u00a0</strong>of the urine is characteristic of this condition.</p>\n<p>Option D- <strong>Tyrosinemia type 1\u00a0</strong>is an inborn error of metabolism due\u00a0to deficiency of the enzyme <strong>fumarylacetoacetase</strong>. Most of the patients present at early infancy with symptoms suggestive of liver and renal dysfunction. The <strong>b</strong><strong>oiled cabbage odor\u00a0</strong>of the urine is characteristic of this condition.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 58-year-old woman presents with complaints of right-sided facial weakness, tinnitus, dysphagia for 2 weeks, and progressive hearing loss for 2 years. A glomus tumor was suspected in this patient. Which of the following investigations will not be done for the above situation?",
    "choices": [
      {
        "id": 1,
        "text": "Contrast-enhanced CT scan"
      },
      {
        "id": 2,
        "text": "Biopsy for histopathology"
      },
      {
        "id": 3,
        "text": "Urine vanillylmandelic acid"
      },
      {
        "id": 4,
        "text": "Four-vessel angiography"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In a clinical suspicion of a&nbsp;<strong>glomus tumor</strong>, a <strong>biopsy</strong> for histopathology is <strong>contraindicated</strong>.</p>\n<p>Glomus tumor is an&nbsp;<strong>extremely vascular&nbsp;</strong>benign tumor. A preoperative biopsy is<strong> never done</strong> in glomus tumors as they<strong> bleed profusely</strong>, and there is an increased risk of&nbsp;<strong>injury</strong> to&nbsp;the high <strong>jugular bulb</strong> or <strong>aberrant internal carotid artery</strong>.</p>\n<p>Glomus tumor is the most common <strong>benign neoplasm</strong> of the middle ear. It originates from the glomus bodies and consists of paraganglionic cells from the neural crest.&nbsp;It is a nonencapsulated <strong>tumor</strong> and a locally invasive tumor.&nbsp;</p>\n<p>Glomus tumor is most often seen in <strong>women</strong> in the fourth to fifth decade of life.</p>\n<p>A patient typically presents with progressive<strong> conductive hearing loss</strong>, pulsatile<strong> tinnitus</strong>, dizziness, and <strong>facial paralysis</strong>. If the tumor presents as a polyp, a history of spontaneous bleeding from the ear is seen.&nbsp;</p>\n<p>Otoscopy examination shows a red reflex through an intact tympanic membrane as a&nbsp;<strong>\"rising sun\"</strong>&nbsp;appearance since the tumor arises from the floor of the middle ear as shown below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2baa583e064545e3b1fea54e496fd6abx605x600.JPEG"
    ]
  },
  {
    "text": "You were posted for an autopsy of a 34-year-old man who was under police custody for interrogation. On external examination, signs of third-degree torture were present. Which of the following incisions is preferred to detect and evaluate the hidden subcutaneous hemorrhage?",
    "choices": [
      {
        "id": 1,
        "text": "I-shaped incision"
      },
      {
        "id": 2,
        "text": "Elongated X-shaped incision"
      },
      {
        "id": 3,
        "text": "Y-shaped incision"
      },
      {
        "id": 4,
        "text": "Modified Y-shaped incision"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario is suggestive of <strong>custodial death</strong>. The incision that is preferred to detect and evaluate the hidden subcutaneous hemorrhage is the\u00a0<strong>elongated</strong> <strong>X- shaped incision</strong>.</p>\n<p>An elongated X-shaped incision is used to dissect subcutaneous structures in the back of the body. It helps identify and evaluate the extent of blunt injuries when superficial imprints are faint. This type of incision is<strong> helpful in the reconstruction of events before death</strong> and is practiced in custodial death.</p>\n<p>The image below shows the 'elongated X- shaped' incision:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f5bc395419e40af8753df2c750a35c7x1280x1462.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b7b26098f0064c0590284a9545abcbfex1280x1462.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cfc9e2e763bb4e7ea5ced99a453f11e0x1280x1461.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dd81a7022bde4e56861d1baa3ea0b99fx1280x1461.JPEG"
    ]
  },
  {
    "text": "A 38-year-old patient presents with a severe left-sided excruciating headache for the past 30 minutes. He has experienced similar headaches every day at the same time for one week and these episodes last for an hour. Most episodes are accompanied by rhinorrhea. There are no cutaneous triggers. It does not respond to indomethacin and is triggered by alcohol. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Migrainous neuralgia"
      },
      {
        "id": 2,
        "text": "Paroxysmal hemicrania"
      },
      {
        "id": 3,
        "text": "SUNCT"
      },
      {
        "id": 4,
        "text": "Tension type headache"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above clinical scenario is suggestive of <strong>migrainous neuralgia</strong> or <strong>cluster headache</strong>.&nbsp;</p>\n<p>A <strong>male</strong> patient presenting with <strong>recurrent excruciating pain</strong> for 30 minutes, presence of <strong>autonomic features</strong>, aggravating on <strong>alcohol</strong> consumption,<strong> no cutaneous triggers</strong>, and <strong>no effect</strong> on <strong>indomethacin</strong> are points in favor of cluster headache. The typical cluster headache patient has <strong>daily one or two</strong> attacks of <strong>shorter</strong> duration <strong>unilateral</strong> pain for 8- 10 weeks per year. Cluster headaches are predominantly seen in males.&nbsp;Cluster headache is associated with autonomic features like conjunctival injection, lacrimation, and<strong> rhinorrhea</strong>.&nbsp;</p>\n<p>Cluster headache is a rare type of <strong>trigeminal autonomic cephalalgia</strong>. Usually present with excruciating, <strong>non-fluctuating</strong>, <strong>retro-orbital pain</strong>.</p>\n<p><strong>Periodicity</strong> is the characteristic feature of cluster headaches. Usually, one of the daily attacks of pain recurs at about the same time each day.&nbsp;They last for a few weeks followed by a remission for months to years.&nbsp;</p>\n<p>Patients are usually <strong>agitated</strong>&nbsp;or aggressive during attacks. This is in contrast with migraine patients who remain motionless during the attack.&nbsp;</p>\n<p>Acute attacks are managed by <strong>100% oxygen</strong> at <strong>10 - 12 L/min</strong> for 15 -20 minutes. Subcutaneous <strong>sumatriptan</strong> 6mg has a rapid onset and will shorten the attack. <strong>Verapamil</strong> is used as a first-line treatment for prophylaxis.</p>\n<p>Other options:</p>\n<p>Option B:&nbsp;<strong>Paroxysmal hemicrania</strong> is a type of trigeminal autonomic cephalalgia. They usually present as unilateral, frequent, excruciating short-lasting episodes of headache. They are <strong>completely relieved</strong> by <strong>indomethacin</strong>.&nbsp;</p>\n<p>Option C:&nbsp;<strong>SUNCT</strong>&nbsp;is a type of trigeminal autonomic cephalalgia. They usually present as unilateral, severe, throbbing pain in the temporal or orbital region. They are always associated with <strong>cutaneous</strong> <strong>triggers</strong>.&nbsp;</p>\n<p>Option D:&nbsp;<strong>Tension headache</strong> is a <strong>chronic headache</strong> with the characteristic of a<strong> bilateral</strong> tight <strong>band-like</strong> discomfort.&nbsp;&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-day old male neonate who has not yet passed meconium developed abdominal distension. There is no history of fever. On rectal examination, forceful expulsion of stool was observed. A barium enema is performed and the findings are shown in the image below. Which of the following is the gold standard for the diagnosis of the above condition?",
    "choices": [
      {
        "id": 1,
        "text": "Ultrasonography"
      },
      {
        "id": 2,
        "text": "Barium enema"
      },
      {
        "id": 3,
        "text": "Rectal biopsy"
      },
      {
        "id": 4,
        "text": "Anorectal manometry"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of a <strong>male newborn</strong>\u00a0presenting with <strong>failure to pass meconium</strong>, abdominal distension, <strong>forceful\u00a0expulsion of stools</strong> on rectal examination, and barium enema showing\u00a0<strong>dilated right colon</strong> with a <strong>transition zone</strong> in the <strong>mid descending colon</strong> is suggestive of\u00a0<strong>Hirschsprung's disease</strong>. The gold standard for the diagnosis of Hirschprung's disease is a <strong>rectal biopsy</strong>.</p>\n<p>In Hirschprung's disease, the rectal biopsy shows <strong>absent ganglia</strong>, <strong>hypertrophied nerve</strong> trunks, and positive <strong>immunostaining</strong> for <strong>acetylcholinesterase.</strong></p>\n<p>Hirschprung's disease is caused by malformation of the pelvic parasympathetic system that results in the<strong> absence of ganglion cells</strong> in the <strong>Auerbach</strong> and <strong>Meissner</strong> plexus. This causes muscular spasms of the distal colon and internal anal sphincter resulting in their functional obstruction.\u00a0</p>\n<p>They are <strong>predominantly</strong> seen in<strong> boys</strong> and are often associated with <strong>Down syndrome</strong>. Most cases present during the neonatal period as abdominal distension, <strong>bilious vomiting</strong>, and <strong>failure to pass meconium</strong>. Beyond this period, they mainly present with poor feeding, abdominal distension, and <strong>severe constipation</strong>. Forceful expulsion of stools is observed on rectal examination as the stools were accumulated in the distal colon.</p>\n<p>A <strong>barium enema</strong> is obtained on all suspected cases of Hirschprung's disease. This demonstrates the location of the transition zone between the dilated ganglionic colon and the distal aganglionic rectal segment.\u00a0</p>\n<p>In<strong> older children</strong>, <strong>anorectal manometry</strong> shows a <strong>high internal sphincter pressure</strong> when the lumen of the rectum is distended with a balloon. This is due to the<strong> absence of normal inhibitory reflex</strong> in Hirschsprung's disease. But due to relative inaccuracy of findings, this test is<strong> not commonly done</strong>.\u00a0</p>\n<p><strong>Ultrasound findings</strong> may also suggest the diagnosis but it is <strong>not sensitive</strong> enough to exclude\u00a0Hirschsprung's disease.</p>\n<p>The three definitive surgical procedures are<strong>\u00a0</strong>the <strong>Swenson</strong> procedure, <strong>Duhamel</strong> procedure, and <strong>Soave's</strong> procedure.</p>\n<p>The most common cause of death in uncorrected Hirschprung's disease is <strong>enterocolitis</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2d6b13aa589c48f893c1d6263ee2d8ac.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/76994677bcc644eaa07eaf10dc146815x1280x1573.JPEG"
    ]
  },
  {
    "text": "A 45-year-old man presents to the OPD with complaints of fever with chills, headache, abdominal pain, and diarrhea. He gives a history of consuming stale food the previous day. Organism isolated on stool culture showed tumbling motility at 25\u00b0C and was non-motile at 37\u00b0C. Which among the following is the selective media for the above causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "PLET medium"
      },
      {
        "id": 2,
        "text": "PPLO broth"
      },
      {
        "id": 3,
        "text": "PALCAM agar"
      },
      {
        "id": 4,
        "text": "Cary Blair medium"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of an adult with symptoms of gastroenteritis, history of consumption of<strong>\u00a0stale food</strong>, organism showing <strong>tumbling motility at\u00a025\u00b0C</strong> is suggestive of\u00a0<strong>food poisoning</strong>\u00a0caused by<strong>\u00a0<em>Listeria monocytogenes.\u00a0</em></strong>The selective media for\u00a0<em>Listeria monocytogenes\u00a0</em>is <strong>PALCAM agar</strong>.</p>\n<p>The PALCAM agar is used to isolate\u00a0<em>Listeria monocytogenes.\u00a0</em>They show a\u00a0grey-green with a black sunken center and a black halo on a cherry-red background. Stool culture is done in <strong>cold enrichment</strong> media.\u00a0</p>\n<p><em>Listeria monocytogenes\u00a0</em>is a <strong>gram-positive</strong>\u00a0bacillus. It shows characteristic <strong>tumbling motility at 25\u00b0C</strong>\u00a0and becomes non-motile at 37\u00b0C.\u00a0The image below shows the tumbling motility of\u00a0<em>Listeria.</em></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/de6917ce863642d3b4473d5204216f41x720x734.GIF"
    ]
  },
  {
    "text": "The neonatology intern on ward duty noticed that a newborn's mother was unimmunized during pregnancy. What is the dose of antitoxin to be administered to this newborn for the prevention of neonatal tetanus?",
    "choices": [
      {
        "id": 1,
        "text": "1000 IU"
      },
      {
        "id": 2,
        "text": "750 IU"
      },
      {
        "id": 3,
        "text": "500 IU"
      },
      {
        "id": 4,
        "text": "250 IU"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>750 IU</strong> of antitoxin is administered to this newborn for the prevention of neonatal tetanus.</p>\n<p>The infants born to mothers who have not received the 2 doses of tetanus toxoid during pregnancy have a risk of developing neonatal tetanus. They can be protected from this by administering <strong>750 IU</strong> of antitoxin <strong>within 6 hours</strong> of birth.</p>\n<p>In <strong>unimmunized pregnant</strong> women, two doses of tetanus toxoid are administered. First dose as early as possible and the second dose one month later. The second dose should be administered at least 3 weeks before delivery.</p>\n<p>In <strong>previously immunized</strong> pregnant women, <strong>a booster dose</strong> is sufficient. Tetanus toxoid protects both mother and child from tetanus.</p>\n<p>Tetanus is an acute disease caused by the <strong>exotoxin</strong> of&nbsp;<em><strong>Clostridium tetani</strong>.</em> It is characterized by muscular rigidity and paroxysmal spasms of voluntary muscles<em>.&nbsp;</em></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true regarding the procedure shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Can be used in fetus with gestational age less than 34 weeks"
      },
      {
        "id": 2,
        "text": "Can be used in cases of fetal coagulopathy"
      },
      {
        "id": 3,
        "text": "Can be used for both vertex and face presentations"
      },
      {
        "id": 4,
        "text": "Flexion point is 3 cm in front of posterior fontanelle"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above image shows a\u00a0<strong>vacuum-assisted delivery</strong>. The <strong>flexion point</strong> is about\u00a0<strong>3 cm</strong> in front of the <strong>posterior</strong>\u00a0fontanelle.\u00a0</p>\n<p>A<strong> vacuum extractor</strong>\u00a0is an instrument used in operative vaginal delivery by creating a vacuum between it and the fetal scalp. During\u00a0vacuum-assisted delivery, the\u00a0suction cup is placed on the fetal head at a point <strong>near the occiput</strong>, called the <strong>flexion point</strong>. A flexion point is an imaginary point on the <strong>sagittal suture</strong>, located about\u00a0<strong> 6 cm from </strong>the<strong> center of the anterior fontanel </strong>or about<strong> 3 cm in front of the posterior fontanelle</strong>. The flexion point is closer to the posterior fontanelle.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2c4bbea399024729baf8d8ecd2987122.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0e74011d405243858a7c2ff034b50419x1280x1312.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/12e4d581536e4145b39ba32f34d917c4x800x600.JPEG"
    ]
  },
  {
    "text": "Which of the following prostaglandin analog can be used in the treatment of pulmonary arterial hypertension?",
    "choices": [
      {
        "id": 1,
        "text": "Iloprost"
      },
      {
        "id": 2,
        "text": "Alprostadil"
      },
      {
        "id": 3,
        "text": "Dinoprostone"
      },
      {
        "id": 4,
        "text": "Travoprost"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Iloprost\u00a0</strong>can be used in the treatment of pulmonary arterial hypertension.\u00a0</p>\n<p>Iloprost is a <strong>prostaglandin I2</strong> (prostacyclin) analog. It is available in both\u00a0<strong>inhaled</strong>\u00a0and intravenous formulations. The inhaled formulation has a <strong>potent vasodilative</strong> action on the pulmonary circulation with less systemic vasodilation than other intravenous prostacyclins.</p>\n<p>Other prostacyclin analogs used for pulmonary arterial hypertension are <strong>epoprostenol</strong> and <strong>treprostinil</strong>.</p>\n<p>Other options:</p>\n<p>Option B-\u00a0<strong>Alprostadil (Prostaglandin E1)</strong> is used as a second-line drug for the <strong>treatment of erectile dysfunction</strong>. It can be given as an <strong>intracavernous</strong> injection or urethral suppository.</p>\n<p>Option C-\u00a0<strong>Dinoprostone (PGE2)</strong> is used for cervical ripening and induction of labor.</p>\n<p>Option D-\u00a0<strong>Travoprost (PGF2alpha)</strong> is used for treating glaucoma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A specimen of the posterior surface of the larynx is kept in an anatomy practical exam and a structure is marked with red. What would be the action of the structure?",
    "choices": [
      {
        "id": 1,
        "text": "Adducts the vocal cords"
      },
      {
        "id": 2,
        "text": "Abducts the vocal cords"
      },
      {
        "id": 3,
        "text": "Tenses the vocal cords"
      },
      {
        "id": 4,
        "text": "Relaxes the vocal cords"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows the posterior view of the larynx and the marked muscle is\u00a0the <strong>posterior cricoarytenoid</strong>.\u00a0Its action is to <strong>abduct the vocal cords</strong> and <strong>open</strong> the glottis. The <strong>posterior cricoarytenoid muscle </strong>is identified by<strong>\u00a0</strong>its origin from the <strong>posterior surface</strong> of the cricoid<strong>.</strong>\u00a0</p>\n<p>The posterior cricoarytenoid muscle <strong>arises </strong>from the <strong>posterior surface of the cricoid lamina</strong> and is attached to the upper and posterior surfaces of the muscular processes of the ipsilateral arytenoids. It is innervated by a branch of the<strong> recurrent laryngeal nerve</strong>. They are <strong>active </strong>in the production of <strong>unvoiced sounds.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1380fc7835bf489bbc7a7a2c9ffe51f3.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/648d8cf164504713b8fb9a45b04b96b1x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/887d5473925944c8b2515b313b2a572cx363x500.PNG"
    ]
  },
  {
    "text": "A 48-year-old employee presented to the ESI hospital with resting tremors, slowness of movements, depression, dementia, and a shuffling, short-stepping gait. He has been working in the same factory for the past 11 years and his monthly income is Rs 20,000. Which of the following is incorrect regarding the benefits he can avail of under the ESI Act?",
    "choices": [
      {
        "id": 1,
        "text": "Outpatient care by a specialist and supply of drugs free of cost"
      },
      {
        "id": 2,
        "text": "An extended sickness benefit for 3 years."
      },
      {
        "id": 3,
        "text": "Inpatient care by a specialist and supply of drugs free of cost"
      },
      {
        "id": 4,
        "text": "Domiciliary services free of cost"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of a patient with <strong>Parkinson's disease</strong>. He can avail of the <strong>extended sickness benefit, </strong>which is payable only for <strong>2 years</strong> (not 3 years) under the <strong>ESI Act</strong>.\u00a0</p>\n<p><strong>ESI act</strong> covers all employees getting income up to Rs.21,000/- per month. Employer contributes 3.25% of the total wage bill. An employee contributes 0.75% of wages. State and Central governments share medical expenditure in the ratio of 1:7.</p>\n<p><strong>Extended sickness benefit</strong>\u00a0is payable for<strong> 2 years</strong> for a set of 34 diseases such as TB, leprosy, malignant diseases, diabetes, <strong>Parkinson's</strong>, myasthenia gravis, glaucoma, coronary artery disease, etc.</p>\n<p>Few important points to be known about the ESI Act:</p>\n<p><strong>Medical benefit</strong> comprises complete medical care\u00a0including hospitalization, <strong>free of cost</strong> which includes:</p>\n<ul>\n<li><strong>Out-patient care</strong></li>\n<li><strong>Supply of drugs</strong> and dressings</li>\n<li><strong>Specialist services</strong> in all branches of medicine</li>\n<li>Pathological and radiological investigations</li>\n<li><strong>Domiciliary services</strong></li>\n<li>Antenatal, natal, and postnatal services</li>\n<li>Immunization services</li>\n<li>Family planning services</li>\n<li>Emergency services</li>\n<li>Ambulance services</li>\n<li>Health-education</li>\n<li><strong>In-patient treatment.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The sequence of the non-template strand in a DNA fragment is TAAAGC. The mRNA that will be transcribed from the anti-sense strand will have the following sequence______",
    "choices": [
      {
        "id": 1,
        "text": "CGGGAT"
      },
      {
        "id": 2,
        "text": "TAAAGC"
      },
      {
        "id": 3,
        "text": "UAAAGC"
      },
      {
        "id": 4,
        "text": "ATTTCG"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>UAAAGC </strong>will be\u00a0the sequence of<strong>\u00a0mRNA</strong> produced from this fragment of DNA (the non-template strand, which is TAAAGC), while the template strand will have a complementary sequence of ATTTCG.</p>\n<p>The non-template strand or, coding strand, or sense/plus strand in the DNA, will have the <strong>same sequence</strong> of the RNA that is produced, except that the non-template or coding strand has <strong>T in place of U.\u00a0</strong></p>\n<p>As all sequences are written in the 5\u2032 to 3\u2032 direction, unless otherwise specified, an RNA sequence of <strong>UAAAGC</strong> would correspond to a DNA sequence on the non-template strand of <strong>TAAAGC</strong>.</p>\n<p>Both the non-template strand and RNA produced will be a <strong>complementary</strong> sequence <strong>to the template</strong> strand. Therefore, the<strong> template strand</strong> would be\u00a0<strong>ATTTCG</strong> (written 5\u2032 to 3\u2032).</p>\n<p>Note:</p>\n<p>Template strand - known as minus or, antisense or non-coding strand.</p>\n<p>Coding strand- known as plus or, sense or non-template strand.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/598ee4cb536d4c9db7a16ca8b1f96a6fx799x389.JPEG"
    ]
  },
  {
    "text": "A 30-year-old female patient came to dermatology OPD with the clinical features shown in the image below. The likely diagnosis is ______.",
    "choices": [
      {
        "id": 1,
        "text": "Nevus of Ito"
      },
      {
        "id": 2,
        "text": "Compound nevus"
      },
      {
        "id": 3,
        "text": "Nevus of Ota"
      },
      {
        "id": 4,
        "text": "Hypomelanosis of Ito"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows bluish patchy skin lesions on the <strong>face</strong> in the region of the first and second branches of the <strong>trigeminal nerve</strong> and <strong>sclera</strong> which are suggestive of <strong>nevus of Ota</strong>.</p>\n<p>Nevus of Ota&nbsp;is an extensive, bluish, patchy, dermal melanocytosis. A large number of <strong>elongated dendritic melanocytes</strong> can be seen scattered among collagen bundles mainly of the superficial dermis.</p>\n<p>It affects the<strong> sclera </strong>and the <strong>skin adjacent</strong> to the<strong> eye</strong>. Distributed along with the <strong>first and the second branches of the trigeminal nerve</strong>.</p>\n<p>Most lesions are present at birth or develop during the first year of life, increasing in size and number in subsequent years. Lesions are more common in females and in Asians.</p>\n<p><strong>Q\u2010switched laser</strong> systems are the first-line treatment, as they achieve higher rates of pigment clearing.</p>\n<p>Other options:</p>\n<p>Option A-<strong>&nbsp;Nevus of Ito</strong> appears as a&nbsp; unilateral,<strong> blue\u2010greyish macular discoloration</strong> location in the area innervated by the<strong> posterior supraclavicular</strong> and<strong> lateral cutaneous brachial nerves- acromioclavicular region.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b8d232f1f06f4b5fbbc0d95f43e049c5.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4854e9b966f245018ac96a650424baaax1279x1170.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0b6a5fe3ee9d4364bbb0f9377a9fa176x1280x1369.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2c168af795624ad29bf03e76bfe43014x1279x1734.JPEG"
    ]
  },
  {
    "text": "A car driver hit his right knee on the dashboard on the sudden application of the brake during a motor vehicle collision. He complains of pain and swelling in the right knee. On examination, there is an excessive backward movement of the tibia in relation to the femur on gently pulling the upper end of the tibia. However, the forward movement of the tibia in relation to the femur appears normal. What is the structure most likely to be injured?",
    "choices": [
      {
        "id": 1,
        "text": "Both anterior and posterior cruciate ligaments"
      },
      {
        "id": 2,
        "text": "Meniscus"
      },
      {
        "id": 3,
        "text": "Anterior cruciate ligament"
      },
      {
        "id": 4,
        "text": "Posterior cruciate ligament"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical scenario of a direct anterior blow to the knees such as\u00a0<strong>dashboard injury</strong> and <strong>excessive backward movement </strong>in the<strong> posterior drawer test</strong> is suggestive of <strong>posterior cruciate ligament (PCL) injury</strong>.</p>\n<p>The initial symptoms are very similar to an ACL (anterior cruciate ligament) injury like the immediate swelling. On performing the<strong> posterior drawer test,</strong> there would be excessive backward movement of the tibia in relation to the femur. The majority of patients with an isolated PCL injury will return to a high level of function with just appropriate <strong>quadriceps rehabilitation</strong>, without the need for\u00a0surgical intervention.</p>\n<p>On performing the <strong>anterior drawer test</strong>, the normal forward gliding movement of the tibia in relation to femoral condyles is suggestive of apparently normal <strong>anterior cruciate ligaments</strong>.\u00a0</p>\n<p>Dashboard injury can also lead to</p>\n<ul>\n<li>Posterior hip dislocation</li>\n<li>Acetabular fracture</li>\n<li>Patellar fracture</li>\n<li>Fracture of neck of the femur</li>\n<li>The shaft of femur fracture</li>\n<li>Posterior cruciate ligament injury</li>\n</ul>\n<p>The image below is an MRI of the knee joint, and the arrow shows the posterior cruciate ligament.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0ccff8268c3145a280736e17f900bbd5x604x600.JPEG"
    ]
  },
  {
    "text": "A 33-year-old female patient presented with a 2-cm thyroid nodule. The results of thyroid function tests are within normal limits. FNAC of the nodule was done, and the findings are shown in the given image. Identify the incorrect statement regarding this condition.",
    "choices": [
      {
        "id": 1,
        "text": "Prognosis is generally poor."
      },
      {
        "id": 2,
        "text": "Lymphatic metastasis is common."
      },
      {
        "id": 3,
        "text": "BRAF mutation is commonly seen."
      },
      {
        "id": 4,
        "text": "Exposure to ionizing radiation is causative."
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above clinical scenario and histopathological slide showing epithelial cells with clear<strong> ground-glass</strong> or&nbsp;<strong>Orphan Annie&ndash;eye</strong>&nbsp;nuclei are suggestive of the diagnosis of&nbsp;<strong>papillary carcinoma of the thyroid</strong>.<strong>&nbsp;</strong>Papillary thyroid cancers usually have an <strong>excellent prognosis.</strong></p>\n<p>Papillary carcinoma thyroid has an excellent prognosis, with a 10-year survival rate of around 95%.&nbsp;The <strong>prognosis</strong> of&nbsp;papillary thyroid cancer is <strong>poor</strong> when <strong>age is more than 40 years, in the presence of extrathyroidal extension, and in the presence of distant metastases</strong>.</p>\n<p><strong>Papillary carcinoma thyroid&nbsp;</strong>(PTC) is the <strong>most common</strong> thyroid cancer. It is frequently associated with exposure to <strong>ionizing radiation.</strong>&nbsp;A gain-of-function mutation in&nbsp;<strong><em>BRAF</em>&nbsp;</strong>is <strong>commonly seen</strong> in papillary thyroid cancer. Translocations that result in gene fusions of <strong><em>RET</em> or <em>NTRK</em>&nbsp;</strong>are also seen in the PTC.&nbsp;</p>\n<p><strong>Metastasis</strong> usually occurs via the <strong>lymphatic route</strong>, but hematogenous metastasis is less common. <strong>PTCs appear</strong> as <strong>cold masses</strong> on <strong>thyroid scintigraphy.</strong></p>\n<p><strong>Microscopic</strong> features of papillary thyroid carcinoma:</p>\n<ul>\n<li>The carcinoma shows&nbsp;<strong>branching papillae</strong>&nbsp;with fibrovascular stalk covered with simple or stratified cuboidal epithelium.</li>\n<li>At high power, the nuclei appear optically clear or empty as the&nbsp;chromatin is dispersed. These <strong>empty-appearing nuclei</strong> are called&nbsp;<strong>Orphan Annie&ndash;eye nuclei.</strong></li>\n<li>Concentric calcified structures called&nbsp;<strong>psammoma</strong>&nbsp;<strong>bodies</strong>&nbsp;are usually seen.</li>\n<li>Foci of lymphatic invasion by the tumor are usually present.</li>\n</ul>\n<p>The presence of&nbsp;<strong>Orphan Annie-eye nuclei</strong>&nbsp;is&nbsp;<strong>diagnostic&nbsp;</strong>of<strong>&nbsp;papillary thyroid cancer</strong>, regardless of the presence of papillary architecture.</p>\n<p><strong>Variants</strong> of papillary carcinoma thyroid:</p>\n<ol>\n<li><strong>Tall cell variant</strong> - Occurs in <strong>older</strong> people. Tall columnar cells with eosinophilic cytoplasm. The <strong>presence</strong> of&nbsp;<strong><em>BRAF</em> mutations</strong> is&nbsp;<strong>diagnostic</strong> of this variant. They present with a&nbsp;<strong>higher rate&nbsp;</strong>of <strong>vascular invasion, extrathyroidal extension, </strong>and<strong> cervical and distant metastases</strong> than conventional PTC.</li>\n<li><strong>Diffuse sclerosing variant</strong> - Occurs in <strong>younger</strong> individuals. This variant <strong>lack <em>BRAF</em> mutations</strong>, but <strong>RET/PTC translocations</strong> are <strong>present.</strong> There is a prominent papillary growth pattern with nests of squamous metaplasia. There is extensive, <strong>diffuse fibrosis</strong> throughout the thyroid gland, associated with <strong>lymphocytic infiltrate</strong>, simulating Hashimoto thyroiditis.</li>\n<li><strong>Follicular variant</strong> - It has the <strong>characteristic nuclear features of papillary carcinoma</strong> and an almost <strong>totally follicular architecture.</strong> Contrasting to conventional PTC, this variant has a <strong>gain-of-function mutation of <em>RAS</em>.</strong></li>\n</ol>\n<p>The image below shows <strong>psammoma bodies</strong> in the papillary carcinoma thyroid. Inset shows a single concentrically calcified psammoma body.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/83847a2622e445508785c10e235ff597.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/240b726f92a24150860f498a3f9562e2x796x434.JPEG"
    ]
  },
  {
    "text": "Which of the following factors can decrease the secretion of growth hormone?",
    "choices": [
      {
        "id": 1,
        "text": "Exercise"
      },
      {
        "id": 2,
        "text": "Fasting"
      },
      {
        "id": 3,
        "text": "Deep sleep"
      },
      {
        "id": 4,
        "text": "Obesity"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Obesity</strong> can <strong>decrease</strong> the secretion of <strong>growth</strong> <strong>hormone</strong> due to<strong> free fatty acid suppression</strong> of growth hormone.</p>\n<p>Stimuli that affect growth hormone secretion in humans include,</p>\n<table style=\"width: 387.75px;\">\n<tbody>\n<tr>\n<td style=\"width: 143px;\"><strong>Stimuli that increase secretion</strong></td>\n<td style=\"width: 242.75px;\"><strong>Stimuli that decrease secretion</strong></td>\n</tr>\n<tr>\n<td style=\"width: 143px;\">\n<ul>\n<li><strong>Exercise</strong></li>\n<li><strong>Deep sleep</strong></li>\n<li><strong>Fasting/Hypoglycemia</strong></li>\n<li>Stressful stimuli (including various psychological stresses)</li>\n<li>Protein deficiency</li>\n<li>Ghrelin</li>\n<li>Estrogens and androgens</li>\n</ul>\n</td>\n<td style=\"width: 242.75px;\">\n<ul>\n<li>Glucose</li>\n<li>Aging</li>\n<li><strong>Obesity</strong></li>\n<li>FFA (free fatty acid)</li>\n<li>Somatostatin</li>\n<li>Growth hormone (exogenous)</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<p>The image given below depicts the fluctuations of secretion of <strong>growth hormone</strong> throughout the day.\u00a0</p>\n<ul>\n<li>Growth hormone is found at relatively <strong>low levels during the day</strong> <strong>unless</strong> specific <strong>triggers such as strenuous exercise are present</strong>.</li>\n<li><strong>During sleep, </strong>on the other hand<strong>, large pulsatile bursts of growth hormone</strong> secretion occur.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/86afb31d2a894732a3b398e50f363e44x720x560.JPEG"
    ]
  },
  {
    "text": "A male patient was diagnosed with schizophrenia for which he was treated with chlorpromazine and olanzapine for a month each. Despite treatment with two different antipsychotics, the symptoms still persist. Which drug is recommended to be used next in this scenario?",
    "choices": [
      {
        "id": 1,
        "text": "Chlorpromazine"
      },
      {
        "id": 2,
        "text": "Fluphenazine"
      },
      {
        "id": 3,
        "text": "Quetiapine"
      },
      {
        "id": 4,
        "text": "Clozapine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above clinical scenario with poor response to two antipsychotics is suggestive of&nbsp;<strong>resistant schizophrenia</strong>, and the<strong>&nbsp;</strong>drug that is recommended to be used next is <strong>clozapine</strong>.</p>\n<p>Treatment-resistant schizophrenia refers to the failure to respond to <strong>at least two trials</strong> of <strong>antipsychotics</strong> of adequate dose and duration. A 4-6 week of antipsychotic on an adequate dose is considered an adequate trial. If patients show even a mild amount of improvement during this period, it may be reasonable to wait before changing a medication, since patients may improve at a <strong>steady rate </strong>for<strong> 3 </strong>to<strong> 6 months</strong>.</p>\n<p>Clozapine, a <strong>second-generation antipsychotic </strong>(atypical antipsychotic)&nbsp;is used for patients who respond poorly to dopamine receptor antagonists (typical antipsychotic). It has mixed 5HT2A-D2 receptor antagonism. Other uses of clozapine are <strong>tardive dyskinesia</strong>, refractory mania, <strong>psychotic depression</strong>, and&nbsp;Huntington's disease.</p>\n<p>Adverse effects of clozapine include sedation,&nbsp;<strong>a</strong><strong>granulocytosis</strong>, weight gain, and postural hypotension. It is also associated with an increased risk of <strong>seizures</strong>.</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Chlorpromazine</strong> is a first-generation antipsychotic drug used in <strong>schizophrenia</strong> as a <strong>first-line</strong> agent.</p>\n<p>Option B:&nbsp;<strong>Fluphenazine</strong> is a first-generation antipsychotic drug. It is used in <strong>schizophrenia&nbsp;</strong>and acute mania.</p>\n<p>Option C:&nbsp;<strong>Quetiapine</strong> is a <strong>second</strong>-generation antipsychotic drug used in schizophrenia, acute mania, and bipolar depression.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While performing bone grafting, which of the following instruments would you use to elevate the periosteum?",
    "choices": [
      {
        "id": 1,
        "text": "A"
      },
      {
        "id": 2,
        "text": "B"
      },
      {
        "id": 3,
        "text": "C"
      },
      {
        "id": 4,
        "text": "D"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The instrument used in the elevation of the periosteum is a <strong>periosteal elevator</strong> shown in image A.</p>\n<p>It is used to elevate the periosteum, as nerves and vessels are generally on this plane, and once elevated there is a safer plane for surgery.</p>\n<p>Option B: The image shows a <strong>curette</strong> used for curetting a cavity in the bone or removing fibrous tissue from the ends of a fracture. It is used in the management of&nbsp;<strong>enchondroma, GCT, </strong>and<strong> osteomyelitis.</strong></p>\n<p>Option C: The image shows an <strong>osteotome.</strong> It has both sides beveled and&nbsp;is used for&nbsp;<strong>cutting bone </strong>in surgeries such as McMurray's osteotomy&nbsp;and corrective osteotomy.&nbsp;</p>\n<p>Option D: It shows a&nbsp;<strong>bone gouge</strong>, a concave-bladed chisel used for cutting round bone surfaces or making holes in the bone.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7529d1aa2f214acb843f250015797418.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test 12';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>