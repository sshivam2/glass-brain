<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrated Mini Test 5 - Biochemistry - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2024-25
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Several colonic polyps were incidentally detected on a screening colonoscopy in a 51-year-old male patient. He was further evaluated and diagnosed with MUTYH-associated polyposis (MAP). Which of the following defective DNA repair mechanisms is seen in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Mismatch repair"
      },
      {
        "id": 2,
        "text": "DNA Nucleotide Excision Repair"
      },
      {
        "id": 3,
        "text": "Non-homologous end joining"
      },
      {
        "id": 4,
        "text": "DNA base excision repair"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"page\" title=\"Page 494\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The DNA repair mechanism that is defective in\u00a0<strong>MUTYH Associated Polyposis</strong> (MAP) is <strong>DNA base excision repair</strong> (BER). Its function is to <strong>remove base uracil</strong> from the DNA.</p>\n<p>Base lesions spontaneously occur in the DNA by various mechanisms including deamination, oxidation, and alkylation. This damage causes the conversion of single bases in the DNA such as <strong>cytosine, adenine, and guanine</strong> bases to <strong>uracil, hypoxanthine, and xanthine</strong> respectively, thereby threatening the integrity of the DNA. This damage is corrected by base excision repair.\u00a0</p>\n<p>Base excision repair may occur in the <strong>nuclei</strong> as well as in the<strong> mitochondria.</strong> It includes the following major enzymatic steps-</p>\n<ul>\n<li><strong>DNA glycosylase</strong>- It recognizes the damaged base and removes it leaving an abasic site/ AP-site (apurinic/apyrimidinic site).\u00a0</li>\n<li><strong>AP\u00a0-endonucleases</strong> excise the basic sugar and cleave the DNA strand.\u00a0</li>\n<li><strong>DNA polymerase</strong>\u00a0\u03b2 (Pol \u03b2) add the appropriate nucleotides\u00a0</li>\n<li><strong>Ligase</strong> seals the strand and completes the repair.</li>\n</ul>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child presents with severe neurological symptoms,  polyneuropathy, retinitis pigmentosa, nerve deafness, and cerebellar ataxia. His symptoms regress with restricted dietary intake of phytanic acid. What can be the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Refsum's disease"
      },
      {
        "id": 2,
        "text": "Usher syndrome"
      },
      {
        "id": 3,
        "text": "Zellweger syndrome"
      },
      {
        "id": 4,
        "text": "Adrenoleukodystrophy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of <strong>Refsum&rsquo;s disease</strong> which occurs due to a defect in the <strong>alpha oxidation of fatty acids</strong>.</p>\n<p><strong>Refsum&rsquo;s disease:</strong> It is a neurologic disorder that results from the defect in alpha oxidation of phytanic acid in the peroxisome. The enzyme <strong>phytanoyl CoA oxidase(Alpha hydroxylase)</strong>&nbsp;is defective.&nbsp;Accumulation of phytanic acid will affect membrane function, protein prenylation, and gene expression.</p>\n<p>The patient presents with severe neurological symptoms, polyneuropathy, <strong>retinitis pigmentosa, nerve deafness,</strong> and <strong>cerebellar ataxia. </strong>Management includes <strong>restricted</strong> dietary <strong>intake</strong> of <strong>phytanic acid.</strong> Sources of phytanic acid such as dairy products, meat, and green leafy vegetables should be avoided.</p>\n<p>Other options:</p>\n<p><strong>Option B: Usher syndrome</strong> -&nbsp;Sensorineural deafness + Retinitis pigmentosa (but symptoms are not affected by restricting phytanic acid)</p>\n<p><strong>Option C: Zellweger Syndrome&nbsp; - </strong>also known as <strong>Cerebrohepatorenal syndrome&nbsp;</strong></p>\n<p>Caused by mutations in the&nbsp;<strong>PEX</strong> family of genes -also called&nbsp;<strong>peroxins&nbsp;</strong>involved in Peroxisome Biogenesis /Peroxisomal enzymes themselves&nbsp;<br />Biochemical findings<strong>&nbsp;</strong>:</p>\n<ul>\n<li style=\"list-style-type: none;\">\n<ul>\n<li>Accumulation of&nbsp;<strong>very-long-chain fatty acids</strong></li>\n<li>abnormalities of the synthesis of bile acids</li>\n<li>marked reduction of plasmalogens</li>\n</ul>\n</li>\n</ul>\n<p><strong>Option D: Adrenoleukodystrophy</strong> is an X-linked recessive disorder of <strong>&beta;-oxidation</strong> of fatty acids. There is an <strong>accumulation</strong> of very large chain fatty acids in the <strong>adrenal glands,</strong> the white matter of the <strong>brain,</strong> and the <strong>testes.</strong> It is a progressive disease that can lead to adrenal gland crisis, <strong>coma,</strong> and <strong>death.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old child presents with swelling of joints, a hoarse voice, and subcutaneous nodules. On examination, hepatosplenomegaly is seen. The child is diagnosed with Farber's disease. Which enzyme defect is responsible for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Beta-galactosidase"
      },
      {
        "id": 2,
        "text": "Sphingomyelinase"
      },
      {
        "id": 3,
        "text": "Alpha-galactosidase"
      },
      {
        "id": 4,
        "text": "Ceramidase"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Farber's disease</strong> is caused by a deficiency of the enzyme <strong>ceramidase</strong>. This leads to the accumulation of <strong>ceramide</strong>, resulting in the characteristic clinical features of Farber disease.</p>\n<p>Key clinical features of Farber disease:</p>\n<ul>\n<li><strong>Hoarse voice</strong>: a hallmark symptom resulting from <strong>laryngeal</strong> involvement.</li>\n<li>Joint Pain and Swelling: Resembling <strong>arthritis</strong> due to <strong>granulomas</strong> in the joints.</li>\n<li>Subcutaneous <strong>Nodules</strong></li>\n<li><strong>Hepatosplenomegaly</strong></li>\n<li>Developmental Delay: due to progressive <strong>neurodegeneration</strong></li>\n</ul>\n<p>The given image shows swelling of joints in Farber's disease:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a017a6d45196402e81ffe7e36e3d7b92x268x201.JPEG"
    ]
  },
  {
    "text": "Which of the following phospholipids plays a key role in the generation and transmission of visual impulses in the retina?",
    "choices": [
      {
        "id": 1,
        "text": "Phosphatidyl serine"
      },
      {
        "id": 2,
        "text": "Phosphatidyl inositol"
      },
      {
        "id": 3,
        "text": "Phosphatidyl choline"
      },
      {
        "id": 4,
        "text": "Phosphatidyl ethanolamine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Phosphatidylinositol</strong> (PI) is responsible for <strong>signal transmission </strong>as well as the<strong> generation </strong>of<strong> impulses </strong>in<strong> </strong>the<strong> retina.\u00a0</strong></p>\n<p><strong>Rhodopsin</strong> or visual purple, the photosensitive pigment, is composed of <strong>opsin</strong> (a protein belonging to the superfamily of <strong>G protein\u2013coupled receptors</strong>) <strong>and</strong> <strong>retinal</strong> (an aldehyde of vitamin A). When light strikes the photoreceptors, <strong>retinal</strong> is chemically <strong>transformed</strong> in a process called <strong>photoisomerization,</strong> which begins the transduction process.</p>\n<p>Visual pigments are a type of <strong>G</strong>-<strong>protein</strong>-<strong>coupled</strong> <strong>receptors</strong>. The receptor protein, known as <strong>opsin</strong>, is locked in its inactive state by <strong>11</strong>-<strong>cis</strong> <strong>retinal.</strong>\u00a0<strong>Isomerization</strong> and <strong>photo</strong>-<strong>excitation</strong> result in the activation of G-protein and the production of <strong>cyclic</strong> <strong>GMP</strong>. <strong>Transducin</strong> serves as the <strong>G</strong>-<strong>protein</strong> specifically within the retina. \u00a0 The nerve impulse that is produced in the retina is then conveyed to the <strong>visual</strong> <strong>centres</strong> in the brain. The signal is ended through the process of <strong>phosphorylation</strong>, specifically targeting a <strong>serine</strong> <strong>residue</strong> on the <strong>activated</strong> <strong>rhodopsin</strong>. This <strong>phosphorylation</strong> is carried out by an enzyme called <strong>rhodopsin</strong> <strong>kinase</strong>. The purpose of this phosphorylation is to allow the <strong>inhibitory</strong> <strong>protein</strong> <strong>beta</strong>-<strong>arrestin</strong> to <strong>connect</strong> to the <strong>rhodopsin</strong> and <strong>deactivate</strong> it.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2af7ed5d414149fb8a564120c482a583x635x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8f3da5e8184f4756813e1f79529ba65bx1171x977.JPEG"
    ]
  },
  {
    "text": "A 40-year-old chronic alcoholic presents with confusion, memory loss, and agitation. On examination, he is disoriented and horizontal nystagmus is noted. Which of the following enzyme markers can aid the diagnosis of the patient's current condition?",
    "choices": [
      {
        "id": 1,
        "text": "Erythrocyte glutathione reductase"
      },
      {
        "id": 2,
        "text": "Erythrocyte transketolase"
      },
      {
        "id": 3,
        "text": "Erythrocyte transaminase"
      },
      {
        "id": 4,
        "text": "Serum methyl malonate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span data-preserver-spaces=\"true\">The features of\u00a0<strong>confusion</strong>, <strong>memory loss</strong>, and<strong>\u00a0horizontal nystagmus</strong> in a\u00a0<strong>chronic alcoholic</strong> are suggestive of <strong>Wernicke's encephalopathy</strong>\u00a0caused due to deficiency of <strong>thiamine\u00a0</strong>(Vitamin <strong>B1</strong>). This can be diagnosed by <strong>erythrocyte transketolase</strong> assay.</span></p>\n<p><span data-preserver-spaces=\"true\">Thiamine (Vitamin <strong>B1</strong>) is a water-soluble vitamin, required for carbohydrate metabolism.\u00a0<strong>Thiamine pyrophosphate</strong> (TPP) is its coenzyme form and is required for the following enzymes:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Pyruvate dehydrogenase\u00a0</span></li>\n<li><span data-preserver-spaces=\"true\">Alpha-ketoglutarate dehydrogenase in citric acid cycle</span></li>\n<li><span data-preserver-spaces=\"true\">Branched-chain keto acid dehydrogenase in the metabolism of leucine, isoleucine, and valine</span></li>\n<li><span data-preserver-spaces=\"true\">Transketolase</span></li>\n</ul>\n<p><span data-preserver-spaces=\"true\">Thiamine deficiency leads to the following:</span></p>\n<p><span data-preserver-spaces=\"true\"><strong>Beriberi</strong> - anorexia, dyspepsia, heaviness, peripheral neuropathy, and weakness (<strong>dry beriberi</strong>) or\u00a0</span><span data-preserver-spaces=\"true\">with cardiovascular features like edema, palpitations, breathlessness, distended neck veins (<strong>wet beriberi</strong>)</span></p>\n<p><strong>Wernicke\u2019s encephalopathy</strong>\u00a0is associated with chronic alcohol abuse which lead to thiamine deficiency because of poor nutritional habits, or malabsorption. It is an<strong>\u00a0acute neurological disorder</strong>\u00a0characterized by:</p>\n<ul>\n<li aria-level=\"1\"><strong>Global confusion</strong></li>\n<li aria-level=\"1\">Ocular abnormalities like <strong>horizontal nystagmus</strong>, gaze palsy, anisocoria, and sluggish pupillary reflex</li>\n<li aria-level=\"1\"><strong>Ataxia</strong> - mainly affecting the gait</li>\n<li aria-level=\"1\">Vestibular dysfunction</li>\n</ul>\n<p><span data-preserver-spaces=\"true\"><strong>Korsakoff's syndrome</strong> is a neuropsychiatric disorder characterized by <strong>confabulation</strong> and <strong>memory defects</strong>. Immediate memory is generally maintained but short-term memory is diminished.</span></p>\n<p><span data-preserver-spaces=\"true\">The initial treatment in a patient with Wernicke's disease should be <strong>emergent thiamine infusion, </strong>either IM or IV. This should be given daily until a normal diet is resumed and <strong>before treatment with IV glucose.</strong> Administration of glucose before thiamine <strong>can worsen Wernicke's encephalopathy.\u00a0</strong></span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 1-month-old child who is being exclusively breastfed develops bluish discoloration of skin, breathing difficulty, and a soft cry. On evaluation, cardiomegaly is detected. The mother, who is accustomed to consuming polished rice, has no symptoms of illness. Which of the following vitamins may be deficient in the mother?",
    "choices": [
      {
        "id": 1,
        "text": "Riboflavin"
      },
      {
        "id": 2,
        "text": "Thiamine"
      },
      {
        "id": 3,
        "text": "Pyridoxine"
      },
      {
        "id": 4,
        "text": "Niacin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical presentation of <strong>cyanosis, dyspnea,</strong> and <strong>aphonia, </strong>seen here as bluish discoloration of skin, breathing difficulty, and a soft or weak cry, associated with <strong>cardiomegaly</strong> in a <strong>breastfed infant </strong>of a mother accustomed to consuming polished-rice, is suggestive of <strong>Infantile Beriberi, </strong>due to<strong> thiamine (vitamin B1)\u00a0deficiency</strong> in the mother.</p>\n<p><strong>Infantile beriberi </strong>occurs in <strong>breastfed infants of thiamine-deficient mothers, </strong>wherein the mother may be asymptomatic but the child presents with the symptoms and signs of <strong>cyanosis, dyspnea,</strong> <strong>aphonia and cardiomegaly</strong>.\u00a0Untreated infantile beriberi may be <strong>fatal </strong>within a few weeks. Thiamine deficiency causes <strong>beriberi, </strong>commonly seen in low socio-economic status where <strong>polished rice</strong> which is thiamine deficient, is consumed. The condition may present in three varieties:</p>\n<p><strong>1. Dry beriberi</strong> is associated with neurological deficits such as peripheral neuropathy, optic atrophy, ataxia, and irritability. Complications include\u00a0<strong>lactic acidosis</strong>\u00a0and Wernicke encephalopathy in adults.</p>\n<p><strong>2. Wet beriberi </strong>results due to cardiac and renal dysfunction which leads to fluid accumulation. It is associated with tachycardia, cardiomegaly, cardiac failure, and edema.</p>\n<p><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">3.\u00a0</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"><strong>Infantile beriberi</strong>, as described above.</span></p>\n<p>Diagnosis of thiamine deficiency can be established by\u00a0<strong>erythrocyte transketolase</strong>\u00a0activity assessment.</p>\n<div class=\"page\" title=\"Page 129\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Treatment with thiamine</strong> leads to <strong>resolution </strong>of neurologic and cardiac symptoms within 24-48 hours. Treatment of patients with mild beriberi with thiamine (5 mg/day) is satisfactory. Severely ill children should receive 10 mg intravenously twice daily.\u00a0</p>\n</div>\n</div>\n</div>\n<p>Other options:</p>\n<p>Option A: <strong>Riboflavin</strong> deficiency can present with <strong>cheilosis</strong>, but it does not typically cause pedal edema and cardiomegaly.</p>\n<p>Option C: <strong>Pyridoxine</strong> (vitamin B6) deficiency can cause <strong>neurological symptoms, anemia</strong>, and<strong> dermatitis</strong> but is not associated with pedal edema, cardiomegaly, and cheilosis.</p>\n<p>Option D: <strong>Niacin</strong> (vitamin B3) deficiency leads to <strong>pellagra</strong>, characterized by the triad of dermatitis, diarrhea, and dementia. It is not associated with pedal edema, cardiomegaly, and cheilosis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During an autopsy of a man with a suspected case of poisoning, you observe the presence of\u00a0a bitter almond odor. Which of the following changes is associated with this poisoning?",
    "choices": [
      {
        "id": 1,
        "text": "Increased NAD+"
      },
      {
        "id": 2,
        "text": "Increased mixed venous saturation"
      },
      {
        "id": 3,
        "text": "Reduced absorption of bicarbonate"
      },
      {
        "id": 4,
        "text": "Increased proton gradient"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span style=\"font-size: 13.3333px;\"><strong>Complex IV </strong>of the electron transport chain (ETC) is blocked by <strong>cyanide,\u00a0</strong>which has a characteristic\u00a0<strong>bitter almond odour</strong> in case of poisoning. In addition, an<strong> increase in the mixed venous saturation</strong> of the blood can be observed as there is <strong>reduced oxygen delivery by the RBCs to the tissues</strong>.\u00a0</span></p>\n<table style=\"height: 215px;\" width=\"599\">\n<tbody>\n<tr>\n<td style=\"width: 291.5px; text-align: left;\">Complexes of ETC</td>\n<td style=\"width: 291.5px; text-align: left;\">\u00a0 Inhibitors</td>\n</tr>\n<tr>\n<td style=\"width: 291.5px; text-align: left;\">Complex I: NADH-Q oxidoreductase</td>\n<td style=\"width: 291.5px; text-align: left;\">Piericidin A, amobarbital, rotenone</td>\n</tr>\n<tr>\n<td style=\"width: 291.5px; text-align: left;\">Complex II: Succinate-Q reductase</td>\n<td style=\"width: 291.5px; text-align: left;\">TTFA (thenoyltrifluoroacetone), carboxin, malonate</td>\n</tr>\n<tr>\n<td style=\"width: 291.5px; text-align: left;\">Complex III: Q- cyt c oxidoreductase</td>\n<td style=\"width: 291.5px; text-align: left;\">BAL (British anti-lewisite), antimycin A</td>\n</tr>\n<tr>\n<td style=\"width: 291.5px; text-align: left;\"><strong>Complex IV</strong>: Cyt c oxidase</td>\n<td style=\"width: 291.5px; text-align: left;\">Hydrogen sulfide, carbon monoxide, <strong>cyanide</strong></td>\n</tr>\n<tr>\n<td style=\"width: 291.5px; text-align: left;\">\u00a0ATP synthase</td>\n<td style=\"width: 291.5px; text-align: left;\">Oligomycin</td>\n</tr>\n</tbody>\n</table>\n<p>The following image shows different compounds inhibiting the different components in an electron transport chain.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7fdce35a5184493da5256b2517142930x1280x2560.JPEG"
    ]
  },
  {
    "text": "A 7-year-old child is brought with a history of impaired vision and severe photophobia. On examination, he has light hair, light skin color, and pale blue eyes. A disorder due to deficiency in the enzyme tyrosinase is suspected. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Albinism"
      },
      {
        "id": 2,
        "text": "Tyrosinemia type 1"
      },
      {
        "id": 3,
        "text": "Tyrosinemia type 2"
      },
      {
        "id": 4,
        "text": "Homocystinuria"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span data-preserver-spaces=\"true\">The clinical scenario along with the deficiency of the&nbsp;</span><span data-preserver-spaces=\"true\">enzyme&nbsp;</span><strong><span data-preserver-spaces=\"true\">tyrosinase&nbsp;</span></strong><span data-preserver-spaces=\"true\">point to the diagnosis of <strong>albinism</strong>.&nbsp;</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Oculocutaneous albinism</span></strong><span data-preserver-spaces=\"true\">&nbsp;<strong>(OCA)</strong> is a group of inherited disorders characterized by a reduction or complete lack of <strong>melanin</strong> pigment in the <strong>skin, hair,</strong> and<strong> eyes</strong> leading to hypopigmentation.&nbsp;It is either due to defective melanosomes or defective protein involved in the formation and transfer of melanin. </span></p>\n<p><span data-preserver-spaces=\"true\">There are 7 types of&nbsp;nonsyndromic albinism (OCA1 to OCA7).<strong> OCA type 1</strong> is characterised by reduced or absent <strong>tyrosinase</strong> activity.&nbsp;</span><span data-preserver-spaces=\"true\">The<strong> first step</strong> in <strong>melanin synthesis</strong> involves the oxidation of L-tyrosine to DOPA by the enzyme tyrosinase.&nbsp;</span>Tyrosinase further acts on DOPA to form dopaquinone, which undergoes a series of reactions to form melanin.&nbsp;</p>\n<p><span data-preserver-spaces=\"true\">Clinical features include&nbsp;<strong>white hair,</strong>&nbsp;<strong>white skin, </strong>and&nbsp;<strong>iris</strong> appearing&nbsp;<strong>blue-grey</strong> in oblique light. Ocular manifestations include&nbsp;<strong>photophobia,</strong> nystagmus, and&nbsp;<strong>decreased visual acuity.&nbsp;</strong></span></p>\n<p><span data-preserver-spaces=\"true\">Other options-</span></p>\n<p>Option B- <strong>Tyrosinemia type 1</strong> is caused due to the deficiency of the enzyme <strong>fumarylacetoacetate hydrolase</strong>. Clinical findings include&nbsp;cirrhosis, liver failure, rickets, failure to thrive, peripheral neuropathy, and boiled cabbage odour.&nbsp;</p>\n<p>Option C- <strong>Tyrosinemia type 2</strong> is caused due to the deficiency of the enzyme <strong>tyrosine transaminase.</strong> Clinical findings include palmoplantar keratosis, painful corneal erosions with photophobia, and <strong>learning disability.&nbsp;</strong></p>\n<p>Option D- <strong>Homocystinuria</strong> is caused due to <strong>cystathionine beta-synthase</strong> deficiency. Clinical findings include lens dislocation, thrombotic vascular disease, <strong>intellectual</strong> <strong>disability</strong>, and osteoporosis.</p>\n<p>Given below is an image of a young child with OCA showing white hair, skin, and pale iris:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/36fbf01e9a85437596b312b2a4c032cex794x527.JPEG"
    ]
  },
  {
    "text": "An exclusively breastfed newborn is referred to you with recurrent vomiting and diarrhea. On examination, the baby is jaundiced and has hepatomegaly. Based on further evaluation, a diagnosis of classical galactosemia is made. This baby is most susceptible to sepsis caused by:",
    "choices": [
      {
        "id": 1,
        "text": "Staphylococcus aureus"
      },
      {
        "id": 2,
        "text": "Streptococcus agalactiae"
      },
      {
        "id": 3,
        "text": "Esherichia coli"
      },
      {
        "id": 4,
        "text": "Klebsiella pneumoniae"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Infants with <strong>classical galactosemia</strong> are susceptible to recurrent <strong>sepsis</strong> caused by <strong>Escherichia coli.</strong></p>\n<p><strong>Classical</strong> galactosemia is caused to deficient<strong>\u00a0galactose-1-phosphate uridyl transferase. </strong>The enzyme is responsible for the conversion of <strong>galactose 1-phosphate to glucose-1-phosphate</strong> in the metabolism of galactose.\u00a0\u00a0</p>\n<p><strong>Classical galactosemia\u00a0</strong>is an\u00a0autosomal recessive disorder.<strong>\u00a0</strong>The enzyme deficient here is\u00a0<strong>galactose-1-phosphate uridyl transferase </strong>(GALT).<strong>\u00a0</strong>Normally, newborns receive up to 40% of their calorie intake as lactose (glucose + galactose). Without GALT, the infant cannot metabolize <strong>galactose 1-phosphate,\u00a0</strong>which\u00a0accumulates and causes injury to the kidney, liver, and brain.</p>\n<p>Clinical features include <strong>vomiting, hypoglycemia,</strong> hepatomegaly, jaundice, congenital cataracts, aminoaciduria, and\u00a0<strong>failure to thrive</strong>. There is an increased incidence of\u00a0<strong><em>Escherichia coli</em> neonatal</strong> <strong>sepsis</strong>. Long-term <strong>complications</strong> include speech delays, learning impairment, motor dysfunction, and hypogonadotropic hypogonadism (in females).</p>\n<div class=\"page\" title=\"Page 136\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The presence of galactose in urine (<strong>positive Benedict's test</strong>), elevated blood galactose level, and elevated\u00a0erythrocyte galactose-1-phosphate level help in confirming the diagnosis.</p>\n</div>\n</div>\n</div>\n<p>Treatment is a <strong>galactose-free diet</strong>. Supportive therapy and the prevention of complications are important.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/273ae933e27941edbdbe9e4f99d5dbe6x1280x1129.JPEG"
    ]
  },
  {
    "text": "A child born with a rare genetic disorder presented with failure to thrive and susceptibility to recurrent pyogenic, viral, and fungal infections. His blood reports showed lymphopenia and a diagnosis of SCID was suspected. He was advised to stay in a protective 'bubble' as shown in the image below. Which of the following statements is incorrect regarding the disease in question?",
    "choices": [
      {
        "id": 1,
        "text": "X-linked inheritance is most common."
      },
      {
        "id": 2,
        "text": "Defective non-homologous end-joining repair"
      },
      {
        "id": 3,
        "text": "The X-linked form is due to the deficiency of  adenosine deaminase"
      },
      {
        "id": 4,
        "text": "Defective humoral\u00a0and\u00a0cell-mediated\u00a0immune responses"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>X-linked SCID </strong>is the\u00a0<strong>most common form</strong> where there\u00a0is a\u00a0<strong>mutation </strong>in the<strong> common \u03b3-chain (\u03b3c) subunit </strong>of<strong> cytokine receptors</strong>. The given clinical scenario and the image of a child in a protective bubble (Bubble boy disease) are suggestive of <strong>severe combined immunodeficiency (SCID).\u00a0</strong></p>\n<p>\u00a0Severe combined immunodeficiency (SCID) is characterized by:</p>\n<ul>\n<li>Defects in\u00a0<strong>both humoral</strong>\u00a0and\u00a0<strong>cell-mediated</strong>\u00a0immune responses.</li>\n<li>Persons with SCID are extremely susceptible to recurrent, severe infections by a wide range of pathogens, including\u00a0<strong>Candida albicans,\u00a0Pneumocystis jirovecii,\u00a0Pseudomonas\u00a0species, cytomegalovirus, varicella,</strong>\u00a0and a host of other bacteria.</li>\n<li>Genes involved are\u00a0<strong>JAK3, RAG1,</strong>\u00a0and\u00a0<strong>IL-7R.</strong></li>\n</ul>\n<p>Types of SCID:</p>\n<p><strong>X-linked SCID</strong></p>\n<ul>\n<li>The\u00a0<strong>most common form,</strong>\u00a0accounting for 50% to 60% of cases, is X-linked, and hence, SCID is more<strong>\u00a0common in boys</strong>\u00a0than in girls.</li>\n<li>The genetic defect in the X-linked form is a\u00a0<strong>mutation</strong> in the <strong>common \u03b3-chain (\u03b3c) subunit </strong>of <strong>cytokine receptors</strong>.</li>\n<li>The thymus contains\u00a0<strong>lobules of undifferentiated epithelial cells resembling fetal thymus.</strong></li>\n</ul>\n<p><strong>Autosomal recessive</strong></p>\n<ul>\n<li>The most common cause of<strong> autosomal-recessive SCID</strong> is a<strong>\u00a0deficiency </strong>of <strong>adenosine deaminase (ADA)</strong>\u00a0enzyme.</li>\n<li>In SCID caused by ADA deficiency, remnants of\u00a0<strong>Hassall\u2019s corpuscles</strong>\u00a0can be found.</li>\n</ul>\n<p>It can be associated with a<strong> defective non-homologous end-joining </strong>(NHEJ). NHEJ is a predominant pathway for DNA double-stranded break repair. NHEJ deficiency confers (severe) combined immunodeficiency due to a failure to carry out V(D)J recombination efficiently. NHEJ also functions in class switch recombination, another step enhancing T and B cell diversity.</p>\n<p>Note:</p>\n<p>The deficiency of adenosine deaminase enzyme was the <strong>first</strong> pathophysiologic condition to be treated by <strong>gene therapy</strong>. In1990, Dr. William French Anderson introduced a new copy of this gene, which was carried on a retroviral vector, into a 4-year-old girl suffering from severe combined immunodeficiency (bubble boy disease).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/20d98e26810d41d993afd2a0347328ae.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 28-year-old male patient with short stature, disproportionate spine, barrel chest with pectus carinatum and a short neck came to the OPD. On evaluation, a diagnosis of lysosomal storage disorder is made. The glycosaminoglycan involved in the condition is a prominent component of which among the following?",
    "choices": [
      {
        "id": 1,
        "text": "Cornea"
      },
      {
        "id": 2,
        "text": "Cartilage"
      },
      {
        "id": 3,
        "text": "Kidney basement membrane"
      },
      {
        "id": 4,
        "text": "Synovial fluid"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of <strong>mucopolysaccharidoses IV</strong> and the glycosaminoglycan involved is <strong>c</strong><strong>hondroitin sulfate,\u00a0</strong>which is a prominent component of <strong>cartilage</strong>.</p>\n<p>It is\u00a0composed of\u00a0repeating units of\u00a0<strong>N-acetyl galactosamine and glucuronic acid </strong>(GAG).</p>\n<p>In this condition, the affected individuals survive into adulthood with normal faces and intellect. Short stature with a disproportionate spine, barrel chest with pectus carinatum, and short neck and limb abnormalities may be present.</p>\n<p>Some important features of chondroitin sulfate are as follows:</p>\n<ul>\n<li>The\u00a0<strong>most abundant GAG</strong>\u00a0in the body and is seen in the\u00a0cartilage, CNS, and bone</li>\n<li>They are located at sites of calcification in endochondral bone and are a major component of <strong>cartilage</strong>.</li>\n<li>They are found in high amounts in the extracellular matrix of the central nervous system.</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Keratan sulfate I and II</strong> are the GAGs in the <strong>cornea</strong>. It is also found in cartilage and loose connective tissue. It is the only GAG that does not contain any uronic acid. The repeating units are <strong>galactose and N-acetyl glucosamine</strong> in beta linkage.</p>\n<p>Option C:\u00a0<strong>Heparan sulfate\u00a0</strong>is the GAG present in the <strong>kidney basement membrane</strong>, where it plays a major role in determining the charge selectiveness of glomerular filtration. It is also found in the skin. It contains repeating units of <strong>sulfated glucosamine and glucuronic acid</strong>.</p>\n<p>Option D: <strong>Hyaluronic acid</strong> is the GAG present in <strong>synovial fluid</strong>. It is also found in skin, bone, cartilage, vitreous humor, and embryonic tissues. It contains repeating units of\u00a0 <strong>N-acetyl glucosamine and glucuronic acid</strong>. It plays a role in morphogenesis and wound repair. The high concentrations of hyaluronic acid along with chondroitin sulfates in cartilage contribute to its compressibility.</p>\n<p>The images below show the structure of the cartilage matrix containing glycosaminoglycans and the structure of aggrecan, a major proteoglycan present in cartilage.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/67318a8bf95c43458e32f68aec2ced49x1102x490.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ca4ee3b83d5f4ce0ad9162fcd39be183x1280x1126.JPEG"
    ]
  },
  {
    "text": "Which of the following enzymes will show reduced activity in a person who is fasting?",
    "choices": [
      {
        "id": 1,
        "text": "Fructose 2,6 bisphosphatase"
      },
      {
        "id": 2,
        "text": "Fructose 1,6 bisphosphatase"
      },
      {
        "id": 3,
        "text": "Pyruvate carboxylase"
      },
      {
        "id": 4,
        "text": "Phosphofructokinase-2"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>During <strong>fasting</strong>, there is increased <strong>glucagon release</strong>. This causes the production of cAMP, and subsequent <strong>activation</strong> <strong>of </strong>cAMP-dependent <strong>protein kinase</strong>. This protein kinase has <strong>two functions:</strong></p>\n<ul>\n<li><strong>Activation</strong> <strong>of fructose 2,6 bisphosphatase</strong></li>\n<li><strong>Inactivation of phosphofructokinase-2</strong></li>\n</ul>\n<p>Both these actions <strong>reduce</strong> the amount of<strong> fructose 2,6 bisphosphate</strong> and thus <strong>inhibit</strong> <strong>glycolysis</strong> and <strong>move</strong> the needle of glucose metabolism <strong>toward</strong> <strong>gluconeogenesis</strong>. <strong>Pyruvate</strong> <strong>carboxylase</strong> and<strong> fructose 1,6 bisphosphatase</strong> are <strong>enzymes</strong> catalyzing steps <strong>of</strong> <strong>gluconeogenesis</strong>, and are thus <strong>stimulated</strong> <strong>during</strong> <strong>fasting</strong> state.</p>\n<p>Glycolysis and gluconeogenesis and the key enzymes involved in these processes are shown below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/33d22ff219d14d8fa321210951976e74x600x1200.JPEG"
    ]
  },
  {
    "text": "A woman with type 1 diabetes mellitus presents to the emergency room with severe nausea, vomiting, and abdominal pain.  She has a fruity odor of breath and is hyperglycemic.  Urine Rothera's test is positive. Which of the following tissues cannot utilize the non-carbohydrate metabolic byproduct increased in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Renal cortex"
      },
      {
        "id": 2,
        "text": "Skeletal muscle"
      },
      {
        "id": 3,
        "text": "Liver"
      },
      {
        "id": 4,
        "text": "Cardiac muscle"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical vignette with a <strong>positive Rothera's test</strong> is suggestive of\u00a0<strong>diabetic ketoacidosis</strong>. The non-carbohydrate metabolic byproduct increased here is\u00a0<strong>ketone bodies</strong> and\u00a0the <strong>liver</strong> <strong>cannot utilize </strong>ketone bodies.</p>\n<p>Type I diabetes mellitus is a <strong>low insulin state</strong>. There is an\u00a0<strong>increased </strong>conversion of <strong>fatty acids </strong>to <strong>acetyl-CoA</strong>\u00a0which in turn leads to <strong>increased ketone body</strong> production. The presence of ketosis can be established by the detection of ketone bodies in urine by<strong>\u00a0Rothera's test</strong>.</p>\n<p>The ketone bodies synthesized in the liver mitochondria are transported in the blood to the peripheral tissues, where they are utilized by the following steps:</p>\n<ul>\n<li>\u03b2-hydroxybutyrate is oxidized to acetoacetate by\u00a0<strong>\u03b2-hydroxybutyrate dehydrogenase</strong> producing NADH.</li>\n<li>Acetoacetate is then activated to acetoacetyl CoA by transferring a CoA molecule from succinyl CoA by <strong>succinyl CoA-acetoacetate CoA transferase (thiophorase).</strong></li>\n<li>Acetoacetyl CoA is cleaved into two acetyl CoA molecules by <strong>thiolase</strong> and oxidized into CO<sub>2</sub> by the TCA cycle.</li>\n</ul>\n<p>Ketone bodies are <strong>utilized</strong> by <strong>extrahepatic tissue</strong> like the <strong>cardiac muscle</strong> and <strong>renal cortex</strong> (prefer the ketone bodies to glucose as fuel). Tissues like <strong>skeletal muscle</strong> and the brain can also utilize the ketone bodies as alternate sources of energy if glucose is not available.</p>\n<p><strong>RBCs cannot</strong> utilize ketone bodies as they <strong>lack mitochondria</strong>. The <strong>liver</strong> cannot utilize ketone bodies as it\u00a0<strong>lacks the enzyme thiophorase.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d0a9b8cd80694d72a4b505f199b0eeb4x720x540.JPEG"
    ]
  },
  {
    "text": "A 1-year-old male baby presents with a history of fever, irritability, and vomiting. On examination, there is moderate hepatomegaly. Laboratory investigations reveal elevated levels of serum transaminases and elevated levels of succinylacetone in serum and urine. Which enzyme is deficient in this baby?",
    "choices": [
      {
        "id": 1,
        "text": "Fumarylacetoacetate hydroxylase"
      },
      {
        "id": 2,
        "text": "Tyrosine aminotransferase"
      },
      {
        "id": 3,
        "text": "4-hydroxy-phenyl pyruvate dioxygenase"
      },
      {
        "id": 4,
        "text": "Phenylalanine hydroxylase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span data-preserver-spaces=\"true\">The clinical scenario and laboratory findings are diagnostic of <strong>t</strong></span><strong><span data-preserver-spaces=\"true\"><strong>yrosinemia</strong> type I</span></strong><span data-preserver-spaces=\"true\">&nbsp;and the enzyme deficient is&nbsp;</span><strong><span data-preserver-spaces=\"true\">fumarylacetoacetate hydroxylase (FAH).</span></strong></p>\n<p><span data-preserver-spaces=\"true\">Tyrosinemia type I or <strong>Hepatorenal tyrosinemia</strong> is caused by FAH deficiency. It is an&nbsp;</span><strong><span data-preserver-spaces=\"true\">autosomal recessive disease</span></strong><span data-preserver-spaces=\"true\">, caused by a defective&nbsp;</span><strong><span data-preserver-spaces=\"true\">FAH gene</span></strong><span data-preserver-spaces=\"true\">. This results in the accumulation of&nbsp;</span><strong><span data-preserver-spaces=\"true\">fumarylacetoacetate</span></strong><span data-preserver-spaces=\"true\">&nbsp;and&nbsp;</span><strong><span data-preserver-spaces=\"true\">succinylacetone</span></strong><span data-preserver-spaces=\"true\">&nbsp;which are metabolites of tyrosine degradation. The tissues most affected are hepatic, renal, and nervous tissues. The manifestations of these can be seen in the form of an&nbsp;</span><strong><span data-preserver-spaces=\"true\">acute hepatic crisis</span></strong><span data-preserver-spaces=\"true\">, such as in this case.&nbsp;They may also present with&nbsp;<strong>peripheral neuropathy</strong>&nbsp;resembling acute porphyria.&nbsp;<strong>Renal involvement</strong>&nbsp;is manifested as a <strong>Fanconi-like syndrome</strong> with hyperphosphaturia, hypophosphatemia, and vitamin D-resistant rickets.<br /></span></p>\n<p><span data-preserver-spaces=\"true\"><strong>Boiled cabbage odor</strong>&nbsp;may be present in classical type 1 tyrosinemia resulting from increased&nbsp;<strong>methionine metabolites</strong>&nbsp;(sulfur-containing compounds). Boiled cabbage odor can also be found in cases of <strong>hypermethioninemia.</strong><br /></span></p>\n<p><span data-preserver-spaces=\"true\">The diagnosis can be established by the demonstration of&nbsp;</span><strong><span data-preserver-spaces=\"true\">elevated levels </span></strong>of<strong><span data-preserver-spaces=\"true\"> succinylacetone</span></strong><span data-preserver-spaces=\"true\">&nbsp;in urine or blood. The treatment of choice is&nbsp;</span><strong><span data-preserver-spaces=\"true\">nitisinone (NTBC)</span></strong><span data-preserver-spaces=\"true\">&nbsp;which reduces the formation of fumarylacetoacetate and succinylacetone by <strong>inhibiting</strong> the <strong>degradation</strong> of <strong>tyrosine</strong>. However, this increases the plasma levels of tyrosine. A&nbsp;</span><strong><span data-preserver-spaces=\"true\">diet low in tyrosine&nbsp;</span></strong><span data-preserver-spaces=\"true\">and phenylalanine is also prescribed to patients.</span></p>\n<p><span data-preserver-spaces=\"true\">Other options:</span></p>\n<p><span data-preserver-spaces=\"true\">Option B:&nbsp;</span><strong><span data-preserver-spaces=\"true\">Tyrosine aminotransferase</span></strong><span data-preserver-spaces=\"true\">&nbsp;is deficient in <strong>t</strong></span><strong><span data-preserver-spaces=\"true\"><strong>yrosinemia</strong> type II</span></strong><span data-preserver-spaces=\"true\">&nbsp;(<strong>Richner-Hanhart syndrome</strong> or <strong>oculocutaneous tyrosinemia</strong>). It is also an <strong>autosomal</strong> <strong>recessive</strong> disease that results in <strong>hyperkeratosis</strong>, herpetiform <strong>corneal ulcers</strong>, and intellectual disability. The laboratory finding here is marked hypertyrosinemia and&nbsp;</span><strong><span data-preserver-spaces=\"true\">elevated 4-hydroxyphenylpyruvic acid</span></strong><span data-preserver-spaces=\"true\">. The treatment here also involves a diet low in tyrosine and phenylalanine.</span></p>\n<p><span data-preserver-spaces=\"true\">Option C:&nbsp;<strong>4-hydroxy-phenyl pyruvate dioxygenase </strong>deficiency&nbsp;causes&nbsp;<strong>type III tyrosinemia</strong>&nbsp;(neonatal tyrosinemia). Patients might rarely have a mental disability. The liver function is generally normal. <strong>Hawkinsinuria</strong> is an autosomal dominant disorder caused due to deficiency of&nbsp;<strong>4-hydroxy-phenyl pyruvate dioxygenase.</strong></span></p>\n<p><span data-preserver-spaces=\"true\">Option D:</span><strong><span data-preserver-spaces=\"true\">&nbsp;Phenylalanine hydroxylase</span></strong><span data-preserver-spaces=\"true\">&nbsp;deficiency causes&nbsp;</span><strong><span data-preserver-spaces=\"true\">phenylketonuria</span></strong><span data-preserver-spaces=\"true\">. It manifests as progressive intellectual disability. The diagnosis is made by measurement of plasma phenylalanine levels or by detecting&nbsp;</span><strong><span data-preserver-spaces=\"true\">phenyl ketones in the urine.</span></strong><span data-preserver-spaces=\"true\">&nbsp;A diet low in phenylalanine is the mainstay of treatment.&nbsp;</span></p>\n<p>The steps and enzymes of tyrosine metabolism are shown below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/36893c4004af444289964d1b4af63913x1280x2566.JPEG"
    ]
  },
  {
    "text": "A 38-year-old male patient came with complaints of weight loss, lethargy, polyuria, and polyphagia. During the blood sample collection for plasma glucose estimation in this patient, a vacutainer shown in the below image is used.  Which of the following glycolytic enzymes is inhibited by the content in the vacutainer?",
    "choices": [
      {
        "id": 1,
        "text": "Aldolase"
      },
      {
        "id": 2,
        "text": "1,3-bisphosphoglycerate kinase"
      },
      {
        "id": 3,
        "text": "Enolase"
      },
      {
        "id": 4,
        "text": "Glyceraldehyde-3-PO4 dehydrogenase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above image shows a <strong>grey</strong>\u00a0<strong>vacutainer</strong>. It is used to collect blood samples for <strong>plasma glucose estimation</strong>. Since it contains sodium fluoride, the<strong> fluoride</strong> will inhibit the glycolytic enzyme <strong>enolase</strong>.</p>\n<p><strong>Grey</strong> vacutainer contains <strong>sodium fluoride</strong> and<strong> potassium oxalate</strong>. Potassium oxalate binds to <strong>calcium</strong> and inhibits <strong>coagulation</strong>.</p>\n<p>\u00a0Inhibitors of glycolytic enzymes:</p>\n<ul>\n<li><strong>Fluoride</strong>\u00a0inhibits the enzyme\u00a0<strong>enolase</strong>\u00a0which is responsible for the conversion of\u00a02-phosphoglycerate to phosphoenolpyruvate.</li>\n<li><strong>Iodoacetate\u00a0</strong>inhibits the enzyme\u00a0<strong>glyceraldehyde-3-phosphate dehydrogenase</strong>\u00a0which is responsible for the conversion of\u00a0glyceraldehyde-3-phosphate to 1,3 bisphosphoglycerate. This action of <strong>iodoacetate</strong> helps in <strong>anticancer</strong> activity.</li>\n<li><strong>Arsenate</strong>\u00a0inhibits <strong>1,3 bisphosphoglycerate kinase</strong>. 1,3 bisphosphoglycerate kinase converts\u00a0 1,3 bisphosphoglycerate to 3 phosphoglycerates.\u00a0Arsenate competes with inorganic phosphate (Pi) in this reaction to give 1-arseno-3-phosphoglycerate which undergoes spontaneous hydrolysis to 3-phosphoglycerate <strong>without</strong> forming <strong>ATP</strong>.</li>\n</ul>\n<p>The below image shows the steps of glycolysis and gluconeogenesis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3d41c97bef744372aa0ae58e61eb5448.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/034b30eece0140db9c37006508c9f10bx600x1200.JPEG"
    ]
  },
  {
    "text": "A patient who is a painter by profession presents with abdominal colic and constipation. On examination, pallor and bluish-black discoloration of gums are observed.  All of the following are features of this poisoning, except __________.",
    "choices": [
      {
        "id": 1,
        "text": "Microcytic hypochromic anemia with basophilic stippling of erythrocytes seen in peripheral smear"
      },
      {
        "id": 2,
        "text": "Elevated levels of ALA and coproporphyrinogen in urine"
      },
      {
        "id": 3,
        "text": "Elevated levels of porphobilinogen in blood"
      },
      {
        "id": 4,
        "text": "Inhibits ALA dehydratase and ferrochelatase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical vignette is suggestive of<strong> lead poisoning</strong>.<strong> Porphobilinogen </strong>is<strong> not elevated</strong> in blood in lead poisoning.&nbsp;&nbsp;</p>\n<p>Lead inhibits the enzymes delta-aminolevulinic acid (<strong>ALA</strong>)<strong> dehydratase</strong> and <strong>ferrochelatase,</strong> which are involved in heme synthesis. ALA is converted to porphobilinogen by ALA dehydratase, which is inhibited by lead. So, <strong>porphobilinogen&nbsp;</strong>levels are <strong>decreased</strong> in lead poisoning.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8fc4a1d71d2b4c55a408594aa70b8175x1280x1771.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/19582e2fc6c742eb9fd8c336727d8ba7x462x368.PNG"
    ]
  },
  {
    "text": "A bodybuilder who does strenuous exercises went to the doctor with complaints of muscle cramps. Muscle cramps are due to the accumulation of lactic acid. Which of the following cycles is responsible for preventing lactate accumulation in the muscle?",
    "choices": [
      {
        "id": 1,
        "text": "Cahill cycle"
      },
      {
        "id": 2,
        "text": "Cori's cycle"
      },
      {
        "id": 3,
        "text": "Kreb's cycle"
      },
      {
        "id": 4,
        "text": "Krebs\u2013Henseleit cycle"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Cori's cycle</strong>\u00a0is responsible for\u00a0preventing lactate accumulation in the muscle.</p>\n<p>The process of reconversion of lactate formed in the muscles, back to glucose inside the liver is called <strong>Cori's cycle. </strong><strong>Lactic acid</strong> is a metabolic byproduct formed after anaerobic glycolysis in tissues such as the <strong>skeletal muscles and erythrocytes</strong>. The lactate so formed is transported into the liver and kidney. Here, it gets reconverted back into pyruvate which can be converted to glucose. This entire process is called\u00a0<strong>Cori\u2019s\u00a0cycle </strong>or the<strong> glucose\u2013lactate cycle</strong>.</p>\n<p>Lactic acid which accumulates in the muscle after <strong>strenuous muscle exercises</strong> enter Cori's cycle. This process <strong>prevents</strong> the <strong>accumulation</strong> of lactate thereby preventing muscle cramps.</p>\n<p>Other options</p>\n<p>Option A- <strong>Cahill cycle</strong>\u00a0is also called as\u00a0<strong>glucose\u2013alanine cycle</strong>. In the fasting state, there is a significant output of alanine from muscle as it is the major substrate for gluconeogenesis. Alanine is derived from the transamination of pyruvate obtained from glycolysis. Alanine is then exported to the liver where it undergoes transamination again back to pyruvate and enters gluconeogenesis.</p>\n<p>Option C-\u00a0<strong>Krebs cycle,</strong>\u00a0also known as the<strong> citric acid cycle,</strong> is the final common oxidative pathway that oxidizes acetyl CoA to CO<sub>2</sub>. It is the source of reduced co-enzymes that provide the substrate for the respiratory chain. It also acts as the link between catabolic and anabolic pathways (amphibolic role).</p>\n<p>Option D- The <strong>Krebs-Henseleit cycle</strong> (urea<strong> </strong>cycle) is also known as the <strong>ornithine\u00a0cycle</strong>. It forms urea by detoxifying ammonia in the liver. The overall reaction may be summarized as NH<sub>3</sub> + CO<sub>2</sub> + Aspartate \u2192 <strong>Urea</strong> + Fumarate.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Gene and cellular therapy is being used to treat all of the following conditions except:",
    "choices": [
      {
        "id": 1,
        "text": "Down's syndrome"
      },
      {
        "id": 2,
        "text": "Severe combined immunodeficiency"
      },
      {
        "id": 3,
        "text": "Acute lymphoblastic leukemia"
      },
      {
        "id": 4,
        "text": "Spinal muscular atrophy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Gene and cellular therapy is being used to treat all the above-mentioned conditions except Down\u2019s syndrome.</p>\n<p><strong>Gene therapy</strong>, a revolutionary breakthrough in modern medicine, aims to introduce a <strong>missing gene</strong> or replace a <strong>defective gene</strong> in an affected individual.\u00a0</p>\n<p>The first curative effect of gene therapy was noticed with <strong>severe combined immunodeficiency </strong>(SCID). Other conditions where it can be applied include<strong> spinal muscular atrophy</strong>, transfusion-dependent <strong>beta-thalassemia</strong>, and chronic granulomatous disease.</p>\n<p>Chimeric antigen receptor (CAR) T cell therapy, a type of <strong>cellular therapy</strong> is practiced in refractory or relapsing cancers such as <strong>B cell acute lymphoblastic leukemia</strong> (ALL) and B cell lymphoma. It cannot be used in chromosomal disorders like Down\u2019s syndrome (Trisomy 21).</p>\n<p>This is generally carried out with the help of a gene delivery vehicle such as a <strong>virus</strong> or <strong>lipid nanoparticle</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A biochemist wanted to study the difference in gene expression between a cancer cell and a normal cell. He used the following method shown in the image. Identify the method.",
    "choices": [
      {
        "id": 1,
        "text": "Microarray technique"
      },
      {
        "id": 2,
        "text": "Northern blot"
      },
      {
        "id": 3,
        "text": "Southern blot"
      },
      {
        "id": 4,
        "text": "Western blot"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The method shown in the image is called\u00a0<strong>microarray</strong> analysis.\u00a0</p>\n<p>It can be used to study<strong> mutations</strong> in DNA and <strong>variations in gene expression</strong>.</p>\n<p>It consists of a slide with tiny spots of DNA called a\u00a0<strong>DNA</strong> (or gene) <strong>chip</strong>. For studying gene expression, mRNA is taken from the sample and then its complementary DNA (cDNA) is made. This cDNA from the normal cell is labeled with green fluorescence, and the cDNA from the cancer cell is labeled with red fluorescence. Then, both are allowed to hybridize with the DNA on the chip.</p>\n<p>Interpretation:</p>\n<ul>\n<li>Black spots represent no expression by both normal and cancer cells.</li>\n<li>Red spots represent more expression by the cancer cells.</li>\n<li>Green spots represent more expression by normal cells.</li>\n<li>Yellow spots represent equal expression by both cells.</li>\n</ul>\n<p>Using the microarray technique, the differing patterns of gene expression between two types of cells can be analyzed.</p>\n<p>Option B -\u00a0A <strong>northern blot</strong> only measures mRNA production from one gene at a time.<br />Option C -\u00a0<strong>Southern blot</strong> can only analyze DNA not the products of DNA expression.<br />Option d - <strong>Western blot</strong> measures protein production.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/355da0b0212546cd9c71a2c730335e0f.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 6-year-old boy was admitted to your hospital with multiple pigmented papular lesions on his face, neck, forearm, and corneal injection following the exposure to the sun as shown below.  On further investigations, cutaneous malignancies like squamous cell carcinomas and basal cell carcinoma were found. Which DNA repair mechanism is defective in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "DNA base excision repair"
      },
      {
        "id": 2,
        "text": "DNA mismatch repair"
      },
      {
        "id": 3,
        "text": "Nonhomologous end joining repair"
      },
      {
        "id": 4,
        "text": "DNA nucleotide excision repair"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical scenario of multiple lesions on the <strong>sun-exposed area</strong> and multiple <strong>cutaneous malignancies</strong> are suggestive of\u00a0<strong>Xeroderma pigmentosum.</strong> The DNA repair mechanism that is defective in this condition is <strong>n</strong><strong>ucleotide excision repair (NER).</strong></p>\n<p>Xeroderma Pigmentosum (XP) is a rare <strong>autosomal recessive</strong> genetic disorder characterized by defective DNA repair which leads to clinical and cellular hypersensitivity to ultraviolet (UV) radiation.</p>\n<p>UV radiation leads to <strong>pyrimidine dimerization</strong> in DNA strands, preventing further replication by DNA polymerase.\u00a0The nucleotide excision repair mechanism corrects the dimer formation in DNA. In XP there is an inability<span class=\"fontstyle0\">\u00a0to repair DNA pyrimidine dimers caused by UV exposure.</span></p>\n<p>In XP the skin is normal at birth. Initially, there will be diffuse erythema, scaling, and freckle lesions. As age progresses a characterized lesion called poikiloderma occurs. It consists of skin atrophy, telangiectasia, and mottled hyper and hypopigmented areas.\u00a0By the age of<strong> 4 -5 years</strong>, they present with multiple malignancies including <strong>squamous cell carcinoma</strong>, malignant melanoma, <strong>basal cell carcinoma</strong>, and fibrosarcoma.</p>\n<p>Most of the cases with XP have ocular manifestations. Initially, it appears as <strong>photophobia</strong>, <strong>conjunctivitis</strong>, ectropion, and symblepharon with ulceration.\u00a0Accumulation of pyrimidine dimer\u00a0causes <strong>corneal opacification</strong> and <strong>neovascularization</strong>. Ocular malignancies are common in the lids, conjunctiva, and cornea as they are exposed to as much as facial skin.</p>\n<p>XP is ultimately fatal, and early detection of the skin lesions and their management with prevention of UV rays exposures prolong the life.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fc50e2775ae1479caade1238b5700740.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Integrated Mini Test 5 - Biochemistry';
        const quizFilename = 'integrated-mini-test-5-biochemistry-6c7d51cf.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2024-25"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>