<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>02 Cell Death - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Pathology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">25</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which among the following is false regarding necrosis?",
    "choices": [
      {
        "id": 1,
        "text": "It is due to denaturation of protein"
      },
      {
        "id": 2,
        "text": "It is due to enzymatic digestion"
      },
      {
        "id": 3,
        "text": "It is an active process"
      },
      {
        "id": 4,
        "text": "There is swelling of cells"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Necrosis</strong> is a <strong>passive</strong> process, not active.</p>\n<p>It is due to&nbsp;<strong>denaturation of protein </strong>and<strong> enzymatic digestion.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the correct sequence of events that occur during necrosis?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3, 4"
      },
      {
        "id": 2,
        "text": "1, 4, 3, 2"
      },
      {
        "id": 3,
        "text": "2, 3, 4, 1"
      },
      {
        "id": 4,
        "text": "4, 3, 2, 1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The sequence of events in necrosis is: <strong>cellular swelling&nbsp;&rarr; pyknosis &rarr; karyorrhexis &rarr; karyolysis</strong></p>\n<p><strong>Necrosis</strong> is defined as the spectrum of morphological changes that follow cell death due to the progressive degradative action of enzymes.</p>\n<p>Morphological changes that occur in necrosis are as follows:</p>\n<p><strong>Cytoplasmic</strong> changes -</p>\n<ul>\n<li>Increased <strong>eosinophilic staining&nbsp;</strong>on H&amp;E specimens</li>\n<li><strong>Moth-eaten </strong>appearance of the cytoplasm&nbsp;- due vacuolated cytoplasmic organelles formed by enzymatic degradation</li>\n<li><strong>Glassy</strong> and <strong>homogenous </strong>cytoplasm&nbsp;- due to loss of glycogen in the cytoplasm</li>\n</ul>\n<p><strong>Nuclear </strong>changes -</p>\n<ul>\n<li><strong>Pyknosis -</strong>&nbsp;nucleus first shrinks and becomes more condensed</li>\n<li><strong>Karyorrhexis</strong><strong>&nbsp;-</strong> fragmentation of the pyknotic nucleus</li>\n<li><strong>Karyolysis</strong>&nbsp;- nucleus fades away leaving behind only the cell membrane or empty cells&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 58-year-old man was admitted with sudden, substernal chest pain radiating to his left arm. On examination, he was diaphoretic and dyspneic with an irregular pulse. Despite resuscitative measures, he died within an hour of admission. Autopsy revealed the following gross appearance of the interventricular myocardium. Which of the following microscopic changes is most likely to be present?",
    "choices": [
      {
        "id": 1,
        "text": "Liquefactive necrosis"
      },
      {
        "id": 2,
        "text": "Caseous necrosis"
      },
      {
        "id": 3,
        "text": "Fat necrosis"
      },
      {
        "id": 4,
        "text": "Coagulative necrosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario and image showing dead tissue are suggestive of&nbsp;<strong>myocardial infarction.</strong>&nbsp;It is characterized by&nbsp;<strong>coagulative necrosis.</strong></p>\n<p>In coagulative necrosis, despite cell death, the outline and <strong>architecture</strong> of the cells are <strong>preserved</strong> for a few days.&nbsp;This is because&nbsp;the cell injury is mainly due to the&nbsp;<strong>denaturation </strong>of all proteins, including&nbsp;the <strong>enzymatic</strong> <strong>proteins</strong>. This <strong>prevents</strong> the <strong>proteolysis</strong> of the dead cells.&nbsp;Ultimately, these necrotized cells are removed by phagocytosis and the lysosomal action of the enzymes of the leukocytes.</p>\n<p>Examples of coagulative necrosis:</p>\n<ul>\n<li>Ischemic injury in all organs,&nbsp;except the brain</li>\n<li>Dry gangrene</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f4422515554943ed86f080df2b4cc62c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most common cause of the following pathological change seen in the spleen?",
    "choices": [
      {
        "id": 1,
        "text": "Apoptosis"
      },
      {
        "id": 2,
        "text": "Embolization"
      },
      {
        "id": 3,
        "text": "Metastasis"
      },
      {
        "id": 4,
        "text": "Atherosclerosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows a pale,\u00a0<strong>wedge-shaped </strong>area of<strong> infarction</strong> in the spleen.</p>\n<p>An infarct is a region of ischaemic necrosis resulting from the obstruction of blood flow, typically due to occlusion of the arterial supply or venous drainage. The most common cause of solid organ infarts is <strong>thromboembolism.</strong></p>\n<p>The pattern of ischemic necrosis seen in <strong>solid organ infarction</strong> is <strong>coagulative necrosis</strong>. However, <strong>CNS infarctions </strong>are an <strong>exception</strong>. They cause <strong>liquefactive necrosis</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bfb0e5155b7645be86d72ee1d35d26e0.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 67-year-old woman died in the hospital 3 days after she was admitted with a sudden onset of right-sided weakness of her body, along with slurring of speech. An autopsy showed the following finding in the brain. What is this pathological change in this lesion?",
    "choices": [
      {
        "id": 1,
        "text": "Fibrinoid necrosis"
      },
      {
        "id": 2,
        "text": "Liquefactive necrosis"
      },
      {
        "id": 3,
        "text": "Caseous necrosis"
      },
      {
        "id": 4,
        "text": "Coagulative necrosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This clinical scenario is suggestive of a <strong>stroke</strong>, which results in <strong>ischemic injury </strong>to the brain.<strong>&nbsp;</strong>This results in <strong>liquefactive necrosis</strong>.</p>\n<p>Liquefactive necrosis refers to cell death by <strong>enzymatic degradation</strong>.&nbsp;The brain contains <strong>microglial cells, </strong>which contain<strong> many enzymes. </strong>When these cells are broken down, they release these enzymes, resulting in liquefactive necrosis.</p>\n<p>The various types of necrosis are as follows:</p>\n<table style=\"width: 334.422px;\">\n<tbody>\n<tr style=\"height: 42px;\">\n<td style=\"width: 146px; height: 42px;\">Type</td>\n<td style=\"width: 171.422px; height: 42px;\">Example</td>\n</tr>\n<tr style=\"height: 42px;\">\n<td style=\"width: 146px; height: 42px;\">Coagulative necrosis</td>\n<td style=\"width: 171.422px; height: 42px;\">Infarcts in all organs except the brain</td>\n</tr>\n<tr style=\"height: 27px;\">\n<td style=\"width: 146px; height: 27px;\">Caseous necrosis</td>\n<td style=\"width: 171.422px; height: 27px;\">Tuberculosis</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 146px; height: 36px;\">Liquefactive necrosis</td>\n<td style=\"width: 171.422px; height: 36px;\">\n<p>Abscesses</p>\n<p>Brain infarct</p>\n<p>Wet gangrene</p>\n</td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 146px; height: 26px;\">Fat necrosis</td>\n<td style=\"width: 171.422px; height: 26px;\">Pancreatitis, Breast</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 146px; height: 54px;\">Fibrinoid necrosis</td>\n<td style=\"width: 171.422px; height: 54px;\">\n<p>Vasculitis</p>\n<p>Aschoff bodies</p>\n<p>Malignant hypertension</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/06c0d3ef51de43ce93203c82c50f7b59.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The gross specimen of the pancreas from a patient who died of acute pancreatitis is shown below. What is it suggestive of?",
    "choices": [
      {
        "id": 1,
        "text": "Coagulative necrosis"
      },
      {
        "id": 2,
        "text": "Caseous necrosis"
      },
      {
        "id": 3,
        "text": "Fibrinoid necrosis"
      },
      {
        "id": 4,
        "text": "Fat necrosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given specimen shows yellow nodules with areas of chalky-white deposits, which are suggestive of&nbsp;<strong>fat necrosis.</strong></p>\n<p>Fat necrosis results from the&nbsp;<strong>release </strong>of<strong> activated pancreatic lipases</strong> into the substance of the pancreas and the peritoneal cavity. These enzymes act on surrounding tissue to release fatty acids, which then combine with calcium to produce grossly visible chalky-white areas (<strong>fat saponification</strong>).</p>\n<p>Histologic examination reveals&nbsp;foci of shadowy outlines of <strong>necrotic fat cells</strong>, with <strong>basophilic</strong> <strong>calcium</strong> <strong>deposits</strong>, surrounded by an inflammatory reaction.</p>\n<p>The various types of necrosis include:</p>\n<table style=\"width: 334.422px;\">\n<tbody>\n<tr style=\"height: 42px;\">\n<td style=\"width: 146px; height: 42px;\">Type</td>\n<td style=\"width: 171.422px; height: 42px;\">Example</td>\n</tr>\n<tr style=\"height: 42px;\">\n<td style=\"width: 146px; height: 42px;\">Coagulative necrosis</td>\n<td style=\"width: 171.422px; height: 42px;\">Infarcts in all organs except the brain</td>\n</tr>\n<tr style=\"height: 27px;\">\n<td style=\"width: 146px; height: 27px;\">Caseous necrosis</td>\n<td style=\"width: 171.422px; height: 27px;\">Tuberculosis</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 146px; height: 36px;\">Liquefactive necrosis</td>\n<td style=\"width: 171.422px; height: 36px;\">\n<p>Abscesses</p>\n<p>Brain infarct</p>\n<p>Wet gangrene</p>\n</td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 146px; height: 26px;\">Fat necrosis</td>\n<td style=\"width: 171.422px; height: 26px;\">Pancreatitis, Breast</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 146px; height: 54px;\">Fibrinoid necrosis</td>\n<td style=\"width: 171.422px; height: 54px;\">\n<p>Vasculitis</p>\n<p>Aschoff bodies</p>\n<p>Malignant hypertension</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://daily-rounds-staging.s3.amazonaws.com/uploads/cd78e14cf3bf4e898c154369db516c37.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the type of necrosis seen in the vessel wall of a patient with polyarteritis nodosa?",
    "choices": [
      {
        "id": 1,
        "text": "Fibrinoid necrosis"
      },
      {
        "id": 2,
        "text": "Gangrenous necrosis"
      },
      {
        "id": 3,
        "text": "Fat necrosis"
      },
      {
        "id": 4,
        "text": "Caseous necrosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 55\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Immune reactions involving <strong>blood vessels</strong>, as seen in the case of <strong>polyarteritis nodosa,</strong>&nbsp;usually show <strong>fibrinoid necrosis.&nbsp;</strong>Fibrinoid means&nbsp;fibrin-like.</p>\n</div>\n</div>\n</div>\n</div>\n<p>In some immune disorders, the <strong>antigen-antibody&nbsp;complexes</strong> get deposited in the blood vessels.&nbsp;These complexes result in<strong>&nbsp;complement activation </strong>(type III hypersensitivity) leading to cell injury.&nbsp;This leads to leakage of fibrin out of the blood vessel, giving a<strong> pinkish appearance</strong> around the blood vessels.</p>\n<p>Fibrinoid necrosis is seen in the following conditions:</p>\n<ul>\n<li>SLE</li>\n<li>Libman-sacks endocarditis</li>\n<li>Arthus reaction</li>\n<li>Serum sickness</li>\n<li>Polyarteritis nodosa</li>\n<li>Post-streptococcal glomerulonephritis</li>\n<li>Malignant&nbsp;hypertension</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6129a1492b5047cbab76fe9a71829f82x1280x1167.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ee88cf2f5647430cb1039339f5af1785x1280x1167.JPEG"
    ]
  },
  {
    "text": "Which of the following is involved in recognition and clearance of necrotic cells?",
    "choices": [
      {
        "id": 1,
        "text": "Inflammasome"
      },
      {
        "id": 2,
        "text": "Toll-like receptors (TLRs)"
      },
      {
        "id": 3,
        "text": "P selectin"
      },
      {
        "id": 4,
        "text": "Manoreceptor"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Inflammasomes</strong>&nbsp;are involved in the&nbsp;<strong>recognition </strong>and<strong> clearance </strong>of&nbsp;<strong>necrotic cells.</strong></p>\n<p>Inflammasomes are involved in <strong>pyroptosis</strong>, a process of programmed cell death distinct from apoptosis and necrosis. This process is dependent on <strong>caspases 1, 4, </strong>and<strong> 5</strong>&nbsp;and is responsible for killing of infected cells. It occurs in the following sequence:</p>\n<ul>\n<li>Activation of inflammasome complex by&nbsp;infected cells</li>\n<li>This causes activation of caspase-1</li>\n<li>This results in generation of IL-1, which is responsible for fever, inflammation, leukocyte recruitment</li>\n</ul>\n<p>Option B: Toll-like receptors (<strong>TLR</strong>)- recognizes molecules shared by pathogens</p>\n<p>Option C: <strong>P-selectins</strong> - an important role in the initial recruitment of WBCs at the site of inflammation &amp; in&nbsp;platelet recruitment and aggregation at the site of injury.&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In cases of cell injury, all of the following are responsible for the increased eosinophilic staining and glassy homogenous cytoplasm except:",
    "choices": [
      {
        "id": 1,
        "text": "Loss of cytoplasmic RNA"
      },
      {
        "id": 2,
        "text": "Denatured protein"
      },
      {
        "id": 3,
        "text": "Increase in glycogen particles"
      },
      {
        "id": 4,
        "text": "Loss of glycogen particles"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In <strong>cell injury</strong>, there is a <strong>loss of glycogen</strong>, which leads to a change in cytoplasmic appearance. An increase in glycogen particles is not a feature of&nbsp;cell injury.</p>\n<p>In cell injury, the following changes are seen in the <strong>cytoplasm</strong>:<strong>&nbsp;</strong></p>\n<ul>\n<li>Increased <strong>eosinophilic staining</strong> due to -\n<ul>\n<li><strong>Increase</strong> in<strong>&nbsp;denatured</strong>&nbsp;<strong>proteins&nbsp;</strong>(which bind to acidic dyes like eosin)</li>\n<li><strong>Loss </strong>of <strong>cytoplasmic RNA&nbsp;</strong>(nucleic acids bind to basic dyes like hematoxylin)&nbsp;</li>\n</ul>\n</li>\n<li><strong>Glassy, homogeneous</strong> appearance - due to loss of glycogen particles</li>\n<li>Moth-eaten appearance - vacuolated appearance due to enzymatic digestion of cytoplasmic organelles</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a true statement about apoptosis?",
    "choices": [
      {
        "id": 1,
        "text": "There is enzymatic digestion of cellular contents"
      },
      {
        "id": 2,
        "text": "It is associated with adjacent inflammation"
      },
      {
        "id": 3,
        "text": "Karyolysis is present"
      },
      {
        "id": 4,
        "text": "Plasma membrane remains intact"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The<strong> plasma membrane</strong> remains<strong> intact </strong>in <strong>apoptosis</strong>.</p>\n<p>Apoptosis&nbsp;literally means <strong>falling-off </strong>in Greek. It&nbsp;is a pathway of<strong> programmed cell death</strong>.</p>\n<div class=\"page\" title=\"Page 63\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Apoptotic cells break up into fragments called <strong>apoptotic bodies</strong>.&nbsp;These apoptotic bodies have intact plasma membrane&nbsp;but altered structures.&nbsp;Hence, they are subjected to <strong>phagocytosis</strong> without eliciting inflammation.</p>\n<p>Necrosis is an unprogrammed form of cell death that includes:</p>\n<ul>\n<li>Enzymatic digestion</li>\n<li>Adjacent inflammation</li>\n<li>Karyolysis</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not an example of physiological apoptosis?",
    "choices": [
      {
        "id": 1,
        "text": "Endometrial cell break-down during menstrual cycle"
      },
      {
        "id": 2,
        "text": "Apoptosis of M\u00fcllerian structures in male fetuses"
      },
      {
        "id": 3,
        "text": "Elimination of neutrophils after an acute inflammatory response"
      },
      {
        "id": 4,
        "text": "Atrophy in parenchymal organs following duct obstruction"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Atrophy in parenchymal organs after duct obstruction is a pathological cause of apoptosis.</p>\n<p><strong>Physiological </strong>causes of apoptosis:</p>\n<ul>\n<li>During embryogenesis<strong> -&nbsp;</strong>M&uuml;llerian inhibiting factor causing apoptosis of the <strong>Mullerian structures</strong> in the <strong>male fetus</strong></li>\n<li>Hormone-dependent apoptosis -\n<ul>\n<li><strong>Endometrial cell breakdown</strong> during the <strong>menstrual</strong> <strong>cycle</strong></li>\n<li>Regression of the lactating breast after weaning.</li>\n</ul>\n</li>\n<li>Cell loss in proliferating cell populations - turnover of cells of intestinal crypt epithelium</li>\n<li><strong>Elimination</strong> of <strong>neutrophils</strong> after an acute inflammatory response and lymphocytes at the end of an immune response</li>\n</ul>\n<p><strong>Pathological </strong>causes of apoptosis:</p>\n<ul>\n<li>DNA damage beyond repair</li>\n<li>Accumulation of misfolded proteins leads to endoplasmic reticulum stress</li>\n<li>Cell injury in certain viral infections (e.g., Councilman bodies in viral hepatitis)</li>\n<li><strong>Pathologic atrophy</strong>&nbsp;after <strong>duct obstruction</strong>&nbsp;in parenchymal organs like pancreas, parotid gland, and kidneys</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not an anti-apoptotic protein?",
    "choices": [
      {
        "id": 1,
        "text": "BCL-XL"
      },
      {
        "id": 2,
        "text": "BAX"
      },
      {
        "id": 3,
        "text": "BCL- 2"
      },
      {
        "id": 4,
        "text": "MCL-1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>BAX</strong>&nbsp;and&nbsp;<strong>BAK</strong>&nbsp;are <strong>pro-apoptotic </strong>proteins.</p>\n<p>They get inserted into the mitochondrial membrane and result in the formation of channels. This allows proteins from the inner mitochondrial membrane to leak out into the cytoplasm.</p>\n<p>On the other hand,&nbsp;<strong>antiapoptotic</strong> proteins&nbsp;of the BCL2 family, like&nbsp;<strong>BCL-2</strong>&nbsp;and <strong>BCL</strong>-<strong>XL</strong>&nbsp;limit the escape of proapoptotic mitochondrial proteins.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a stress sensor of apoptosis?",
    "choices": [
      {
        "id": 1,
        "text": "Bim"
      },
      {
        "id": 2,
        "text": "Puma"
      },
      {
        "id": 3,
        "text": "Smac"
      },
      {
        "id": 4,
        "text": "Noxa"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\"><span class=\"s1\"><strong>Smac</strong>, also known as <strong>Diablo</strong> is not a stress sensor of apoptosis. It</span><span class=\"s1\">&nbsp;is a <strong>proapoptotic protein</strong> that initiates the caspase cascade by neutralizing IAPs (physiological inhibitors of apoptosis).</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What are apoptotic bodies made up of?",
    "choices": [
      {
        "id": 1,
        "text": "Cytoplasm and organelles"
      },
      {
        "id": 2,
        "text": "Cytoplasm and nuclear fragments"
      },
      {
        "id": 3,
        "text": "Organelles and nuclear fragments"
      },
      {
        "id": 4,
        "text": "Cytoplasm, nuclear fragments and organelles"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Apoptotic bodies are made up of&nbsp;<strong>cytoplasm</strong>&nbsp;with tightly packed <strong>organelles</strong>, and <strong>nuclear fragments.</strong></p>\n<p>During apoptosis, extensive plasma membrane<strong> blebbing</strong> occurs, followed by cell fragmentation into <strong>apoptotic bodies</strong> by a process called <strong>budding</strong>.&nbsp;</p>\n<p>In apoptotic cells,&nbsp;<strong>phosphatidylserine</strong>, which&nbsp;is normally present on the inner leaflet of the plasma membrane,&nbsp;<strong>flips&nbsp;</strong>to the <strong>outer leaflet</strong>. Hence, it gets recognized by tissue macrophages and leads to <strong>phagocytosis</strong> of the apoptotic bodies.</p>\n<p><strong>Annexin V&nbsp;</strong>is a marker of apoptosis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Caspase cleaves proteins at:",
    "choices": [
      {
        "id": 1,
        "text": "Cysteine residue"
      },
      {
        "id": 2,
        "text": "Cystine residue"
      },
      {
        "id": 3,
        "text": "Aspartic acid residue"
      },
      {
        "id": 4,
        "text": "Asparagine residue"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The activation of caspases depends on a finely tuned balance between production of pro- and anti-apoptotic proteins.</p>\n<p>Two distinct <strong>pathways</strong> converge on caspase activation:</p>\n<ul>\n<li>The mitochondrial (<strong>intrinsic</strong>) pathway</li>\n<li>The death receptor (<strong>extrinsic</strong>) pathway</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2ae6c046f8e34e878ae1f038830c2ee1x1280x836.JPEG"
    ]
  },
  {
    "text": "What is the function of FLIP protein in the pathway of apoptosis?",
    "choices": [
      {
        "id": 1,
        "text": "Stimulates the extrinsic pathway"
      },
      {
        "id": 2,
        "text": "Stimulates the intrinsic pathway"
      },
      {
        "id": 3,
        "text": "Inhibits the extrinsic pathway"
      },
      {
        "id": 4,
        "text": "Inhibits the intrinsic pathway"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>FLIP</strong>&nbsp;is a cellular protein that&nbsp;<strong>inhibits</strong> the&nbsp;<strong>extrinsic pathway</strong> of apoptosis.</p>\n<p>It is a <strong>caspase antagonist</strong> that inhibits the activation of caspases involved in the extrinsic or death receptor pathway.&nbsp;Some viruses produce homologs of this protein. This may play a role in keeping infected cells alive.</p>\n<p>There are <strong>two</strong>&nbsp;<strong>pathways</strong> that can lead to caspase activation and cause <strong>apoptosis</strong> of the cell.</p>\n<table style=\"height: 112px; width: 478px;\">\n<tbody>\n<tr>\n<td style=\"width: 224px;\"><strong>Mitochondrial</strong> or&nbsp;<strong>intrinsic&nbsp;</strong>pathway</td>\n<td style=\"width: 240px;\"><strong>Death receptor</strong> or&nbsp;<strong>extrinsic&nbsp;</strong>pathway</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">Activation inside the cell&nbsp;</td>\n<td style=\"width: 240px;\">Activation outside the cell&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">\n<p>Occurs in response to:</p>\n<ul>\n<li>DNA damage</li>\n<li>Radiation</li>\n<li>Infection</li>\n</ul>\n</td>\n<td style=\"width: 240px;\">\n<p>Involved in:</p>\n<ul>\n<li>Elimination of self-reactive lymphocytes</li>\n<li>Killing of target cells by cytotoxic T-cells</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">\n<p>Involves release of pro-apoptotic proteins (BAX, BAK)</p>\n<p>They form a <strong>BAX-BAK</strong> channel&nbsp;in the mitochondrial membrane</p>\n</td>\n<td style=\"width: 240px;\">\n<p>Involves death receptors on cell surfaces (have a&nbsp;death domain)</p>\n<p>These include&nbsp;<strong>TNF-1</strong> and <strong>Fas </strong>(CD95) of the TNF family</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">\n<p>Leakage of <strong>cytochrome-c</strong> results in the formation of Cyt.c-APAF1 complex, followed by <strong>apoptosome</strong> formation</p>\n</td>\n<td style=\"width: 240px;\">\n<p><strong>FasL</strong> on T-cells binds to Fas bind adapter proteins via death domain</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">\n<p>Activation of<strong> caspase 9</strong></p>\n</td>\n<td style=\"width: 240px;\">\n<p>Activation of <strong>caspases 8</strong> and <strong>10</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 464px;\" colspan=\"2\">Both pathways converge into a common pathway that involves the activation of caspases 3, 6, 7 (executioner caspases)</td>\n</tr>\n</tbody>\n</table>\n<p>APAF-1 -&nbsp;Apoptotic peptidase activating factor-1</p>\n<p>TNF - Tumor necrosis factor</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0345eabce43c47f2a836eaba2e433507x1280x2558.JPEG"
    ]
  },
  {
    "text": "Both intrinsic and extrinsic pathways are seen in:",
    "choices": [
      {
        "id": 1,
        "text": "Apoptosis"
      },
      {
        "id": 2,
        "text": "Necrosis"
      },
      {
        "id": 3,
        "text": "Necroptosis"
      },
      {
        "id": 4,
        "text": "Pyroptosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Intrinsic</strong> and <strong>extrinsic</strong> pathways are both seen in <strong>apoptosis.</strong></p>\n<p>Apoptosis has two pathways:</p>\n<table style=\"height: 112px; width: 478px;\">\n<tbody>\n<tr>\n<td style=\"width: 224px;\"><strong>Mitochondrial</strong> or&nbsp;<strong>intrinsic&nbsp;</strong>pathway</td>\n<td style=\"width: 240px;\"><strong>Death receptor</strong> or&nbsp;<strong>extrinsic&nbsp;</strong>pathway</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">Activation inside the cell&nbsp;</td>\n<td style=\"width: 240px;\">Activation outside the cell&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">\n<p>Occurs in response to:</p>\n<ul>\n<li>DNA damage</li>\n<li>Radiation</li>\n<li>Infection</li>\n</ul>\n</td>\n<td style=\"width: 240px;\">\n<p>Involved in:</p>\n<ul>\n<li>Elimination of self-reactive lymphocytes</li>\n<li>Killing of target cells by cytotoxic T-cells</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">\n<p>Involves release of pro-apoptotic proteins (BAX, BAK)</p>\n<p>They form a <strong>BAX-BAK</strong> channel&nbsp;in the mitochondrial membrane</p>\n</td>\n<td style=\"width: 240px;\">\n<p>Involves death receptors on cell surfaces (have a&nbsp;death domain)</p>\n<p>These include&nbsp;<strong>TNF-1</strong> and <strong>Fas </strong>(CD95) of the TNF family</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">\n<p>Leakage of <strong>cytochrome-c</strong> results in the formation of Cyt.c-APAF1 complex, followed by <strong>apoptosome</strong> formation</p>\n</td>\n<td style=\"width: 240px;\">\n<p><strong>FasL</strong> on T-cells binds to Fas bind adapter proteins via death domain</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 224px;\">\n<p>Activation of<strong> caspase 9</strong></p>\n</td>\n<td style=\"width: 240px;\">\n<p>Activation of <strong>caspases 8</strong> and <strong>10</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 464px;\" colspan=\"2\">Both pathways converge into a common pathway that involves the activation of caspases 3, 6, 7 (executioner caspases)</td>\n</tr>\n</tbody>\n</table>\n<p>APAF-1 -&nbsp;Apoptosis activating factor-1</p>\n<p>TNF - Tumor necrosis factor</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6b7e94bb9c324391bc322277f32bf97fx1280x2558.JPEG"
    ]
  },
  {
    "text": "Which of the following pathological changes is represented by the marked structure seen on histopathology of a liver specimen?",
    "choices": [
      {
        "id": 1,
        "text": "Apoptosis"
      },
      {
        "id": 2,
        "text": "Granuloma formation"
      },
      {
        "id": 3,
        "text": "Abscess formation"
      },
      {
        "id": 4,
        "text": "Coagulative necrosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above histopathological image shows&nbsp;<strong>Councilman </strong>or<strong>&nbsp;</strong><strong>acidophil</strong> <strong>bodies</strong>. They represent <strong>hepatocytes</strong> undergoing <strong>apoptosis</strong>.</p>\n<p>Councilman bodies are commonly seen in <strong>acute viral hepatitis.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/68c93fb3a86d47838327634e29e6f10a.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad07a5eafb20461a9fd5daf205bd9d37x1280x1167.JPEG"
    ]
  },
  {
    "text": "Which of the following features is not true about necroptosis?",
    "choices": [
      {
        "id": 1,
        "text": "It is a form of programmed cell death"
      },
      {
        "id": 2,
        "text": "It results in cell swelling"
      },
      {
        "id": 3,
        "text": "There is caspase activation"
      },
      {
        "id": 4,
        "text": "Reduced cellular ATP levels"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Caspase activation does not occur in <strong>necroptosis.</strong>&nbsp;It is a <strong>caspase-independent</strong>&nbsp;form of&nbsp;programmed cell death.</p>\n<p><strong>Necroptosis</strong> is a <strong>programmed form</strong> of <strong>necrosis</strong>&nbsp;(which is normally an unprogrammed process). Though the activation of this pathway is similar to apoptosis, there is no&nbsp;activation of caspases, which is an important part of apoptosis.</p>\n<p>Necroptosis is triggered by the activation of TNFR1 by TNF-&alpha;. This induces&nbsp;the recruitment of RIP1 and RIP3 kinase and the formation of a <strong>necrosome</strong>. The necrosome <strong>reduces</strong> <strong>cellular</strong> <strong>ATP</strong> levels.</p>\n<p>Necroptosis occurs in the following conditions:</p>\n<ul>\n<li><strong>Pathological -&nbsp;</strong>ischemic brain injury, neurodegenerative diseases, viral infections</li>\n<li><strong>Physiological -&nbsp;</strong>formation of the mammalian bone growth plate</li>\n</ul>\n<p>The following table lists the differences between apoptosis and necroptosis:</p>\n<table style=\"width: 491.46875px;\">\n<tbody>\n<tr>\n<td style=\"width: 151px;\">Feature</td>\n<td style=\"width: 171px;\"><strong>Apoptosis</strong></td>\n<td style=\"width: 174.46875px;\"><strong>Necroptosis</strong></td>\n</tr>\n<tr>\n<td style=\"width: 151px;\">Induction stimuli</td>\n<td style=\"width: 171px;\">Oxidative stress, death receptor ligands, chemotherapy</td>\n<td style=\"width: 174.46875px;\">Viral or chemical exposure, radiation, endogenous or pathological factors</td>\n</tr>\n<tr>\n<td style=\"width: 151px;\">Morphological changes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</td>\n<td style=\"width: 171px;\">Nuclear pyknosis, membrane <strong>blebbing</strong>, generation of <strong>apoptotic</strong> <strong>bodies</strong></td>\n<td style=\"width: 174.46875px;\"><strong>Swelling of cells</strong> and organelles, loss of membrane integrity</td>\n</tr>\n<tr>\n<td style=\"width: 151px;\">Molecular changes</td>\n<td style=\"width: 171px;\">Cleavage of caspases, DNA fragmentation</td>\n<td style=\"width: 174.46875px;\">Acidosis, random DNA degradation, release of cellular proteins</td>\n</tr>\n<tr>\n<td style=\"width: 151px;\">Clearance</td>\n<td style=\"width: 171px;\">Apoptotic bodies phagocytosed by neighboring cells and macrophages</td>\n<td style=\"width: 174.46875px;\">Necrotic cells ingested by macrophages, significant inflammation</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following are true about pyroptosis except:",
    "choices": [
      {
        "id": 1,
        "text": "There is cell swelling"
      },
      {
        "id": 2,
        "text": "There is loss of membrane integrity"
      },
      {
        "id": 3,
        "text": "It is a form of programmed cell death"
      },
      {
        "id": 4,
        "text": "There is involvement of caspase 8"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Caspases 1, 4,</strong> and<strong> 5</strong> are involved in <strong>pyroptosis,</strong> not caspase 8.</p>\n<p>Pyroptosis is a form of <strong>programmed cell death</strong> that is different from apoptosis and necrosis. It is involved in the clearance of <strong>necrotic</strong> and <strong>microbe-infected cells</strong>. It occurs in the following sequence:</p>\n<ul>\n<li>Activation of the inflammasome complex</li>\n<li>Activation of caspase-1</li>\n<li>Generation of IL-1 - results in fever, inflammation, leukocyte recruitment</li>\n</ul>\n<p>Pyroptosis differs from apoptosis by the following features:</p>\n<ul>\n<li>There is <strong>cellular swelling</strong></li>\n<li>There is <strong>loss</strong> of cell <strong>membrane integrity&nbsp;</strong></li>\n<li>It is associated with inflammation&nbsp;</li>\n<li>Caspases 1, 4, and 5 are involved</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During the autopsy of a 90-year-old woman, a normal-looking liver was noted. The following microscopic appearance of hepatocytes was noted. Which of the following cellular mechanisms is likely responsible for this finding?",
    "choices": [
      {
        "id": 1,
        "text": "Nuclear pyknosis"
      },
      {
        "id": 2,
        "text": "Hypertrophy"
      },
      {
        "id": 3,
        "text": "Coagulative necrosis"
      },
      {
        "id": 4,
        "text": "Autophagocytosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given image shows brownish&nbsp;<strong>lipofuscin granules </strong>within the liver cells. It is composed of lipid-containing residues of lysosomal digestion that are formed due to <strong>autophagocytosis.</strong></p>\n<p>Lipofuscin is a wear-and-tear pigment that is due to <strong>free radical injury</strong> to the tissue. It is prominent in the liver and heart of <strong>aging</strong> patients or patients with severe <strong>malnutrition</strong> and cancer <strong>cachexia</strong>.</p>\n<p><strong>Autophagy</strong> is a process by which the cell <strong>consumes itself.</strong>&nbsp;It involves the sequestration of cellular organelles into cytoplasmic autophagic vacuoles (<strong>autophagosomes</strong>) that fuse with lysosomes, resulting in the digestion of the enclosed material. It occurs in the following conditions:</p>\n<ul>\n<li>As a survival mechanism during nutrient deprivation and stress conditions</li>\n<li>Cancers, inflammatory bowel diseases, neurodegenerative disorders - due to dysregulation&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/da0f5b808d1445af8bf47533f856d8a4.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the most reliable marker for cellular autophagy?",
    "choices": [
      {
        "id": 1,
        "text": "Atg5"
      },
      {
        "id": 2,
        "text": "RIP3"
      },
      {
        "id": 3,
        "text": "LC3"
      },
      {
        "id": 4,
        "text": "Annexin V"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\"><span class=\"s1\">Microtubule-associated protein light chain 3 (<strong>LC3</strong>) is a reliable marker for <strong>cellular autophagy.</strong>&nbsp;</span></p>\n<p class=\"p1\"><span class=\"s1\">There is increased synthesis of this molecule during autophagy. LC3 plays a role in&nbsp;</span>elongation and closure of the autophagosomal membrane.</p>\n<div class=\"page\" title=\"Page 48\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Autophagy (<strong>self-eating</strong>) is the process in which the starved cell eats its own components in an attempt to reduce nutrient demand to match the supply.</p>\n</div>\n</div>\n</div>\n</div>\n<p class=\"p1\">Option A: Atg5 protein, although associated with autophagy, is not a reliable marker as there is no differential expression during autophagy initiation.</p>\n<p class=\"p1\">Option B: RIP3 (receptor associated kinase 3) is a unique kinase involved in necroptosis.</p>\n<p class=\"p1\">Option D: Annexin V is a marker for cellular apoptosis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following forms of cell death is induced by lipid peroxidation?",
    "choices": [
      {
        "id": 1,
        "text": "Pyroptosis"
      },
      {
        "id": 2,
        "text": "Necroptosis"
      },
      {
        "id": 3,
        "text": "Ferroptosis"
      },
      {
        "id": 4,
        "text": "Programmed necrosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Ferroptosis</strong> is an iron-dependent pathway of cell death that is induced by <strong>lipid peroxidation.</strong></p>\n<p>It is triggered by&nbsp;an increase in membrane lipid peroxidation in response to the following signals:</p>\n<ul>\n<li>Excessive intracellular levels of <strong>iron</strong></li>\n<li>Reactive oxygen species (<strong>ROS</strong>)</li>\n</ul>\n<p>This leads to a <strong>loss</strong> of <strong>selective</strong> <strong>permeability</strong>&nbsp;of the plasma membrane, which ultimately leads to cell death. Unlike necrosis, the process is <strong>regulated</strong> by specific signals and can, therefore, be <strong>prevented</strong> by <strong>reducing</strong> <strong>iron</strong> levels.</p>\n<p>Ferroptosis has been linked to cell death in a variety of human pathologies including:</p>\n<ul>\n<li>Cancer</li>\n<li>Neurodegenerative diseases</li>\n<li>Stroke</li>\n</ul>\n<p>Other forms of cell death that are not dependent on lipid peroxidation include:</p>\n<ul>\n<li><strong>Necroptosis</strong>&nbsp;or&nbsp;<strong>programmed necrosis -</strong>&nbsp;programmed cell death <strong>without caspase</strong> activation</li>\n<li><strong>Pyroptosis</strong> - programmed cell death that is dependent on <strong>caspases</strong> 1, 4, and 5</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not involved in efferocytosis?",
    "choices": [
      {
        "id": 1,
        "text": "Epithelial cell"
      },
      {
        "id": 2,
        "text": "Macrophage"
      },
      {
        "id": 3,
        "text": "Fibroblast"
      },
      {
        "id": 4,
        "text": "Free radicals"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Efferocytosis</strong> is a specialized type of phagocytosis, where <strong>apoptotic bodies</strong> are phagocytosed with the help of&nbsp;<strong>macrophages, epithelial cells</strong>, and <strong>fibroblast cells.</strong></p>\n<p>During this process, ligands bind to the apoptotic bodies and send &lsquo;<strong>eat me</strong>&rsquo; <strong>signals</strong>. These signals are recognized by receptors present on phagocytes that bind and engulf these cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following diseases is not caused by an abnormal folded protein?",
    "choices": [
      {
        "id": 1,
        "text": "Alzheimer's disease"
      },
      {
        "id": 2,
        "text": "Huntington's disease"
      },
      {
        "id": 3,
        "text": "Parkinson's disease"
      },
      {
        "id": 4,
        "text": "Pompe disease"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Pompe disease&nbsp;</strong>is a <strong>glycogen</strong>&nbsp;<strong>storage </strong>disorder caused by the deficiency of lysosomal acid alpha glucosidase enzyme. It is not due to abnormal folded proteins.<strong>&nbsp;</strong></p>\n<p>During <strong>normal</strong> protein synthesis, <strong>chaperones</strong> in the endoplasmic reticulum (ER) control the <strong>proper folding</strong> of newly synthesized proteins. <strong>Misfolded</strong> polypeptides are <strong>ubiquitinated</strong> and targeted for <strong>proteolysis</strong>.&nbsp;</p>\n<p>Sometimes,&nbsp;<strong>unfolded</strong> or <strong>misfolded </strong>proteins <strong>accumulate</strong> in the ER as a result of inherited mutations or environmental stress. This induces a<strong> protective</strong>&nbsp;<strong>response</strong> called the unfolded protein response that increases&nbsp;the production of chaperones.<strong>&nbsp;</strong>This reduces the levels of misfolded proteins in the cell.&nbsp;</p>\n<p>However, when the accumulation of misfolded proteins overwhelms these adaptations, it results in<strong> ER stress</strong> which leads to the <strong>activation of caspases </strong>and, ultimately,<strong> apoptosis</strong>.</p>\n<p>Some diseases that occur due to the accumulation of abnormal folded proteins are:</p>\n<ul>\n<li>Alzheimer's disease</li>\n<li>Huntington's&nbsp;disease</li>\n<li>Parkinson's&nbsp;disease</li>\n<li>Prion diseases</li>\n<li>Amyotrophic lateral sclerosis</li>\n<li>Tay-Sachs disease</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f162eb552c0e49328430e8b8111d90cax1280x1111.JPEG"
    ]
  }
];
        let quizName = '02 Cell Death';
        let hierarchy = ["Marrow", "qBank", "Pathology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>