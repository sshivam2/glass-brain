<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrated Mini Test 4 - Physiology - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2024-25
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following events is likely to take place during the act of vomiting?",
    "choices": [
      {
        "id": 1,
        "text": "Peristaltic movements in the small intestine"
      },
      {
        "id": 2,
        "text": "Elevation of the hyoid bone"
      },
      {
        "id": 3,
        "text": "Depression of the soft palate"
      },
      {
        "id": 4,
        "text": "Breath held in expiration"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 19\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Elevation of the hyoid</strong> bone takes place during the act of vomiting.</p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;A woman has vomiting whenever she eats spicy food. Arrange the sequence of events during vomiting:\\nA. LES opens and UES closes\\nB. Strong contractions in the stomach\\nC. Inspiration against closed glottis\\nD. Relaxation of pyloric sphincter\\nE. LES opens and UES opens\\nF. Reverse peristalsis in small intestine&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:963,&quot;3&quot;:{&quot;1&quot;:0},&quot;4&quot;:{&quot;1&quot;:2,&quot;2&quot;:16777215},&quot;9&quot;:0,&quot;10&quot;:1,&quot;11&quot;:4,&quot;12&quot;:0}\">The <strong>sensory signals</strong> that initiate vomiting are located in the pharynx, oesophagus, stomach, and upper portions of the small intestines. <strong>Excessive</strong> <strong>distention</strong> or irritation of the <strong>duodenum</strong> provides a strong stimulus for vomiting. <strong>Area postrema</strong> constitutes the vomiting centre.</span></p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;A woman has vomiting whenever she eats spicy food. Arrange the sequence of events during vomiting:\\nA. LES opens and UES closes\\nB. Strong contractions in the stomach\\nC. Inspiration against closed glottis\\nD. Relaxation of pyloric sphincter\\nE. LES opens and UES opens\\nF. Reverse peristalsis in small intestine&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:963,&quot;3&quot;:{&quot;1&quot;:0},&quot;4&quot;:{&quot;1&quot;:2,&quot;2&quot;:16777215},&quot;9&quot;:0,&quot;10&quot;:1,&quot;11&quot;:4,&quot;12&quot;:0}\"><strong>Antiperistalsis,</strong> or <strong>reverse peristalsis,</strong> usually starts in the early stages of vomiting. It begins far down in the ileum and travels up to the duodenum and stomach resulting in their distention. This distention becomes the <strong>exciting factor</strong> that initiates the act of vomiting.</span></p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;A woman has vomiting whenever she eats spicy food. Arrange the sequence of events during vomiting:\\nA. LES opens and UES closes\\nB. Strong contractions in the stomach\\nC. Inspiration against closed glottis\\nD. Relaxation of pyloric sphincter\\nE. LES opens and UES opens\\nF. Reverse peristalsis in small intestine&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:963,&quot;3&quot;:{&quot;1&quot;:0},&quot;4&quot;:{&quot;1&quot;:2,&quot;2&quot;:16777215},&quot;9&quot;:0,&quot;10&quot;:1,&quot;11&quot;:4,&quot;12&quot;:0}\">The following events take place at the onset of vomiting (1) the breath is held at <strong>mid-inspiration,</strong> (2) the <strong>hyoid bone</strong> and <strong>larynx</strong> are elevated to pull the <strong>upper esophageal sphincter open,</strong> (3) <strong>closure of the glottis</strong> to prevent aspiration of vomitus into the lungs, and (4) <strong>lifting of the soft palate</strong> to <strong>close the posterior nares.\u00a0</strong></span></p>\n<p>The diaphragm then contracts strongly downward and all of the abdominal wall muscles contract simultaneously. This squeezes the stomach between the diaphragm and the abdominal muscles, raising the<strong> intra-abdominal pressure</strong> to a high level. Ultimately, the l<strong>ower oesophagal sphincter fully relaxes,</strong> enabling the stomach's contents to be <strong>expelled</strong> through the oesophagus.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old-lady with CKD presents with bilateral limb muscle weakness and fasciculations. On investigation, her serum potassium level was found to be 6 mEq/L. What is the likely mechanism to have caused her clinical features?",
    "choices": [
      {
        "id": 1,
        "text": "Resting membrane potential of nerves is hyperpolarised"
      },
      {
        "id": 2,
        "text": "Resting membrane potential is reduced"
      },
      {
        "id": 3,
        "text": "Resting membrane potential moved closer to the threshold potential"
      },
      {
        "id": 4,
        "text": "Resting membrane potential moved away from threshold potential"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of an elderly lady with CKD presenting with <strong>bilateral limb muscle weakness</strong> and <strong>fasciculations</strong> along with <strong>serum potassium </strong>levels of <strong>6 mEq/L</strong> (normal levels: 3.5-5) is suggestive of <strong>hyperkalemia</strong>.\u00a0Resting membrane potential moved<strong> closer</strong> to the <strong>threshold potential</strong> is the likely mechanism to have caused her clinical features.\u00a0</p>\n<p>Resting membrane potential (RMP) is the <strong>difference</strong> in the <strong>electrical potentials</strong> between the<strong> cytoplasm</strong> of the cell and the <strong>extracellular space</strong>.\u00a0</p>\n<p>At rest, there are more open K<sup>+</sup> channels compared to Na+ channels, thus the membrane permeability of K<sup>+</sup> is greater. As a result of this, the intracellular and extracellular K<sup>+</sup> concentrations are the major determinants of the RMP. Furthermore, the<strong> RMP is close</strong> to the <strong>equilibrium potential</strong> of <strong>K<sup>+</sup></strong>\u00a0in general.\u00a0</p>\n<p>In <strong>hyperkalemia</strong>, the extracellular level of K<sup>+</sup> is increased. Thus the RMP moves closer to the threshold to elicit an action potential leading to a <strong>more</strong> <strong>excitable nerve</strong>. The excitable nerve stimulates the muscle repeatedly causing<strong> fasciculations</strong>, exhaustion of muscle, and<strong> weakness</strong>.</p>\n<p>In <strong>hypokalemia</strong>, the extracellular level of K<sup>+</sup> is reduced. Thus the RMP is reduced and the neuron is<strong> hyperpolarized</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old man presented with resting tremors, difficulty in initiating movements, poor balance, and frequent falls. What is the site of the lesion of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Substantia nigra"
      },
      {
        "id": 2,
        "text": "Thalamus"
      },
      {
        "id": 3,
        "text": "Subthalamus"
      },
      {
        "id": 4,
        "text": "Globus pallidus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The diagnosis based on the given clinical scenario of the elderly man presenting with <strong>resting tremors</strong>, <strong>difficulty</strong> in <strong>initiating </strong>movements, <strong>poor balance</strong>, and <strong>frequent falls</strong> is suggestive of <strong>Parkinson's disease,</strong> and the site of the lesion is<strong> substantia nigra</strong>.</p>\n<p>Degeneration of substantia nigra is seen in<strong> Parkinson's disease</strong>, also known as<strong>\u00a0paralysis agitans</strong>. It shows an <strong>accumulation of synucleins</strong>. Bradykinesia, <strong>rigidity</strong>, <strong>resting tremors</strong>, and <strong>postural instability</strong> are classic features of Parkinson's disease.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Thalamus </strong>plays a role in memory, emotions, the sleep-wake cycle, and in the processing of <strong>sensory information</strong> and relaying it to the <strong>cortex</strong>. Lesions in the thalamus are seen in a multitude of disorders including <strong>vascular</strong> diseases, metabolic disorders, inflammatory diseases, and infections.</p>\n<p>Option C:\u00a0A<strong>\u00a0</strong>lesion in the <strong>subthalamic nucleus</strong> causes sudden <strong>violent involuntary,\u00a0</strong>and<strong>\u00a0flinging movements</strong>\u00a0confined to<strong>\u00a0one side\u00a0</strong>of the<strong>\u00a0body,</strong>\u00a0commonly affecting the proximal muscles of the limbs, a condition called\u00a0<strong>hemiballismus.</strong>\u00a0The movements are seen\u00a0<strong>contralateral to the side of the lesion.</strong></p>\n<p>Option D:<strong>\u00a0</strong>A lesion in the\u00a0<strong>globus pallidus</strong>\u00a0can give rise to\u00a0<strong>athetosis</strong>. This involves spontaneous and\u00a0continuous writhing movements\u00a0of the hand, arm, neck, or face.</p>\n<p>The image below shows\u00a0hemiballismus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d9bc6f77f7f24458a33402c036015213x1280x1882.JPEG"
    ]
  },
  {
    "text": "An elderly woman presents to the doctor with a 3-month history of easy fatiguability while performing day-to-day activities. On examination, she has pallor. Her hemoglobin level is 10 g/dL. Her laboratory test reports are given below.  Which of the following is true regarding the nutrient deficient in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Calcium increases its absorption"
      },
      {
        "id": 2,
        "text": "It is predominantly absorbed from the duodenum"
      },
      {
        "id": 3,
        "text": "Ascorbic acid decreases its absorption"
      },
      {
        "id": 4,
        "text": "Its uptake is mediated by divalent metal transporter type 2"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of an elderly woman presenting with <strong>easy fatiguability</strong> with pallor and laboratory features of <strong>decreased hemoglobin, serum iron, transferrin saturation, serum ferritin,</strong> and <strong>increased TIBC</strong> (total iron binding capacity), suggest <strong>iron-deficiency anemia.</strong> Iron\u00a0is predominantly absorbed from the <strong>duodenum.</strong></p>\n<p>Iron is mainly absorbed from the <strong>duodenum </strong>and<strong> proximal small intestine</strong>. The acidic contents of the stomach play a major role in its absorption. Once it reaches the brush border of the enterocyte, the ferric form is converted to the ferrous form by <strong>ferrireductase</strong>. This ferrous form is then transported into the cell by <strong>divalent metal transporter type 1 </strong>(DMT-1).</p>\n<p class=\"p1\">Once inside the\u00a0cell, iron may be <strong>stored</strong> as <strong>ferritin</strong> or transported\u00a0to plasma through\u00a0<strong>ferroportin</strong>. During the transport, iron is converted back into the ferric form by <strong>hephaestin.\u00a0</strong>The iron in plasma is transported to the required tissues by the protein <strong>transferrin.\u00a0</strong></p>\n<p class=\"p1\">Iron is a major content of<strong> hemoglobin, </strong>myoglobin, cytochrome P-450 group of enzymes, components of the electron transport chain, and ribonucleotide reductase.</p>\n<p>Iron is available in food in two forms, heme and nonheme. <strong>Heme iron</strong> is mainly present in <strong>red meat</strong> and is <strong>readily absorbed.\u00a0</strong>Several factors can increase or decrease iron absorption. <strong>Ascorbic acid increases</strong> iron absorption whereas, <strong>phytates</strong> (in bran, oats, rye fiber), <strong>polyphenols</strong> (in tea), <strong>calcium,</strong> and <strong>soy protein</strong> <strong>decrease</strong> its absorption.</p>\n<p>Therefore, a patient with anemia must be advised to consume red meat and oranges/lemons and to avoid coffee, tea, and calcium tablets while taking iron tablets.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/acda5fdbd5dd4d02a24ce182a3060cabx1279x1210.JPEG"
    ]
  },
  {
    "text": "A patient with an established diagnosis of peptic ulcer disease is started on omeprazole. Which type of cell membrane transport is inhibited by this drug?",
    "choices": [
      {
        "id": 1,
        "text": "Simple diffusion"
      },
      {
        "id": 2,
        "text": "Secondary active transport"
      },
      {
        "id": 3,
        "text": "Facilitated diffusion"
      },
      {
        "id": 4,
        "text": "Primary active transport"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Primary active transport</strong> type of cell membrane transport is inhibited by this drug.\u00a0<strong>Omeprazole</strong> is a proton pump<strong>\u00a0inhibitor</strong>\u00a0that blocks the<strong> H<sup>+</sup>-K<sup>+</sup> ATPase.\u00a0</strong>The proton pump is an example of\u00a0<strong>primary active transport.\u00a0</strong></p>\n<p>Primary active transport is an active transport mechanism that obtains energy from the<strong> hydrolysis </strong>of <strong>ATP</strong> to transport molecules against an electrochemical gradient. The transportation of the molecules mainly depends on the carrier proteins.</p>\n<p>Important examples of primary active transport:\u00a0</p>\n<ul>\n<li>Sodium-potassium ATPase</li>\n<li>Proton pump</li>\n<li>Calcium ATPase</li>\n</ul>\n<p>Proton pumps: These are essential for the primary active transport of <strong>hydrogen ions</strong>. These pumps are mainly present in <strong>gastric glands</strong> of the <strong>stomach</strong> and <strong>late distal tubules</strong> and <strong>cortical collecting ducts</strong> of the<strong> kidney</strong>.\u00a0</p>\n<p>The main function of proton pumps in the parietal cells of the stomach is to <strong>secrete gastric acid</strong>. The gastric mucosa has abundant mitochondria and this provides the ATPase that is required for the primary active transport of hydrogen ions.\u00a0</p>\n<p>At rest, the proton pumps lie within the cells in stacks of membrane compartments called <strong>tubulovesicles</strong>. During the active phase secretion, these tubulovesicles fuse to form canaliculi. This fusion increases the apical membrane of the cells and positions the proton pumps to begin the acid secretion.\u00a0</p>\n<p>Proton-pump inhibitors like omeprazole form\u00a0<strong>thiophilic sulfenamide cation\u00a0</strong>that irreversibly binds and inactivates the enzyme H<sup>+</sup>-K<sup>+</sup> ATPase.\u00a0</p>\n<p>Other options:\u00a0</p>\n<p>Option A: In <strong>simple diffusion</strong>,\u00a0the molecules pass directly through the cell membrane along the concentration gradient. It does not require energy and is\u00a0<strong>not carrier-mediated</strong>. Examples include the movement of\u00a0<strong>water, oxygen, carbon dioxide,\u00a0</strong>and<strong>\u00a0nitrogen\u00a0</strong>across the cell membrane.\u00a0</p>\n<p>Option B:\u00a0In\u00a0<strong>secondary active transport</strong>,\u00a0the transport of sodium is coupled to the transport of other substances against the concentration gradient. Examples include sodium co-transport of glucose and amino acids with sodium and sodium counter-transport of calcium and hydrogen ions.\u00a0</p>\n<p>Option C: In <strong>facilitated diffusion</strong>, the molecules are transported via <strong>carrier-mediated</strong> proteins along the concentration gradient. This transport does not require energy. Examples include the transport of glucose through GLUT (insulin-mediated transport of glucose via GLUT 4).\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "When a pheochromocytoma suddenly discharges a large amount of epinephrine into the circulation, the patient's heart rate would be expected to:",
    "choices": [
      {
        "id": 1,
        "text": "Increase because the increase in blood pressure stimulates the carotid and aortic baroreceptors"
      },
      {
        "id": 2,
        "text": "Increase because epinephrine has a direct chronotropic effect on the heart"
      },
      {
        "id": 3,
        "text": "Increase because of increased tonic parasympathetic discharge to the heart"
      },
      {
        "id": 4,
        "text": "Decrease because the increase in blood pressure stimulates the carotid and aortic chemoreceptors"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>When a pheochromocytoma suddenly discharges a large amount of epinephrine into the circulation, the patient's heart rate would be expected to increase because it has direct chronotrophic effect on heart.</p>\n<p><strong>Effect of Catecholamines on Heart</strong></p>\n<p>Both epinephrine and norepinephrine &ndash;</p>\n<ul>\n<li>Increase the force and rate of contraction of the heart by &beta;1-receptors.</li>\n</ul>\n<ul>\n<li>Increase myocardial excitability, causing extrasystoles and occasionally cardiac arrhythmias.</li>\n</ul>\n<p>The differences in the effects are given in the table below&nbsp;</p>\n<table style=\"width: 416px;\">\n<tbody>\n<tr style=\"height: 46px;\">\n<td style=\"width: 205px; height: 46px;\">\n<p><strong>Norepinephrine</strong></p>\n</td>\n<td style=\"width: 199px; height: 46px;\">\n<p><strong>Epinephrine</strong></p>\n</td>\n</tr>\n<tr style=\"height: 82px;\">\n<td style=\"width: 205px; height: 82px;\">\n<p>vasoconstriction via <strong>&alpha;1-receptors</strong></p>\n</td>\n<td style=\"width: 199px; height: 82px;\">\n<p>Vasodilatation in skeletal muscle and the liver via <strong>&beta;2-receptors.</strong>&nbsp;</p>\n</td>\n</tr>\n<tr style=\"height: 217px;\">\n<td style=\"width: 205px; height: 217px;\">\n<p>Norepinephrine -&gt; Increases systolic and diastolic blood pressures -&gt; stimulation of carotid and aortic baroreceptors -&gt; reflex bradycardia -&gt; overrides cardio acceleratory effect of norepi&shy;nephrine-&gt;cardiac output falls.</p>\n</td>\n<td style=\"width: 199px; height: 217px;\">\n<p>Epi&shy;nephrine causes a widening of the pulse pressure but because baroreceptor stimulation is insufficient to obscure the direct effect of the epinephrine on the heart, cardiac rate, and output increase.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following receptor actions of the drug best describes the rationale for adding epinephrine in cardiopulmonary resuscitation?",
    "choices": [
      {
        "id": 1,
        "text": "\u03b11 receptor\u2212mediated vasoconstriction"
      },
      {
        "id": 2,
        "text": "\u03b21 receptor\u2212mediated vasodilation"
      },
      {
        "id": 3,
        "text": "\u03b11 receptor\u2212mediated increase in renin secretion"
      },
      {
        "id": 4,
        "text": "\u03b22 receptor\u2212mediated increase in cardiac contractility"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The main effects of <strong>epinephrine</strong> in cardiac arrest are related to its <strong>\u03b11 receptor-mediated peripheral vasoconstriction</strong> resulting in the <strong>redistribution</strong> of <strong>blood flow</strong> to the <strong>brain</strong>.</p>\n<p>Additionally,<strong> \u03b21 </strong>mediated <strong>increase</strong> in <strong>cardiac contractility</strong> may also exert beneficial effects.</p>\n<p>The other options incorrectly match the receptor and its functions.</p>\n<p>Option B:<strong> </strong>The<strong> \u03b21 receptor </strong>promotes<strong> cardiac contractility </strong>and<strong> enhances renin production.</strong></p>\n<p>Option D:<strong> </strong>The<strong> \u03b22 receptor </strong>causes<strong> vasodilation.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with organophosphorus poisoning was given atropine. Which among the following effects of atropine is paired correctly with the receptor blocked to produce it?",
    "choices": [
      {
        "id": 1,
        "text": "Mydriasis- M1"
      },
      {
        "id": 2,
        "text": "Tachycardia- M2"
      },
      {
        "id": 3,
        "text": "Decreased bronchial secretions- M4"
      },
      {
        "id": 4,
        "text": "Bronchodilation- M1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Atropine </strong>causes<strong> tachycardia </strong>due to the blockade of <strong>M2 </strong>receptors in the heart <strong>inhibiting </strong>the action of <strong>acetylcholine </strong>on them.</p>\n<div class=\"page\" title=\"Page 139\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Atropine is a\u00a0<strong>muscarinic receptor antagonist.\u00a0</strong>Muscarinic antagonists block the effects of acetylcholine by binding to and inhibiting muscarinic receptors on effector cells in the peripheral ganglia and the CNS. Atropine is a competitive antagonist of the muscarinic receptors.</p>\n<p>Atropine initially\u00a0<strong>blocks</strong>\u00a0these presynaptic\u00a0<strong>M1</strong>\u00a0receptors. This increases the amount of ACh released at the SA node and causes\u00a0<strong>bradycardia.\u00a0</strong>Then, the progressive increase in the atropine concentration\u00a0<strong>blocks</strong>\u00a0the postsynaptic<strong>\u00a0M2</strong>\u00a0receptors on the SA node (decreasing the ACh release) decreasing the parasympathetic tone, thereby causing<strong>\u00a0tachycardia.</strong></p>\n<p>Other options:</p>\n</div>\n</div>\n</div>\n<p>Option A:<strong> Mydriasis </strong>is caused due to <strong>M3 </strong>(mainly) and <strong>M2 </strong>receptors.</p>\n<p>Options C and D: <strong>Decreased bronchial secretions</strong> and <strong>bronchodilatation </strong>are due to <strong>M2 </strong>and<strong> M3</strong> receptor blockade.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs act via the mechanism depicted in the illustration shown below?",
    "choices": [
      {
        "id": 1,
        "text": "4, 5 and 6"
      },
      {
        "id": 2,
        "text": "1 and 3"
      },
      {
        "id": 3,
        "text": "1, 4 and 6"
      },
      {
        "id": 4,
        "text": "2 and 4 only"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given illustration shows the <strong>G-protein-coupled receptor pathway</strong> for signalling. The drugs that function via this mechanism are <strong>dobutamine,</strong> propranolol, <strong>atropine, misoprostol,</strong> montelukast.&nbsp;</p>\n<p>Functional families of <strong>GPCRs</strong> include <strong>beta-adrenergic</strong> receptors, <strong>muscarinic cholinergic</strong> receptors, <strong>eicosanoid</strong> receptors, and <strong>thrombin</strong> receptors.</p>\n<p>G proteins act as inhibitory and excitatory because of differences in the alpha subunit.</p>\n<p>In general, Gs and Gq subtypes are excitatory whereas Gi is inhibitory.</p>\n<p><strong>Resting-state:</strong></p>\n<ul>\n<li>G protein heterotrimer consisting of alpha, beta and gamma subunits forms a complex with G-protein-coupled receptors at the intracellular domain. The extracellular domain of GPCR has the binding domain for hormones and G protein subunits do not directly bind them.<strong>&nbsp;</strong></li>\n<li><strong>The alpha subunit is bound to GDP&nbsp;</strong></li>\n</ul>\n<p><strong>Binding of ligand results in an activated state:&nbsp;</strong></p>\n<ul>\n<li>Alpha subunit undergoes a conformational change</li>\n<li>Release of GDP and binding of GTP</li>\n<li>GTP bound alpha subunit dissociates from beta-gamma subunit</li>\n<li><strong>Both alpha subunit and beta-gamma subunit </strong>bind to and <strong>regulate effectors&nbsp;only when they are separated&nbsp;</strong></li>\n</ul>\n<p>The illustration below shows the pathway.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d902400ccd9346d68492bfed78e061bb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/83e6ecc6f4954392abde621853e68007x1280x1346.JPEG"
    ]
  },
  {
    "text": "A pregnant woman with hyperemesis gravidarum is prescribed domperidone. How does this drug alleviate nausea?",
    "choices": [
      {
        "id": 1,
        "text": "Antagonism of D2 receptors in the area postrema"
      },
      {
        "id": 2,
        "text": "Antagonism of 5HT3 receptors in the vagal nerve terminals"
      },
      {
        "id": 3,
        "text": "Enhanced dopamine release in the chemoreceptor trigger zone"
      },
      {
        "id": 4,
        "text": "Agonism of the 5HT4 receptors in the gut"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In a pregnant female with<strong> hyperemesis gravidarum, domperidone </strong>alleviates nausea by<strong> antagonism of D2 receptors </strong>in the <strong>area postrema. </strong></p>\n<p>Domperidone selectively blocks dopamine D2 receptors in the <strong>area postrema</strong> and <strong>chemoreceptor trigger zone</strong> (CTZ), key areas involved in <strong>nausea </strong>and <strong>vomiting </strong>reflexes.</p>\n<p>Uses:</p>\n<ul>\n<li>Gastroparesis</li>\n<li>Nausea and vomiting</li>\n<li><strong>Hyperemesis gravidarum</strong></li>\n</ul>\n<p>Adverse Effects:</p>\n<ul>\n<li>Cardiac: Increased risk of serious <strong>ventricular arrhythmias</strong>, especially at higher doses (&gt;30mg/day) and in older adults (&gt;60 years).</li>\n<li>Neurological: <strong>Extrapyramidal symptoms</strong> (e.g., dystonia, tardive dyskinesia) mainly in individuals with pre-existing conditions.</li>\n<li>Hormonal: <strong>Elevated prolactin</strong> levels leading to galactorrhea, gynecomastia, amenorrhea, or impotence.</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: <strong>Ondansetron</strong> is a <strong>5-HT3 receptor antagonist</strong>. It blocks impulses at the peripheral origin in GIT. It is most commonly indicated for the treatment of postoperative and chemotherapy-induced nausea and vomiting. Headache and dizziness are the common adverse effects.</p>\n<p>Option C: Domperidone <strong>does not enhance dopamine release</strong> in the chemoreceptor trigger zone. Its D2 receptor blockade would be expected to decrease dopamine activity in this area.\u00a0</p>\n<p>Option D: 5HT4 stimulation of excitatory motor neurons <strong>enhances acetylcholine release</strong> at the neuromuscular junction and triggers the peristaltic reflex. The 5HT4 agonist action is shown by metoclopramide, cisapride, mosapride, itopride, and renzapride.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements regarding neonatal jaundice is true?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 4"
      },
      {
        "id": 2,
        "text": "2, 4, 5"
      },
      {
        "id": 3,
        "text": "2, 3, 5"
      },
      {
        "id": 4,
        "text": "1, 2, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The correct statements are <strong>1, 2, and 5</strong>.</p>\n<p><strong>Breastfeeding jaundice (BFJ)</strong></p>\n<ul>\n<li><strong>Exclusively breastfed</strong> infants have a <strong>different pattern</strong> of physiological jaundice as compared to <strong>artificially fed</strong> babies. (Statement 1)</li>\n<li><strong>Early-onset</strong>, unconjugated hyperbilirubinemia of breastfed infants.\u00a0</li>\n<li>Occurs in the<strong> 1st week after birth </strong>(usually<strong> appears after 24 - 72 hours </strong>of birth)\u00a0</li>\n<li>Due to decreased milk intake with dehydration and/or reduced caloric intake. (<strong>Breastfeeding failure jaundice) </strong>(Statement 2)</li>\n<li>Treatment:\u00a0Continue breastfeeding and supplementation with formula feeds if needed</li>\n</ul>\n<p><strong>Breast milk jaundice (BMJ)</strong></p>\n<ul>\n<li><strong>Late-onset</strong>, <strong>unconjugated</strong> hyperbilirubinemia of breastfed infants. (Statement 3)</li>\n<li>Occurs<strong> after the 7<sup>th</sup> day</strong> with maximal concentrations as high as 10\u201330 mg/dl reached during the 2<sup>nd</sup>-3<sup>rd</sup> week.</li>\n<li>Due to the presence of <strong>glucuronidase</strong> in breast milk (etiology not entirely clear).</li>\n<li>Treatment:<strong>\u00a0Continue breastfeeding</strong> and the bilirubin gradually decreases but <strong>may persist for 3-10 weeks</strong> at lower levels; phototherapy may be of benefit in some cases. (Statement 4)</li>\n<li>Breastfeeding is not stopped for the treatment of breast milk jaundice. (Statement 5)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-year-old boy is brought by his mother with complaints of poor growth, weakness, abnormal gait, and bowing of the legs. The head appears as seen in the image below. Laboratory investigations revealed low serum levels of vitamin D. All of the following findings can be seen in this patient except",
    "choices": [
      {
        "id": 1,
        "text": "Decrease in renal calcium excretion"
      },
      {
        "id": 2,
        "text": "Increase in renal phosphate excretion"
      },
      {
        "id": 3,
        "text": "Increase in serum alkaline phosphatase"
      },
      {
        "id": 4,
        "text": "Decrease in parathyroid hormone level"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"page\" title=\"Page 963\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>From the given scenario, the clinical features of the patient and low serum vitamin D levels point to a diagnosis of<strong>\u00a0vitamin D deficiency rickets </strong>in the patient. The image shows <strong>frontal bossing</strong>\u00a0seen in rickets. This condition is associated with an\u00a0<strong>increase </strong>in<strong>\u00a0</strong>parathyroid hormone (<strong>PTH</strong>) levels.\u00a0</p>\n<p>Nutritional rickets commonly occur due to<strong>\u00a0</strong>the<strong> deficiency of vitamin D</strong>, thereby affecting the metabolism of calcium and phosphate ions in the body.<strong> Vitamin D\u00a0</strong>is mainly synthesized by the following mechanism -</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a7002b1f81ec40a99f7d62870157a6ce.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/244b924e584d4ff0905febc9f244cab4x600x764.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0068925326e04a6cb5929d7ef06e1639x1280x1596.JPEG"
    ]
  },
  {
    "text": "A healthy woman with a normal pregnancy is being evaluated during her antenatal visit. Which of the following is likely to be seen in her thyroid profile?",
    "choices": [
      {
        "id": 1,
        "text": "Normal total T4"
      },
      {
        "id": 2,
        "text": "Normal free T3"
      },
      {
        "id": 3,
        "text": "Decreased TSH"
      },
      {
        "id": 4,
        "text": "Increased free T4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Free T3 </strong>(triiodothyronine),\u00a0<strong>free T4 </strong>(thyroxine), and<strong> TSH</strong>\u00a0(thyroid-stimulating hormone) levels <strong>remain</strong> <strong>normal</strong> during pregnancy. Therefore, <strong>normal free T3</strong> levels are likely to be seen in the thyroid profile of a healthy woman with normal pregnancy.</p>\n<p>Endocrine glands show physiological changes during pregnancy to meet the extra demands of the growing fetus. Maternal <strong>total T4 </strong>and<strong> T3</strong> levels are <strong>increased</strong> during the\u00a0<strong>early period of gestation </strong>due\u00a0to stimulation of the thyroid gland by <strong>hCG </strong>(\u03b1-subunit of hCG is similar to TSH). <strong>TSH</strong> levels in the first trimester decline slightly (but remain in the <strong>normal</strong> range).\u00a0The level of TSH is normal\u00a0during the second and third trimesters.</p>\n<p>The physiologically important <strong>free T4</strong> and <strong>free T3</strong> levels are <strong>unchanged</strong> due to the elevated levels of thyroid-binding globulin (<strong>TBG</strong>). Hence, pregnant women remain <strong>euthyroid</strong>.\u00a0</p>\n<p>The hormonal changes during pregnancy are as follows:</p>\n<table style=\"width: 449px; height: 247px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"text-align: center; width: 214px;\"><strong>Increased</strong></td>\n<td style=\"text-align: center; width: 140px;\"><strong>Decreased</strong></td>\n<td style=\"text-align: center; width: 124px;\"><strong>Unchanged</strong></td>\n</tr>\n<tr>\n<td style=\"width: 214px;\">\n<p>Growth Hormone</p>\n<p><strong>Insulin</strong> (due to <strong>insulin resistance</strong>)</p>\n<p><strong>Prolactin</strong></p>\n<p><strong>Total T3, T4</strong></p>\n<p>Aldosterone</p>\n<p>Testosterone, Androstenedione, and cortisol</p>\n</td>\n<td style=\"width: 140px;\">\n<p>LH (Luteinizing\u00a0hormone)</p>\n<p>FSH (Follicle-stimulating hormone)</p>\n<p>DHEAS (Di-hydro epiandrosterone)</p>\n</td>\n<td style=\"width: 124px;\">\n<p><strong>Free</strong> <strong>T3, T4</strong></p>\n<p><strong>TSH</strong></p>\n<p>ADH (Anti- \u00a0diuretic hormone)</p>\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"page\" title=\"Page 1\">\u00a0</div>\n<div class=\"page\" title=\"Page 1\">Plasma insulin level is increased in pregnancy due to a number of hormones that increase insulin resistance including:</div>\n<ul>\n<li><strong>Human</strong>\u00a0<strong>placental lactogen</strong>\u00a0</li>\n<li><strong>Progesterone and estrogen</strong></li>\n<li>Placental\u00a0growth hormone\u00a0</li>\n<li>Cortisol</li>\n<li>Prolactin</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the correct sequence of maturation of sperms in spermatogenesis.",
    "choices": [
      {
        "id": 1,
        "text": "2, 3, 4, 1"
      },
      {
        "id": 2,
        "text": "3, 2, 4, 1"
      },
      {
        "id": 3,
        "text": "2, 3, 1, 4"
      },
      {
        "id": 4,
        "text": "2, 4, 3, 1"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct sequence is <strong>2, 3, 4, 1.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d688c2832e3e4849b24ca05ab3e3bd1fx1280x1388.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1c4297f1621d482bae03db2c2c0518ecx1279x1541.JPEG"
    ]
  },
  {
    "text": "The structures involved in the auditory pathway are -",
    "choices": [
      {
        "id": 1,
        "text": "1, 2 and 3"
      },
      {
        "id": 2,
        "text": "1, 4 and 5"
      },
      {
        "id": 3,
        "text": "2, 3 and 4"
      },
      {
        "id": 4,
        "text": "3, 4 and 5"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The structures involved in the auditory pathway are&nbsp;<strong>1, 4, and 5,</strong> i.e, the&nbsp;<strong>superior olivary nucleus</strong>,<strong>&nbsp;medial geniculate body</strong>, and&nbsp;<strong>superior temporal gyrus</strong>.</p>\n<p>The correct sequence of structures involved in the auditory pathway from the periphery to the center is -</p>\n<ol>\n<li>Vestibulocochlear nerve</li>\n<li>Cochlear nucleus</li>\n<li><strong>Superior olivary nucleus</strong></li>\n<li><strong>Lateral lemniscus</strong></li>\n<li><strong>Inferior colliculus</strong></li>\n<li><strong>Medial geniculate body</strong></li>\n<li>Auditory cortex - <strong>superior temporal gyrus</strong></li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/21d34630f07c4f3a9d8753de74fa1220x1280x1441.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1f2cecf16b1040809c4dd31c05e16773x600x1002.JPEG"
    ]
  },
  {
    "text": "A 72-year old man presented with complaints of reduced vision in the right eye. Kinetic perimetry revealed right homonymous hemianopia. What is the most likely location of the defect in the optic pathway?",
    "choices": [
      {
        "id": 1,
        "text": "Optic chiasma"
      },
      {
        "id": 2,
        "text": "Optic tract"
      },
      {
        "id": 3,
        "text": "Optic nerve"
      },
      {
        "id": 4,
        "text": "Retina"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely defect in this patient presenting with <strong>right homonymous hemianopia</strong> is in the <strong>left optic tract.&nbsp;</strong><strong>Homonymous hemianopia</strong> involves a loss of vision on the same side of the visual field in both eyes.</p>\n<p>Other options:</p>\n<p>Option A - A lesion affecting the <strong>optic chiasma</strong> produces <strong>heteronymous hemianopia</strong>. It involves loss of vision on the opposite sides of visual fields in both eyes.&nbsp;</p>\n<p>Options C and D - Lesions of the retina and <strong>optic nerve</strong> affect the visual field of only that eye. The visual field of the opposite eye is normal.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You inject lidocaine around a sebaceous cyst prior to excising. Which of the following processes contribute to its local anesthetic action?",
    "choices": [
      {
        "id": 1,
        "text": "Only 1"
      },
      {
        "id": 2,
        "text": "1, 3 and 4"
      },
      {
        "id": 3,
        "text": "1, 2 and 4"
      },
      {
        "id": 4,
        "text": "1, 3 and 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The correct answer is <strong>1, 3 and 5.</strong></p>\n<p>The mechanisms of action of local anesthetics like lidocaine include:</p>\n<ul>\n<li><strong>Inhibition</strong> of voltage-gated <strong>Na</strong> <strong>channels</strong></li>\n<li><strong>Inhibition\u00a0</strong>(not potentiation) of <strong>K</strong> and <strong>Ca</strong>\u00a0<strong>channels</strong></li>\n<li><strong>Inhibition</strong> of Transient receptor potential vanilloid 1 (<strong>TRPV1</strong>)</li>\n</ul>\n<p>However, the <strong>main action</strong> of local anesthetics is mediated by the <strong>inhibition of voltage-gated Na channels</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "As a part of evaluation, a psychiatrist enumerates all the colors of the rainbow to his patient. The next day, when the patient was asked to recollect these colors, he was unable to recollect the 6th color. The doctor mentioned the first few letters of the color, and then the patient answered. The function of which part of the brain is evaluated here?",
    "choices": [
      {
        "id": 1,
        "text": "Striatum"
      },
      {
        "id": 2,
        "text": "Amygdala"
      },
      {
        "id": 3,
        "text": "Cerebellum"
      },
      {
        "id": 4,
        "text": "Neocortex"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the given clinical scenario,\u00a0<strong>priming</strong>\u00a0is being assessed, which depends on the functioning of the\u00a0<strong>neocortex.</strong></p>\n<p><strong>Priming</strong> is a form of <strong>nondeclarative memory</strong> that helps in recognizing words or objects to which the person was <strong>exposed previously</strong>. It is usually assessed by checking for increased reading speed, faster naming of objects, and faster recollection of getting a clue when presented with previously exposed information.</p>\n<p>Memory is usually divided into two forms:</p>\n<ul>\n<li><strong>E</strong><strong>xplicit</strong> or declarative memory is associated with <strong>consciousness</strong> or awareness.</li>\n<li><strong>Implicit</strong> or non-declarative memory does not involve awareness and its retention. It does not involve the hippocampus in its processing.</li>\n</ul>\n<p>Memory can also be classified as:</p>\n<p><strong>Short-term memory-</strong>\u00a0lasts for a<strong> few seconds</strong> to <strong>minutes</strong>. <strong>Working memory</strong> is a form of short-term memory. It keeps the information available, usually for a very short time, until the individual plans some action based on it.</p>\n<p><strong>Long-term memory</strong> can be <strong>recollected after years</strong> or even for a <strong>lifetime</strong>. These memories are stored in various parts of the <strong>neocortex.</strong> The various types of the memories such as visual, auditory, olfactory, etc., are localized to the cortical regions.</p>\n<p>Other options:</p>\n<p>Option 1: <strong>Striatum</strong> forms a part of the basal ganglia and is involved in decision-making functions, such as <strong>motor control</strong>, emotion, habit formation, and reward.</p>\n<p>Option 2: <strong>Amygdala</strong>, a component of the limbic system, is responsible for the <strong>control of emotions, behavior, </strong>and <strong>memory formation.\u00a0</strong></p>\n<p>Option 3: <strong>Cerebellum</strong> is responsible for the <strong>coordination</strong> of <strong>movement</strong>, maintaining posture and balance, muscle tone, and motor learning.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You observe that the arms of an infant extend spontaneously when the senior resident tries to elicit the following reflex by holding the infant\u2019s trunk and then suddenly lowering the infant as if he or she were falling. All the following options regarding this reflex are true, except ______.",
    "choices": [
      {
        "id": 1,
        "text": "This reflex is  a prerequisite to walking."
      },
      {
        "id": 2,
        "text": "This reflex starts to appear by 7\u20138 months of age."
      },
      {
        "id": 3,
        "text": "This reflex disappears by 18 months of postnatal period."
      },
      {
        "id": 4,
        "text": "It is a primitive reflex."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The reflex being elicited in the given scenario is the\u00a0<strong>parachute reflex</strong>,<strong>\u00a0</strong>and this reflex<strong> remains throughout life.</strong></p>\n<p>The parachute reflex can be evoked by holding the infant's trunk and then suddenly lowering it as if it were falling. This will cause the infant's arms to extend in order to break the fall. Thus, it is a <strong>prerequisite for walking</strong>. The onset of this reflex is at <strong>7-8 months of age</strong>;\u00a0it fully develops by 10-11 months and persists for life.\u00a0</p>\n<p>The parachute reflex is a <strong>primitive reflex.</strong> Primitive reflexes appear and disappear at specific times during a child's development. Any persistence or absence of these reflexes is significant for central nervous system dysfunction.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5ed4be649584467985091f1563981de8.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "In a case-control study, lung compliance of two different groups (1 and 3) was compared against that of the control group (2) and recorded as shown in the graph below. Which of the following cases likely represents groups 1 and 3, respectively?",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary emphysema and pulmonary edema"
      },
      {
        "id": 2,
        "text": "Pulmonary fibrosis and pulmonary emphysema"
      },
      {
        "id": 3,
        "text": "Pulmonary  fibrosis and pulmonary edema"
      },
      {
        "id": 4,
        "text": "Pulmonary edema and pulmonary fibrosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Graphs <strong>1</strong>\u00a0and <strong>3</strong>\u00a0correspond to <strong>decreased</strong> and<strong> increased compliance</strong>,<strong>\u00a0</strong>respectively. Among the given options,\u00a0<strong>pulmonary fibrosis</strong> is associated with decreased compliance, and\u00a0<strong>pulmonary emphysema</strong> is associated with increased compliance.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"p1\">The extent to which the lungs will expand for each unit increase in transpulmonary pressure is called <strong>lung compliance</strong>. The total compliance of both lungs together in normal, adult averages about\u00a0200 mL of air/cm H<sub><span class=\"s1\">2</span></sub>O\u00a0transpulmonary pressure.</p>\n<ul>\n<li class=\"p1\">The curve is shifted\u00a0<strong>downwards</strong>\u00a0in case of\u00a0<strong>decreased compliance</strong>.\u00a0</li>\n<li class=\"p1\">The curve is shifted\u00a0<strong>upwards</strong>\u00a0and to the left in case of <strong>increased compliance</strong>.</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2eb2c59a816d425ab3192c7e16c9b5df.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/db1d6b5f6b6847988b48ab216846028cx1279x1179.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f20ea13b2fdc4a55bef689f2825dc1bbx1280x1381.JPEG"
    ]
  }
];
        let quizName = 'Integrated Mini Test 4 - Physiology';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2024-25"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>