<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>02 Glycolysis And Gluconeogenesis - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Biochemistry
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following glucose transporter in the myocytes is under the influence of insulin?",
    "choices": [
      {
        "id": 1,
        "text": "GLUT 1"
      },
      {
        "id": 2,
        "text": "GLUT 2"
      },
      {
        "id": 3,
        "text": "GLUT 3"
      },
      {
        "id": 4,
        "text": "GLUT 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>GLUT 4\u00a0</strong>is the glucose transporter in the <strong>myocytes</strong>\u00a0under the influence of <strong>insulin.</strong></p>\n<p>Glucose transport in our body mainly occurs through sodium-independent glucose transporters, which include\u00a0<strong>GLUT</strong> transporters and to a small extent through sodium-dependent glucose transporters, which include <strong>SGLT-1</strong> and <strong>SGLT-2</strong>. Insulin induces the movement of intracellular GLUT 4 molecules to the cell surface and thus increases glucose uptake. In type 2 diabetes mellitus, membrane GLUT 4 is reduced, leading to insulin resistance in muscle and fat cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following glucose transporter is specific to the transport of fructose from the intestine to enterocytes?",
    "choices": [
      {
        "id": 1,
        "text": "GLUT 1"
      },
      {
        "id": 2,
        "text": "GLUT 3"
      },
      {
        "id": 3,
        "text": "GLUT 5"
      },
      {
        "id": 4,
        "text": "GLUT 7"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Glucose transporter specific to the transport of <strong>fructose</strong> from the intestine to enterocytes is <strong>GLUT 5. </strong>It is present in small intestine, testis, and sperm, and it primarily transports <strong>fructose</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Insulin was administered in a patient with severe hyperglycemia. This drug will stimulate glucose uptake in all the following except:",
    "choices": [
      {
        "id": 1,
        "text": "Heart"
      },
      {
        "id": 2,
        "text": "Skeletal muscle"
      },
      {
        "id": 3,
        "text": "Liver"
      },
      {
        "id": 4,
        "text": "Adipose tissue"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the <strong>liver,</strong>\u00a0the transport of glucose is through <strong>GLUT 2,</strong> which is <strong>insulin-independent</strong>.</p>\n<p><strong>Insulin-stimulated glucose uptake</strong> takes place in the heart, skeletal muscle, and adipose tissue through <strong>GLUT 4.</strong>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which glucose transporter is present in erythrocytes?",
    "choices": [
      {
        "id": 1,
        "text": "GLUT 1"
      },
      {
        "id": 2,
        "text": "GLUT 2"
      },
      {
        "id": 3,
        "text": "GLUT 3"
      },
      {
        "id": 4,
        "text": "GLUT 4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>GLUT 1\u00a0</strong>is the glucose transporter present in <strong>erythrocytes.</strong>\u00a0</p>\n<p>It mediates <strong>basal glucose uptake.</strong> GLUT 1 is also the major glucose transporter in the brain and placenta and is widely distributed.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a patient after overnight fasting, which of the following will have reduced levels of glucose transporters?",
    "choices": [
      {
        "id": 1,
        "text": "Brain cells"
      },
      {
        "id": 2,
        "text": "Adipocytes"
      },
      {
        "id": 3,
        "text": "Hepatocytes"
      },
      {
        "id": 4,
        "text": "RBCs"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Adipose tissue</strong> will have\u00a0reduced levels of glucose transporters after overnight fasting.</p>\n<p>The passive uptake of glucose by muscle and adipose tissue is catalyzed by the GLUT-4 transporter. Levels of insulin-sensitive receptor <strong>GLUT-4 decrease</strong> after <strong>overnight fasting</strong>.\u00a0</p>\n<p>In the absence of insulin, most GLUT 4 molecules are <strong>sequestered</strong> in <strong>membrane vesicles</strong> within the cell, but when blood glucose rises, the release of insulin triggers GLUT 4 movement to the plasma membrane.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false about glycolysis?",
    "choices": [
      {
        "id": 1,
        "text": "Occurs in the cytoplasm"
      },
      {
        "id": 2,
        "text": "Conversion of glucose to 3-carbon units"
      },
      {
        "id": 3,
        "text": "Complete breakdown of glucose"
      },
      {
        "id": 4,
        "text": "2 ATPs are utilized in the pathway"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>complete breakdown</strong> of glucose involves the <strong>Krebs cycle</strong> (TCA cycle), which occurs in the mitochondria, and not glycolysis.</p>\n<p>Glycolysis takes place in the\u00a0<strong>cytoplasm</strong>\u00a0of all cells. <strong>6</strong> carbon-containing glucose is converted to <strong>3</strong> carbon-containing <strong>pyruvate</strong> in aerobic and lactate in an anaerobic environment. RBC<strong> lacks mitochondria</strong> and hence completely relies on glucose for energy needs.</p>\n<p><strong>Phosphofructokinase-1 (PFK-1)</strong> is the rate-limiting enzyme in glycolysis and is involved in the conversion of fructose-6-PO4 to fructose 1,6 bisphosphate.\u00a0This is the slowest\u00a0reaction\u00a0in\u00a0glycolysis and is,\u00a0therefore,\u00a0the\u00a0<strong>rate</strong>-<strong>limiting</strong>\u00a0step. Hexokinase, PFK-1, and pyruvate kinase are involved in 3 irreversible steps of glycolysis.</p>\n<p>Net ATP from aerobic glycolysis is <strong>7 ATP</strong>. Net ATP from anaerobic glycolysis is <strong>2 ATP</strong>. 2 ATP molecules are utilized in glycolysis. Steps <strong>releasing ATP</strong> in glycolysis are as follows:</p>\n<ul>\n<li>1,3 bisphosphoglycerate to 3 phosphoglycerate</li>\n<li>Phosphoenolpyruvate to pyruvate</li>\n</ul>\n<p><strong>Inhibitors </strong>of glycolytic enzymes:</p>\n<p>\u2022 Iodoacetate inhibits glyceraldehyde 3 PO4 dehydrogenase<br />\u2022 Fluoride inhibits enolase<br />\u2022 Arsenate inhibits 1, 3 bisphosphoglycerate kinase step. Arsenic causes glycolysis to produce zero net ATP.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/09eac840c4be4b5593f6ecfaf58e45a6x1280x2966.JPEG"
    ]
  },
  {
    "text": "The step involving which of the following enzyme is reversible in glycolysis?",
    "choices": [
      {
        "id": 1,
        "text": "Enolase"
      },
      {
        "id": 2,
        "text": "Phosphofructokinase"
      },
      {
        "id": 3,
        "text": "Pyruvate kinase"
      },
      {
        "id": 4,
        "text": "Hexokinase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Enolase</strong> catalyzes the conversion of 2-phosphoglycerate to phosphoenolpyruvate, which is a <strong>reversible step</strong> of <strong>glycolysis.</strong></p>\n<p>The <strong>irreversible steps</strong> of glycolysis are catalyzed by the following enzymes:</p>\n<ul>\n<li>Hexokinase</li>\n<li>Phosphofructokinase</li>\n<li>Pyruvate kinase\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cc4951437de043529ff0159f9a351e84x1280x2966.JPEG"
    ]
  },
  {
    "text": "Which of the following substances inhibits the rate-limiting enzyme in glycolysis?",
    "choices": [
      {
        "id": 1,
        "text": "AMP"
      },
      {
        "id": 2,
        "text": "Glucose-6-PO4"
      },
      {
        "id": 3,
        "text": "Citrate"
      },
      {
        "id": 4,
        "text": "Insulin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Phosphofructokinase (PFK-1)</strong>\u00a0is the <strong>rate-limiting</strong> enzyme in glycolysis.\u00a0<strong>Citrate inhibits</strong> the PFK-1.</p>\n<p><strong>Mg2+</strong>\u00a0serves as the co-factor\u00a0for the enzyme. This step is the\u00a0<strong>committed</strong>\u00a0step of glycolysis.</p>\n<p>In general, end products of a reaction on accumulation can inhibit the forward direction progress of any reaction. Substrates and cofactors of an enzyme/reaction will stimulate a reaction/to activate the enzyme, and hence push the reaction in the forward direction.</p>\n<p><strong>Inhibitors</strong> of PFK-1: ATP, Citrate</p>\n<p>Allosteric <strong>activators </strong>of PFK-1: AMP, ADP, <strong>Fructose 2,6 bisphosphate</strong> (<strong>Most potent activator</strong>)</p>\n<p><strong>Hormonal</strong> regulation: Inducer \u2014 <strong>Insulin,</strong>\u00a0Repressor\u2014 Glucagon</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c999483a311244b0ae9c8e60c5750ad4x1280x2966.JPEG"
    ]
  },
  {
    "text": "All of the following statements about glucokinase are true in comparison to other hexokinases, except:",
    "choices": [
      {
        "id": 1,
        "text": "Higher Km value"
      },
      {
        "id": 2,
        "text": "Phosphorylates multiple hexose substrates"
      },
      {
        "id": 3,
        "text": "An inducible enzyme"
      },
      {
        "id": 4,
        "text": "Higher Vmax value"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Note: Glucokinase acts on other hexoses such as fructose, mannose too. However, in vivo, the K<sub>m</sub> for this reaction is so high that at the intracellular concentrations available, the activity is not significant. Hence, the best option has been chosen as the answer in this MCQ.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d285d5989367415e9accc0c6ad5e7da3x1280x1172.JPEG"
    ]
  },
  {
    "text": "Which of the following is the first committed step of glycolysis?",
    "choices": [
      {
        "id": 1,
        "text": "Glucose to glucose 6 PO4"
      },
      {
        "id": 2,
        "text": "Fructose 6 phosphate to Fructose 1, 6 bisphosphate"
      },
      {
        "id": 3,
        "text": "1,3 bisphosphoglycerate to 3-phosphoglycerate"
      },
      {
        "id": 4,
        "text": "Phosphoenolpyruvate to pyruvate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Fructose 6 phosphate to fructose 1,6 bisphosphate catalyzed by PFK-1 is the <strong>first commited step</strong> of glycolysis. As&nbsp;fructose 1,6 bisphosphate once formed, it<strong> cannot revert</strong> back and go into any pathway<strong> other than glycolysis</strong>.</p>\n<p>Note:&nbsp;Glucose to glucose-6-PO<sub>4</sub> is also an irreversible step catalyzed by hexokinase, but as this glucose-6-PO<sub>4</sub> can still enter the HMP shunt, it is not a step committed to glycolysis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/80d17f2c59764d7f9f8551ac297419d6x1280x2966.JPEG"
    ]
  },
  {
    "text": "Which of the following is a false statement regarding anaerobic glycolysis?",
    "choices": [
      {
        "id": 1,
        "text": "End product is lactic acid"
      },
      {
        "id": 2,
        "text": "Net production of ATP is 2"
      },
      {
        "id": 3,
        "text": "Pyruvate dehydrogenase enzyme is needed"
      },
      {
        "id": 4,
        "text": "Occurs in places like the eye lens and RBCs"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Lactate dehydrogenase</strong> enzyme is needed in <strong>anaerobic glycolysis,</strong> not pyruvate dehydrogenase.</p>\n<p>Under anaerobic conditions, pyruvate is reduced to lactate. This reaction is catalyzed by <strong>lactate dehydrogenase</strong>.</p>\n<p>Since <strong>RBC\u2019s lack mitochondria</strong>, the further reactions of pyruvate in the TCA cycle cannot take place. Hence, glycolysis in erythrocytes always ends in the formation of lactate. Also, anaerobic glycolysis is the major fate for pyruvate in the lens and cornea of the eye, kidney medulla, leukocytes, because these are all <strong>poorly vascularized</strong> structures.</p>\n<p><strong>Net ATP</strong> produced per molecule of glucose under anaerobic conditions is <strong>2.\u00a0</strong>The NADH does not contribute to the ATP production because it gets used up in the reduction of pyruvate to lactate, which need NADH.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following glycolytic enzymes catalyze the step where an inorganic phosphate is utilized?",
    "choices": [
      {
        "id": 1,
        "text": "Phosphoglyceromutase"
      },
      {
        "id": 2,
        "text": "Phosphohexose isomerase"
      },
      {
        "id": 3,
        "text": "Glyceraldehyde-3-phosphate dehydrogenase"
      },
      {
        "id": 4,
        "text": "Phosphofructokinase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Conversion of<strong> glyceraldehyde-3-phosphate to 1,3 biphosphoglycerate</strong> catalyzed by glyceraldehyde 3-phosphate dehydrogenase involves the addition of <strong>inorganic phosphate.</strong></p>\n<p>Note: The step catalyzed by phosphofructokinase utilizes ATP as a phosphate donor and not inorganic phosphate.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6c1b9a40d53d4371b77620d00751bf13x1280x2966.JPEG"
    ]
  },
  {
    "text": "Which of the following enzymes takes part in substrate-level phosphorylation in glycolysis?",
    "choices": [
      {
        "id": 1,
        "text": "Pyruvate kinase"
      },
      {
        "id": 2,
        "text": "PFK-1"
      },
      {
        "id": 3,
        "text": "Hexokinase"
      },
      {
        "id": 4,
        "text": "Pyruvate dehydrogenase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The enzyme involved in substrate-level<strong>\u00a0phosphorylation</strong> is <strong>pyruvate kinase.</strong></p>\n<p>In substrate-level phosphorylation, there is a direct generation of ATP. In glycolysis, there are two such reactions, which are examples of substrate-level phosphorylation. They are as follows:</p>\n<ul>\n<li>1,3 bisphosphoglycerate to 3-phosphoglycerate, catalyzed by the enzyme <strong>phosphoglycerate kinase</strong></li>\n<li>Phosphoenol pyruvate to pyruvate, catalyzed by <strong>pyruvate kinase\u00a0</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5923cb3ec01f490c8feafb23a69682a6x1280x2966.JPEG"
    ]
  },
  {
    "text": "How many net ATPs are generated in aerobic glycolysis?",
    "choices": [
      {
        "id": 1,
        "text": "2"
      },
      {
        "id": 2,
        "text": "7"
      },
      {
        "id": 3,
        "text": "10"
      },
      {
        "id": 4,
        "text": "9"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Net</strong> generation of <strong>ATP</strong> up to pyruvate in <strong>aerobic glycolysis</strong> is <strong>7.</strong></p>\n<p>Steps of ATP production in glycolysis:</p>\n<table style=\"height: 160px; width: 502px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 114px;\"><strong>Reaction</strong></td>\n<td style=\"width: 128px;\"><strong>Enzyme</strong></td>\n<td style=\"width: 126px;\"><strong>Method of ATP produced</strong></td>\n<td style=\"width: 116px;\"><strong>Net ATP produced</strong></td>\n</tr>\n<tr>\n<td style=\"width: 114px;\">Glyceraldehyde-3 phosphate to 1,3 bisphosphoglycerate</td>\n<td style=\"width: 128px;\">Glyceraldehyde 3 phosphate dehydrogenase</td>\n<td style=\"width: 126px;\">From 2 molecules of NADH via respiratory chain oxidation</td>\n<td style=\"width: 116px;\">5 ATP (2*2.5 per NADH)</td>\n</tr>\n<tr>\n<td style=\"width: 114px;\">1,3 bisphosphoglycerate to 3 phosphoglycerate</td>\n<td style=\"width: 128px;\">Phosphoglycerate kinase</td>\n<td style=\"width: 126px;\">Substrate-level phosphorylation</td>\n<td style=\"width: 116px;\">2 ATP</td>\n</tr>\n<tr>\n<td style=\"width: 114px;\">Phosphoenolpyruvate to pyruvate</td>\n<td style=\"width: 128px;\">Pyruvate kinase</td>\n<td style=\"width: 126px;\">substrate-level phosphorylation</td>\n<td style=\"width: 116px;\">2 ATP</td>\n</tr>\n<tr>\n<td style=\"width: 114px;\">\u00a0</td>\n<td style=\"width: 128px;\">\u00a0</td>\n<td style=\"width: 126px;\">\u00a0</td>\n<td style=\"width: 116px;\">Total = 9 ATP</td>\n</tr>\n</tbody>\n</table>\n<p>But, remember that <strong>2</strong> molecules of <strong>ATP</strong> get <strong>utilized</strong> in the previous steps of glycolysis, catalyzed by the enzymes hexokinase and PFK-1.</p>\n<p>Hence, net ATP generation in aerobic glycolysis is <strong>9-2 = 7 ATP.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are collecting a blood sample from a patient for blood glucose estimation. You put the sample in a vacutainer containing sodium fluoride. Which of the following enzyme is inhibited by this compound?",
    "choices": [
      {
        "id": 1,
        "text": "Glyceraldehyde 3 PO4 dehydrogenase"
      },
      {
        "id": 2,
        "text": "Enolase"
      },
      {
        "id": 3,
        "text": "Pyruvate kinase"
      },
      {
        "id": 4,
        "text": "1, 3 bisphosphoglycerate kinase"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span style=\"font-size: 12pt;\"><span style=\"font-size: 10pt;\">Sodium fluoride and potassium oxalate are added to the blood sample to estimate glucose.\u00a0<strong>Fluoride </strong>is an <strong>inhibitor</strong> of <strong>enolase\u00a0</strong>and hence halts the process of glycolysis. By doing so, it prevents blood glucose levels from being falsely estimated as low.\u00a0</span></span></p>\n<p><span style=\"font-size: 12pt;\"><strong><span style=\"font-size: 10pt;\">Inhibitors</span></strong><span style=\"font-size: 10pt;\"> o</span><span style=\"font-size: 10pt;\">f</span><strong><span style=\"font-size: 10pt;\"> glycolytic enzymes:</span></strong></span></p>\n<ul>\n<li><strong>Fluoride</strong> inhibits <strong>enolase</strong></li>\n<li><strong>Iodoacetate</strong> inhibits <strong>glyceraldehyde 3 PO<sub>4</sub> dehydrogenase</strong></li>\n<li><strong>Arsenate</strong> inhibits <strong>phosphoglycerate kinase\u00a0</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is fructose 2,6 bisphosphate?",
    "choices": [
      {
        "id": 1,
        "text": "Intermediate metabolite of glycolysis"
      },
      {
        "id": 2,
        "text": "Positive allosteric regulator of PFK1"
      },
      {
        "id": 3,
        "text": "Negative allosteric regulator of PFK2"
      },
      {
        "id": 4,
        "text": "Positive allosteric regulator of PFK2"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Fructose 2,6-bisphosphate</strong> is the most potent <strong>positive allosteric activator</strong> of <strong>phosphofructokinase-1</strong> and inhibitor of fructose 1, 6-bisphosphatase. It is not an intermediate of glycolysis.</p>\n<p>Fructose 2, 6-bisphosphate is formed by phosphorylation of fructose-6-phosphate by phosphofructokinase-2. It\u00a0acts as an intracellular signal, indicating that glucose is abundant and hence causes an <strong>increase </strong>in the<strong> rate of glycolysis</strong> during the<strong> well-fed state</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with anemia and hepatosplenomegaly is diagnosed with hemolytic anemia. Deficiency of which of the following glycolytic enzymes is most likely associated with this presentation?",
    "choices": [
      {
        "id": 1,
        "text": "Enolase"
      },
      {
        "id": 2,
        "text": "Pyruvate kinase"
      },
      {
        "id": 3,
        "text": "Aconitase"
      },
      {
        "id": 4,
        "text": "Phosphofructokinase-1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Deficiency</strong> of <strong>pyruvate kinase</strong> leads to <strong>hemolytic anemia.</strong></p>\n<p><strong>Erythrocytes lack mitochondria </strong>and hence generate ATP exclusively via glycolysis. In a glycolytic enzyme deficiency, there is a reduced rate of glycolysis, leading to decreased ATP production. This results in a\u00a0few <strong>alterations</strong> in the<strong> RBC membrane</strong>, thereby leading to changes in cell shape. Such deformed RBCs are later phagocytosed by cells of the reticuloendothelial system, and this results in a state of <strong>hemolytic anemia</strong>.</p>\n<p>The <strong>most common enzyme deficiency</strong> causing hemolytic anemia\u00a0is <strong>glucose-6-phosphate dehydrogenase deficiency</strong> (pentose phosphate pathway).</p>\n<p>The <strong>second most common enzyme deficiency</strong> causing hemolytic anemia is the <strong>pyruvate kinase</strong>.</p>\n<p>Note: Though hemolysis is seen in PFK-1 deficiency, it does not always manifest as anemia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Where does the Rapaport Leubering cycle occur?",
    "choices": [
      {
        "id": 1,
        "text": "Liver"
      },
      {
        "id": 2,
        "text": "RBCs"
      },
      {
        "id": 3,
        "text": "Kidney"
      },
      {
        "id": 4,
        "text": "Brain"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Rapaport Leubering cycle:</strong></p>\n<ul>\n<li><strong>1, 3-Bisphosphoglycerate</strong> is converted to <strong>2, 3-bisphosphoglycerate</strong> by the action of the enzyme bisphosphoglycerate mutase. 2, 3-BPG is present at high concentration in RBCs and serves to increase O<sub>2</sub> delivery. 2, 3-BPG decreases the O<sub>2</sub> affinity of hemoglobin by binding to deoxyhemoglobin and shifts the O<sub>2</sub>-Hb dissociation curve to the right. Hence, there is more oxygen release in conditions like hypoxia. \u00a0\u00a0\u00a0\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0</li>\n<li><strong>2,3-bisphosphoglycerate</strong> is hydrolyzed to <strong>3-phosphoglycerate</strong>\u00a0and Pi by 2,3-bisphosphoglycerate phosphatase and no ATP is generated.</li>\n</ul>\n<p>Since the reaction catalysed by 1, 3- Bisphosphoglycerate kinase is bypassed, no ATPs are produced in that step. Only 2 ATPs are generated by the pyruvate kinase step and 2 ATPs are utilized in the steps catalyzed by hexokinase and PFK-1. Anaerobic glycolysis takes place due to the absence of mitochondria. So this pathway yields\u00a0<strong>no net generation of ATP\u00a0</strong>from glycolysis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a443bb5c6e0742998b5d1ef28705c6a6x1280x461.JPEG"
    ]
  },
  {
    "text": "Which of the following pathways act as a major energy source for cancer cells?",
    "choices": [
      {
        "id": 1,
        "text": "Glycolysis"
      },
      {
        "id": 2,
        "text": "Oxidative phosphorylation"
      },
      {
        "id": 3,
        "text": "Krebs cycle"
      },
      {
        "id": 4,
        "text": "\u03b2-oxidation of fatty acids"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Cancer cells</strong> derive energy mainly from <strong>glycolysis.</strong></p>\n<p>Cancer cells utilize large amounts of glucose and metabolize it to <strong>lactic acid</strong>, even in the presence of oxygen. This effect was termed the <strong>Warburg effect.\u00a0</strong></p>\n<p>The increased rate of glycolysis is due to certain defects in the mitochondrial electron transport chain. Besides, this enhanced glycolysis enables the cancer cells to proliferate in the reduced oxygen tension conditions, which is seen in tumors. This <strong>switch</strong> from <strong>aerobic to anaerobic</strong> glucose metabolism also acts as an impetus to tumorigenesis.</p>\n<p>The increased glucose consumption is used as a carbon source for anabolic processes needed to support cell proliferation such as the de novo generation of nucleotides, lipids, and proteins. Also, the major isoenzyme of pyruvate kinase in cancer cells is <strong>PK-2</strong> (in contrast to PK-1 in normal cells), which appears to play a role in the Warburg effect.</p>\n<p>Note: This effect is the basis for detecting cancers by FDG-PET scanning.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following tissues does gluconeogenesis take place?",
    "choices": [
      {
        "id": 1,
        "text": "Mature RBC's"
      },
      {
        "id": 2,
        "text": "Kidney"
      },
      {
        "id": 3,
        "text": "Adipocytes"
      },
      {
        "id": 4,
        "text": "Myocyte"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The<strong> liver</strong> and<strong> kidney</strong> are the two major locations where <strong>gluconeogenesis</strong> takes place.</p>\n<p>During <strong>short periods</strong> of <strong>fasting</strong>, most gluconeogenesis takes place in the <strong>liver,</strong> while the remaining takes place in the kidneys. However, during periods of <strong>prolonged fasting</strong>, the kidneys become a major site of gluconeogenesis.</p>\n<p>Gluconeogenesis is the process of synthesizing glucose or glycogen from non-carbohydrate precursors. It occurs in <strong>cytosol</strong> and<strong> mitochondria </strong>of the liver and kidney. Significant substrates are<strong> glucogenic amino acids, lactate, glycerol,</strong> and<strong> propionate.</strong></p>\n<p>Lactate generated in various tissues is transported to the liver and is converted back to pyruvate and enters gluconeogenesis. This pathway is referred to as <strong>Cori\u2019s cycle.\u00a0</strong>The Glucose-alanine cycle is referred to as the\u00a0<strong>Cahill cycle.</strong></p>\n<p>Muscle cannot participate in gluconeogenesis since it lacks glucose-6-phosphatase.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/527f070d97d3456abedf77ff23df65bbx1126x1292.PNG"
    ]
  },
  {
    "text": "Which of the following is not a substrate for gluconeogenesis?",
    "choices": [
      {
        "id": 1,
        "text": "Glucogenic amino acids"
      },
      {
        "id": 2,
        "text": "Propionate"
      },
      {
        "id": 3,
        "text": "Glycerol"
      },
      {
        "id": 4,
        "text": "Acetyl CoA"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Acetyl CoA</strong> is not a substrate for gluconeogenesis. Instead, it enters\u00a0the<strong> Krebs cycle</strong> for<strong> oxidative phosphorylation.</strong></p>\n<p>The following serve as substrates for gluconeogenesis:</p>\n<ul>\n<li><strong>Glucogenic amino acids</strong>, alanine being the major contributor (alanine is the source of pyruvate). Glucogenic amino acids are converted into pyruvate, oxaloacetate, succinyl CoA, and alpha-ketoglutarate to enter gluconeogenesis and the Krebs cycle at various points.</li>\n<li>Lactate</li>\n<li>Pyruvate</li>\n<li><strong>Glycerol</strong></li>\n<li><strong>Propionate</strong> (ruminants)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the process of reconversion of lactate formed in the muscles and RBC\u2019s, back into glucose inside the liver called?",
    "choices": [
      {
        "id": 1,
        "text": "Cahill cycle"
      },
      {
        "id": 2,
        "text": "Cori cycle"
      },
      {
        "id": 3,
        "text": "Kreb's cycle"
      },
      {
        "id": 4,
        "text": "Dicken-Horecker cycle"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The process of reconversion of lactate formed in the muscles\u00a0and RBCs, back into glucose inside the liver is called\u00a0<strong>Cori's cycle. </strong></p>\n<p><strong>Lactic acid</strong> is a metabolic byproduct formed after glycolysis in tissues such as the <strong>skeletal muscles</strong> and<strong> RBCs</strong>. The lactate so formed is transported into the liver and kidney. Here, it gets reconverted back into glucose. This entire process is called\u00a0<strong>Cori\u2019s\u00a0cycle </strong>or the <strong>glucose\u2013lactate cycle</strong>.</p>\n<p><strong>Cahill cycle</strong>\u00a0is also called as\u00a0<strong>glucose\u2013alanine cycle</strong>. In the fasting state, there is a significant output of alanine from skeletal muscle obtained from glycolysis of muscle glycogen. Alanine is derived from the transamination of pyruvate obtained from glycolysis. Alanine is then exported to the liver where it undergoes transamination again back to pyruvate and enters gluconeogenesis.</p>\n<p>Note:\u00a0<strong>Pentose phosphate pathway</strong> is otherwise known as <strong>Warburg-Dickens-Horecker Cycle</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following organ pairs is involved in the Cahill cycle?",
    "choices": [
      {
        "id": 1,
        "text": "Liver and Muscle"
      },
      {
        "id": 2,
        "text": "Liver and Kidney"
      },
      {
        "id": 3,
        "text": "Muscle and Kidney"
      },
      {
        "id": 4,
        "text": "Brain and Liver"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> liver</strong> and <strong>muscle</strong> are involved in the\u00a0<strong>Cahill cycle</strong>.</p>\n<p>During periods of fasting, there is the production of alanine in the skeletal muscles, which is formed by transamination reactions from pyruvate. This alanine is shunted out into the circulation, and later on into the liver. Here in the liver, another round of transamination takes place, and the alanine is reconverted back into pyruvate. This pyruvate serves as a substrate for gluconeogenesis. This entire pathway has been called as the <strong>Cahill\u2019s cycle</strong>\u00a0or the <strong>glucose\u2013alanine pathway</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Malate shuttle is important in which of the following processes?",
    "choices": [
      {
        "id": 1,
        "text": "Glycolysis only"
      },
      {
        "id": 2,
        "text": "Gluconeogenesis and glycolysis"
      },
      {
        "id": 3,
        "text": "Glycogenolysis"
      },
      {
        "id": 4,
        "text": "Glycogen synthesis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Malate shuttle</strong> is important in both,&nbsp;<strong>gluconeogenesis</strong> and<strong> glycolysis.</strong></p>\n<p class=\"p1\">Malate shuttle is a biochemical system for <strong>translocating impermeable</strong> <strong>electrons (NADH)</strong> or <strong>substrates (oxaloacetate)</strong>, in the form of a <strong>permeable</strong> substance,&nbsp;<strong>malate.</strong>&nbsp;The semipermeable inner mitochondrial membrane is permeable to malate.</p>\n<p class=\"p2\">In <strong>glycolysis</strong>, the impermeable <strong>NADH</strong> produced in the cytosol (of liver and cardiac cells) are taken up into mitochondria in the form of malate for oxidation via malate shuttle.</p>\n<p class=\"p2\">In <strong>gluconeogenesis</strong>, pyruvate in the mitochondria generates impermeable <strong>oxaloacetate</strong><strong>,&nbsp;</strong>which is <strong>converted</strong> to <strong>aspartate</strong> and&nbsp;translocated to the cytosol <strong>via malate shuttle</strong> for the synthesis of glucose.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a repressor of the enzyme pyruvate carboxylase?",
    "choices": [
      {
        "id": 1,
        "text": "Cortisol"
      },
      {
        "id": 2,
        "text": "Glucagon"
      },
      {
        "id": 3,
        "text": "Insulin"
      },
      {
        "id": 4,
        "text": "Adrenaline"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Insulin</strong> is a <strong>repressor</strong> of the enzyme pyruvate carboxylase. Since<strong>\u00a0pyruvate carboxylase</strong> is a gluconeogenic enzyme, its activity is <strong>increased</strong> during <strong>fasting</strong> and <strong>decreased </strong>following<strong>\u00a0</strong>carbohydrate <strong>feeds.</strong></p>\n<table style=\"height: 190px; width: 325px;\">\n<tbody>\n<tr>\n<td style=\"width: 316.354px;\" colspan=\"2\"><strong>Factors influencing pyruvate carboxylase</strong></td>\n</tr>\n<tr>\n<td style=\"width: 122.222px;\"><strong>Inducers</strong></td>\n<td style=\"width: 188.819px;\">Glucocorticoids Glucagon Epinephrine</td>\n</tr>\n<tr>\n<td style=\"width: 122.222px;\"><strong>Repressor</strong></td>\n<td style=\"width: 188.819px;\">Insulin</td>\n</tr>\n<tr>\n<td style=\"width: 122.222px;\"><strong>Activator</strong></td>\n<td style=\"width: 188.819px;\">Acetyl CoA</td>\n</tr>\n<tr>\n<td style=\"width: 122.222px;\"><strong>Inhibitor</strong></td>\n<td style=\"width: 188.819px;\">ADP</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c74b963c16d746129126dfefc247ce07x710x214.GIF"
    ]
  },
  {
    "text": "All of the following enzymes are involved in gluconeogenesis except:",
    "choices": [
      {
        "id": 1,
        "text": "Phosphoglucomutase"
      },
      {
        "id": 2,
        "text": "Fructose 1,6 bisphosphatase"
      },
      {
        "id": 3,
        "text": "Pyruvate carboxylase"
      },
      {
        "id": 4,
        "text": "Phosphoglycerate kinase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Phosphoglucomutase enzyme is not involved in gluconeogenesis.</p>\n<p><strong>Phosphoglucomutase</strong> catalyzes the conversion of glucose-6-phosphate to glucose-1-phosphate, which is important for the<strong> synthesis</strong> of<strong> UDP glucose</strong>. This is essential for <strong>glycogen synthesis, glycogenolysis,</strong> and&nbsp;the<strong> uronic acid pathway</strong>.</p>\n<p>Option B:&nbsp;<strong>Fructose-1,6-bisphosphatase</strong> is an <strong>irreversible enzyme</strong>&nbsp;in gluconeogenesis and mediates the conversion of fructose-1,6-bisphosphate&nbsp;&rarr; fructose-6-phosphate (cytosol)</p>\n<p>Option C:&nbsp;Pyruvate carboxylase&nbsp;is an <strong>irreversible enzyme</strong>&nbsp;in gluconeogenesis&nbsp;and mediates the conversion of pyruvate&nbsp;&rarr; oxaloacetate in mitochondria.</p>\n<p>Option D:&nbsp;Phosphoglycerate kinase is a&nbsp;<strong>reversible enzyme&nbsp;</strong>in gluconeogenesis&nbsp;and mediates the conversion of 3-phosphoglycerate&nbsp;&rarr; 1,3 biphosphoglycerate.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ee4f62d6af874884a82e93a83aa6306ax960x540.JPEG"
    ]
  },
  {
    "text": "Which of the following is a step in the gluconeogenic pathway?",
    "choices": [
      {
        "id": 1,
        "text": "Pyruvate to Lactate"
      },
      {
        "id": 2,
        "text": "Glucose-6-PO4 to Fructose-6-PO4"
      },
      {
        "id": 3,
        "text": "Pyruvate to Acetyl CoA"
      },
      {
        "id": 4,
        "text": "Oxaloacetate to Phosphoenolpyruvate"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Option A: Pyruvate to lactate is a step in anaerobic glycolysis.</p>\n<p>Option B: Glucose 6 phosphate to fructose 6 phosphate is a step in glycolysis.</p>\n<p>Option C: Pyruvate to acetyl CoA is an anaerobic step in the oxidation of glucose.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ab6287d4c3344460a3cda715d9451c74x600x1200.JPEG"
    ]
  },
  {
    "text": "Which of the following is not seen in low insulin-glucagon ratio?",
    "choices": [
      {
        "id": 1,
        "text": "Glycogen breakdown"
      },
      {
        "id": 2,
        "text": "Ketogenesis"
      },
      {
        "id": 3,
        "text": "Glycogen storage"
      },
      {
        "id": 4,
        "text": "Gluconeogenesis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A<strong> low insulin/glucagon ratio</strong> indicates low insulin and high glucagon levels, which are observed in the\u00a0<strong>fasting</strong> state. In the fasting state, all of the above processes (i.e., glycogen breakdown, ketogenesis, and gluconeogenesis) occur, but not glycogen storage.</p>\n<table style=\"width: 364px;\">\n<tbody>\n<tr>\n<td style=\"width: 122px;\">\n<p><strong>Metabolic process</strong></p>\n</td>\n<td style=\"width: 124px;\">\n<p><strong>Fasting state/ low insulin-glucagon ratio</strong></p>\n</td>\n<td style=\"width: 106px;\">\n<p><strong>Fed state/ high insulin-glucagon ratio </strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">\n<p>Gluconeogenesis</p>\n</td>\n<td style=\"width: 124px;\">\n<p>Increased</p>\n</td>\n<td style=\"width: 106px;\">\n<p>Decreased</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">\n<p>Glycogenolysis</p>\n</td>\n<td style=\"width: 124px;\">\n<p>Increased</p>\n</td>\n<td style=\"width: 106px;\">\n<p>Decreased</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">\n<p>Ketogenesis</p>\n</td>\n<td style=\"width: 124px;\">\n<p>Increased</p>\n</td>\n<td style=\"width: 106px;\">\n<p>Decreased</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">\n<p>Glycogen storage</p>\n</td>\n<td style=\"width: 124px;\">\n<p>Decreased</p>\n</td>\n<td style=\"width: 106px;\">\n<p>Increased</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following enzyme activity decreases in fasting?",
    "choices": [
      {
        "id": 1,
        "text": "Hormone-sensitive lipase"
      },
      {
        "id": 2,
        "text": "Glycogen phosphorylase"
      },
      {
        "id": 3,
        "text": "Pyruvate carboxylase"
      },
      {
        "id": 4,
        "text": "Phosphofructokinase 1"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>During<strong> fasting</strong>, there is<strong> low insulin,</strong> and hence, the activity of <strong>phosphofructokinase-1</strong> gets<strong> inhibited. </strong></p>\n<p>Phosphofructokinase 1 is an enzyme of glycolysis. It is induced by insulin and a well-fed state.</p>\n<p>Other options:\u00a0</p>\n<p>Option A:\u00a0Hormone-sensitive lipase mobilizes stored fats in a fasting state.</p>\n<p>Option B:\u00a0<strong>Glycogen phosphorylase</strong> is active in <strong>fasting</strong> state so as to produce glucose from glycogen.</p>\n<p>Option C:\u00a0<strong>Pyruvate carboxylase</strong> is an enzyme of gluconeogenesis. During the fasting state, the liver is flooded with fatty acids mobilized from adipose tissue. The resulting elevated hepatic acetyl CoA activates pyruvate carboxylase. Other enzymes of gluconeogenesis that are elevated in fasting include Phosphoenolpyruvate carboxykinase, Fructose-1,6-bisphosphatase, and Glucose-6-phosphatase.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Enzyme activated by a decrease in insulin: glucagon ratio is:",
    "choices": [
      {
        "id": 1,
        "text": "Glucokinase"
      },
      {
        "id": 2,
        "text": "Hexokinase"
      },
      {
        "id": 3,
        "text": "Phosphofructokinase"
      },
      {
        "id": 4,
        "text": "Glucose 6-phosphatase"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Enzyme activated by a decrease in insulin: glucagon ratio is<strong>\u00a0glucose 6-phosphatase.</strong></p>\n<p>A <strong>decrease</strong> in <strong>insulin: glucagon ratio</strong> is seen in <strong>fasting state</strong>, in which there is the activation of gluconeogenesis and inhibition of glycolysis.</p>\n<p>Among the given options, only glucose 6-phosphatase is an enzyme of gluconeogenesis and therefore is activated. The enzymes mentioned as other options are irreversible enzymes of\u00a0glycolysis and are inhibited in the fasting state.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1c428914beaf486b8890abaf1c2d2055x1280x2966.JPEG"
    ]
  }
];
        let quizName = '02 Glycolysis And Gluconeogenesis';
        let hierarchy = ["Marrow", "qBank", "Biochemistry"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>