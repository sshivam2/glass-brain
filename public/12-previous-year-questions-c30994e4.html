<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12 Previous Year Questions - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Orthopedics
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">9</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>A football player had a twist in the ankle and knee. Clinically, no bony injury was appreciated. The examiner is performing a test to assess the knee joint. Which test is this?</p>\n\n<p><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"427\" src=\"https://image.prepladder.com/content/f8BRzTDBAaw98foC8RvD1724837997.png\" width=\"681\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Posterior drawer for PCL"
      },
      {
        "id": 2,
        "text": "Mc Murray"
      },
      {
        "id": 3,
        "text": "Lachman"
      },
      {
        "id": 4,
        "text": "Anterior drawer for ACL"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Option C -</strong> <strong>Lachman Test</strong>:</p>\n\n<ul>\n\t<li>This test evaluates the <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> <span class=\"customMeta\" data-dictid=\"0faa43e76516927771851bff22a1e2\">cruciate</span> <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> (ACL) by assessing the stability of the knee. With the knee flexed at approximately 20-30 degrees, the examiner stabilizes the <span class=\"customMeta\" data-dictid=\"512283ec9816927772024c89478b7d\">femur</span> with one hand and pulls the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> forward with the other. Increased forward movement of the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> relative to the <span class=\"customMeta\" data-dictid=\"512283ec9816927772024c89478b7d\">femur</span> indicates ACL injury.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Incorrect OptionS:</strong></p>\n\n<p><strong>Option A -</strong> <strong>Posterior Drawer for PCL</strong>:</p>\n\n<ul>\n\t<li>This test assesses the integrity of the <span class=\"customMeta\" data-dictid=\"a5c6cb079d16927771967e62ffee72\">posterior</span> <span class=\"customMeta\" data-dictid=\"0faa43e76516927771851bff22a1e2\">cruciate</span> <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> (PCL). The examiner applies a <span class=\"customMeta\" data-dictid=\"a5c6cb079d16927771967e62ffee72\">posterior</span> force to the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> while the patient is in a <span class=\"customMeta\" data-dictid=\"b0976ea1fd16927771995d5c700a21\">supine</span> position with the knee flexed. A positive test shows excessive <span class=\"customMeta\" data-dictid=\"a5c6cb079d16927771967e62ffee72\">posterior</span> movement of the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> relative to the femur, indicating PCL injury.</li>\n</ul>\n\n<p><strong>Option B -</strong> <strong>McMurray Test</strong>:</p>\n\n<ul>\n\t<li>This test is used to assess <span class=\"customMeta\" data-dictid=\"ddb3fc5499169277719282f6100904\">meniscal</span> tears. The examiner rotates the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> while the knee is flexed and extended. Pain or a \"click\" during this <span class=\"customMeta\" data-dictid=\"220efc126c169277719138aa9a5537\">maneuver</span> suggests a <span class=\"customMeta\" data-dictid=\"ddb3fc5499169277719282f6100904\">meniscal</span> tear, but it is not specific for <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> injuries.</li>\n</ul>\n\n<p><strong>Option D -</strong> <strong>Anterior Drawer for ACL</strong>:</p>\n\n<ul>\n\t<li>This test is also used to assess the ACL. The patient lies <span class=\"customMeta\" data-dictid=\"b0976ea1fd16927771995d5c700a21\">supine</span> with the knee flexed at 90 degrees. The examiner pulls the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> forward while stabilizing the femur. Increased <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> movement of the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> relative to the <span class=\"customMeta\" data-dictid=\"512283ec9816927772024c89478b7d\">femur</span> indicates ACL injury.</li>\n</ul>",
    "question_images": [
      "https://image.prepladder.com/content/f8BRzTDBAaw98foC8RvD1724837997.png"
    ],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A counterforce brace is used in?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Tennis elbow"
      },
      {
        "id": 2,
        "text": "Ankle sprain"
      },
      {
        "id": 3,
        "text": "Ulnar claw hand"
      },
      {
        "id": 4,
        "text": "Foot drop"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Tennis elbow</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>A counterforce <span class=\"customMeta\" data-dictid=\"ea9813b91c169277718305c8fe4777\">brace</span> is primarily used for treating <span class=\"customMeta\" data-dictid=\"bfe689a0b21692777200b9437fa418\">tennis elbow</span> (lateral epicondylitis). It helps reduce the strain on the tendons by applying pressure to the forearm, which relieves pain and allows the muscles to rest.</li>\n</ul>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p style=\"text-align: center;\"><strong>Lateral <span class=\"customMeta\" data-dictid=\"46415c09ef1692777187f6fdf3b4f4\">epicondylitis</span> (Tennis elbow)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Definition</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>A condition characterized by pain and <span class=\"customMeta\" data-dictid=\"169e1c9eb416927772006ea5a02252\">tenderness</span> at the <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> <span class=\"customMeta\" data-dictid=\"9cdc5a92a216927771870d4b257a80\">epicondyle</span> of the <span class=\"customMeta\" data-dictid=\"a547f4a22716927771897daf6b50e7\">humerus</span> due to non-specific <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> at the origin of the <span class=\"customMeta\" data-dictid=\"45f9bc42ac16927771871c9dc2970a\">extensor</span> muscles of the forearm</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Causes</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Overuse of <span class=\"customMeta\" data-dictid=\"45f9bc42ac16927771871c9dc2970a\">extensor</span> muscles</li>\n\t\t\t\t<li>Repetitive activities (e.g., tennis, typing, using mouse)</li>\n\t\t\t\t<li>Non-specific <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> at muscle origin</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Clinical Features</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Pain and <span class=\"customMeta\" data-dictid=\"169e1c9eb416927772006ea5a02252\">tenderness</span> precisely <span class=\"customMeta\" data-dictid=\"8fb8df140b1692777191702bbc9358\">localized</span> to the <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> <span class=\"customMeta\" data-dictid=\"9cdc5a92a216927771870d4b257a80\">epicondyle</span> of the humerus</li>\n\t\t\t\t<li>Pain aggravated by extending the wrist against resistance</li>\n\t\t\t\t<li>Normal <span class=\"customMeta\" data-dictid=\"fd0c8ab494169277720227102dc79a\">X-ray</span> findings</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Tests</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Cozen's test:</strong> Also known as the resisted wrist extension test or <span class=\"customMeta\" data-dictid=\"8459151fee1692777197d1ac765aa0\">resistive</span> <span class=\"customMeta\" data-dictid=\"bfe689a0b21692777200b9437fa418\">tennis elbow</span> test, this test involves the patient making a fist and resisting wrist extension while the examiner applies pressure. The test is positive if the patient experiences pain on the <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> epicondyle.</li>\n\t\t\t\t<li><strong>Maudsley's test: </strong>This test involves the patient pronating their <span class=\"customMeta\" data-dictid=\"258a5bb5841692777203cfb8e31f55\">forearm</span> and resisting extension of the third <span class=\"customMeta\" data-dictid=\"02e6b5c95316927771867eba7818b1\">digit</span> of their hand while the examiner stabilizes the humerus. The test is positive if the patient experiences sudden pain on the <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> epicondyle.</li>\n\t\t\t\t<li><strong>Mills's test:</strong> Another common test for tennis elbow.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Treatment</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Initial: Analgesics, anti-inflammatory drugs</li>\n\t\t\t\t<li>If no response: Local <span class=\"customMeta\" data-dictid=\"3509997646169277719014053aa74d\">injection</span> of <span class=\"customMeta\" data-dictid=\"3ad7a8484f16927771892d460daa4b\">hydrocortisone</span> at the point of maximum tenderness</li>\n\t\t\t\t<li>Physical therapy and activity modification</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Ankle <span class=\"customMeta\" data-dictid=\"daa538622e1692777199fda4912331\">Sprain</span> (Option B)</strong> typically requires ankle supports, braces, or wraps for <span class=\"customMeta\" data-dictid=\"3024d9916e16927771896f5b7159b6\">immobilization</span> and stabilization, but not specifically a counterforce brace. Treatment usually involves rest, ice, compression, and <span class=\"customMeta\" data-dictid=\"a1f256489a16927771870ddd296574\">elevation</span> (R.I.C.E.), along with possible rehabilitation exercises.</p>\n\n<p><strong>Ulnar <span class=\"customMeta\" data-dictid=\"c2193cdaa816927771843863690961\">Claw</span> Hand (Option C)</strong>, a <span class=\"customMeta\" data-dictid=\"ce2b48d83d1692777185427cee6c98\">deformity</span> caused by damage to the <span class=\"customMeta\" data-dictid=\"d7fd512e881692777201909450fd8c\">ulnar</span> nerve, requires <span class=\"customMeta\" data-dictid=\"e0c04b24581692777199eb9e3f856a\">splints</span> or other supportive devices to manage the hand\u2019s positioning and function. A counterforce <span class=\"customMeta\" data-dictid=\"ea9813b91c169277718305c8fe4777\">brace</span> is not used for this condition; a <span class=\"customMeta\" data-dictid=\"0e0dce452a1692777198212234f2f0\">static</span> or <span class=\"customMeta\" data-dictid=\"9334d0330416927771861c9e8ac790\">dynamic splint</span> is typically used to improve function.</p>\n\n<p><strong>Foot Drop (Option D)</strong>, a condition characterized by difficulty lifting the foot due to weakness or <span class=\"customMeta\" data-dictid=\"72fa9105b916927771945aef35e8ed\">paralysis</span> of the <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> <span class=\"customMeta\" data-dictid=\"7d3a7e876e1692777200a1e15f025f\">tibialis</span> muscle, is usually treated with ankle-foot orthoses (AFOs) to support the foot and prevent dragging. A counterforce <span class=\"customMeta\" data-dictid=\"ea9813b91c169277718305c8fe4777\">brace</span> is not typically used for foot drop.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A maid is playing with a child by spinning him while holding his hands. A few hours later, the child starts crying, does not use his arm, and does not let anybody touch him. What is the possible diagnosis?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Pulled elbow"
      },
      {
        "id": 2,
        "text": "Olecranon fracture"
      },
      {
        "id": 3,
        "text": "Fracture head of radius"
      },
      {
        "id": 4,
        "text": "Elbow dislocation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Pulled elbow</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The condition indicates a <strong>pulled elbow (nursemaid\u2019s elbow) </strong>caused by a sudden pull on the arm, leading to <span class=\"customMeta\" data-dictid=\"4fff084ff9169277719765c9d85a8e\">radial</span> head subluxation. The classic arm position is slightly<strong> </strong><strong>flexed and pronated.</strong></li>\n</ul>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Pulled Elbow (also known as Nursemaid\u2019s Elbow)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Age group </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>1-5 years (most common)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Mechanism of injury</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>A sudden <span class=\"customMeta\" data-dictid=\"b88c1802e21692777190700ee5b998\">jerk</span> or pull on the arm when it is <strong>extended and pronated</strong> causes the <span class=\"customMeta\" data-dictid=\"4fff084ff9169277719765c9d85a8e\">radial</span> head to slip out of the <span class=\"customMeta\" data-dictid=\"96f5104d6816927771816ac8dfceeb\">annular</span> <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> (radial head subluxation).</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Clinical presentation </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>The child holds the affected arm close to the body in a <strong>slightly flexed and pronated</strong> position, resisting movement, particularly supination.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>X-ray </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Diagnosis is usually clinical.</li>\n\t\t\t\t<li>X-ray is unnecessary unless there is suspicion of other injuries.\n\t\t\t\t<ul>\n\t\t\t\t\t<li>It may appear normal</li>\n\t\t\t\t\t<li>If visible, they can show subtle <strong>displacement of the <span class=\"customMeta\" data-dictid=\"4fff084ff9169277719765c9d85a8e\">radial</span> head</strong>, with the possible <span class=\"customMeta\" data-dictid=\"a1f256489a16927771870ddd296574\">elevation</span> of the <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> fat pad or visibility of the <span class=\"customMeta\" data-dictid=\"a5c6cb079d16927771967e62ffee72\">posterior</span> fat pad, indicating joint effusion.</li>\n\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Treatment </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Reduction of the <span class=\"customMeta\" data-dictid=\"e53b153fb316927771996481a3e88f\">subluxation</span> by <strong>supination and flexion</strong> or <strong>hyperpronation</strong> of the <span class=\"customMeta\" data-dictid=\"258a5bb5841692777203cfb8e31f55\">forearm</span> typically results in immediate relief.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"\" data-author=\"M I Ibrahim, M. M. Razalli, R. R. Johan , F. M. Effendi\" data-hash=\"\" data-license=\"NA\" data-source=\"https://www.semanticscholar.org/paper/Pulled-elbow-syndrome-in-infants-below-2-years-of-A-Ibrahim-Razalli/fe824a54b32403260655958a21c1a5bb8cdb990e/figure/0\" data-tags=\"\" height=\"460\" src=\"https://image.prepladder.com/content/ef83LKaYTVKuEtM6w3J41745217463.png\" width=\"472\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"472\" src=\"https://image.prepladder.com/content/ZXfBuFlzuAnA42qypBRA1745217470.png\" width=\"472\" /></p>\n\n<p>\u00a0</p>\n\n<p><strong>Incorrect options:</strong></p>\n\n<p><strong>Olecranon <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">fracture</span> (Option B): </strong>Caused due to fall on an outstretched hand or as a result of direct blow to elbow. May be <span class=\"customMeta\" data-dictid=\"a6260fa86416927772008d36bd7e5f\">transverse</span> or <span class=\"customMeta\" data-dictid=\"9c8512bb5d169277718470669bd36e\">comminuted</span> fracture. Associated <span class=\"customMeta\" data-dictid=\"d7fd512e881692777201909450fd8c\">ulnar</span> nerve injury can be seen.</p>\n\n<p><strong>Fracture <span class=\"customMeta\" data-dictid=\"44ce69b86116927771891442487872\">head of radius</span> (Option C): </strong>Common in adults, caused due to fall on an outstretched hand or fall over the elbow. CT/MRI may be required if X-ray is inconclusive.</p>\n\n<p><strong>Elbow <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> (Option D):</strong> Common <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> in children, caused by fall on an outstretched hand. The <span class=\"customMeta\" data-dictid=\"979385c98a1692777192fb1721a16e\">median</span> nerve is most commonly injured.</p>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"\" data-author=\"Kian\" data-hash=\"\" data-license=\"Open access\" data-source=\"https://wikem.org/wiki/File:Elbow_dislocation_lateral.jpg\" data-tags=\"\" height=\"827\" src=\"https://image.prepladder.com/content/ZQvrPpddmW8MXQ5zhnYX1745217479.png\" width=\"578\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/ef83LKaYTVKuEtM6w3J41745217463.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What is the medical condition of a tennis player who is able to repeatedly and independently reduce a shoulder dislocation?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Acute shoulder dislocation"
      },
      {
        "id": 2,
        "text": "Recurrent shoulder dislocation"
      },
      {
        "id": 3,
        "text": "Inferior shoulder dislocation"
      },
      {
        "id": 4,
        "text": "Fracture upper end humerus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) </strong>Recurrent shoulder dislocation</p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li><strong>Recurrent Shoulder Dislocation</strong> occurs due to repeated dislocations, often with <strong>joint instability</strong> or <strong>capsular laxity</strong>. This patient can reduce the <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> independently due to muscle memory or prior experience. It is common in athletes, especially those involved in overhead sports like tennis.</li>\n\t<li><strong>Recurrent shoulder dislocation</strong> is the most common <span class=\"customMeta\" data-dictid=\"8a6b09beac1692777184b08a2b5766\">complication</span> following an initial dislocation.</li>\n\t<li>It occurs due to repeated trauma, capsular laxity, bone changes, muscle weakness, inadequate rehabilitation, or high-risk activities.</li>\n\t<li><strong>Hill-Sachs and Bankart lesions</strong>, associated with shoulder dislocations, contribute to joint <span class=\"customMeta\" data-dictid=\"acb259200b16927771908888d1377c\">instability</span> and increase the risk of recurrence.</li>\n</ul>\n\n<p><strong>Complications of Shoulder Dislocation:</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:649px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #999999; border-left:1px solid #999999; border-right:1px solid #999999; border-top:1px solid #999999; vertical-align:top\">\n\t\t\t<p><strong>Early Complications</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #999999; border-left:none; border-right:1px solid #999999; border-top:1px solid #999999; vertical-align:top\">\n\t\t\t<p><strong>Delayed Complications</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td rowspan=\"3\" style=\"border-bottom:1px solid #999999; border-left:1px solid #999999; border-right:1px solid #999999; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Rotator <span class=\"customMeta\" data-dictid=\"074fda92471692777185c9d613a2ea\">cuff</span> tear</strong> - Common in the elderly due to degenerative changes in the tendons and less common in younger patients.</li>\n\t\t\t\t<li><strong>Axillary <span class=\"customMeta\" data-dictid=\"a66cd3adaa1692777182e77cb23021\">artery</span> injury</strong> - Rare; Occurs with severe trauma</li>\n\t\t\t\t<li><strong>Nerve injury</strong> - The <strong>axillary nerve </strong>is most commonly affected; other nerve injuries and complete <span class=\"customMeta\" data-dictid=\"1e4db8b6ad1692777183683f42d44b\">brachial</span> <span class=\"customMeta\" data-dictid=\"3a9085a5761692777195417d7c03ae\">plexus</span> <span class=\"customMeta\" data-dictid=\"f3e67cebd51692777194f5257898e4\">palsy</span> are rare.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td rowspan=\"3\" style=\"border-bottom:1px solid #999999; border-left:none; border-right:1px solid #999999; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Recurrence</strong> - Most common, due to instability.</li>\n\t\t\t\t<li><strong>Joint stiffness</strong> - Results from prolonged immobility.</li>\n\t\t\t\t<li><strong>Unreduced dislocation</strong> - Due to missed or undiagnosed dislocation.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t</tr>\n\t\t<tr>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Acute Shoulder <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">Dislocation</span> (Option A)</strong> refers to a <strong>single episode</strong> of dislocation, typically requiring immediate reduction. The patient would not be able to repeatedly reduce it independently, making this option incorrect.</p>\n\n<p><strong>Inferior Shoulder <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">Dislocation</span> (Option C)</strong>: Rare and occurs when the humeral head is displaced <strong>downward</strong>. It typically results from significant trauma and would not be easily <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> independently.</p>\n\n<p><strong>Fracture of Upper End Humerus (Option D)</strong> involves a <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">fracture</span> of the humeral head or neck, which may <span class=\"customMeta\" data-dictid=\"efaf9e0192169277719278711f7f74\">mimic</span> <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> but wouldn't allow the patient to repeatedly reduce the <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> independently. Fractures require different management and do not typically present with <span class=\"customMeta\" data-dictid=\"c64e3a661b1692777197afc2ff7bca\">recurrent</span> dislocations.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 25 year old Volleyball player presents to your OPD with injury to thumb,along with pain, swelling, and tenderness at the base of the thumb. On examination the thumb is in the position of abduction. Which of the following is the diagnosis of the presenting condition?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Game keepers thumb"
      },
      {
        "id": 2,
        "text": "Bowler's thumb"
      },
      {
        "id": 3,
        "text": "Kaplan injury"
      },
      {
        "id": 4,
        "text": "Mallet finger"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) </strong>Game keepers thumb</p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The injury described in the question, with <strong>pain</strong>, <strong>swelling</strong>, <strong>tenderness at the base of the thumb</strong>, and the <strong>thumb in the position of abduction</strong>, is consistent with <strong>Gamekeeper's Thumb</strong> (also known as <strong>Skier's Thumb</strong>).</li>\n</ul>\n\n<p><strong>Ulnar Collateral <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">Ligament</span> Injury</strong>: Known as <strong>Gamekeeper\u2019s Thumb</strong> or <strong>Skier\u2019s Thumb</strong>, caused by hyperabduction of the thumb (e.g., falling onto an extended thumb).</p>\n\n<p><strong>Injury Types</strong>:</p>\n\n<ul>\n\t<li><strong>Partial Rupture</strong>: Only the <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> is torn; <span class=\"customMeta\" data-dictid=\"acb259200b16927771908888d1377c\">instability</span> in <span class=\"customMeta\" data-dictid=\"85ff8a7ff81692777202a827961a5c\">flexion</span> but stable in extension.</li>\n\t<li><strong>Complete Rupture</strong>: Both the <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> and <span class=\"customMeta\" data-dictid=\"236c57792f1692777194be265ad6db\">palmar</span> plate are torn; <span class=\"customMeta\" data-dictid=\"acb259200b16927771908888d1377c\">instability</span> in all positions.</li>\n\t<li><strong>Stener Lesion</strong>: When the <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> pulls away from its <span class=\"customMeta\" data-dictid=\"ccd357daaf16927771825777ea6a0d\">attachment</span> and doesn\u2019t heal unless repaired.</li>\n</ul>\n\n<p><strong>Clinical Assessment</strong>:</p>\n\n<ul>\n\t<li>Tenderness and <span class=\"customMeta\" data-dictid=\"e3d212ebd316927771996e0c472d4a\">swelling</span> over the <span class=\"customMeta\" data-dictid=\"d7fd512e881692777201909450fd8c\">ulnar</span> side of the thumb.</li>\n\t<li><strong>X-ray</strong> to rule out fractures.</li>\n\t<li><strong>Stress tests</strong> to check for laxity.</li>\n\t<li><strong>Laxity in <span class=\"customMeta\" data-dictid=\"85ff8a7ff81692777202a827961a5c\">flexion</span> and extension</strong> suggests complete <span class=\"customMeta\" data-dictid=\"e73553a3a5169277719787fd5f4680\">rupture</span> requiring surgery.</li>\n</ul>\n\n<p><strong>Treatment</strong>:</p>\n\n<ul>\n\t<li><strong>Partial Tears</strong>: Immobilization in a <span class=\"customMeta\" data-dictid=\"7f606f911b1692777199eb69ab67c5\">splint</span> for 2-4 weeks, avoiding <span class=\"customMeta\" data-dictid=\"b6b1ecba7c16927771953ee3dc08ea\">pinch</span> for 6-8 weeks.</li>\n\t<li><strong>Complete Tears</strong>: Surgical repair required, with care to avoid damaging the <span class=\"customMeta\" data-dictid=\"ebb480187d1692777199e233e9e356\">superficial</span> <span class=\"customMeta\" data-dictid=\"4fff084ff9169277719765c9d85a8e\">radial</span> nerve.</li>\n\t<li>Post-surgery: Thumb immobilized in a <span class=\"customMeta\" data-dictid=\"7f606f911b1692777199eb69ab67c5\">splint</span> for 6 weeks, with early movement in the flexion-extension plane.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Bowler's Thumb (Option B)</strong>: Refers to a condition caused by <span class=\"customMeta\" data-dictid=\"56af81fad316927771843d2b4b1e4f\">compression</span> of the <strong>ulnar nerve</strong> at the <strong>hypothenar eminence</strong> (not an injury to the thumb ligament).</p>\n\n<p><strong>Kaplan injury (Option C)</strong>: Refers to an injury to the <strong>flexor tendon</strong> of the thumb, often seen in deep cuts to the palm or thumb, not related to hyperabduction.</p>\n\n<p><strong>Mallet Finger (Option D)</strong>: Involves injury to the <strong>extensor tendon</strong> of the finger, causing an inability to straighten the <span class=\"customMeta\" data-dictid=\"5ff25303a01692777186731f6a4f5c\">distal</span> joint, which is not the case here.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Football player gets blow to the outer knee during match.Which structure is most commonly associated with this type of injury?</p>\n\n<p>Lateral lemniscus</p>",
    "choices": [
      {
        "id": 1,
        "text": "Anterior cruciate ligament"
      },
      {
        "id": 2,
        "text": "Medial collateral ligament"
      },
      {
        "id": 3,
        "text": "Posterior Cruciate ligament"
      },
      {
        "id": 4,
        "text": "Lateral lemniscus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">Medial</span> <span class=\"customMeta\" data-dictid=\"4de12d1ef31692777184db1d11c6bd\">collateral</span> ligament</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The MCL is a <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> located on the inner side of the <span class=\"customMeta\" data-dictid=\"9d86b5d3351692777190224c62427b\">knee joint</span> that helps stabilize the knee against excessive sideways or <span class=\"customMeta\" data-dictid=\"e33d939e82169277720167f59b0ee2\">valgus</span> stress.</li>\n\t<li>It connects the <span class=\"customMeta\" data-dictid=\"512283ec9816927772024c89478b7d\">femur</span> (thigh bone) to the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> (shin bone) and plays a crucial role in maintaining the integrity of the knee joint.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Anterior <span class=\"customMeta\" data-dictid=\"0faa43e76516927771851bff22a1e2\">cruciate</span> <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> (ACL) (Option A): </strong>While the ACL is another important <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> in the knee, it is not directly associated with MCL injuries. The ACL is located inside the <span class=\"customMeta\" data-dictid=\"9d86b5d3351692777190224c62427b\">knee joint</span> and is responsible for controlling rotational and <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> translation of the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> in relation to the femur.</p>\n\n<p><strong>Posterior <span class=\"customMeta\" data-dictid=\"0faa43e76516927771851bff22a1e2\">cruciate</span> <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> (PCL) (Option C): </strong>The PCL is also an internal <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> of the knee, but it is not commonly associated with MCL injuries. The PCL helps stabilize the knee against <span class=\"customMeta\" data-dictid=\"a5c6cb079d16927771967e62ffee72\">posterior</span> translation of the <span class=\"customMeta\" data-dictid=\"ca6af868811692777200ce067e9db9\">tibia</span> in relation to the femur.</p>\n\n<p><strong>Lateral <span class=\"customMeta\" data-dictid=\"526b3e942016927771928828b6c34f\">meniscus</span> (Option D): </strong>The <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> <span class=\"customMeta\" data-dictid=\"526b3e942016927771928828b6c34f\">meniscus</span> is the counterpart of the <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">medial</span> <span class=\"customMeta\" data-dictid=\"526b3e942016927771928828b6c34f\">meniscus</span> and is located on the outer side of the knee joint. It is not directly associated with MCL injuries. However, it can be injured independently or in conjunction with other knee injuries.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Identify the shown image</p>\n\n<p><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"505\" src=\"https://image.prepladder.com/content/uT6bVa8i4A9kN0VxjFQ01747034246.png\" width=\"505\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Ankle knee stabilizer"
      },
      {
        "id": 2,
        "text": "Patella tendon bearing brace"
      },
      {
        "id": 3,
        "text": "Thomas splint"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) <span class=\"customMeta\" data-dictid=\"615557ed3a169277719497f86e830b\">Patella</span> <span class=\"customMeta\" data-dictid=\"606c2acae5169277720052151cb04c\">Tendon</span> <span class=\"customMeta\" data-dictid=\"2bb6ddacfd169277718230a816b21f\">Bearing</span> Brace.</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>A <span class=\"customMeta\" data-dictid=\"615557ed3a169277719497f86e830b\">patella</span> <span class=\"customMeta\" data-dictid=\"606c2acae5169277720052151cb04c\">tendon</span> <span class=\"customMeta\" data-dictid=\"2bb6ddacfd169277718230a816b21f\">bearing</span> brace, also known as a patellar <span class=\"customMeta\" data-dictid=\"606c2acae5169277720052151cb04c\">tendon</span> <span class=\"customMeta\" data-dictid=\"ea9813b91c169277718305c8fe4777\">brace</span> or patellar <span class=\"customMeta\" data-dictid=\"606c2acae5169277720052151cb04c\">tendon</span> strap, is a specialized <span class=\"customMeta\" data-dictid=\"ea9813b91c169277718305c8fe4777\">brace</span> designed to provide targeted support and <span class=\"customMeta\" data-dictid=\"56af81fad316927771843d2b4b1e4f\">compression</span> to the patellar tendon.</li>\n\t<li>It is commonly used in conditions such as patellar <span class=\"customMeta\" data-dictid=\"04d32b0a4e16927772003f402a66c5\">tendonitis</span> or jumper's knee, where there is pain or <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> in the patellar tendon.</li>\n</ul>\n\n<p><strong>Ankle Knee Stabilizer (Option A): </strong>Type of <span class=\"customMeta\" data-dictid=\"ea9813b91c169277718305c8fe4777\">brace</span> or support that provides stability to both the ankle and knee joints. It is commonly used in cases of <span class=\"customMeta\" data-dictid=\"301e3b01f01692777191aced6dc342\">ligament</span> injuries or <span class=\"customMeta\" data-dictid=\"acb259200b16927771908888d1377c\">instability</span> in these joints.</p>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"6662\" src=\"https://image.prepladder.com/content/jN0tLzHqKgncmsD6aG141748153857.png\" width=\"3641\" /></p>\n\n<p>\u00a0</p>\n\n<p><strong>Thomas <span class=\"customMeta\" data-dictid=\"7f606f911b1692777199eb69ab67c5\">Splint</span> (Option C): </strong>Specific type of <span class=\"customMeta\" data-dictid=\"7f606f911b1692777199eb69ab67c5\">splint</span> used for <span class=\"customMeta\" data-dictid=\"3024d9916e16927771896f5b7159b6\">immobilization</span> and <span class=\"customMeta\" data-dictid=\"6694ddb1db1692777199c9a1e38bf0\">stabilization</span> of the <span class=\"customMeta\" data-dictid=\"512283ec9816927772024c89478b7d\">femur</span> or thigh bone. It is commonly used in cases of fractures or dislocations of the femur.</p>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"604\" src=\"https://image.prepladder.com/content/pBYoDa8tWguUUsfWd5aR1747034272.png\" width=\"604\" /></p>",
    "question_images": [
      "https://image.prepladder.com/content/uT6bVa8i4A9kN0VxjFQ01747034246.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/jN0tLzHqKgncmsD6aG141748153857.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What is the medical condition of a tennis player who is able to repeatedly and independently reduce a shoulder dislocation?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Acute shoulder dislocation"
      },
      {
        "id": 2,
        "text": "Recurrent shoulder dislocation"
      },
      {
        "id": 3,
        "text": "Inferior shoulder dislocation"
      },
      {
        "id": 4,
        "text": "Fracture upper end humerus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct option: B</strong></p>\n\n<ul>\n\t<li>Recurrent shoulder <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> refers to the repeated episodes of shoulder dislocation, where the <span class=\"customMeta\" data-dictid=\"f0cdc42a0c1692777198f54a380826\">shoulder joint</span> pops out of its normal position. Some individuals, particularly those involved in sports like tennis, may develop a condition known as voluntary or <span class=\"customMeta\" data-dictid=\"94e112a3551692777188225fb50f30\">habitual</span> dislocation. They can voluntarily and easily reduce the dislocated shoulder on their own. This ability to self-reduce the <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> repeatedly is characteristic of <span class=\"customMeta\" data-dictid=\"c64e3a661b1692777197afc2ff7bca\">recurrent</span> shoulder dislocation.</li>\n</ul>\n\n<p><strong>Incorrect options: </strong></p>\n\n<p><strong>Option A:</strong> <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">Acute</span> shoulder dislocation: <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">Acute</span> shoulder <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> refers to the initial episode of shoulder dislocation, which requires manual reduction.</p>\n\n<p><strong>Option C:</strong> <span class=\"customMeta\" data-dictid=\"49c4ef5b9d1692777190c0277f8344\">Inferior</span> shoulder dislocation: <span class=\"customMeta\" data-dictid=\"49c4ef5b9d1692777190c0277f8344\">Inferior</span> shoulder <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> (luxatio erecta) is a rare type of shoulder <span class=\"customMeta\" data-dictid=\"c1aae6e67f169277718624a4e51cfe\">dislocation</span> where the arm is stuck in an elevated position.</p>\n\n<p><strong>Option </strong><strong>D.</strong> <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">Fracture</span> upper end humerus: <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">Fracture</span> of the upper end of the <span class=\"customMeta\" data-dictid=\"a547f4a22716927771897daf6b50e7\">humerus</span> is a different condition involving a break in the bone.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What is the likely diagnosis for a 28-year-old man who has completed a half-marathon and is now experiencing pain on the front and inner side of his shin that worsens with prolonged jogging and walking? The X-ray results for his leg were normal.</p>",
    "choices": [
      {
        "id": 1,
        "text": "Jones fracture"
      },
      {
        "id": 2,
        "text": "Shin splint"
      },
      {
        "id": 3,
        "text": "Lisfranc fracture"
      },
      {
        "id": 4,
        "text": "Nutcracker fracture"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct option is B: <span class=\"customMeta\" data-dictid=\"d3eb7fc1d41692777198c9b9e4364e\">Shin</span> splint: </strong>Shin <span class=\"customMeta\" data-dictid=\"e0c04b24581692777199eb9e3f856a\">splints</span> commonly present with pain along the <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> and <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">medial</span> aspect of the tibia. The pain is often described as a dull, aching sensation and is aggravated by activities such as running or walking for a long time. <span class=\"customMeta\" data-dictid=\"fd0c8ab494169277720227102dc79a\">X-ray</span> findings are usually normal in <span class=\"customMeta\" data-dictid=\"d3eb7fc1d41692777198c9b9e4364e\">shin</span> splints.</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option A: Jones fracture: </strong>Jones <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">fracture</span> refers to a <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">fracture</span> of the fifth <span class=\"customMeta\" data-dictid=\"b7f1b05b6d1692777192a18bc2396f\">metatarsal</span> bone in the foot, typically involving the metaphyseal-diaphyseal junction. It is not related to the symptoms described in the case.</p>\n\n<p><strong>Option C: Lisfranc fracture: </strong>Lisfranc <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">fracture</span> involves the injury to the <span class=\"customMeta\" data-dictid=\"a3b012f5661692777200bc29594c41\">tarsometatarsal</span> joint complex in the midfoot. It is not related to the symptoms described in the case.</p>\n\n<p><strong>Option D: Nutcracker fracture: </strong>Nutcracker <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">fracture</span> refers to a <span class=\"customMeta\" data-dictid=\"e3727bc4841692777203d62242b6e6\">fracture</span> of the <span class=\"customMeta\" data-dictid=\"4992469b3c169277719874a6808793\">scaphoid</span> bone in the wrist. It is not related to the symptoms described in the case.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  }
];
        let quizName = '12 Previous Year Questions';
        let hierarchy = ["PrepLadder", "qBank", "Orthopedics"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>