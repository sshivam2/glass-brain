<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 017 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A newborn infant is found to have a congenital urethral abnormality in which the urethral meatus opens on the ventral side of the penis. It is resulting in difficulty in directing the urine stream due to the ventral curvature of the penis. Which of the following is the cause of this malformation?",
    "choices": [
      {
        "id": 1,
        "text": "Splitting of the genital tubercles"
      },
      {
        "id": 2,
        "text": "Failure of the fusion of urethral folds"
      },
      {
        "id": 3,
        "text": "Improper development of urorectal septum"
      },
      {
        "id": 4,
        "text": "Improper development of paramesonephric duct"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario describes <strong>hypospadias.&nbsp;</strong>It occurs due to the<strong> incomplete fusion</strong> of the <strong>urethral folds.</strong></p>\n<p>Development of external genitalia in males</p>\n<p class=\"p1\">It is under the influence of androgens secreted by the fetal testes. The genital tubercle elongates to form <strong>phallus</strong>. During this elongation, the phallus pulls the urethral folds forward so that they form the lateral walls of the <strong>urethral groove.</strong> This groove extends along the ventral aspect of the elongated phallus, but not up to the glans. The urethral folds which form the lateral wall of the urethral groove fuse to form the penile urethra. The most distal part of urethra is formed by the penetration of the ectodermal cells from the tip of the glans. These form a short epithelial cord that forms the <strong>external urethral meatus.</strong></p>\n<p class=\"p1\"><strong>Incomplete fusion&nbsp;</strong>of the urethral folds leads to hypospadiasis.&nbsp;</p>\n<p class=\"p1\">Other options:</p>\n<p class=\"p1\">Option A- Splitting of genital tubercles leads to <strong>bifid</strong> or <strong>double penis.</strong></p>\n<p class=\"p1\">Option C- Improper development of urorectal septum or cloaca leads to&nbsp;absent perineal and <strong>anal opening</strong>s in association with <strong>ambiguous genitalia</strong> and <strong>urogenital and</strong>&nbsp;<strong>colonic&nbsp;</strong>malformations.</p>\n<p class=\"p1\">Option D- Improper developmental paramesonephric duct leads to uterine anomalies like <strong>uterus didelphys,</strong> uterus arcuatus, uterus bicornis, etc.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9eff50fe8fee4fe8a0f8a128eb32e983x1280x2289.JPEG"
    ]
  },
  {
    "text": "Largest percentage of blood volume in the circulatory system is in _____.",
    "choices": [
      {
        "id": 1,
        "text": "Arteries"
      },
      {
        "id": 2,
        "text": "Capillaries"
      },
      {
        "id": 3,
        "text": "Veins"
      },
      {
        "id": 4,
        "text": "Heart"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Largest percentage of blood volume in the circulatory system is in veins.</p>\n<p><strong>Vessels and Percentage of Total Blood Volume</strong></p>\n<table>\n<tbody>\n<tr>\n<td>\n<p><strong>VESSELS</strong></p>\n</td>\n<td>\n<p><strong>% OF TOTAL BLOOD VOLUME</strong></p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Heart</p>\n</td>\n<td>\n<p>12</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Pulmonary circulation</p>\n</td>\n<td>\n<p>18</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Aorta</p>\n</td>\n<td>\n<p>2</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Artery</p>\n</td>\n<td>\n<p>8</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Arteriole</p>\n</td>\n<td>\n<p>1</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Capillary</p>\n</td>\n<td>\n<p>5</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Venule, vein, vena cava</p>\n</td>\n<td>\n<p>54</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The parent purine nucleotide made from de novo purine synthesis is ______",
    "choices": [
      {
        "id": 1,
        "text": "AMP"
      },
      {
        "id": 2,
        "text": "GMP"
      },
      {
        "id": 3,
        "text": "IMP"
      },
      {
        "id": 4,
        "text": "TMP"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Inosine monophosphate</strong> <strong>(IMP)</strong> is the <strong>parent purine nucleotide</strong> made from de novo purine synthesis.</p>\n<p><strong>Ribose 5-phosphate</strong> is converted to inosine monophosphate (IMP) by series of reactions. The <strong>regulatory enzymes</strong> of purine synthesis are</p>\n<ul>\n<li>PRPP Synthetase</li>\n<li>PRPP glutamyl amidotransferase</li>\n</ul>\n<p>The rate-limiting enzyme is&nbsp;<strong>PRPP glutamyl amidotransferase.</strong></p>\n<p>Following the synthesis of IMP, separate branches lead to <strong>AMP</strong> and <strong>GMP</strong> synthesis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A couple comes to a hospital for genetic counselling and upon further evaluation, the husband is found to have Marfan syndrome. The inheritance pattern and mutation associated with this condition are:",
    "choices": [
      {
        "id": 1,
        "text": "Autosomal dominant, mutation in FBN-1 gene"
      },
      {
        "id": 2,
        "text": "Autosomal recessive, mutation in FBN-1 gene"
      },
      {
        "id": 3,
        "text": "Autosomal dominant, mutation in FBN-2 gene"
      },
      {
        "id": 4,
        "text": "Autosomal recessive, mutation in FBN-2 gene"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The inheritance pattern and the mutation in Marfan syndrome are that it is <strong>autosomal dominant</strong> and is associated with a mutation in <strong>FBN-1</strong> gene.</p>\n<div class=\"page\" title=\"Page 157\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Marfan syndrome</strong> is an autosomal dominant disorder affecting connective tissues\u00a0associated chiefly with cardiovascular, ocular, and musculoskeletal abnormalities, although involvement of other organ systems like the central nervous system, respiratory system and skin has also been observed. It results from an inherited defect in an extracellular glycoprotein called <strong>Fibrillin-1</strong>.</p>\n<div class=\"page\" title=\"Page 157\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Fibrillin occurs in two homologous forms, fibrillin-1 and fibrillin-2, encoded by two separate genes, FBN-1 and FBN-2, located on long arms of chromosomes 15 and 5, respectively. <strong>Mutations of FBN-1 give rise to Marfan syndrome</strong> while mutations of the related FBN2 gene give rise to congenital contractural arachnodactyly, an autosomal dominant disorder characterized by skeletal abnormalities, which is less common.\u00a0</p>\n<p>Fibrillin-1 is a regulator of TGF-\u03b2 which is responsible for inflammation, fibrosis, and activation of specific matrix metalloproteinases (MMPs), particularly MMP-2 and MMP-9.</p>\n<p>Patients with Marfan syndrome are tall and have an\u00a0<strong>decreased\u00a0upper to lower segment ratio\u00a0</strong>with<strong>\u00a0long arms, hands,</strong>\u00a0and\u00a0<strong>fingers</strong>. Deformities of the chest wall, vertebral column, and foot arches may be present.</p>\n<p>Associated cardiovascular abnormalities include mitral valve prolapse leading to<strong>\u00a0mitral regurgitation\u00a0</strong>and dilatation of aortic root/sinuses of Valsalva leading to\u00a0<strong>aortic regurgitation,</strong>\u00a0aortic dissection, and rupture.</p>\n<p><strong>Ocular Features</strong> include <strong>ectopia lentis,</strong> cataract, refractive errors like myopia due to <strong>increased axial length</strong> and retinal detachment</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following egg belongs to:",
    "choices": [
      {
        "id": 1,
        "text": "Schistosoma mansoni"
      },
      {
        "id": 2,
        "text": "Schistosoma hematobium"
      },
      {
        "id": 3,
        "text": "Schistosoma japonicum"
      },
      {
        "id": 4,
        "text": "Schistosoma mekongi"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows a non-operculated, yellowish-brown egg with a lateral spine near the rounded posterior end is suggestive of&nbsp;<strong><em>Schistosoma mansoni</em>.</strong></p>\n<p>Adult worms of <em>S. mansoni</em> live in the <strong>inferior mesenteric vein</strong> and their infective form is fork-tailed cercaria.</p>\n<p>Following skin penetration by cercariae, a pruritic rash termed cercarial dermatitis or <strong>swimmers itch</strong> develops locally which is self-limiting.</p>\n<p>After 4- 8 weeks of the cercarial invasion, high worm load, and egg antigen stimuli lead to the formation of immune complexes which result in serum sickness-like illness termed <strong>Katayama fever</strong>. They present with high-grade fever, rash, arthralgia, hepatosplenomegaly. lymphadenopathy and eosinophilia.&nbsp;</p>\n<p>When eggs get deposited in the small intestine, patients develop abdominal pain and blood dysentery for a long time called <strong>intestinal bilharziasis</strong>. The eggs deposited in the intestinal wall lead to microabscesses, granulomas, hyperplasia, and fibrosis.&nbsp;</p>\n<p>The <strong>drug of choice</strong> is<strong> praziquantel</strong> 40mg/kg single oral dose. <strong>Oxamniquine</strong> 15mg/kg single oral dose is also an effective dose. It distorts the tegument of the male worm and makes the worm more susceptible to the lethal action of the immune system.</p>\n<p>Other options:</p>\n<p>Option B- In <strong><em>Schistosoma&nbsp;hematobium</em></strong>, the egg has a <strong>terminal spine</strong>.</p>\n<p>Option C- In&nbsp;<em><strong>Schistosoma japonicum</strong></em>, the egg has no spine but shows a <strong>lateral small rudimentary knob</strong>.</p>\n<p>Option D- <strong><em>Schistosoma mekongi</em></strong>&nbsp;is similar to <em>S.japonicum</em> but is slightly smaller and round.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8297318bf6d64811b2738f35bd802e8f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1fc6ce8c297f4aaba5e9b2e3722def9ex766x545.JPEG"
    ]
  },
  {
    "text": "Identify the wrongly matched antifungal mechanism of action pair:",
    "choices": [
      {
        "id": 1,
        "text": "Ketoconazole \u2013 Lanosterol 14 demethylase inhibition"
      },
      {
        "id": 2,
        "text": "Flucytosine \u2013 inhibits microtubule synthesis and thus hinders mitosis"
      },
      {
        "id": 3,
        "text": "Terbinafine \u2013 Squalene epoxidase inhibition"
      },
      {
        "id": 4,
        "text": "Amphotericin B \u2013 sequesters ergosterol"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Flucytosine</strong> is a <strong>pyrimidine antimetabolite,</strong> which is inactive as such. After uptake into fungal cells, fungal <strong>cytosine deaminase</strong> converts <strong>flucytosine to 5-fluorouracil</strong> , which is an<strong> anticancer drug</strong>. 5-fluorouracil is further converted into metabolites that inhibit <strong>thymidylate synthase</strong>, an enzyme that is necessary for DNA synthesis. Thus <strong>fungal DNA synthesis is inhibited</strong>.</p>\n<p>Flucytosine has clinically useful activity (3C) against</p>\n<ul>\n<li><em>Cryptococcus</em></li>\n<li><em>Candida</em> species</li>\n<li>Agents causing chromoblastomycosis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Statutory rape is sexual intercourse with:",
    "choices": [
      {
        "id": 1,
        "text": "Woman who is in intoxicated state"
      },
      {
        "id": 2,
        "text": "Wife living under decree of separation"
      },
      {
        "id": 3,
        "text": "Any person other than his / her spouse"
      },
      {
        "id": 4,
        "text": "Girl below 18 years of age with her consent"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Statutory rape&nbsp;is having sexual relationship with a<strong> girl who is below 18 years of age even with her consent.</strong></p>\n<p><strong>Other Options :</strong></p>\n<ul>\n<li>Option A: Sexual intercourse with a woman who is under the influence of sedative drugs like GHB, Rohypnol (flunitrazepam) is called <strong>date rape</strong>.</li>\n<li>Option B: Sexual intercourse with wife living separately, against her consent is <strong>marital rape</strong>.</li>\n</ul>\n<p>Option C: Voluntary sexual intercourse between a married person and a person who is not their spouse is <strong>adultery</strong>.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are an intern performing the tuning fork tests on a patient who presented to the ENT OPD with complaints of decreased hearing in the left ear. Which of the following tuning forks is most commonly used for the routine clinical assessment for such patients?",
    "choices": [
      {
        "id": 1,
        "text": "1024 Hz"
      },
      {
        "id": 2,
        "text": "512 Hz"
      },
      {
        "id": 3,
        "text": "256 Hz"
      },
      {
        "id": 4,
        "text": "126 Hz"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A <strong>tuning fork</strong> of<strong> 512 Hz </strong>is<strong> most commonly used</strong> for routine clinical assessment in ENT.&nbsp;</p>\n<p>Tuning forks of lower frequencies produce a sense of bone vibration while those of higher frequencies have a shorter decay time and are thus not routinely preferred.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Blue sclera is seen in ________.",
    "choices": [
      {
        "id": 1,
        "text": "Alkaptonuria"
      },
      {
        "id": 2,
        "text": "Osteogenesis imperfecta"
      },
      {
        "id": 3,
        "text": "Kawasaki disease"
      },
      {
        "id": 4,
        "text": "Rheumatoid arthritis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Blue sclera is seen in&nbsp;<strong>osteogenesis imperfecta and&nbsp;Ehlers&ndash;Danlos syndrome type VI.</strong></p>\n<p>Blue scleral discoloration is caused by the&nbsp;<strong>thinning</strong> or transparency of the sclera, with resultant visualization of the underlying uvea.&nbsp;</p>\n<p>Causes</p>\n<p>Major associations:</p>\n<ul>\n<li><strong>Osteogenesis imperfecta</strong>:<strong> Most common cause</strong>: Due to the defects in the synthesis and structure of <strong>type 1 collagen</strong>. Two types have ocular features.\n<ul>\n<li><strong>Type I</strong> is <strong>autosomal dominant</strong>. Possible ocular features include <strong>blue sclera, megalocornea,</strong> and <strong>corneal arcus</strong>.</li>\n<li><strong>Type IIA</strong> is either <strong>sporadic</strong> or inherited in an <strong>autosomal-dominant</strong> manner. Ocular manifestations include<strong> blue sclera and shallow orbits</strong>.</li>\n</ul>\n</li>\n<li><strong>Ehlers&ndash;Danlos syndrome type VI</strong></li>\n<li><strong>Nevus of Ota</strong>\n<ul>\n<li>Proliferation of <strong>melanocytes</strong></li>\n<li>Hamartoma</li>\n<li>Melanocytes present in the lamina fusca layer of the sclera</li>\n<li>Blue color due to<strong>&nbsp;</strong>the&nbsp;<strong>Tyndall effect</strong>.</li>\n</ul>\n</li>\n<li>Pseudoxanthoma elasticum</li>\n<li>Congenital glaucoma</li>\n<li>High myopia</li>\n<li>Scleritis</li>\n</ul>\n<p><strong>Image</strong>: The image below shows&nbsp;blue sclerae in a child suffering from osteogenesis imperfecta.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/65422f53b5544eb7b89969a94968f111x970x453.JPEG"
    ]
  },
  {
    "text": "In the following natural history of disease flowchart, point A to C is called?",
    "choices": [
      {
        "id": 1,
        "text": "Screening time"
      },
      {
        "id": 2,
        "text": "Lead time"
      },
      {
        "id": 3,
        "text": "Lag time"
      },
      {
        "id": 4,
        "text": "Generation time"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The period between the first possible time of detection (point A) and the usual time of diagnosis (point C) is\u00a0called as <strong>lead time.</strong></p>\n<p><strong>Other options:</strong></p>\n<p>The period between the first possible time of detection (point A) and the final critical point of diagnosis (point B) is\u00a0called <strong>Screening\u00a0time.</strong></p>\n<p><strong>Screening</strong>\u00a0is the search for unrecognized diseases or defects in apparently healthy individuals by means of\u00a0<strong>rapidly applicable</strong>\u00a0tests or procedures. It must be done in conditions where there is a considerable\u00a0<strong>time lag</strong>\u00a0between the\u00a0<strong>onset</strong>\u00a0of the disease and the\u00a0<strong>usual time</strong>\u00a0of diagnosis (point C in the image).</p>\n<p>This ensures the success of any treatment in<strong>\u00a0reversing</strong>\u00a0the disease process.\u00a0The\u00a0<strong>final critical point</strong>\u00a0(point B in the image) is the stage beyond which treatment would be\u00a0<strong>unsuccessful</strong>\u00a0or there would be\u00a0<strong>permanent damage</strong>.</p>\n<p><strong>Generation time</strong>\u00a0is defined as the interval of time between the\u00a0<strong>onset</strong>\u00a0of infection by a host and the\u00a0<strong>maximal infectivity</strong>\u00a0of that host.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2c054d9709274672bd0f96fb7051f3a1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/82f55365a19745e894c69d3df65d1c54x1279x1020.JPEG"
    ]
  },
  {
    "text": "The Mid-day meals provide _______ :",
    "choices": [
      {
        "id": 1,
        "text": "1/2 of total calories and 1/2 of protein"
      },
      {
        "id": 2,
        "text": "1/2 of total calories and 1/3 of protein"
      },
      {
        "id": 3,
        "text": "1/3 of total calories and 1/3 of protein"
      },
      {
        "id": 4,
        "text": "1/3 of total calories and 1/2 of protein"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The mid-day meals provide <strong>1/3 of total energy </strong>requirement and <strong>1/2 of protein needed</strong>.</p>\n<p>Mid-Day Meal Programme/School Lunch Programme</p>\n<ul>\n<li>The mid-day meals is now provided to children under the PM POSHAN scheme. It provides 1/3 of total energy requirement and 1/2 of protein needed.</li>\n<li>The calorific value of a mid-day meal at upper primary stage has been fixed at a minimum of <strong>700 calories</strong> and <strong>20 grams of protein&nbsp;</strong></li>\n<li>The meal should be a supplement and not a substitute for the home diet.</li>\n<li>The scheme is under the control of Ministry of <strong>Human Resource Development</strong>( Department of school education and Literacy)</li>\n<li>Model Menu</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All the following diseases are associated with rodents except:",
    "choices": [
      {
        "id": 1,
        "text": "Leptospirosis"
      },
      {
        "id": 2,
        "text": "Rat bite fever"
      },
      {
        "id": 3,
        "text": "Tularemia"
      },
      {
        "id": 4,
        "text": "Oriental sore"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>Diseases related to rodents:\n<ul>\n<li><strong>Bacterial</strong>: Plague, tularemia, salmonellosis</li>\n<li><strong>Viral</strong>: Lassa fever, encephalitis, hemorrhagic fevers</li>\n<li><strong>Rickettsial</strong>: Scrub typhus, murine typhus, rickettsial pox</li>\n<li><strong>Parasitic</strong>: Hymenolepis diminuta, leishmaniasis, amoebiasis, trichinosis, Chagas disease</li>\n<li><strong>Others</strong>: Rat bite fever, leptospirosis, histoplasmosis, ring worm</li>\n</ul>\n</li>\n<li>Oriental sore- caused by Leishmania and transmitted by the phlebotomine sand fly.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young boy was being evaluated for post-operative bleeding following a tonsillectomy and  was found to have an inherited bleeding disorder which resulted in the defective adhesion of platelets. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hemophilia A"
      },
      {
        "id": 2,
        "text": "Hemophilia B"
      },
      {
        "id": 3,
        "text": "Immune thrombocytopenia purpura"
      },
      {
        "id": 4,
        "text": "Von Willebrand disease"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario points to the likely diagnosis of Von Willebrand Disease. (vWD). It is the most common inherited bleeding disorder which occurs due to deficiency of or the presence of abnormal von Willebrand&nbsp;factor (vWF).&nbsp;vWF is synthesized by endothelial cells and megakaryocytes (gene located on chromosome 12p). It is then stored in endothelial storage vesicles, The functions of vWF include:</p>\n<ul>\n<li><strong>Adhesion</strong> of&nbsp;the <strong>platelets</strong>&nbsp;to the exposed subendothelium</li>\n<li><strong>Binding</strong> site of <strong>Factor</strong> <strong>VIII</strong></li>\n</ul>\n<p>Clinical features include bleeding after dental extractions and surgeries including tonsillectomies, epistaxis, bruising, and menorrhagia. Most individuals are asymptomatic otherwise.&nbsp;</p>\n<p>vWD has been classified into 3 major subtypes based on the amount of vWF factor in the blood and the presence of functional defects. Type 1 is the most common disease subtype.</p>\n<p>Treatment mainly includes Desmopressin which stimulates the release of vWF and Factor VIII from the endothelial stores.&nbsp;</p>\n<p>Other options-</p>\n<p>Options A and B- Hemophilias A and B are inherited clotting disorders due to the deficiencies of Factor VIII and Factor IX respectively.</p>\n<p>Option C- Idiopathic thrombocytopenic purpura is an acquired bleeding disorder in which there is an immune-mediated destruction of platelets.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An unconscious patient with a history of seizures is brought to the ED. He then develops muscular flaccidity and excessive salivation. After a few minutes, he begins to regain consciousness and is in a confused state. This phenomenon is associated with which of the following types of seizures?",
    "choices": [
      {
        "id": 1,
        "text": "GTCS"
      },
      {
        "id": 2,
        "text": "Absence seizures"
      },
      {
        "id": 3,
        "text": "Atonic seizures"
      },
      {
        "id": 4,
        "text": "Myoclonic seizures"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The scenario is suggestive of <strong>post-ictal confusion</strong> which is seen in <strong>generalized tonic-clonic seizures</strong>.</p>\n<p>It is not seen in absence seizures, atonic seizures or myoclonic seizures.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The rheumatoid factor most commonly measured in the laboratory is ______.",
    "choices": [
      {
        "id": 1,
        "text": "Ig M"
      },
      {
        "id": 2,
        "text": "Ig G"
      },
      {
        "id": 3,
        "text": "Ig A"
      },
      {
        "id": 4,
        "text": "Ig D"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>IgM isotype is the one most frequently measured by commercial laboratories.</p>\n<p>Serum IgM RF has been found in <strong>75&ndash;80%</strong> of patients with<strong> RA</strong>.However, it can also be found in the following:</p>\n<ul>\n<li>Primary Sj&ouml;gren&rsquo;s syndrome</li>\n<li>Systemic lupus erythematosus,</li>\n<li>Subacute bacterial endocarditis</li>\n<li>Hepatitis B and C</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-year-old boy who had SARS CoV-2 infection 3 months back came with complaints of fatigue and shortness of breath for 3 days. The minimum duration of these symptoms to define it as post-Covid-19 condition according to WHO is ____",
    "choices": [
      {
        "id": 1,
        "text": "2 months"
      },
      {
        "id": 2,
        "text": "2 weeks"
      },
      {
        "id": 3,
        "text": "4 months"
      },
      {
        "id": 4,
        "text": "4 weeks"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The minimum duration of symptoms such as fatigue, shortness of breath to define it as <strong>post Covid-19</strong> condition according to WHO is <strong>2 months.</strong></p>\n<p>WHO clinical case definition of post Covid-19 - Post Covid-19 condition occurs in individuals with a history of probable or confirmed SARS CoV-2 infection, usually <strong>3 months from the onset</strong> of Covid-19, with symptoms that <strong>last for at least 2 months</strong> and cannot be explained by an alternative diagnosis.</p>\n<p>Common symptoms include&nbsp;</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Fatigue</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Shortness of breath</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Cognitive dysfunction.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is false regarding screening mammography?",
    "choices": [
      {
        "id": 1,
        "text": "Two views are obtained, the craniocaudal (CC) and mediolateral oblique (MLO) view."
      },
      {
        "id": 2,
        "text": "Mammography is usually performed in the 2nd half of menstrual cycle."
      },
      {
        "id": 3,
        "text": "Mammography is less sensitive in young patients."
      },
      {
        "id": 4,
        "text": "The MLO view images the greatest volume of breast tissue."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Mammography is performed in the&nbsp;<strong>1<sup>st</sup> half of the menstrual cycle.</strong></p>\n<p>During the first half of the menstrual cycle, that patient has had menses in the past 14 days and ovulation has not yet occurred. In the second half, ovulation occurs and if she is pregnant (which is usually confirmed after a month), it would affect the embryo. Hence first half of the menstrual cycle is the preferred time.</p>\n<p>Mammography uses low-voltage, high-amperage X-rays.</p>\n<ul>\n<li>The <strong>radiation dose</strong> from mammography is <strong>0.1 cGy&nbsp;</strong>(up to 0.2 cGy) per study.</li>\n<li>It involves 2 standard views.\n<ul>\n<li><strong>Mediolateral oblique</strong> (MLO) view:&nbsp;covers <strong>greater volume</strong> of breast tissue, including the upper outer quadrant and the axillary tail of Spence.</li>\n<li><strong>Craniocaudal</strong> (CC) view: provides better visualization of the <strong>medial</strong> <strong>aspect</strong> of the breast.</li>\n</ul>\n</li>\n<li><strong>The sensitivity</strong> of mammography <strong>increases with age</strong> as the breast becomes less dense.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Most common site of Gastrinoma in MEN 1 syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Jejunum"
      },
      {
        "id": 2,
        "text": "Ileum"
      },
      {
        "id": 3,
        "text": "Duodenum"
      },
      {
        "id": 4,
        "text": "Stomach"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Most common site of gastrinoma in MEN 1 syndrome is the first and second part of duodenum.</p>\n<p>MEN 1 syndrome is characterized by the<strong> triad</strong> of tumors involving the <strong>parathyroids, pancreatic islets (Gastrinoma), and anterior pituitary.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents with a hernia medial to the inferior epigastric artery. What is the most likely diagnosis and appropriate management for the same?",
    "choices": [
      {
        "id": 1,
        "text": "Direct hernia and Bassini repair"
      },
      {
        "id": 2,
        "text": "Direct hernia and Lichtenstein mesh repair"
      },
      {
        "id": 3,
        "text": "Indirect hernia and Bassini repair"
      },
      {
        "id": 4,
        "text": "Indirect hernia and Lichtenstein mesh repair"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of a hernia <strong>medial</strong> to the<strong> inferior epigastric artery</strong> is suggestive of a <strong>direct hernia</strong>, which is managed surgically by<strong>&nbsp;Lichtenstein mesh repair</strong>.</p>\n<p>The contents of a <strong>direct hernia</strong> protrude<strong>&nbsp;outward</strong>,<strong>&nbsp;forward,</strong>&nbsp;and&nbsp;<strong>medially</strong> to the <strong>inferior epigastric artery </strong>and&nbsp;the <strong>superficial inguinal ring</strong>.<strong>&nbsp;</strong>It<strong>&nbsp;</strong>protrudes through the <strong>Hesselbach triangle </strong>which is a zone of weakness for a direct hernia.<strong>&nbsp;</strong>Whereas, the contents of an<strong> indirect hernia</strong> protrude <strong>laterally</strong> to the <strong>inferior epigastric artery</strong>. The sac of an indirect inguinal hernia passes from the deep inguinal ring obliquely towards the superficial inguinal ring and then reaches the scrotum.</p>\n<p>A <strong>Lichtenstein mesh repair</strong> is currently one of the most frequently used methods for treating an<strong> inguinal hernia</strong>. It is done for <strong>reconstruction</strong> of the <strong>inguinal floor</strong> in <strong>adults</strong>. It is an <strong>anterior tension-free mesh repair</strong> that reduces the chances of&nbsp;<strong>recurrence</strong> of a hernia. A piece of prosthetic nonabsorbable <strong>mesh is used</strong> to bridge the defect in this repair.</p>\n<p>Other surgical methods used for the repair of a hernia are:</p>\n<ul>\n<li><strong>Bassini repair</strong> - It is done for the <strong>reconstruction</strong> of the <strong>inguinal floor</strong> in <strong>adults</strong>. In this method, a <strong>mesh is not</strong> used. It is associated with a <strong>high</strong>&nbsp;<strong>recurrence</strong>&nbsp;and is not used frequently now. It is used only in cases of <strong>hernial strangulation and peritonitis</strong> where the use of a <strong>mesh is not preferred</strong>. It is performed by <strong>suturing</strong> the transversus abdominis and internal oblique musculoaponeurotic arches/<strong>conjoined tendon</strong> to the<strong> inguinal ligament</strong>.&nbsp;</li>\n<li><strong>Shouldice repair</strong>&nbsp;- It is a&nbsp;<strong>multilayered repair,</strong>&nbsp;where the posterior wall of the inguinal canal is strengthened by <strong>continuous sutures.</strong>&nbsp;It involves <strong>double-breasting</strong> of the<strong> transversalis fascia</strong>. It is associated with a&nbsp;<strong>very low recurrence rate.</strong></li>\n<li><strong>Gilbert repair</strong> (plug and patch repair) - It&nbsp;is an <strong>extension</strong> of <strong>Lichtenstein&rsquo;s original mesh repair</strong> and has now become the <strong>most commonly</strong> performed <strong>primary anterior inguinal hernia repair</strong>. In this technique, a <strong>cone-shaped plug</strong> of<strong> polypropylene mesh</strong> is used. It is deployed like an upside-down umbrella when inserted into the internal inguinal ring to occlude the hernia</li>\n<li><strong>Stoppa-Rives repair</strong>&nbsp;- It is used for the repair of large, recurrent, or bilateral hernias. In this method, a sub-umbilical&nbsp;<strong>midline incision </strong>is given to place a<strong> large mesh</strong> into the <strong>preperitoneal space.</strong></li>\n<li><strong>Herniotomy</strong> - It is used to treat <strong>inguinal hernia</strong> in a<strong> child </strong>which&nbsp;occurs due to the<strong> presence</strong> of a&nbsp;<strong>patent processus vaginalis</strong>. Therefore in herniotomy, the repair of the inguinal ring is not done</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0aeac8d0744e4138bc41f46999891d7cx1280x1584.JPEG"
    ]
  },
  {
    "text": "Which of the following is incorrect in describing the triangle of safety in chest tube insertion?",
    "choices": [
      {
        "id": 1,
        "text": "Below and lateral to the pectoralis major muscle"
      },
      {
        "id": 2,
        "text": "Above the level of the inframammary fold"
      },
      {
        "id": 3,
        "text": "Above the level of the nipple"
      },
      {
        "id": 4,
        "text": "Anterior to the midaxillary line"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>'Above the level of the inframammary fold' is an incorrect description of the triangle of safety in chest tube insertion.</p>\n<p>Chest tube insertion is carried out in the&nbsp;<strong>5th intercostal space</strong> anterior to the midaxillary line in the <strong>triangle of safety </strong>(image below).&nbsp;It lies-</p>\n<ul>\n<li>anterior to the midaxillary line [yellow line]</li>\n<li>above the level of the nipple [blue line]</li>\n<li>below and lateral to the pectoralis major muscle (lateral to the lateral border of the pectoralis major) [red line]</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/55e8fb1ff4aa41e8821862aea33c64acx600x577.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a5e3bd1eeedd46f798075ea204058331x600x1759.JPEG"
    ]
  },
  {
    "text": "A pregnant lady with PIH was being monitored with bed rest in supine position. Which of the following is a complication of the below representation?",
    "choices": [
      {
        "id": 1,
        "text": "Ascending aorta syndrome"
      },
      {
        "id": 2,
        "text": "Superior vena caval syndrome"
      },
      {
        "id": 3,
        "text": "Abdominal aorta syndrome"
      },
      {
        "id": 4,
        "text": "Supine venacava syndrome"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Supine vena cava syndrome is the complication of the given representation.</p>\n<p>The above image shows compression of the inferior vena cava by the gravid uterus, this compression sometimes leads to supine vena cava&nbsp;syndrome. During late pregnancy, <strong>the gravid uterus compresses the great vessels against the hard spine</strong>, when the patient is in the&nbsp;supine position. Of the two vessels, the vena cava is compressed, while the <strong>aorta is resistant to compression, owing to its structure</strong>. The vena caval compression normally,&nbsp;however, results in opening up of collateral circulation by means of paravertebral and azygous veins. In some cases, when the collateral circulation fails to open up, the venous return of the heart may be seriously curtailed.</p>\n<p>This results in hypotension, tachycardia,&nbsp;and syncope and is called supine vena cava&nbsp;syndrome. The normal blood pressure is quickly restored by turning the patient to the&nbsp;lateral position.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/818a11bfd02342e28fd5896ef76828b9.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Fitz-Hugh-Curtis syndrome is ________",
    "choices": [
      {
        "id": 1,
        "text": "Perihepatitis"
      },
      {
        "id": 2,
        "text": "Cholecystitis"
      },
      {
        "id": 3,
        "text": "Tuboovarian abscess"
      },
      {
        "id": 4,
        "text": "Gonococcal urethritis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Fitz-Hugh-Curtis syndrome is a&nbsp;<strong>perihepatitis </strong>which occurs in the setting of pelvic inflammatory disease (PID).</p>\n<p>It occurs in approximately 10 percent of women with acute PID.</p>\n<p>Gonococcal salpingits / chlamydial infection &rarr; transperitoneal / vascular spread&nbsp;&rarr; inflammation of the liver capsule and peritoneal surfaces of the anterior right upper quadrant.</p>\n<p>Characterized by<strong> right upper quadrant abdominal pain</strong> with a pleuritic component, sometimes referred to the right shoulder.</p>\n<div class=\"page\" title=\"Page 94\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 94\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Liver parenchyma and stroma are not involved</strong>. Aminotransferases are usually normal or only slightly elevated.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d1de68d453f44e3696b6d3c68d969a1cx512x288.PNG"
    ]
  },
  {
    "text": "During Pomeroy technique of female sterilization, which portion of the tube is ligated?",
    "choices": [
      {
        "id": 1,
        "text": "Isthmo- ampullary"
      },
      {
        "id": 2,
        "text": "Ampullary"
      },
      {
        "id": 3,
        "text": "Isthmus"
      },
      {
        "id": 4,
        "text": "Corneal"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Isthmus </strong>is ligated in&nbsp;<strong>Pomeroy technique</strong>.</p>\n<p>The most popular technique of tubal ligation is the Pomeroy&nbsp;technique.</p>\n<p>The operation is simple, requires short hospitalization and is surgically <strong>reversible</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/68eb0440727d410ca729173009d8a441x1200x2309.JPEG"
    ]
  },
  {
    "text": "A 4 day old baby is active and feeding well. He has a bilirubin level of 8 mg/dl. What is the next step in the management of the baby?",
    "choices": [
      {
        "id": 1,
        "text": "Exchange transfusion"
      },
      {
        "id": 2,
        "text": "Stop breastfeeding and start phototherapy"
      },
      {
        "id": 3,
        "text": "IV fluids and phototherapy"
      },
      {
        "id": 4,
        "text": "Continue breastfeeding"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Since this child has a bilirubin level of only <strong>8 mg/dl</strong> on the 4<sup>th</sup> day, it points to <strong>physiologic jaundice</strong>. The child is active and feeding well, the\u00a0mother should be encouraged to <strong>continue breastfeeding\u00a0frequently and exclusively.</strong></p>\n<p>All the <strong>other options</strong> would be possible treatment choices if the child had <strong>pathological jaundice.\u00a0</strong></p>\n<p>Physiological jaundice/Icterus neonatorum is due to\u00a0<strong>increased bilirubin production</strong>\u00a0from the\u00a0<strong>breakdown</strong>\u00a0of\u00a0<strong>fetal red</strong>\u00a0<strong>blood cells</strong>\u00a0combined with transient\u00a0<strong>limitation in the conjugation of bilirubin</strong>\u00a0by the immature\u00a0<strong>neonatal liver</strong>. It first\u00a0<strong>appears on the 2nd or 3rd days</strong> usually peaks on the 4th day at 5-6 mg/dL and decreases to &lt;2 mg/dL\u00a0<strong>between the 5th and 7th days after birth.</strong>\u00a0</p>\n<p>On the other hand, in pathological jaundice, appearance is <strong>within the first 24 hours after birth</strong> and may be present at or <strong>beyond the age of 2 weeks</strong> in term babies and 3 weeks in preterm babies. There may be an <strong>elevated direct (or conjugated) bilirubin level</strong>. Jaundice visible on the palms and soles, unresponsiveness to phototherapy, and a rapid rise in bilirubin levels during phototherapy indicate pathological jaundice.</p>\n<p><strong>Phototherapy</strong> is initiated in babies with pathological jaundice when the <strong>bilirubin levels</strong> <strong>exceed the 95th percentile</strong> on the total serum bilirubin (TSB) normogram. Babies are kept at a distance of <strong>30-45 cm</strong> from the <strong>UV lamp (460-490 nm)</strong> with <strong>eyes and gonads covered.</strong> It is avoided in babies with conjugated hyperbilirubinemia due to the risk of bronze-baby syndrome. <strong>Dehydration</strong> and <strong>hypocalcemia </strong>are potential <strong>complications</strong> and breastfeeding is encouraged.</p>\n<p><strong>Exchange transfusion</strong> (ET) is done in cases of bilirubin encephalopathy, Rh incompatibility with significant hemolysis, and bilirubin values exceeding TSB cutoffs for ET.</p>\n<div class=\"panel panel-default ng-scope\" style=\"box-sizing: border-box; margin-bottom: 20px; background-color: #ffffff; border: 1px solid #dddddd; border-radius: 4px; box-shadow: rgba(0, 0, 0, 0.05) 0px 1px 1px; color: rgba(0, 0, 0, 0.87); font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><span style=\"font-size: 12pt;\"><strong>Note:</strong> Phototherapy acts mainly by structural isomerization. Phototherapy is effective only when there is bilirubin in the skin. So, there is no role of prophylactic phototherapy.</span></div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55 year old female complains of lower backache. The radiographic image of her lumbosacral spine is given below. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Osteoporosis"
      },
      {
        "id": 2,
        "text": "Ankylosing spondylitis"
      },
      {
        "id": 3,
        "text": "Osteomalacia"
      },
      {
        "id": 4,
        "text": "Renal osteodystrophy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above image depicts&nbsp;<strong>ballooning of disc spaces&nbsp;</strong>leading to&nbsp;<strong>biconcave shape of vertebral body&nbsp;</strong>known as&nbsp;<strong>&lsquo;Cod&nbsp;</strong><strong>fish appearance&rsquo;,&nbsp;</strong>classically seen in&nbsp;<strong>osteoporosis.</strong>&nbsp;</p>\n<p>It is caused due to the reduction in the strength of the bone that leads to an increased risk of fractures. WHO defines osteoporosis as a T score&nbsp;<strong>less than -2.5</strong>. It is the&nbsp;<strong>gold standard to assess bone mineral density</strong>.</p>\n<p><strong>Other radiological features of osteoporosis:</strong></p>\n<ul>\n<li><strong>Loss of vertical height&nbsp;</strong>of vertebra due to collapse</li>\n<li><strong>Ground glass appearance of bones&nbsp;</strong>especially in the bones like pelvis</li>\n<li>Loss of cortical bone (<strong>picture frame vertebrae</strong>) and trabecular bone (<strong>ghost vertebrae</strong>)</li>\n<li>Loss of trabeculae in proximal femur area.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2f2a1d0501014043a35b81e8bca026d5.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The Doppler waveform of the venous blood flow in lower limb DVT is?",
    "choices": [
      {
        "id": 1,
        "text": "Monophasic"
      },
      {
        "id": 2,
        "text": "Biphasic"
      },
      {
        "id": 3,
        "text": "Triphasic"
      },
      {
        "id": 4,
        "text": "Non Phasic"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>Doppler waveform</strong> of the <strong>venous blood flow</strong> in l<strong>ower limb deep vein thrombosis </strong>is\u00a0<strong>monophasic.</strong></p>\n<p>The normal venous waveform shows variation (phasicity)\u00a0secondary to respiration referred to as <strong>respirophasic waveform</strong>.</p>\n<p>Loss of this phasic variation results in a <strong>monophasic waveform </strong>suggestive\u00a0of venous obstruction proximal to the level of interrogation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 23-year-old female is overly attached to her mother. She feels uncomfortable when she is away from her mother and always prefers to be with her.  She has difficulty making everyday decisions without an excessive amount of advice and reassurance from her mother. Which of the following best describes this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Anankastic personality disorder"
      },
      {
        "id": 2,
        "text": "Borderline personality disorder"
      },
      {
        "id": 3,
        "text": "Avoidant personality disorder"
      },
      {
        "id": 4,
        "text": "Dependent personality disorder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given history describes a person with dependent personality disorder.</p>\n<p>Persons with dependent personality disorder :</p>\n<ul>\n<li style=\"font-weight: 400;\">Have difficulty in making everyday decisions without an excessive amount of advice and reassurance from others.</li>\n<li style=\"font-weight: 400;\"><strong>Need others to assume responsibility</strong> <strong>for most major areas of their lives.</strong></li>\n<li style=\"font-weight: 400;\">Have difficulty expressing disagreement with others because of fear of loss of support.</li>\n<li style=\"font-weight: 400;\">Have difficulty initiating projects or doing things on his or her own.</li>\n<li style=\"font-weight: 400;\">Go to any extreme to obtain nurturance and support from others.</li>\n<li style=\"font-weight: 400;\"><strong>Feel uncomfortable or helpless when alone.</strong></li>\n<li style=\"font-weight: 400;\">Urgently seek another relationship as a source of care or support when a close relationship ends.</li>\n</ul>\n<p>They risk <strong>major depressive disorder</strong> if they lose the person on whom they depend, but with treatment, the prognosis is favorable.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A most common preventable cause of anesthetic mishaps is:",
    "choices": [
      {
        "id": 1,
        "text": "Faulty laryngoscope"
      },
      {
        "id": 2,
        "text": "Ventilator dysfunction"
      },
      {
        "id": 3,
        "text": "Anesthetic machine malfunction"
      },
      {
        "id": 4,
        "text": "Human errors"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The most common preventable cause of anesthetic mishaps is&nbsp;<strong>human error.</strong></p>\n<p>&nbsp;<strong>Common human errors include:</strong></p>\n<ul>\n<li>Unrecognized breathing circuit disconnection</li>\n<li>Mistaken drug administration</li>\n<li>Airway mismanagement</li>\n<li>Anesthesia machine misuse</li>\n<li>Fluid mismanagement</li>\n<li>Intravenous line disconnection</li>\n</ul>\n<p><strong>Equipment malfunctions</strong>&nbsp;that can cause preventable anesthetic accidents are:</p>\n<ul>\n<li>Breathing circuit malfunction</li>\n<li>Monitoring device&nbsp;malfunction</li>\n<li>Ventilator&nbsp;dysfunction</li>\n<li>Anesthesia machine&nbsp;malfunction</li>\n<li>Faulty laryngoscope</li>\n</ul>\n<p>Unpreventable mishaps include sudden death syndrome and fatal idiosyncratic drug reactions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man was brought to the casualty with a 3-day history of the findings shown. On examination, 50% of the body surface area was involved. Hemorrhagic cheilitis and crusting were also noted. What are the diagnosis and most probable underlying etiology?",
    "choices": [
      {
        "id": 1,
        "text": "Stevens Johnson syndrome; Mycoplasma pneumoniae infection"
      },
      {
        "id": 2,
        "text": "Stevens Johnson syndrome; cephalosporin intake"
      },
      {
        "id": 3,
        "text": "Toxic epidermal necrolysis; viral infection"
      },
      {
        "id": 4,
        "text": "Toxic epidermal necrolysis; carbamazepine intake"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>As more than 30% of the body surface is involved, the diagnosis is <strong>toxic epidermal necrolysis (TEN)</strong>.&nbsp;SJS/TEN is primarily a <strong>drug\u2010induced</strong> phenomenon, with a culprit drug being demonstrated in approximately 85% of cases.</p>\n<p>Common <strong>drugs</strong> that can cause SJS/TEN are:</p>\n<ul>\n<li>Allopurinol</li>\n<li>NSAIDs - oxicam group</li>\n<li>Anti-epileptics - phenobarbital, phenytoin, carbamazepine, lamotrigine</li>\n<li>Antibiotics - penicillins, cephalosporins, sulfamethoxazole, sulfasalazine, nevirapine</li>\n</ul>\n<p>In 15% of the cases, where the drug cannot be identified, especially in <strong>children</strong>, appear to be triggered by <strong>infections</strong>, most notably by <em>Mycoplasma pneumoniae</em>.</p>\n<p>Note: FDA recommends genotyping before starting carbamazepine, as HLA B1502 allele which is seen in increased frequencies among Asians is implicated in carbamazepine induced SJS/TEN.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/057f214e6fd94b4dbd620eff52086597.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The Bone scan in multiple myeloma shows _____",
    "choices": [
      {
        "id": 1,
        "text": "Hot spot"
      },
      {
        "id": 2,
        "text": "Cold spot"
      },
      {
        "id": 3,
        "text": "Diffusely increased uptake"
      },
      {
        "id": 4,
        "text": "Diffusely decreased uptake"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The Bone scan in <strong>multiple myeloma</strong> shows\u00a0<strong>cold spot,\u00a0</strong>as there is <strong>no compensatory osteoblastic activity.</strong></p>\n<p>Multiple myelomas are the most common primary malignant bone neoplasm in adults arising from red marrow due to the monoclonal proliferation of the <strong>plasma cells.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 017';
        const quizFilename = 'fmge-mini-test-017-c187e29d.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>