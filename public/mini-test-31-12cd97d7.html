<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 31 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 60-year-old patient who is a  known case of diabetes mellitus with an HbA1c value of 8.8% has been posted for surgery after pre-anesthetic evaluation. Which of the following is used for the physical status classification of the patient during the pre-anesthetic evaluation?",
    "choices": [
      {
        "id": 1,
        "text": "Thyromental distance"
      },
      {
        "id": 2,
        "text": "Mallampati classification"
      },
      {
        "id": 3,
        "text": "ASA classification"
      },
      {
        "id": 4,
        "text": "Neck circumference"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>American Society of Anesthesiologists classification</strong> (ASA-PS) is used to classify physical status.</p>\n<p>An integral part of the pre-anesthetic evaluation is assessing a patient's risk for undergoing anesthesia and surgery. This helps the anesthetist make <strong>informed clinical decisions</strong> and helps the <strong>patient</strong> <strong>understand</strong> their <strong>risks</strong>.\u00a0</p>\n<p>After classifying patients based on this risk assessment, those who require <strong>more intensive postoperative monitoring</strong> can be identified. In addition, patients who are at <strong>high risk</strong> for <strong>complications</strong> can be <strong>identified</strong> and <strong>alternative interventions</strong> considered.\u00a0</p>\n<p>The ASA-PS is the most commonly used risk assessment. However, it is important to note that it describes only the <strong>patient's preoperative status</strong> and not the risks associated with the specific procedure that the patient will undergo.\u00a0</p>\n<p><strong>Thyromental distance</strong> (Option A), <strong>Mallampati classification</strong> (Option B), and <strong>neck circumference</strong> (Option D) are used to assess difficult airways.\u00a0</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An anatomy resident while observing the histological section of the thymus under high magnification identifies the following structure in the medullary area of the thymus. These structures are derived from which pharyngeal pouch?",
    "choices": [
      {
        "id": 1,
        "text": "First pharyngeal pouch"
      },
      {
        "id": 2,
        "text": "Second pharyngeal pouch"
      },
      {
        "id": 3,
        "text": "Third pharyngeal pouch"
      },
      {
        "id": 4,
        "text": "Fourth pharyngeal pouch"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The magnified view of the histology slide shows the&nbsp;<strong>Hassall&rsquo;s corpuscles</strong> (thymic corpuscles) which are seen in the medullary area of the thymus. They are derived from the <strong>3rd pharyngeal pouch.</strong></p>\n<p>Hassall&rsquo;s corpuscles are small rounded structures formed from <strong>whorls of medullary epithelial cells</strong> with a central partially keratinized core appearing as eosinophilic staining mass.</p>\n<p>The <strong>3rd pharyngeal pouch</strong> gives rise to the <strong>thymus</strong> in the ventral part and the <strong>inferior parathyroid gland</strong> in the dorsal part. The <strong>thymus</strong> then <strong>moves away</strong> from the pharyngeal wall in a <strong>caudal</strong> and <strong>medial direction</strong>, pulling the inferior parathyroid with it. It reaches the anterior part of the thorax, where it fuses with its counterpart from the opposite side.</p>\n<p>The endodermal cells of the thymus get invaded by the vascular mesoderm, which contains numerous lymphoblasts. <strong>Hassall&rsquo;s corpuscles (thymic corpuscles)</strong> are derived from the <strong>endoderm</strong> of the <strong>3rd pouch</strong>.</p>\n<p>The following image describes the derivatives of the pharyngeal pouches.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1c0b9d9001854549b4ab7b246010fe79.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/488fe56869f04e7b9a2876c800451789x1280x1407.JPEG"
    ]
  },
  {
    "text": "After a diet rich in cholesterol, it is seen that the de novo synthesis of cholesterol in the liver decreases. Which of the following enzymes is involved in this?",
    "choices": [
      {
        "id": 1,
        "text": "Acetoacetyl CoA synthase"
      },
      {
        "id": 2,
        "text": "HMG CoA lyase"
      },
      {
        "id": 3,
        "text": "HMG CoA synthase"
      },
      {
        "id": 4,
        "text": "HMG CoA reductase"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Among the given options, the enzyme&nbsp;<strong>HMG CoA reductase</strong> is involved in the <strong>regulation </strong>of<strong> cholesterol synthesis</strong> in the body.</p>\n<div class=\"page\" title=\"Page 261\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>HMG-CoA</strong> is <strong>reduced</strong> to mevalonate by <strong>NADPH</strong> in a reaction catalyzed by <strong>HMG-CoA reductase</strong> which is the <strong>principal regulatory step</strong> in the pathway of cholesterol synthesis. It is the site of action of the cholesterol-lowering statins, which are HMG-CoA reductase inhibitors.</p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>Long-term regulation</strong> of cholesterol synthesis involves <strong>regulating</strong> the <strong>transcription</strong> of the gene for HMG CoA reductase. When there is <strong>sufficient cholesterol</strong> in the cell, <strong>transcription</strong> of the gene for HMG CoA reductase is <strong>suppressed</strong>, and there is <strong>decreased synthesis</strong> of cholesterol.&nbsp;</p>\n<p>When cholesterol is less, proteases in the Golgi bodies cleave a sterol regulatory element-binding protein (SREBP). The protein which is then formed binds to a sterol regulatory element (SRE) on the DNA. This activates transcription of the HMG CoA reductase gene which increases cholesterol synthesis.</p>\n<p>Hormones that influence HMG reductase are:</p>\n<ul>\n<li><strong>Insulin </strong>and<strong> thyroxine</strong> <strong>increase</strong> the activity of HMG CoA reductase</li>\n<li><strong>Cortisol </strong>and<strong> glucagon decrease</strong> the activity of HMG CoA reductase</li>\n<li><strong>Statins inhibit</strong> the activity of HMG CoA reductase</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/affadf70f6e14d269ed81f681a304e06x600x566.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7087eb4a999a413da1c7e7c4a3566407x510x692.PNG"
    ]
  },
  {
    "text": "The data which best explains the difference between the highest and the lowest values is:",
    "choices": [
      {
        "id": 1,
        "text": "Variance"
      },
      {
        "id": 2,
        "text": "Coefficient of variation"
      },
      {
        "id": 3,
        "text": "Range"
      },
      {
        "id": 4,
        "text": "Interquartile range"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Range</strong> gives the <strong>difference </strong>between the<strong> highest </strong>and l<strong>owest</strong>&nbsp;values in a given set of data.</p>\n<p>In a dataset of marks of students in a subject, if the highest score is 100 and the lowest is 51, the range would be 49.</p>\n<p>Option A:<strong> Variance&nbsp;</strong>(var or SD&sup2;) is the&nbsp;<strong>mean </strong>of the<strong> squares </strong>of all the <strong>deviation scores</strong>&nbsp;of the distribution. It is used to&nbsp;measure how far<strong> data </strong>is<strong> spread out</strong>.</p>\n<p>Option B:<strong> Coefficient of variation</strong> (CV) is used to <strong>compare</strong> the <strong>variability</strong>. For example, whether the pulse varies more in old or young and growth varies more in boys or girls. It is calculated by expressing SD as a percentage of the mean, i.e., <strong>CV = SD/mean x 100</strong>. Since it is expressed as a percentage it doesn't have any units.</p>\n<p>Option D<strong>: Quartiles</strong> divide the distribution into <strong>4 equal groups</strong>. The difference between mid values of each quartile gives the interquartile range.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old woman presented with the following lesions. Her serum angiotensin-converting enzyme levels were found to be higher than normal. What is the likely systemic disease associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Dermatomyositis"
      },
      {
        "id": 2,
        "text": "Tuberculosis"
      },
      {
        "id": 3,
        "text": "Erysipelas"
      },
      {
        "id": 4,
        "text": "Sarcoidosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient with<strong> cutaneous red-purple indurated plaques </strong>and<strong> nodules over the nose and cheeks </strong>and<strong> elevated angiotensin-converting enzyme levels</strong> is likely to have<strong> lupus pernio</strong>.<strong> </strong>The likely systemic disease associated with this condition is<strong> sarcoidosis</strong>.<strong>\u00a0</strong></p>\n<p><strong>Cutaneous sarcoidosis</strong> presents as\u00a0red\u2010brown or red violaceous nodules or plaques, generally multiple, and does not cause symptoms. Diascopy reveals the subtle <strong>brown\u2010yellow</strong> <strong>or \u2018apple jelly</strong>\u2019 color characteristic of granulomatous diseases but is usually more opaque than in lupus vulgaris. At diagnosis, at least <strong>60% of patients</strong> have an <strong>increased serum angiotensin\u2010converting enzyme level.</strong></p>\n<p><strong>Lupus pernio</strong> is the <strong>most distinctive</strong> manifestation of cutaneous sarcoidosis. It presents as infiltrated <strong>erythemato-violaceous plaques</strong> involving the nose, cheeks, ears, lips, forehead, and fingers. On the cheeks, a prominent telangiectatic component is characteristic.\u00a0The clinical appearance is due to the presence of <strong>epithelioid cell granulomas</strong> in the dermis.</p>\n<p>Lupus pernio is usually <strong>painless</strong> and, as it does not tend to ulcerate, is not as mutilating as lupus vulgaris. In more than half of cases, it is associated with sarcoidosis of the <strong>upper respiratory tract</strong>, especially in patients with involvement of the <strong>nasal rims</strong>.\u00a0It is also frequently associated with <strong>pulmonary fibrosis</strong>, chronic uveitis, and bony cysts, particularly affecting the terminal phalanges.</p>\n<p>The image below shows the apple jelly appearance on diascopy:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/337acc68a11b449482cf6ab0841d95b0.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3547e63466a845a9ba262d8a975c1340x512x423.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bf9fe60313d24244b2575098d299d82ax720x286.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/085073e7b41d49ceae91b25f7632b189x720x413.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/487502ee392c45d69d9a679500e4695dx1280x1211.JPEG"
    ]
  },
  {
    "text": "A 15-year-old boy presented with a speech disorder and a history of recurrent bouts of secretory otitis media in the past. On examination, he was found to have a bifid uvula and a short soft palate with adenoid hypertrophy. The patient underwent adenoidectomy. The most specific speech disorder expected in this patient postoperatively is:",
    "choices": [
      {
        "id": 1,
        "text": "Rhinolalia clausa due to postoperative nasopharyngeal stenosis"
      },
      {
        "id": 2,
        "text": "Rhinolalia aperta due to postoperative velopharyngeal insufficiency"
      },
      {
        "id": 3,
        "text": "Rhinolalia clausa due to postoperative velopharyngeal insufficiency"
      },
      {
        "id": 4,
        "text": "Rhinolalia aperta due to postoperative nasopharyngeal stenosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Rhinolalia aperta</strong> due to postoperative velopharyngeal insufficiency is the most specific postoperative complication in this case.</p>\n<p><strong>Preoperatively</strong>, the patient initially presents with a speech disorder, most probably, <strong>rhinolalia clausa</strong> (hypo-nasality) due to <strong>adenoid hypertrophy.</strong> Rhinilalia clausa is the<strong> lack of nasal</strong> <strong>resonance</strong> for words that are normally resonated in the nasal cavity such as m, n, and ng. It occurs due to <strong>blockage</strong> of the <strong>nose</strong> or <strong>nasopharynx</strong>.\u00a0</p>\n<p><strong>Postoperatively</strong>, the patient with a history of<strong> bifid uvula</strong> and <strong>short soft palate</strong> (significant of submucous cleft palate) is likely to develop <strong>rhinolalia aperta</strong> (hypernasality). In this condition, <strong>words</strong> that have little resonance, <strong>are resonated</strong> in the nose. This occurs because the nasopharynx cannot be cut off from the oropharynx or when there is <strong>abnormal communication</strong> between the <strong>oral</strong> and <strong>nasal</strong> <strong>cavities</strong>. The presence of a submucous cleft palate is a contraindication for adenoidectomy as it can lead to velopharyngeal insufficiency.</p>\n<p>\u00a0</p>\n<table style=\"height: 15px;\" width=\"349\">\n<tbody>\n<tr>\n<td style=\"width: 166.5px;\"><strong>Rhinolalia clausa</strong><br /><strong>(Hyponasality)</strong></td>\n<td style=\"width: 166.5px;\"><strong>Rhinolalia aperta</strong><br /><strong>(Hypernasality)</strong></td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">Common cold</td>\n<td style=\"width: 166.5px;\">Velopharyngeal insufficiency</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">Nasal allergy</td>\n<td style=\"width: 166.5px;\">Congenitally short soft palate</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">Nasal polypi</td>\n<td style=\"width: 166.5px;\">Submucous palate</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">Nasal growth</td>\n<td style=\"width: 166.5px;\">Large nasopharynx</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">Adenoids</td>\n<td style=\"width: 166.5px;\">Cleft of the soft palate</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">Nasopharyngeal mass</td>\n<td style=\"width: 166.5px;\">Paralysis of the soft palate</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">Familial speech pattern</td>\n<td style=\"width: 166.5px;\">Post adenoidectomy</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">Habitual</td>\n<td style=\"width: 166.5px;\">Oronasal fistula</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">\u00a0</td>\n<td style=\"width: 166.5px;\">Familial speech pattern</td>\n</tr>\n<tr>\n<td style=\"width: 166.5px;\">\u00a0</td>\n<td style=\"width: 166.5px;\">Habitual</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Under McNaughten's rule, which of the following criteria is not valid to clear a mentally unsound person of all responsibility?",
    "choices": [
      {
        "id": 1,
        "text": "Evidence of psychiatric illness"
      },
      {
        "id": 2,
        "text": "Presence of uncontrollable impulse"
      },
      {
        "id": 3,
        "text": "Psychiatric illness while committing the crime"
      },
      {
        "id": 4,
        "text": "Inability to understand that the act is wrong"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The criterion of the\u00a0<strong>presence of uncontrollable impulse\u00a0</strong>is not included in McNaughten's rule. Therefore, it is not a valid criterion to clear a mentally unsound person of all criminal responsibility.</p>\n<p>McNaughten's rule is followed by the British Courts of law to examine the liability of a mentally unsound person who has committed a crime. <strong>BNS 22\u00a0</strong>is the Indian adaptation of this rule.\u00a0</p>\n<p>McNaughten's rule forms the basis of the\u00a0<strong>legal test of insanity/the 'right or wrong' test.\u00a0</strong>It states that a mentally unsound person is cleared of all criminal responsibility for the crime committed if the following criteria are met:</p>\n<ul>\n<li>Presence of evidence of psychiatric illness.</li>\n<li>Existence of psychiatric illness at the time of the commission of the crime.</li>\n<li>Psychiatric illness is of such a degree that the person does not have the ability to understand the wrongness of the act, i.e., impaired intellectual ability.\u00a0</li>\n</ul>\n<p>McNaughten's rule decide a person's soundness of mind based on the presence or absence of intellectual ability. However, it fails to consider any impairments in the person's emotional state or the presence of any\u00a0<strong>uncontrollable/ irresistible impulses\u00a0</strong>while committing the act.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young non-obese patient presented with increased fatigue for several months. Two of his relatives have a history of early-onset diabetes. Investigations revealed high blood glucose and low serum insulin levels. Urine ketones and islet autoantibodies were negative.  There was an improvement after 2 weeks of glimepiride. Which of the following is incorrect regarding this condition?",
    "choices": [
      {
        "id": 1,
        "text": "It is an autosomal-dominant disease"
      },
      {
        "id": 2,
        "text": "Type 3 is most common type"
      },
      {
        "id": 3,
        "text": "It responds to all oral hypoglycemic agents"
      },
      {
        "id": 4,
        "text": "It is associated with cystic kidney disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-preserver-spaces=\"true\">This patient is likely to have&nbsp;<strong>maturity-onset diabetes of the young&nbsp;</strong>(MODY). It <strong>responds only</strong> to <strong>sulphonylureas</strong> (glimepiride, glipizide), not all oral hypoglycemic agents.</span></p>\n<p><span data-preserver-spaces=\"true\">The clinical vignette describes a young <strong>non-obese</strong> patient with a <strong>positive family history of diabetes.</strong> Features of reduced insulin level with <strong>no antibodies</strong>, <strong>negative urinary ketones</strong>, and a good response to a sulphonylurea drug (glimepiride) rule out the possibility of Type 1 diabetes mellitus.</span></p>\n<p><span data-preserver-spaces=\"true\">MODY is a <strong>monogenic</strong> disorder inherited in an <strong>autosomal dominant</strong> fashion. It is generally <strong>inherited</strong> at the age of <strong>25 years or younger.</strong> Patients are generally not obese. The pathophysiology of this condition involves <strong>impaired glucose-induced secretion of insulin.&nbsp;</strong></span></p>\n<p><span data-preserver-spaces=\"true\">There are <strong>six types</strong> of MODY. However, <strong>type 3 </strong>is the <strong>most common</strong>. Types 1, 3 and 5 occur due to mutations in the&nbsp;<strong>hepatic nuclear factor</strong>. Type 2 occurs due to a mutation in the glucokinase gene and type 4 occurs due to mutations in pancreatic and duodenal homeobox 1. MODY type 5 is associated with <strong>renal cysts</strong>.</span></p>\n<p><span data-preserver-spaces=\"true\">Patients usually respond to therapy with <strong>sulfonylureas</strong> but eventually require insulin as a result of beta-cell failure.&nbsp;</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 34-year-old male patient presented with severe dyspnea, mild fever, joint pains, and joint swelling. He has had similar episodes in the past. Examination revealed mitral stenosis and left atrial hypertrophy. Echocardiography showed small warty vegetations along the lines of the closure of the mitral valve leaflets. How long will you give secondary prophylaxis to this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Till 44 years of age"
      },
      {
        "id": 2,
        "text": "Till 39 years of age"
      },
      {
        "id": 3,
        "text": "Till 40 years of age"
      },
      {
        "id": 4,
        "text": "Till  50 years of age"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient with <strong>repeated</strong> <strong>episodes</strong>\u00a0of severe <strong>dyspnea</strong>, mild <strong>fever</strong>, <strong>arthralgia</strong>,\u00a0<strong>joint</strong> <strong>swelling</strong>, <strong>mitral</strong> <strong>stenosis</strong>, and <strong>warty valvular</strong> <strong>vegetation</strong> is likely to have <strong>rheumatic heart disease</strong>. Since he is a 34-year-old with carditis with residual valve disease, he should receive prophylaxis until he is<strong> 44 years of age.\u00a0</strong></p>\n<p>Secondary prophylaxis is given to patients with acute rheumatic fever (ARF) and rheumatic heart disease (RHD). These patients are at a higher risk of developing a further episode after a <strong>group A streptococcal infection</strong>. Hence they should receive long-term penicillin prophylaxis to prevent recurrent infections.\u00a0</p>\n<p><span class=\"fontstyle0\">In those with rheumatic fever with<strong> persistent valvular disease</strong>, prophylaxis should be given <strong>for 10 years</strong> after the last episode <strong>or</strong> till they <strong>attain 40 years of age</strong> (whichever is <strong>longer</strong>). As he is 34 years of age, providing prophylaxis for 10 years till he attains 44 years of age is longer than until he turns 40.</span></p>\n<p><span class=\"fontstyle0\">Lifelong medication can be continued in severe valvular disease or postintervention (after valve surgery) patients.</span></p>\n<p><span class=\"fontstyle0\">The best antibiotic for secondary prophylaxis is <strong>benzathine penicillin G</strong> (1.2 million units) given\u00a0<strong>every 4 weeks</strong>.\u00a0</span><span class=\"fontstyle0\">Oral penicillin V (250 mg) can be given twice daily instead, but is less effective than benzathine penicillin G. Patients who are allergic to penicillin can receive erythromycin (250 mg) twice daily.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old male patient presented with psychosis and visual hallucinations that began several months ago. He now has dementia,  memory loss, impaired judgment, and intermittent myoclonus. He passes away 1 year after the onset of symptoms.\u00a0Brain biopsy reveals PrPsc proteins accumulations. Which of the following is this agent sensitive to?",
    "choices": [
      {
        "id": 1,
        "text": "Dry heat"
      },
      {
        "id": 2,
        "text": "Ionizing radiation"
      },
      {
        "id": 3,
        "text": "Ethanol"
      },
      {
        "id": 4,
        "text": "Phenol"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical vignette suggests Creutzfeldt Jakob disease, a condition caused by prions. Prions are sensitive to phenol.</p>\n<p>The patient with psychosis, visual hallucinations, dementia, memory loss, impaired judgment, intermittent myoclonus, death one year after onset of symptoms, and brain biopsy significant for\u00a0<strong>PrP<sup>Sc</sup></strong>\u00a0accumulations is likely to have Creutzfeldt Jakob disease.\u00a0\u00a0</p>\n<p><strong>Prions</strong> are the proteinaceous infectious particle that lacks nucleic acid, composed entirely of alternatively folded proteins that undergo self-propagation.\u00a0<strong>PrP<sup>Sc</sup></strong>\u00a0is the disease-causing isoform of the prion protein. Diagnosis can be established by detecting\u00a0<strong>PrP<sup>Sc</sup></strong>\u00a0proteins in brain biopsy. However, the diagnosis can be made clinically.</p>\n<p>Prions are <strong>resistant</strong> to formaldehyde, urea, <strong>dry</strong> <strong>heat</strong>, boiling, <strong>ethanol</strong>, proteases, deoxycholate, and <strong>ionizing radiation</strong>. They are sensitive to <strong>phenol</strong>, household bleach, ether, sodium hydroxide, strong detergents, and autoclaving.\u00a0</p>\n<p><strong>Other diseases caused by prions include:</strong></p>\n<ul>\n<li>Creutzfeldt\u00ad Jakob disease</li>\n<li>Gerstmann\u00ad Str\u00e4ussler \u00adScheinke syndrome\u00a0</li>\n<li>Fatal familial insomnia\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0</li>\n<li>Kuru in humans\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0</li>\n<li>Scrapie in sheep and goats \u00a0\u00a0</li>\n<li>Bovine spongiform en\u00adcephalopathy in cows</li>\n</ul>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old overweight woman presents with complaints of irregular periods for the last year. Physical examination revealed a BMI of 32 kg/m2 with signs of hirsutism. Pelvic sonographic findings show multiple ovarian follicles arranged in a necklace pattern. Which of the following drugs cannot be used in the treatment of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Letrozole"
      },
      {
        "id": 2,
        "text": "Finasteride"
      },
      {
        "id": 3,
        "text": "Centchroman"
      },
      {
        "id": 4,
        "text": "Cyproterone acetate"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Ulipristal&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:16897,&quot;3&quot;:{&quot;1&quot;:0},&quot;12&quot;:0,&quot;17&quot;:1}\">The clinical scenario suggests a diagnosis of <strong>polycystic ovarian disease </strong>(PCOD).&nbsp;<strong>Centrochroman</strong> is not used in the treatment of PCOD.&nbsp;<br /><br />PCOD is attributed to obesity, smoking, and poor diet. The affected ovary or ovaries have cysts (12 or more) that are composed of atretic follicles, coupled with theca and stromal cell hyperplasia.&nbsp;&nbsp;</span></p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Ulipristal&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:16897,&quot;3&quot;:{&quot;1&quot;:0},&quot;12&quot;:0,&quot;17&quot;:1}\">Symptoms of PCOD include hirsutism and acne (due to hyperandrogenism), anovulation followed by amenorrhea, or heavy menstrual or intermenstrual bleeding.</span></p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Ulipristal&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:16897,&quot;3&quot;:{&quot;1&quot;:0},&quot;12&quot;:0,&quot;17&quot;:1}\">Diagnosis is made by pelvic&nbsp;<strong>ultrasound</strong> which shows <strong>\"necklace\"</strong> appearance. Endomtrial hyperplasia may also be present.&nbsp;</span></p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Ulipristal&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:16897,&quot;3&quot;:{&quot;1&quot;:0},&quot;12&quot;:0,&quot;17&quot;:1}\">Treatment of PCOD includes l</span><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Ulipristal&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:16897,&quot;3&quot;:{&quot;1&quot;:0},&quot;12&quot;:0,&quot;17&quot;:1}\">ifestyle modification such as smoking cessation, diet, and exercise with a focus on weight reduction, c</span>ombined oral contraceptives to regularize menstrual cycles and decrease androgen levels.&nbsp;</p>\n<p>To treat hirsutism, 5&alpha;-reductase inhibitors like <strong>finasteride </strong>are effective;&nbsp;<strong>eflornithine hydrochloride</strong> cream prevents hair growth.<br />&nbsp;<br />Clomiphene is the first line of treatment for women with infertility. It may be combined with dexamethasone to improve the fertility rate.</p>\n<p>Metformin treats the root cause of PCOS, rectifies endocrine and metabolic functions, and improves the fertility rate. It is used as an insulin sensitizer and induces spontaneous ovulation.</p>\n<p>Surgery is indicated when <strong>medical therapy fails</strong>, when there is a history of&nbsp;<strong>previous pregnancy losses</strong>, when there is infertility, or when hyperstimulation occurs. Surgery comprises of laparoscopic<span class=\"Apple-converted-space\">&nbsp;ovarian drilling of not more than 4 cysts in each ovary by laser or unipolar electric cautery. It improves fertility for a period of one year.&nbsp;</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "After a road traffic accident, an old man experienced the sudden blurring of vision and floaters in his right eye. What would be the ideal investigation of choice for the suspected vitreous hemorrhage?",
    "choices": [
      {
        "id": 1,
        "text": "Optical coherence tomography"
      },
      {
        "id": 2,
        "text": "Ultrasound A scan"
      },
      {
        "id": 3,
        "text": "Ultrasound B-scan"
      },
      {
        "id": 4,
        "text": "Electroretinography"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>investigation</strong> of <strong>choice</strong> for vitreous hemorrhage is an ultrasound<strong>&nbsp;B-scan.</strong></p>\n<p><strong>B-scan ultrasonography</strong> in unclotted vitreous hemorrhage generally shows a <strong>uniform appearance,</strong> and once cellular aggregates develop, small particulate echoes become visible.</p>\n<p>USG B can also be used to assess posterior segment in the case of opaque media, and study intraocular tumors, orbital tumors, and other mass lesions.&nbsp;</p>\n<p><strong>Vitreous hemorrhage&nbsp;</strong>has a variable presentation depending on the severity of the hemorrhage. The mild<strong>&nbsp;hemorrhage</strong> causes <strong>sudden onset floaters</strong> and diffuse blurring of vision, but may not affect visual acuity, whilst a <strong>dense bleed may result in sudden painless loss of vision.</strong></p>\n<p><strong>Causes</strong></p>\n<ul>\n<li>Acute posterior vitreous detachment associated either with a retinal tear or avulsion of a peripheral vessel</li>\n<li>Proliferative retinopathy\n<ul>\n<li>Diabetic</li>\n<li>Retinal vein occlusion</li>\n<li>Sickle cell disease</li>\n<li>Eales disease</li>\n<li>Vasculitis</li>\n</ul>\n</li>\n<li>Miscellaneous retinal disorders\n<ul>\n<li>Macroaneurysm</li>\n<li>Telangiectasia</li>\n<li>Capillary hemangioma</li>\n</ul>\n</li>\n<li>Trauma</li>\n<li>Systemic\n<ul>\n<li>Bleeding disorders</li>\n<li>Terson syndrome</li>\n</ul>\n</li>\n</ul>\n<p><strong>Treatment</strong> is dictated by severity and cause, but an increasingly low threshold is being adopted for <strong>early vitrectomy.</strong></p>\n<p><strong>Terson syndrome<br /></strong><strong>Terson</strong> syndrome refers to the <strong>combination</strong> of <strong>intraocular</strong> and <strong>subarachnoid hemorrhage</strong>&nbsp;secondary to <strong>aneurysmal rupture,</strong> most commonly arising from the <strong>anterior communicating artery.</strong></p>\n<p>Other options:&nbsp;</p>\n<p>Option A -&nbsp;<strong>Optical coherence tomography </strong>is used to provide cross-sectional or tomographic images of tissues of less than 10um axial resolution using light waves. It is used to image the anterior chamber angle, trabeculotomy blebs, tumors and cysts of the iris and ciliary body, macular disorders, diagnose glaucoma and in pachymetry.&nbsp;</p>\n<p>Option B - <strong>Ultrasound&nbsp;A-scan</strong> produces a unidimensional image. It is used to measure axial length, anterior chamber depth, and thickness of intraocular masses.&nbsp;</p>\n<p>Option D - <strong>Electroretinography </strong>records changes in the resting potential of the eye that are induced by flashes of light.&nbsp;It&nbsp;is used to evaluate <strong>retinal disorders,</strong> function, especially in cases where fundal examination is not possible.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old male child presents with complaints of high-grade fever, pain in the right knee joint for more than a week, and a recent episode of sore throat. Examination reveals knee joint tenderness. Laboratory evaluation showed elevated WBC count, ESR, and CRP. X-ray showed a faint extracortical outline in the proximal tibia. Which of the following is false regarding the complications associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Suppurative arthritis can occur if the metaphysis is intra-articular"
      },
      {
        "id": 2,
        "text": "Pathological fractures are not commonly seen in this condition"
      },
      {
        "id": 3,
        "text": "Epiphyseal damage is commonly seen in elderly individuals"
      },
      {
        "id": 4,
        "text": "Psuedoarthrosis can occur at the hip joint in  infants"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario is suggestive of <strong>acute hematogenous osteomyelitis </strong>and epiphyseal damage is seen in<strong> neonates and infants.</strong></p>\n<p><strong>Acute osteomyelitis</strong></p>\n<p>Causative organisms:</p>\n<ul>\n<li><strong>Staphylococcus </strong>is the most common organism causing osteomyelitis.</li>\n<li><strong>Pseudomonas </strong>is the most common cause in&nbsp;<strong>IV drug abusers</strong></li>\n<li><strong>Salmonella&nbsp;</strong>is the most common cause in patients of&nbsp;<strong>sickle cell anemia</strong></li>\n<li>H.influenzae was a common causative organism in children, less common now because of vaccination</li>\n<li>Streptococcus</li>\n<li>E.coli</li>\n</ul>\n<p>Route of infection: Acute osteomyelitis can be hematogenous or from exogenous routes such as open fractures, iatrogenic intervention, or spread from local infection.</p>\n<p><strong>Cardinal features</strong> of acute osteomyelitis in children include:</p>\n<ul>\n<li>Fever</li>\n<li>Pain</li>\n<li>Refusal to bear weight</li>\n<li>Elevated WBC count</li>\n<li>Elevated CRP</li>\n<li>Elevated ESR</li>\n</ul>\n<p>X-ray findings:</p>\n<ul>\n<li>During the first week, the X-ray appear to be normal and by the second week, a<strong> faint extracortical line</strong> may be visible due to periosteal new bone formation. This is a classic sign of early pyogenic osteomyelitis.</li>\n<li>A combination of<strong> regional osteoporosis</strong> with a localized segment of apparently increased density is an important late finding in this condition.</li>\n</ul>\n<p><strong>Management of acute osteomyelitis:</strong></p>\n<p>Collection of blood samples for&nbsp;<strong>culture and sensitivity test</strong>, followed by immediate&nbsp;<strong>empirical antibiotic therapy</strong>&nbsp;to prevent septicemia and other complications.&nbsp;</p>\n<p><strong>Surgical drainage</strong>&nbsp;is indicated only in the following&nbsp;<strong>two circumstances</strong></p>\n<ul>\n<li>Presence of an abscess requiring drainage</li>\n<li>Whenever the patient does not respond to antibiotics</li>\n</ul>\n<p><strong>Supportive therapy</strong>&nbsp;includes analgesics, IV fluids, and splinting of the limb.</p>\n<p>The complications of inadequately treated acute osteomyelitis include:&nbsp;</p>\n<ul>\n<li>Septicemia- Nowadays this is a rare complication due to prompt antibiotic therapy.</li>\n<li><strong>Epiphyseal damage and altered bone growth</strong>- This is seen in neonates and infants as their epiphyses are entirely cartilaginous. So the metaphysical vessels can penetrate into the physis and carry the infection to the epiphysis. In some cases involving the hip joint, the femoral head is so badly damaged and can lead to pseudoarthrosis.</li>\n<li><strong>Septic arthritis</strong>- It is seen when the metaphysics is intraarticular, in very young infants as the growth plate is penetrable, and from metastatic infection</li>\n<li><strong>Pathological fracture</strong>- It is an uncommon complication, but can occur if there is a treatment delay and a weakened bone due to erosion or overzealous debridement.</li>\n<li><strong>Chronic osteomyelitis</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You observe that the arms of an infant extend spontaneously when the senior resident tries to elicit the following reflex by holding the infant\u2019s trunk and then suddenly lowering the infant as if he or she were falling. All the following options regarding this reflex are true, except ______.",
    "choices": [
      {
        "id": 1,
        "text": "This reflex is  a prerequisite to walking."
      },
      {
        "id": 2,
        "text": "This reflex starts to appear by 7\u20138 months of age."
      },
      {
        "id": 3,
        "text": "This reflex disappears by 18 months of postnatal period."
      },
      {
        "id": 4,
        "text": "It is a primitive reflex."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The reflex being elicited in the given scenario is the\u00a0<strong>parachute reflex</strong>,<strong>\u00a0</strong>and this reflex<strong> remains throughout life.</strong></p>\n<p>The parachute reflex can be evoked by holding the infant's trunk and then suddenly lowering it as if it were falling. This will cause the infant's arms to extend in order to break the fall. Thus, it is a <strong>prerequisite for walking</strong>. The onset of this reflex is at <strong>7-8 months of age</strong>;\u00a0it fully develops by 10-11 months and persists for life.\u00a0</p>\n<p>The parachute reflex is a <strong>primitive reflex.</strong> Primitive reflexes appear and disappear at specific times during a child's development. Any persistence or absence of these reflexes is significant for central nervous system dysfunction.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5ed4be649584467985091f1563981de8.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A drug is instilled into the right eye of the rabbit, and the left eye is used as the control. The findings obtained after some time are shown in the table and image given below.",
    "choices": [
      {
        "id": 1,
        "text": "Cocaine"
      },
      {
        "id": 2,
        "text": "Physostigmine"
      },
      {
        "id": 3,
        "text": "Pilocarpine"
      },
      {
        "id": 4,
        "text": "Atropine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>On instillation of the drug, there is <strong>mydriasis</strong> in the eye and <strong>loss of light reflex</strong>. The drug is likely to be <strong>atropine</strong>. It is an anticholinergic agent. It causes mydriasis, cycloplegia, loss of light reflex, and impaired accommodation.</p>\n<p>Autonomic supply of the eye:</p>\n<p>The <strong>radial muscle</strong> of the iris is controlled by\u00a0<strong>\u03b1</strong><span class=\"s1\"><strong>1 adrenergic receptor</strong>. Stimulation of this receptor causes <strong>mydriasis.\u00a0</strong></span></p>\n<p><span class=\"s1\">The<strong> sphincter muscle </strong>of the iris is controlled by the\u00a0</span><strong>M<span class=\"s1\">3 and</span>\u00a0M</strong><span class=\"s1\"><strong>2 cholinergic receptors.</strong> Stimulation of these receptors causes <strong>miosis.</strong></span></p>\n<p><span class=\"s1\"><strong>The ciliary muscle </strong>is supplied by the\u00a0</span><strong>\u03b2</strong><span class=\"s1\"><strong>2</strong> adrenergic receptors as well as\u00a0</span><strong>M<span class=\"s1\">3 and</span>\u00a0M</strong><span class=\"s1\"><strong>2</strong> cholinergic receptors. The\u00a0<strong>\u03b22</strong>\u00a0receptors cause relaxation of the ciliary muscle, which helps in <strong>far vision,</strong> while\u00a0<strong>M3 and M2\u00a0</strong>receptors cause contraction of the ciliary muscle, which helps in\u00a0<strong>near vision.</strong></span></p>\n<p><span class=\"s1\"><strong>Lacrimal glands are supplied by the\u00a0</strong></span>\u03b1 receptors and M3 and M2 receptors. They increase lacrimal secretion.</p>\n<p>Effects of various drugs on the eye</p>\n<table style=\"height: 217px; width: 733px;\">\n<tbody>\n<tr>\n<td style=\"width: 134px; text-align: center;\"><strong>Class</strong></td>\n<td style=\"width: 134px; text-align: center;\"><strong>Muscarinic receptor antagonist</strong></td>\n<td style=\"width: 134px; text-align: center;\"><strong>Cholinesterase inhibitors</strong></td>\n<td style=\"width: 135px; text-align: center;\"><strong>Muscarinic receptor agonist</strong></td>\n<td style=\"width: 135px; text-align: center;\"><strong>Adrenergic agonist</strong></td>\n<td style=\"width: 162px; text-align: center;\"><strong>Local anesthetic</strong></td>\n</tr>\n<tr>\n<td style=\"width: 134px;\">Drugs</td>\n<td style=\"width: 134px;\"><strong>Atropine</strong>, homatropine, Scopalamine, Tropicamide</td>\n<td style=\"width: 134px;\"><strong>Physostigmine</strong>, neostigmine, pyridostigmine, organophosphorus compounds, etc</td>\n<td style=\"width: 135px;\"><strong>Pilocarpine</strong></td>\n<td style=\"width: 135px;\">Epinephrine</td>\n<td style=\"width: 162px;\"><strong>Cocaine</strong></td>\n</tr>\n<tr>\n<td style=\"width: 134px;\">Mechanism of action in the eye</td>\n<td style=\"width: 134px;\"><strong>Blocks M3 and M2</strong> receptors</td>\n<td style=\"width: 134px;\"><strong>Stimulates M3 and M2</strong> receptors</td>\n<td style=\"width: 135px;\"><strong>Stimulates M3 and M2</strong> receptors in the eye</td>\n<td style=\"width: 135px;\"><strong>Stimulates\u00a0\u03b1</strong><span class=\"s1\"><strong>1 </strong>receptor\u00a0 in the eye</span></td>\n<td style=\"width: 162px;\"><strong>Blocks sodium channel</strong> and blocks <strong>norepinephrine transporter</strong></td>\n</tr>\n<tr>\n<td style=\"width: 134px;\">Effect on iris</td>\n<td style=\"width: 134px;\">Mydriasis</td>\n<td style=\"width: 134px;\">Miosis</td>\n<td style=\"width: 135px;\">Miosis</td>\n<td style=\"width: 135px;\">Mydriasis</td>\n<td style=\"width: 162px;\">Mydriasis</td>\n</tr>\n<tr>\n<td style=\"width: 134px;\">Corneal reflex</td>\n<td style=\"width: 134px;\">Present</td>\n<td style=\"width: 134px;\">Present</td>\n<td style=\"width: 135px;\">Present</td>\n<td style=\"width: 135px;\">Present</td>\n<td style=\"width: 162px;\">Absent</td>\n</tr>\n<tr>\n<td style=\"width: 134px;\">Light reflex</td>\n<td style=\"width: 134px;\"><strong>Absent</strong></td>\n<td style=\"width: 134px;\">Present</td>\n<td style=\"width: 135px;\">Present</td>\n<td style=\"width: 135px;\">Present</td>\n<td style=\"width: 162px;\">Present</td>\n</tr>\n<tr>\n<td style=\"width: 134px;\">Lacrimal secretions</td>\n<td style=\"width: 134px;\">Decreased</td>\n<td style=\"width: 134px;\">Increased</td>\n<td style=\"width: 135px;\">Increased</td>\n<td style=\"width: 135px;\">\u00a0Increased</td>\n<td style=\"width: 162px;\">---</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/38cc05b0933e4f65a83a650431d5c197.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old lady presented with low mood, loss of appetite, and sleep disturbances that began a month ago. She has been in good health and has no significant past or psychiatric history. Two months ago, her son was diagnosed with Hodgkin's lymphoma. She is able to carry out her daily activities and still cherishes time with her son. Which among the following is true about the prognosis of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Most patients do not return to their previous level of functioning"
      },
      {
        "id": 2,
        "text": "Adults are more likely to improve sooner than adolescents"
      },
      {
        "id": 3,
        "text": "Suicidal risk is not a concern in these patients"
      },
      {
        "id": 4,
        "text": "Pharmacotherapy is preferred over psychotherapy for this condition."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario with low mood, loss of appetite, and sleep disturbances occurring within 3 months of a stressful event (Son's lymphoma diagnosis) is suggestive of an\u00a0<strong>adjustment disorder. Adults recover sooner than adolescents.</strong></p>\n<p><strong>Adjustment disorder</strong> is an emotional response to a stressful event such as the loss of a job, divorce, moving to a new environment, financial problems, medical illnesses, or the death of a loved one.\u00a0</p>\n<p>With appropriate treatment, the prognosis of an adjust\u00adment disorder is good. Most patients are able to <strong>return to their previous level of functioning</strong> within 3 months. <strong>Adolescents</strong> usually require a <strong>longer time to recover</strong> than adults and may <strong>develop mood disorders</strong> or <strong>substance\u00ad related</strong> <strong>disorders</strong> in the future.</p>\n<p>The <strong>suicidal risk</strong> is found to be <strong>higher</strong> in patients with chronic adjustment disorder with depressive symptoms, associated substance-related disorders in those with previous suicide attempts. The highest risk is seen in adolescent patients.</p>\n<p><strong>Diagnosing criteria for adjustment disorder</strong> include:</p>\n<div class=\"page\" title=\"Page 467\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Development of emotional or behavioral response within 3 months of the onset of the stressor.</li>\n<li>The symptoms or behavior are clinically significant, where, any one of the following are met:\n<ul>\n<li>The response is out of proportion to the severity or intensity of the stressor.</li>\n<li>Significant impairment in social, occupational, or other areas of functioning.</li>\n</ul>\n</li>\n<li>Stress-related disturbance does not meet\u00a0the criteria for another mental disorder or exacerbation of pre-existing mental disorder.</li>\n<li>The symptoms do not represent normal bereavement.</li>\n<li>Once the stressor is terminated, the symptoms do not persist for more than<strong>\u00a0</strong>6 additional months.</li>\n</ul>\n<p>The mainstay of treatment is <strong>psychotherapy</strong>. Pharmacotherapy is\u00a0not commonly used, however it is reasonable to use medications for specific symptoms for a brief period of time.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a function of cholecystokinin?",
    "choices": [
      {
        "id": 1,
        "text": "Stimulation of pancreatic enzyme secretion"
      },
      {
        "id": 2,
        "text": "Stimulation of gastric emptying"
      },
      {
        "id": 3,
        "text": "Enhancing motility of small intestine"
      },
      {
        "id": 4,
        "text": "Relaxation of the sphincter of Oddi"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Cholecystokinin(CCK)\u00a0<strong>inhibits gastric emptying,</strong> it does not stimulate it.</p>\n<p>CCK is secreted by<strong> I\u00a0cells </strong>in the mucosa of the <strong>upper</strong>\u00a0<strong>small intestine</strong>. It\u00a0is also found in nerves in the distal ileum and colon, and neurons in the cerebral cortex. Its functions include:</p>\n<ul>\n<li class=\"p1\"><strong>Stimulation of pancreatic enzyme secretion </strong>(option A)</li>\n<li class=\"p1\">Gallbladder contraction</li>\n<li class=\"p1\"><strong>Relaxation of the sphincter of Oddi </strong>to allow the flow of bile and pancreatic juice into the intestinal lumen (option D)</li>\n<li class=\"p1\"><strong>Inhibits gastric emptying</strong></li>\n<li class=\"p1\">Increases the synthesis of enterokinase</li>\n<li class=\"p1\"><strong>Enhances the motility of the small intestine and colon </strong>(option C)</li>\n<li class=\"p1\">Increases the action of secretin, alkalizing the pancreatic juice</li>\n<li class=\"p1\">Trophic effect on the pancreas</li>\n</ul>\n<p>The secretion of CCK is increased by:</p>\n<ul>\n<li>Products of digestion like <strong>peptides</strong> and <strong>amino acids</strong> coming in contact with the intestinal mucosa</li>\n<li>Presence of <strong>fatty acids</strong> containing &gt;10 C atoms in the duodenum</li>\n<li>CCK-releasing peptide and monitor peptide</li>\n</ul>\n<p>Bile and pancreatic juice enter the duodenum in response to CCK, enhancing the <strong>digestion</strong> <strong>of protein and fat</strong>. The products of this digestion stimulate further CCK secretion, as positive feedback. However, this positive feedback is terminated when the products of digestion move further down the GI tract.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the characteristic radiographic finding shown in the image",
    "choices": [
      {
        "id": 1,
        "text": "Fish hook ureter"
      },
      {
        "id": 2,
        "text": "Drooping lily sign"
      },
      {
        "id": 3,
        "text": "Bouquet of flowers appearance"
      },
      {
        "id": 4,
        "text": "Vesicoureteric reflex"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows the&nbsp;<strong>drooping lily sign </strong>on the right side<strong>,&nbsp;</strong>a urographic sign observed in patients with a&nbsp;<strong>duplicated collecting system.&nbsp;</strong></p>\n<p>The&nbsp;drooping lily sign&nbsp;refers to the&nbsp;<strong>inferolateral displacement</strong>&nbsp;of the opacified lower pole moiety due to an obstructed upper pole moiety.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1eca9c554d274be984c3ac9ae545e59e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/85cab19afd164c0383a3886a29362907x720x723.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f4c6c0f2aaf4986a53ea5cc4a0000c2x1025x1803.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fd859f2e271844759c58616366babd93x720x960.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea709aba64c84e85a8296dddda5d8f81x898x1024.JPEG"
    ]
  },
  {
    "text": "A 35-year-old female patient who underwent radiotherapy for Hodgkin's lymphoma 5 years ago presents with a slow-growing thyroid swelling for 6 months. Physical examination reveals 2 by 2cm swelling over the thyroid gland. Laboratory investigations show a normal TSH, T3, and T4. Which of the following is false regarding the underlying disease?",
    "choices": [
      {
        "id": 1,
        "text": "More common in younger individuals"
      },
      {
        "id": 2,
        "text": "The most common type of  thyroid tumor"
      },
      {
        "id": 3,
        "text": "Commonly metastasizes hematogenously"
      },
      {
        "id": 4,
        "text": "Has excellent 10 year survival rate"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient with thyroid swelling, who was treated for Hodgkin\u2019s lymphoma by <strong>radiotherapy,</strong> is likely to have <strong>papillary thyroid cancer</strong>. Papillary thyroid cancer spreads through the <strong>lymphatic system.</strong></p>\n<p><strong>Radiation</strong> is the established risk factor for the development of differentiated thyroid carcinoma (papillary and follicular). This association is stronger for <strong>papillary</strong> than for follicular carcinomas.</p>\n<p>Papillary thyroid carcinomas are the <strong>most common</strong> forms of thyroid carcinoma and present in <strong>younger individuals</strong>. They commonly spread by the <strong>lymphatic system</strong> but have an excellent <strong>10-year survival rate</strong> of <strong>95%</strong>.</p>\n<p>The risk of developing papillary thyroid cancer is high among individuals who:</p>\n<ul>\n<li style=\"font-weight: 400;\">Received external irradiation to the thyroid as children (&lt; 5 years of age)</li>\n<li style=\"font-weight: 400;\">Received radiation for soft tissue malignancies, such as <strong>Hodgkin\u2019s lymphoma</strong></li>\n<li style=\"font-weight: 400;\">Have a history of acute environmental exposure</li>\n<li style=\"font-weight: 400;\">Familial syndromes (Cowden syndrome, Werner syndrome, Carney syndrome, etc)</li>\n</ul>\n<p>Clinical features -</p>\n<ul>\n<li>thyroid swelling</li>\n<li>lateral aberrant thyroid -cervical node invasion my metastasis)</li>\n<li>dysphagia</li>\n<li>horseness</li>\n</ul>\n<p>Diagnosis -</p>\n<ul>\n<li>\n<div class=\"topbullet\">Thyroid function studies</div>\n</li>\n<li>\n<div class=\"topbullet\">Thyroid-stimulating hormone (TSH) suppression test</div>\n</li>\n<li>\n<div class=\"topbullet\">Thyroid ultrasound</div>\n</li>\n<li>\n<div class=\"topbullet\">Fine-needle aspiration biopsy (FNAB)(to confirm the diagnosis)</div>\n</li>\n</ul>\n<p>Histopathology -</p>\n<ul>\n<li>Complex, branching, randomly oriented<strong>\u00a0papillae</strong>\u00a0with fibrovascular cores associated with follicles.</li>\n<li>Usually dense fibrosis.</li>\n<li>Papillae lined by cuboidal cells.</li>\n<li>Nuclei are overlapping with finely dispersed optically\u00a0<strong>clear chromatin</strong>\u00a0(also called ground-glass),\u00a0which gives a clear or empty appearance, therefore, the name is ground glass or\u00a0<strong>Orphan Annie eye</strong>\u00a0nuclei.</li>\n<li>Macronucleoli, eosinophilic intranuclear inclusions (represent cytoplasmic invaginations) and nuclear longitudinal grooves (represent folding of the redundant nuclear membrane, but nonspecific).</li>\n<li>Stromal elastosis - often lymphatic invasion.</li>\n<li><strong>Psammoma bodies</strong>.</li>\n</ul>\n<p>Staging -\u00a0</p>\n<ul>\n<li>AGES scoring system- Age, histologic Grade, Extrathyroidal invasion, and metastases and tumor Size. Predict the risk of dying from papillary cancer.</li>\n<li>MACIS scale - Postoperative modification of the AGES scale. Includes Metastases, Age at presentation (&lt;40 or &gt;40 years old), Completeness of original surgical resection, extrathyroidal Invasion, and Size of original lesion</li>\n<li>AMES system - classifies differentiated thyroid tumors. Includes Age (men &lt;40 years old, women &lt;50 years old), Metastases, Extrathyroidal spread, and Size of tumors (&lt; or &gt;5 cm).\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/628bf43056324e7297f9fb57701bf5f7x1280x918.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0115e94d4f3141c4b376540b5fe61b4cx725x512.JPEG"
    ]
  },
  {
    "text": "A 45-year-old woman presents with lower abdominal pain, increased frequency of micturition, and pain during sex that extends to the vulva and vagina. The pain increases when the bladder is full. Cystoscopy shows fissures and punctate hemorrhages in the bladder mucosa as shown in the image below and marked submucosal edema of the bladder. Biopsy reveals mucosal ulceration and increased numbers of mucosal mast cells. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Malakoplakia"
      },
      {
        "id": 2,
        "text": "Transitional cell carcinoma of bladder"
      },
      {
        "id": 3,
        "text": "Follicular cystitis"
      },
      {
        "id": 4,
        "text": "Interstitial cystitis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical features are characteristic of <strong>interstitial cystitis</strong> or chronic pelvic pain syndrome.</p>\n<p><strong>Interstitial cystitis</strong> is a rare idiopathic condition that occurs most frequently in <strong>women</strong> presenting as\u00a0intermittent severe <strong>suprapubic</strong> <strong>pain</strong>, urinary frequency, urgency, hematuria, and dysuria.\u00a0<strong>Hunner ulcers</strong> are characteristic ulcers seen in\u00a0<strong>interstitial cystitis.\u00a0</strong>It is characterized by marked <strong>submucosal</strong> <strong>edema</strong> of the <strong>bladder</strong> with mucosal ulceration, seen in<strong>\u00a0</strong>the\u00a0<strong>late phase</strong> of interstitial cystitis.</p>\n<p>Cystoscopic findings show fissures and punctate hemorrhages (<strong>glomerulations</strong>) in the bladder mucosa. Microscopically<strong>, mucosal ulceration </strong>is covered by fibrin, necrotic material, and increased numbers of mucosal<strong> mast cells.\u00a0</strong>The pathologic findings are nonspecific, and the main role of <strong>biopsy</strong> is to <strong>rule out carcinoma in situ,</strong> which may mimic interstitial cystitis clinically. Late in the course, transmural fibrosis may appear, leading to a <strong>contracted bladder</strong>.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Malakoplakia</strong> is an inflammatory reaction caused by <strong>defects</strong> in <strong>phagocyte</strong> <strong>function</strong>. It occurs during chronic bacterial infections. On cystoscopy, it appears as soft, yellow, <strong>raised</strong> <strong>mucosal</strong> <strong>plaques</strong>\u00a03-4cm in diameter with large aggregates of foamy macrophages.</p>\n<p>Option B: <strong>Transitional cell carcinoma </strong>of the bladder or urothelial neoplasms are the most common bladder tumors. Morphological variants include papillary, nodular, or flat lesions.\u00a0</p>\n<p>Option C:<strong>\u00a0Follicular cystitis</strong> is characterized by multiple lymphoid follicles in the bladder mucosa or underlying wall.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8ecaffe54ba1497c8d6bed87bd2087b0.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test 31';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>