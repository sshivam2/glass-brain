<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>228 Surgery Aiims 2019  (May & Nov) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Surgery
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">33</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A patient presents with renal calculus of > 4 cm of the staghorn type. What is the best management?",
    "choices": [
      {
        "id": 1,
        "text": "Extracorporeal shockwave lithotripsy"
      },
      {
        "id": 2,
        "text": "Percutaneous nephrolithotomy"
      },
      {
        "id": 3,
        "text": "Ureteroscopic removal"
      },
      {
        "id": 4,
        "text": "Retrorenal surgery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>best</strong> management for<strong> staghorn renal calculus</strong> of<strong> &gt;4 cm</strong> is percutaneous nephrolithotomy<strong> (PCNL)</strong>.&nbsp;</p>\n<p>The <strong>initial</strong> management of renal stones depends on the stone size and includes conservative management, extracorporeal shockwave lithotripsy <strong>(ESWL)</strong>, and PCNL. <strong>PCNL</strong> is preferred for stones <strong>&gt; 2cm</strong> in size and for <strong>staghorn calculi</strong>, while <strong>ESWL</strong> is used to treat renal stones of <strong>size 0.6 to 1.5</strong> cm.&nbsp;PCNL is indicated in</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Renal stones<strong> &gt;2 cm</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Staghorn calculus</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Failed shockwave lithotripsy (SWL) or retrograde intrarenal surgery (RIRS) for renal calculi</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Lower pole renal stones with anatomy that is unfavorable for ESWL</li>\n</ul>\n<p>Other options:</p>\n<p>Option C: <strong>Ureteroscopic removal</strong> is attempted for <strong>failed SWLs or PCNLs</strong>, and is <strong>not</strong> the <strong>first choice</strong> in the surgical management of renal stones.</p>\n<p>Option D:<strong> RIRS</strong> is a minimally invasive procedure similar to ureteroscopic removal, where the kidney is accessed using a <strong>slim and flexible ureteroscope</strong> in a retrograde manner via the<strong> ureteric orifice</strong>. It is indicated for <strong>lower pole</strong> renal stones <strong>&lt; 2 cm</strong>.&nbsp;&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are doing an emergency laparotomy for a case of intestinal obstruction. Which organ will you first visualize to know if this is a case of small bowel or large bowel obstruction?",
    "choices": [
      {
        "id": 1,
        "text": "Ileum"
      },
      {
        "id": 2,
        "text": "Caecum"
      },
      {
        "id": 3,
        "text": "Jejunum"
      },
      {
        "id": 4,
        "text": "Sigmoid colon"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>The cecum</strong> is the <strong>first organ to be visualized to differentiate</strong> between the small and large bowel in cases of intestinal obstruction.</p>\n<p><strong>Distension of the cecum </strong>will confirm<strong> large bowel involvement. </strong>The identification&nbsp;of a collapsed distal segment of the large bowel and its sequential proximal assessment will lead to the identification of the cause.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the best position for a conscious patient to be in during the insertion of a Ryle's tube?",
    "choices": [
      {
        "id": 1,
        "text": "Supine with neck flexion"
      },
      {
        "id": 2,
        "text": "Supine with neck extension"
      },
      {
        "id": 3,
        "text": "Sitting with neck flexion"
      },
      {
        "id": 4,
        "text": "Sitting with neck extension"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The best position for a <strong>conscious patient</strong> to be in during the insertion of Ryle's tube<strong> (RT)</strong> is <strong>sitting with neck flexion</strong>. The described position helps in directing the RT towards the esophagus and also prevents it from coiling in the oropharynx or entering the trachea.</p>\n<p>RT, also known as nasogastric <strong>(NG) </strong>tube, measures <strong>120-125 cm</strong>. It has <strong>4 markings</strong> at 40cm (cardia), 50cm (body), 60cm (pylorus), and 70 cm (duodenum) to indicate the approximate position after the placement.</p>\n<p>Indications for NG tube:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Feeding in patients with dysphagia, decreased appetite, or those who are nil per os (NPO) for medical or surgical reasons.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Aspiration of gastric fluid</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Gastric decompression in cases of intestinal obstruction and paralytic ileus.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Zollinger-Ellison syndrome&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Bowel irrigation</li>\n</ul>\n<p>The <strong>absolute</strong> <strong>contraindications</strong> for an NG tube are <strong>severe midface trauma</strong>, recent nasal surgery, and <strong>basilar skull </strong>fractures</p>\n<p>Steps for the correct insertion of RT in an adult:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Examination of the patient&rsquo;s nostril for any <strong>anatomical abnormalities</strong> and then instillation with 10 ml of 1% lignocaine&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>NEX method</strong> is used to <strong>measure the length of the RT</strong>: &nbsp;Place the exit port of the tube at the tip of the nose. Extend the tube to the earlobe, and then to the xiphisternum.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The patient is asked to sit <strong>upright with partial neck flexion</strong>. The tip of the Ryle&rsquo;s tube is lubricated and passed along the floor of the nasal passage until a resistance is felt(corresponds to nasopharynx)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The patient is subsequently asked to swallow water to guide the tube through the esophagus into the stomach until the <strong>marked length</strong> (based on the NEX method).</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">NG tube is finally taped to secure it in place.</li>\n</ol>\n<p><br />Confirmation of the correct position is done by:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Auscultation</strong> in the <strong>epigastric</strong> <strong>area</strong> while injecting a bolus of air</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">X-ray chest to locate the lead markers</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Aspiration of contents and subsequently confirming gastric origin (pH &lt;6 indicates gastric placement)</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2b29d419f2864e5ab70adf6c34335073x576x432.PNG"
    ]
  },
  {
    "text": "Pick from the following the usual cause of thyroid storm in thyroidectomy:",
    "choices": [
      {
        "id": 1,
        "text": "Rough handling of thyroid during surgery"
      },
      {
        "id": 2,
        "text": "Due to parathyroid gland"
      },
      {
        "id": 3,
        "text": "Inadequate patient preparation"
      },
      {
        "id": 4,
        "text": "Infections"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The usual cause of thyroid storm in thyroidectomy is<strong> inadequate patient preparation</strong> before surgery. Patient preparation <strong>pre-operatively</strong> involves ensuring a <strong>euthyroid</strong> <strong>state</strong>.</p>\n<p><strong>Rough handling</strong> of the thyroid in thyroidectomy does <strong>not</strong> cause a<strong> thyroid storm</strong>. Though a significant amount of thyroglobulin is stored in the acinar cells, they are inactive unless converted to thyroxine (T3 and T4).&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following colored cannula will you use to achieve maximum flow rate, in a patient who needs a large amount of fluids?",
    "choices": [
      {
        "id": 1,
        "text": "Grey"
      },
      {
        "id": 2,
        "text": "Green"
      },
      {
        "id": 3,
        "text": "Blue"
      },
      {
        "id": 4,
        "text": "Pink"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Grey</strong> colored cannula is used to achieve <strong>maximum flow rate</strong> in a patient who needs a large amount of fluids.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient who was admitted after a road traffic accident is put on mechanical ventilation. He opens his eyes on verbal command and moves all four limbs spontaneously. Calculate his GCS.",
    "choices": [
      {
        "id": 1,
        "text": "Eyes-2, Verbal-1, Motor-5"
      },
      {
        "id": 2,
        "text": "Eyes-2, Verbal-NT, Motor-5"
      },
      {
        "id": 3,
        "text": "Eyes-3, Verbal-1, Motor-6"
      },
      {
        "id": 4,
        "text": "Eyes-3, Verbal-NT, Motor-6"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The patients GCS is<strong> Eyes-3, Verbal-NT, Motor-6.</strong></p>\n<p>It is calculated as follows:</p>\n<ul>\n<li><strong>Eye opening</strong>: Opening to verbal command - 3&nbsp;</li>\n<li><strong>Verbal response</strong>: In the case of endotracheal intubation, the verbal response score is noted as NT (non-testable)</li>\n<li><strong>Motor respone</strong>: Movement of all 4 limbs spontaneously - 6</li>\n</ul>\n<p>Total GCS score is not recorded since one of the components is non-testable.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient was brought to the casualty after a road traffic accident (RTA) with chest trauma. He is conscious and speaks single words. He has a respiratory rate of 44 cycles per min and a BP of 90/40 mmHg. There is a hyper-resonance on percussing the right side of his chest. What will be your next, immediate step?",
    "choices": [
      {
        "id": 1,
        "text": "Intubate the patient"
      },
      {
        "id": 2,
        "text": "Insert needle in appropriate intercostal space"
      },
      {
        "id": 3,
        "text": "Start intravenous fluids urgently"
      },
      {
        "id": 4,
        "text": "Take a chest X-ray"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of <strong>chest trauma</strong> with a <strong>hyper resonant</strong> note on the right side suggests <strong>pneumothorax</strong>. <strong>Hemodynamic</strong> <strong>instability</strong> in this patient suggests <strong>tension pneumothorax</strong> and this is managed by <strong>immediate decompression</strong> by <strong>insertion of a needle</strong> in the appropriate place.</p>\n<p><strong>Pneumothorax</strong> refers to the presence of excess air in the pleural space. Entrapment of air occurs by:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Primary</strong> spontaneous pneumothorax - Due to the <strong>spontaneous</strong> <strong>rupture</strong> of apical pleural <strong>blebs</strong> or cystic spaces immediately below the visceral pleura.&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Secondary</strong> pneumothorax - Due to the rupture of dilated cystic spaces in lung <strong>diseases</strong> like chronic obstructive pulmonary disease <strong>(COPD)</strong>&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Tension</strong> pneumothorax - Due to <strong>a one-way valve </strong>mechanism that directs airflow into the pleural space leading to a higher than atmospheric pressure environment. This leads to the affected lung being <strong>unable to expand</strong> appropriately and leads to <strong>hemodynamic instability.</strong>&nbsp;</li>\n</ol>\n<p><br /><strong>Tension pneumothorax</strong> is a <strong>surgical emergency</strong> and the excessive pressure has to be <strong>immediately</strong> relieved. A chest<strong>&nbsp;X-ray</strong> is <strong>not</strong> required before emergency decompression as it is a <strong>clinical</strong> diagnosis, but an X-ray should be done following chest tube insertion<strong> (option D)</strong>. Tension pneumothorax is managed by immediate needle decompression in the 5th ICS (adults), followed by definitive management with a chest tube inserted in the same space.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Intubation</strong> is performed when the patient is<strong> unresponsive</strong> post chest tube insertion.&nbsp;</p>\n<p>Option C: While <strong>IV fluids</strong> are a part of the resuscitation protocol, the management of <strong>tension pneumothorax </strong>takes <strong>higher</strong> <strong>precedence</strong> as the next immediate step.</p>\n<p>Note: According to ATLS 10th edition</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">In adults, needle thoracostomy or needle decompression location is changed to the 5th ICS anterior to the midaxillary line from the 2nd ICS midclavicular line.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">In the pediatric age group, the needle thoracostomy location remains at the 2nd ICS midclavicular line.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is used for wound infection grading?",
    "choices": [
      {
        "id": 1,
        "text": "ASA classification"
      },
      {
        "id": 2,
        "text": "SIRS criteria"
      },
      {
        "id": 3,
        "text": "Southampton grading"
      },
      {
        "id": 4,
        "text": "APACHE II score"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Southampton</strong> <strong>wound</strong> <strong>grading</strong> system is used to score the <strong>severity</strong> of <strong>wound</strong> <strong>site</strong> <strong>infection</strong>.</p>\n<p>Southampton wound grading system:</p>\n<ul>\n<li>Grade 0 - Normal healing</li>\n<li>Grade I - Normal healing with different grades of erythema</li>\n<li>Grade II - Erythema with other signs of inflammation at different parts of the wound.</li>\n<li>Grade III - Clear or serosanguinous discharge at different sites</li>\n<li>Grade IV - Pus discharge</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: American Society of Anesthesiologists <strong>(ASA)&nbsp;</strong> grading is used in<strong> pre-anesthetic checkups</strong> to assess a patient's physical health and fitness for anesthesia and surgery.</p>\n<p>Option B: Systemic Inflammatory Response Syndrome <strong>(SIRS)</strong> is a set of clinical criteria used to<strong> identify and monitor critically ill patients</strong> with high-grade burns, severe trauma, and other major surgeries.</p>\n<p>Option D: Acute Physiology and Chronic Health Evaluation II <strong>(APACHE II)</strong>&nbsp; is a scoring system used to assess the <strong>severity</strong> and predict the <strong>outcome</strong> of <strong>pancreatitis</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The most common mediastinal tumor is _______.",
    "choices": [
      {
        "id": 1,
        "text": "Thymoma"
      },
      {
        "id": 2,
        "text": "Neurogenic"
      },
      {
        "id": 3,
        "text": "Lymphoma"
      },
      {
        "id": 4,
        "text": "Bronchial cyst"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>most common</strong> mediastinal tumors in descending order of incidence are <strong>thymoma (25%)</strong>, germ cell tumor (13%), lymphoma, mesenchymal, and thyroid.</p>\n<p>The <strong>Masaoka classification</strong> and <strong>TNM staging</strong> are used in the staging of thymoma.</p>\n<p>The most common mediastinal tumor in <strong>children</strong> is the <strong>neurogenic tumor</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "On the 5th postoperative day post CABG, the patient develops tachypnea and hypotension. What is the most probable cause?",
    "choices": [
      {
        "id": 1,
        "text": "Sepsis"
      },
      {
        "id": 2,
        "text": "Acute kidney failure"
      },
      {
        "id": 3,
        "text": "Acute respiratory failure"
      },
      {
        "id": 4,
        "text": "Acute cardiac failure"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical presentation of <strong>tachypnoea</strong> and <strong>hypotension</strong> in a <strong>post-op day 5</strong> patient who underwent coronary artery bypass grafting <strong>(CABG)</strong> points towards lung collapse <strong>(atelectasis) </strong>- type 3 respiratory failure.</p>\n<p>Atelectasis is the <strong>most common respiratory complication</strong> in a post-operative patient.</p>\n<p>The factors predisposing to atelectasis are general anesthesia, upper abdominal surgery, and <strong>thoracic surgery</strong>. They commonly present with <strong>tachypnoea</strong> and decreased oxygen saturation. On examination, the breath sounds are <strong>bronchial</strong> in nature and <strong>reduced</strong> in intensity.</p>\n<p><strong>Lung</strong> <strong>atelectasis</strong> can be <strong>reversed</strong> (within 24h-48h) with <strong>early</strong> <strong>mobilization</strong>, deep breathing (5 sequential breaths for 5s), <strong>incentive</strong> <strong>spirometry</strong>, and chest physiotherapy.</p>\n<p>Other postoperative systemic complications include:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Pneumonia</strong> and <strong>myocardial</strong> <strong>infarction </strong>: <strong>F</strong><strong>irst</strong> <strong>few</strong> <strong>days</strong> after surgery</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Venous</strong> <strong>thromboembolism</strong>, kidney failure, and urinary tract infection: Days 4 to 7</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Superficial</strong> and <strong>deep</strong> <strong>surgical</strong> <strong>site</strong> infections: <strong>2nd post-op week</strong></li>\n</ol>\n<p>Other options:</p>\n<p>Option A: For a diagnosis of <strong>sepsis,</strong> SEPSIS 3 criteria needs to be satisfied:&nbsp;</p>\n<ul>\n<li>A <strong>documented infection</strong></li>\n<li>An acute increase in<strong> &gt;2 SOFA</strong> points</li>\n</ul>\n<p>Option B: <strong>Acute kidney failure</strong> is defined as a decrease in <strong>urine output</strong> (&lt;0.5 mL/kg/h for 6-12h) and a <strong>rise</strong> in <strong>serum creatinine</strong> values ( &gt;1.5x baseline or &gt;0.3 mg/dL).&nbsp;</p>\n<p>Option D: <strong>Acute cardiac failure</strong> has features of <strong>hypotension</strong> and <strong>tachycardia</strong>, with peripheral signs of hypoperfusion characterized by cold clammy extremities.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The probable diagnosis based on the below clinical image of the breast is?",
    "choices": [
      {
        "id": 1,
        "text": "Paget's disease"
      },
      {
        "id": 2,
        "text": "Mondor's disease"
      },
      {
        "id": 3,
        "text": "Zuska's disease"
      },
      {
        "id": 4,
        "text": "Tietze syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows a <strong>thrombosed subcutaneous cord</strong> attached to the skin of the breast which is the <strong>pathognomic feature</strong> of<strong> Mondor's Disease</strong>.</p>\n<p>Mondor&rsquo;s disease is the<strong> thrombophlebitis of the superficial veins</strong> of the breast and anterior chest wall. It may also occur in the arm or penis. On <strong>raising the arm</strong>, the <strong>skin</strong> over the chest gets <strong>stretched</strong> and a narrow, <strong>shallow groove</strong> alongside the cord is seen. It is treated by <strong>restricting arm movements</strong> and usually subsides within a few months without recurrence, complications, or deformity.</p>\n<p>The differential diagnosis to be considered is lymphatic permeation from an occult carcinoma of the breast.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Paget&rsquo;s disease</strong> is a type of <strong>ductal carcinoma</strong> <strong>in situ</strong> arising from the nipple and commonly presents as nipple erosion.</p>\n<p>Option B: <strong>Zuska&rsquo;s disease</strong>, also called recurrent periductal mastitis, is a condition of <strong>recurrent retroareolar infections</strong> and abscesses. <strong>Smoking</strong> has been implicated as a risk factor for this condition. Managed symptomatically by <strong>antibiotics</strong> coupled with incision and drainage as necessary.</p>\n<p>Option D: <strong>Tietze&rsquo;s syndrome</strong> refers to the<strong> benign inflammation</strong> of one or more<strong> costal cartilages</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e175c4df650b400b8dd36d8ab8be45a6.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The most commonly involved artery  in pseudoaneurysm formation:",
    "choices": [
      {
        "id": 1,
        "text": "Aorta"
      },
      {
        "id": 2,
        "text": "Femoral artery"
      },
      {
        "id": 3,
        "text": "Popliteal artery"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Other options:</p>\n<p>Option A: <strong>Aortic aneurysm</strong> can be types - thoracic or abdominal. They are usually seen in <strong>heritable conditions</strong> like Marfan syndrome or vascular-type Ehlers-Danlos.</p>\n<p>Option C: The <strong>most common peripheral aneurysm</strong> is the <strong>popliteal aneurysm</strong> (80% of the cases) followed by the femoral aneurysm.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/405608b7a9c64e7c833f1145fd893ffcx1280x1913.JPEG"
    ]
  },
  {
    "text": "A chronic alcoholic patient came to the emergency with pain in the epigastrium radiating to the back and recurrent vomiting. On examination, guarding was present in the upper epigastrium. The erect chest X-ray was normal. What is the next step?",
    "choices": [
      {
        "id": 1,
        "text": "Upper GI endoscopy"
      },
      {
        "id": 2,
        "text": "Alcohol breath test"
      },
      {
        "id": 3,
        "text": "Serum lipase"
      },
      {
        "id": 4,
        "text": "CECT"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of the patient presenting with <strong>abdominal pain</strong>, <strong>recurrent vomiting</strong>, and<strong> upper epigastric guarding</strong> in a chronic alcoholic is highly suggestive of <strong>acute pancreatitis</strong>. The <strong>normal</strong> erect <strong>chest X-ray</strong> indicates that there is <strong>no pneumoperitoneum</strong> (effectively ruling out perforation). The <strong>next step</strong> is to send blood samples for serum lipase levels.</p>\n<p>While contrast-enhanced computed tomography<strong> (CECT)</strong> of the <strong>abdomen</strong> <strong>(option D)</strong> is the best investigation to rule out a case of acute pancreatitis, it is not the next step after an abdominal X-ray.</p>\n<p>Acute pancreatitis is often caused by <strong>gallstones</strong> (70%) or <strong>alcoholism</strong> (25%). The cardinal symptom is acute-onset severe pain in the upper quadrant of the abdomen. The patient usually presents in <strong>shock</strong> (hypotension and tachycardia) and <strong>tachypnoea</strong>. Some may also present with signs of bleeding into the fascial planes leading to discoloration of the sites involved:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Cullen&rsquo;s sign: Around the umbilicus</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Grey Turner&rsquo;s sign: Flanks</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Fox sign: Inguinal region</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Bryant&rsquo;s sign: Scrotum</li>\n</ol>\n<p>The diagnosis is often <strong>clinical</strong> with a laboratory diagnosis of <strong>serum lipase preferred over serum amylase</strong>. The severity of the acute pancreatitis is assessed using the Ranson and Glasgow scoring system ( &ge;3 at 48h of onset of pain ). APACHE, SOFA, SAPS, and MODS can also be used to assess the severity of pancreatitis in intensive care (ICU) settings.&nbsp;&nbsp;</p>\n<p>Pancreatitis is <strong>managed conservatively</strong> with initial nasogastric drainage followed by intravenous fluids, analgesia, and frequent monitoring of vital signs, urine output, and blood gases.</p>\n<p>Other options:</p>\n<p>Option A: Upper gastrointestinal intestinal (GI) <strong>endoscopy</strong> is performed by passing a flexible endoscope and is the best method for examining the <strong>upper gastrointestinal mucosa</strong>. It doesn't help us diagnose pancreatitis.</p>\n<p>Option B: The <strong>alcohol breath test</strong> is used as a <strong>screening</strong> <strong>test</strong> to measure the <strong>concentration of alcohol</strong> in a person's breath, but doesn't help us diagnose pancreatitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The best way to manage the wound shown in the image is:",
    "choices": [
      {
        "id": 1,
        "text": "Cleaning and dressing"
      },
      {
        "id": 2,
        "text": "Debridement and dressing"
      },
      {
        "id": 3,
        "text": "Cleaning and skin grafting"
      },
      {
        "id": 4,
        "text": "Cleaning and use of allograft"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows a <strong>superficial injury</strong> to the skin, an <strong>abrasion</strong>. <strong>Cleaning</strong> and <strong>dressing</strong> is the appropriate management of an abrasion.</p>\n<p><strong>Wound</strong> <strong>cleaning</strong>&nbsp;is the removal of bacteria and particles to decrease the chances of infection. It includes the <strong>&ldquo;TIME&rdquo;</strong> acronym:</p>\n<ul>\n<li aria-level=\"1\">T - Tissue : Assessment and debridement of non-viable tissue or foreign material</li>\n<li aria-level=\"1\">I - Inflammation/Infection : Assess the etiology of each wound&nbsp;</li>\n<li aria-level=\"1\">M - Moisture Balance : Assess the etiology of wound exudate</li>\n<li aria-level=\"1\">E - Edge of the wound : Assess the edge and surrounding skin</li>\n</ul>\n<p><strong>Wound irrigation</strong> or toilet is <strong>washing the wound</strong> with <strong>normal</strong> <strong>saline</strong>.</p>\n<p><strong>Wound debridement</strong> is performed using a surgical blade or fine scissors to <strong>remove any devitalized</strong>, nonviable tissue or any embedded foreign body (option B).&nbsp;</p>\n<p>Skin grafting is required only in situations of wonuds with larger areas soft tissue loss (options C and D).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1c32f0d7a8d440329116e2fc4724ac73.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Device shown in the image is used for which purpose?",
    "choices": [
      {
        "id": 1,
        "text": "Prevent viral infections"
      },
      {
        "id": 2,
        "text": "Prevent transfusion related reactions"
      },
      {
        "id": 3,
        "text": "Prevent infections"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows a <strong>leukoreduction filter</strong> which is used for<strong> filtering out </strong>donor <strong>WBCs</strong>. This helps in <strong>reducing</strong> the incidence of <strong>transfusion-related reactions</strong> by removing WBC <strong>microaggregates</strong>. The optimum time for performing leukoreduction is before the storage of blood.</p>\n<p>Potential benefits include <strong>reduced</strong> risk of:&nbsp;</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Sensitization to HLA antigens (important for transplant patients &amp; preventing platelet refractoriness)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Febrile non-hemolytic transfusion reactions (FNHTR)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">CMV transmission</li>\n</ul>\n<p>Note: <strong>CMV</strong> also has an affinity for <strong>monocytes</strong> and <strong>macrophages </strong>(types of WBCs). <strong>Reduction in WBCs</strong> is the cause for the <strong>decrease</strong> in <strong>CMV</strong> <strong>transmission</strong> <strong>(accidental benefit)</strong>, and thus, the <strong>main</strong> <strong>purpose</strong> of a leukoreduction filter is <strong>not</strong> the prevention of CMV transmission (options A and C).</p>\n<p>Possible reduced risk of:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Transfusion-associated graft versus host disease (TA- GVHD)&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Transfusion-related immuno-modulatory (TRIM) effects</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Transmitting variant Creutzfeldt-Jakob Disease</li>\n</ul>\n<p>Other Methods of Leucodepletion are:</p>\n<ul>\n<li aria-level=\"1\">Specific leucodepletion filters (Most Efficient)</li>\n<li aria-level=\"1\">Washing</li>\n<li aria-level=\"1\">Freezing</li>\n<li aria-level=\"1\">Buffy coat removal</li>\n<li aria-level=\"1\">Micro-aggregate filtration</li>\n<li aria-level=\"1\">Low leucocyte apheresis devices</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0e5b569df5184f2090100b7a6a5176cb.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "In a child with a unilateral undescended testis, a diagnostic laparoscopy is performed which showed the blind-ending testicular vessels on the right side. What is the next best step?",
    "choices": [
      {
        "id": 1,
        "text": "Inguinal exploration"
      },
      {
        "id": 2,
        "text": "Abdominal exploration"
      },
      {
        "id": 3,
        "text": "Scrotal exporation"
      },
      {
        "id": 4,
        "text": "No further exploration"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In non-palpable testis cases, laparoscopically encountering blind-ending vas deferens and testicular vessels prior to entering the internal ring is sufficient to <strong>diagnose a vanishing testis.</strong>&nbsp;In such cases,<strong>&nbsp;no further exploration is required.</strong></p>\n<p>Cryptorchidism is the&nbsp;<strong>failure</strong>&nbsp;of the descent of the intra-abdominal testes into the&nbsp;<strong>scrotal sac.</strong>&nbsp; It is the most common congenital abnormality of the genitourinary tract. The descent of the testes can<strong>&nbsp;arrest&nbsp;</strong>anywhere, and the most common site is the<strong>&nbsp;inguinal region.</strong></p>\n<p>Phases of testicular descent:</p>\n<ul>\n<li><strong>Transabdominal phase:&nbsp;</strong>Testes come to lie in the lower abdomen or pelvis, and this descent is regulated by<strong>&nbsp;Mullerian-inhibiting substances.</strong></li>\n<li><strong>Inguinoscrotal phase:&nbsp;</strong>Testes descend along the inguinal canal and reach the scrotal sac, and this phase of the descent is regulated by <strong>androgen-induced calcitonin gene-related peptide from the genitofemoral nerve.</strong></li>\n</ul>\n<p>The exact pathogenesis remains unknown; however, deficiency in gonadotropins and Mullerian-inhibiting substance (MIS) and increased expression of estradiol in the placenta are thought to play a role.&nbsp;</p>\n<p>Cryptorchidism is histopathologically characterized&nbsp;by the following:&nbsp;</p>\n<ol>\n<li>Testicular&nbsp;<strong>atrophy:</strong>&nbsp;thickening of the basement membrane, arrested germ cell development, marked hyalinization</li>\n<li>Tubules showing&nbsp;<strong>Sertoli cells but no spermatogenesis</strong></li>\n<li><strong>Increase</strong>&nbsp;in the interstitial&nbsp;<strong>Leydig cells</strong>&nbsp;</li>\n</ol>\n<div class=\"page\" title=\"Page 1337\">&nbsp;It is associated with testicular atrophy and dysfunction, which result in sterility. Cryptorchid testes carry a 3&ndash;5-fold higher risk for testicular cancer (usually seminoma).</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the surgical site infection rate expected in a patient with a clean-contaminated wound that is operated on after antibiotics prophylaxis?",
    "choices": [
      {
        "id": 1,
        "text": "1-2%"
      },
      {
        "id": 2,
        "text": "3%"
      },
      {
        "id": 3,
        "text": "13-20%"
      },
      {
        "id": 4,
        "text": "20-30%"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The surgical site infection rate expected in a patient with a <strong>clean contaminated wound</strong> that is operated upon <strong>after antibiotics prophylaxis</strong> is 3%.</p>\n<p class=\"p1\">SSI rates relating to wound contamination with and without using antibiotic prophylaxis:</p>\n<table style=\"height: 269px; width: 376px;\" width=\"334\">\n<tbody>\n<tr>\n<td style=\"width: 162.539px; text-align: center;\">\n<p class=\"p1\">Type of surgery</p>\n</td>\n<td style=\"width: 88.273px; text-align: center;\">\n<p class=\"p1\">Infection rate without prophylaxis (%)</p>\n</td>\n<td style=\"width: 82.7969px; text-align: center;\">\n<p class=\"p1\">Infection rate with prophylaxis (%)</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 162.539px;\">\n<p class=\"p1\">Clean</p>\n<p class=\"p1\">(no viscus opened)</p>\n</td>\n<td style=\"width: 88.273px; text-align: center;\">1-2</td>\n<td style=\"width: 82.7969px; text-align: center;\">1-2</td>\n</tr>\n<tr>\n<td style=\"width: 162.539px;\">\n<p class=\"p1\">Clean-contaminated</p>\n<p class=\"p1\">(viscus opened, minimal spillage)</p>\n</td>\n<td style=\"width: 88.273px; text-align: center;\">6-9</td>\n<td style=\"width: 82.7969px; text-align: center;\">3</td>\n</tr>\n<tr>\n<td style=\"width: 162.539px;\">\n<p class=\"p1\">Contaminated</p>\n<p class=\"p1\">(open viscus with spillage or inflammatory disease)</p>\n</td>\n<td style=\"width: 88.273px; text-align: center;\">13-20</td>\n<td style=\"width: 82.7969px; text-align: center;\">6</td>\n</tr>\n<tr>\n<td style=\"width: 162.539px;\">\n<p class=\"p1\">Dirty</p>\n<p class=\"p1\">(pus or perforation, or incision through an abscess)</p>\n</td>\n<td style=\"width: 88.273px; text-align: center;\">40</td>\n<td style=\"width: 82.7969px; text-align: center;\">7</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a component of qSOFA?",
    "choices": [
      {
        "id": 1,
        "text": "Respiratory rate \u226522/min"
      },
      {
        "id": 2,
        "text": "Systolic BP \u2264100 mm Hg"
      },
      {
        "id": 3,
        "text": "Altered mental status"
      },
      {
        "id": 4,
        "text": "Bilateral pupillary reflex"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>qSOFA</strong>&nbsp;score (quickSOFA) is a bedside prompt that may identify patients with suspected infection who are at greater risk for a poor outcome outside the intensive care unit (ICU).</p>\n<p>It uses three criteria, assigning one point each for</p>\n<ul>\n<li>Low blood pressure (SBP&le;100 mmHg),</li>\n<li>High respiratory rate (&ge;22 breaths per min)</li>\n<li>Altered mentation (Glasgow coma scale, &lt;15).</li>\n</ul>\n<p>The score ranges from 0 to 3 points. The presence of 2 or more qSOFA points is a simple prompt to identify infected patients outside the ICU who are likely to develop sepsis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following does not classify as locally advanced breast cancer?",
    "choices": [
      {
        "id": 1,
        "text": "Tumor more than 4 cm"
      },
      {
        "id": 2,
        "text": "Inflammatory breast cancer"
      },
      {
        "id": 3,
        "text": "Chest wall involvement"
      },
      {
        "id": 4,
        "text": "Skin involvement"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A breast tumor of<strong> size &gt; 5 cm</strong> (not 4 cm) is classified as locally advanced breast carcinoma <strong>(LABC)</strong>.\u00a0</p>\n<p>Invasive breast carcinoma is of 3 types:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Early breast carcinoma <strong>(EBC)</strong> - TNM combination of T1 to T2, N0 to N1, and M0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Locally advanced breast carcinoma <strong>(LABC)</strong> - T4N0M0, T3N1M0, TanyN2-3M0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Advanced breast carcinoma <strong>(ABC)</strong> - TanyNanyM1</li>\n</ol>\n<p>Locally advanced breast cancer <strong>(LABC)</strong> includes:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Breast tumors <strong>more than 5 cm</strong> in diameter\u00a0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Cancers that <strong>involve the skin</strong> or the <strong>underlying muscles</strong> of the chest (T4 of TNM staging)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Cancers that involve <strong>multiple local lymph nodes</strong> (axillary or sub clavicular)\u00a0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Inflammatory breast cancer</strong> - a rapidly growing type of cancer that makes the breast appear red and swollen\u00a0</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following are features of SIRS except:",
    "choices": [
      {
        "id": 1,
        "text": "Temperature > 38 degrees Celsius"
      },
      {
        "id": 2,
        "text": "Respiratory Rate > 20/minute and PaCO2 <35 mmHg"
      },
      {
        "id": 3,
        "text": "Pulse rate > 90/minute"
      },
      {
        "id": 4,
        "text": "WBC > 12000/mm3 or < 4000/mm3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\"><strong>Respiratory Rate &gt; 20/minute</strong> or (Not and) <strong>PaCO2 &lt; 32 mmHg</strong> (Not &lt;<span style=\"font-size: 15.5556px;\">35 mmHg</span>) would be a feature of <strong>SIRS</strong> (Systemic inflammatory response syndrome).</p>\n<p class=\"p1\">Systemic inflammatory response syndrome (SIRS) is an <strong>exaggerated defense response</strong> of the body to a noxious stressor (infection, trauma, surgery, acute inflammation, ischemia, or reperfusion) to localize and then eliminate the endogenous or exogenous source of the insult.</p>\n<p class=\"p2\">SIRS is diagnosed when any <strong>two</strong> of the following are present:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Hyperthermia</strong> (&gt;38 Degree Celsius) or <strong>Hypothermia</strong> (&lt;36 Degree Celsius)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Tachypnoea</strong> (&gt;20/min) or <strong>PaCO2 &lt; 32 mmHg</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Tachycardia</strong> (&gt;90/min)&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">White cell count <strong>&gt;12 x 10<sup>9</sup></strong>/liter <strong>or</strong> <strong>&lt;4 x 10<sup>9</sup></strong>/liter <strong>or</strong> <strong>&gt;10%</strong> Band forms</li>\n</ul>\n<p class=\"p2\">&nbsp;Sepsis is <strong>SIRS</strong> with <strong>a documented infection</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The most common neuroendocrine tumor of the pancreas is",
    "choices": [
      {
        "id": 1,
        "text": "Gastrinoma"
      },
      {
        "id": 2,
        "text": "Somatostatinoma"
      },
      {
        "id": 3,
        "text": "Insulinoma"
      },
      {
        "id": 4,
        "text": "VIPoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The\u00a0<strong>most common neuroendocrine</strong> tumor of the<strong> pancreas </strong>is<strong>\u00a0</strong><strong>insulinoma\u00a0</strong>(4 per million).</p>\n<p>Insulinoma is an insulin-producing tumor of the pancreas, with more than 90% of them being benign. It occurs in <strong>&gt;40 years</strong> in patients <strong>without</strong> MEN 1 syndrome and <strong>&lt;40 years</strong> in patients <strong>with MEN 1</strong>. It presents with symptoms of <strong>hypoglycemia</strong> such as weakness, headaches, sweating, faintness, seizures, and altered behavior. These occur <strong>after</strong> <strong>fasting</strong> or <strong>exertion</strong> and <strong>improve</strong> <strong>after glucose</strong> intake.\u00a0</p>\n<p>The investigation of choice for insulinoma is the determination of\u00a0<strong>72-hour fasting glucose</strong>\u00a0and\u00a0<strong>serum insulin levels.\u00a0</strong>C-peptide and proinsulin levels are also <strong>elevated.</strong></p>\n<p>Medical management includes:</p>\n<ul>\n<li><strong>Frequent</strong> carbohydrate-rich meals</li>\n<li><strong>Somatostatin analogs</strong> like\u00a0<strong>octreotide</strong> are effective in controlling symptoms due to excess insulin secretion. They should be used with caution as they can <strong>suppress</strong> <strong>counterregulatory hormones</strong>, such as growth hormone (GH), glucagon, and catecholamines, and precipitously <strong>worsen</strong> hypoglycemia.\u00a0</li>\n<li><strong>Diazoxide</strong> can be used in the <strong>initial management</strong>\u00a0of insulinoma as it <strong>inhibits insulin release</strong>. Its side effects include sodium retention and nausea.\u00a0</li>\n<li><strong>Everolimus</strong> has been found to be highly effective in <strong>improving glycemic control</strong> in patients with insulinoma owing to its <strong>antitumor effect</strong> and <strong>induction of insulin resistance.</strong></li>\n</ul>\n<p><strong>Enucleation</strong> and <strong>pancreatectomy </strong>are\u00a0the definitive surgical management of insulinoma.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Gastrinoma</strong> has an incidence of <strong>0.5 to 4 in a million</strong>.</p>\n<p>Options B &amp; D: <strong>Somatostatinoma</strong> and <strong>VIPoma</strong> are much rarer than gastrinoma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "After parotidectomy patients complains of loss of sensation while shaving. Which nerve is most likely affected?",
    "choices": [
      {
        "id": 1,
        "text": "Auriculotemporal nerve"
      },
      {
        "id": 2,
        "text": "Great auricular nerve"
      },
      {
        "id": 3,
        "text": "Facial nerve"
      },
      {
        "id": 4,
        "text": "Mandibular nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Other options:</p>\n<p>Option A: The auriculotemporal nerve, a branch of the mandibular nerve (V3 of trigeminal) supplies the posterior part of the <strong>temple</strong>, <strong>tragus</strong>, and adjoining auricle. It does not supply the area where a person is likely to shave. However, the injury to the auriculotemporal nerve resulting in aberrant regeneration would result in <strong>Frey's Syndrome</strong> (gustatory sweating).</p>\n<p>Option C: Though the facial nerve is the most common nerve affected during parotidectomy, any damage would result in <strong>facial paralysis</strong> and not loss of sensation of the face.</p>\n<p>Option D: The mandibular nerve is a branch of the trigeminal nerve (cranial nerve V) that supplies the skin over the mandible, lower lip, and cheek. However, they are <strong>not injured</strong> during parotidectomy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c9a0690eb72a443ca860da60760bcb6bx1280x1308.JPEG"
    ]
  },
  {
    "text": "ABCDE rule applies for:",
    "choices": [
      {
        "id": 1,
        "text": "Malignant melanoma"
      },
      {
        "id": 2,
        "text": "BCC"
      },
      {
        "id": 3,
        "text": "SCC"
      },
      {
        "id": 4,
        "text": "Actinic keratosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>ABCDE algorithm</strong> is used to <strong>diagnose</strong> <strong>melanoma</strong>.</p>\n<p>It comprises of:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Asymmetry</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Border irregularity</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Color variegation</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Diameter of more than 6 mm&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Evolution or change</li>\n</ul>\n<p><br /><strong>Melanoma</strong> is a malignant tumor arising from <strong>melanocytes&nbsp;</strong>at the<strong> epidermal-dermal junction</strong>. Though it represents only<strong> 4% of skin cancers</strong>, it<strong> accounts for 80% of deaths</strong> (high mortality rate). It presents as a <strong>pigmented</strong> lesion that has <strong>enlarged</strong>, ulcerated, or bled.</p>\n<p><strong>Histopathological</strong> <strong>confirmation</strong> is the <strong>gold</strong> <strong>standard</strong> in the diagnosis of <strong>melanoma</strong>. It is divided into <strong>four</strong> main types: nodular melanoma (NM), superficial spreading melanoma (SSM), lentigo maligna melanoma (LMM), and acral lentiginous melanoma (ALM).&nbsp;</p>\n<p>The treatment consists of <strong>wide</strong> <strong>local</strong> <strong>excision</strong> of the tumor and follow-up to detect any local recurrence around the scar and excluding nodal spread.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the following instrument?",
    "choices": [
      {
        "id": 1,
        "text": "Unipolar cautery"
      },
      {
        "id": 2,
        "text": "Bipolar cautery"
      },
      {
        "id": 3,
        "text": "Harmonic scalpel"
      },
      {
        "id": 4,
        "text": "Ligasure"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option D: LigaSure vessel sealing system (shown below) is a <strong>bipolar apparatus</strong> for sealing vascular tissue. It applies a <strong>high coaptive pressure</strong> during the generation of tissue temperature under 1000&deg;C, <strong>hydrogen cross-links</strong> are first ruptured and then renatured, resulting in a vascular seal that has <strong>high tensile strength</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/60fc29a16f1d4dfdb504b26ed5a03526.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/654a4e1b00464eec885a99eaf02876acx720x827.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/90d35681b8114a99b2a5a0ede9a998f9x512x200.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74ed992a61ef498a8309022346b666e6x210x151.PNG"
    ]
  },
  {
    "text": "Radical neck dissection spares which of the following structures?",
    "choices": [
      {
        "id": 1,
        "text": "Digastric muscle"
      },
      {
        "id": 2,
        "text": "Sternocleidomastoid muscle"
      },
      {
        "id": 3,
        "text": "Spinal accessory nerve"
      },
      {
        "id": 4,
        "text": "Ipsilateral cervical lymph nodes"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Digastric muscle is spared in radical neck dissection (RND). RND is used in the treatment of malignant lesions of the neck with local spread or metastasis.&nbsp;</p>\n<p>In 1905, Crile described <strong>RND</strong> where<strong> Level I-V LN</strong>, sternocleidomastoid <strong>(SCM)</strong>, internal jugular vein<strong> (IJV)</strong>, and <strong>XI cranial nerve</strong> (spinal accessory nerve) are <strong>removed</strong>.</p>\n<p>In 1962, Suarez described modified RND<strong> (MRND)</strong> where <strong>Level I-V LNs</strong>&nbsp;are&nbsp;<strong>removed</strong> and the following are <strong>preserved</strong>:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">MRND I - XI cranial nerve&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">MRND II -&nbsp; XI cranial nerve and IJV</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">MRND III - XI cranial nerve, IJV, and SCM</li>\n</ol>\n<p><br />Note: RND with an additional LN/muscle/nerve is called extended RND.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient comes with active variceal bleeding. Which of the following is not done?",
    "choices": [
      {
        "id": 1,
        "text": "Platelet transfusion"
      },
      {
        "id": 2,
        "text": "Arrange pRBC"
      },
      {
        "id": 3,
        "text": "IV Octreotide"
      },
      {
        "id": 4,
        "text": "Urgent Endoscopy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Platelet transfusion</strong> is <strong>not</strong> done in the case of <strong>active variceal bleeding</strong> unless <strong>coagulopathy</strong> is <strong>confirmed</strong> as the <strong>cause</strong>. Platelet transfusions are indicated only in patients with a platelet count of &lt;50,000/microL\u00a0 or in patients with evidence of microvascular bleeding.</p>\n<p><strong>Variceal</strong> <strong>hemorrhage</strong> is a medical emergency. Varices usually present with the <strong>acute onset</strong><strong>\u00a0large-volume haematemesis</strong>, the <strong>lower</strong> <strong>esophagus</strong> being the <strong>most common site</strong> for variceal bleeding.</p>\n<p>The <strong>sites</strong> for portosystemic anastomosis are:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Left</strong> <strong>gastric</strong> vein to <strong>distal</strong> <strong>oesophageal</strong> veins: oesophageal and gastric variceal bleeding</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Superior</strong> <strong>rectal</strong> veins to <strong>Middle</strong> and <strong>inferior</strong> rectal veins: hemorrhoids and rectal bleeding</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Left branch</strong> of the portal vein to <strong>Periumbilical</strong> veins: caput-medusae</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The <strong>right</strong> <strong>branch</strong> of the portal vein to <strong>retroperitoneal</strong> veins draining into azygos, hemiazygos, lumbar, intercostal, and phrenic veins</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Omental</strong> and <strong>colonic</strong> veins near hepatic and splenic \ufb02exures to <strong>Retroperitoneal</strong> veins near hepatic and splenic \ufb02exures</li>\n</ul>\n<p><strong>Medical</strong> <strong>management</strong> of variceal bleeding includes<strong> blood transfusion (option B)</strong>\u00a0and drug therapy with <strong>somatostatin</strong> <strong>analogs</strong> like <strong>octreotide (option C)</strong>. Short-term antibiotics like ceftriaxone are known to decrease bacterial infection and increase survival.</p>\n<p><strong>Surgical</strong> <strong>measures</strong> are preferred if <strong>medical</strong> management <strong>fails</strong>. They include <strong>balloon</strong> <strong>tamponade</strong>, <strong>endoscopic banding (option D)</strong>, transjugular intrahepatic portosystemic shunt <strong>(TIPS)</strong>, portosystemic shunts, splenectomy, and gastric revascularization</p>\n<p>Note: <strong>Sugiura</strong> <strong>procedure</strong> is the <strong>non-shunt</strong> <strong>surgical management</strong> of <strong>refractory</strong> oesophageal variceal bleeding. It is a procedure of de-vascularizing the distal esophagus and stomach.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2f488b42a32444f4874fb788c84a0e28x1280x1654.JPEG"
    ]
  },
  {
    "text": "A child presents with pain and swelling in the right side of his scrotum and testicular torsion is suspected. Which is the most appropriate management?",
    "choices": [
      {
        "id": 1,
        "text": "Immediate exploration on both symptomatic and asymptomatic side"
      },
      {
        "id": 2,
        "text": "Immediate exploration on symptomatic side only"
      },
      {
        "id": 3,
        "text": "Delayed exploration on both symptomatic and asymptomatic side"
      },
      {
        "id": 4,
        "text": "Delayed exploration on symptomatic side only"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In a case of <strong>suspected testicular torsion</strong>, <strong>immediate exploration</strong> needs to be done on <strong>both</strong> the symptomatic as well as the asymptomatic side. After the de-torsion, the adequacy of the blood flow has to be assessed by Doppler.</p>\n<p>In <strong>testicular torsion</strong>, the <strong>blood</strong> <strong>supply</strong> to the testicle is <strong>compromised</strong> due to the twisting of the spermatic cord within the<strong> tunica vaginalis</strong>, resulting in ischemia of the epididymis and the testis. The patient usually presents with <strong>acute onset pain</strong> and <strong>swelling</strong> of the <strong>scrotum</strong>. On examination, the <strong>cremasteric reflex is lost</strong>, and the <strong>scrotum</strong> looks <strong>asymmetrical</strong>.&nbsp;</p>\n<p><strong>Prehn&rsquo;s sign</strong> is used to differentiate <strong>epididymitis</strong> from <strong>testicular</strong> <strong>torsion</strong>. Prehn&rsquo;s sign is said to be positive when the pain gets relieved on lifting the testis, and it is seen in epididymo-orchitis.</p>\n<p>At the time of surgical exploration, <strong>contralateral</strong> testes also must be <strong>explored</strong> and <strong>fixed</strong> to the dartos fascia in order to prevent possible torsion occurring in this testes.</p>\n<p>More than 80% of the testis can be salvaged if surgery is performed within <strong>6 hours</strong>. If the testis is found to be necrosed on scrotal exploration, orchidectomy of the necrosed testis and orchidopexy of the contralateral testis is done.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the instrument shown below that is used to create a pneumoperitoneum ?",
    "choices": [
      {
        "id": 1,
        "text": "Veress needle"
      },
      {
        "id": 2,
        "text": "Salah's needle"
      },
      {
        "id": 3,
        "text": "Hasson Trocar"
      },
      {
        "id": 4,
        "text": "Von Graefe needle"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Option D: </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Von</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Graefe</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> needle (also known as Graefe's knife) is </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">primarily</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> used in </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">ophthalmic</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">surgery</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3d015fa229ba49698cced76cfbc8cbf4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1dc4dcf008464391af178e36afae9445x616x301.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/61c45f7654ac41b682c79029bba3c77cx500x500.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ea25b6ec1e494a2bb42baf99b3a29bfdx1279x735.JPEG"
    ]
  },
  {
    "text": "Which of the following is the principle behind the wound-healing procedure shown in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Negative pressure wound therapy"
      },
      {
        "id": 2,
        "text": "Positive pressure wound therapy"
      },
      {
        "id": 3,
        "text": "Foam therapy"
      },
      {
        "id": 4,
        "text": "Sponge therapy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows <strong>negative pressure wound therapy</strong> using a vacuum-assisted closure <strong>(VAC)</strong> device to promote healing in <strong>chronic</strong> wounds.</p>\n<p>Principle: An <strong>intermittent</strong> negative pressure of <strong>-125 mmHg</strong> hastens debridement and formation of granulation tissue in chronic wounds.</p>\n<p>Indications: <strong>Chronic wounds</strong> (such as diabetic foot ulcers, <strong>stage III and IV pressure ulcers</strong>),&nbsp;traumatic wounds, flaps and grafts, and dehisced incisions.</p>\n<p>Contraindications:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Exposed vital structures</strong> (organs, blood vessels, or vascular grafts)&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Preexisting infection&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Inadequate</strong> debridement of <strong>devitalized</strong> soft tissue or bone increases the risk of infection.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The presence of malignancy<strong> (Marjolin&rsquo;s ulcer)</strong>.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">An allergic reaction towards the adhesive used to maintain the vacuum seal.</li>\n</ol>\n<p>Though not an absolute contraindication, there is <strong>no appreciable benefit</strong> for ischemic wounds.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/343819643f414ecdb0ef4a522676ff6d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Stage the bedsore in the following image:",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "3"
      },
      {
        "id": 3,
        "text": "2"
      },
      {
        "id": 4,
        "text": "1"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows <strong>complete</strong> <strong>skin</strong> <strong>loss</strong> that involves <strong>muscles</strong> and shows <strong>exposed</strong> <strong>bone</strong> indicating a <strong>stage</strong> <strong>4</strong> <strong>pressure sore.</strong></p>\n<p>Pressure sores are skin or soft tissue injuries that occur due to <strong>prolonged</strong> <strong>pressure</strong> over <strong>specific</strong> <strong>areas</strong> of the body. An external pressure of <strong>&gt;30 mmHg</strong> leads to the formation of pressure sores. The common sites of pressure sores in decreasing frequency are the <strong>ischium</strong>, <strong>greater</strong> <strong>trochanter</strong>, sacrum, heel, malleolus (lateral followed by medial), and occiput.</p>\n<p>Pressure sores can be prevented with <strong>good skincare</strong>, the use of air-fluidized beds, special pressure-dispersion cushions, or foams. <strong>Repositioning</strong> the patient<strong> every two hours</strong> can lessen the pressure on the area.&nbsp;</p>\n<p>Ulcers of <strong>stages 1 and 2</strong> often do <strong>not</strong> require <strong>operative</strong> <strong>measures</strong>. They are managed with regular wound cleaning and dressing with a good antibiotic cover.</p>\n<p><strong>Stage 3 and 4</strong> ulcers are adequately <strong>debrided</strong>, and vacuum-assisted closure <strong>(VAC)</strong> is used to promote the growth of granulation tissue required for surgical closure. Large skin flaps that have muscle with sensory innervation are best for reconstruction.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/93227f683c5c406398747cba22815f56.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient with a road traffic accident presented to the emergency room and requires a large amount of fluids to be transfused. Which of the following IV cannula is preferred?",
    "choices": [
      {
        "id": 1,
        "text": "Green"
      },
      {
        "id": 2,
        "text": "Blue"
      },
      {
        "id": 3,
        "text": "Pink"
      },
      {
        "id": 4,
        "text": "Grey"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Grey</strong> coloured IV cannula is required for this patient in order to transfuse large amount of fluids.</p>\n<p>The <strong>ATLS</strong> 10th edition guidelines state that <strong>2 cannulae</strong> of <strong>atleast 18G</strong> should be used to gain vascular access in trauma patients. In this scenario requiring large fluid transfusions, the grey (16G) cannula would be preferable to the green (18G) cannula due to the higher flow rate.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with a nodule of the neck presents to the surgery OPD. A junior resident performs the following method to palpate it. Identify the procedure shown in the video below.",
    "choices": [
      {
        "id": 1,
        "text": "Lahey's method"
      },
      {
        "id": 2,
        "text": "Crile's method"
      },
      {
        "id": 3,
        "text": "Kocher's method"
      },
      {
        "id": 4,
        "text": "Pemberton's  method"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option C: <strong>Kocher's method</strong> is done to demonstrate the <strong>pressure effect</strong> of the thyroid gland on the <strong>trachea</strong> or <strong>larynx</strong>. <strong>Lateral</strong> <strong>compression</strong> will result in <strong>stridor</strong>.</p>\n<p>Option D: <strong>Pemberton's</strong> <strong>sign </strong>(not method), is <strong>engorgement of neck veins </strong>when the patient is asked to raise their hands above the head and the arms should touch the ears. It is seen in patients with <strong>retrosternal goiter.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/263233731a97445ba5cad0ce70d913a8.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ce429ab8ae72405d88b511078b9a3737x720x734.GIF"
    ]
  },
  {
    "text": "The instrument given in the image is:",
    "choices": [
      {
        "id": 1,
        "text": "Hemovac"
      },
      {
        "id": 2,
        "text": "Jackson-Pratt drain"
      },
      {
        "id": 3,
        "text": "Minivac"
      },
      {
        "id": 4,
        "text": "Corrugated drain"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Other options:</p>\n<p>Option A: <strong>Hemovac</strong> is also a <strong>closed</strong> <strong>type</strong> of suction drain which can typically handle <strong>larger amounts</strong> of fluid than the JP drain.</p>\n<p>Option C: <strong>Minivac</strong> is a <strong>closed wound drainage</strong> system under <strong>negative pressure</strong> used in<strong> minor surgeries.</strong></p>\n<p>Option D: <strong>Corrugated drain</strong> is an <strong>open</strong> <strong>drainage</strong> system to <strong>remove</strong> excess <strong>fluid</strong> from the <strong>operated</strong> <strong>site</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/210266563a904215911189525e7a5788.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6178bee5c9a44efc86e4b6f359c6c1fdx1280x1565.JPEG"
    ]
  }
];
        let quizName = '228 Surgery Aiims 2019  (May & Nov)';
        let hierarchy = ["Marrow", "PYQs", "Surgery"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>