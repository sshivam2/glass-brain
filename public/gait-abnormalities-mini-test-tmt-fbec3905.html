<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gait Abnormalities Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2024-25
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 55-year-old woman, who is a known case of carcinoma breast, had blurred vision, nausea and vomiting. After a few weeks,\u200b the patient developed clumsiness of both hands and imbalance that has led to several falls. MRI revealed cerebellar atrophy. Which of the following is the most appropriate next step in the evaluation of the patient?",
    "choices": [
      {
        "id": 1,
        "text": "Nerve conduction studies"
      },
      {
        "id": 2,
        "text": "CT angiography"
      },
      {
        "id": 3,
        "text": "Serum anti-Yo (PCA1)"
      },
      {
        "id": 4,
        "text": "Cervical spine MRI"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Serum anti-Yo (PCA1) </strong>is assessed to evaluate for paraneoplastic cerebellar degeneration.</p>\n<p>The presence of <strong>gait</strong> and <strong>limb</strong> ataxia and subacute onset of symptoms together with MRI findings of cerebellar atrophy is suggestive of <strong>paraneoplastic cerebellar degeneration </strong>mainly due to extensive degeneration of <strong>purkinje</strong> <strong>cells</strong>.</p>\n<p>The syndrome occurs due to the antibodies that develop against the neural proteins expressed by the tumors, which cross-react with normal neuronal tissue.</p>\n<p>The tumors commonly involved include:</p>\n<ul>\n<li>Small cell lung cancer</li>\n<li>Breast carcinoma</li>\n<li>Ovarian carcinoma</li>\n<li>Hodgkin&rsquo;s lymphoma</li>\n</ul>\n<p><strong>The anti neuronal antibodies</strong> may be detected in the <strong>serum</strong> and/or <strong>CSF</strong>.</p>\n<p>These antibodies causing cerebellar syndrome include:</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Antibodies</strong></td>\n<td><strong>Tumor associated</strong></td>\n</tr>\n<tr>\n<td>Purkinje cell cytoplasmic antibody type 1 (<strong>PCA1</strong>), also called <strong>Anti-yo</strong></td>\n<td>Carcinoma of the breast, ovary</td>\n</tr>\n<tr>\n<td>Antibodies against voltage gated calcium channels (<strong>Anti-VGCC</strong>)</td>\n<td>Small cell lung cancer</td>\n</tr>\n<tr>\n<td><strong>Anti-Tr</strong> (or anti-Delta/Notch-like epidermal growth factor-related receptor [<strong>DNER</strong>])</td>\n<td>Hodgkin&rsquo;s lymphoma</td>\n</tr>\n<tr>\n<td>Anti Metabotropic glutamate receptor 1 (<strong>mGluR1</strong>)</td>\n<td>Hodgkin&rsquo;s lymphoma</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old boy was admitted to the hospital with recurrent infections. His gait was uncoordinated and ocular examination revealed ocular telangiectasia in the right eye. Which of the following is the most likely mode of inheritance of the disease described in the clinical scenario?",
    "choices": [
      {
        "id": 1,
        "text": "X linked dominant"
      },
      {
        "id": 2,
        "text": "Autosomal recessive"
      },
      {
        "id": 3,
        "text": "Autosomal dominant"
      },
      {
        "id": 4,
        "text": "X linked recessive"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical features of <strong>uncoordinated gait</strong> and <strong>ocular telangiectasia</strong> in the given scenario are suggestive of <strong>ataxia-telangiectasia,</strong> and the mode of inheritance of this disease is <strong>autosomal recessive.</strong></p>\n<p>Ataxia-telangiectasia is a syndrome complex that comprises neurologic, immunologic, endocrinologic, and cutaneous disorders.&nbsp;The gene involved in this condition is the <strong>mutation</strong> in the <strong>ATM&nbsp;gene</strong> mapped to the long arm of chromosome <strong>11(11q22-23). </strong>There is <strong>d</strong><strong>efective DNA repair </strong>and increased sensitivity to ionizing radiation. A hypoplastic thymus is present in this condition.</p>\n<p>The age of <strong>onset</strong> of telangiectasia is around <strong>3 to 6 years.</strong> By 12 years of age, affected children are usually confined to wheelchairs due to progressive ataxia.&nbsp;</p>\n<p>Clinical features:</p>\n<ul>\n<li>Progressive <strong>cerebellar ataxia</strong></li>\n<li><strong>Oculocutaneous telangiectasias</strong></li>\n<li>Chronic sinopulmonary disease</li>\n<li>High incidence of malignancy:<strong>&nbsp;adenocarcinomas and lymphoreticular tumors</strong> (lymphoma, leukemia, and Hodgkin's disease)</li>\n<li>Humoral and cellular immunodeficiency</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are assessing a patient with Normal Pressure Hydrocephalus. What type of gait would you expect to see?",
    "choices": [
      {
        "id": 1,
        "text": "Unsteady, falling towards one side"
      },
      {
        "id": 2,
        "text": "Short steps, shuffling and festinant"
      },
      {
        "id": 3,
        "text": "Excessive hip flexion and slapping of one foot"
      },
      {
        "id": 4,
        "text": "Broad-based and shuffling"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Broad-based and shuffling</strong> is the most likely gait you would expect to see in a patient with Normal Pressure Hydrocephalus (NPH).\u00a0</p>\n<p>This gait is characterized by a <strong>wide/broad-base, shuffling, short strides, </strong>and hesitation with<strong> starting and turning.</strong></p>\n<p>Normal pressure hydrocephalus presents with a characteristic clinical triad of ataxia in the form of broad/wide-based gait (<strong>magnetic gait</strong>), <strong>urinary incontinence, and dementia</strong>. Since intracranial pressure is normal, there will be <strong>no papilledema </strong>in patients with normal pressure hydrocephalus.</p>\n<p>Normal-pressure hydrocephalus is a <strong>communicating hydrocephalus</strong> (non-obstructive hydrocephalus) caused by <strong>delayed resorption</strong> of cerebrospinal fluid.<strong> Meningeal scarring</strong> is seen in some patients, due to previous history of meningitis, subarachnoid hemorrhage, or head trauma.</p>\n<p>On imaging, <strong>dilated lateral ventricles</strong> are seen. Lumbar puncture<strong> opening pressure </strong>is in the<strong> normal</strong> to high range.</p>\n<p>Treatment includes <strong>ventricular shunting</strong>. <strong>Gait</strong> improves <strong>more</strong> than <strong>cognition.</strong></p>\n<p>Option A.<strong> Unsteady, falling towards one side</strong> is suggestive of a <strong>vestibular condition</strong> such as <strong>Meniere's disease, vestibular neuritis or labyrinthitis.</strong></p>\n<p>Option B. <strong>Short steps, shuffling and festinant</strong> is a description of festinating gait, which is seen in <strong>Parkinson's </strong>disease.</p>\n<p>Option C. <strong>Excessive hip flexion and slapping </strong>of one foot is a description of slapping gait, which is seen in <strong>motor neuropathy - eg common peroneal neuropathy.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the given conditions will not lead to the abnormal sign shown in the image given below?",
    "choices": [
      {
        "id": 1,
        "text": "Injury to inferior gluteal nerve"
      },
      {
        "id": 2,
        "text": "Injury to gluteus medius"
      },
      {
        "id": 3,
        "text": "Injury to superior gluteal nerve"
      },
      {
        "id": 4,
        "text": "Fracture neck of femur"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows Trendelenburg&rsquo;s sign, which is caused mainly due to the injury to <strong>gluteus</strong> <strong>medius</strong>, <strong>gluteus</strong> <strong>minimus,</strong> or <strong>superior</strong> <strong>gluteal</strong> <strong>nerve</strong> (nerve supplying the abductors), and not inferior gluteal nerve.</p>\n<p><strong>Trendelenburg sign:</strong> This sign is demonstrated by asking the patient to stand on one limb. When the patient stands on the affected limb, the pelvis severely drops over the swing limb.</p>\n<p>Causes of positive Trendelenburg sign:</p>\n<ul>\n<li>Paralysis of abductor muscles: Gluteus medius and gluteus minimus (injury, polio)</li>\n<li>Damage to the superior gluteal nerve</li>\n<li>Dislocation of the hip</li>\n<li>Destruction of the head of the femur</li>\n<li>Fracture neck of the femur</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/803ea349557e497d87db45b738246454.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2cb7a5a51ea5422e96254c000492acf5x1280x4280.JPEG"
    ]
  },
  {
    "text": "Which of the following sequences correctly represents the phases of the gait cycle during a single stride?",
    "choices": [
      {
        "id": 1,
        "text": "1-4-2-3-5-6"
      },
      {
        "id": 2,
        "text": "1-5-2-3-4-6"
      },
      {
        "id": 3,
        "text": "1-2-4-3-5-6"
      },
      {
        "id": 4,
        "text": "1-2-3-4-5-6"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct sequence for the phases of the gait cycle is:</p>\n<p><strong>Heel strike -&gt; Mid Stance -&gt; Push Off -&gt; Acceleration -&gt; Mid Swing -&gt; Deceleration</strong></p>\n<p>A normal gait follows a specific pattern, consisting of multiple gait cycles. A <strong>gait cycle </strong>is defined as the interval from the heel strike of one leg to its next heel strike. The gait cycle is divided into two phases:</p>\n<p>a) <strong>Stance phase</strong></p>\n<p>b) <strong>Swing phase</strong></p>\n<p>Stance phase: This phase of the gait cycle occurs when the foot is in contact with the ground. It begins with the heel strike and ends with the toe off, making up <strong>60 percent </strong>of the gait cycle. The stance phase includes three key events:</p>\n<p>- <strong>Heel strike</strong>: The moment the heel makes contact with the ground.<br />- <strong>Mid stance</strong>: When the entire foot is flat on the ground.<br />- <strong>Push off:</strong> When the body is propelled forward by pushing off the ground with the foot; the heel lifts first, followed by the toes.</p>\n<p>Swing phase: This phase occurs when the foot is off the ground. It begins with the toe off and ends when the foot is ready to strike the ground again. The swing phase accounts for <strong>40 percent </strong>of the gait cycle and includes the following events:</p>\n<p>- <strong>Acceleration:</strong> Once the foot leaves the ground, the leg moves forward with the help of hip flexors.<br />- <strong>Mid swing:</strong> The midpoint of the leg\u2019s forward motion.<br />- <strong>Deceleration:</strong> The leg slows down to prepare the foot for the next heel strike.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old woman presents with recent confusion and difficulty in doing daily activities of living. She also has recent urinary incontinence and walks with a magnetic gait. She has a past history of meningitis. Which of the following is the definitive management of her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Venticuloperitoneal shunting"
      },
      {
        "id": 2,
        "text": "Periodic lumbar punctures"
      },
      {
        "id": 3,
        "text": "Levodopa-carbidopa"
      },
      {
        "id": 4,
        "text": "Acetylcholinesterase inhibitors"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The classic\u00a0<strong>triad of dementia</strong>(difficulties in activities of daily living and confusion)<strong>, hypokinetic magnetic gait,</strong>\u00a0and<strong> urinary incontinence </strong>seen in this patient suggest\u00a0<strong>normal-pressure hydrocephalus </strong>(NPH). The definitive treatment of this condition is <strong>ventriculoperitoneal shunting</strong> to reduce the intracranial pressure on the surrounding brain tissue.</p>\n<p>Normal-pressure hydrocephalus is a\u00a0<strong>communicating hydrocephalus</strong>\u00a0caused by\u00a0<strong>delayed resorption</strong>\u00a0of cerebrospinal fluid.\u00a0<strong>M</strong><strong>eningeal scarring</strong>\u00a0is seen in some patients, due to previous history of meningitis, subarachnoid hemorrhage, or head trauma.</p>\n<p>It presents with the characteristic triad of</p>\n<ul>\n<li>Dementia (mostly executive function),</li>\n<li>Ataxic or apractic gait, and</li>\n<li>Urinary incontinence (sometimes urgency too).</li>\n</ul>\n<p>It is classified as <strong>idiopathic</strong> (primary) or <strong>symptomatic</strong> (secondary) occurring due to prior brain infection, injury, radiation, or hemorrhage.\u00a0</p>\n<p>The etiology is poorly understood but is thought to be related to the<strong> hyperdynamic flow of CSF</strong> in the aqueduct, reduced compliance of the subarachnoid space, <strong>increased CSF</strong> pulse <strong>pressure</strong>, and <strong>reduced</strong> <strong>reabsorption</strong> of CSF.\u00a0</p>\n<p>Diagnosis:\u00a0</p>\n<ul>\n<li>Neuroimaging reveals\u00a0<strong>enlarged lateral ventricles</strong>\u00a0(hydrocephalus) with little or\u00a0<strong>no cortical atrophy</strong>, although the Sylvian fissures can be mistaken for perisylvian atrophy due to the propped open (so-called \u201c<strong>boxcarring</strong>\u201d) appearance.</li>\n<li>CSF parameters are normal except for the high range of pressure.</li>\n<li>Another confirmatory test performed is the cerebrospinal fluid\u00a0<strong>(</strong><strong>CSF) tap test</strong>,<strong>\u00a0</strong>which shows marked improvement of symptoms with spinal fluid removal.</li>\n</ul>\n<p>Treatment: Ventriculoperitoneal shunting: It\u00a0is done to drain excess\u00a0cerebrospinal fluid (CSF). Complications of the shunting procedure include\u00a0<strong>shunt obstruction</strong>,<strong>\u00a0infection, i</strong><strong>ntracerebral or intraventricular hemorrhage,\u00a0</strong>malposition\u00a0or breakage of the shunt, etc.</p>\n<p>Other options:</p>\n<p>Option B - Periodic lumbar punctures can help reduce the symptoms in pseudotumour cerebri but have no role in the management of NPH.</p>\n<p>Option C - <strong>Levodopa-carbidopa\u00a0</strong>is used in the management of Parkinsons disease which presents with tremors, rigidity, akinesia and postural instability.</p>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Option D - <strong>Acetylcholine esterase inhibitors\u00a0</strong>like rivastigmine, galantamine are used in the management of Alzheimer's disease.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient who is being evaluated for an abnormal gait was asked to stand on one leg. It was observed that his opposite side pelvis began to drop. Identify the point of insertion of the affected muscles in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The scenario describes the<strong> Trendelenburg sign</strong>. The muscles affected are the&nbsp;<strong>gluteus</strong> <strong>medius&nbsp;</strong>and&nbsp;<strong>gluteus</strong> <strong>minimus.&nbsp;</strong>They are attached to the <strong>greater trochanter</strong> which is labeled as <strong>1</strong> in the image.</p>\n<p><strong>Trendelenburg sign:</strong> This sign is demonstrated by asking the patient to stand on one limb. When the patient stands on the affected limb, the pelvis severely drops over the swing limb.</p>\n<p>Causes of positive Trendelenburg sign:</p>\n<ul>\n<li>Paralysis of the abductor muscles: Gluteus medius and gluteus minimus (injury, polio)</li>\n<li>Damage to the superior gluteal nerve</li>\n<li>Dislocation of the hip</li>\n<li>Destruction of the head of the femur</li>\n<li>Fracture neck of the femur</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/65835ce3f6654e14a4c72100d659b4ab.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2cb7a5a51ea5422e96254c000492acf5x1280x4280.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/67066fb092614d779d80ccbb651c9db2x1280x2213.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7469ea311fbb4dfea134ad41d53856bfx800x600.JPEG"
    ]
  },
  {
    "text": "Hyperkinetic gait is typically associated with which of the following conditions:",
    "choices": [
      {
        "id": 1,
        "text": "Friedrich\u2019s ataxia"
      },
      {
        "id": 2,
        "text": "Huntington\u2019s disease"
      },
      {
        "id": 3,
        "text": "Wilson\u2019s disease"
      },
      {
        "id": 4,
        "text": "Progressive supranuclear palsy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Hyperkinetic gait </strong>involves<strong> involuntary, excessive </strong>movements and is most commonly associated with <strong>Huntington\u2019s disease</strong>. The random choreic movements give the gait a dancing quality.</p>\n<p>Option A:<strong> Friedrich\u2019s ataxia</strong>: It is a hereditary disorder causing progressive damage to the nervous system and the gait typically is ataxic due to <strong>loss of proprioception </strong>and coordination.</p>\n<p>Option C: <strong>Wilson\u2019s disease:</strong> It is a disease of copper metabolism causing a variety of movement disorders, including tremors, dystonia, and parkinsonism. These abnormal movements are often <strong>mixed</strong> and can include <strong>both hyperkinetic and hypokinetic features.</strong></p>\n<p>Option D:<strong> Progressive supranuclear palsy:</strong> It is a <strong>neurodegenerative</strong> disorder that typically leads to <strong>hypokinetic-rigid syndrome </strong>similar to Parkinson\u2019s disease.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 38-year-old man came to the Orthopedic outpatient clinic with a new complaint. He had sustained a left isolated shaft of femur fracture 6 months ago and was managed with traction in a rural health centre. He noticed a difference in his gait once he started weight-bearing exercises. Which of the following gait abnormalities is likely to be seen in him?",
    "choices": [
      {
        "id": 1,
        "text": "Circumduction gait"
      },
      {
        "id": 2,
        "text": "Trendelenburg gait"
      },
      {
        "id": 3,
        "text": "Quadriceps gait"
      },
      {
        "id": 4,
        "text": "High stepping gait"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>High stepping gait</strong> is a gait abnormality seen with foot drop, which may be a complication in the\u00a0<strong>shaft of femur fractures. </strong>This is due to possible injury to<strong>\u00a0</strong>the<strong> sciatic nerve. </strong>The sciatic nerve runs down the back of the thigh and can be injured during trauma, leading to weakness or paralysis in the muscles it innervates, including those responsible for dorsiflexion.</p>\n<p>A high stepping gait helps to clear the dropped foot off the ground while walking due to problems with dorsiflexion.</p>\n<p>Another common cause for foot drop and high stepping gait can be the <strong>neck of fibula fracture</strong> causing damage to the <strong>common peroneal nerve.</strong> Temporary measures to relieve the foot drop involve <strong>physiotherapy</strong> and <strong>toe raising spring</strong>. <strong>Posterior tibialis transfer</strong> is indicated in <strong>complete foot drop</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child presents with neonatal hypotonia, tachypnoea, abnormal eye movements, and mental retardation. On axial imaging, the fourth ventricle is abnormally shaped with a \u2018batwing appearance\u2019 as given below. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rhombencephalosynapsis"
      },
      {
        "id": 2,
        "text": "Pontine tegmental cap dysplasia"
      },
      {
        "id": 3,
        "text": "Joubert syndrome"
      },
      {
        "id": 4,
        "text": "Dandy walker malformation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario and the image showing the<strong> Molar tooth sign</strong> suggest the diagnosis of<strong> Joubert syndrome. The image</strong>&nbsp;shows an<strong>&nbsp;</strong>axial T2 weighted image at the level of superior cerebellar peduncles demonstrating the&nbsp;<strong>molar tooth sign</strong>.</p>\n<p><strong>Joubert syndrome:</strong></p>\n<p>These are a group of recessive <strong>congenital ataxia</strong> disorders in which typically there is</p>\n<ul>\n<li>Neonatal hypotonia</li>\n<li>Tachypnoea</li>\n<li>Abnormal eye movements</li>\n<li>Mental retardation associated with a particular pattern of cerebellar dysgenesis with a <strong>molar tooth-type malformation</strong> and vermis hypoplasia</li>\n</ul>\n<p><strong>MRI features :</strong></p>\n<ul>\n<li>The cardinal feature is the presence of a <strong>molar tooth</strong>&nbsp;<strong>sign</strong> which is created by a <strong>combination of</strong>\n<ul>\n<li><strong>Midbrain hypoplasia</strong> with an</li>\n<li><strong>Abnormally deep interpeduncular fossa</strong> and</li>\n<li><strong>A failure of the superior cerebellar peduncles</strong> to <strong>decussate</strong> across the midline.</li>\n</ul>\n</li>\n<li>On axial imaging, the <strong>fourth ventricle</strong> is abnormally shaped with a <strong>batwing appearance</strong></li>\n<li>Cerebellar hypoplasia</li>\n<li>Midline vermian cleft</li>\n<li>Dysplastic small vermis</li>\n<li>The midbrain is small</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8de790473815413ba4f7c0751e25a729.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is primarily responsible for the development of a scissoring gait in children with cerebral palsy?",
    "choices": [
      {
        "id": 1,
        "text": "Spasticity of the quadriceps muscles"
      },
      {
        "id": 2,
        "text": "Spasticity of the gastrocnemius muscles"
      },
      {
        "id": 3,
        "text": "Weakness of the hip abductor muscles"
      },
      {
        "id": 4,
        "text": "Spasticity of the hip adductor muscles"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Scissoring gait</strong> in children with <strong>cerebral palsy </strong>is primarily caused by the <strong>spasticity</strong> of the <strong>hip adductor</strong> muscles- adductor longus, adductor brevis, and adductor magnus.</p>\n<p>The <strong>excessive tone </strong>in these muscles pulls the legs inward, causing them to cross in a scissoring fashion and leading to the characteristic gait abnormality.</p>\n<p>Option A:<strong> Spasticity</strong> of the <strong>quadriceps</strong> muscles: Spasticity in these muscles can lead to knee hyperextension or a <strong>stiff-legged gait</strong>.</p>\n<p>Option B: <strong>Spasticity</strong> of the <strong>gastrocnemius</strong> muscles: This typically leads to an equinus deformity or <strong>toe-walking.</strong></p>\n<p>Option C: <strong>Weakness</strong> of the<strong> hip abductor </strong>muscles: This leads to the <strong>Trendelenburg gait.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A man presented with slurred speech and festinating shuffling gait. He tells that a course of levodopa was advised by his previous doctor but didn't show any effect. Which of the following mineral toxicity/ deficiency causes such features?",
    "choices": [
      {
        "id": 1,
        "text": "Selenium"
      },
      {
        "id": 2,
        "text": "Zinc"
      },
      {
        "id": 3,
        "text": "Manganese"
      },
      {
        "id": 4,
        "text": "Magnesium"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Manganese</strong> toxicity can cause\u00a0<strong>secondary parkinsonism\u00a0</strong>with features similar to atypical parkinsonism.</p>\n<div class=\"page\" title=\"Page 3430\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Secondary parkinsonism</strong> is characterized by Parkinson-like disease caused by agents/factors that cause <strong>basal ganglia dysfunction</strong>. These factors include drugs (tetrabenazine, metoclopramide, neuroleptics, flunarizine), stroke, tumor, infection, or toxins.\u00a0Clinical features will be based on the region of the basal ganglia that has been damaged.</p>\n<p>Toxins such as carbon monoxide or manganese produce<strong>\u00a0damage to the globus pallidus</strong>, and hence present with features resembling<strong>\u00a0atypical parkinsonism\u00a0</strong>such as:</p>\n</div>\n</div>\n</div>\n<ul>\n<li>Early speech and gait impairment</li>\n<li>Repeated early falls</li>\n<li><strong>Absence of rest tremor</strong></li>\n<li><strong>No motor asymmetry</strong></li>\n<li><strong>Poor or no response to levodopa</strong></li>\n<li>Aggressive clinical course</li>\n<li>Symptoms of severe early autonomic involvement</li>\n</ul>\n<div class=\"page\" title=\"Page 3430\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Manganese</strong>\u00a0deficiency on the other hand can result in poor growth,\u00a0bone demineralization, ataxia, convulsions, and abnormalities in carbohydrate and lipid metabolism.</p>\n<p>Other options</p>\n</div>\n</div>\n</div>\n<p>Option A:<strong> Selenium deficiency</strong> causes <strong>Keshan disease</strong> (cardiomyopathy in endemic regions of China); Excess selenium intake leads to <strong>selenosis\u00a0</strong>(with hair loss, brittle nails, garlic breath odor, myopathy, and neurologic symptoms).</p>\n<p>Option B: <strong>Zinc toxicity</strong> leads to nausea, vomiting, headache, fever, and hypersalivation. <strong>Zinc deficiency</strong> causes dwarfism, hypogonadism, hypopigmented hair, hypogeusia, and impaired immunity.</p>\n<p>Option D: <strong>Hypomagnesemia</strong> is characterized by neurologic symptoms like tremors, muscle weakness, ataxia, delirium, and psychosis. <strong>Hypermagnesemia</strong> causes lethargy, weakness, hypotonia, weak tendon reflexes, and coma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following can present with circumduction gait except",
    "choices": [
      {
        "id": 1,
        "text": "Hip flexor weakness"
      },
      {
        "id": 2,
        "text": "Leg length discrepancy"
      },
      {
        "id": 3,
        "text": "Ankle dorsiflexion weakness"
      },
      {
        "id": 4,
        "text": "Hip adductors spasticity"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Hip adductors spasticity</strong> can not present with circumduction gait. It typically causes the leg to pull inward, leading to a <strong>scissor gait</strong> rather than circumduction.</p>\n<p>Option A:<strong> Hip flexor weakness</strong>: Causes difficulty in advancing the leg during the swing phase, leading to <strong>circumduction to clear the foot</strong>.</p>\n<p>Option B:<strong> Leg length discrepancy</strong>: The longer leg may require circumduction <strong>to prevent the foot from dragging</strong> on the ground.</p>\n<p>Option C: <strong>Ankle dorsiflexion weakness</strong>: Leads to foot drop, which often results in circumduction to <strong>avoid the foot dragging</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following can be associated with focal ataxia?",
    "choices": [
      {
        "id": 1,
        "text": "Phenytoin"
      },
      {
        "id": 2,
        "text": "Thiamine deficiency"
      },
      {
        "id": 3,
        "text": "Hyponatremia"
      },
      {
        "id": 4,
        "text": "Cerebellar haemorrhage"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Cerebellar haemorrhage can cause <strong>focal ataxia</strong>.</p>\n<p>Focal ataxia is often caused by cerebrovascular disease, most commonly due to <strong>ischemic stroke or cerebellar hemorrhage</strong>. These lesions generally result in cerebellar symptoms on the <strong>same side</strong> as the affected area.</p>\n<p>All the mentioned causes result in symmetrical ataxia</p>\n<p><strong>Drugs:</strong></p>\n<ul>\n<li>Phenytoin</li>\n<li>Lithium</li>\n<li>Barbiturates</li>\n<li>Fluorouracil</li>\n<li>Paclitaxel</li>\n</ul>\n<p><strong>Postinfectious syndrome:</strong></p>\n<ul>\n<li>Varicella</li>\n<li>Poliovirus</li>\n<li>Coxsackievirus</li>\n<li>Echovirus</li>\n<li>Epstein-Barr virus</li>\n<li>Toxoplasmosis</li>\n<li>Legionella</li>\n<li>Lyme disease</li>\n</ul>\n<p><strong>Malnutrition/Deficency:</strong></p>\n<ul>\n<li>Vitamin B1 (thiamine)</li>\n<li>Vitamin B12 (cobalamine)</li>\n</ul>\n<p><strong>Intoxification/exposure:</strong></p>\n<ul>\n<li>Alcohol\u00a0</li>\n<li>Toluene exposure</li>\n<li>Gasoline sniffing</li>\n<li>Glue sniffing, spray painting</li>\n<li>Methyl mercury</li>\n<li>Bismuth</li>\n</ul>\n<p><strong>Others:</strong></p>\n<ul>\n<li>Paraneoplastic syndromes</li>\n<li>Hyponatremia</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient walks with a stomping gait. When asked to close his eyes and walk, he is unable to do so. Which of the following tracts is probably affected?",
    "choices": [
      {
        "id": 1,
        "text": "Spinocerebellar tract"
      },
      {
        "id": 2,
        "text": "Posterior column tract"
      },
      {
        "id": 3,
        "text": "Vestibulospinal tract"
      },
      {
        "id": 4,
        "text": "Rubrospinal tract"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given symptoms and test indicates the involvement of the<strong> posterior column. </strong></p>\n<p>As our feet touch the ground, we receive proprioceptive information to tell us their location. The <strong>stomping gait</strong> occurs when there is a loss of this proprioceptive input. In an effort to know when the feet land and their location, the patient will slam the foot hard onto the ground in order to sense it. A key to this gait involves its exacerbation when patients cannot see their feet (i.e. in the dark). The patients may lift their legs very high to hit the ground hard.</p>\n<p>It is seen in conditions where the <strong>posterior column</strong> or <strong>proprioception</strong> is affected like vitamin B12 deficiency and diabetic neuropathy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the incorrect action about the structure marked with '?' in the following clinical and cadaveric images.",
    "choices": [
      {
        "id": 1,
        "text": "It enhances the economy of bipedal locomotion"
      },
      {
        "id": 2,
        "text": "It is active during the swing phase of gait"
      },
      {
        "id": 3,
        "text": "It is active during the stance phase of gait"
      },
      {
        "id": 4,
        "text": "It helps to effect eversion of the foot"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The '?' marked structure in the clinical and cadaveric image is <strong>peroneus tertius</strong>.\u00a0It is<strong> not</strong> active during the <strong>stance</strong> phase of gait.</p>\n<p><strong>Peroneus tertius/ Fibularis tertius:</strong></p>\n<p>It is a part of the\u00a0<strong>anterior compartment </strong>of the leg.</p>\n<p><strong>Attachments:</strong> It often appears to be part of the extensor digitorum longus and might be described as its<strong> \u2018fifth tendon\u2019</strong>. Its fibers <strong>arise</strong> from the distal third or more of the medial surface of the <strong>fibula</strong>, the adjoining anterior surface of the interosseous membrane, and the anterior intermuscular septum. It is<strong> inserted</strong> onto the medial part of the dorsal surface of the <strong>base of the fifth metatarsal</strong>; a thin expansion usually extends forwards along the medial border of the shaft of the bone.</p>\n<p><strong>Relations:</strong> It lies lateral to the extensor digitorum longus.</p>\n<p><strong>Innervation: </strong>It<strong>\u00a0</strong>is innervated by the <strong>deep fibular nerve, L5, S1.</strong></p>\n<p><strong>Actions:</strong>\u00a0During the <strong>swing phase</strong> of gait, it acts with extensor digitorum longus and tibialis anterior to produce <strong>dorsiflexion</strong> of the foot, and with fibularis longus and fibularis brevis to effect <strong>eversion</strong> of the foot. This helps in improving efficiency and enhances the economy of <strong>bipedal locomotion.</strong> It is not active during the <strong>stance</strong> phase.</p>\n<p><strong>Testing:</strong>\u00a0It cannot be tested in isolation, but its tendon can sometimes be seen and felt when the foot is dorsiflexed against resistance (as shown in the above image).</p>\n<p>The animations below show a <strong>superior </strong>and\u00a0<strong>inferior view</strong> of the peroneus muscles. The muscle marked with <strong>blue</strong> is the peroneus<strong> longus</strong>, <strong>red</strong> is the peroneus<strong> brevis</strong>, and<strong>\u00a0green</strong> is the peroneus <strong>tertius.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b5605e8e33144e398d40a0e38f48e387.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c25e984485554c03bff6f2a4b93b2650x600x600.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8f0ee63599e74762be3242da4066b730x600x600.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9114df80105247c9b79bc5c25dd76a47x960x720.PNG"
    ]
  },
  {
    "text": "Match the following gaits with the respective disorders in which they are typically seen.",
    "choices": [
      {
        "id": 1,
        "text": "1-C, 2-D, 3-B, 4-A"
      },
      {
        "id": 2,
        "text": "1-D, 2-A, 3-B, 4-C"
      },
      {
        "id": 3,
        "text": "1-D, 2-C, 3-B, 4-A"
      },
      {
        "id": 4,
        "text": "1-B, 2-C, 3-D, 4-A"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The correct match is:</p>\n<ol>\n<li>Circumduction gait -\u00a0Hemiplegia</li>\n<li>Trendelenburg gait -\u00a0Gluteus medius paralysis</li>\n<li>Quadriceps gait -\u00a0Polio</li>\n<li>High-stepping gait -\u00a0Sciatic Nerve Injury\u00a0</li>\n</ol>\n<p><strong>High-stepping gait</strong> is a gait abnormality seen with foot drop due to injury to<strong>\u00a0</strong>the<strong> sciatic nerve.\u00a0</strong>A high stepping gait helps to clear the dropped foot off the ground while walking due to problems with dorsiflexion. Temporary measures to relieve the foot drop involve <strong>physiotherapy</strong> and <strong>toe raising spring</strong>. <strong>Posterior tibialis transfer</strong> is indicated in <strong>complete foot drop</strong>.</p>\n<p><strong>Circumduction gait</strong> is typically seen in <strong>hemiplegia</strong> or a <strong>spastic hip</strong>. The limb moves without flexion at the knee or ankle. The patient tries to clear the ground by circumducting the whole limb.</p>\n<p><strong>Trendelenburg gait</strong> is seen with the\u00a0<strong>failure</strong> of the <strong>hip abduction</strong>, as seen in congenital or traumatic dislocation of the hip, non-union of fractures of the neck of the femur, or\u00a0gluteus medius paralysis. In order to prevent falling, the <strong>torso</strong> <strong>tilts</strong> to the <strong>affected</strong> side, which is seen as a <strong>pelvis drop</strong> on the <strong>opposite </strong>side, and the body <strong>sways</strong> from side to side.</p>\n<p><strong>Quadriceps gait</strong> is a gait abnormality seen in <strong>polio</strong> due to <strong>quadriceps weakness</strong> and flexion deformity. The patient <strong>limps</strong> with one <strong>hand on the knee</strong> to prevent the loss of balance from buckling of the knee.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old female child with polyneuropathy, sensorineural deafness, and cerebellar ataxia has the following finding on fundus examination. Lab reveals increased blood levels of phytanic acid. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Refsum's disease"
      },
      {
        "id": 2,
        "text": "Usher syndrome"
      },
      {
        "id": 3,
        "text": "Zellweger syndrome"
      },
      {
        "id": 4,
        "text": "Adrenoleukodystrophy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows fundoscopy findings of <strong>retinitis pigmentosa</strong>. This along with the given clinical scenario is suggestive of <strong>Refsum\u2019s disease.\u00a0</strong></p>\n<p>Refsum's disease is a rare autosomal recessive disorder that results from the <strong>defect</strong> in <strong>alpha oxidation</strong> of fatty acids such as phytanic acid in the <strong>peroxisome</strong> leading to <strong>elevated levels</strong> of<strong> phytanic acid</strong> in the blood.\u00a0</p>\n<p>In this condition, the enzyme <strong>phytanoyl CoA hydroxylase</strong> is defective and causes the accumulation of phytanic acid. Clinically, patients present with dysmorphic facies and\u00a0<strong>severe neurological symptoms </strong>such as\u00a0polyneuropathy, retinitis pigmentosa, nerve deafness, ichthyosis, and cerebellar ataxia. Regression of symptoms is observed with <strong>restricted dietary intake</strong> of phytanic acid. Therefore, management includes avoiding sources of phytanic acid such as dairy products, meat, nuts, and green leafy vegetables.</p>\n<p>Note: The <strong>Zellweger spectrum</strong> is a continuum of diseases of persoxisome defects with Zellweger syndrome (most severe) at one end, neonatal adrenoleukodystrophy in the middle (intermediate severity) and infantile Refsum's disease (least severe) at the other end.</p>\n<p>Option B-\u00a0<strong>Usher syndrome</strong>\u00a0is characterized by <strong>sensorineural deafness </strong>and<strong> retinitis pigmentosa</strong> (but symptoms are not affected by restricting phytanic acid)</p>\n<p>Option C-\u00a0<strong>Zellweger Syndrome</strong> is also known as <strong>cerebrohepatorenal syndrome.</strong> It is caused by mutations in the\u00a0PEX/Peroxin<strong>\u00a0</strong>family of genes involved in peroxisome biogenesis /peroxisomal enzymes.\u00a0There is severe neurologic symptoms and patients usually die in the 1st year of life.</p>\n<p>Option D-\u00a0<strong>Adrenoleukodystrophy</strong>\u00a0is a\u00a0<strong>disorder</strong> of <strong>\u03b2-oxidation</strong> of fatty acids. There is a very large chain fatty acids buildup in the <strong>adrenal glands</strong>, the <strong>white matter</strong> of the brain, and <strong>testes</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7da552f5916f4124a97bb1856ae86a20.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient complains of difficulty in maintaining balance while walking at night for the past 2 months. On examination, he has spastic weakness in both lower limbs, a positive Babinski sign, and an absent ankle jerk. Laboratory results are given below. Which of the following is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ischemic stroke"
      },
      {
        "id": 2,
        "text": "Syringomyelia"
      },
      {
        "id": 3,
        "text": "Tabes dorsalis"
      },
      {
        "id": 4,
        "text": "Subacute combined degeneration of cord"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario of <strong>sensory ataxia</strong> (patient is unable to maintain balance without visual input), <strong>UMN signs</strong> (<strong>spasticity</strong> and <strong>positive Babinski</strong> sign), and <strong>absence</strong> <strong>of ankle jerk</strong> due to peripheral neuropathy point to a diagnosis of <strong>subacute combined degeneration of cord (SACD)</strong>. Note that <strong>neurological symptoms</strong> of vitamin B12 deficiency <strong>can occur without</strong> <strong>anemia</strong> and <strong>macrocytosis</strong>.</p>\n<p><strong>SACD</strong> is a <strong>degeneration of</strong> the <strong>dorsal</strong> <strong>and</strong> <strong>lateral</strong> <strong>columns</strong> of the spinal cord, which occurs as a result of <strong>vitamin B12 deficiency</strong>. Patients present with sensory ataxia (involvement of the dorsal column) and UMN type of motor symptoms such as spasticity and positive Babinski sign (involvement of corticospinal tract). Because of coexisting peripheral neuropathy, deep tendon reflexes can be absent. Some patients also develop cortical defects such as dementia.</p>\n<p>The <strong>treatment</strong> of vitamin B12 deficiency when the patient has neurological symptoms is with <strong>cyanocobalamine 1000 mcg</strong> given <strong>intramuscularly</strong>, first daily for 1 week \u2192 then weekly for 1 month \u2192 then monthly for the rest of the patient's life.</p>\n<p>Other options:</p>\n<p>Option A: Although UMN type of motor symptoms are seen in ischemic stroke as well, they are unilateral. Furthermore, stroke is an acute onset clinical syndrome, while this patient has had these complaints for the past 2 months.</p>\n<p>Option B: Patients with <strong>syringomyelia</strong> present with <strong>weakness in arms</strong> more than legs and <strong>loss of pain and temperature</strong> sensation over the shoulders, upper back, and nape of the neck (<strong>cape-like distribution</strong>).<strong> Fine touch</strong>, <strong>vibration</strong>, and <strong>joint position</strong> sense remain <strong>preserved</strong>.</p>\n<p>Option C: <strong>Tabes dorsalis </strong>primarily affects the <strong>dorsal columns,</strong> leading to <strong>sensory ataxia</strong> and absent reflexes, it does not cause spasticity or a positive Babinski sign, as it spares the corticospinal tracts.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old boy presents with dizziness, unsteadiness and difficulty walking since the past few hours. On examination, the child has ataxia, wide-based gait, decreased responsiveness and peri oral rash. His father reports that he has been behaving strangely and was caught bunking school. What is the most likely cause of the child's symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Friedrich's ataxia"
      },
      {
        "id": 2,
        "text": "Toluene intoxication"
      },
      {
        "id": 3,
        "text": "Post infectious cerebellitis"
      },
      {
        "id": 4,
        "text": "Ataxia telangiectasia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This is a scenario of <strong>toluene inhalation</strong> <strong>intoxication</strong> presenting <strong>acutely</strong> with neurologic symptoms and signs of <strong>symmetric ataxia</strong>, <strong>wide based gait</strong> and <strong>peri oral rash</strong> (<strong>glue sniffer's rash</strong>).</p>\n<p><strong>Inhalants</strong> are compounds like <strong>butane, propane, freons and toluene</strong>. These are present in household items like <strong>glue</strong>, <strong>paint thinners</strong>, <strong>whiteners</strong> and <strong>hairsprays</strong>. These compounds are easily available, thus they're easy to abuse.</p>\n<p>Inhalant intoxication presents with symptoms like <strong>euphoria, agitation, anxiety</strong> and <strong>decreased responsiveness</strong>. The effects last for a <strong>few hours</strong> after the inhalation. Inhalant use can also acutely cause <strong>symmetric ataxia</strong>, and long term use is also associated with <strong>local</strong> <strong>perioral dermatitis</strong> known as \"<strong>glue sniffer's rash</strong>\".</p>\n<p>Inhalant intoxication can be harmful as <strong>repeated inhalation</strong> can lead to <strong>hypoxia</strong>, <strong>coma</strong> and long term use has been associated with <strong>delirium</strong> and <strong>dementia</strong>.</p>\n<p>Use of intoxicants or drugs must be elicited in patient visits to determine early symptoms of mental disorders and functional impairment in pediatric populations. This can be done through a <strong>HEADSSS assessment</strong> (<strong>Home, Education, Activities, Drugs, Sexuality, Suicide/Depression, Safety).</strong></p>\n<p>Other toxic causes of ataxia include alcohol, lithium, phenytoin, barbiturates, mercury, gasoline and glue inhalation.</p>\n<p>Other options :\u00a0<br /><br />Option A : <strong>Friedrich's ataxia</strong> would present as <strong>chronic ataxia</strong>, and not acutely as in this patient. Friedreich's ataxia is the <strong>most</strong> <strong>common form of inherited ataxia</strong>. It is an <strong>autosomal recessive</strong> disorder generally occurring in individuals less than 25 years of age. It is caused by the <strong>expansion of a GAA trinucleotide repeat</strong> in the first intron of a gene on chromosome <strong>9q13</strong> that encodes <strong>frataxin</strong>. Patients present with clinical features of <strong>dysarthria</strong>, <strong>progressive staggering gait, frequent falls, nystagmus, and titubation</strong> (nodding head and body movements).</p>\n<p>Option C : <strong>Postinfectious cerebellitis</strong> is a <strong>reversible cerebellar ataxia</strong> and a rare acute or subacute complication of <strong>varicella zoster </strong>infection.</p>\n<p>Option D : <strong>Ataxia telangiectasia</strong> is a rare inherited cause of ataxia. Patients present in the first decade of life with <strong>progressive</strong> <strong>telangiectatic lesions</strong> associated with <strong>deficits in cerebellar function and nystagmus</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Gait Abnormalities Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2024-25"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>