<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15 Diabetes Mellitus-Ii - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">19</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>A 22-year-old female with newly diagnosed Type 1 Diabetes Mellitus is struggling to maintain postprandial glucose levels despite basal-bolus insulin therapy. Her endocrinologist decides to add an adjunctive medication approved for both type 1 and type 2 diabetes mellitus. Which of the following drugs fits this indication?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Empagliflozin"
      },
      {
        "id": 2,
        "text": "Linagliptin"
      },
      {
        "id": 3,
        "text": "Pramlintide"
      },
      {
        "id": 4,
        "text": "Semaglutide"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct answer is option C: Pramlintide</strong></p>\n\n<ul>\n\t<li>\n\t<p><strong>Pramlintide</strong> is an <span class=\"customMeta\" data-dictid=\"57fb8c52881692777181db5ce5dba0\">amylin</span> analog, approved for use in both <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">type 1</span> and <span class=\"customMeta\" data-dictid=\"05e8c1df0d1692777201c9acee8b1f\">type 2</span> diabetes mellitus, in patients already on insulin.</p>\n\t</li>\n\t<li>\n\t<p>It slows <span class=\"customMeta\" data-dictid=\"12347b15191692777188bc86d226e1\">gastric</span> emptying, suppresses <span class=\"customMeta\" data-dictid=\"5e98c7ac6916927771967b424f152e\">postprandial</span> glucagon, and promotes satiety, helping improve <span class=\"customMeta\" data-dictid=\"5e98c7ac6916927771967b424f152e\">postprandial</span> <span class=\"customMeta\" data-dictid=\"af3ae60c0c16927771889b84ca41c0\">glucose</span> control.</p>\n\t</li>\n\t<li>\n\t<p>Empagliflozin (SGLT2 inhibitor) is used only in <span class=\"customMeta\" data-dictid=\"05e8c1df0d1692777201c9acee8b1f\">type 2</span> DM, not <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">type 1</span> due to DKA risk. Linagliptin is a DPP-4 i\u00a0</p>\n\t</li>\n\t<li>\n\t<p>Semagutide is not approved for use in <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">type 1</span> DM as it needs some <span class=\"customMeta\" data-dictid=\"806eb8418c16927771822855b56695\">beta</span> cell reserve to be able to produce <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> by <span class=\"customMeta\" data-dictid=\"148de0e6a61692777190372a1432f0\">incretin</span> effect\u00a0</p>\n\t</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/5fkT7H2faFmBTVWdBd0i1753558976.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/MPWNgp0ZGdPkzQMzKLjY1753559271.mp3"
  },
  {
    "text": "<p>A 65-year-old woman with poorly controlled diabetes mellitus presents to the emergency department with fever, facial pain, and a black necrotic eschar on her nasal turbinates. A CT scan shows sinus involvement and extension to the brain. What is the most appropriate initial management for this patient?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Fluconazole"
      },
      {
        "id": 2,
        "text": "Immediate surgical debridement and intravenous amphotericin B"
      },
      {
        "id": 3,
        "text": "Doxycyline and Azithromycin"
      },
      {
        "id": 4,
        "text": "Piperacillin Tazobactum"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Answer is Option B:\u00a0Immediate <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> debridement and <span class=\"customMeta\" data-dictid=\"27b78a96071692777190f4dfb93430\">intravenous</span> amphotericin B</strong></p>\n\n<ul>\n\t<li>In cases of rhino-cerebral mucormycosis, especially with signs of significant tissue <span class=\"customMeta\" data-dictid=\"5e84a7987c16927771931012aced83\">necrosis</span> and possible central nervous system involvement, immediate <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> debridement is essential to remove necrotic tissue and control the infection.</li>\n\t<li>Intravenous amphotericin B is the first-line <span class=\"customMeta\" data-dictid=\"c929a2b71516927771812a8b7b7ec3\">antifungal</span> treatment that targets the <span class=\"customMeta\" data-dictid=\"f616aee08b169277718361438e1a91\">causative</span> organisms, significantly improving the patient's chances of survival.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Infections in Diabetes Mellitus</strong></p>\n\n<ul>\n\t<li>Diabetes mellitus (DM) increases <span class=\"customMeta\" data-dictid=\"6ced8252211692777199ab0cc3f2bb\">susceptibility</span> to <span class=\"customMeta\" data-dictid=\"5204097a961692777194904909b6fe\">opportunistic</span> infections.</li>\n\t<li>Focused infections:\n\t<ul>\n\t\t<li>Rhino-cerebral <span class=\"customMeta\" data-dictid=\"2bde1f4f961692777193e2d85cb0e8\">mucormycosis</span> (RCM)</li>\n\t\t<li>Acute emphysematous cholecystitis</li>\n\t\t<li>Pyelonephritis</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>Rhino-Cerebral <span class=\"customMeta\" data-dictid=\"2bde1f4f961692777193e2d85cb0e8\">Mucormycosis</span> (RCM)</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:614px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Aspect</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Details</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Overview</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Severe fungal infection affecting <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> passages, sinuses, and brain.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Causative Agent</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Primarily caused by <em>Rhizopus oryzae</em>, associated with uncontrolled DM and <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"27b295ed331692777190e5e04eaa18\">ketoacidosis</span> (DKA).</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Pathophysiology</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Begins in <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> turbinates; progresses rapidly due to <span class=\"customMeta\" data-dictid=\"c5ef9f5e371692777181b43f888174\">angioinvasive</span> nature, causing tissue <span class=\"customMeta\" data-dictid=\"5e84a7987c16927771931012aced83\">necrosis</span> and <span class=\"customMeta\" data-dictid=\"526ede3fee169277720184378acc5e\">vascular</span> thrombosis.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Clinical Manifestations</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Fever, <span class=\"customMeta\" data-dictid=\"9fdd7489051692777202cffe3f24cc\">facial</span> pain, swelling, <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> discharge, necrotic eschar.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Diagnosis</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Imaging studies and histopathological examination.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Treatment</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Immediate <span class=\"customMeta\" data-dictid=\"c929a2b71516927771812a8b7b7ec3\">antifungal</span> therapy (e.g., amphotericin B) and aggressive <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> debridement.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/02DIsGrlUFHbdRozejf11753559745.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/AtoZfiYJIFtfTnSK2JRw1753810551.mp3"
  },
  {
    "text": "<p>A 55-year-old woman with a 10-year history of type 2 diabetes presents for a routine eye examination with compliants of visual loss. On examination, she is found to have microaneurysms, retinal haemorrhages, cotton wool spots and macular edema. What is the most effective management option for her symptomatic foveal oedema?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Pan-retinal laser photocoagulation"
      },
      {
        "id": 2,
        "text": "Intravitreal anti-VEGF injections"
      },
      {
        "id": 3,
        "text": "Corticosteroid injections"
      },
      {
        "id": 4,
        "text": "Routine observation and follow-up"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct answer is B:\u00a0Intravitreal anti-VEGF injections</strong></p>\n\n<ul>\n\t<li>The patient likely has <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"ebad8eb48c1692777191b5de5d04a1\">macular</span> oedema, a <span class=\"customMeta\" data-dictid=\"8a6b09beac1692777184b08a2b5766\">complication</span> of <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"60029fa8cd169277719733357ef47e\">retinopathy</span> characterized by <span class=\"customMeta\" data-dictid=\"fb7a2c30e416927771972f7df6f8c0\">retinal</span> thickening and fluid accumulation in the macula. This condition can lead to visual <span class=\"customMeta\" data-dictid=\"4885d5d0021692777189aac6dc80f7\">impairment</span> and requires prompt treatment to preserve vision.</li>\n\t<li>Anti-VEGF therapy has been shown to be more effective than laser treatment for <span class=\"customMeta\" data-dictid=\"509310d4411692777199f2ffdb7769\">symptomatic</span> foveal oedema in <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"ebad8eb48c1692777191b5de5d04a1\">macular</span> oedema.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Diabetic Retinopathy</strong></p>\n\n<ul>\n\t<li>Severity increases with the duration of diabetes.\u00a0</li>\n\t<li>Ischemia-induced VEGF production and <span class=\"customMeta\" data-dictid=\"89e3252d5b16927771833fb9b432ae\">capillary</span> dropout may originate from or involve the area around the inner nuclear layer (especially the deep <span class=\"customMeta\" data-dictid=\"89e3252d5b16927771833fb9b432ae\">capillary</span> plexus)</li>\n\t<li>The actual <span class=\"customMeta\" data-dictid=\"8eedb6cec61692777196a6a3b93d3f\">proliferation</span> of new vessels (neovascularization) that we clinically detect in PDR happens on the surface of the <span class=\"customMeta\" data-dictid=\"f17d8978bd1692777197621051012f\">retina</span> \u2014 at the inner limiting <span class=\"customMeta\" data-dictid=\"34cd707428169277719272942b7905\">membrane</span> (ILM) and into the vitreous.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Management:</strong></p>\n\n<ul>\n\t<li><strong>Proliferative <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">Diabetic</span> Retinopathy</strong>:\n\n\t<ul>\n\t\t<li>Untreated can lead to <span class=\"customMeta\" data-dictid=\"636ccb4336169277720289af6a0778\">vitreous</span> haemorrhage and <span class=\"customMeta\" data-dictid=\"fb7a2c30e416927771972f7df6f8c0\">retinal</span> detachment.</li>\n\t\t<li><strong>Pan-retinal Laser Photocoagulation</strong>: Preserves vision if applied early.</li>\n\t</ul>\n\t</li>\n\t<li><strong>Diabetic <span class=\"customMeta\" data-dictid=\"ebad8eb48c1692777191b5de5d04a1\">Macular</span> Oedema</strong>:\n\t<ul>\n\t\t<li>Intravitreal <span class=\"customMeta\" data-dictid=\"3509997646169277719014053aa74d\">injection</span> therapy is now preferred\u00a0</li>\n\t\t<li>Anti-VEGF injections are more effective than laser treatment, often requiring monthly injections.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Pan-retinal laser <span class=\"customMeta\" data-dictid=\"10cb4498ea1692777195b60ee356a3\">photocoagulation</span> (Option A)</strong>: While effective for proliferative <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> retinopathy, it is not the first-line treatment for <span class=\"customMeta\" data-dictid=\"509310d4411692777199f2ffdb7769\">symptomatic</span> foveal oedema.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Corticosteroid injections (Option C)</strong>: While they may have some benefit, anti-VEGF injections are typically preferred in current clinical practice for treating <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"ebad8eb48c1692777191b5de5d04a1\">macular</span> oedema.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Routine observation and follow-up (Option D)</strong>: This option is not appropriate for <span class=\"customMeta\" data-dictid=\"509310d4411692777199f2ffdb7769\">symptomatic</span> foveal oedema, as timely intervention is necessary to prevent vision loss.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/PFpricLZwdsTFksx6fBD1753560085.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/wS3WSfx3pdWDsUDIOHAq1753561242.mp3"
  },
  {
    "text": "<p>Best screening test for evaluation of diabetic nephropathy is\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "HbA1c"
      },
      {
        "id": 2,
        "text": "BUN: Creatinine ratio"
      },
      {
        "id": 3,
        "text": "Creatinine clearance"
      },
      {
        "id": 4,
        "text": "Urinary protein to creatinine ratio"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Answer is D:\u00a0</strong>Urinary protein to <span class=\"customMeta\" data-dictid=\"2ead0fd0301692777185187bd72768\">creatinine</span> ratio</p>\n\n<p><strong>Serum <span class=\"customMeta\" data-dictid=\"2ead0fd0301692777185187bd72768\">creatinine</span> and <span class=\"customMeta\" data-dictid=\"2ead0fd0301692777185187bd72768\">creatinine</span> <span class=\"customMeta\" data-dictid=\"3a3fb1b8a816927771840e6a344cc0\">clearance</span> rise only after significant <span class=\"customMeta\" data-dictid=\"32562f5afa1692777193c891837db9\">nephron</span> loss (\u226550%)</strong>, so they miss <strong>early <span class=\"customMeta\" data-dictid=\"4aa6035df41692777190b41d4a1583\">kidney</span> damage</strong> like microalbuminuria.<br />\nThey are <strong>late markers</strong> and poor indicators for <strong>early <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"b06dd1c5181692777193f14f3ed7d7\">nephropathy</span> screening</strong>.</p>\n\n<p>Diabetic <span class=\"customMeta\" data-dictid=\"b06dd1c5181692777193f14f3ed7d7\">nephropathy</span> begins with <span class=\"customMeta\" data-dictid=\"b7fa8406071692777192aecab2b359\">microalbuminuria</span> (30\u2013300 mg/day). uPCR can detect even small increases in <span class=\"customMeta\" data-dictid=\"1fa594dc2b169277718104d76aa4e2\">albumin</span> accurately.</p>\n\n<p>Most important is that it is a<strong> <span class=\"customMeta\" data-dictid=\"ef5cb829b8169277719603304e73cb\">quantitative</span> test </strong>and not <span class=\"customMeta\" data-dictid=\"1304db17d3169277719684a316a8c4\">qualitative</span> test. By using <span class=\"customMeta\" data-dictid=\"2ead0fd0301692777185187bd72768\">creatinine</span> as a reference, uPCR corrects for variations in <span class=\"customMeta\" data-dictid=\"0096f2a7631692777201eb9f21d5a7\">urine</span> concentration.</p>\n\n<p>It r<strong>equires only a random spot <span class=\"customMeta\" data-dictid=\"0096f2a7631692777201eb9f21d5a7\">urine</span> sample,</strong> not cumbersome 24-hour <span class=\"customMeta\" data-dictid=\"0096f2a7631692777201eb9f21d5a7\">urine</span> collection. Improves patient compliance.\u00a0</p>\n\n<p>More <strong>consistent and less expensive</strong> than repeated 24h <span class=\"customMeta\" data-dictid=\"0096f2a7631692777201eb9f21d5a7\">urine</span> collections. Useful for <strong>routine <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> follow-up</strong></p>\n\n<p>\u00a0</p>\n\n<table>\n</table>\n\n<p>\u00a0</p>\n\n<table>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/ISV20DWKUIFiRGWx4Odl1753650166.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/bMjFpYwvKfPLUiUESle61753650250.mp3"
  },
  {
    "text": "<p>All of the following are correct about diabetic neuropathy except?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Affects unmyelinated type C fibers"
      },
      {
        "id": 2,
        "text": "Third nerve palsy presents with pupillary involvement"
      },
      {
        "id": 3,
        "text": "Orthostatic hypotension occurs due to involvement of type B fibers"
      },
      {
        "id": 4,
        "text": "Clonidine is used for management of diabetic diarrhea"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Answer is B:\u00a0Third nerve <span class=\"customMeta\" data-dictid=\"f3e67cebd51692777194f5257898e4\">palsy</span> presents with pupillary involvement</strong></p>\n\n<p>Most common <span class=\"customMeta\" data-dictid=\"6b7b5460171692777185e6e2475f8c\">cranial</span> nerve affected in DM is occulomotor nerve with pupillary sparing.\u00a0</p>\n\n<p><strong>Microvascular <span class=\"customMeta\" data-dictid=\"0f670d10711692777190af4b12fac9\">ischemia</span> affects the central core of the nerve where the <span class=\"customMeta\" data-dictid=\"3db910d8571692777198303e3bcb27\">somatic</span> motor fibers are located</strong>. Thus EOM <span class=\"customMeta\" data-dictid=\"f3e67cebd51692777194f5257898e4\">palsy</span> will occur causing <span class=\"customMeta\" data-dictid=\"e18c2053271692777194e62a208e01\">ptosis</span> and eye being down and out.\u00a0</p>\n\n<p>Peripheral <span class=\"customMeta\" data-dictid=\"8f19a37b5916927771941ba9f5ef49\">parasympathetic</span> fibers are spared because they are supplied by pial blood vessels on the nerve\u2019s surface.</p>\n\n<p><strong>Other options\u00a0</strong></p>\n\n<p><strong>A</strong>:\u00a0 <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">Diabetic</span> <span class=\"customMeta\" data-dictid=\"2d9476094c16927771933bcb162f19\">neuropathy</span> affects <span class=\"customMeta\" data-dictid=\"e2488001c816927772014412348125\">unmyelinated</span> type C fibers, causing burning pain and <span class=\"customMeta\" data-dictid=\"bd1c98736616927771820954b0a744\">autonomic</span> symptoms because these fibers are most vulnerable to chronic hyperglycemia-induced <span class=\"customMeta\" data-dictid=\"60d563fe241692777194203742bf5b\">oxidative</span> stress.<br />\n<strong>C</strong>:\u00a0 Orthostatic <span class=\"customMeta\" data-dictid=\"9402185d4b1692777189cb62891ff1\">hypotension</span> arises from damage to lightly <span class=\"customMeta\" data-dictid=\"dd79d3db911692777193c60304ef85\">myelinated</span> type B <span class=\"customMeta\" data-dictid=\"bfcae0fcde1692777196b3a20c4465\">preganglionic</span> fibers, as <span class=\"customMeta\" data-dictid=\"0f670d10711692777190af4b12fac9\">ischemia</span> impairs <span class=\"customMeta\" data-dictid=\"5731c5431416927771999e54e2563b\">sympathetic</span> <span class=\"customMeta\" data-dictid=\"3f0b42b17016927772014c586d44b7\">vasoconstriction</span> needed to maintain BP upon standing.<br />\n<strong>D</strong>:\u00a0 Clonidine, an \u03b12-agonist, helps in <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"aaabe672c51692777186a829ebdc0c\">diarrhea</span> by reducing intestinal secretions through <span class=\"customMeta\" data-dictid=\"f03ca2d2a716927771901227bc175a\">inhibition</span> of <span class=\"customMeta\" data-dictid=\"5731c5431416927771999e54e2563b\">sympathetic</span> outflow to the gut.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/sqw8k8IiocL7pemGtHtp1753649857.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/RZKacZebbbnEgQGFdQ6L1753650083.mp3"
  },
  {
    "text": "<p>Which of the following is not correct about Type 2 diabetes mellitus?\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Polygenic inheritance"
      },
      {
        "id": 2,
        "text": "Increased insulin levels"
      },
      {
        "id": 3,
        "text": "Beta cell exhaustion"
      },
      {
        "id": 4,
        "text": "Increased PPAR-\u03b3 activity"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct answer is D:\u00a0Increased PPAR-\u03b3 activity</strong></p>\n\n<p>Increased PPAR-\u03b3 activity helps treat diabetes and does not cause it.\u00a0\u00a0</p>\n\n<p>Activation of PPAR-\u03b3 improves:</p>\n\n<ol>\n\t<li>\n\t<p>Insulin sensitivity (especially in <span class=\"customMeta\" data-dictid=\"5c2a4a949d16927771802ba54640cc\">adipose</span> and muscle tissue)</p>\n\t</li>\n\t<li>\n\t<p>Glucose <span class=\"customMeta\" data-dictid=\"cc20d2d7111692777201fb0caeb3f2\">uptake</span> via GLUT4</p>\n\t</li>\n\t<li>\n\t<p>Storage of lipids in <span class=\"customMeta\" data-dictid=\"5c2a4a949d16927771802ba54640cc\">adipose</span> tissue</p>\n\t</li>\n</ol>\n\n<p>In <span class=\"customMeta\" data-dictid=\"05e8c1df0d1692777201c9acee8b1f\">Type 2</span> DM in early stages , <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> levels are elevated. In late stage <span class=\"customMeta\" data-dictid=\"806eb8418c16927771822855b56695\">beta</span> cell <span class=\"customMeta\" data-dictid=\"9598f8e9d81692777187d4bdab30ce\">exhaustion</span> occurs causing insulinopenia. That is why in late phase of <span class=\"customMeta\" data-dictid=\"05e8c1df0d1692777201c9acee8b1f\">type 2</span> DM <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> is needed and OHA donot work.\u00a0</p>\n\n<p>Type 2DM has <span class=\"customMeta\" data-dictid=\"5be6ff563616927771963d8ac13f91\">polygenic</span> <span class=\"customMeta\" data-dictid=\"42a1758eae169277719495e655297a\">patten</span> of inheritance\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/VfN7RW9jjqOpxRg4eqjh1753649514.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/jJg6T1RXjDVWNyY6ZVtF1753649653.mp3"
  },
  {
    "text": "<p>Which of the following is correct about mechanism of action of Acarbose?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Increases insulin secretion from pancreatic beta cells"
      },
      {
        "id": 2,
        "text": "Inhibits \u03b1-glucosidase in intestinal brush border"
      },
      {
        "id": 3,
        "text": "Increases glucose uptake in peripheral tissues"
      },
      {
        "id": 4,
        "text": "Enhances insulin sensitivity in peripheral tissues"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Answer is B: Inhibits \u03b1-glucosidase in intestinal <span class=\"customMeta\" data-dictid=\"da5d70d6c016927771839e073ce917\">brush border</span> </strong></p>\n\n<p>-Acarbose inhibits alpha-glucosidase enzymes in the gut, slowing the <span class=\"customMeta\" data-dictid=\"47d4bcce081692777186a1aafdde1a\">digestion</span> of carbohydrates and reducing post-meal <span class=\"customMeta\" data-dictid=\"af3ae60c0c16927771889b84ca41c0\">glucose</span> spikes.</p>\n\n<p>-It is taken with each meal to reduce post-prandial blood <span class=\"customMeta\" data-dictid=\"af3ae60c0c16927771889b84ca41c0\">glucose</span> and modestly improve <span class=\"customMeta\" data-dictid=\"b5f500def916927771888b49285ac6\">glycemic</span> control.</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/4RZJtjVSu2OKVsXkQCW11753649217.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/nlC4puRZT9XGtRqRXiXr1753649283.mp3"
  },
  {
    "text": "<p>Which of the following is not correct about complications seen in Diabetes mellitus?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Blindness incidence is increased by 25 times"
      },
      {
        "id": 2,
        "text": "Foot gangrene and amputation risk is increased by 100 times"
      },
      {
        "id": 3,
        "text": "Most common site of diabetic foot ulcer is heel"
      },
      {
        "id": 4,
        "text": "Diabetic nephropathy is leading cause of Chronic kidney disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Option is C: Most common site of <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> foot <span class=\"customMeta\" data-dictid=\"7b4370a0b01692777201a5bc0739c2\">ulcer</span> is heel</strong></p>\n\n<p>Diabetic foot <span class=\"customMeta\" data-dictid=\"7b4370a0b01692777201a5bc0739c2\">ulcer</span> is usually seen on toes or <span class=\"customMeta\" data-dictid=\"b7f1b05b6d1692777192a18bc2396f\">metatarsal</span> heads.</p>\n\n<p>Risk of <span class=\"customMeta\" data-dictid=\"cf284485b71692777183c57876bed2\">blindness</span> in diabetics is upto 25 times higher as compared to normal population due to neovascularization. It can lead to <span class=\"customMeta\" data-dictid=\"fb7a2c30e416927771972f7df6f8c0\">retinal</span> <span class=\"customMeta\" data-dictid=\"2b005085881692777186cf95c3ad51\">detachment</span> and <span class=\"customMeta\" data-dictid=\"636ccb4336169277720289af6a0778\">vitreous</span> hemorrhage.\u00a0</p>\n\n<p>Diabetic <span class=\"customMeta\" data-dictid=\"b06dd1c5181692777193f14f3ed7d7\">nephropathy</span> leads to <span class=\"customMeta\" data-dictid=\"89275101301692777186567d1912a0\">diffuse</span> <span class=\"customMeta\" data-dictid=\"9b496e768c1692777188421dbac69f\">glomerulosclerosis</span> that casues progressive decline of eGFR. At values less < 30 ml /min , either Hemodialysis or <span class=\"customMeta\" data-dictid=\"4aa6035df41692777190b41d4a1583\">kidney</span> transplanatation decision making has to be done.\u00a0</p>\n\n<p>Due to combination of <span class=\"customMeta\" data-dictid=\"2d9476094c16927771933bcb162f19\">neuropathy</span> and angiopathy,\u00a0risk of critical limb ischemia, non-healing ulcers, and ultimately digital <span class=\"customMeta\" data-dictid=\"741c89cb18169277718889cfaafa53\">gangrene</span> or limb <span class=\"customMeta\" data-dictid=\"9dfe4d42641692777181673eb73924\">amputation</span> is much higher reaching upto 40-100 x times more than normal population.\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/l4BrGe7HmKyUQNWN2YBE1753648757.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/dhlpcY9lr3oMFXjhA2VO1753649128.mp3"
  },
  {
    "text": "<p>Which of the following is not correct about SGLT2i</p>",
    "choices": [
      {
        "id": 1,
        "text": "Lowering of SBP"
      },
      {
        "id": 2,
        "text": "Used in HFreEF in non diabetic population"
      },
      {
        "id": 3,
        "text": "Cause afferent arteriolar dilatation"
      },
      {
        "id": 4,
        "text": "Increased risk of mycotic genital infections"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct answer is C:\u00a0Cause <span class=\"customMeta\" data-dictid=\"4dd3bdfe1d1692777180deb3103555\">afferent</span> arteriolar dilatation\u00a0</strong></p>\n\n<p>-SGLT2i will cause salt loss in urine. It will increase sodium at <span class=\"customMeta\" data-dictid=\"948746a830169277719140f9f93879\">macula</span> densa and cause <span class=\"customMeta\" data-dictid=\"4dd3bdfe1d1692777180deb3103555\">afferent</span> constriction. This reduces intraglomerular pressure. Thus it reduces <span class=\"customMeta\" data-dictid=\"3c305b384216927771969ca4166493\">progression</span> of <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> nephropathy\u00a0</p>\n\n<p>-Salt loss in <span class=\"customMeta\" data-dictid=\"0096f2a7631692777201eb9f21d5a7\">urine</span> also lowers SBP by 5 mm Hg and explains the <span class=\"customMeta\" data-dictid=\"e2b5f013011692777183ea1b11ed9c\">cardiovascular</span> benefit without causing <span class=\"customMeta\" data-dictid=\"32742bce4316927771941ff62a9db7\">orthostatic</span> hypotension\u00a0</p>\n\n<p>-Increased sugar levels in <span class=\"customMeta\" data-dictid=\"0096f2a7631692777201eb9f21d5a7\">urine</span> explains the risk of <span class=\"customMeta\" data-dictid=\"39f702525516927771939b0791cac7\">mycotic</span> <span class=\"customMeta\" data-dictid=\"0e919a208b16927771885d9c1f6662\">genital</span> infections and UTI.\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/mlAYyybjhFYFxEJGIP2k1753648488.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/G3QwMmBpOtgxYJyrfNb61753648668.mp3"
  },
  {
    "text": "<p>Which of the following is the earliest renal abnormality in diabetic nephropathy?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Microalbuminuria"
      },
      {
        "id": 2,
        "text": "Nodular glomerulosclerosis"
      },
      {
        "id": 3,
        "text": "Increased glomerular filtration rate"
      },
      {
        "id": 4,
        "text": "Proteinuria (>300 mg/day)"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct answer is C: Increased <span class=\"customMeta\" data-dictid=\"1ad1e71a4a1692777188853097f685\">glomerular</span> <span class=\"customMeta\" data-dictid=\"83d76f27051692777202029aee0cd3\">filtration</span> rate\u00a0</strong></p>\n\n<ul>\n\t<li>\n\t<p>The <strong>earliest functional change </strong>in <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"b06dd1c5181692777193f14f3ed7d7\">nephropathy</span> is <span class=\"customMeta\" data-dictid=\"1ad1e71a4a1692777188853097f685\">glomerular</span> hyperfiltration, seen as an increased GFR <strong>due to <span class=\"customMeta\" data-dictid=\"4dd3bdfe1d1692777180deb3103555\">afferent</span> arteriolar dilation\u00a0</strong>resulting from altered <span class=\"customMeta\" data-dictid=\"813dde106b16927772017f0fdd843f\">tubuloglomerular</span> feedback.\u00a0</p>\n\t</li>\n\t<li>\n\t<p>This precedes microalbuminuria, which marks the first clinical stage.</p>\n\t</li>\n\t<li>\n\t<p>Structural changes like Kimmelstiel\u2013Wilson nodules occur much later.</p>\n\t</li>\n</ul>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/Fy9zKSyEQicEC7gBnieY1753648187.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/mlsq1kyk7m4zcv1xFkok1753648341.mp3"
  },
  {
    "text": "<p>50-year-old man with T2DM presents with consistently elevated early morning blood glucose levels. His continous glucose monitoring does not show any noctural hypoglycemia.\u00a0 His current insulin regimen includes twice-daily intermediate-acting insulin. Which of the following is the most likely explanation for his fasting hyperglycaemia?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Excess dose of insulin given the day before"
      },
      {
        "id": 2,
        "text": "Increased insulin sensitivity between 4 am to 8 am"
      },
      {
        "id": 3,
        "text": "Inreased insulin resistance between 4 am to 8 am"
      },
      {
        "id": 4,
        "text": "Beta cell exhausation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Answer is C: Increased <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> resistance between 4 am and 8 am\u00a0</strong></p>\n\n<p>\u00a0</p>\n\n<p>The patient has\u00a0<strong>dawn phenomenon</strong>, where early morning <span class=\"customMeta\" data-dictid=\"c52b35ebb01692777189131c97fbba\">hyperglycemia</span> results from increased <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> resistance between 4 am to 8 am. The <em>lack of preceding <span class=\"customMeta\" data-dictid=\"d51601f2c41692777193ddfa55d163\">nocturnal</span> hypoglycemia</em> rules out somogyi phenomenon.</p>\n\n<p><strong>Somogyi phenomenon</strong>: Hormones involved are catecholamines, cortisol, <span class=\"customMeta\" data-dictid=\"c4d90ebfde1692777188e3689c1753\">glucagon</span> and GH</p>\n\n<p><strong>Dawn phenomenon </strong>: Hormones involved are <span class=\"customMeta\" data-dictid=\"1698cefc83169277718522e3f5fd61\">cortisol</span> and GH</p>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"Somugay and downs phenomena\" data-author=\"NA\" data-hash=\"8477\" data-license=\"NA\" data-source=\"NA\" data-tags=\"April2025\" height=\"497\" src=\"https://image.prepladder.com/notes/A53iKYcUQSecxbHHsw801744283799.png\" width=\"497\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>\n\n<p>\u00a0</p>\n\n<p><strong>Dawn Phenomenon vs Somogyi Phenomenon:</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Feature</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Dawn Phenomenon</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Somogyi Phenomenon</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Definition</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Fasting hyperglycaemia in the early morning due to natural <span class=\"customMeta\" data-dictid=\"6d2d14b32a1692777184597558c86a\">circadian</span> hormone resistance\u00a0</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Rebound <span class=\"customMeta\" data-dictid=\"c52b35ebb01692777189131c97fbba\">hyperglycemia</span> after <span class=\"customMeta\" data-dictid=\"d51601f2c41692777193ddfa55d163\">nocturnal</span> <span class=\"customMeta\" data-dictid=\"78c658d4ed1692777189098c7544b9\">hypoglycemia</span> due to counterregulatory hormone release.\u00a0</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><br />\n\t\t\tHoromones involved\u00a0</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Increased release of growth hormone and <span class=\"customMeta\" data-dictid=\"1698cefc83169277718522e3f5fd61\">cortisol</span> in the late night hours.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Glucagon, catecholamines and <span class=\"customMeta\" data-dictid=\"1698cefc83169277718522e3f5fd61\">cortisol</span> due to body's response to late-night hypoglycaemia.\u00a0</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Timing</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Happens between 4 am to 8 am\u00a0 due to <span class=\"customMeta\" data-dictid=\"6d2d14b32a1692777184597558c86a\">circadian</span> rhythms and insufficient insulin.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Occurs after midnight, following hypoglycaemia, leading to elevated morning blood <span class=\"customMeta\" data-dictid=\"af3ae60c0c16927771889b84ca41c0\">glucose</span> levels.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p><strong>Clinical Relevance</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Requires adjusting <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> doses and timing to prevent early morning hyperglycemia.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Early morning <span class=\"customMeta\" data-dictid=\"c52b35ebb01692777189131c97fbba\">hyperglycemia</span> was once thought to be due to prior hypoglycaemia, but new research questions this theory.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/A53iKYcUQSecxbHHsw801744283799.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/2EtGqq7TlqmLoNXIRrpu1753554907.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/zTKIwViDz5KZpUHNiD0c1753555005.mp3"
  },
  {
    "text": "<p>Which of the following drugs slows the progression of diabetic nephropathy and is an aldosterone antagonist?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Finrenone"
      },
      {
        "id": 2,
        "text": "Empagliflozin"
      },
      {
        "id": 3,
        "text": "Linagliptin"
      },
      {
        "id": 4,
        "text": "ACEi"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Answer is A : Finrenone\u00a0</strong></p>\n\n<p><strong>Drugs that slow the <span class=\"customMeta\" data-dictid=\"3c305b384216927771969ca4166493\">progression</span> of CKD in <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> nephropathy\u00a0</strong></p>\n\n<ol>\n\t<li>ACEi or ARB\u00a0</li>\n\t<li>Finrenone\u00a0</li>\n\t<li>SGLT2i - Empagliflozin</li>\n\t<li>GLP1RA</li>\n</ol>\n\n<p><strong>Drugs to avoid in <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> nephropathy\u00a0</strong></p>\n\n<ol>\n\t<li>NSAIDS</li>\n\t<li>Metformin\u00a0</li>\n\t<li>Dual RAAS <span class=\"customMeta\" data-dictid=\"70d039f1401692777183bb2f23a21a\">blockade</span> with ACEi and ARB</li>\n</ol>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/pIUtmI9oJHTReMHF3it91753558162.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/8yhhoUFQwHDLpRIBfmjh1753558303.mp3"
  },
  {
    "text": "<p>A 52-year-old obese male with poorly controlled Type 2 Diabetes Mellitus is started on semaglutide. Which of the following statements is not\u00a0true regarding this drug?</p>",
    "choices": [
      {
        "id": 1,
        "text": "It acts via GLP-1 receptor agonism, enhancing glucose-dependent insulin secretion"
      },
      {
        "id": 2,
        "text": "It may cause abdominal pain and elevated serum amylase levels suggestive of pancreatitis"
      },
      {
        "id": 3,
        "text": "It can cause transient worsening of diabetic retinopathy, especially in patients with rapid glycemic improvement"
      },
      {
        "id": 4,
        "text": "It commonly causes fluid retention and weight gain due to PPAR-\u03b3 activation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Answer is D:\u00a0It commonly causes fluid <span class=\"customMeta\" data-dictid=\"b668aed705169277719744b6db8f8e\">retention</span> and weight gain due to PPAR-\u03b3 activation</strong></p>\n\n<p>A \u2013 True: Semaglutide is a GLP-1 <span class=\"customMeta\" data-dictid=\"9e4959f6f316927771978bb152d440\">receptor</span> agonist, increases <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> release in a glucose-dependent manner.</p>\n\n<p>B \u2013 True: Semaglutide is associated with pancreatitis; patients may show raised amylase/lipase.</p>\n\n<p>C \u2013 True: <strong>Rapid <span class=\"customMeta\" data-dictid=\"92a52a7756169277718538d58fe1a9\">correction</span> </strong>of chronic hyperglycemia\u00a0by semaglutide and even <span class=\"customMeta\" data-dictid=\"901bf573f216927771905f0abedca2\">intensive</span> <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> therapy causes sudden shift in <span class=\"customMeta\" data-dictid=\"fb7a2c30e416927771972f7df6f8c0\">retinal</span> <span class=\"customMeta\" data-dictid=\"33dfead74b1692777195931780bd9e\">perfusion</span> , altered <span class=\"customMeta\" data-dictid=\"fb7a2c30e416927771972f7df6f8c0\">retinal</span> <span class=\"customMeta\" data-dictid=\"82cc227a1c169277718387905b50c6\">blood flow</span> and endothelial function causing <span class=\"customMeta\" data-dictid=\"a6cf2c3dc51692777200ef7fb22f69\">transient</span> worsening of pre-existing <span class=\"customMeta\" data-dictid=\"910047ee281692777192ceee540959\">microvascular</span> damage.\u00a0</p>\n\n<p>D \u2013 false\u00a0(<strong>Correct answer</strong>): Fluid <span class=\"customMeta\" data-dictid=\"b668aed705169277719744b6db8f8e\">retention</span> and weight gain are side effects of thiazolidinediones like pioglitazone which act via PPAR-\u03b3 \u2013 not seen with semaglutide.</p>\n\n<p><em>Extra mile\u00a0</em></p>\n\n<p>Semaglutide carries a <strong>black box warning</strong> for\u00a0Risk of <span class=\"customMeta\" data-dictid=\"799202e6fe16927772009a1501b0a8\">thyroid</span> C-cell tumors, including <span class=\"customMeta\" data-dictid=\"0a36e18386169277719259641cf29b\">medullary</span> <span class=\"customMeta\" data-dictid=\"799202e6fe16927772009a1501b0a8\">thyroid</span> <span class=\"customMeta\" data-dictid=\"988c19e3131692777183b6744d1920\">carcinoma</span> (MTC) based on studies on rodents. So contraindicated in patients with MEN 2</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/oROnBIxlvN2zg4Kw8VdK1753557252.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/hOTiX1z2b8hPTzE4Vipa1753557360.mp3"
  },
  {
    "text": "<p>50-year-old female with Type 2 diabetes mellitus comes for consultation due to extreme fatigue and thirst. BP 170/100 mm Hg . She is non compliant on her medicines and latest labs are mentioned below. Which is not correct about management of this case?\u00a0</p>\n\n<ol>\n\t<li>Random Plasma Glucose: 286 mg/dl</li>\n\t<li>HbA1c: 11.2 %</li>\n\t<li>Urine glucose +++</li>\n\t<li>Serum creatinine 2 mg/dl\u00a0</li>\n\t<li>eGFR: 25 mL/min</li>\n\t<li>Serum potassium 6.5 meq /dl\u00a0</li>\n</ol>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Monitor urine albumin creatinine ratio"
      },
      {
        "id": 2,
        "text": "Start Metformin with Sitagliptin"
      },
      {
        "id": 3,
        "text": "Start Amlodipine"
      },
      {
        "id": 4,
        "text": "Start Empagliflozin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Answer is B:\u00a0Start Metformin with Sitagliptin</strong></p>\n\n<p>The patient has developed <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> <span class=\"customMeta\" data-dictid=\"b06dd1c5181692777193f14f3ed7d7\">nephropathy</span> and <strong>eGFR of 25 implies <span class=\"customMeta\" data-dictid=\"d4ae50897e16927771884b5c46ba7d\">grade</span> 4 CKD</strong>.\u00a0</p>\n\n<p>Metformin is contraindicated in patients with significant <span class=\"customMeta\" data-dictid=\"b9356afdba16927771979d068c6587\">renal</span> <span class=\"customMeta\" data-dictid=\"4885d5d0021692777189aac6dc80f7\">impairment</span> (eGFR < 30 mL/min) due to the increased risk of <span class=\"customMeta\" data-dictid=\"b82539c9ae1692777191a3f7ddd7bb\">lactic</span> acidosis.Sitagliptin is metabolized by kidney. Control of hyperrtension with CCB is required as <span class=\"customMeta\" data-dictid=\"1ffaec13de169277719828374cfda0\">serum</span> <span class=\"customMeta\" data-dictid=\"a995a613a016927771969d4395dc80\">potassium</span> is elevated. ACEi are not be given with high <span class=\"customMeta\" data-dictid=\"a995a613a016927771969d4395dc80\">potassium</span> values. Empagliflozin is indicated as eGFR is less than 30 ml /min and it shows cardio <span class=\"customMeta\" data-dictid=\"b9356afdba16927771979d068c6587\">renal</span> benefit by <span class=\"customMeta\" data-dictid=\"ff02aa40d51692777191246d4a9b87\">lowering</span> SBP.\u00a0</p>\n\n<p>\u00a0</p>\n\n<p><br />\n\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/uxIgthV8FeO27kst6YeE1753557081.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/9csbFQ8Io1hzo4SJ6Uy01753557168.mp3"
  },
  {
    "text": "<p>You are educating a mother of\u00a0 8-year-old girl with type 1 Diabetes Mellitus about insulin administration techniques. Which of the following statements is incorrect regarding insulin delivery?</p>",
    "choices": [
      {
        "id": 1,
        "text": "The preferred site for subcutaneous insulin injection is the anterior abdominal wall."
      },
      {
        "id": 2,
        "text": "Insulin pens should be held at a 90\u00b0 angle to the skin for optimal delivery"
      },
      {
        "id": 3,
        "text": "Repeated insulin injections at the same site can cause lipohypertrophy"
      },
      {
        "id": 4,
        "text": "Repeat the insulin injection spot after 5-7 days"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct answer is D:\u00a0Repeat the <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> <span class=\"customMeta\" data-dictid=\"3509997646169277719014053aa74d\">injection</span> site after 5-7 days</strong></p>\n\n<p>Repeating the same <span class=\"customMeta\" data-dictid=\"3509997646169277719014053aa74d\">injection</span> spot should be <em>avoided for at least 2 weeks</em> to allow tissue <span class=\"customMeta\" data-dictid=\"9cf83937931692777188a014337dcf\">healing</span> and reduce <span class=\"customMeta\" data-dictid=\"0245b9e7621692777191d33806faaa\">lipodystrophy</span> risk.\u00a0</p>\n\n<p>Repeated use of same site may cause <span class=\"customMeta\" data-dictid=\"0245b9e7621692777191d33806faaa\">lipodystrophy</span> . Lipohypertrophy is more common and is seen due to <span class=\"customMeta\" data-dictid=\"3e0d247aa916927771812684526ac0\">anabolic</span> effects of insulin.\u00a0</p>\n\n<p>The <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> wall is the preferred site due to consistent absorption.</p>\n\n<p>90\u00b0 angle ensures proper SC delivery using <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> pens or syringes.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/tkNHpxggFC0kCTUp0vcd1753556770.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/rxfHoij8yAPNAigO78tG1753556892.mp3"
  },
  {
    "text": "<p>60 year old diabetic patient collapsed in the bathroom in the morning and died.\u00a0 She was on metformin and glipizide for last 10 years. Her latest HbA1c was 11%. What can be possible cause of this event?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Autonomic neuropathy"
      },
      {
        "id": 2,
        "text": "Congestive chronic heart failure"
      },
      {
        "id": 3,
        "text": "Pericardial tamponade"
      },
      {
        "id": 4,
        "text": "Catastrophic CNS hemorrhage"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct answer is A: <span class=\"customMeta\" data-dictid=\"bd1c98736616927771820954b0a744\">Autonomic</span> neuropathy\u00a0</strong></p>\n\n<p>Uncontrolled diabetes with 10-year duration\u00a0 will have increased risk of <span class=\"customMeta\" data-dictid=\"e1fb96fd2416927771830dfed40e14\">cardiac</span> <span class=\"customMeta\" data-dictid=\"bd1c98736616927771820954b0a744\">autonomic</span> neuropathy.\u00a0</p>\n\n<p>It can <em>cause silent myocardial ischemia, arrhythmias, <span class=\"customMeta\" data-dictid=\"d51601f2c41692777193ddfa55d163\">nocturnal</span> bradycardia, or QT prolongation</em>, leading to sudden death, especially overnight or early morning (bathroom collapse is classic).</p>\n\n<p>HbA1c : 11%\u00a0 indicates suboptimal control, further increasing <span class=\"customMeta\" data-dictid=\"910047ee281692777192ceee540959\">microvascular</span> and <span class=\"customMeta\" data-dictid=\"bd1c98736616927771820954b0a744\">autonomic</span> complications.</p>\n\n<p><strong>Congestive chronic <span class=\"customMeta\" data-dictid=\"1a5e87d16716927771888f364bce89\">heart failure</span> </strong>causes gradual decompensation, not sudden collapse unless massive arrhythmia.</p>\n\n<p><strong>CNS bleed w</strong>ould present with headache, <span class=\"customMeta\" data-dictid=\"da6db7b0e21692777203c4075458d3\">focal</span> neuro deficits, and may not cause instant death unless massive</p>\n\n<p>There is no history suggestive of <span class=\"customMeta\" data-dictid=\"e1fb96fd2416927771830dfed40e14\">cardiac</span> tamponade.\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/VKOnLRkAb1hMUnNUrSHt1753556479.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/OPHad6HhSzDMpXoPgS6c1753556651.mp3"
  },
  {
    "text": "<p>A 55-year-old man with T2DM is brought to ER in unconcious state. Work up shows ABG pH=7.38, pCO2 40 mm Hg HCO3 = 26 meq/L, Sodium 140 meq/L , K =5.5 meq/L urine ketostix is negative, RBS : 150 mg/dl and serum lactate is normal. Which of the following is correct about next step in managment of this patient?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "NCCT head"
      },
      {
        "id": 2,
        "text": "Normal saline followed by insulin drip"
      },
      {
        "id": 3,
        "text": "Administer 50% dextrose"
      },
      {
        "id": 4,
        "text": "Draw blood culture and start empirical antimicrobials"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Answer is option A: NCCT head\u00a0</strong></p>\n\n<p>Presentation given is of a <span class=\"customMeta\" data-dictid=\"a5603ff98316927771865d7ae41f16\">diabetic</span> patient with normal glucose, no acidosis, no ketones, and normal lactate, the most likely cause of sudden unconsciousness should trigger an evaluation for neurological causes (e.g., stroke or seizure).</p>\n\n<p>Based on lab reports <strong>hypoglycemia, DKA, hyperosmolar <span class=\"customMeta\" data-dictid=\"36a802ceb516927771893371227fb8\">hyperglycemic</span> state and <span class=\"customMeta\" data-dictid=\"fe9ab8afe416927771980091186846\">sepsis</span> are ruled out.</strong> Hence we will perform NCCT head to evaluate for CNS event like stroke.\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/jz0kpVpilfBUvncTGIMI1753556112.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/7kYKnyTCmPW7mcdNmlbI1753556352.mp3"
  },
  {
    "text": "<p>Which of the following drug will worsen cardiovascular mortality in a diabetic patient who underwent a CABG?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Semaglutide"
      },
      {
        "id": 2,
        "text": "Empagliflozin"
      },
      {
        "id": 3,
        "text": "Rosiglitazone"
      },
      {
        "id": 4,
        "text": "Tirzepatide"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct answer is C: Rosiglitazone\u00a0</strong></p>\n\n<p>Rosiglitazone, a <span class=\"customMeta\" data-dictid=\"de74d03176169277720014dfd26c35\">thiazolidinedione</span> , has been associated with an <strong>increased </strong>risk of <span class=\"customMeta\" data-dictid=\"e2b5f013011692777183ea1b11ed9c\">cardiovascular</span> events, particularly myocardial <span class=\"customMeta\" data-dictid=\"77aed446d2169277719007f42bf052\">infarction</span> and heart failure, especially in patients with existing <span class=\"customMeta\" data-dictid=\"e2b5f013011692777183ea1b11ed9c\">cardiovascular</span> disease or those who have undergone procedures like CABG.\u00a0</p>\n\n<p><strong>Antidiabetic drugs proven to reduce <span class=\"customMeta\" data-dictid=\"e2b5f013011692777183ea1b11ed9c\">cardiovascular</span> mortality in T2DM:</strong></p>\n\n<ol>\n\t<li>\n\t<p><strong>SGLT2 inhibitors</strong></p>\n\n\t<ul>\n\t\t<li>\n\t\t<p>Empagliflozin, Canagliflozin, Dapagliflozin</p>\n\t\t</li>\n\t\t<li>\n\t\t<p>Proven to reduce <strong>CV death</strong>, <strong>hospitalization for heart failure</strong>, and <strong>renal outcomes</strong></p>\n\t\t</li>\n\t\t<li>\n\t\t<p>Especially useful in <strong>T2DM with HF or CKD</strong></p>\n\t\t</li>\n\t</ul>\n\t</li>\n\t<li>\n\t<p><strong>GLP-1 <span class=\"customMeta\" data-dictid=\"9e4959f6f316927771978bb152d440\">receptor</span> agonists</strong></p>\n\n\t<ul>\n\t\t<li>\n\t\t<p>Semaglutide, Liraglutide, Dulaglutide</p>\n\t\t</li>\n\t\t<li>\n\t\t<p>Reduce <strong>major adverse <span class=\"customMeta\" data-dictid=\"e2b5f013011692777183ea1b11ed9c\">cardiovascular</span> events (MACE)</strong> in <strong>atherosclerotic CV disease</strong></p>\n\t\t</li>\n\t</ul>\n\t</li>\n\t<li>\n\t<p><strong>Tirzepatide</strong></p>\n\n\t<ul>\n\t\t<li>\n\t\t<p>A dual GLP-1 + GIP agonist</p>\n\t\t</li>\n\t</ul>\n\t</li>\n</ol>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/sGPNdJeUbrJEbQBL2lgu1753555821.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/Lf6YtsXf5LQy18WLyguP1753555952.mp3"
  },
  {
    "text": "<p>Which form of insulin is used for basal delivery in basal bolus regimen?\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Lispro"
      },
      {
        "id": 2,
        "text": "N.P.H"
      },
      {
        "id": 3,
        "text": "Glargine"
      },
      {
        "id": 4,
        "text": "Glulisine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>\u00a0</p>\n\n<p><strong>Answer is C: Glargine\u00a0</strong></p>\n\n<p><strong>Glargine serves the <span class=\"customMeta\" data-dictid=\"923af580cf16927771829606bce2a7\">basal</span> role to\u00a0</strong>maintain background <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> levels. <strong>Glulisine\u00a0and Lispro serves as <span class=\"customMeta\" data-dictid=\"8d138d554c16927771835be732558c\">bolus</span> role in <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> <span class=\"customMeta\" data-dictid=\"988bd8e7c71692777197b9f1d5d5ca\">regimen</span> to control the post <span class=\"customMeta\" data-dictid=\"a3ec06b3241692777196c3f58fb999\">prandial</span> spikes</strong>. <span class=\"customMeta\" data-dictid=\"8d138d554c16927771835be732558c\">Bolus</span> <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> is given 3 times per day.\u00a0</p>\n\n<p>Glargine is a long-acting <span class=\"customMeta\" data-dictid=\"923af580cf16927771829606bce2a7\">basal</span> <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> designed to provide steady <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> levels throughout the day, with an onset of action around 1\u20132 hours and a duration of approximately 24 hours.</p>\n\n<p>In contrast, Lispro is a rapid-acting <span class=\"customMeta\" data-dictid=\"8d138d554c16927771835be732558c\">bolus</span> insulin, primarily used to control <span class=\"customMeta\" data-dictid=\"5e98c7ac6916927771967b424f152e\">postprandial</span> <span class=\"customMeta\" data-dictid=\"af3ae60c0c16927771889b84ca41c0\">glucose</span> spikes. It begins to act within about 15 minutes of <span class=\"customMeta\" data-dictid=\"3509997646169277719014053aa74d\">injection</span> and lasts for 3\u20135 hours.</p>\n\n<p><strong>NPH (Neutral Protamine Hagedorn)</strong> is an <strong>intermediate-acting insulin</strong>, with a slower onset (2\u20134 hours) and peak effect around 6\u20138 hours, often <strong>given twice daily.</strong></p>\n\n<h3>\u00a0</h3>\n\n<p><strong>Typical Dosing Strategy of <span class=\"customMeta\" data-dictid=\"923af580cf16927771829606bce2a7\">basal</span> bolus:</strong> dose ~0.5 units/kg/day</p>\n\n<ul>\n\t<li>\n\t<p>50% as basal</p>\n\t</li>\n\t<li>\n\t<p>50% divided as <span class=\"customMeta\" data-dictid=\"8d138d554c16927771835be732558c\">bolus</span> before meals</p>\n\t</li>\n</ul>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/HIlx5ltjkoeRRI1NLswa1753555126.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/RE0VitAlmGRuI2HA6n6Q1753555644.mp3"
  }
];
        let quizName = '15 Diabetes Mellitus-Ii';
        const quizFilename = '15-diabetes-mellitus-ii-02010343.html';
        let hierarchy = ["PrepLadder", "qBank", "Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>