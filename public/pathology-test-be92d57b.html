<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pathology Test - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Test Series Subject / 2024
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 49-year-old female presents with a unilateral bloody nipple discharge. On examination, a small, palpable mass beneath the areola is noted. A core needle biopsy is performed, and the histopathology report is as shown. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ductal carcinoma in situ"
      },
      {
        "id": 2,
        "text": "Intraductal papilloma"
      },
      {
        "id": 3,
        "text": "Lobular carcinoma in situ"
      },
      {
        "id": 4,
        "text": "Fibroadenoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of unilateral <strong>bloody nipple discharge</strong> with a palpable <strong>mass beneath the areola</strong> and histopathology showing a central <strong>fibrovascular core with papillae arborizing within the lumen</strong> are suggestive of a solitary<strong> intraductal papilloma</strong>. \u00a0</p>\n<p><strong>Intraductal papilloma</strong> is a <strong>benign</strong>, proliferative breast disorder without atypia. It can be solitary or multiple (papillomatosis). Most commonly seen in <strong>premenopausal women</strong>.</p>\n<p>Option A. <strong>Ductal carcinoma in situ</strong>: Ductal carcinoma in situ (DCIS) is a neoplastic proliferation of epithelial cells limited by the basement membrane. It involves the ducts and lobules. It is not associated with a loss of E-cadherin expression. It typically presents as a suspicious area on a mammogram rather than a palpable mass with bloody discharge.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/33a226579f36420ba901f8e452a670ef.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5fa0c0cfe76d465a9d5b174e28efe374x1280x1883.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/798b39a05e98465bbb9b7923caeead7bx802x603.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3beb1bce3561466b832c958609ec7f15x1280x963.JPEG"
    ]
  },
  {
    "text": "Oil red O stain is used in which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Formalin fixation"
      },
      {
        "id": 2,
        "text": "Frozen section"
      },
      {
        "id": 3,
        "text": "Alcohol fixation"
      },
      {
        "id": 4,
        "text": "Gluteraldehyde fixation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Oil red O (ORO) stain\u00a0is used in<strong> frozen section.</strong></p>\n<p>Oil red O <strong>stains lipid/ fats</strong> and gives a characteristic <strong>orange/red appearance</strong>. It is used in the unfixed frozen sections as the fixation of fats with other routine processes may lose the lipid content. <strong>10% Neutral buffer formaldehyde (NBF)</strong> is the preferred fixative in histopathological sections staining with Oil red O. Zenker's fixative and Helly's fixative are best avoided during staining with ORO.</p>\n<p>Oil red O\u00a0stains the lipid in the vacuoles in the pulmonary vasculature.\u00a0It can be useful in identifying fat emboli in lung tissue, diagnosing renal cell carcinoma, and sebaceous gland tumors of the skin.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">\u00a0Other stains used for lipids or fats:</p>\n<div class=\"page\" title=\"Page 67\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><strong>Nile blue sulfate</strong>\u00a0The preferred fixative is formal calcium.</li>\n<li><strong>Osmic acid</strong> is used in the frozen section. 10% NBF is the preferred fixative</li>\n<li><strong>Sudan black B</strong> is used in the frozen section. The preferred fixative is 10% NBF.</li>\n</ul>\n<p>Other Options:</p>\n<p>Option A:\u00a0<strong>Formalin fixation- </strong>Formalin\u00a0as <strong>10% neutral buffered formalin (NBF)</strong> is the most common fixative used in diagnostic pathology.</p>\n<p>Option C:\u00a0<strong>Ethyl alcohol</strong>- Ideal fixative for <strong>cytological smears</strong> because it acts quickly and gives good nuclear detail.</p>\n<p>Option D:\u00a0<strong>Glutaraldehyde</strong>- Preferred\u00a0fixative in <strong>electron microscopy.</strong> The standard solution is a 2.5% buffered glutaraldehyde.</p>\n<p>The image below shows microscopy of an oil-red O-stained<strong>\u00a0bronchoalveolar lavage</strong> sample from a patient with acute lung injury.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0c66878a03164f31a3515090753ca42bx257x208.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/49b4ee358500448eaa8aaf9a00c0768bx1280x960.JPEG"
    ]
  },
  {
    "text": "A patient comes to the clinic complaining of recurrent oral and genital ulcers. Further evaluation shows an association with the HLA -B51 haplotype. Identify the likely diagnosis.",
    "choices": [
      {
        "id": 1,
        "text": "Goodpasture\u2019s syndrome"
      },
      {
        "id": 2,
        "text": "Takayasu Arteritis"
      },
      {
        "id": 3,
        "text": "Behcet disease"
      },
      {
        "id": 4,
        "text": "Churg-Strauss Syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The presentation of a patient with recurrent oral aphthous ulcers and genital ulcers, associated with <strong>HLA haplotype B51</strong> is likely to be a diagnosis of <strong>Behcet disease</strong>.</p>\n<p>Behcet disease is a neutrophilic vasculitis affecting small- to medium-sized vessels that classically presents as a<strong> clinical triad </strong>of <strong>recurrent oral aphthous ulcers, genital ulcers, and uveitis</strong>. Here <strong>(Th17) T helper 17</strong> cells play an important contribution in the recruitment of neutrophils, which will later infiltrate into the vessel wall.\u00a0</p>\n<p>There can also be gastrointestinal and pulmonary manifestations, with disease mortality related to severe neurologic involvement or rupture of vascular aneurysms. The condition is treated with steroids, cyclophosphamide, and TNF antagonists.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Goodpasture's syndrome</strong> is an <strong>anti-GBM</strong> (glomerular basement membrane) <strong>antibody</strong>-mediated disease. The antibodies are directed against the non-collagenous portion of the <strong>\u03b13 chain</strong> of <strong>collagen type IV</strong>. As it is present in both the alveoli and GBM, it usually presents with pulmonary hemorrhage and renal failure.</p>\n<p>Option B: <strong>Takayasu arteritis</strong> is the inflammation of the <strong>medium to large-sized arteries</strong>. It mainly affects the aortic arch and its branches. The most commonly affected artery is the subclavian artery. Patients will present with features of arm claudication, Raynaud's phenomenon, etc. They can also present with syncope, transient ischemic attack, abdominal pain, or chest pain depending on the arteries involved. A biopsy of the affected artery will show pan arteritis with mononuclear cell infiltrates and occasionally giant cells. Takayasu arteritis is not associated with migratory thrombophlebitis.</p>\n<p>Option D:\u00a0<strong>Churg-Strauss syndrome</strong> (eosinophilic granulomatosis with polyangiitis) is a small vessel vasculitis characterized by asthma, peripheral and tissue eosinophilia, extravascular granuloma formation, and vasculitis of multiple organs. The clinical features include non-specific symptoms like fever, malaise, anorexia, and weight loss. The pulmonary findings are characterized by severe asthmatic attacks and pulmonary infiltrates. Renal disease is less common in these patients. These patients show <strong>p-ANCA positivity</strong>.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man with HIV presents with generalized edema and proteinuria. He has had a gradual decline in renal function over the past year. Renal biopsy shows the following findings. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Focal segmental glomerulosclerosis"
      },
      {
        "id": 2,
        "text": "Membranoproliferative glomerulonephritis"
      },
      {
        "id": 3,
        "text": "Lupus nephritis"
      },
      {
        "id": 4,
        "text": "IgA nephropathy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario of an <strong>HIV-positive man</strong> presenting with <strong>edema</strong>, <strong>proteinuria</strong>, and renal biopsy findings showing <strong>segmental hyalinosis</strong> and <strong>sclerosis</strong> of the <strong>glomeruli</strong> is suggestive of <strong>focal segmental glomerulosclerosis </strong>(<strong>FSGS</strong>).\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fcf63741bddb4ae5a94e0f250d58817b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/02e8adc032f341f0bacbc5166c384649x1280x1186.JPEG"
    ]
  },
  {
    "text": "An autopsy of a 38-year-old male patient who died of cardiac failure showed the following histopathological image of the endocardium. Which of the following best describes the form of vegetation found in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Small, warty vegetations along the line of closure of the valve leaflets"
      },
      {
        "id": 2,
        "text": "Large, irregular masses on valve cusps and chordae"
      },
      {
        "id": 3,
        "text": "Small, bland vegetations on the line of closure"
      },
      {
        "id": 4,
        "text": "Small to medium sized vegetations on either sides of the valve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical vignette with histopathology showing <strong>Anitschkow cells </strong>and<strong> Aschoff bodies</strong>&nbsp;are pathognomic of the&nbsp;<strong>rheumatic fever (RF) phase </strong>of&nbsp;<strong>rheumatic heart disease (RHD).&nbsp;</strong>It is associated with&nbsp;<strong>small, warty&nbsp;vegetations along the lines of closure of the valve leaflets.</strong></p>\n<div class=\"page\" title=\"Page 565\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>RF</strong>&nbsp;is an acute, immunologically mediated, multisystem inflammatory disease classically occurring a few weeks after group A streptococcal pharyngitis. <strong>RHD</strong> is principally characterized by deforming fibrotic valvular disease, particularly the <strong>mitral valve.</strong></p>\n</div>\n</div>\n</div>\n</div>\n<p>Important pathological findings in rheumatic fever are:</p>\n<ul>\n<li>Inflammation in the <strong>three layers of the heart</strong> can result in endocarditis, myocarditis, pericarditis, or pancarditis<strong>.</strong></li>\n<li>Inflammation of the <strong>endocardium</strong> and the left side valves can lead to <strong>fibrinoid necrosis</strong>. Over these areas of necrosis, small <strong>vegetations</strong> can be seen along the lines of closure, called <strong>verrucae. </strong></li>\n<li>In the<strong> subendocardium,</strong> irregular thickenings called <strong>MacCallum plaques </strong>can be present.</li>\n<li><strong>Aschoff bodies</strong>&nbsp;are&nbsp;collections of lymphocytes (primarily T cells), scattered plasma cells, and <strong>plump-activated macrophages&nbsp;</strong>(called <strong>Anitschkow</strong> cells).<strong>&nbsp;</strong>The Anitschkow cells have abundant cytoplasm and nuclei with chromatin that is centrally condensed into a slender, wavy ribbon. Hence they are also called&nbsp;<strong>caterpillar cells.</strong></li>\n<li>Mitral valve in chronic RHD shows leaflet thickening, commissural fusion and shortening, and thickening and fusion of the tendinous cords.This leads to narrowing of the mitral orifice, giving it a&nbsp;<strong>fish mouth</strong> appearance.</li>\n</ul>\n<p>Image: Histology of a rheumatic fever patient showing Aschoff bodies and Anitschkow cells.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/81f20ee11112409ebf8bfaf924a525ee.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/aa77d43ce6f34bb480a2a303f8c419fcx802x531.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/800f908dc3a343d8961576964a1f3db1x1280x925.JPEG"
    ]
  },
  {
    "text": "A child presents with recurrent lung infections and thick mucus secretions. Chest x-ray shows bronchiectasis in bilateral upper lobes. What is the most common mutation seen in these patients?",
    "choices": [
      {
        "id": 1,
        "text": "Ile507del"
      },
      {
        "id": 2,
        "text": "Asn1303Lys"
      },
      {
        "id": 3,
        "text": "Phe508del"
      },
      {
        "id": 4,
        "text": "Gly178Arg"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of a child with <strong>recurrent lung infection</strong> with <strong>thick mucus secretion</strong> and <strong>upper lobe bronchiectasis</strong> suggest the diagnosis of <strong>cystic fibrosis</strong>. The most common mutation in <strong>cystic fibrosis</strong> is\u00a0<strong>Phe508del</strong>.\u00a0</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p><strong>Cystic fibrosis</strong> or <strong>mucoviscidosis</strong>\u00a0is an <strong>autosomal recessive</strong> disorder with a mutation in the cystic fibrosis transmembrane regulator <strong>(CFTR) gene</strong> on <strong>chromosome 7q</strong>.\u00a0The most common CFTR mutation is\u00a0<strong>F508 deletion</strong>.</p>\n<p>CFTR gene encodes for <strong>ATP-gated chloride channels</strong> in the apical membranes of epithelial cells. It regulates the flow of ions across epithelial membranes of sweat glands, respiratory airways, pancreatic ducts, etc. The defect leads to high salt concentrations in sweat and viscous luminal secretions in the respiratory and gastrointestinal tracts.</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">Clinical manifestations/ complications of cystic fibrosis include:</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<ul>\n<li><strong>Sinusitis</strong> and <strong>nasal polyps</strong></li>\n<li><strong>Respiratory </strong>- copious hyper-viscous and adherent pulmonary secretions with abnormal mucociliary clearance obstruct small and medium-sized airways leading to respiratory compromise. The disease can be further complicated by bronchiectasis and allergic bronchopulmonary aspergillosis (ABPA).</li>\n<li><strong>Gastrointestinal </strong>-<strong>\u00a0</strong>\n<ul>\n<li>Thick and adherent exocrine secretions <strong>obstruct</strong> <strong>pancreatic</strong> <strong>ducts</strong> and impair the production and flow of digestive enzymes</li>\n<li>Tissue destruction of the <strong>exocrine</strong> <strong>pancreas</strong>, with fibrotic scarring, cyst proliferation, and loss of acinar tissue - fat malabsorption, steatorrhea, fat-soluble vitamin deficiencies</li>\n<li>Obstruction of intrahepatic bile ducts and parenchymal fibrosis leading to hepatic insufficiency and <strong>focal biliary cirrhosis</strong></li>\n<li><strong>Distal intestinal obstructive syndrome</strong> in <strong>adults</strong> and <strong>meconium ileus</strong> in <strong>neonates</strong></li>\n</ul>\n</li>\n<li><strong>Reproductive</strong>\u00a0-<strong> males</strong> have\u00a0<strong>infertility</strong> due to the congenital <strong>absence</strong> of bilateral <strong>vas</strong> <strong>deferens</strong> and defective sperm transport, resulting in\u00a0<strong>obstructive azoospermia. Females</strong> have infertility due to abnormalities of the reproductive tract secretions.</li>\n</ul>\n<p>\u00a0The\u00a0<strong>diagnosis</strong>\u00a0is\u00a0<strong>confirmed</strong>\u00a0if\u00a0<strong>both</strong>\u00a0of the following\u00a0<strong>criteria</strong>\u00a0are met:</p>\n</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<ul>\n<li>Presence of\n<ul>\n<li><strong>Clinical symptoms</strong> affecting at least one organ system (respiratory, gastrointestinal, or genitourinary)\u00a0<strong>or</strong></li>\n<li>Positive<strong> newborn screening</strong>\u00a0<strong>or</strong></li>\n<li>A <strong>sibling</strong> with cystic fibrosis</li>\n</ul>\n</li>\n<li>Evidence of\u00a0<strong>dysfunction</strong>\u00a0of the\u00a0<strong>CFTR gene</strong>\u00a0by\n<ul>\n<li><strong>Two positive sweat chloride tes</strong>t results were obtained on separate days\u00a0<strong>or</strong></li>\n<li>Identification of <strong>two CFTR mutations</strong> by genetic testing\u00a0<strong>or</strong></li>\n<li>An <strong>abnormal</strong> measurement of <strong>nasal potential difference</strong></li>\n</ul>\n</li>\n</ul>\n<p>Cystic fibrosis requires a multidisciplinary approach to management. The correction of the defect can be done via:</p>\n<ul>\n<li><strong>Lumacaftor,</strong> an FDA-approved drug that corrects the misfolding and reverts the Phe508del mutation defect</li>\n<li><strong>Ivacaftor</strong> potentiates CFTR channel opening and stimulates ion transport</li>\n</ul>\n<p>End-stage pulmonary failure requires <strong>lung transplantation</strong>.</p>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old man diagnosed with Huntington's chorea has a family history of the disease. Which of the following best explains the earlier onset of the disease in successive generations?",
    "choices": [
      {
        "id": 1,
        "text": "Mutations in the somatic cells"
      },
      {
        "id": 2,
        "text": "Incomplete penetrance"
      },
      {
        "id": 3,
        "text": "Genetic anticipation"
      },
      {
        "id": 4,
        "text": "Mitochondrial inheritance"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Genetic anticipation </strong>explains the earlier onset of the disease in successive generations.</p>\n<p><strong>Genetic</strong> <strong>anticipation</strong>\u00a0is a phenomenon observed in certain <strong>trinucleotide repeat</strong> <strong>disorders</strong> like <strong>Huntington's disease</strong>. In these disorders, the number of <strong>CAG repeats</strong> in a specific gene <strong>increases</strong> with <strong>each generation</strong>, leading to <strong>earlier onset</strong> and <strong>more severe</strong> <strong>symptoms</strong> in offspring.</p>\n<p><strong>Huntington's disease (HD)</strong> is a <strong>degenerative disease</strong> of the <strong>caudate</strong> and <strong>putamen</strong> (\u201c<strong>striate neurons</strong>\u201d) caused by an <strong>autosomal dominant</strong> <strong>inheritance</strong> of a <strong>trinucleotide repeat (CAG)</strong> in the <strong>Huntingtin gene</strong> <strong>(chromosome 4)</strong>, which results in <strong>chorea</strong> and <strong>dementia</strong> and which demonstrates <strong>anticipation</strong>.</p>\n<p>The <strong>caudate nucleus</strong> is dramatically <strong>atrophied</strong>, with accompanying atrophy of the <strong>putamen</strong>, <strong>cortex</strong>, and <strong>hydrocephalus ex vacuo</strong> of the <strong>3rd</strong> <strong>ventricle</strong>.</p>\n<p>This is commonly seen in the 4th and 5th decade of life and motor problems like <strong>chorea precede dementia</strong>. Treatment consists of <strong>haloperidol</strong> and <strong>tetrabenazine</strong> for chorea.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Somatic mutations</strong> are <strong>acquired mutations</strong> that occur in somatic cells and are <strong>not passed</strong> <strong>on</strong> <strong>to offspring.</strong> They cannot explain the pattern of inheritance seen in this case.</p>\n<p>Option B: <strong>Incomplete penetrance</strong> refers to <strong>variations in penetrance and expressivity of clinical features.</strong> Not all individuals who inherit the mutant gene show a <strong>mutant phenotype.</strong> It is a feature of <strong>autosomal dominant disorders. \u00a0\u00a0</strong></p>\n<p>Option D: <strong>Mitochondrial inheritance</strong> has its unique patterns of inheritance, passed exclusively from <strong>females,</strong> that do not match the observed scenario.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following is a histopathological image of the thyroid mass. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Medullary carcinoma of thyroid"
      },
      {
        "id": 2,
        "text": "Papillary carcinoma of thyroid"
      },
      {
        "id": 3,
        "text": "Follicular carcinoma of thyroid"
      },
      {
        "id": 4,
        "text": "Anaplastic carcinoma of thyroid"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The histopathological image shows the presence of\u00a0<strong>amyloid-rich stroma</strong>\u00a0(pinkish material) and nests of polygonal cells, which are findings suggestive of <strong>medullary carcinoma of thyroid.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5fb38b7565364d3d8a365f322be2ce22.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/13978ae15e1548d297146ee93c34b3f0x1279x1050.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9affd63531ca4189945bff000d2db13ex1279x1042.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cd65f2d47b9e46a5b1aba25a8accaa7dx800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f0c87e50b4243b78b271621dda8028bx1280x853.JPEG"
    ]
  },
  {
    "text": "Match the following cell types with their associated malignancy.",
    "choices": [
      {
        "id": 1,
        "text": "1-b, 2-a, 3-d, 4-c"
      },
      {
        "id": 2,
        "text": "1-a, 2-d, 3-c, 4-b"
      },
      {
        "id": 3,
        "text": "1-b, 2-c, 3-a, 4-c"
      },
      {
        "id": 4,
        "text": "1-a, 2-b, 3-d, 4-c"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct matches are <strong>1-b, 2-a, 3-d, 4-c.</strong></p>\n<table style=\"height: 117px; width: 437.195679px;\">\n<tbody>\n<tr>\n<td style=\"width: 150px;\">1. Popcorn cell</td>\n<td style=\"width: 267.195679px;\">b. Lymphocyte-predominant Hodgkin's lymphoma</td>\n</tr>\n<tr>\n<td style=\"width: 150px;\">2. Faggot cell</td>\n<td style=\"width: 267.195679px;\">a. Acute promyelocytic leukemia</td>\n</tr>\n<tr>\n<td style=\"width: 150px;\">3. Cerebriform nuclei</td>\n<td style=\"width: 267.195679px;\">d. Sezary syndrome</td>\n</tr>\n<tr>\n<td style=\"width: 150px;\">4. Starry sky</td>\n<td style=\"width: 267.195679px;\">c. Burkitt lymphoma</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p><strong>Popcorn cell </strong>is a lymphohistiocytic (L&amp;H) variant of<strong>&nbsp;Reed Steenberg (RS) cells</strong>&nbsp;that are characteristic of<strong>&nbsp;lymphocyte-predominant Hodgkin lymphoma.</strong>&nbsp;It has a delicate multilobed, puffy nucleus resembling popped corn. The image below shows a&nbsp;<strong>popcorn cell</strong>&nbsp;seen in lymphocytic predominant Hodgkin's lymphoma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/07ddd987bf4d41d6833787183cd52f2ex1280x1130.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d2a4f9b9a7b2443493016dfc3a6d9f90x720x818.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f992ca337fa54961bf9742e338b6114ex220x222.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6413a6d302b74609934d8a289e3f2e2ex1024x768.JPEG"
    ]
  },
  {
    "text": "Which of the following mutations is not seen in patients with renal cell carcinoma?",
    "choices": [
      {
        "id": 1,
        "text": "MET mutation"
      },
      {
        "id": 2,
        "text": "VHL mutation"
      },
      {
        "id": 3,
        "text": "MSH2 mutation"
      },
      {
        "id": 4,
        "text": "BHD mutation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>MSH2</strong> mutation is not associated with<strong> renal cell carcinoma</strong>.</p>\n<p>Renal cell carcinoma can be sporadic or inherited. Various mutations are implicated in familial cancers. The most common mutation is\u00a0<strong>VHL mutation (clear cell RCC).</strong></p>\n<p>Other mutations that can cause renal cell carcinoma include <strong>MET mutation</strong> (Papillary type RCC), <strong>BHD mutation\u00a0</strong>(Birt-Hogg-Dub\u00e9 syndrome), and Xp11 translocation (a subtype that occurs in young patients due to overexpression of TFE3 transcription factor).</p>\n<p><strong>MSH2 mutation</strong> results in <strong>DNA\u00a0mismatch repair</strong>\u00a0which causes colon cancers including <strong>familial hereditary nonpolyposis colon carcinoma</strong> and endometrial cancers.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Bronchoscopic examination of a 55-year-old non-smoker woman confirmed the presence of lung carcinoma. On biopsy, a lepidic pattern was observed. Which of the following paraneoplastic syndromes is associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Lambert Eaton Syndrome"
      },
      {
        "id": 2,
        "text": "Migratory thrombophlebitis"
      },
      {
        "id": 3,
        "text": "Hypercalcemia"
      },
      {
        "id": 4,
        "text": "Cushing syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario of a non-smoker woman presenting with cough, hemoptysis, weight loss, and lung biopsy showing a<strong> lepidic pattern</strong> (<strong>butterfly</strong> <strong>on the fence</strong>) is suggestive of <strong>adenocarcinoma</strong> of the <strong>lung</strong>. The <strong>paraneoplastic</strong> <strong>syndromes</strong> associated with this include <strong>hypertrophic osteoarthropathy</strong> and <strong>migratory</strong> <strong>venous thrombophlebitis</strong>.</p>\n<p>Migratory venous thrombophlebitis is a paraneoplastic syndrome also known as <strong>Trousseau\u2019s syndrome</strong> or Trousseau's sign of malignancy. It is characterized by recurrent episodes of localized thrombosis of the superficial veins of limbs. It can lead to tender and erythematous rashes.</p>\n<p>Migratory thrombophlebitis is seen in <strong>pancreatic cancer (most common)</strong>, <strong>lung cancer</strong>, gastrointestinal cancer, ovarian cancer, prostate cancer, and in lymphomas.\u00a0</p>\n<p><strong>Adenocarcinoma</strong> is the<strong> most common type of lung cance</strong>r seen in <strong>women</strong> and <strong>nonsmokers.</strong> Adenocarcinomas are usually located in the <strong>periphery</strong> compared to other lung tumors and are relatively smaller. <strong>Atypical adenomatous hyperplasia</strong> is a precursor lesion of adenocarcinoma. Immunohistochemical markers in adenocarcinoma lung are <strong>thyroid transcription factor-1 (TTF-1) and napsin A.</strong></p>\n<p>Microscopic examination shows a<strong> lepidic pattern of growth</strong> at the periphery of the tumor. The tumor cells appear to crawl along the normal-appearing alveolar septa, as shown in the image below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3189559b5b6f41ffbcca3945e7a98e38x800x533.JPEG"
    ]
  },
  {
    "text": "A female patient presented with complaints of bloody urine mostly during the night time. Laboratory investigations show pancytopenia and elevated LDH levels. Ham's test was found to be positive. What is the gold standard investigation done for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Flow cytometry"
      },
      {
        "id": 2,
        "text": "Lap score"
      },
      {
        "id": 3,
        "text": "Coombs test"
      },
      {
        "id": 4,
        "text": "FISH"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical vignette of bloody urine during the night, pancytopenia, elevated LDH levels, and positive<strong> </strong>Ham test are suggestive of <strong>paroxysmal nocturnal</strong> <strong>hemoglobinuria</strong> (PNH) and <strong>flow cytometry</strong> <strong>is the gold standard investigation.</strong></p>\n<p>PNH is a <strong>chronic acquired hemolytic anemia</strong> that occurs due to mutations in the <strong>PIGA gene</strong>. PIGA is an enzyme that is essential for the synthesis of certain membrane-associated complement regulatory proteins.</p>\n<p>Thus, PNH blood cells are deficient in three <strong>glycosylphosphatidylinositols (GPI) linked proteins</strong> that regulate complement activity:</p>\n<ul>\n<li>Decay accelerating factors or <strong>CD55</strong></li>\n<li>Membrane inhibitor of reactive lysis or <strong>CD59</strong></li>\n<li><strong>C8 binding protein</strong></li>\n</ul>\n<p>Clinically, the patient would have hemolysis, pancytopenia, and a tendency for venous thrombosis. <strong>Intravascular hemolysis</strong> may be <strong>nocturnal</strong> and <strong>paroxysmal</strong> or chronic hemolysis without the dramatic hemoglobinuria. Blood investigations reveal <strong>iron deficiency anemia</strong> (due to chronic hemoglobinuria) and <strong>elevated LDH</strong> levels.</p>\n<p>Investigations in PNH include:</p>\n<ul>\n<li><strong>Flow cytometry (gold standard) - deficiency of CD59 and CD55</strong></li>\n<li><strong>Ham test</strong> (acidified serum lysis) - lysis of RBCs in a mildly acidic pH due to complement fixation</li>\n<li><strong>Bone marrow biopsy</strong> -\n<ul>\n<li>Hypercellularity with erythroid hyperplasia is seen in classical presentations</li>\n<li>Patients who develop pancytopenia will have hypocellular bone marrow</li>\n</ul>\n</li>\n<li><strong>Imaging</strong> - to evaluate <strong>venous thrombosis</strong></li>\n</ul>\n<p>Treatment involves the use of <strong>eculizumab,</strong> a monoclonal antibody that<strong> prevents the conversion of the complement C5 to C5a.</strong></p>\n<p>Other options:</p>\n<p>Option B: <strong>Leukocyte alkaline phosphatase (LAP) score</strong> is obtained by assessing the staining intensity in 100 consecutive neutrophils, with each neutrophil scored on a scale of 1\u20134. Conditions that result in an <strong>increase in leukocytes</strong> in <strong>all stages of maturity</strong> will reflect a corresponding increase in LAP. LAP is <strong>increased in leukemoid reaction</strong> and <strong>decreased in CML</strong>, and hence helps to differentiate the two.</p>\n<p>Option C: <strong>Coombs test </strong>detects antibodies against blood components, and is positive in autoimmune causes of anemia.</p>\n<p>Option D:\u00a0<strong>Fluorescent In Situ Hybridisation (FISH)</strong> helps in the detection of specific genetic information on morphologically intact tissue using <strong>fluorescent probes</strong>. FISH can be performed on prenatal samples, peripheral blood cells, touch preparations from cancer biopsies, and even fixed archival tissue sections. It is used to detect <strong>chromosomal aneuploidy</strong>, subtle <strong>microdeletions</strong> and <strong>rearrangements</strong>, complex <strong>translocations,</strong> and <strong>gene amplification</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which female genital cancer is associated with metabolic disturbances like diabetes, obesity, and hypertension?",
    "choices": [
      {
        "id": 1,
        "text": "Vulval cancer"
      },
      {
        "id": 2,
        "text": "Ovarian cancer"
      },
      {
        "id": 3,
        "text": "Endometrial cancer"
      },
      {
        "id": 4,
        "text": "Cervical cancer"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Endometrial cancer\u00a0</strong>has been found to be associated with metabolic disturbances like diabetes, obesity, and hypertension.</p>\n<div class=\"page\" title=\"Page 1032\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Endometrial carcinoma</strong> is the most common invasive cancer of the female genital tract. <strong>Type 1</strong> endometrial carcinoma shows <strong>endometrioid</strong> morphology and is associated with the following:</p>\n<ul>\n<li>Unopposed estrogen exposure\u00a0(endometrial hyperplasia)</li>\n<li><strong>Obesity</strong></li>\n<li><strong>Diabetes</strong> <strong>mellitus</strong></li>\n<li><strong>Hypertension</strong></li>\n</ul>\n<p>The\u00a0tumor-suppressor gene <em><strong>PTEN </strong></em>is mutated in approximately 20% of endometrial hyperplasias.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old male child presents with a history of easy bruisiability and hemarthrosis. Investigations revealed normal platelet count and bleeding time, normal PT, and prolonged PTT. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Von Willebrand disease"
      },
      {
        "id": 2,
        "text": "Hemophilia A"
      },
      {
        "id": 3,
        "text": "Bernard-Soulier syndrome"
      },
      {
        "id": 4,
        "text": "Glanzmann thrombasthenia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of <strong>hemarthrosis</strong> and the investigations showing <strong>prolonged PTT</strong>\u00a0 and normal <strong>platelet count, bleeding time</strong>, and <strong>PT,</strong> are suggestive of a coagulation disorder. Among the given options, <strong>hemophilia A </strong>is a coagulation disorder, while all the other conditions are platelet disorders.</p>\n<p>Bleeding into joints (<strong>hemarthrosis</strong>) and deep tissues is a feature of coagulation disorders, whereas platelet disorders usually present with mucocutaneous bleeding such as petechiae, purpura, epistaxis, or GI bleeding. <strong>Prolonged PT/aPTT </strong>is a feature of coagulation disorders, while prolonged bleeding time is a feature of platelet disorders.</p>\n<p>In the given scenario, normal platelet count and bleeding time exclude platelet disorders. Normal PT indicates normal functioning of the extrinsic pathway of the coagulation cascade, and prolonged PTT indicates a defect in the intrinsic pathway.</p>\n<p>Hemophilia is an <strong>X-linked </strong>(recessive) coagulation disorder associated with <strong>mutations in\u00a0factor VIII</strong>, affecting the\u00a0<strong>intrinsic pathway</strong>.\u00a0The patients present with <strong>easy bruising</strong>, significant <strong>hemorrhage following trauma</strong> and operative procedures, and\u00a0<strong>hemarthroses</strong>, but\u00a0no petechiae. The\u00a0diagnosis is confirmed by carrying out factor VIII-specific assays. Infusions of recombinant factor VIII are used for treatment.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/063b99cd019049389f1b51dcaba83160x1280x2324.JPEG"
    ]
  },
  {
    "text": "Which of the following regions of the hepatic lobule would be the first to show morphological changes in a patient with alcoholic liver disease?",
    "choices": [
      {
        "id": 1,
        "text": "Periportal zone"
      },
      {
        "id": 2,
        "text": "Midzonal parenchyma"
      },
      {
        "id": 3,
        "text": "Centrilobular zone"
      },
      {
        "id": 4,
        "text": "Sinusoids"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\"><strong>Zone 3</strong>, i.e., the <strong>centrilobular zone</strong> is the first region to show morphological changes in <strong>alcoholic liver disease</strong>.\u00a0</p>\n<p class=\"p1\"><span class=\"s1\">Based on blood flow, the liver parenchyma can be divided into three zones. </span></p>\n<ul>\n<li class=\"p1\"><span class=\"s1\">Zone 1 - Periportal (around portal triad)</span></li>\n<li class=\"p1\"><span class=\"s1\">Zone 2 - Midzonal parenchyma</span></li>\n<li class=\"p1\"><strong><span class=\"s1\">Zone 3 - Centrilobular (around hepatic vein)</span></strong></li>\n</ul>\n<p class=\"p1\">A schematic diagram showing the hepatic lobule indicating the direction of blood flow and the zones of decreasing oxygenation is given below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/27353f2ec8d848c592a7d89d9a1ba455x1280x1316.JPEG"
    ]
  },
  {
    "text": "A patient presents with fatigue and chronic diarrhea for 4 months. Endoscopy reveals several ulcers in the gastric antrum and the descending duodenum. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "VIPoma"
      },
      {
        "id": 2,
        "text": "Zollinger-Ellison syndrome"
      },
      {
        "id": 3,
        "text": "Glucagonoma"
      },
      {
        "id": 4,
        "text": "Insulinoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of gastrinoma-\u00a0<strong>Zollinger-Ellison</strong>\u00a0<strong>syndrome</strong>.\u00a0</p>\n<div class=\"page\" title=\"Page 776\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Zollinger-Ellison syndrome is caused by <strong>gastrin-secreting neuroendocrine tumors</strong>. In 75% of patients, gastrinomas are sporadic, solitary lesions. The remaining 25% of patients with gastrinomas have multiple endocrine neoplasia type 1 (MEN1).\u00a0Gastrinomas usually arise in the small intestine or pancreas. The most remarkable feature in the stomach is an<strong> increase in oxyntic mucosal thickness</strong> due to massive parietal cell hyperplasia.</p>\n<p>Patients present with <strong>duodenal ulcers</strong> or <strong>chronic diarrhea</strong>. Ulcers may occur in unusual locations such as the jejunum; when <strong>intractable jejunal ulcers</strong> are found, Zollinger-Ellison syndrome should be considered.\u00a0</p>\n<p><strong>Treatment</strong> of individuals with Zollinger-Ellison syndrome includes blockade of acid hypersecretion, typically with <strong>proton pump inhibitors</strong>.\u00a0</p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>Other options:</strong></p>\n<p>Option A:<strong>\u00a0VIPoma</strong>\u00a0is characterized by watery diarrhea, hypokalemia, and achlorhydria (<strong>WDHA syndrome</strong>). It is caused by the release of vasoactive intestinal peptide (VIP) from the tumor.</p>\n<p>Option C:<strong> Glucagonomas</strong>, \u03b1-cell tumors are associated with increased serum levels of glucagon. The patient presents with mild diabetes mellitus, a characteristic skin rash (necrolytic migratory erythema), and anemia. They occur most frequently in perimenopausal and postmenopausal women and are characterized by extremely high plasma glucagon levels.</p>\n<p>Option D: <strong>Insulinomas</strong>,\u00a0\u03b2-cell tumors are the most common pancreatic endocrine neoplasms. These are usually <strong>benign</strong> and often cause symptomatic hypoglycemia. Hypoglycemic symptoms appear when <strong>blood glucose </strong>levels fall<strong> below 50 mg/dL</strong>. The symptoms usually develop after fasting or exertion and improve after glucose intake.</p>\n<div class=\"page\" title=\"Page 1114\">\u00a0</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 43-year-old lady comes with complaints of fever, abdominal pain, and itching over her arms and legs. On examination, icterus and mild hepatomegaly are seen. Liver function tests show deranged values with elevated serum IgG levels. The patient also tests negative for viral hepatitis markers. Which of the following characteristic histopathological features suggests the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Gound-glass hepatocytes"
      },
      {
        "id": 2,
        "text": "Bile duct injury and granulomas"
      },
      {
        "id": 3,
        "text": "Councilman bodies"
      },
      {
        "id": 4,
        "text": "Piecemeal necrosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical features along with increased serum IgG levels and absence of viral hepatitis markers indicate <strong>autoimmune hepatitis (AIH)</strong>. <strong>\u00a0</strong>The characteristic histopathological picture seen in AIH is<strong> a\u00a0</strong>cluster of plasma cells and lymphocytes at the interface between the portal tract and liver lobule is known as<strong> interface hepatitis or piecemeal necrosis</strong></p>\n<p>Autoimmune hepatitis (AIH) is characterized by extensive <strong>inflammation</strong>, <strong>fibrosis,</strong> and ultimately <strong>cirrhosis</strong>. The pathologic features include:</p>\n<ul>\n<li><strong>Emperipolesis</strong> - Lymphocytes and plasma cells within the cytoplasm of hepatocytes.</li>\n<li><strong>Interface hepatitis</strong> or <strong>piecemeal necrosis</strong>.</li>\n<li><strong>Rosette formation</strong> due to necrosis of groups of hepatocytes and resultant regeneration.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/72c5edd3b376459b9e1e28ac3dc6025ex1280x4469.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1282276a113b45348a0beb46208f50a6x1280x1585.JPEG"
    ]
  },
  {
    "text": "A 15-year-old boy presents with swelling in the upper diaphyseal part of the tibia. X-ray of the swelling showed a periosteal reaction. A histopathological image of the biopsy is given below. Immunohistochemistry was positive for synaptophysin and mic 2. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Osteosarcoma"
      },
      {
        "id": 2,
        "text": "Ewing sarcoma"
      },
      {
        "id": 3,
        "text": "Metastatic neuroblastoma"
      },
      {
        "id": 4,
        "text": "Osteoclastoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario along with the image showing<strong>\u00a0small round blue cells</strong> and\u00a0immunohistochemistry (IHC) positive for <strong>synaptophysin</strong> and <strong>mic-2</strong> point to a likely diagnosis of <strong>Ewing sarcoma</strong>.\u00a0</p>\n<p>Ewing\u00a0sarcoma<strong>\u00a0</strong>is the <strong>2nd most common</strong>\u00a0bone sarcoma in children. The majority of the patients affected are usually\u00a0<strong>&lt;20 years</strong> of age. It has a slight <strong>male</strong> predominance.\u00a0</p>\n<p>It commonly involves the\u00a0<strong>diaphysis</strong>\u00a0of the <strong>long bones</strong> like the <strong>femur</strong>,<strong> tibia</strong>, fibula, and humerus and <strong>flat bones</strong> of the <strong>pelvis</strong>. The majority of Ewing sarcomas have<strong> t(11:22)</strong>.\u00a0</p>\n<p>Patients present with\u00a0<strong>painful enlarging mass</strong>, fever, and anaemia. The affected area is usually tender, swollen, and warm. Laboratory findings may show an elevated WBC count and erythrocyte sedimentation rate (ESR).\u00a0</p>\n<p>A histopathological examination of Ewing sarcoma shows sheets of<strong> uniform, round cells </strong>arranged in<strong> Homer-Wright rosettes.</strong><strong>\u00a0</strong>These cells are of neuroectodermal origin and have minimal cytoplasm and abundant glycogen. When they are arranged around a central fibrillary core in the form of clusters, the appearance is termed\u00a0<strong>Homer-Wright rosettes.\u00a0</strong>Immunohistochemistry is usually\u00a0positive for<strong> synaptophysin </strong>and<strong> mic-2.</strong></p>\n<p>Given below is the histopathological appearance of\u00a0Ewing sarcoma.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/07c24b9bbadb44aea23a29cba1f073be.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9003f86ee1384b5c938b3096d52cc98cx1280x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6a40fa82d61e43fe834545ba3e782885x1279x1048.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f99343856f124715846432a4a29e62b6x720x1363.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/660d962942824c67b7a48a238f3a7b59x1280x853.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f9424f27b6514a5e9ff11fcfcc92c10cx720x765.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2c756ed405974a7e941ed0f99971568dx800x570.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1ef15ab45b4f4b9899cc3960b4ccffedx1280x853.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7fa42e7411944499863d9f1d71934b6bx720x912.JPEG"
    ]
  },
  {
    "text": "A 45-year-old  is being evaluated on a follow-up visit. He is found to have increased erythropoietin levels and his centrifuged blood sample is shown in the image below. Which of the following conditions must have led to these lab findings?",
    "choices": [
      {
        "id": 1,
        "text": "Hypersplenism"
      },
      {
        "id": 2,
        "text": "Hereditary hemochromatosis"
      },
      {
        "id": 3,
        "text": "Polycythemia vera"
      },
      {
        "id": 4,
        "text": "Chronic obstructive lung disease"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Patients with <strong>chronic obstructive lung disease</strong> (COPD) would have an <strong>increased hematocrit</strong> and an <strong>increased erythropoietin</strong> in an attempt for the body to supply sufficient oxygen to all cells of the body.</p>\n<p><strong>Polycythemia</strong> refers to an <strong>increase</strong> in the number of red blood cells (<strong>RBC</strong>) in the body. It is classified into <strong>relative</strong> and <strong>absolute. Relative polycythemia</strong> is due to <strong>reduced intravascular volume</strong> (dehydration). Furthermore, <strong>absolute polycythemia</strong> can be further classified as follows:</p>\n<table style=\"height: 142px; width: 451px;\">\n<tbody>\n<tr>\n<td style=\"width: 109px;\">\u00a0</td>\n<td style=\"width: 159.1875px;\"><strong>Primary</strong> polycythemia (polycythemia <strong>vera)</strong></td>\n<td style=\"width: 164.8125px;\"><strong>Secondary </strong>polycythemia</td>\n</tr>\n<tr>\n<td style=\"width: 109px;\">Pathophysiology</td>\n<td style=\"width: 159.1875px;\">Caused by mutations in the hematopoietic stem cells (Option C)</td>\n<td style=\"width: 164.8125px;\">\n<p>Hypoxia (COPD,\u00a0<strong>carbon monoxide</strong> poisoning)\u00a0</p>\n<p>Autonomous EPO production\u00a0</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 109px;\">Erythropoietin (EPO)</td>\n<td style=\"width: 159.1875px;\">Normal or low</td>\n<td style=\"width: 164.8125px;\"><strong>High</strong></td>\n</tr>\n<tr>\n<td style=\"width: 109px;\">WBCs, and platelet count\u00a0</td>\n<td style=\"width: 159.1875px;\">High (due to increased production of all cell lines)</td>\n<td style=\"width: 164.8125px;\">Normal</td>\n</tr>\n</tbody>\n</table>\n<p><br />Other options:</p>\n<p>Option A: <strong>Hypersplenism</strong> would lead to increased <strong>destruction</strong> of RBCs thereby leading to <strong>anemia</strong> and <strong>not polycythemia</strong><strong>.</strong></p>\n<p>Option B: <strong>Hereditary hemochromatosis</strong> does not have elevated erythropoietin as the defect lies in the HFE gene which leads to over-absorption of iron which would downregulate erythropoietin synthesis.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b9923303854a4f7d9707390b6a0e1f44.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A middle-aged man presents to the outpatient department with fever, epigastric discomfort, progressive weight loss, arthralgia, and foul-smelling diarrhea for the past 6 months. There is no relation between the abdominal pain and his bowel movements. He was started on a restrictive diet, which showed no improvement. His biopsy is given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Irritable bowel syndrome"
      },
      {
        "id": 2,
        "text": "Whipple disease"
      },
      {
        "id": 3,
        "text": "Cystic fibrosis"
      },
      {
        "id": 4,
        "text": "Celiac disease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The symptoms of this patient along with the given slide showing <strong>macrophages</strong> filled with <strong>PAS-positive inclusions</strong> point to a diagnosis of <strong>Whipple's disease.</strong></p>\n<p>The morphologic hallmark of Whipple disease is a dense accumulation of <strong>distended, foamy macrophages </strong>in the small intestinal lamina propria. Macrophages contain <strong>periodic acid\u2013Schiff (PAS)-positive,</strong> diastase-resistant granules that represent lysosomes stuffed with partially digested bacteria.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/26f54d8b758243b88f33ce83ef392037.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2adcf7b3dc914c63acaeea8f10c8ad46x1280x1574.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6f207a28a36c4a84b67d08d402fecf5dx1280x1230.JPEG"
    ]
  },
  {
    "text": "A 3-year-old male child with weakness of limbs and difficulty in walking was evaluated. Serum creatinine kinase was elevated. A sex-linked recessive mode of inheritance was seen.  What is the condition the boy is suffering from?",
    "choices": [
      {
        "id": 1,
        "text": "Myotonic dystrophy"
      },
      {
        "id": 2,
        "text": "Limb-girdle dystrophy"
      },
      {
        "id": 3,
        "text": "Facioscapulohumeral dystrophy"
      },
      {
        "id": 4,
        "text": "Duchenne muscular dystrophy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A 3-year-old male child with <strong>limb weakness, difficulty walking, elevated creatinine kinase,</strong> and <strong>sex-linked inheritance</strong> is likely to suffer from<strong> Duchenne muscular dystrophy. </strong></p>\n<p>It is an <strong>X-linked recessive</strong> disease and is due to a mutation in a structural protein called <strong>dystrophin.\u00a0</strong><strong>Males</strong> are commonly affected. They are normal at birth. Symptoms of weakness gradually develop and are often characterized by delayed walking, clumsiness, and inability to keep up with peers.\u00a0</p>\n<p><strong>Pelvic girdle muscles</strong> are affected and this is followed by <strong>shoulder girdle weakness. </strong>Muscles of the lower leg are weak but enlarged,\u00a0described as <strong>pseudohypertrophy. </strong>Other features include<strong>\u00a0cardiomyopathy, arrhythmias</strong>, and<strong> intellectual disability.</strong></p>\n<p><strong>Serum creatine kinase</strong> is markedly elevated. Supportive treatment is needed.\u00a0</p>\n<p>Other options:</p>\n<p>Option A:\u00a0<strong>Myotonic dystrophy</strong> is an <strong>autosomal dominant</strong>\u00a0disorder affecting multiple systems. It is associated with <strong>skeletal muscle weakness, cataracts, endocrinopathy</strong>, and <strong>cardiomyopathy.</strong></p>\n<p>Option B: A <strong>limb-girdle\u00a0dystrophy</strong> is a heterogeneous group characterized by\u00a0<strong>autosomal recessive</strong> and <strong>autosomal dominant</strong> types. It is characterized by <strong>proximal muscle weakness</strong> with variable age of onset and severity</p>\n<p>Option C: <strong>Facioscapulohumeral dystrophy</strong> is an<strong> autosomal dominant</strong> type characterized by <strong>weakness of facial muscles </strong>and <strong>shoulder girdle.\u00a0</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a marker for gastrointestinal stromal tumors?",
    "choices": [
      {
        "id": 1,
        "text": "KIT"
      },
      {
        "id": 2,
        "text": "SDH"
      },
      {
        "id": 3,
        "text": "PDGFRA"
      },
      {
        "id": 4,
        "text": "NRG-1"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>NRG-1</strong> (Neuregulin-1) is not a marker for <strong>gastrointestinal stromal tumors</strong> (GISTs).</p>\n<p><strong>GIST</strong> are the most common <strong>mesenchymal</strong> tumor of the <strong>abdomen,</strong> the <strong>stomach</strong> being the most common site. They arise from the <strong>interstitial cells</strong> of <strong>Cajal,</strong> the pacemaker cells of the GIT. GIST is seen in the <strong>5th</strong> to <strong>6th decade</strong> of life and has an <strong>equal preponderance</strong> among males and females. Most patients present with <strong>haematemesis, melena,</strong> or <strong>vague abdominal</strong> pain. The most common indications for surgery include <strong>bleeding</strong> and <strong>obstruction.</strong></p>\n<p>The GIST may occur in a <strong>sporadic</strong> form or as part of <strong>familial syndromes.</strong> In sporadic GIST, the most common mutations seen are gain-of-function mutation in KIT (75-80%) and PDGFRA mutation (8%). Microscopically, GIST has <strong>elongated spindle cells</strong> or plumper epithelioid cells, or a mixed pattern.</p>\n<p>The below image shows the microscopy of GIST composed of bundles, or fascicles, of spindle-shaped tumor cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a9bf9b67e36847358296aa149b9b4ea8x1280x1033.JPEG"
    ]
  },
  {
    "text": "Massive splenomegaly is not seen in which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Chronic myeloid leukemia"
      },
      {
        "id": 2,
        "text": "Aplastic anemia"
      },
      {
        "id": 3,
        "text": "Hairy cell leukemia"
      },
      {
        "id": 4,
        "text": "Lymphoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>All the above are associated with massive splenomegaly except <strong>aplastic anemia</strong>.</p>\n<div class=\"page\" title=\"Page 663\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Aplastic anemia</strong> is a syndrome of chronic primary <strong>hematopoietic failure</strong>. This results in <strong>pancytopenia</strong> (anemia, neutropenia, and thrombocytopenia). Important causes include\u00a0</p>\n<div class=\"page\" title=\"Page 7\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Alkylating agents, antimetabolites</li>\n<li>Benzene</li>\n<li>Whole-body irradiation</li>\n<li>Viral infections: Hepatitis (unknown virus), Cytomegalovirus, Epstein-Barr virus, Herpes zoster</li>\n<li>Fanconi anemia</li>\n</ul>\n<div class=\"page\" title=\"Page 8\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The patient will have</p>\n<ul>\n<li>Decreased red blood cells leading to\u00a0<strong>anemia</strong></li>\n<li>Decreased white blood cells leading to recurrent <strong>infections</strong></li>\n<li>Decreased platelets lead to <strong>petechiae</strong> and ecchymoses.</li>\n</ul>\n<p>Many other leukemias and lymphomas may have a similar presentation. However, <strong>splenomegaly</strong> is <strong>characteristically absent</strong> in these patients.\u00a0</p>\n<p>The bone marrow is markedly hypocellular. It is largely devoid of hematopoietic cells. Marrow aspirates yield a <strong>dry tap</strong> having <strong>only fat cells</strong>, fibrous stroma, lymphocytes, and plasma cells. Aplasia is best appreciated in <strong>marrow biopsies.\u00a0</strong>The following image shows a <strong>hypocellular bone marrow</strong> with little hematopoiesis and several fat cells.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4b4583bb82df48aaa3989ceacb840475x800x600.PNG"
    ]
  },
  {
    "text": "A child with a history of recurrent respiratory infections met with a road traffic accident and requires a blood transfusion. Immediately after starting a blood transfusion, the child develops severe anaphylactic reactions. Which of the following conditions is most likely to cause such manifestations?",
    "choices": [
      {
        "id": 1,
        "text": "Isolated IgA deficiency"
      },
      {
        "id": 2,
        "text": "Hyper IgM syndrome"
      },
      {
        "id": 3,
        "text": "DiGeorge syndrome"
      },
      {
        "id": 4,
        "text": "Bruton\u2019s Agammaglobulinemia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario of a child with recurrent respiratory infections and developing a <strong>severe anaphylactic reaction </strong>immediately after starting a blood transfusion is suggestive of<strong> Isolated IgA deficiency</strong>.</p>\n<p>Isolated IgA deficiency is the <strong>most common primary immunodeficiency disorder</strong>. Here, the B cells fail to mature into IgA plasma cells and this leads to <strong>decreased </strong>levels of <strong>IgA</strong> with <strong>normal</strong> levels of<strong> IgG </strong>and<strong> IgM</strong>. Most of the patients are asymptomatic. Symptomatic patients develop recurrent respiratory infections, diarrhoea and rarely auto-immune diseases like SLE and rheumatoid arthritis.\u00a0</p>\n<p>Patients with IgA deficiency are at <strong>risk</strong> of severe <strong>anaphylactic reactions </strong>associated with blood transfusion containing normal IgA.\u00a0<strong>IgA-deficient plasma</strong> and washed cellular blood components can be used to prevent allergic reactions in individuals with IgA Deficiency.</p>\n<p><strong>Treatment</strong> of severe anaphylaxis involves <strong>stopping </strong>the <strong>transfusion</strong>. Vascular access is maintained and administration of <strong>0.3\u20130.5 mg </strong>of <strong>adrenaline</strong> is done. Administration of steroids, antihistamine drugs, and bronchodilators are done.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Hyper IgM</strong> syndrome is due to <strong>deficient CD40L</strong> on <strong>T-cells</strong>. B-cells have CD40 on their surface which interacts with CD40L on T-cells to undergo class switching from IgM to various other classes (IgG, IgA, IgE) depending on the type of antigen. Thus, failure of this class switching leads to an increase in IgM and a decrease in other classes of antibodies. Clinically, patients present with <strong>recurrent pyogenic infections</strong>, because the level of opsonizing<strong> IgG antibodies</strong> is <strong>low</strong>.</p>\n<p>Option C: <strong>DiGeorge syndrome</strong> is caused due to <strong>deletion</strong> of <strong>chromosome 22q11</strong>. It leads to loss of T cell-mediated immunity and the characteristic features are (Mnemonic CATCH-22) <strong>Cardiac abnormality, abnormal facies, thymic aplasia, cleft palate </strong>and <strong>hypocalcemia</strong>. Absent thymus in this condition causes recurrent infections.\u00a0</p>\n<p>Option D: <strong>Bruton's X-linked agammaglobulinemia</strong> is due to a <strong>defect</strong> in <strong>Bruton tyrosine kinase (BTK)</strong>, which is required for the maturation of pre-B cells. Thus the defect leads to the arrest of maturation of pre-B cells and a decrease in the number of mature B cells. There will be <strong>decreased IgM, IgG</strong>, <strong>IgA levels</strong> leading to recurrent infections.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the following cells with their locations.",
    "choices": [
      {
        "id": 1,
        "text": "1-a, 2-b, 3-c, 4-d"
      },
      {
        "id": 2,
        "text": "1-c, 2-d, 3-a, 4-b"
      },
      {
        "id": 3,
        "text": "1-d, 2-a, 3-d, 4-c"
      },
      {
        "id": 4,
        "text": "1-b, 2-a, 3-c, 4-d"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The correctly matched set of the cells and their locations is&nbsp;1-b, 2-a, 3-c, 4-d.</p>\n<p><strong>Kupffer cells</strong> are a component of the mononuclear phagocytic system and are located in the liver.</p>\n<p>Parietal cells, also called<strong>&nbsp;oxyntic cells,</strong>&nbsp;are found in the upper half of the gastric glands.&nbsp;They have numerous<strong> mitochondria </strong>and&nbsp;are actively involved in the secretion of <strong>hydrochloric acid&nbsp;</strong>and <strong>intrinsic factor </strong>- a<strong>&nbsp;</strong>glycoprotein that aids in the absorption of vitamin B12 from the ileum.&nbsp;</p>\n<p><strong>Dust cells</strong>&nbsp;are&nbsp;<strong>macrophages</strong>&nbsp;in the walls of the alveoli. They phagocytose dust particles in the alveoli. In CHF these&nbsp;<strong>macrophages</strong>&nbsp;<strong>phagocytose erythrocytes</strong>&nbsp;that escape from the capillaries. The cells acquire a brick-red color and are called&nbsp;<strong>heart failure cells</strong>.</p>\n<p><strong>Clara cells</strong> are non-ciliated cuboidal epithelial cells that secrete important defense markers and serve as stem cells after injury. These cells make up a larger portion of the epithelial lining in the later portions of the conducting airway.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 75-year-old man presented 3 months ago with mild behavioral changes. He developed startle myoclonus and progressively worsening dementia. His condition deteriorated rapidly and the patient passed away within 2 days. On autopsy, spongiform degeneration of the brain was noted. What inclusions could also be found on histopathological examination of his brain?",
    "choices": [
      {
        "id": 1,
        "text": "PrP deposits"
      },
      {
        "id": 2,
        "text": "Alpha synuclein"
      },
      {
        "id": 3,
        "text": "Tau tangles"
      },
      {
        "id": 4,
        "text": "Polyglutamine aggregates"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This <strong>elderly</strong> man, with <strong>startle myoclonus</strong>, a <strong>rapidly progressive dementia</strong> that leads to <strong>death within 3 months</strong>, and <strong>spongiform degeneration</strong> of the <strong>brain</strong> on autopsy most likely had a diagnosis of <strong>prion disease</strong> (likely Creutzfeldt-Jakob disease or Kuru). Creutzfeldt-Jakob disease is associated with misfolded prion protein <strong>inclusions</strong> called <strong>PrP.</strong></p>\n<p>Prion disease is a <strong>rapidly progressing neurodegenerative</strong> disorder that occurs due to <strong>abnormal protein folding</strong> of prion proteins. These proteins can undergo a <strong>structural change</strong> from an alpha helix to beta-pleated sheets (PrP<sup>C\u00a0</sup>to PrPSc).\u00a0These proteins now <strong>become resistant</strong> to <strong>breakdown</strong> by normal proteases in the body and can <strong>rapidly spread</strong>, invading the central nervous system and <strong>inducing neuronal cell death</strong>. Prion diseases can be <strong>sporadic</strong> in nature, but more often they have a <strong>familial</strong> mode of spread due to mutations in the PRNP gene that codes for PrP.</p>\n<p>The brain classically undergoes <strong>spongiform degeneration</strong> due to <strong>vacuole formation</strong> and rapid death of the neurons. Histopathological examination during post-mortem can reveal inclusion such as\u00a0<strong>PrP<sup>SC\u00a0</sup>deposits</strong> and Kuru plaques.\u00a0</p>\n<p>Other options:</p>\n<p>Option B: <strong>Alpha-synuclein</strong> is commonly seen in <strong>Parkinson's disease,</strong>\u00a0which presents with an abnormal shuffling gait, resting tremors, rigidity, and bradykinesia. It can also be seen in\u00a0<strong>m</strong><strong>ultiple system atrophy</strong>\u00a0which is predominantly a disease of autonomic dysfunction. It can progress rapidly but is not associated with startle myoclonus or progressive dementia.</p>\n<p>Option C: <strong>Tau neurofibrillary tangles\u00a0</strong>are often seen in <strong>Alzheimer's</strong> disease and <strong>frontotemporal lobe degeneration</strong>. Both these conditions do not present with rapid worsening of symptoms as seen in this patient. <strong>Alzheimer's</strong> disease causes <strong>gradually progressive dementia</strong> and presents with myoclonic jerks only at later stages. <strong>Frontotemporal lobe degeneration</strong> would result in <strong>gradual behavioral changes</strong> and features of aphasia.</p>\n<p>Option D: <strong>Polyglutamate aggregates</strong> are seen in <strong>Huntington's</strong> disease. This disorder presents with a gradual onset of dementia and abnormal movements that progress to death over 20 years.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 6-year-old child presents with recurrent ear infections and a skin rash. During the workup, the finding below is seen on electron microscopy. What other marker will likely be positive in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Chromogranin"
      },
      {
        "id": 2,
        "text": "S100"
      },
      {
        "id": 3,
        "text": "Calretinin"
      },
      {
        "id": 4,
        "text": "CD117"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Birbeck granules</strong> are <strong>cytoplasmic organelles</strong> that are characteristic of <strong>Langerhans cells histioctyosis. S100</strong> is a family of proteins that are also expressed by Langerhans cells. Therefore, a patient with Birbeck granules on electron microscopy is likely to have a positive S100 test.</p>\n<p>Histopathologically, it is characterized by the presence of Langerhans cells. The tumour cells contain <strong>abundant cytoplasm with folded or grooved nuclei</strong>. Ultrastructurally, they contain <strong>tennis-racket-shaped</strong> intracytoplasmic inclusions called Birbeck granules. The tumour cells specifically express <strong>HLA-DR, S-100, </strong>and<strong> CD1a </strong>and<strong> langerin (CD207) </strong>markers.</p>\n<p>The most common gene mutated in LCH is the<strong> BRAF </strong>gene. Activation of the <strong>valine-to-glutamate</strong> substitution at residue <strong>600</strong> in BRAF gene is seen in LCH. Less common mutations have also been detected in TP53, RAS, and the receptor tyrosine kinase MET.\u00a0</p>\n<p><strong>BRAF mutations </strong>are also seen in conditions like <strong>hairy cell leukaemia, colon adenocarcinoma, melanoma, papillary thyroid carcinoma.\u00a0</strong></p>\n<p>LCH is a spectrum of clonal proliferations of <strong>immature dendritic cells</strong> called the Langerhans cells. It is characterized by single or multiple <strong>osteolytic</strong> bone lesions and can also infiltrate nearly every organ, like the skin (of the scalp), lungs, liver, spleen, bone marrow, or the central nervous system.\u00a0</p>\n<p>LCH can present as the following clinical entities: Multifocal multisystem LCH (<strong>Letterer-Siwe</strong> disease) - mostly seen in infants<br />Unifocal and multifocal unisystem LCH (<strong>eosinophilic granuloma</strong>)- The combination of bone defects, diabetes insipidus, and exophthalmos is called the <strong>Hand-Sch\u00fcller-Christian</strong> triad - mostly seen in older children, adults<br /><strong>Pulmonary LCH </strong>- mostly seen in adults</p>\n<p>Clinical features include: Often asymptomatic. Dyspnea, cough, bone pain, abnormal growth of soft tissue over the affected bone, rash, pruritus, increased thirst, and lymphadenopathy.<br />Fatigue, generalized weakness, weight loss, night sweats, nausea, and fever may also occur.</p>\n<p>Other important markers:</p>\n<ul>\n<li style=\"line-height: 1.2;\">GATA3: Primary lung adenocarcinoma, small cell carcinoma, thyroid neoplasms both primary and metaplastic</li>\n<li style=\"line-height: 1.2;\"><strong>Chromogranin</strong>: Neuroendocrine tumors <strong>(Option A)</strong></li>\n<li style=\"line-height: 1.2;\"><strong>CD117</strong>: GIST Tumors, Mast cell tumors, malignant melanoma, clear cell sarcoma <strong>(Option D)</strong></li>\n<li style=\"line-height: 1.2;\">CD1a: Histiocytosis X</li>\n<li style=\"line-height: 1.2;\"><strong>Calretinin</strong>: Adrenal cortical neoplasm, mesothelial origin tumors, sex-chord stromal tumors <strong>(Option B)</strong></li>\n<li style=\"line-height: 1.2;\">Desmin: Rhabdomyosarcoma, smooth muscle tumor</li>\n<li style=\"line-height: 1.2;\">Vimentin: Pancreatic cancer, endometrial carcinoma</li>\n<li style=\"line-height: 1.2;\">S100: Urothelial carcinoma, Melanoma, Pancreatic ductal carcinoma, Chordoma, Histocytosis X<br />\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5db862fca312475d817f65aa325d9c42.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A peripheral smear of a patient having myelodysplastic syndrome is shown below. Identify the finding.",
    "choices": [
      {
        "id": 1,
        "text": "Ringed sideroblasts"
      },
      {
        "id": 2,
        "text": "Pawn ball megakaryocytes"
      },
      {
        "id": 3,
        "text": "Pseudo pelger huet cells"
      },
      {
        "id": 4,
        "text": "Dohle bodies"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The peripheral smear shows <strong>pseudo-pledger huet cells</strong> (<strong>neutrophils</strong> with <strong>only two nuclear lobes</strong> and occasionally neutrophils that completely lack nuclear segmentation) which are seen in<strong> </strong>myelodysplastic syndrome<strong>.</strong>\u00a0</p>\n<p><strong>Myelodysplastic syndrome</strong> is a group of clonal stem cell disorders characterized by maturation defects, associated with ineffective hematopoiesis.</p>\n<p>It is of two types:</p>\n<ul>\n<li>Primary MDS - develops slowly, usually after 50 years of age.</li>\n<li>Secondary or therapy-related MDS (t-MDS) - develops 2 to 8 years after the toxic drug or radiation exposure with a poor prognosis</li>\n</ul>\n<p>Patients usually present with weakness, infections, and hemorrhages due to pancytopenia. Both types of MDS have a high risk of transformation to acute myeloid leukemia (AML). However, the most frequent and rapid transformation occurs in therapy-related MDS (t-MDS).</p>\n<p>Other options:</p>\n<p>Option A: <strong>Ringed sideroblasts</strong> are erythroblasts with <strong>iron-laden</strong> mitochondria visible as perinuclear granules in <strong>Prussian blue stain</strong>ed aspirates or biopsy.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/eff069c81d81461988d8a18c8d360589.PNG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/a25775b4073c4f32abbddcd1957a1ad2.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c2020efbddbd45948d9e52b1cee01780x720x773.PNG"
    ]
  },
  {
    "text": "A young person with recurrent seasonal conjunctivitis presents with itchiness and watering in the eyes. What is the most likely cell involved in the immediate phase of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Eosinophils"
      },
      {
        "id": 2,
        "text": "Mast cells"
      },
      {
        "id": 3,
        "text": "Neutrophils"
      },
      {
        "id": 4,
        "text": "Lymphocyte"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical features of allergic reactions suggest Type 1 hypersensitivity which is mediated by immunoglobulin E (IgE) binding to <strong>mast cells</strong>.</p>\n<p><strong>Immediate (Type I) Hypersensitivity,\u00a0</strong>also called allergic reactions or allergies\u00a0is a rapid immunologic reaction that is triggered by the binding of an antigen to an <strong>IgE antibody</strong> on the surface of <strong>mast cells. </strong>It has two phases.</p>\n<p><strong>Early phase</strong>:\u00a0The mediators produced by the <strong>mast cells</strong> are responsible for most of the immediate hypersensitivity reactions. <strong>Histamine </strong>and <strong>leukotrienes</strong> are <strong>released rapidly</strong> from the sensitized mast cells and<strong> trigger intense immediate reactions </strong>characterized by edema, mucus secretion, and smooth muscle spasm.</p>\n<p><strong>Other mediators</strong> involved in the early phase are,\u00a0</p>\n<ul>\n<li>Enzymes: neutral proteases (chymase, tryptase) and acid hydrolases</li>\n<li>Proteoglycans: heparin and chondroitin sulfate</li>\n<li>Lipid mediators: Platelet-activating factor (PAF)</li>\n</ul>\n<p><strong>Late-phase</strong>: The <strong>late-phase</strong> reaction is characterized by the <strong>recruitment of leukocytes</strong>, that <strong>amplify</strong> and <strong>sustain the inflammatory response</strong> without exposure to the triggering antigen.</p>\n<p><strong>Mediators</strong> involved in the\u00a0<strong>late phase</strong> of type 1 hypersensitivity reaction are:</p>\n<ul>\n<li>Cytokines: TNF, IL-1, IL-4, IL-5, and chemokines (eotaxin)</li>\n<li>Leukocytes (eosinophils)</li>\n<li>Major Basic Protein (MBP)</li>\n<li>Eosinophil cationic protein</li>\n</ul>\n<p>The sequence of events in immediate (type 1) hypersensitivity</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/957777893ca84d688544dd560439d13ex1280x2558.JPEG"
    ]
  },
  {
    "text": "A patient who underwent renal transplantation 8 months ago presents with pain at the site of the transplanted kidney, fever, and malaise. The renal biopsy findings of the kidney allograft are shown in the image below. Which of the following is the most likely causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Cytomegalovirus"
      },
      {
        "id": 2,
        "text": "Polyomavirus"
      },
      {
        "id": 3,
        "text": "Pneumocystits"
      },
      {
        "id": 4,
        "text": "Listeria"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical vignette of <strong>acute pyelonephritis</strong> after 8 months of kidney transplantation and the image showing enlarged tubular epithelial cells, <strong>nuclear inclusions,</strong> and <strong>interstitial inflammation</strong> suggest<strong>\u00a0nephropathy</strong>\u00a0caused by<strong> polyomavirus.</strong></p>\n<p>Polyomavirus is a viral pathogen causing <strong>pyelonephritis</strong> in kidney <strong>allografts</strong>.\u00a0Immunosuppression of the allograft recipient can lead to <strong>reactivation of latent infection</strong> by polyomavirus and the development of nephropathy. This form of pyelonephritis is referred to as <strong>polyomavirus nephropathy</strong>.</p>\n<p>Histopathology shows infection of tubular epithelial cell nuclei, leading to <strong>nuclear enlargement</strong> and <strong>intranuclear inclusions</strong> visible by light microscopy. An inflammatory interstitial inflammatory response is present.</p>\n<p>Electron microscopy shows the presence of intranuclear viral inclusions, as seen in the image below.</p>\n<p><strong>Image A</strong> shows big clusters of <strong>viral particles</strong> in the nucleus and <strong>image B</strong> shows <strong>degrading organelles:</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/376c059e6b44491dbfc4167a1acca35f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad885fa16c4941f3848f0f841aedb6c4x567x274.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8309f05ff2174661a84eea3112a89f71x1280x1891.JPEG"
    ]
  }
];
        let quizName = 'Pathology Test';
        let hierarchy = ["Marrow", "FMGE Test Series Subject", "2024"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>