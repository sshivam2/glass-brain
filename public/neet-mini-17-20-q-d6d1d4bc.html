<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neet Mini - 17 (20 Q) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "During the dissection class, a professor asks you to name the nerve that innervates the muscle labeled as A. He gives a clue that the nerve will also innervate the rhomboid minor and major. Identify the nerve.",
    "choices": [
      {
        "id": 1,
        "text": "Dorsal scapular nerve"
      },
      {
        "id": 2,
        "text": "Thoracodorsal nerve"
      },
      {
        "id": 3,
        "text": "Accessory nerve"
      },
      {
        "id": 4,
        "text": "Axillary nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Muscle A is the\u00a0<strong>levator</strong> <strong>scapulae</strong>, which is innervated by the <strong>dorsal scapular nerve. </strong>It\u00a0also supplies the rhomboid major and minor.</p>\n<p>The dorsal scapular nerve\u00a0originates from the C5 root of the brachial plexus, passes posteriorly, and often pierces the middle scalene muscle in the neck. It then travels along the medial border of the scapula and innervates the rhomboid major and minor muscles. It also innervates the levator scapulae along with branches directly from the anterior rami of the C3 and C4 spinal nerves.</p>\n<p><strong>Appendicular group of back muscles </strong>and their innervations:</p>\n<table style=\"height: 313px; width: 453px;\">\n<tbody>\n<tr>\n<td style=\"width: 138.266px;\"><strong>Muscle\u00a0</strong></td>\n<td style=\"width: 155.047px;\"><strong>Nerve Supply</strong></td>\n<td style=\"width: 137.688px;\"><strong>Action</strong></td>\n</tr>\n<tr>\n<td style=\"width: 138.266px;\">\n<p>Trapezius</p>\n</td>\n<td style=\"width: 155.047px;\">Accessory nerve</td>\n<td style=\"width: 137.688px;\">\n<div class=\"page\" title=\"Page 727\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Elevation of the scapula, rotation of scapula during abduction of humerus above horizontal; middle fibers retract scapula; lower fibers depress the scapula</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 138.266px;\">\n<p>Latissimus dorsi</p>\n</td>\n<td style=\"width: 155.047px;\">Thoracodorsal nerve</td>\n<td style=\"width: 137.688px;\">\n<div class=\"page\" title=\"Page 741\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Adduction, medial rotation, and extension of the arm at the glenohumeral joint</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 138.266px;\">\n<p><strong>Levator scapulae</strong></p>\n</td>\n<td style=\"width: 155.047px;\"><strong>Dorsal scapular nerve</strong><br />Branches directly from anterior rami of C3 and C4</td>\n<td style=\"width: 137.688px;\">\n<div class=\"page\" title=\"Page 727\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Elevation of the scapula</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 138.266px;\">\n<p><strong>Rhomboid major and minor</strong></p>\n</td>\n<td style=\"width: 155.047px;\"><strong>Dorsal scapular nerve</strong></td>\n<td style=\"width: 137.688px;\">\n<div class=\"page\" title=\"Page 727\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Elevation and retraction of the scapula</p>\n</div>\n</div>\n</div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/800ad87067d34c4582dcba987079ce08.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1cc7962a39374d419793ce26976b0c05x1280x1652.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1cffab5959c948759d1924a10e81eb3fx600x647.GIF"
    ]
  },
  {
    "text": "A 30-year-old man with a known history of bronchial asthma presented with acute breathlessness, tachycardia, and agitation. Pulse oximetry was 85% on room air. Identify the correct sequence of events that are occurring in the carotid bodies in response to the current state.",
    "choices": [
      {
        "id": 1,
        "text": "1-3-2-5-4"
      },
      {
        "id": 2,
        "text": "2-1-3-5-4"
      },
      {
        "id": 3,
        "text": "5-2-3-1-4"
      },
      {
        "id": 4,
        "text": "2-3-1-5-4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario is suggestive of acute exacerbation of bronchial asthma where the patient is hypoxic (pulse oximetry of 85%). The correct sequence regarding the <strong>response to hypoxia</strong> is&nbsp;<strong>1-3-2-5-4.</strong></p>\n<p>Type I glomus cells in the carotid and aortic bodies have <strong>O<sub>2</sub>-sensitive K<sup>+</sup> channels</strong>, which are inactivated&nbsp;in response to hypoxia.&nbsp;This <strong>reduces the K<sup>+</sup> efflux,</strong> depolarizing the cell and <strong>causing Ca<sup>2+</sup></strong> <strong>in\ufb02ux,&nbsp;</strong>via L-type voltage-gated calcium channels.&nbsp;The<strong> Ca<sup>2+</sup> influx</strong> triggers action potentials and consequent<strong> excitation of the afferent nerve endings.</strong></p>\n<div class=\"page\" title=\"Page 659\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The <strong>smooth muscle cells</strong> in the pulmonary arteries contain similar O<sub>2</sub>-sensitive K+ channels, which mediate the <strong>vasoconstriction</strong> caused by hypoxia. <strong>Systemic arteries</strong> contain <strong>ATP-sensitive K<sup>+</sup> channels</strong> that allow&nbsp;K<sup>+</sup> efflux in response to hypoxia leading to <strong>vasodilation</strong> instead of vasoconstriction.</p>\n<div class=\"page\" title=\"Page 660\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Since there is a large blood flow per unit of tissue in the carotid bodies, the O<sub>2</sub> needs of the cells are met largely by dissolved O<sub>2</sub> alone. The <strong>receptors </strong>are <strong>not stimulated</strong> in <strong>anemia</strong> or <strong>carbon monoxide poisoning</strong>, since the dissolved O<sub>2</sub> in the blood reaching the receptors is generally normal, even though the combined oxygen in the blood is decreased.</p>\n<p>The receptors are stimulated when:</p>\n<ul>\n<li>Low arterial Po2&nbsp;</li>\n<li>Vascular stasis- the amount of O<sub>2&nbsp;</sub>delivered to the receptors per unit time is decreased</li>\n<li>Cyanide - prevents O<sub>2</sub> utilization at the tissue level</li>\n<li>Nicotine in sufficient doses activates the chemoreceptors</li>\n<li>Infusion of K<sup>+</sup> increases the discharge rate in chemoreceptor afferents</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old boy is brought to the OPD by his parents. They complained that their son found climbing stairs and walking long distances difficult. His teachers also complained that his handwriting was gradually getting worse.  They found that he was getting clumsy over the past month and would mumble while talking. On examination, the doctor notices an over-arched foot, depressed deep tendon reflexes, and extensor plantar reflexes. An X-ray of the spine was ordered which showed the following image. An echocardiogram done shows an enlarged heart. What is the trinucleotide repeat associated with this disorder?",
    "choices": [
      {
        "id": 1,
        "text": "GAA"
      },
      {
        "id": 2,
        "text": "CAG"
      },
      {
        "id": 3,
        "text": "CTG"
      },
      {
        "id": 4,
        "text": "CGG"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient's clinical features showing progressive ataxia, dysarthria, clumsiness, depressed deep tendon reflexes, pes cavus, cardiomyopathy and x-ray showing scoliosis are highly suggestive of <strong>Friedreich ataxia</strong>. It is caused by an expansion of a <strong>GAA trinucleotide repeat</strong> related to chromosome 9q13.</p>\n<p>It is an\u00a0<strong>autosomal-recessive disease</strong>\u00a0with progressive ataxia, spasticity, weakness, sensory neuropathy, and cardiomyopathy.\u00a0<strong>Deep tendon reflexes are depressed or absent,</strong>\u00a0but an<strong>\u00a0extensor plantar reflex is typically present.</strong></p>\n<p>The\u00a0<strong>expansion of a GAA trinucleotide repeat </strong>on\u00a0chromosome 9q13, encodes frataxin, a protein found in the mitochondrial inner membrane where it is involved in the assembly of iron-sulfur cluster enzymes of complex I and II. Affected individuals have extremely low levels of protein.</p>\n<p>Patients become wheelchair-bound within 5 years of onset and the life expectancy is up to 40-50 years of age. Cardiomyopathy is associated with arrhythmias and congestive heart failure which eventually contributes to the affected individual's death</p>\n<p>Other trinucleotide repeat disorders:</p>\n<p>\u00a0</p>\n<table style=\"height: 697px; width: 401px;\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 141px; height: 18px;\"><strong>Disease</strong></td>\n<td style=\"width: 83px; height: 18px;\"><strong>Repeats</strong></td>\n<td style=\"width: 155px; height: 18px;\">Clinical features</td>\n</tr>\n<tr style=\"height: 91px;\">\n<td style=\"width: 141px; height: 91px;\"><strong>Fragile X- syndrome</strong></td>\n<td style=\"width: 83px; height: 91px;\">\u00a0 <strong>CGG</strong></td>\n<td style=\"width: 155px; height: 91px;\">Mental retardation, large ears,\u00a0and jaws, macroorchidism in males</td>\n</tr>\n<tr style=\"height: 107.2px;\">\n<td style=\"width: 141px; height: 107.2px;\">\n<p>Myotonic Dystrophy</p>\n<p>(<strong>chromosome 19)</strong></p>\n</td>\n<td style=\"width: 83px; height: 107.2px;\">\u00a0 CTG</td>\n<td style=\"width: 155px; height: 107.2px;\">Muscle loss, cardiac arrhythmia,<br /><strong>cataracts</strong>, endocrinopathy</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 141px; height: 36px;\"><strong>Huntington\u2019s disease</strong></td>\n<td style=\"width: 83px; height: 36px;\">\u00a0 <strong>CAG</strong></td>\n<td style=\"width: 155px; height: 36px;\">Choreoathetosis, cognitive and affective dysfunction</td>\n</tr>\n<tr style=\"height: 72px;\">\n<td style=\"width: 141px; height: 72px;\">Spinocerebellar ataxia type 1</td>\n<td style=\"width: 83px; height: 72px;\">\u00a0 CAG</td>\n<td style=\"width: 155px; height: 72px;\">Progressive ataxia, dysarthria,<br />dysmetria.</td>\n</tr>\n<tr style=\"height: 91px;\">\n<td style=\"width: 141px; height: 91px;\"><strong>Friedreich's ataxia</strong></td>\n<td style=\"width: 83px; height: 91px;\">\u00a0 <strong>GAA</strong></td>\n<td style=\"width: 155px; height: 91px;\">Progressive ataxia,<br />dysarthria, hypertrophic<br />cardiomyopathy.</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cb3ef0e63fc44130b46934e97edd175e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following diseases is not caused by pseudomonas aeroginosa?",
    "choices": [
      {
        "id": 1,
        "text": "Scromboid poisoning"
      },
      {
        "id": 2,
        "text": "Jacuzzi syndrome"
      },
      {
        "id": 3,
        "text": "Glanders disease"
      },
      {
        "id": 4,
        "text": "Shanghai fever"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Glanders disease is not caused by pseudomonas. Causative organism for Glander\u2019s disease is Burkholderia Mallei.</p>\n<p>Diseases caused by Pseudomonas aeruginosa:</p>\n<ul>\n<li>Shanghai fever: self-limited febrile illness</li>\n<li>Jacuzzi syndrome (<strong>Hot tub folliculitis</strong>/<strong>Pseudomonas aeruginosa folliculitis</strong>) is a common type of folliculitis, which causes\u00a0<strong>inflammation of hair follicles.</strong></li>\n<li>Scromboid poisoning: It is one of the most common causes of morbidity associated with fish intake which have not been refrigerated properly from the time they were caught until the time they were served. Bacteria act on compounds in the fish, releasing histamine. Process is induced by enzymes produced by primarily enteric gram-negative bacteria (e.g., Morganella morganii, Escherichia coli, Klebsiella species and Pseudomonas aeruginosa) found in the fish's cutis and intestines.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old man, who is a bachelor, living alone in a rented home is brought to the casualty. His initial symptoms included nausea, vomiting, abdominal distension and pain. Later his symptoms progressed to dry mouth, dysarthria, blurring of vision and muscle weakness. It is found that he might have consumed expired food from the containers found in his house, as shown below. Considering the suspected diagnosis, what specific category of treatment would you consider as appropriate in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Immunosuppressant"
      },
      {
        "id": 2,
        "text": "Antibacterial"
      },
      {
        "id": 3,
        "text": "Vaccination"
      },
      {
        "id": 4,
        "text": "Antitoxin"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The characteristic clinical history along with canned food shown in the image is suggestive of\u00a0<strong>foodborne botulism</strong>\u00a0caused by <strong>Clostridium botulinum.\u00a0</strong>It is treated with\u00a0Botulinum<strong> antitoxin</strong> one vial by slow IV\u00a0in normal saline and one vial IM and repeated at 2 to 4-hour intervals IV.\u00a0</p>\n<p><strong>Clostridium botulinum</strong>\u00a0toxin\u00a0<strong>types A, B, E</strong>\u00a0cause disease in\u00a0<strong>humans.\u00a0</strong>Type<strong> E</strong> is often associated with fish and other seafood. It multiplies in the food, e.g., sausages, <strong>tinned meat, fish, fruits</strong>, etc. before it is consumed, and produces a powerful exotoxin under suitable anaerobic conditions. The fatal dose for an adult is 0.01 mg. or even less.\u00a0</p>\n<p>Symptoms usually begin<strong> 12-36 hours</strong> after ingestion.\u00a0m. The initial GI symptoms include nausea, vomiting, abdominal distension, and pain. Later symptoms are dry or sore mouth or throat, difficulty with visual accommodation,\u00a0<strong>dysphonia, diplopia, ptosis, dysarthria</strong>, blurring of vision, muscle weakness, descending bilaterally symmetrical motor paralysis initiated by abducent (VI) or oculomotor (III) nerve palsy, dysphagia, constipation, respiratory insufficiency, and urinary retention. The patient is conscious until death, which is preceded by coma or delirium.</p>\n<p>All the pathogenic effects are caused by a powerful exotoxin produced by the organism.<strong> Botulinum toxin</strong>\u00a0acts by\u00a0<strong>blocking the production</strong>\u00a0and\u00a0<strong>release of acetylcholine</strong>\u00a0at the synapses and neuromuscular junction.</p>\n<p><strong>Site of action:</strong>\u00a0neuromuscular junctions, postganglionic parasympathetic nerve endings, and peripheral ganglia.</p>\n<p>Clinical use :</p>\n<ul>\n<li>It is used in the\u00a0treatment\u00a0of neuromuscular disorders like\u00a0<strong>strabismus,\u00a0blepharospasm,\u00a0wrinkle,\u00a0myoclonus</strong>\u00a0(since botulism toxin produces flaccid paralysis).</li>\n<li>The action is\u00a0short-lasting\u00a0and recovery occurs in 2-4 months once the new terminal axon sprouts form and restore transmission.</li>\n<li>Blocking of acetylcholine release\u00a0from nerve terminal is\u00a0permanent\u00a0and recovery occurs only by sprouting of new nerve<br />terminals.</li>\n</ul>\n<p>At autopsy, the kidneys, liver, and meninges are congested. Histological examination of the organs may show thrombosis.</p>\n<p>Treatment:</p>\n<ul>\n<li>Gastric lavage or emesis.</li>\n<li>Activated charcoal.</li>\n<li>Purgative (sorbitol).\u00a0</li>\n<li>Whole bowel irrigation.</li>\n<li>Botulinum<strong> antitoxin</strong> (types A, B and E) one vial (50,000 to 1,00,000 units) by slow i.v. in normal saline and one vial i.m., and repeated at 2 to 4-hour intervals i.v.\u00a0</li>\n<li>Botulism immune globulin (BIG) is a pentavalent types A, B, C, D, and E. 50 ml is given i.v. daily, till the patient recovers.</li>\n<li>Guanidine 15 to 40 mg/kg/day orally. It reverses the neuromuscular block of botulism.</li>\n<li>Adequate respiration.</li>\n<li>Alcohol precipitates toxin; frequent small doses of brandy are beneficial.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/923c62d8fb1f410aa292104f3ab87af9.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 14-year-old female patient presents to your clinic with nasal obstruction. Physical examination revealed a wide, roomy nasal cavity, a pale nasal mucosa and greyish-black dry crusts that improved after modified Young's procedure. Identify the clinical feature likely to be associated with this condition.",
    "choices": [
      {
        "id": 1,
        "text": "Offensive cheesy discharge"
      },
      {
        "id": 2,
        "text": "Merciful anosmia"
      },
      {
        "id": 3,
        "text": "Paroxysmal sneezing"
      },
      {
        "id": 4,
        "text": "Allergic salute"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of <strong>atrophic rhinitis,&nbsp;</strong>and <strong>merciful anosmia</strong> is&nbsp;associated with this condition. Merciful anosmia is when the patient has <strong>marked anosmia</strong> and is unable to smell the <strong>foul odor</strong>&nbsp;coming from their nose.</p>\n<p>Atrophic rhinitis is a chronic inflammation of the nose characterized by atrophy of the nasal mucosa and turbinate bones. It is more common in <strong>females</strong> and starts around <strong>puberty</strong>. The patient presents&nbsp;with&nbsp;<strong>n</strong><strong>asal</strong>&nbsp;<strong>obstruction</strong>&nbsp;in spite of <strong>roomy chambers</strong>. It is associated with&nbsp;<strong>foul odor</strong>&nbsp;from their nose but the patient is unable to smell it because of&nbsp;<strong>merciful anosmia.</strong>&nbsp;Anosmia due to degeneration of nerve elements. On examination nasal mucosa appears&nbsp;<strong>pale, </strong>greenish or <strong>greyish black dry crusts</strong> covering the turbinates and septum.&nbsp;</p>\n<p><strong>Medical managemen</strong>t is done using warm saline for <strong>nasal irrigation</strong>, removal of crusts&nbsp;and administering local antibiotics like <strong>kemicetine antiozaena solution</strong>(containing chloromycetin, oestradiol, and vitamin D2).</p>\n<p>Surgical&nbsp;management involves:</p>\n<ul>\n<li>In<strong> Young's operation,</strong>&nbsp;both the nostrils are closed completely by raising flaps within the nasal vestibule. They are opened after 6 months and during this time, the mucosa comes back to normal and the crusting is reduced.</li>\n<li><strong>Modified young operation</strong>&nbsp;is a modified version of Young's operation where the <strong>nostrils</strong> are only&nbsp;<strong>partially closed.&nbsp;</strong>The results are the same compared to Young's operation and it is done to avoid discomfort from complete closure of the nostrils.&nbsp;</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Offensive cheesy discharge</strong> is seen in an uncommon condition called <strong>rhinitis caseosa</strong>. It is usually unilateral and affects males.&nbsp;The disease arises from chronic sinusitis with the collection of inspissated cheesy material.</p>\n<p>Option C: <strong>Paroxysmal sneezing</strong> refers to bouts of sneezing in the morning and is associated with <strong>allergic rhinitis</strong> and&nbsp;<strong>vasomotor rhinitis.&nbsp;</strong></p>\n<p>Option D:<strong> Allergic salute</strong> is the constant upward rubbing motion of the nose simulating a salute, leading to transverse nasal crease across the dorsum of the nose. Seen in <strong>allergic rhinitis.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A study to determine the association between maternal smoking during pregnancy and low birth weight is being carried out. It involves obtaining smoking histories from pregnant women during their antenatal visits and then subsequently assessing the birth weight of their babies soon after delivery. What type of study is this?",
    "choices": [
      {
        "id": 1,
        "text": "Prospective cohort"
      },
      {
        "id": 2,
        "text": "Retrospective cohort"
      },
      {
        "id": 3,
        "text": "Case control"
      },
      {
        "id": 4,
        "text": "Cross sectional"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">The study of choice is </span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>a prospective cohort study.\u00a0</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">This study is a prospective cohort study because the subjects (pregnant women) were categorized on the basis of exposure or lack of exposure to a risk factor -smoking during pregnancy. They were followed to determine if the outcome, the low birth weight of the babies occurred or not.</span></div>\n<div>\u00a0</div>\n<div><strong>A prospective cohort study</strong> is a study in which the <strong>outcome has not yet occurred</strong> at the time that the investigations begin. They <strong>begin</strong> in the <strong>present</strong> and <strong>continue</strong> into the <strong>future</strong>. The design of a prospective cohort is shown below.</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8f391022577a432882f37243dae2c1d4x720x743.JPEG"
    ]
  },
  {
    "text": "Which of the following conditions show \u201cMaltese cross\u201d appearance of urinary casts under polarized light?",
    "choices": [
      {
        "id": 1,
        "text": "Nephritic syndrome"
      },
      {
        "id": 2,
        "text": "Fabry\u2019s disease"
      },
      {
        "id": 3,
        "text": "Chronic renal failure"
      },
      {
        "id": 4,
        "text": "Acute tubular necrosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Urine analysis in <strong>Fabry&rsquo;s disease</strong> may reveal oval fat bodies and birefringent glycolipid globules under polarized light showing a \"Maltese cross&rdquo; appearance. It can also be seen in <strong>nephrotic syndrome</strong>.</p>\n<p>Interpretation of casts in urine:</p>\n<ul>\n<li>Hyaline casts: Physiological, concentrated urine, fever, exercise</li>\n<li>Red blood cell casts: Glomerular causes</li>\n<li>White blood cells casts: Pyelonephritis, interstitial nephritis</li>\n<li>Muddy brown casts: Acute tubular necrosis, interstitial nephritis</li>\n<li>Fatty casts: Heavy proteinuria</li>\n<li>Broad casts: Chronic renal failure</li>\n</ul>\n<p>Maltese cross appearance elsewhere:</p>\n<ul>\n<li>Short-range shotgun wound</li>\n<li>Babesiosis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 48-year-old patient presented with scrotal swelling. Following orchidectomy, the following histological picture was observed. Which of the following tumor markers would not have been elevated in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Placental alkaline phosphatase"
      },
      {
        "id": 2,
        "text": "\u00df-Human chorionic gonadotropin"
      },
      {
        "id": 3,
        "text": "Alpha-fetoprotein"
      },
      {
        "id": 4,
        "text": "Lactate dehydrogenase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The history and the given histology picture (fried-egg appearance) are highly suggestive of <strong>testicular seminoma. </strong></p>\n<p><strong>Alpha-fetoprotein (AFP)</strong> is never raised in pure seminomas.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/eb1f92f587764346b48f9e0750454e4a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 48-year-old woman came with complaints of post-menopausal bleed. She is a known diabetic and hypertensive for the past 15 years. She was diagnosed to have endometrial carcinoma. Which among the following is the gold standard investigation in staging endometrial carcinoma?",
    "choices": [
      {
        "id": 1,
        "text": "MRI"
      },
      {
        "id": 2,
        "text": "Surgery"
      },
      {
        "id": 3,
        "text": "Endometrial biopsy"
      },
      {
        "id": 4,
        "text": "PET-CT"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Surgery</strong> is the gold standard investigation for staging endometrial carcinoma.</p>\n<p>Endometrial carcinoma is surgically staged according to the Joint 2010 International Federation of Gynecology and Obstetrics&nbsp;<span class=\"nowrap\">(<strong>FIGO</strong>)/TNM</span>&nbsp;classification system.</p>\n<p>Total extra-fascial hysterectomy with bilateral salpingo-oophorectomy and pelvic and para-aortic lymph node dissection is the standard staging procedure for endometrial carcinoma.&nbsp;</p>\n<p>When a patient is staged only clinically, contrast-enhanced magnetic resonance imaging (MRI) appears to be the best radiographic modality for detecting myometrial invasion or cervical involvement.</p>\n<p>Hysteroscopy and biopsy visualizes the entire uterine lining and select biopsy from suspicious areas; both reduce the chances of missing the lesion. Even then, this is not 100% predictive, as an early lesion can be missed.</p>\n<p>Recently, the concern has been raised regarding the&nbsp;spilling of cancer cells into the peritoneal cavity during hysteroscopy.</p>\n<p>PET&ndash;CT reveals metabolic activity in the tissue and is highly sensitive and specific for detecting positive pelvic and/or para-aortic lymphadenopathy as well as distant metastases in selected high-risk patients with endometrial cancer.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Unconjugated hyperbilirubinemia, which did not subside even after 3 weeks of birth, was observed in a neonate. On investigating, liver enzymes, PT/INR and albumin levels were normal. No hemolysis was seen on a peripheral blood smear. A drop in bilirubin level was observed within a week after treating with phenobarbital. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rotor syndrome"
      },
      {
        "id": 2,
        "text": "Crigler Najjar type 2"
      },
      {
        "id": 3,
        "text": "Dubin Johnson syndrome"
      },
      {
        "id": 4,
        "text": "Crigler Najjar type 1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Jaundice persisiting <strong>3 weeks after birth</strong> is suggestive of&nbsp;<strong>pathological jaundice</strong>. Among the given options,&nbsp;<strong>Crigler Najjar type</strong>&nbsp;<strong>2&nbsp;</strong>presents with&nbsp;<strong>unconjugated</strong> hyperbilirubinemia which <strong>responds</strong> to&nbsp;<strong>p</strong><strong>henobarbital therapy</strong>.<strong>&nbsp;</strong>&nbsp;</p>\n<p><strong>Dubin Johnson</strong> (option C) and <strong>Rotor&nbsp;</strong>(option A) syndromes lead to <strong>conjugated hyperbilirubinemia</strong>.&nbsp;</p>\n<p><span class=\"fontstyle0\">Crigler Najjar type 2 is an <strong>autosomal recessive</strong> disease with <strong>non-hemolytic</strong>, <strong>unconjugated</strong> hyperbilirubinemia caused by homozygous missense mutations in the enzyme UDP <strong>UGT1A1</strong>&nbsp;resulting in reduced (partial) enzymatic activity.</span></p>\n<p>The differences between Crigler-Najjar type 1 and type 2 are described in the table below:</p>\n<table>\n<tbody>\n<tr>\n<td style=\"text-align: center;\"><strong>Crigler Najjar Type 1</strong></td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\"><strong>Crigler Najjar Type 2</strong></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">Autosomal recessive</td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">Autosomal recessive</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">UDPGT is <strong>absent</strong></td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">UDPGT is <strong>reduced</strong></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">Severe unconjugated hyperbilirubinemia</td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">Less severe</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">Pale stools</td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">Normal-coloured stools</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\">May proceed to <strong>kernicterus&nbsp;</strong>and <strong>does not</strong><strong>&nbsp;respond to phenobarbitone</strong></td>\n<td style=\"text-align: center;\">&nbsp;</td>\n<td style=\"text-align: center;\">Does not proceed to kernicterus and <strong>is responsive to phenobarbitone</strong></td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During a preoperative anesthetic evaluation, pharmacologic stress echocardiography is being undertaken for a patient with chronic pulmonary disease. Which of the following agents can be used for inducing pharmacological stress in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Dipyridamole"
      },
      {
        "id": 2,
        "text": "Dobutamine"
      },
      {
        "id": 3,
        "text": "Adenosine"
      },
      {
        "id": 4,
        "text": "Regadenoson"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 1280\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Dobutamine</strong> can be used for the induction of pharmacological stress in a patient with <strong>chronic pulmonary disease</strong>.</p>\n<p><strong>Dobutamine</strong> is a potent <strong>&beta;-receptor agonist</strong> used for stress testing. It increases myocardial oxygen demand by&nbsp;<strong>increasing</strong>&nbsp;<strong>contractility</strong>,&nbsp;<strong>heart</strong>&nbsp;<strong>rate</strong>, and&nbsp;<strong>blood pressure</strong>&nbsp;in a similar manner as exercise.&nbsp;<strong>Dobutamine stress testing&nbsp;</strong>is the preferred choice for the assessment of myocardial viability and is generally used as an alternative to vasodilator stress in patients with <strong>chronic pulmonary disease</strong>, where vasodilators are contraindicated.&nbsp;&nbsp;</p>\n<div class=\"page\" title=\"Page 1731\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Cardiac stress testing is performed in patients with <strong>known</strong> or <strong>suspected</strong> <strong>coronary artery disease</strong>. It is also done for <strong>preoperative CVS monitoring</strong> in a patient with risk factors for myocardial infarction. Generally, <strong>exercise stress</strong> <strong>testing</strong> is <strong>preferred</strong> because it provides information on functional capacity, exercise tolerance, and symptom provocation. However, some patients undergo pharmacologic stress testing.&nbsp;<strong>Indications</strong> for<strong> pharmacologic stress testing</strong> include:&nbsp;</p>\n<ul>\n<li>Unstable angina</li>\n<li>Inability to exercise</li>\n<li>History of uncontrolled heart failure at risk for deterioration</li>\n<li>Poorly controlled blood pressure</li>\n<li>History of aortic stenosis</li>\n<li>Recent myocardial infarction</li>\n<li>Acute pulmonary embolism</li>\n<li>Acute pericarditis or myocarditis</li>\n<li>Severe pulmonary hypertension</li>\n<li>Chronic pulmonary disease</li>\n</ul>\n<div class=\"page\" title=\"Page 1731\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 1731\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Vasodilators</strong> are the <strong>most commonly</strong> used pharmacologic stressors for myocardial perfusion imaging. Vasodilator stress acts by increasing and diverting blood flow to the non-diseased blood vessels so that the diseased vessels can be visualized clearly. It is brought about by drugs such as adenosine, dipyridamole, and regadenoson.</p>\n<p>Contraindications to vasodilator stress testing are:</p>\n<ul>\n<li>Pronounced active bronchospastic airway disease</li>\n<li>Significant hypotension</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man met with an accident and fell with his hand in dorsiflexion. On examination, there is swelling and tenderness around the wrist joint. The X-ray shown below confirmed the diagnosis, following which Tavernier's maneuver successfully corrected the condition. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Perilunate dislocation"
      },
      {
        "id": 2,
        "text": "Lunate dislocation"
      },
      {
        "id": 3,
        "text": "Scapholunate dislocation"
      },
      {
        "id": 4,
        "text": "Lunotriquetral dislocation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical history and treatment with <strong>Tavernier's maneuver</strong> point to a <strong>perilunate dislocation</strong>.</p>\n<p>The <strong>X-ray</strong> of&nbsp;<strong>perilunate dislocation </strong>shows&nbsp;the <strong>lunate</strong> maintaining its <strong>normal</strong> articulation with the radius, whereas other <strong>carpal bones</strong> have <strong>dislocated</strong> from the lunate <strong>dorsally.&nbsp;</strong>It is frequently associated with <strong>compression</strong> of the <strong>median nerve.</strong>&nbsp;</p>\n<p>Prompt reduction reduces swelling and potential damage to the median nerve. The most commonly used method of <strong>closed reduction</strong> is the <strong>Tavernier maneuver.</strong> It consists of locking the capitate into the distal concavity of the lunate. When the injury cannot be reduced this way, urgent reduction in theatre should be done.</p>\n<p>In<strong>&nbsp;lunate dislocation</strong>, the lunate dislocates anteriorly and the rest of the carpal bones remain in place.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b4b8aa0badf847a2abbcc53694cd63cd.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17e5ea0aa31f431fbdc0da6820aa23b6x1280x2089.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/735921856e184784bd415d125a2cd187x501x521.PNG"
    ]
  },
  {
    "text": "USG mode used in echocardiography is _______",
    "choices": [
      {
        "id": 1,
        "text": "A mode"
      },
      {
        "id": 2,
        "text": "B mode"
      },
      {
        "id": 3,
        "text": "M mode"
      },
      {
        "id": 4,
        "text": "C mode"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>M-mode USG</strong> is used for <strong>echocardiography.</strong></p>\n<p>The echo intensity is displayed as brightness and the trace is swept across the screen so that the x-axis represents time.</p>\n<p>Modes in USG:</p>\n<ul>\n<li><strong>A</strong> mode &ndash; <strong>A</strong>mplitude mode - Used in Ophthalmology and orbital biometry&nbsp;</li>\n<li>B mode/ Grayscale used for all routine application</li>\n<li><strong>M</strong> mode &ndash; Echocardiography (<strong>M</strong>otion)</li>\n</ul>\n<p>Advantage of USG &ndash; No radiation and is portable</p>\n<p>The disadvantage of USG &ndash; operator dependence</p>\n<p><strong>USG has preferred investigation for</strong>:</p>\n<ul>\n<li>Gall bladder pathology</li>\n<li>Cyst</li>\n<li>Fluid collection like ascites, pleural effusion, and pericardial effusion</li>\n<li>Initial evaluation of jaundice</li>\n<li>USG is the <strong>safest</strong> radiological investigation for <strong>pregnant</strong> female</li>\n</ul>\n<p><strong>Therapeutic application of USG</strong> &ndash; <strong>HIFU </strong>(high intensity focussed USG) useful for the treatment of <strong>fibroid</strong>. HIFU exploits the thermal effects of high powered ultrasound beams that are tightly focused so that very small target tissue can be heated and coagulated.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/75472a992cc6482ba01446db0a615cfex720x547.JPEG"
    ]
  },
  {
    "text": "An IT employee is feeling guilty, hopeless, and not able to concentrate on work. His symptoms started 3 years back when he entered college. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Depressive disorder"
      },
      {
        "id": 2,
        "text": "Dysthymia"
      },
      {
        "id": 3,
        "text": "Adjustment disorder"
      },
      {
        "id": 4,
        "text": "Cyclothymic disorder"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The given clinical scenario of guilt, hopelessness, and difficulty in concentrating over a period of <strong>more than 2 years</strong>, is suggestive of <strong>dysthymia (persistent depressive disorder)</strong>.</p>\n<p>The DSM 5 and ICD-11 criteria for diagnosis of dysthymia:&nbsp;</p>\n<p>A. Depressed mood for most of the day as indicated by either subjective account or observation by others, for at&nbsp;<strong>least 2 years</strong>. In children and adolescents at&nbsp;least 1 year.</p>\n<p>B. Presence&nbsp;of<strong>&nbsp;two (or more)</strong>&nbsp;of the following while being depressed.</p>\n<ol>\n<li>Poor appetite or overeating</li>\n<li>Insomnia or hypersomnia</li>\n<li>Low energy or fatigue</li>\n<li>Low self-esteem</li>\n<li>Poor concentration and/or difficulty making decisions</li>\n<li>Feelings of hopelessness</li>\n</ol>\n<div class=\"page\" title=\"Page 212\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>C. During the 2-year period (1 year for children or adolescents) of the disturbance, the individ&shy;ual has never been without the symptoms in criteria A and B for more than 2 months at a time.</p>\n<p>D. Criteria for a major depressive disorder may be continuously present for 2 years.</p>\n<p>E. There has never been a manic episode or a hypomanic episode, and criteria have never been met for cyclothymic disorder.</p>\n<p>F. The disturbance is not better explained by a persistent schizoaffective disorder, schizophrenia, delusional disorder, or other specified or unspecified schizophrenia spectrum and other psychotic disorders.</p>\n<p>G. The symptoms are not attributable to the physiological effects of a substance (e.g., a drug of abuse, a medication) or another medical condition (e.g. hypothyroidism).</p>\n<p>H. The symptoms cause clinically significant distress or impairment in social, occupational, or other important areas of functioning.</p>\n</div>\n</div>\n</div>\n<p>Option C:&nbsp;<strong>Adjustment disorder </strong>is characterized by emotional or behavioral symptoms that develop&nbsp;<strong>within 3 months of exposure</strong>&nbsp;to an identifiable stressor and usually&nbsp;<strong>do not last more than 6 months</strong>&nbsp;after the stressor ends.</p>\n<p>Option D: <strong>Cyclothymic disorder&nbsp;</strong>is symptomatically a mild form of bipolar II disorder, characterized by episodes of <strong>hypomania</strong> and <strong>mild depression</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "On applying firm sliding pressure on unblistered skin in a bullous eruption, the epidermis gets separated from the dermis in some conditions, as shown in the image given below. In which of the following conditions is this sign not seen?",
    "choices": [
      {
        "id": 1,
        "text": "Staphylococcal scalded skin syndrome"
      },
      {
        "id": 2,
        "text": "Pemphigus foliaceus"
      },
      {
        "id": 3,
        "text": "Pemphigus vulgaris"
      },
      {
        "id": 4,
        "text": "Epidermolysis bullosa simplex"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The sign shown in the image, which is elicited by applying firm tangential sliding pressure with a finger on lesional or perilesional skin is called\u00a0<strong>Nikolsky's sign</strong><strong>.\u00a0</strong>This sign is not elicited\u00a0in epidermolysis bullosa simplex.</p>\n<p><strong>In Nikolsky's sign,</strong>\u00a0a tangential/lateral pressure applied on the <strong>affected</strong>, <strong>perilesional</strong> or<strong> normal</strong> skin around the blister, results in <strong>separation</strong> between the upper and lower layers of the epidermis, producing an <strong>erosion</strong>. It is <strong>positive</strong> when there is <strong>extension</strong> of the blister with or without <strong>removal</strong> of epidermis in the tested area. This is because the underlying pathology is common to the affected as well as the normal skin.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/166e514afd1e45c8aef710d1e2d5167a.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f0ca4046f35d411ea876d133981dc82dx1280x1103.JPEG"
    ]
  },
  {
    "text": "A young man presents with diarrhea and abdominal pain. There is a rash around his neck as shown in the image below. He follows a maize-based diet. Which of the following is measured for the diagnosis of his condition?",
    "choices": [
      {
        "id": 1,
        "text": "2-methyl nicotinamide"
      },
      {
        "id": 2,
        "text": "Riboflavin levels"
      },
      {
        "id": 3,
        "text": "RBC glutathione reductase"
      },
      {
        "id": 4,
        "text": "Transketolase activity"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario along with the image showing\u00a0<strong>Casal\u2019s necklace\u00a0</strong>around the neck is suggestive of <strong>pellagra\u00a0</strong>(niacin or vitamin B3 deficiency). <strong>2-methyl nicotinamide</strong>\u00a0is measured for the diagnosis of this condition.\u00a0</p>\n<p><strong>Niacin</strong> is a nutrient that is synthesized in the body from <strong>tryptophan</strong>. The term niacin represents two compounds<strong> nicotinic acid</strong>\u00a0and <strong>nicotinamide</strong>.\u00a0It acts as a<strong> precursor</strong> for the <strong>coenzymes NAD</strong> and <strong>NADP</strong>, which are important in various oxidation and reduction reactions.</p>\n<p><strong>Niacin</strong> deficiency causes <strong>pellagra.</strong> It is usually seen in individuals with a<strong> corn</strong>/\u00a0<strong>maize-based staple diet</strong>, a history of alcohol consumption, Hartnup disease, and carcinoid syndrome.\u00a0</p>\n<p>The primary manifestations of pellagra are often referred to as the<strong> 4 Ds</strong>: <strong>diarrhea</strong>, <strong>dermatitis</strong>, <strong>dementia</strong>, leading to<strong>\u00a0death</strong>. Other manifestations\u00a0include:\u00a0</p>\n<ul>\n<li><strong>Abdominal pain</strong>,<strong> loss of appetite</strong></li>\n<li>Bright red glossitis</li>\n<li>Generalized weakness, irritability</li>\n<li><strong>Casal\u2019s necklace</strong> - pigmented scaly skin rash around the neck.</li>\n</ul>\n<p>It is diagnosed by measuring <strong>urinary levels</strong> of\u00a0<strong>2-methyl nicotinamide</strong> and 2-pyridone. Treatment is oral supplementation of\u00a0<strong>100\u2013200 mg</strong> of <strong>nicotinamide</strong> or <strong>nicotinic acid</strong> three times daily for 5 days.</p>\n<p>Other options:</p>\n<p>Options B and C: Red blood cell or urinary <strong>riboflavin</strong> concentrations and RBC <strong>glutathione reductase activity</strong> measurement are used in the laboratory diagnosis of <strong>riboflavin deficiency</strong> (vitamin B2 deficiency).</p>\n<p>Option D: Functional enzymatic assay of <strong>transketolase activity</strong> measured before and after the addition of thiamine pyrophosphate is used to diagnose <strong>thiamine deficiency</strong> (vitamin B1 deficiency).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0f2ae3babd924b63b6fc170ea5c2f983.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following visual field defects demonstrates a lesion in the optic radiation in the temporal lobe?",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "3"
      },
      {
        "id": 3,
        "text": "2"
      },
      {
        "id": 4,
        "text": "1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Image 3 </strong>(Superior quadrantanopia) demonstrates a lesion in the optic radiation in the temporal lobe.</p>\n<p><strong>Superior quadrantanopia</strong>\u00a0in image 3 (<strong>pie in the\u00a0sky</strong>) is seen in patients who have an <strong>injury</strong> to the<strong> optic radiations</strong>, which pass through the <strong>temporal</strong>\u00a0<strong>lobe</strong>. They are also known as <strong>Meyer\u2019s loop.</strong></p>\n<p>Image 1: <strong>Bilateral hemianopia</strong> occurs due to a defect in the optic tract.</p>\n<p>Image 2: <strong>Inferior quadrantic</strong> <strong>hemianopia</strong> (<strong>pie on the floor</strong>) defect is due to the involvement of <strong>superior fibers</strong> of the optic radiations \u2013 <strong>Baum\u2019s loop</strong>. It is seen in <strong>parietal lobe</strong> lesions.</p>\n<p>Image 4: <strong>Right contralateral homonymous hemianopia</strong> with <strong>macular sparing</strong> occurs due to a defect in the<strong> visual cortex</strong> in the <strong>occipital lobe</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7e6308d151684f668829a99071957caa.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old patient presents to the emergency room with intermittent palpitations, headache, and sweating. There have been multiple such episodes in the past. During these episodes, his blood pressure is found to be elevated. Ultrasonography reveals a suprarenal mass and elevated 24-hour urinary metanephrine. What is the next best step in the clinical management of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Perform an MRI scan"
      },
      {
        "id": 2,
        "text": "Laparoscopic resection"
      },
      {
        "id": 3,
        "text": "Contrast enhanced CT scan"
      },
      {
        "id": 4,
        "text": "123 Iodine-MIBG scan"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical vignette with&nbsp;<strong>elevated 24-hour urinary metanephrine&nbsp;</strong>is suggestive of&nbsp;<strong>pheochromocytoma.&nbsp;</strong>The next step is&nbsp;an<strong> MRI to localize the site of the tumor.</strong></p>\n<p>MRI is preferred for the localization of pathologies because contrast media used for <strong>CT scans can provoke paroxysms.</strong>&nbsp;Also, with the MRI, exposure to radiation is reduced in the case of children and pregnant women. Classically, pheochromocytomas show a<strong> &lsquo;Swiss cheese&rsquo;</strong> configuration.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cec3ad367515481980712c01c1b4688ex512x318.PNG"
    ]
  },
  {
    "text": "Which of the following is not a prokinetic?",
    "choices": [
      {
        "id": 1,
        "text": "5HT4 agonist"
      },
      {
        "id": 2,
        "text": "Dopamine antagonist"
      },
      {
        "id": 3,
        "text": "Motilin"
      },
      {
        "id": 4,
        "text": "Diphenylmethane"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Diphenylmethane</strong> is not a prokinetic agent. Its derivative (Bisacodyl) is used as a <strong>laxative.</strong></p>\n<p><strong>Prokinetic</strong> agents<strong>&nbsp;</strong>are the drugs that <strong>increase GI motility</strong> and transit of material in the GI tract. These&nbsp;agents include:</p>\n<ul>\n<li>Dopamine receptor antagonists- <strong>metoclopramide</strong> and <strong>domperidone</strong></li>\n<li>Serotonin receptor agonists- <strong>cisapride</strong> and prucalopride</li>\n<li><strong>Motilin</strong></li>\n<li>Macrolide antibiotics mimicking motilin - erythromycin</li>\n<li>Miscellaneous agents:\n<ul>\n<li>Sincalide (C-terminal octapeptide of CCK)</li>\n<li>Camicinal (motilin receptor agonist)</li>\n<li>Relamorelin&nbsp;(ghrelin receptor agonist)</li>\n<li>Velusetrag and naronapride (5HT<sub>4&nbsp;</sub>agonists)</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Neet Mini - 17 (20 Q)';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>