<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forensic Medicine & Toxicology - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Test Series Subject / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A child rescued from a trafficking ring is brought to the department of forensic medicine for age estimation. The X-ray image of the hand is shown below. What is the likely age of the child?",
    "choices": [
      {
        "id": 1,
        "text": "4 years"
      },
      {
        "id": 2,
        "text": "6 years"
      },
      {
        "id": 3,
        "text": "8 years"
      },
      {
        "id": 4,
        "text": "13 years"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The child's age is likely to be <strong>13 years.</strong></p>\n<p>In the above X-ray image of the wrist and hand, <strong>all</strong> the <strong>carpal</strong> <strong>bones</strong> are <strong>seen</strong>. The <strong>lower epiphysis</strong> of the <strong>first metacarpal</strong> has <strong>not united</strong> with the shaft. This suggests that the age of the child is 12 to 15 years.</p>\n<p>The age of ossification of the carpal bones:</p>\n<table style=\"height: 218px;\" width=\"257\">\n<tbody>\n<tr>\n<td style=\"width: 120.5px;\"><strong>Carpal bone</strong></td>\n<td style=\"width: 120.5px;\"><strong>Age of ossification</strong></td>\n</tr>\n<tr>\n<td style=\"width: 120.5px;\">Capitate</td>\n<td style=\"width: 120.5px;\">1-3 months</td>\n</tr>\n<tr>\n<td style=\"width: 120.5px;\">Hamate</td>\n<td style=\"width: 120.5px;\">\n<p>2-4 months</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 120.5px;\">Triquetrum</td>\n<td style=\"width: 120.5px;\">\n<p>2-3 years</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 120.5px;\">Lunate</td>\n<td style=\"width: 120.5px;\">2-4 years</td>\n</tr>\n<tr>\n<td style=\"width: 120.5px;\">Scaphoid</td>\n<td style=\"width: 120.5px;\">4-6 years</td>\n</tr>\n<tr>\n<td style=\"width: 120.5px;\">Trapezium</td>\n<td style=\"width: 120.5px;\">4-6 years</td>\n</tr>\n<tr>\n<td style=\"width: 120.5px;\">Trapezoid</td>\n<td style=\"width: 120.5px;\">4-6 years \u00a0</td>\n</tr>\n<tr>\n<td style=\"width: 120.5px;\">Pisiform</td>\n<td style=\"width: 120.5px;\">8-12 years \u00a0</td>\n</tr>\n</tbody>\n</table>\n<p>The age of fusion of joints:</p>\n<table style=\"width: 584px;\">\n<tbody>\n<tr>\n<td style=\"width: 151px;\"><strong>Bone/ joint</strong></td>\n<td style=\"width: 194.344px;\"><strong>Maximum age at fusion </strong></td>\n</tr>\n<tr>\n<td style=\"width: 151px;\">\n<p>Elbow joint centers</p>\n<p>Metacarpals</p>\n</td>\n<td style=\"width: 194.344px;\">16 years</td>\n</tr>\n<tr>\n<td style=\"width: 151px;\">Wrist joint centers</td>\n<td style=\"width: 194.344px;\">19 years</td>\n</tr>\n<tr>\n<td style=\"width: 151px;\">Hip bone centers</td>\n<td style=\"width: 194.344px;\">22 years</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8f7bb2ba97b84dc6974e49c0f8543974.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "An ICU patient dies due to cardiac failure. After some time, you notice that the deceased body has become cold. What is this phenomenon known as?",
    "choices": [
      {
        "id": 1,
        "text": "Vibices"
      },
      {
        "id": 2,
        "text": "Livor mortis"
      },
      {
        "id": 3,
        "text": "Algor mortis"
      },
      {
        "id": 4,
        "text": "Postmortem caloricity"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The phenomenon of cooling of the body following a death is called <strong>algor mortis/ postmortem cooling.</strong></p>\n<p><strong>After death,</strong> the body <strong>loses heat</strong> mainly by <strong>conduction</strong> and <strong>convection.</strong><span class=\"fontstyle0\">&nbsp;It&nbsp;</span>is one of the <strong>early changes</strong> occurring after death.&nbsp;Temperature is usually measured in the&nbsp;<strong>rectum </strong>or<strong> abdominal cavity </strong>(subhepatic region).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A man has been arrested and booked under Sec. 304-B IPC. Which of the following offenses has he been accused of?",
    "choices": [
      {
        "id": 1,
        "text": "Death by rash/ negligent act"
      },
      {
        "id": 2,
        "text": "Dowry death"
      },
      {
        "id": 3,
        "text": "Culpable homicide"
      },
      {
        "id": 4,
        "text": "Grievous hurt"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Section 304-B</strong> of the <strong>Indian Penal Code</strong> (I.P.C)/ <strong>Section 80 </strong>of the <strong>Bharatiya Nyaya Sanhita (BNS) </strong>deals with dowry deaths.</p>\n<p>This legal provision comes into effect when the untimely demise of a woman occurs by burns/bodily injury or any other cause apart from normal circumstances within the <strong>first 7 years</strong> of her marriage. Evidence of cruelty or harassment by her spouse or relatives of her spouse in connection with demands for dowry must be shown. An individual accused of dowry death (cognizable, non-bailable) is liable to imprisonment from 7 years to life.\u00a0</p>\n<p><strong>Other options -\u00a0</strong></p>\n<p><strong>Option A -\u00a0Death</strong> by <strong>rash or negligent</strong> <strong>act</strong> is punishable (imprisonment for up to 2 years with/without fine) by Sec. <strong>304-A </strong>IPC.\u00a0</p>\n<p><strong>Option C -\u00a0Culpable homicide</strong> is punishable by Sec. <strong>299 IPC</strong>. It is an offense wherein the accused intentionally causes death or bodily injury likely to cause death. \u00a0Culpable homicide is defined under <strong>section 100</strong> of the<strong> BNS.</strong></p>\n<p><strong>Option D - \u00a0</strong><strong>Grievous hurt</strong> is punishable by <strong>Sec. 320 IPC (Sec.116 BNS)</strong>. Grievous hurt refers to any hurt that <strong>endangers life</strong>, or which causes the victim to be in <strong>severe bodily pain</strong>, or <strong>unable</strong> to<strong> follow</strong> his <strong>ordinary pursuits</strong> for a period of <strong>twenty days</strong>. This includes emasculation, permanent privation of the sight of either eye, permanent privation of the hearing of either ear, the privation of any member or joint or the destruction or permanent impairment of the power of any member or joint, permanent disfiguration of the head or face, and fracture or dislocation of a bone or tooth.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During the autopsy of a patient who died of suspected poisoning, it was noted that he had pink-coloured skin and mucosa. Prior to death, he had a bitter almond smell from his breath and frothy discharge.  What is the most likely cause of death in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Carbon monoxide poisoning"
      },
      {
        "id": 2,
        "text": "Cyanide poisoning"
      },
      {
        "id": 3,
        "text": "Hydrogen sulphide poisoning"
      },
      {
        "id": 4,
        "text": "Datura poisoning"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario points towards <strong>cyanide poisoning.</strong></p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p><strong>Poisoning by cyanide:</strong></p>\n<ul>\n<li>Cyanides are protoplasmic cytotoxic poisons.</li>\n<li>They act by inhibiting cytochrome oxidases for utilising O2 in a cell, leading to internal asphyxia (cellular asphyxia), leading to death.</li>\n<li>It can also act on other enzymes mildly.</li>\n<li><strong>It also acts as a corrosive on mucosa.</strong></li>\n<li>Inhalation brings about death instantaneously by respiratory arrest.</li>\n</ul>\n<p><strong>Clinical Features in small doses</strong></p>\n<ul>\n<li>Saltish taste in mouth</li>\n<li>Smell of bitter almonds to the breath</li>\n<li>Salivation, nausea, vomiting</li>\n<li>Cyanosis</li>\n</ul>\n<p><strong>Clinical Features in large doses</strong></p>\n<ul>\n<li>Rapid loss of consciousness, convuslions, coma, death</li>\n<li>Very often found deadat the scene&nbsp;</li>\n</ul>\n</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>Treatment of cyanide poisoning:</p>\n<ul>\n<li>Nitrites&nbsp;<strong>(Amyl nitrite,Sodium nitrite)</strong>&nbsp;are given to convert haemoglobin to methaemoglobin.</li>\n<li>Cyanides combine with methaemoglobin to form cyanmethaemoglobin , which in the presence of&nbsp;<strong>rhodonase &amp; sodium thiosulphate</strong>&nbsp;converts cyanide to thiocyanate which is excreted in urine.</li>\n</ul>\n</div>\n</div>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p><strong>Other antidotes:</strong></p>\n<ul>\n<li><strong>Hydroxycobalamin (vitamin B12)</strong></li>\n<li><strong>Dicobalt EDTA</strong></li>\n<li><strong>PAPP</strong>(Para amino propio phenol)</li>\n</ul>\n</div>\n</div>\n<div class=\"ng-scope\">&nbsp;</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Olive Green colored urine is seen in poisoning with:",
    "choices": [
      {
        "id": 1,
        "text": "Organophosphates"
      },
      {
        "id": 2,
        "text": "Kerosene"
      },
      {
        "id": 3,
        "text": "Carbolic acid"
      },
      {
        "id": 4,
        "text": "Oxalic acid"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Olive green urine</strong> is seen in <strong>carbolic acid poisoning.</strong></p>\n<p>In carbolic acid poisoning if the patient <strong>survives for 48 hrs</strong> there will be <strong>carboluria</strong> followed <strong>by anuria. </strong>The victim will pass dark, <strong>smoky urine</strong> which soon turns <strong>olive green</strong> <strong>on standing due to oxidation of hydroquinone and pyrocatechol.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/9dedb167c00348fea20d0c445794a690x440x518.PNG"
    ]
  },
  {
    "text": "A 5-year-old boy is brought to OPD with complaints of pain over the forearm. On detailed examination, several wounds with cigarettes burns are found. X-ray showed a spiral fracture of the radius. Which of the following is least likely seen in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Subdural hematoma"
      },
      {
        "id": 2,
        "text": "Periosteal shearing"
      },
      {
        "id": 3,
        "text": "Multiple injuries at same stage of healing"
      },
      {
        "id": 4,
        "text": "Soft tissue swelling"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario is suggestive of\u00a0<strong>battered baby syndrome</strong>. The classical feature of this condition is injuries inflicted are of <strong>different ages </strong>and in <strong>different stages of healing</strong>. This is due to the repetitive nature of child abuse.</p>\n<p>A battered child is one who has received <strong>repetitive physical injuries as a result of non-accidental\u00a0</strong><strong>violence, produced by a parent or guardian</strong>, there may also be deprivation of nutrition, care, and affection.</p>\n<p>This syndrome <strong>must be considered</strong> in any child:</p>\n<ul>\n<li>In whom the degree and type of injury varies with the history given</li>\n<li>When injuries are of different ages and in different stages of healing</li>\n<li>When there is a purposeful delay in seeking medical attention despite serious injury</li>\n<li>Who exhibits evidence of fracture of any bone, subdural hematoma, failure to thrive, soft tissue swelling or skin bruising</li>\n<li>Who dies suddenly</li>\n</ul>\n<p><span class=\"fontstyle0\"><strong>Skeletal survey</strong>, which includes the following, should be done in a case of suspected child abuse:</span></p>\n<ul>\n<li><span class=\"fontstyle0\">AP views of the entire skeleton</span></li>\n<li><span class=\"fontstyle0\">Dedicated views of hands and feet</span></li>\n<li><span class=\"fontstyle0\">Lateral views of the appendicular skeleton, skull, and spine</span></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During the court proceedings, the defense lawyer asks a leading question, which the prosecutor appeals against. The judge grants the appeal. Such questions are permitted during which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Re-examination"
      },
      {
        "id": 2,
        "text": "Cross examination"
      },
      {
        "id": 3,
        "text": "Examination in chief"
      },
      {
        "id": 4,
        "text": "Dying declaration"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Leading questions</strong> are not allowed in all of the given options except <strong>cross-examination, </strong>i.e leading questions are <strong>allowed</strong> <strong>during cross-examination.</strong></p>\n<p>As per section 141 of the Indian Evidence Act, a leading question is one which is suggestive of the answer that is desired or one which includes a fact and leads to the admitting of a conclusive answer, such as yes or no.</p>\n<p><strong>Cross-examination</strong> is one wherein the witness is questioned by the opposite party's lawyer, i.e the lawyer for the accused or the defense lawyer. It is undertaken with the objective&nbsp;to demonstrate favorable facts to their case, to test the accuracy of the witness statements, to unearth new or old facts, and to discredit the witness.</p>\n<p>The sequence of examination while recording evidence is as follows:</p>\n<ol>\n<li><strong>Examination-in-Chief/direct examination</strong> by the party that summoned the witness to elicit all the facts from the witness. <strong>Leading questions</strong> are <strong>not allowed&nbsp;</strong>(option C). The only <strong>exception</strong> is if the judge is satisfied that the <strong>witness is hostile.&nbsp;</strong></li>\n<li><strong>Cross-examination</strong>&nbsp;is done by the defence lawyer.</li>\n<li><strong>Re-examination</strong>&nbsp;is done by the party that summoned the witness to correct or clarify or detail the statements made by the witness during cross-examination.<strong> Leading questions</strong> are <strong>not allowed </strong>(option A).</li>\n</ol>\n<p>Other options:</p>\n<p>Option D: A<strong> dying declaration</strong> is an oral or written statement made by a person who is dying. The doctor should certify that the person is conscious and with normal mental faculties before the declaration is recorded. It is recorded by the executive magistrate, or a doctor in the presence of two witnesses, if there is no time for the magistrate to come. <strong>Leading questions</strong> should <strong>not be asked.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "For a man to be found guilty of statutory rape, he must have had sexual intercourse with?",
    "choices": [
      {
        "id": 1,
        "text": "A woman who is in intoxicated state"
      },
      {
        "id": 2,
        "text": "His wife living under decree of separation"
      },
      {
        "id": 3,
        "text": "Any person other than his wife"
      },
      {
        "id": 4,
        "text": "A girl below 18 years of age with her consent"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Statutory rape</strong>&nbsp;is having a&nbsp;<strong>sexual relationship</strong> with a<strong> girl</strong> who is<strong> below 18 years</strong> of age <strong>even with</strong> her<strong> consent.</strong></p>\n<p>Sexual intercourse with a woman who is under the influence of sedative drugs like GHB, rohypnol (flunitrazepam) is called <strong>date rape</strong>.&nbsp;</p>\n<p>Sexual intercourse with wife living separately, against her consent is <strong>marital rape.&nbsp;</strong></p>\n<p>Voluntary sexual intercourse between a married person and a person who is not their spouse is <strong>adultery</strong>.</p>\n<p>Note: Adultery used to be a punishable offence under Section 497 IPC. It was scapped down by the Supreme Court on 6th September 2018, and is no longer punishable.&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In organophosphorus poisoning, clinical manifestations occur when pseudocholinesterase levels fall below:",
    "choices": [
      {
        "id": 1,
        "text": "95% of normal"
      },
      {
        "id": 2,
        "text": "75% of normal"
      },
      {
        "id": 3,
        "text": "60% of normal"
      },
      {
        "id": 4,
        "text": "50% of normal"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In organophosphorus poisoning, <strong>clinical&nbsp;signs and symptoms are observed</strong>&nbsp;when pseudocholinesterase level falls below <strong>50% of normal.&nbsp;</strong></p>\n<ul>\n<li><strong>Mild&nbsp;</strong>poisoning: 40-50% of normal</li>\n<li><strong>Moderate&nbsp;</strong>poisoning: 10-40% of normal</li>\n<li><strong>Severe&nbsp;</strong>poisoning: &lt;10% of normal</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following acts as a physiological antidote to scorpion venom?",
    "choices": [
      {
        "id": 1,
        "text": "Physostigmine"
      },
      {
        "id": 2,
        "text": "Norepinephrine"
      },
      {
        "id": 3,
        "text": "Prazosin"
      },
      {
        "id": 4,
        "text": "Atropine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Prazosin</strong> acts as a physiological antidote for <strong>scorpion venom.&nbsp;</strong></p>\n<p>The venom is a clear, colorless, proteinous toxalbumen, having a <strong>hemolytic</strong> and <strong>neurotoxic</strong> effect. Its toxicity is more than that of snakes, but only a small quantity is injected. The venom is a <strong>potent autonomic stimulator</strong>, resulting in the release of massive amounts of <strong>catecholamines</strong> from the adrenals.</p>\n<p>If the scorpion has <strong>hemolytic</strong> venom, the reaction is mainly local and simulates the viper snake bite. The scorpion sting will have only <strong>one hole</strong> in the center of the reddened area. The <strong>extremity</strong> will have <strong>edema, pain, and reddening</strong>. This usually lasts for one to two hours.</p>\n<p>The symptoms produced by a <strong>neurotoxic</strong> venom are similar to a cobra bite. There is usually <strong>no marked</strong> reaction in the <strong>local area</strong>. Nausea, vomiting, extreme restlessness, fever, various types of paralysis, cardiac arrhythmias, convulsions, coma, respiratory depression, and death may occur within hours from <strong>pulmonary edema</strong> or <strong>cardiac failure.</strong></p>\n<p><strong>Prazosin&nbsp;</strong>can <strong>counteract</strong> the <strong>alpha-adrenergic</strong> effects of autonomic stimulation, such as hypertension.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Human skeletal remains were found in an abandoned basement in Wuhan. Which of the following would indicate that the victim was a Caucasian?",
    "choices": [
      {
        "id": 1,
        "text": "Taurodontism"
      },
      {
        "id": 2,
        "text": "Carabelli cusps"
      },
      {
        "id": 3,
        "text": "Shovel shaped incisors"
      },
      {
        "id": 4,
        "text": "Lack of the third upper molar"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\"><strong>Carabelli&rsquo;s cusps </strong>are most commonly seen&nbsp;<strong>only</strong> in<strong>&nbsp;Caucasian races</strong> and rare in the other major racial groups. These are <strong>small</strong> <strong>nodules</strong> on the lingual surface of maxillary <strong>molars.</strong></p>\n<p>The image below shows Carabelli&rsquo;s cusps seen in&nbsp;Caucasian races.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3d36823ef4a94ef19bc35deaecc275ffx392x216.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/69f2eab25b324ac39f92de2619e4f14bx404x464.PNG"
    ]
  },
  {
    "text": "Which of the following are constituents of smokeless gunpowder?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2 and 5"
      },
      {
        "id": 2,
        "text": "2, 4 and 5"
      },
      {
        "id": 3,
        "text": "2, 3 and 4"
      },
      {
        "id": 4,
        "text": "1, 3 and 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Smokeless gunpowder contains nitroglycerine, nitrocellulose and nitroguanidine.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman was drugged with a substance, which was slipped into her coffee without her knowledge by a man at her workplace. The man confessed that he tried to make her notice him by adding a love philter to her coffee. Which of the following would he have used?",
    "choices": [
      {
        "id": 1,
        "text": "CNS depressants"
      },
      {
        "id": 2,
        "text": "Deliriants"
      },
      {
        "id": 3,
        "text": "Stupefying agents"
      },
      {
        "id": 4,
        "text": "Aphrodisiacs"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A&nbsp;<strong>love philter</strong> is a magical potion that is supposed to make the person who receives the potion love the one who gave it. These are usually <strong>aphrodisiacs.</strong></p>\n<p>Some aphrodisiacs that are used as&nbsp;love philter are:</p>\n<ul>\n<li>Cantharides</li>\n<li>Arsenic</li>\n<li>Alcohol</li>\n<li>Opium</li>\n<li>Cocaine</li>\n<li>Cannabis</li>\n</ul>\n<p>The use of a love philter might lead to&nbsp;<strong>accidental poisoning</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The least common fingerprint pattern is _____________.",
    "choices": [
      {
        "id": 1,
        "text": "Composite"
      },
      {
        "id": 2,
        "text": "Whorl"
      },
      {
        "id": 3,
        "text": "Loops"
      },
      {
        "id": 4,
        "text": "Arches"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Composite type (1-2%) is the least common fingerprint pattern.</p>\n<p>Patterns of fingerprints:</p>\n<ul>\n<li><strong>Loops</strong> - Most common type <strong>(60-70%)</strong></li>\n<li><strong>Whorl</strong> - (25-30%)</li>\n<li><strong>Arch</strong> - (6-7%) They may be plain, <strong>tented,\u00a0</strong>or exceptional.\u00a0</li>\n<li><strong>Composite forms (1 \u2013 2%) - least common</strong></li>\n</ul>\n<p>The study of ridge patterns in the skin is <strong>Dactylography/</strong> Galton-Henry system/ Dermatoglyphics. Fingerprints are the impressions of patterns produced by the papillary or epidermal ridges present on the fingertips.</p>\n<p>Classification of fingerprints into different patterns is based on <strong>delta and core formation. </strong>Delta is a <strong>triangular</strong> arrangement formed where three separate ridge line flows come together. The <strong>core</strong> is the <strong>centermost portion</strong> of a ridge flow pattern.\u00a0</p>\n<p>The number of delta and core for each pattern is given below.</p>\n<table style=\"border-collapse: collapse; width: 31.8495%; height: 134.391px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.5029%; height: 22.3984px;\"><strong>Pattern\u00a0</strong></td>\n<td style=\"width: 52.6012%; height: 22.3984px;\"><strong>Delta\u00a0</strong></td>\n<td style=\"width: 15.896%; height: 22.3984px;\"><strong>Core</strong></td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.5029%; height: 22.3984px;\">Loop</td>\n<td style=\"width: 52.6012%; height: 22.3984px;\">1</td>\n<td style=\"width: 15.896%; height: 22.3984px;\">1</td>\n</tr>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 31.5029%; height: 44.7969px;\">Plain arch</td>\n<td style=\"width: 52.6012%; height: 44.7969px;\">0</td>\n<td style=\"width: 15.896%; height: 44.7969px;\">0</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.5029%; height: 22.3984px;\">Tented arch</td>\n<td style=\"width: 52.6012%; height: 22.3984px;\">1 delta at the base of the upthrust</td>\n<td style=\"width: 15.896%; height: 22.3984px;\">0</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.5029%; height: 22.3984px;\">Whorl</td>\n<td style=\"width: 52.6012%; height: 22.3984px;\">2</td>\n<td style=\"width: 15.896%; height: 22.3984px;\">1</td>\n</tr>\n</tbody>\n</table>\n<p>The image given below shows the delta and core in the different fingerprint patterns. For each type, the position of the core is marked with a green circle, and the delta is marked with a blue triangle.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2fc713c740f24137a525a1dbbee9a507x1280x2295.JPEG"
    ]
  },
  {
    "text": "A 60-year-old female was admitted for a strangulated femoral hernia. She came with complaints of abdominal pain and fecal vomits. Small intestines were found to be perforated. The next day she underwent a release of hernia and recession of intestines with an end to end anastomosis. The next day she started developing signs of peritonitis and died 3 days later. Which of the following options is the most appropriate for the line I (a) of the death certificate?",
    "choices": [
      {
        "id": 1,
        "text": "Strangulated femoral hernia"
      },
      {
        "id": 2,
        "text": "Peritonitis"
      },
      {
        "id": 3,
        "text": "Intestinal perforation"
      },
      {
        "id": 4,
        "text": "Surgery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Peritonitis</strong> is appropriate for the line I (a) of the death certificate as it is the<strong> disease/condition directly leading to </strong><strong>death.</strong></p>\n<p>In this patient:</p>\n<ul>\n<li><strong>I(a) </strong>- Disease directly leading to death:<strong>&nbsp;Peritonitis</strong></li>\n<li><strong>I(b)</strong> - Antecedent cause: Perforation of small intestine</li>\n<li><strong>I(c) - </strong>Condition which gave rise to the antecedent cause: Strangulated femoral hernia</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "First-hand knowledge rule is applicable to:",
    "choices": [
      {
        "id": 1,
        "text": "Common witness"
      },
      {
        "id": 2,
        "text": "Hand writing expert"
      },
      {
        "id": 3,
        "text": "Doctor"
      },
      {
        "id": 4,
        "text": "Hostile witness"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>first-hand knowledge</strong> rule is applicable to a<strong> common witness</strong> who gives <strong>evidence</strong> about the<strong> facts observed </strong>or<strong> perceived </strong>by him.</p>\n<p>An <strong>expert witness</strong> is someone who has been <strong>trained </strong>or is<strong> skilled</strong> or has <strong>knowledge</strong> and <strong>experience</strong> and is able to draw conclusions from the facts observed by him. Doctors, handwriting/ fingerprints/ firearms experts come under this category.</p>\n<p>A <strong>hostile witness</strong> is a person who is supposed to have some<strong> interest</strong> or<strong> motive </strong>for<strong> concealing </strong>a part of the<strong> truth</strong> or for giving completely false evidence.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents to you with a history of ingestion of one uncrushed seed similar to that shown in the image below. He is asymptomatic at presentation. Which of the following can be anticipated in this case?",
    "choices": [
      {
        "id": 1,
        "text": "No poisonous action"
      },
      {
        "id": 2,
        "text": "Confusion followed by coma"
      },
      {
        "id": 3,
        "text": "Severe convulsions followed by death"
      },
      {
        "id": 4,
        "text": "Opisthotonos followed by respiratory paralysis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows seeds of <strong>Strychnos-nux vomica</strong>. If swallowed <strong>uncrushed</strong>, the seeds of nux vomica have <strong>no poisonous action</strong>, as they are not dissolved in the gastrointestinal tract, and are passed entirely in the faeces.</p>\n<p>Strychnine is a competitive antagonist of <strong>glycine</strong> at the postsynaptic receptors in the motor neurons of the anterior horn of the spinal cord. This leads to increased activity in the motor neurons. The fatal dose is <strong>15-30 mg</strong> of strychnine or<strong> one crushed seed.</strong></p>\n<p>Patients typically present with symptoms similar to <strong>tetanus</strong> such as</p>\n<ul>\n<li><strong>Convulsions</strong> are clonic initially but eventually become tonic. The anti-gravity muscles experience the most severe convulsions, causing the body to typically arch in hyperextension\u2014a position called opisthotonus.</li>\n<li><strong>Risus sardonicus</strong> which results from the <strong>contraction of the jaws and facial muscles</strong> in which the corners of the mouth are drawn back.</li>\n<li>If the spasm involves the abdominal muscles, the body bends forward <strong>(emprosthotonos),</strong> or to the side <strong>(pleurosthotonus).</strong></li>\n<li>If death is preceded by a severe convulsion, as in strychnine poisoning, it causes an increase in the body temperature known as <strong>postmortem caloricity.</strong></li>\n</ul>\n<p>The first step in the management of strychnine poisoning is to control convulsions with <strong>benzodiazepines or barbiturates</strong> and the patients should be placed in a <strong>dark room</strong> to avoid triggering further convulsions. <strong>Activated charcoal</strong> can be used to adsorb unabsorbed poison after a thorough stomach wash. <strong>Acidification of urine </strong>can be done to increase the excretion of strychnine.</p>\n<p>The toxin strychnine does not affect any receptors in the brain and the person remains conscious till death. Strychnine poisoning is characterized by <strong>conscious seizures.\u00a0</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/25394b21de9d4bd9955ffaba14fd12c1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A deceased male was posted for a \u200bpost-mortem examination. His relatives reported that he had a tattoo over his skin, which was not found on examination. Which of the following structures would you examine?",
    "choices": [
      {
        "id": 1,
        "text": "Lymph nodes"
      },
      {
        "id": 2,
        "text": "Liver"
      },
      {
        "id": 3,
        "text": "Arteries"
      },
      {
        "id": 4,
        "text": "Skin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The lymph nodes&nbsp;should be examined in this case.</p>\n<p>Some amount of material or dye used for creating tattoo marks is transported through lymph to the r<strong>egional lymph nodes.&nbsp;</strong>Hence in cases where a tattoo mark has disappeared&nbsp;naturally or has been removed, the lymph nodes must be examined before making any conclusions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Among the following criteria, which is the most reliable criterion for age determination from Gustafson's method?",
    "choices": [
      {
        "id": 1,
        "text": "Cementum apposition"
      },
      {
        "id": 2,
        "text": "Root resorption"
      },
      {
        "id": 3,
        "text": "Secondary dentin deposition"
      },
      {
        "id": 4,
        "text": "Root transparency"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>According to&nbsp;<strong>Gustafson's</strong> method, <strong>root transparency</strong> is the most reliable criterion.</p>\n<p><strong>Gustafson's</strong> method of estimating the&nbsp;<strong>age</strong> of an individual is based on <strong>physiological changes</strong> in <strong>dental tissues</strong>. It is mainly useful in adults <strong>over 21 years</strong> of age (option B).</p>\n<p>Gustafson&rsquo;s criteria:</p>\n<ul>\n<li><strong>Attrition -</strong>&nbsp;Gradual wear and tear changes of the occlusal or upper surface due to mastication</li>\n<li><strong>Periodontosis -&nbsp;</strong>&nbsp;Regression of gums and periodontal tissue surrounding the tooth, resulting in loosening of the tooth and falling</li>\n<li><strong>Secondary dentin</strong> - Deposition of dentin in the pulp cavity and gradual decrease in the size of the cavity</li>\n<li><strong>Cementum apposition</strong> - Cementum increases in thickness near the end of the root due to changes in the tooth position. Secondary cementum deposition occurs continually and slowly, forming incremental lines.</li>\n<li><strong>Root resorption</strong> -<strong>&nbsp;</strong>&nbsp;Involves both cementum and dentin, which show characteristic sharp grooves&nbsp;</li>\n<li><strong>Transparency of the root -</strong>&nbsp;This is<strong> the most reliable criteria</strong>. Canals in dentin get filled with minerals, and they become transparent gradually. Dentine becomes transparent due to rarefaction.</li>\n</ul>\n<p>Other options:</p>\n<p>Option C - <strong>Weight and height</strong> of the erupting teeth of a child are used to estimate the age of infants by <strong>Stack's method, not Gustafson's method.</strong></p>\n<p>Option D -&nbsp; Chemical methods for <strong>estimation of the nitrogen content</strong> of enamel, which increases with age, are used for estimating the age beyond 25 years. It is not a part of Gustafson's criteria.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following confirm a live birth except:",
    "choices": [
      {
        "id": 1,
        "text": "Presence of milk in the stomach"
      },
      {
        "id": 2,
        "text": "Skin exfoliation"
      },
      {
        "id": 3,
        "text": "Presence of meconium in the large bowel"
      },
      {
        "id": 4,
        "text": "Closure of foetal channels"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Absence</strong> (and not presence)<strong> of meconium</strong> in the large bowel is a confirmatory sign of live birth.</p>\n<p><strong>Confirmatory signs of live birth are&nbsp;</strong>:</p>\n<ul>\n<li>Presence of milk in the stomach</li>\n<li>Absence of meconium in the large bowel, exception being breech delivery.</li>\n<li>Exfoliation of skin</li>\n<li>Closure of foetal channels</li>\n<li>Changes in the umbilical cord</li>\n</ul>\n<p><strong>Live birth can be excluded if :</strong></p>\n<ul>\n<li>Signs of maceration are present</li>\n<li>Signs of immaturity are present. If the child has not attained the viable age (7 months), it could not have been born alive.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a reliable indicator that the victim was alive while the fire was in progress?",
    "choices": [
      {
        "id": 1,
        "text": "Vital reaction in the burned area"
      },
      {
        "id": 2,
        "text": "Redness of the exposed skin surface"
      },
      {
        "id": 3,
        "text": "Elevated carboxyhemoglobin levels"
      },
      {
        "id": 4,
        "text": "Blistering of the skin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Elevated&nbsp;levels of <strong>carbon monoxide in the circulating blood</strong> and <strong>carbon particles in the air passages and lungs</strong>&nbsp;are reliable indicators suggesting that the victim was alive while the fire was in progress.</p>\n<p>They do not prove that any burns were ante-mortem, but that the victim was still alive when the fire was in progress, which is not the same conclusion.</p>\n<table style=\"width: 308px;\">\n<tbody>\n<tr>\n<td style=\"width: 63px;\">\n<p>Trait</p>\n</td>\n<td style=\"width: 123px;\">\n<p>Ante-mortem burns</p>\n</td>\n<td style=\"width: 100px;\">\n<p>Post-mortem burns</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 63px;\">\n<p>Line of redness</p>\n</td>\n<td style=\"width: 123px;\">\n<p>Present</p>\n</td>\n<td style=\"width: 100px;\">\n<p>Absent</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 63px;\">\n<p>Blister</p>\n</td>\n<td style=\"width: 123px;\">\n<p>Contains serous fluid with proteins and chlorides</p>\n<p>Base is inflamed</p>\n</td>\n<td style=\"width: 100px;\">\n<p>Contains air only</p>\n<p>Base is dry, hard and yellow.</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 63px;\">\n<p>Vital-reaction</p>\n</td>\n<td style=\"width: 123px;\">\n<p>Present</p>\n</td>\n<td style=\"width: 100px;\">\n<p>Absent</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 63px;\">\n<p>Enzymes</p>\n</td>\n<td style=\"width: 123px;\">\n<p>Peripheral zone of burn shows increase in enzyme reaction</p>\n</td>\n<td style=\"width: 100px;\">\n<p>Peripheral zone of burn does not show increase in enzyme reaction</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The preauricular sulcus is an indicator of:",
    "choices": [
      {
        "id": 1,
        "text": "Skull fusion"
      },
      {
        "id": 2,
        "text": "Race"
      },
      {
        "id": 3,
        "text": "Sex"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>preauricular sulcus</strong> is a groove on the iliac bone found in a female pelvis. It is absent in a male pelvis and hence can be used for <strong>sex determination.</strong></p>\n<p>Important differentiating features between male and female pelvis are:</p>\n<table style=\"height: 170px; width: 375px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 103px; text-align: center;\"><strong>Characteristic</strong></td>\n<td style=\"width: 133px; text-align: center;\"><strong>Male pelvis</strong></td>\n<td style=\"width: 119px; text-align: center;\"><strong>Female pelvis</strong></td>\n</tr>\n<tr>\n<td style=\"width: 103px; text-align: center;\">General Morphology</td>\n<td style=\"width: 133px; text-align: center;\">Rugged with marked muscle attachments</td>\n<td style=\"width: 119px; text-align: center;\">Gracile and smooth</td>\n</tr>\n<tr>\n<td style=\"width: 103px; text-align: center;\">Overall shape</td>\n<td style=\"width: 133px; text-align: center;\">Pelvis is high and narrow</td>\n<td style=\"width: 119px; text-align: center;\">Pelvis is wide and shallow</td>\n</tr>\n<tr>\n<td style=\"width: 103px; text-align: center;\">Pubic bone</td>\n<td style=\"width: 133px; text-align: center;\">Narrow and triangular</td>\n<td style=\"width: 119px; text-align: center;\">Wide and rectangular</td>\n</tr>\n<tr>\n<td style=\"width: 103px; text-align: center;\">Subpubic angle</td>\n<td style=\"width: 133px; text-align: center;\">Narrow (70 degrees)</td>\n<td style=\"width: 119px; text-align: center;\">Wide (90 degrees)</td>\n</tr>\n<tr>\n<td style=\"width: 103px; text-align: center;\">Greater sciatic notch</td>\n<td style=\"width: 133px; text-align: center;\">J-shape</td>\n<td style=\"width: 119px; text-align: center;\">L-shape</td>\n</tr>\n<tr>\n<td style=\"width: 103px; text-align: center;\">Preauricular sulcus</td>\n<td style=\"width: 133px; text-align: center;\">Absent</td>\n<td style=\"width: 119px; text-align: center;\">Present</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In the civil negligence case against a doctor who bears the onus of proof?",
    "choices": [
      {
        "id": 1,
        "text": "Patient"
      },
      {
        "id": 2,
        "text": "Police not under rank of  sub inspector"
      },
      {
        "id": 3,
        "text": "Magistrate"
      },
      {
        "id": 4,
        "text": "Doctor"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the case of civil negligence, the<strong> burden of proof is on the patient.</strong></p>\n<p>The question of<strong> civil negligence</strong> arises when a suit is filed in a civil court:</p>\n<ul>\n<li><strong>By a patient</strong> or his/her relatives against the doctor <strong>for getting compensation from the doctor</strong> if he/she has suffered an injury due to the doctor's negligence.</li>\n<li><strong>By a doctor</strong> against the patient or his/her relatives <strong>to collect the fees</strong>, the payment of which has been refused due to alleged professional negligence by the doctor.</li>\n</ul>\n<p>In either case, the <strong>patient has to prove</strong> that the doctor has committed professional negligence.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What type of skull fracture is shown in the given image:",
    "choices": [
      {
        "id": 1,
        "text": "Diastatic fracture"
      },
      {
        "id": 2,
        "text": "Pond fracture"
      },
      {
        "id": 3,
        "text": "Gutter fracture"
      },
      {
        "id": 4,
        "text": "Depressed fracture"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows a&nbsp;<strong>gutter fracture</strong> of the skull.</p>\n<p class=\"p1\">It is a <strong>furrow in the outer table of the skull</strong>, ordinarily the result of a <strong>glancing blow by a missile from a rifled firearm</strong>. These are frequently accompanied with comminuted depressed fractures of inner table of the skull.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/64cf45c49b6f406ab8d79cd6fd9990b6.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following findings are seen in patients with chronic arsenic poisoning?",
    "choices": [
      {
        "id": 1,
        "text": "1,2,3 are correct"
      },
      {
        "id": 2,
        "text": "2,3 are correct"
      },
      {
        "id": 3,
        "text": "1,4 are correct"
      },
      {
        "id": 4,
        "text": "Only 1 is correct"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Among the given options,<strong> raindrop pigmentation, peripheral neuritis</strong>, and&nbsp;<strong>mees line&nbsp;</strong>are seen in patients with chronic arsenic poisoning.&nbsp;<strong>Luminous vomit&nbsp;</strong>is a feature of<strong>&nbsp;yellow phosphorous poisoning.</strong>&nbsp;</p>\n<p>Arsenic is an odorless, tasteless, metallic poison. Gastrointestinal features of <strong>acute</strong> arsenic poisoning include nausea and vomiting, colicky abdominal pain, and profuse diarrhea with <strong>rice water stools</strong>.</p>\n<p>In <strong>chronic</strong>&nbsp;arsenic poisoning, skin symptoms include erythematous lesions, flushing, and can also lead to hyperkeratotic skin and desquamation. Pigmentation is patchy and resembles <strong>raindrops</strong> on a dusty road. In the distal parts of the body, hyperkeratosis is present.&nbsp; <strong>Mees lines</strong> are transverse white striae of the fingernails, called striate leukonychia. Renal manifestations include chronic <strong>nephritis</strong> and urine contains albumin, casts, etc.&nbsp;</p>\n<p>Arsenic can be detected in the bones for prolonged periods<strong>. </strong>Hence it can be found even in&nbsp;<strong>skeletonized remains</strong> of the body<strong>.&nbsp;Dimercaprol</strong>&nbsp;is the treatment of choice for acute arsenic poisoning.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74c69ede1931425db6f9c4192891ec35x1280x4902.JPEG"
    ]
  },
  {
    "text": "The wound in the given image is most likely to have been produced by?",
    "choices": [
      {
        "id": 1,
        "text": "Road traffic accident"
      },
      {
        "id": 2,
        "text": "Broom handle"
      },
      {
        "id": 3,
        "text": "Serrated knife"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows <strong>'tram-line' bruising</strong>, most likely to have been produced by a <strong>stick or a broom handle</strong>.&nbsp;</p>\n<p>Tram-line bruising:</p>\n<ul>\n<li>When the skin surface is struck by a rod or rectangular sectioned object such as a cane or lath, the consequent bruising may be of the <strong>&lsquo;tram-line&rsquo; or &lsquo;railway line&rsquo;</strong> type.</li>\n<li>The mechanism of this double line is that the weapon sinks into the skin on impact so that the edges drag the skin downwards and the traction tears the marginal blood vessels. The centre compresses the skin, which, in the absence of underlying bone, causes little or no damage to the vessels.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/58bd20bafabf4fd19654a71612ae88cf.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0994e7aaec1444cdb7f8125ec8427bdex600x439.JPEG"
    ]
  },
  {
    "text": "As per The Medical Termination of Pregnancy (Amendment) Bill, 2020, Induction of MTP in a  mentally ill, rape victim is allowed until what age of gestation?",
    "choices": [
      {
        "id": 1,
        "text": "20 weeks"
      },
      {
        "id": 2,
        "text": "22 weeks"
      },
      {
        "id": 3,
        "text": "24 weeks"
      },
      {
        "id": 4,
        "text": "28 weeks"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>As per the Medical Termination of Pregnancy (Amendment) Bill 2020, the induction of MTP in a mentally ill or rape victim is allowed until 24 weeks.&nbsp;</p>\n<p>&nbsp;</p>\n<p>Salient features of amendments:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Enhancing the upper gestation limit from 20 to 24 weeks for special categories of women which includes survivors of rape, victims of incest and other vulnerable women (like differently-abled women, minors) etc.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Opinion of only one provider will be required up to 20 weeks of gestation and of two providers for termination of pregnancy of 20-24 weeks of gestation.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Upper gestation limit not to apply in cases of substantial foetal abnormalities.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Name and other particulars of a woman whose pregnancy has been terminated shall not be revealed except to a person authorised in any law for the time being in force.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The ground of failure of contraceptive has been extended to women and her partner.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In Breslau\u2019s second life test, the organ tested is _______",
    "choices": [
      {
        "id": 1,
        "text": "Heart"
      },
      {
        "id": 2,
        "text": "Lung"
      },
      {
        "id": 3,
        "text": "Brain"
      },
      {
        "id": 4,
        "text": "Stomach and Intestine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In Breslau&rsquo;s second life test the organ tested is Stomach and intestine.</p>\n<p><strong>BRESLAU&rsquo;S SECOND LIFE TEST:</strong></p>\n<ul>\n<li>It is based on <strong>air entering stomach and intestine during respiration in a live born foetus</strong>.</li>\n<li>Stomach and intestine are removed by tying double ligatures at each end and placed in water.</li>\n<li><strong>Inference:</strong></li>\n<li>A floating viscera giving out air-bubbles when opened under water is positive test and suggestive of live birth.</li>\n<li>False positive &ndash; in case of stillbirth, air might enter the stomach when child tries to free obstruction of air passages.</li>\n<li><strong>Mucus, saliva and air bubbles in stomach &ndash; breathing has occurred.</strong></li>\n<li><strong>Only mucus &ndash; breathing has not occurred.</strong></li>\n<li>Blood, meconium, liquor amnii in stomach &ndash; child alive at or shortly before birth.</li>\n<li><strong>Milk in stomach &ndash; child was alive for sometime after birth</strong>.</li>\n<li>Test is invalid in case of putrefaction.</li>\n</ul>\n<p><strong>&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A man regularly derives sexual gratification by inflicting pain upon his partner. He would often produce cuts and cigarette burns on his partner's arms. This is best described as?",
    "choices": [
      {
        "id": 1,
        "text": "Voyeurism"
      },
      {
        "id": 2,
        "text": "Fetishism"
      },
      {
        "id": 3,
        "text": "Sadism"
      },
      {
        "id": 4,
        "text": "Masochism"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given scenario is suggestive of&nbsp;<strong>sexual sadism.&nbsp;</strong>It is seen more commonly in <strong>men</strong>. It develops due to early experiences of brutality in sex.</p>\n<p>The sadist may bite, beat, whip, produce cuts or cigarette burns etc on their sexual partner. In extreme cases, the victim's nipples may be bitten off, items such as a bottle or sticks are inserted into the vagina. <strong>Blunt trauma</strong> causing <strong>fractures</strong> and <strong>rupture of internal organs</strong> may also be seen.</p>\n<p>Other options:</p>\n<p>Option A -<strong> Voyeurism</strong> - It is the act of obtaining sexual gratification by <strong>observing an unsuspecting person</strong> who is naked, disrobing or engaging in sexual activity.</p>\n<p>Option B -<strong> Fetishism</strong> - It is a form of sexual behaviour in which gratification is associated with an <strong>abnormal stimulus</strong> which may be an object, activity or part of the body.</p>\n<p>Option D - <strong>Masochism</strong> - This is <strong>opposite</strong> to sadism. Sexual gratification is obtained by <strong>suffering the pain</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A registered medical practitioner is requested by a survivor of sexual violence to examine her. What is the maximum time by which the practitioner can take a vaginal swab to look for the presence of spermatozoa?",
    "choices": [
      {
        "id": 1,
        "text": "Within 72 hours"
      },
      {
        "id": 2,
        "text": "Within 36 hours"
      },
      {
        "id": 3,
        "text": "Within 5 days"
      },
      {
        "id": 4,
        "text": "Within 48 hours"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A <strong>vaginal swab</strong> of a rape victim demonstrates spermatozoa if the<strong> vaginal swab is taken within 72 hours</strong> after an assault.</p>\n<p>However <strong>vaginal swab</strong> can be taken <strong>within 96 hours</strong> to <strong>demonstrate semen.</strong></p>\n<p><strong>Evidence on the outside of the body</strong> and on materials such as clothing <strong>can be collected even after 96 hours.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Forensic Medicine & Toxicology';
        let hierarchy = ["Marrow", "FMGE Test Series Subject", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>