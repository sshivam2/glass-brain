<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dizziness Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 40-year-old man presents with intermittent episodes of dizziness for the past few weeks, lasting for a few hours at a time. He also complains of ringing and fullness in his right ear. Rinne's test is positive bilaterally and the Weber test shows lateralization to the left ear. He works as a school teacher and gets vertiginous episodes with loud noise such as the ringing of the bell. Which of the following terms can be used to describe this symptom?",
    "choices": [
      {
        "id": 1,
        "text": "Tumarkin\u2019s otolithic crisis"
      },
      {
        "id": 2,
        "text": "Tullio phenomenon"
      },
      {
        "id": 3,
        "text": "Lermoyez syndrome"
      },
      {
        "id": 4,
        "text": "Vestibular hydrops"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Tullio phenomenon </strong>describes\u00a0the <strong>vertiginous episodes</strong> associated with <strong>exposure</strong> <strong>to</strong> <strong>loud noise</strong> in a patient with Meniere's disease. This phenomenon is due to the <strong>distended saccule </strong>lying against the <strong>stapes footplate.</strong></p>\n<p>Meniere's disease (MD) or endolymphatic hydrops is a\u00a0disorder of the inner ear\u00a0caused by impaired endolymph resorption. It is characterized by an episodic sudden onset of\u00a0<strong>vertigo</strong>, low-frequency\u00a0<strong>hearing loss</strong>\u00a0(in the early stages of the disorder), low-frequency roaring\u00a0<strong>tinnitus</strong>, and\u00a0<strong>sensation of fullness</strong>\u00a0in the affected ear.</p>\n<p>Treatment of Meniere's disease includes\u00a0<strong>Betahistine</strong>.\u00a0It\u00a0acts by causing\u00a0<strong>dilatation</strong> of the<strong> labyrinthine blood vessels,\u00a0</strong>thereby improving the microvascular circulation in the stria vascularis of the cochlea. It is also found to\u00a0<strong>inhibit</strong>\u00a0<strong>vestibular nuclei activity</strong>. Other drugs used in the medical management of Meniere's disease are-</p>\n<ul>\n<li>Prochlorperazine\u00a0is a vestibular sedative.</li>\n<li>Diuretics\u00a0such as furosemide and hydrochlorothiazide are used to control recurrent attacks.</li>\n<li>Propantheline bromide, an anticholinergic agent is also found to be effective.</li>\n</ul>\n<p>Other options-\u00a0</p>\n<p>Option A: <strong>Tumarkin\u2019s otolithic crisis\u00a0</strong>(drop attacks)\u00a0is when a patient with <strong>Meniere\u2019s</strong> develops\u00a0<strong>sudden drop attacks</strong> <strong>without loss of consciousness</strong>. It is an uncommon manifestation.\u00a0</p>\n<p>Option C: <strong>Lermoyez syndrome</strong> includes\u00a0<strong>symptoms</strong> <strong>of</strong> <strong>Meniere's</strong> disease seen <strong>in reverse order</strong>. Initially, there is a\u00a0<strong>progressive deterioration of hearing,\u00a0followed by an attack of\u00a0vertigo.</strong></p>\n<p>Option D: <strong>Vestibular hydrops</strong> include <strong>typical episodes of vertigo</strong> while <strong>cochlear function remains intact.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly patient complains of dizziness on standing from a seated position and after large meals. Blood pressure in the supine and standing position is found to be 130/88 and 100/70 mm of Hg respectively. Examination is unrevealing and ECG is normal. What is the pathophysiology behind this patient's presentation?",
    "choices": [
      {
        "id": 1,
        "text": "Decreased vasovagal responsiveness"
      },
      {
        "id": 2,
        "text": "Decreased baroreceptor responsiveness"
      },
      {
        "id": 3,
        "text": "Exaggerated Bezold-Jarisch reflex"
      },
      {
        "id": 4,
        "text": "Exaggerated Bainbridge reflex"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This <strong>elderly</strong> patient presents with <strong>dizziness</strong> on <strong>standing</strong> from a <strong>seated</strong> position and a drop in <strong>systolic</strong> and <strong>diastolic</strong> blood pressures of more than <strong>20 mmHg</strong> and more than <strong>10 mmHg</strong>, respectively, is indicative of <strong>orthostatic</strong> <strong>hypotension</strong>\u00a0due to<strong> age-related</strong> <strong>decreases in baroreceptor responsiveness</strong>.\u00a0<br /><br /><span class=\"s1\">Orthostatic hypotension is defined as reduction in <strong>systolic blood pressure</strong>\u00a0of at least\u00a0<strong>20 mmHg</strong>\u00a0or\u00a0<strong>diastolic blood pressure</strong>\u00a0of at least\u00a0<strong>10 mmHg</strong>\u00a0within<strong>\u00a03 min of standing</strong> or head-up tilt on a tilt table. It manifests as lightheadedness, dizziness, weakness, difficulty thinking, presyncope (near-faintness), and blurred vision.</span></p>\n<p><span class=\"s1\">On standing, blood is displaced to the lower extremities, reducing venous return to the heart. This leads to a decrease in cardiac output and stimulation of compensatory mechanisms which trigger a reflex increase in sympathetic (vasoconstrictor) outflow.<br /></span></p>\n<p><span class=\"s1\"> Orthostatic hypotension is a manifestation of <strong>sympathetic (autonomic) failure</strong>. Orthostatic hypotension also increases with <strong>age</strong> because of the <strong>reduced baroreflex responsiveness</strong>, <strong>decreased cardiac compliance</strong>, and <strong>attenuation</strong> of the <strong>vestibulosympathetic reflex</strong> associated with aging. This is an example of a neurogenic cause of orthostatic hypotension which are aggravated or precipitated by autonomic stressors like a <strong>meal</strong>, <strong>hot bath</strong>, or <strong>exercise</strong>.</span></p>\n<p>In\u00a0<strong>non-neurogenic causes</strong>\u00a0of orthostatic hypotension such as <strong>hypovolemia</strong>, the drop in the blood pressure is accompanied by a compensatory\u00a0<strong>increase in heart rate of &gt;15</strong>\u00a0<strong>beats/min</strong>.\u00a0</p>\n<p><strong>Non-neurogenic causes</strong>\u00a0of orthostatic hypotension include</p>\n<ul>\n<li><strong>Cardiac pump failure</strong> - myocardial infarction, myocarditis, aortic stenosis</li>\n<li><strong>Hypovolemia</strong> - dehydration, diarrhea, hemorrhage</li>\n<li><strong>Metabolic</strong> - adrenocortical insufficiency, pheochromocytoma</li>\n<li><strong>Venous pooling</strong> - sepsis, prolonged standing, or recumbency</li>\n<li><strong>Medications</strong> - alpha-blockers, diuretics, phenothiazines, tricyclic antidepressants</li>\n</ul>\n<p><strong>Treatment</strong>\u00a0includes\u00a0<strong>removing reversible causes</strong>\u00a0like\u00a0<strong>drugs causing hypotension</strong>. Non-pharmacological interventions include\u00a0<strong>patient education</strong>\u00a0regarding staged moves from supine to upright, raising the head of the bed, and increasing dietary fluid and salt. If these fail, drugs like\u00a0<strong>fludrocortisone</strong>\u00a0and\u00a0<strong>midodrine</strong>\u00a0can be given.<br /><br />Option A : Increased <strong>vasovagal</strong> <strong>reflex</strong> is seen in <strong>vasovagal syncope</strong> triggered by <strong>emotional stressors</strong>.<br /><br />Option C :\u00a0<strong>Bezold-Jarisch reflex </strong>is characterized by<strong> profound brady\u00adcardia, hypotension, </strong>and a<strong> brief period of apnea </strong>followed by<strong> rapid shallow breathing </strong>due to the <strong>activation of chemosensitive vagal C fibers </strong>in the<strong> cardiopulmonary region. </strong>They can be elicited after administering<strong> irritants like capsaicin or serotonin. </strong>It can also be activated<strong> during myocardial infarction </strong>and on exposure to<strong> radioactive dyes during coronary angiography.\u00a0</strong><br /><br />Option D : <strong>Bainbridge reflex</strong> is a compensatory <strong>increase in heart rate</strong> following an <strong>increase in cardiac preload</strong>. Cardiac preload drops in orthostatic hypotension.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old male patient complains of continuous dizziness and nausea since 3 days that is present at rest and worsens with head movement. Examination findings are given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Benign positional paroxysmal vertigo"
      },
      {
        "id": 2,
        "text": "Labyrinthitis"
      },
      {
        "id": 3,
        "text": "Vestibular neuritis"
      },
      {
        "id": 4,
        "text": "Meniere's disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This scenario is a case of left <strong>vestibular neuritis</strong> which is characterized by <strong>continuous</strong> episodes of <strong>vertigo</strong> that is present at <strong>rest</strong> and <strong>worsens</strong> with <strong>head movement</strong>. <strong>Nystagmus</strong> occurs <strong>spontaneously</strong> without head movement, and is <strong>unidirectional.\u00a0Positive</strong> (<strong>abnormal</strong>) <strong>head impulse</strong> test, <strong>lack</strong> of <strong>skew deviation</strong> of the eyes and <strong>unidirectional</strong> nystagmus differentiates it from <strong>central</strong> causes of vertigo.<br /><br /><strong>Vestibular neuritis</strong> <strong>(VN)</strong> presents with vestibular symptoms like <strong>sudden onset</strong> of <strong>persistent vertigo</strong> with associated symptoms such as <strong>nausea</strong>, <strong>vomiting</strong>, and <strong>imbalance</strong>. Unlike <strong>benign paroxysmal positional vertigo</strong> (<strong>BPPV</strong>, Option A), <strong>continuous</strong> vertigo persists even when the head remains still. <strong>Spontaneous</strong> <strong>unidirectional</strong> <strong>nystagmus</strong> is present, occurring without head movement. <br /><br /><strong>Head impulse test</strong> involves the <strong>vestibulo-ocular reflex</strong>, and is <strong>abnormal</strong> (<strong>positive</strong>) in acute <strong>peripheral</strong> vestibular lesions such as VN. An abnormal test would be eyes dragged off target with corrective saccades back to the target. Eyes focused on the target after head movement would be a normal response.\u00a0<br /><br />Vestibular neuritis <strong>resolves</strong> <strong>spontaneously</strong>, but <strong>glucocorticoids</strong> can improve outcomes if administered within 3 days of symptom onset. <strong>Antiviral</strong> medications are only suggested for <strong>Herpes zoster oticus (Ramsay Hunt syndrome)</strong>. <strong>Vestibular suppressant</strong> medications can reduce <strong>acute</strong> symptoms. Patients should be encouraged to resume normal activity as soon as possible. <strong>Vestibular rehabilitation</strong> therapy can also be tried.<br /><br /><strong>Central</strong> vertigo is indicated by a <strong>n</strong><strong>ormal head impulse test</strong>, <strong>vertical skew deviation</strong> and <strong>bidirectional nystagmus </strong>(direction of saccades changes with gaze direction). Other neurologic features that point to central dysfunction include <strong>diplopia, weakness</strong> and <strong>dysarthria</strong>. Older patients with vascular risk factors presenting with acute vestibular syndrome should be evaluated for possibility of a stroke.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9d7e8eec04d9445fb4d1493a987e329fx1280x912.JPEG"
    ]
  },
  {
    "text": "A patient complains of dizziness that is triggered by exposure to loud sounds. This phenomenon is unlikely to be seen in which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Otosyphilis"
      },
      {
        "id": 2,
        "text": "Superior semicircular canal dehiscence syndrome"
      },
      {
        "id": 3,
        "text": "Perilymph fistula"
      },
      {
        "id": 4,
        "text": "Otosclerosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>tullio phenomenon</strong>, which is <strong>vertigo triggered by loud sounds</strong> is <strong>not seen in otosclerosis</strong>.<br /><br /><strong>Tullio phenomenon</strong> describes the <strong>vertiginous</strong> <strong>episodes</strong>, <strong>unsteadiness</strong>, <strong>nausea,</strong> and <strong>nystagmus</strong> when exposed to <strong>loud sounds</strong> or <strong>noise</strong>. This phenomenon is due to the <strong>distended saccule lying against the stapes footplate</strong>.<br /><br />This is seen in cases of <strong>Meniere's disease</strong>. It is also seen whenever there is a <strong>third mobile window lesion</strong> such as <strong>otic syphilis</strong>, <strong>perilymph fistula,</strong> and <strong>dehiscence of semicircular canals</strong>. <strong>Vestibular activation</strong> can result from a <strong>breach in the bony capsule</strong> of semicircular canals, which <strong>redirects a portion of sound or pressure</strong> to the <strong>semicircular canals</strong>.\u00a0</p>\n<p><strong>Otosclerosis</strong> is the <strong>disease of the bony labyrinth</strong> in which a <strong>normally dense endochondral layer</strong> of the bony otic capsule is <strong>replaced by irregularly laid spongy bone</strong>. It is more commonly seen in <strong>females</strong> between <strong>20-30 years of age</strong> and the <strong>hearing loss</strong> is <strong>aggravated</strong> during <strong>pregnancy and menopause</strong>.</p>\n<p>Patients present with a <strong>bilateral conductive type of hearing loss</strong>, <strong>tinnitus</strong> (commonly in cochlear type and active stage), <strong>paracusis willisii</strong> (<strong>better hearing in noisy surroundings</strong> than in a quiet place), <strong>vertigo</strong>, and a <strong>monotonous</strong>, <strong>well-modulated soft speech</strong>. <strong>Pure tone audiometry</strong> shows a <strong>dip at 2000 Hz</strong> in the <strong>bone conduction curve</strong> known as the <strong>Carhart's notch</strong>.</p>\n<p>Other options :<br /><br />Option A: <strong>Otosyphilis</strong> results in <strong>fistulae formation</strong> in the <strong>labyrinth</strong> leading to Tullio phenomenon.</p>\n<p>Option B: <strong>Superior semicircular canal dehiscence</strong> syndrome occurs due to the <strong>third window effect</strong> created by the dehiscent wall of the superior semicircular canal. This causes <strong>endolymph in the labyrinthine system</strong> to <strong>move with sound or pressure</strong>, causing an <strong>activation of the vestibular system</strong>. It is usually diagnosed in <strong>middle-aged </strong>individuals. Etiology may be <strong>congenital</strong> or <strong>acquired</strong> from <strong>cranial trauma</strong>.</p>\n<p>Option C: A <strong>perilymph fistula</strong> is an <strong>abnormal connection</strong> between the <strong>inner ear and middle ear</strong>, resulting in <strong>leakage of perilymph</strong> from the cochlea or vestibule. This most commonly occurs <strong>through</strong> the <strong>round or oval window</strong>. Causes include <strong>post-stapedectomy</strong>, ear surgery with dislocation of the stapes, <strong>head trauma,</strong> and <strong>inner ear injury</strong> due to <strong>forceful Valsalva</strong> or <strong>barotrauma</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 25 year old male patient comes to the emergency room with complaints of dizziness, neck pain and headache since the past 2 hours following neck trauma. Damage of which of the following vessels is most likely responsible for this patient's presentation?",
    "choices": [
      {
        "id": 1,
        "text": "Carotid artery"
      },
      {
        "id": 2,
        "text": "Internal jugular vein"
      },
      {
        "id": 3,
        "text": "Vertebral artery"
      },
      {
        "id": 4,
        "text": "Vertebral vein"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This is a case of\u00a0<strong>vertebral artery dissection\u00a0</strong>characterized by\u00a0<strong>dizziness, severe headache and neck pain\u00a0</strong>following\u00a0<strong>neck trauma</strong>.\u00a0<br /><br /><strong>Vertebral artery dissection (VAD)</strong> is a common cause of <strong>stroke</strong> in patients <strong>younger than 45</strong> years. It can <strong>occur</strong> <strong>spontaneously</strong>, but <strong>incidental minor trauma</strong> and <strong>neck distortion</strong> caused by <strong>chiropractic</strong> <strong>manipulation</strong>, <strong>bending of the neck</strong>, or <strong>blunt trauma</strong> causes the dissection. Patients complain of <strong>severe neck pain</strong>, <strong>headache,</strong> and <strong>dizziness/vertigo</strong> following precipitating factors.</p>\n<p>VAD is <strong>visualized on MR angiography</strong> and <strong>CT angiography</strong>. VAD is <strong>treated with anticoagulants</strong> such as <strong>heparin</strong> to prevent stroke. <strong>Thrombolysis</strong> can be started <strong>within 4.5 hours</strong> of symptom onset if there are no contraindications.<br /><br />VAD occurs due to an <strong>intimal tear</strong> and <strong>arterial blood dissecting</strong> into the layers of the arterial wall causing <strong>hematoma</strong> and <strong>clot formation</strong>. This causes <strong>stenosis</strong>, compromised arterial blood flow and thromboembolism leading to symptoms of <strong>VAD</strong> and <strong>stroke</strong>. <strong>Lateral medullary syndrome</strong> (<strong>Wallenberg syndrome</strong>) and <strong>cerebellar infarctions</strong> are the <strong>most common location</strong> for <strong>strokes</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fffffee58ae8410e9bea807bf29b9dd6x1280x1657.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/52fa0421a4314ed39aed9757600187ecx532x600.JPEG"
    ]
  },
  {
    "text": "A 30 year old woman presents with severe dizziness that has been occurring several times a month for the past year, which are occasionally accompanied by throbbing headaches, nausea and vomiting. She also has a history of headaches characterised by severe throbbing pain on one side of her head, sensitivity to light and sound, nausea and vomiting. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Vestibular migraine"
      },
      {
        "id": 2,
        "text": "Basilar migraine"
      },
      {
        "id": 3,
        "text": "Lateral medullary syndrome"
      },
      {
        "id": 4,
        "text": "Meniere's disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient is likely suffering from <strong>vestibular migraine</strong>, which is characterized by a history of <strong>vertigo and migraines</strong>.</p>\n<p>Vestibular migraine is a type of <strong>migraine</strong> featuring <strong>vertigo episodes</strong>, <strong>motion intolerance</strong>, <strong>persistent dizziness</strong> and <strong>disequilibrium</strong>. It is the <strong>most common cause</strong> of <strong>central vertigo in adults and children</strong>.</p>\n<p><strong>Headaches</strong> <strong>may or may not occur concurrently</strong> with vertigo, and hence it is important to take a thorough <strong>history of</strong> <strong>migraine</strong> in the past.\u00a0</p>\n<p>The <strong>diagnostic criteria</strong> for <strong>vestibular migraine</strong> consist of the following:</p>\n<ul>\n<li><strong>At least 5 episodes</strong> <strong>of vestibular</strong> <strong>symptoms</strong> of <strong>moderate or severe intensity</strong> lasting <strong>5 minutes to 72 hours</strong></li>\n<li><strong>Current or previous history of migraines</strong> <strong>with or without aura</strong></li>\n<li><strong>One or more</strong> of the following <strong>migraine features</strong> with at least 50% of vestibular episodes:\n<ul>\n<li><strong>Headache</strong> with <strong>at least 2 </strong>of the following characteristics : <strong>One-sided </strong>location, <strong>pulsating</strong> quality, <strong>moderate or severe pain</strong> intensity,</li>\n<li><strong>Photophobia/phonophobia</strong></li>\n<li>Visual aura</li>\n</ul>\n</li>\n<li>Not better accounted for by another diagnosis</li>\n</ul>\n<p>The <strong>pathophysiology</strong> of vestibular migraine is <strong>unknown</strong>, but the vestibular symptoms may be an <strong>aura</strong>, an <strong>associated symptom</strong>, or due to <strong>peripheral</strong> <strong>vestibulopathy</strong>.</p>\n<p><strong>Migraine</strong> is an <strong>episodic</strong>, <strong>unilateral</strong> <strong>throbbing</strong> <strong>headache</strong> associated with features like <strong>sensitivity to light, sound or movement</strong>. <strong>Nausea</strong> and <strong>vomiting</strong> often accompany the headache. Patient may have <strong>aura</strong> (<strong>classical migraine</strong>) in which the headache is <strong>preceded by visual or other neurological</strong> <strong>symptoms</strong>, or <strong>may not have aura (common migraine)</strong>. Common <strong>triggers</strong> include <strong>bright lights, sounds, and hunger</strong>. The release of <strong>vasoactive</strong> <strong>peptides</strong> such as <strong>calcitonin gene-related peptide (CGRP)</strong> by the <strong>trigeminal nucleus cells</strong> is the theory used to explain the pathogenesis of the condition. The <strong>neurotransmitters serotonin</strong> and <strong>dopamine</strong> also play a part.</p>\n<p>A <strong>migraine attack</strong> has <strong>four phases</strong>: <strong>premonitory (prodrome)</strong>, <strong>aura</strong>, <strong>headache</strong> and <strong>postdrome</strong>; each has distinct and sometimes disabling symptoms, which may overlap.</p>\n<p>Other options. :<br /><br />Option B : <strong>Basilar migraine</strong> is a migraine with <strong>predominant brainstem aura</strong>. It is associated with brainstem aura symptoms such as <strong>vertigo</strong>, <strong>dysarthria, diplopia, tinnitus, hearing loss, lack of coordination,</strong> and <strong>loss of consciousness</strong>. It is common in <strong>adolescent girls</strong>.</p>\n<p>Option C : <strong>Lateral medullary syndrome</strong> (<strong>wallenberg</strong> syndrome) is due to <strong>occlusion</strong> of the <strong>ipsilateral vertebral artery</strong> or <strong>posterior inferior cerebellar</strong> <strong>artery</strong> resulting in the following findings :</p>\n<ul>\n<li>Descending tract and nucleus of <strong>cranial nerve V:</strong> <strong>Ipsilateral impaired sensation</strong> over <strong>half of the face</strong></li>\n<li>IX and X cranial nerves: <strong>Ipsilateral paralysis of palate</strong>, <strong>vocal cord,</strong> <strong>diminished gag reflex</strong></li>\n<li>Nucleus of Tractus solitarius: <strong>Ipsilateral</strong> <strong>loss</strong> of <strong>taste</strong></li>\n<li>Vestibular nucleus: <strong>Nystagmus</strong>, <strong>diplopia</strong>, <strong>vertigo</strong>, <strong>nausea</strong></li>\n<li>Spinocerebellar tract: <strong>Ipsilateral</strong> <strong>ataxia</strong></li>\n<li>Descending sympathetic tract: <strong>Ipsilateral</strong> <strong>Horner\u2019s syndrome</strong></li>\n<li>Lateral spinothalamic tract: <strong>Contralateral impaired pain</strong> and thermal sensation over half of body</li>\n</ul>\n<p>Option D : <strong>Meniere's disease</strong> (<strong>endolymphatic hydrops</strong>) is an inner ear disorder where the endolymph distends the endolymphatic system. The disease is usually unilateral. It is characterized by <strong>episodic vertigo, fluctuating sensorineural hearing loss, tinnitus,</strong> and a <strong>sense of ear fullness</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65 year old male patient complains of dizziness and tinnitus 1 week after being discharged from the hospital. Medications he received in the hospital are listed below. Which of the following likely contributed to the patient\u2019s current symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 5"
      },
      {
        "id": 2,
        "text": "1, 2, 4"
      },
      {
        "id": 3,
        "text": "2, 3, 5"
      },
      {
        "id": 4,
        "text": "1, 3, 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The patient is suffering from delayed onset <strong>drug induced ototoxicity\u00a0</strong>from\u00a0<strong>gentamicin, ibuprofen, and furosemide </strong>use. <br /><br /><strong>Ototoxicity</strong> is characterized by <strong>high-frequency hearing loss</strong>, <strong>tinnitus</strong> and <strong>vestibular dysfunction</strong>. Ototoxic drugs can be <strong>primarily vestibulotoxic</strong> (damage the<strong> hair cells</strong> of the <strong>inner ear</strong>) or <strong>cochleotoxic</strong>. Examples include antimicrobials (<strong>gentamicin</strong> and <strong>streptomycin</strong>), diuretics (<strong>furosemide</strong>) and NSAIDs (<strong>ibuprofen</strong>). Certain other drugs which cause dizziness or unsteadiness are antihypertensives, labyrinthine sedatives, oestrogen preparations, diuretics, antimicrobials (nalidixic acid, metronidazole) and <strong>antimalarials</strong>.\u00a0<br /><br />Patients with <strong>impaired</strong> <strong>renal</strong> <strong>function</strong>, <strong>elderly</strong> (&gt; 65 years), <strong>concomitant ototoxic</strong> drug use, <strong>past aminoglycoside</strong> <strong>use</strong>, and <strong>genetic susceptibility</strong> to aminoglycosides are at <strong>increased risk of ototoxicity</strong>. Symptoms of ototoxicity, hearing loss, tinnitus and/or giddiness may manifest <strong>during treatment</strong> or <strong>after completion</strong> of the treatment (<strong>delayed toxicity</strong>).\u00a0<br /><br /><strong>Aminoglycosides</strong> include streptomycin, gentamicin, tobramycin, amikacin, and kanamycin.\u00a0 <strong>Streptomycin</strong>, <strong>gentamicin</strong> and <strong>tobramycin</strong> are the most <strong>vestibulotoxic</strong>. <strong>Amikacin</strong>, <strong>kanamycin</strong>, and <strong>neomycin</strong> mainly affect <strong>auditory</strong> functions.\u00a0<br /><br />Other options :\u00a0<br /><br />Metformin (2) and warfarin (5) are not known to be ototoxic.<br /><br /></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-year-old male patient presents with dizziness and fatigue during a marathon. The patient is oriented and diaphoretic. Vitals reveal heart rate of 100/min, blood pressure of 90/60 mm of Hg and temperature of 101 \u00b0F. ECG is normal. His condition improves gradually after IV fluids. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Heat stroke"
      },
      {
        "id": 2,
        "text": "Heat exhaustion"
      },
      {
        "id": 3,
        "text": "Heat syncope"
      },
      {
        "id": 4,
        "text": "Heat cramps"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient's clinical features of <strong>dizziness, fatigue, hypotension, preserved thermoregulatory control</strong> (<strong>temperature &lt; 105 \u00b0F)</strong> and <strong>absence of central nervous system dysfunction</strong> following <strong>endurance exercise</strong> (marathons) and exposure to <strong>high ambient temperature</strong> most likely points to a diagnosis of <strong>heat exhaustion</strong>.</p>\n<p><strong>Heat exhaustion</strong> is caused by <strong>excessive exposure to heat</strong>, leading to nausea, vomiting, <strong>dizziness</strong>, thirst, fatigue, headache, <strong>sweating</strong>, and decreased urine output. Body temperature may rise but <strong>does not exceed 40.5\u00b0C (105\u00b0F)</strong>. Heat exhaustion is distinct from heat stroke as the body <strong>maintains thermoregulation</strong> and <strong>no CNS dysfunction </strong>occurs. Prompt treatment is essential to prevent progression to life-threatening heat stroke. <strong>Diagnosis</strong> involves <strong>ruling out heat stroke</strong>.<br /><br /><strong>Heat stroke </strong>(Option A)\u00a0is characterized by a raised core temperature of<strong>\u00a0 &gt; </strong><strong>40.5\u00b0C [105\u00b0F] </strong>due to\u00a0<strong>loss of thermoregulatory function\u00a0</strong>and failure of sweating.<strong>\u00a0</strong>Predisposing factors include high temperature, increased humidity, infections, old age, lack of acclimatization, and alcoholism. Heat stroke can be of two types:</p>\n<ul>\n<li><strong>Classic </strong>heat stroke (CHS)\u00a0seen in those with\u00a0<strong>chronic diseases</strong> who are predisposed to heat-related illnesses.\u00a0</li>\n<li><strong>Exertional\u00a0</strong>heat stroke (EHS) is seen in <strong>young, previously healthy</strong> people with prolonged exposure to or physical exertion in high temperatures.\u00a0</li>\n</ul>\n<p>Heat stroke usually presents as a sudden collapse. The skin is dry, flushed, and hot. <strong>Sweating\u00a0</strong>is\u00a0<strong>absent</strong>\u00a0in<strong>\u00a0CHS\u00a0</strong>but<strong>\u00a0</strong>present\u00a0in about\u00a050% of<strong>\u00a0</strong>cases\u00a0of\u00a0EHS<strong>. </strong>Tachypnea (rapid Kussmaul breathing), tachycardia, hypotension, and widened pulse pressure are other findings.</p>\n<p>CNS dysfunction includes <strong>delirium</strong>, coma, and convulsions. Thermal cardiomyopathy and heat-related reversible increase in cardiac biomarker levels are also seen. ECG findings include <strong>tachyarrhythmias</strong>, nonspecific\u00a0<strong>ST-T wave changes</strong>, and heat-related ischemia or\u00a0<strong>infarction</strong>. Other complications include\u00a0<strong>rhabdomyolysis</strong>,\u00a0<strong>disseminated intravascular coagulation</strong>\u00a0(DIC), and\u00a0<strong>multiorgan failure.<br /><br /></strong>Heat stroke is managed by <strong>rapid cooling,</strong>\u00a0<strong>continuous monitoring</strong>\u00a0with a\u00a0<strong>rectal thermistor\u00a0</strong>(flexible thermometer), <strong>f</strong><strong>luid resuscitation</strong> and <strong>correction of e</strong><strong>lectrolyte</strong> and <strong>metabolic abnormalities</strong>\u00a0(<strong>hyponatremia</strong>\u00a0and\u00a0<strong>hypoglycemia</strong>).</p>\n<p>Other options :\u00a0</p>\n<p>Option C: <strong>Heat</strong> <strong>syncope</strong> <strong>(exercise associated collapse)</strong>\u00a0is when the <strong>patient collapses</strong> following<strong> endurance exercise</strong> or<strong>\u00a0prolonged standing</strong> in the <strong>heat.</strong>\u00a0Heat stress causes relative <strong>volume depletion</strong>, <strong>decreased vasomotor tone</strong>, and <strong>peripheral vasodilation</strong>. This results in <strong>decreased venous return</strong> and <strong>postural</strong> <strong>hypotension</strong>, especially in<strong> nonacclimated elderly</strong> individuals. After removal from heat source, most patients<strong> recover promptly </strong>with <strong>cooling</strong> and <strong>rehydration</strong>.\u00a0<br /><br />Option D:<strong>\u00a0Heat cramps</strong>\u00a0are painful muscle spasms caused by the loss of water and salt in high temperatures due to\u00a0<strong>profuse sweating.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient comes with complaints of dizziness and is found to have unidirectional nystagmus on examination. Suspecting a peripheral cause of vertigo, which of the following would you consider in the differential diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 4"
      },
      {
        "id": 2,
        "text": "3, 5"
      },
      {
        "id": 3,
        "text": "1, 3"
      },
      {
        "id": 4,
        "text": "2, 4, 5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Acoustic neuroma</strong>,<strong> Meniere's disease</strong>, and <strong>vestibular neuronitis</strong> are examples of <strong>peripheral</strong> causes of <strong>vertigo</strong> as they involve the <strong>vestibular</strong> <strong>end</strong> <strong>organs </strong>and <strong>vestibular nerve</strong>.<br /><br />Disorders of the vestibular system cause <strong>vertigo</strong> and are divided into <strong>peripheral</strong> and <strong>central</strong> <strong>causes</strong>. <strong>Peripheral</strong> <strong>causes</strong> of vertigo involve the <strong>internal</strong> <strong>ear</strong> and <strong>vestibular nerve</strong> before it enters the brainstem.\u00a0Vertigo<strong>\u00a0</strong>is the most common cause of\u00a0dizziness<strong> </strong>and refers to\u00a0a sense of spinning or other\u00a0motion<strong>\u00a0</strong>that may be\u00a0<strong>physiological</strong>, occurring during/after a <strong>sustained head rotation</strong>, or\u00a0<strong>pathological,\u00a0</strong>due to\u00a0<strong>vestibular dysfunction.\u00a0</strong>It is due to the <strong>asymmetry\u00a0</strong>of <strong>vestibular inputs\u00a0</strong>from the <strong>two</strong>\u00a0<strong>labyrinths </strong>or in their\u00a0<strong>central pathway.</strong></p>\n<p><strong>Central\u00a0</strong>causes of vertigo are associated with other central nervous system signs such as <strong>dysarthria, diplopia, </strong>and<strong> ataxia.\u00a0<br /><br /></strong>Vertigo is also associated with\u00a0<strong>nystagmus </strong>which\u00a0is a rhythmical, involuntary, and oscillatory movement of the eyes. It can be\u00a0<strong>horizontal</strong>,\u00a0<strong>vertical</strong>, or<strong> rotatory. </strong>The following features can be used to<strong> </strong>differentiate<strong> </strong>between<strong> peripheral and central nystagmus.<br /><br /></strong></p>\n<table width=\"534\">\n<tbody>\n<tr>\n<td style=\"width: 166.086px;\">Nystagmus</td>\n<td style=\"width: 160.68px;\">Peripheral lesion</td>\n<td style=\"width: 164.844px;\">Central lesion</td>\n</tr>\n<tr>\n<td style=\"width: 166.086px;\">Latency</td>\n<td style=\"width: 160.68px;\">2-20 seconds</td>\n<td style=\"width: 164.844px;\">No latency</td>\n</tr>\n<tr>\n<td style=\"width: 166.086px;\">Duration</td>\n<td style=\"width: 160.68px;\">Less than one minute</td>\n<td style=\"width: 164.844px;\">More than one minute</td>\n</tr>\n<tr>\n<td style=\"width: 166.086px;\">Direction</td>\n<td style=\"width: 160.68px;\">Fixed</td>\n<td style=\"width: 164.844px;\">Changes</td>\n</tr>\n<tr>\n<td style=\"width: 166.086px;\">Fatiguability</td>\n<td style=\"width: 160.68px;\">Fatiguable</td>\n<td style=\"width: 164.844px;\">Nonfatiguable</td>\n</tr>\n<tr>\n<td style=\"width: 166.086px;\">Associated symptoms</td>\n<td style=\"width: 160.68px;\">Severe vertigo</td>\n<td style=\"width: 164.844px;\">None or slight</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/448001da21a1482ab44cffb4cde92e2bx1280x912.JPEG"
    ]
  },
  {
    "text": "A 58-year-old woman presents with complaints of episodic dizziness, right-sided facial weakness, tinnitus, and progressive hearing loss. A reddish mass is seen behind the tympanic membrane which blanches on applying pressure. It was removed surgically and the histopathology showed the following slide. Which of the following is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hemangioendothelioma"
      },
      {
        "id": 2,
        "text": "Capillary hemangioma"
      },
      {
        "id": 3,
        "text": "Acoustic neuroma"
      },
      {
        "id": 4,
        "text": "Glomus tumour"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The diagnosis in the above case is a <strong>Glomus tumor</strong>.</p>\n<p>Glomus tumor is an\u00a0<strong>extremely vascular\u00a0</strong>benign tumor. Glomus tumor is the most common <strong>benign neoplasm</strong> of the middle ear. It originates from the glomus bodies and consists of paraganglionic cells from the neural crest.\u00a0It is a nonencapsulated <strong>tumor</strong> and a locally invasive tumor.\u00a0</p>\n<p>Glomus tumor is most often seen in <strong>women</strong> in the fourth to fifth decade of life.</p>\n<p>A patient typically presents with <strong>progressive conductive hearing loss</strong>, <strong>pulsatile tinnitus</strong>, <strong>dizziness</strong>, and <strong>facial paralysis</strong>. If the tumor presents as a polyp, a history of spontaneous bleeding from the ear is seen.</p>\n<p>Otoscopy examination shows a red reflex through an intact tympanic membrane as a\u00a0<strong>\"rising sun\"</strong>\u00a0appearance since the tumor arises from the floor of the middle ear.</p>\n<p>Clinical and radiological features are enough to arrive at a diagnosis. Treatment consists of:</p>\n<ul>\n<li aria-level=\"2\">Surgical removal.</li>\n<li aria-level=\"2\">Radiation.</li>\n<li aria-level=\"2\">Embolization.</li>\n<li aria-level=\"2\">Combination of the above</li>\n</ul>\n<p>These tumors arise from <strong>modified smooth muscle cells</strong> of the <strong>glomus bodies\u00a0</strong>which\u00a0are specialized arteriovenous structures involved in thermoregulation. They are benign but extremely painful due to abundant nerve fibers.</p>\n<p>Histopathology shows<strong> branching vascular channels</strong> separated by stroma containing glomus cells in nests:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8b4fb68c4e0f4c8186573754dafd022d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/874cd82f2731426082913cfeaf561773x1280x853.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/66608e07536d4823a515db5e574bb28ex1280x853.JPEG"
    ]
  },
  {
    "text": "An elderly patient with known cardiovascular disease presents with sudden onset vertigo. Suspecting a central cause of vertigo, which of the following features distinguishes lateral pontine syndrome from lateral medullary syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Ipsilateral limb and gait ataxia"
      },
      {
        "id": 2,
        "text": "Contralateral loss of pain and temperature over body"
      },
      {
        "id": 3,
        "text": "Ipsilateral Horner\u2019s syndrome"
      },
      {
        "id": 4,
        "text": "Ipsilateral lower motor neuron facial paralysis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Ipsilateral lower motor neuron facial paralysis</strong> is seen in <strong>lateral pontine syndrome</strong> and helps differentiate it from lateral medullary syndrome.</p>\n<p><strong>Lateral pontine syndrome</strong> occurs due to <strong>occlusion of the anterior inferior cerebellar artery</strong>. Presence of <strong>complete ipsilateral facial palsy</strong> indicates a <strong>LMN lesion</strong> which inturn points towards lateral pontine syndrome. If <strong>ipsilateral upper facial muscles</strong> are <strong>spared</strong>, this would indicate a <strong>UMN lesion</strong>, which inturn points towards <strong>lateral medullary syndrome</strong>.<br /><br /><strong>Ipsilateral manifestations</strong> of <strong>lateral pontine syndrome</strong> include:</p>\n<ul>\n<li>CN VII: <strong>Lower motor neuron facial paralysis </strong></li>\n<li>CN V: <strong>loss of pain and temperature</strong> sensation over the <strong>face</strong>.</li>\n<li>Vestibular nerve or nucleus: <strong>Horizontal and vertical nystagmus</strong>, <strong>vertigo</strong>, <strong>nausea, vomiting, oscillopsia</strong>.</li>\n<li>Auditory nerve or cochlear nucleus: <strong>Deafness, tinnitus</strong>.</li>\n<li>Middle cerebellar peduncle: <strong>Ataxia of limb and gait</strong>.</li>\n<li>Descending sympathetic tract: <strong>Horner\u2019s syndrome</strong> (miosis, ptosis, and anhidrosis).</li>\n</ul>\n<p><strong>Contralateral manifestations</strong> of <strong>lateral pontine syndrome</strong> include <strong>loss of pain and temperature sensation</strong> over the <strong>body</strong> due to lateral spinothalamic tract involvement.</p>\n<p><strong>Occlusion</strong> of <strong>posterior inferior cerebellar artery</strong> causes <strong>lateral medullary syndrome</strong> or <strong>Wallenberg syndrome</strong>. The clinical findings correspond to the neuroanatomical structures affected in the lateral portion of the medulla:</p>\n<ul>\n<li>Descending tract and nucleus of CN V (trigeminal)- <strong>loss of pain and sensation</strong> over the <strong>ipsilateral half of the face</strong>.</li>\n<li>Inferior cerebellar peduncle \u2013 <strong>ipsilateral ataxia (gait and limb)</strong></li>\n<li>Lateral spinothalamic tract \u2013 <strong>loss of pain and temperature sensation</strong> over the <strong>contralateral half of the body</strong>.</li>\n<li>IX and X CN - ipsilateral paralysis of palate, vocal cord, diminished gag reflex giving rise to <strong>dysphagia, dysarthria</strong>.</li>\n<li>Vestibular nucleus - <strong>Nystagmus, diplopia, vertigo, nausea</strong></li>\n<li>Descending sympathetic tract \u2013 <strong>ipsilateral</strong> <strong>Horner\u2019s syndrome</strong> (miosis, ptosis, and anhidrosis).</li>\n<li><strong>Ipsilateral upper motor neuron facial paralysis</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/acbc0dd7bfa24c77ab0833e01721f548x1280x1674.JPEG"
    ]
  },
  {
    "text": "A 35-year-old female patient with major depression presents with a 4-month history of episodic dizziness occurring at rest and exacerbated by standing and watching movies. Blood pressure on sitting and standing remains constant. Examination and imaging findings are normal. If psychosomatic dizziness is suspected, which of the following is indicated?",
    "choices": [
      {
        "id": 1,
        "text": "Meclizine"
      },
      {
        "id": 2,
        "text": "Duloxetine"
      },
      {
        "id": 3,
        "text": "Promethazine"
      },
      {
        "id": 4,
        "text": "Scopolamine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>SNRIs</strong> such as <strong>duloxetine\u00a0</strong>are indicated for treating cases of <strong>psychosomatic dizziness</strong> (persistent postural perceptual dizziness)\u00a0seen in patients with depression and anxiety, and is characterized by a\u00a0<strong>chronic feeling (&gt;3 months)\u00a0</strong>of\u00a0<strong>fluctuating dizziness\u00a0</strong>that is present at\u00a0<strong>rest\u00a0</strong>and worsens with <strong>standing\u00a0</strong>and\u00a0<strong>visual motion\u00a0</strong>(watching movies, shopping in a supermarket).\u00a0<strong>Neurologic\u00a0</strong>examination is\u00a0<strong>normal</strong>.<br /><br /><strong>Psychological factors\u00a0</strong>are implicated as a cause of chronic dizziness. Dizziness may be a\u00a0<strong>somatic manifestation\u00a0</strong>of\u00a0<strong>depression, anxiety\u00a0</strong>and\u00a0<strong>panic disorder</strong>. Patients with\u00a0<strong>persistent postural perceptual dizziness </strong>have <strong>chronic fluctuating episodes of dizziness </strong>(&gt;3 months) that is\u00a0<strong>present at rest\u00a0</strong>but\u00a0<strong>worse when standing.\u00a0</strong>There is an intensification of symptoms with visual motion (watching movies or shopping in supermarkets). They may also be associated with a past history of\u00a0<strong>vestibular neuritis.\u00a0<br /><br /></strong><strong>Neurologic\u00a0</strong>and <strong>vestibular examination\u00a0</strong>is <strong>normal. Comorbid anxiety disorders\u00a0</strong>can contribute the patients symptoms.\u00a0<br /><br />Patients are treated with <strong>SSRIs, cognitive behavioral therapy </strong>and\u00a0<strong>vestibular rehabilitation. Vestibular suppressant medications\u00a0</strong>such as\u00a0<strong>meclizine, promethazine\u00a0</strong>and\u00a0<strong>scopolamine\u00a0</strong>should be avoided.\u00a0<br /><br />Disorders of the vestibular system cause <strong>vertigo</strong> and are divided <strong>peripheral</strong> and <strong>central</strong> causes. Peripheral causes of vertigo involve the <strong>internal ear</strong> and <strong>vestibular nerve</strong> before it enters the brainstem. <strong>Vertigo</strong> is the <strong>most common cause</strong> of <strong>dizziness</strong> and refers to a sense of spinning or other motion that may be <strong>physiological</strong>, occuring during/after a <strong>sustained head rotation</strong>, or <strong>pathological</strong>, due to <strong>vestibular dysfunction</strong>. It is due to <strong>asymmetry</strong> of <strong>vestibular inputs</strong> from the two labyrinths or in their central pathway.<br /><br />Vertigo is also associated with <strong>nystagmus</strong> which is a <strong>rhythmical</strong>, <strong>involuntary</strong>, and <strong>oscillatory</strong> movement of the eyes. It can be <strong>horizontal</strong>, <strong>vertical</strong>, or <strong>rotatory</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient complains of imbalance and blurry vision while walking. He was started on gentamicin 1 week ago. Head impulse test is abnormal in both directions and responses to caloric testing are reduced. Apart from discontinuing gentamicin which of the following is the most appropriate management?",
    "choices": [
      {
        "id": 1,
        "text": "Vestibular suppressant"
      },
      {
        "id": 2,
        "text": "Vestibular rehabilitation"
      },
      {
        "id": 3,
        "text": "Vestibular implant"
      },
      {
        "id": 4,
        "text": "Observation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This is a scenario of <strong>bilateral vestibular hypofunction</strong> following <strong>gentamicin use </strong>and is characterized by complaints of <strong>imbalance while walking</strong>, <strong>blurry vision with head movement</strong> (<strong>oscillopsia</strong>), <strong>bilateral abnormal head impulse test,</strong> and <strong>reduced response to caloric testing</strong>. The most appropriate management is <strong>vestibular rehabilitation</strong>.</p>\n<p><strong>Bilateral vestibular hypofunction</strong> (BVH) is <strong>most commonly</strong> <strong>caused</strong> by <strong>vestibulotoxic effects</strong> of <strong>aminoglycosides</strong> such as <strong>gentamicin</strong>. Clinical signs of vestibulotoxicity occur <strong>about a week</strong> after gentamicin administration. Bedside tests of vestibular function such as assessment of <strong>dynamic</strong> <strong>visual acuity</strong> and <strong>head impulse test</strong> should be performed daily to <strong>stop gentamicin</strong> if vestibulotoxicity occurs.\u00a0</p>\n<p><strong>Causes</strong> of BVH include :\u00a0</p>\n<ul>\n<li><strong>Idiopathic</strong></li>\n<li>Part of a <strong>neurodegenerative</strong> disorder</li>\n<li><strong>Iatrogenic</strong> (medication ototoxicity)</li>\n<li>Other causes: degenerative diseases of the cerebellum, <strong>meningitis</strong>, systemic <strong>autoimmune</strong> diseases, <strong>trauma</strong>, <strong>bilateral M\u00e9ni\u00e8re</strong> disease, and <strong>bilateral vestibular schwannomas</strong> (neurofibromatosis type 2)</li>\n</ul>\n<p>Bilateral loss of vestibular function leads to <strong>oscillopsia</strong> (<strong>blurry vision with head movements</strong>), <strong>gait disturbances,</strong> and <strong>loss of balance</strong> (especially in the <strong>dark</strong>). Patients typically <strong>do not have vertigo</strong> as vestibular function is lost on both sides leading to <strong>no asymmetry of vestibular input</strong>.\u00a0</p>\n<p>Examination findings of BVH include <strong>diminished dynamic visual acuity</strong> due to loss of stable vision when the head is moving, <strong>abnormal head impulse</strong> <strong>test in both directions</strong>, <strong>Romberg sign,</strong> and <strong>reduced responses to caloric testing</strong>.\u00a0</p>\n<p>Apart from <strong>discontinuing the offending drug</strong>, current therapy for BVH is <strong>vestibular rehabilitation therapy</strong>. <strong>Vestibular suppressant medications</strong> such as meclizine and promethazine <strong>should not be used</strong> (Option A), as they will <strong>increase the imbalance</strong>.\u00a0</p>\n<p><strong>Vestibular rehabilitation therapy (VRT)</strong> is a specialized form of <strong>physical therapy</strong> designed to <strong>alleviate imbalance and dizziness</strong> associated with vestibular disorders. It involves a series of <strong>exercises</strong>\u00a0that help to <strong>retrain the brain and vestibular system</strong> to <strong>compensate</strong> for any <strong>damage or dysfunction</strong>.</p>\n<p>Other options :\u00a0</p>\n<p>Option C: <strong>Vestibular implants</strong> hold <strong>future potential</strong> as a treatment, but are not currently indicated.</p>\n<p>Option D: The patient's condition may gradually improve by observation alone but vestibular rehabilitation therapy helps improve symptoms.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents with vertigo, tinnitus and hearing loss. He has a history of resolved interstitial keratitis in the past. Which of the following serologic tests should be negative to consider a diagnosis of Cogan's syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Free treponemal antigen absorption test"
      },
      {
        "id": 2,
        "text": "Chlamydia IgG titre"
      },
      {
        "id": 3,
        "text": "Antinuclear antibody"
      },
      {
        "id": 4,
        "text": "Anti-neutrophil cytoplasmic autoantibody"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Free treponemal antigen absorption test (FTA-Abs)</strong> should be done to <strong>rule out otosyphilis</strong> to make a diagnosis of <strong>Cogan syndrome</strong>, which is an <strong>autoimmune</strong> condition characterized by <strong>interstitial keratitis</strong>, <strong>hearing loss</strong>, <strong>tinnitus</strong> and <strong>vestibular</strong> <strong>symptoms</strong> such as <strong>vertigo</strong>.</p>\n<p><strong>Cogan\u2019s syndrome</strong> is an <strong>autoimmune vasculitis syndrome</strong> that presents as <strong>interstitial keratitis</strong>, <strong>vestibuloauditory symptoms</strong> (vertigo, tinnitus, and bilateral sensorineural hearing loss), and <strong>systemic vasculitis</strong>, particularly <strong>aortitis with aortic valve involvement</strong>. <strong>Otosyphilis</strong> presents similarly with <strong>interstitial keratitis, vertigo, tinnitus and hearing loss</strong>. <strong>Serology for syphilis</strong>, which is an <strong>exclusion criterion,</strong> <strong>must be negative</strong> for making a diagnosis of Cogan syndrome.</p>\n<p><strong>Ocular and inner ear findings</strong> in <strong>Cogan's syndrome</strong> occur <strong>simultaneously</strong> <strong>or</strong> <strong>within 6 months</strong> of each other. Ocular complaints include photophobia, blurred vision, lacrimation, and pain. Onset is usually sudden, and resolution is gradual with the possibility of future recurrences.</p>\n<p>Cogan's syndrome is hypothesized to be an <strong>autoimmune etiology</strong>. <strong>Risk factors</strong> include <strong>recent upper respiratory tract infection</strong> or <strong>Chlamydial</strong> <strong>infection</strong>, as <strong>raised chlamydial antibody titres</strong> have been reported during <strong>active disease </strong>(Option B).\u00a0</p>\n<p>Findings on evaluation include the presence of <strong>antinuclear antibodies</strong> (Option C), anti-smooth muscle antibodies, lupus anticoagulants, cryoglobulins, heat shock protein antibodies, <strong>anti-neutrophil cytoplasmic autoantibodies</strong> (Option D), or rheumatoid factor (RF). Direct antibodies against the inner ear and corneal antigens are also reported.</p>\n<p><strong>Glucocorticoids</strong> are the <strong>mainstay of treatment</strong>. <strong>Infliximab</strong> has been shown to improve vestibuloauditory functions in cases <strong>refractory to steroids</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following clinical features is common to both benign positional paroxysmal vertigo and vestibular neuritis?",
    "choices": [
      {
        "id": 1,
        "text": "Vertigo at rest"
      },
      {
        "id": 2,
        "text": "Vertigo with head motion"
      },
      {
        "id": 3,
        "text": "Time duration of vertigo"
      },
      {
        "id": 4,
        "text": "Tinnitus associated with vertigo"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Vertigo with head motion</strong> is a characteristic feature of <strong>both BPPV and vestibular neuritis</strong>.<br /><br /><strong>In BPPV</strong>, the vertigo is typically <strong>brief and intense lasting a few seconds</strong>, and it is <strong>triggered by specific head movements</strong>. In <strong>vestibular neuritis</strong>, the vertigo is <strong>typically more prolonged, present at rest</strong> and <strong>worsens by specific head movements</strong>.<br /><br /><strong>BPPV</strong> is a condition characterized by <strong>recurrent episodes of transient vertigo</strong> (<strong>&lt;1 min</strong>) <strong>triggered</strong> by <strong>changes in head position</strong> relative to gravity. It is caused by <strong>dislodged calcium carbonate crystals (otoconia) </strong>from the <strong>utricular macula </strong>into one of the <strong>semicircular canals</strong>, usually the <strong>posterior</strong> semicircular canal. A <strong>diagnosis</strong> of BPPV can be made by <strong>Dix-Hallpike test</strong> and the condition is <strong>treated</strong> by <strong>repositioning</strong> <strong>maneuvers</strong> for the otoconia such as the <strong>Epley maneuver</strong>.<br /><br /><strong>Vestibular neuritis (VN)</strong> is characterized by <strong>continuous episodes of vertigo</strong> that is <strong>present at rest</strong> and <strong>worsens with head movement</strong>. <strong>Nystagmus occurs spontaneously</strong> without head movement, and is <strong>unidirectional</strong>. <strong>Positive (abnormal) head impulse test</strong>, <strong>lack of skew deviation</strong> of the eyes and <strong>unidirectional nystagmus</strong> <strong>differentiates</strong> <strong>it</strong> from <strong>central causes</strong> of vertigo.</p>\n<p><strong>VN </strong>presents with <strong>vestibular symptoms</strong> like <strong>sudden onset of persistent vertigo</strong> with associated symptoms such as <strong>nausea, vomiting, and imbalance</strong>. Unlike BPPV, <strong>continuous vertigo persists even when the head remains still</strong>. Vestibular neuritis <strong>resolves spontaneously</strong>, but <strong>glucocorticoids</strong> can be given to improve outcomes if administered<strong> within 3 days of</strong> <strong>symptom onset</strong>. <strong>Vestibular suppressant medications</strong> can be given to <strong>reduce acute symptoms</strong>. Patients should be encouraged to <strong>resume normal activity</strong> as soon as possible. <strong>Vestibular rehabilitation therapy</strong> can also be tried.</p>\n<p>Other options :\u00a0<br /><br />Option A and D : <strong>Vertigo at rest and associated tinnitus</strong> is seen in <strong>vestibular neuritis</strong>, and not in BPPV.<br /><br />Option B : <strong>BPPV</strong> typically causes brief episodes of <strong>vertigo lasting seconds</strong>, while <strong>vestibular neuritis</strong> typically causes <strong>more prolonged episodes</strong> of vertigo <strong>lasting days to weeks</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are examining a patient with dizziness. The patient is seated and asked to fix on a target. Suddenly turning his head by 15 degrees to the right reveals an inability to fixate on the target with corrective saccades. Which of the following is abnormal in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Vestibulo ocular reflex"
      },
      {
        "id": 2,
        "text": "Vestibulo collic reflex"
      },
      {
        "id": 3,
        "text": "Vestibulo spinal reflex"
      },
      {
        "id": 4,
        "text": "Cervico collic reflex"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> vestibulo ocular reflex </strong>(VOR) is <strong>abnormal</strong> in this patient given an <strong>inability to maintain target fixation</strong> on <strong>sudden head turn</strong>.<br /><br /><strong>Stabilization of gaze</strong> <strong>during head movements</strong> is one of the <strong>main roles of the vestibular system</strong>. This is performed by the <strong>vestibulo-ocular reflex</strong> (VOR), which <strong>moves the eyes</strong> in the <strong>opposite direction</strong> to <strong>compensate for head movement</strong>. The test performed in this patient is known as a <strong>head</strong> <strong>impulse test</strong> that tests the VOR and helps <strong>differentiate between central and peripheral</strong> causes of <strong>vertigo</strong>.</p>\n<p>Head impulse test involves the vestibulo-ocular reflex, and is <strong>abnormal (positive) </strong>in <strong>acute peripheral vestibular</strong> <strong>lesions</strong> such as <strong>vestibular neuritis</strong>. An <strong>abnormal test</strong> would be <strong>eyes dragged off target</strong> with <strong>corrective saccades</strong> back to the target. Eyes focused on the target after head movement would be a normal response.<br /><br />Acute vestibular syndrome due to central causes (cerebellar or brainstem infarct or hemorrhage) may be life-threatening and has to be differentiated from peripheral causes affecting the vestibular nerve or labyrinth (vestibular neuritis). <strong>Central vertigo</strong> is indicated by a <strong>normal head impulse test</strong>.</p>\n<p>VOR <strong>prevents the slipping of the retinal images</strong> when the <strong>head moves</strong>. It <strong>moves the eyes</strong> at the <strong>same speed</strong> but in the <strong>opposite direction</strong> as the head. If an object is being pursued with eye and head movement, vision cancels the vestibulo-ocular reflex to prevent the eyes from moving in the opposite direction as the head.\u00a0</p>\n<p>VOR is a <strong>physiological vestibular nystagmus</strong> that forms the <strong>basis of caloric test</strong>. If <strong>cold water</strong> is poured into the <strong>right ear</strong> the patient develops <strong>left</strong> <strong>jerk nystagmus</strong> (rapid phase towards the left), while the <strong>reverse</strong> happens with <strong>warm water</strong>, i.e. patient develops right jerk nystagmus. It can be remembered by the mnemonic '<strong>COWS</strong>' (<strong>Cold- Opposite, Warm-Same</strong>).<br /><br />Other options :<br /><br />Option B : <strong>Vestibulo collic reflex</strong> is a compensatory response of the <strong>neck muscles</strong> when <strong>head motion</strong> is sensed by the vestibular organs.<br /><br />Option C : <strong>Vestibulo spinal reflex</strong> <strong>stabilizes body posture</strong> to head movements.<br /><br />Option D : <strong>Cervico collic reflex</strong> is a cervical reflex which is a compensatory response of neck muscles to <strong>stabilize the head with body movement</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 68-year-old male patient presents with sudden onset vertigo and headache since the past few hours. Blood pressure is 220/120 mm of Hg. Non contrast CT scan is done, shown below. Which of the following examination findings is unlikely to be seen in this patient's condition?",
    "choices": [
      {
        "id": 1,
        "text": "Unidirectional nystagmus"
      },
      {
        "id": 2,
        "text": "Dysarthria"
      },
      {
        "id": 3,
        "text": "Positive Romberg sign"
      },
      {
        "id": 4,
        "text": "Vertical skew deviation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient's <strong>sudden onset vertigo</strong> and <strong>headache</strong>, along with a <strong>region of hyperdensity</strong> in the <strong>cerebellar hemisphere</strong> on <strong>non contrast CT</strong> point to <strong>cerebellar hemorrhage</strong> which is characterized by <strong>central nystagmus</strong> <strong>(direction changing)</strong>, <strong>dysarthria, ataxia</strong> and <strong>vertical skew deviation</strong> (Option D).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7435772b86a2458e896fa79db78a0256.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9b5dad14c49f4427818b642bcb14f857x720x733.PNG"
    ]
  },
  {
    "text": "An airforce pilot presents with sudden onset intermittent hearing loss, dizziness, and tinnitus soon after a flight training exercise. Investigations reveal high-frequency sensorineural hearing loss. Hennebert sign is seen. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Meniere's disease"
      },
      {
        "id": 2,
        "text": "Perilymph fistula"
      },
      {
        "id": 3,
        "text": "Superior semicircular canal dehiscence syndrome"
      },
      {
        "id": 4,
        "text": "Vestibular neuritis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient presenting with <strong>sudden onset intermittent sensorineural hearing loss</strong>, <strong>dizziness</strong> and <strong>tinnitus</strong> following a flight training exercise (<strong>barotrauma</strong>) with <strong>dizziness </strong>and <strong>nystagmus</strong>\u00a0on <strong>valsalva</strong> maneuver (<strong>positive fistula test</strong> and <strong>hennebert's sign</strong>) is suggestive of <strong>perilymph</strong> <strong>fistula</strong>.\u00a0\u00a0</p>\n<p>A <strong>perilymph</strong> <strong>fistula</strong> is an <strong>abnormal</strong> <strong>connection</strong> between the <strong>inner ear</strong> and <strong>middle</strong> <strong>ear</strong>, resulting in <strong>leakage</strong> of <strong>perilymph</strong> from the cochlea or vestibule. This most commonly occurs <strong>through</strong> the <strong>round</strong> or <strong>oval</strong> <strong>window</strong>. Causes include <strong>post</strong>-<strong>stapedectomy</strong>, <strong>ear</strong> <strong>surgery</strong> with <strong>dislocation</strong> of the <strong>stapes</strong>, <strong>head</strong> <strong>trauma </strong>and\u00a0<strong>inner ear injury</strong> due to <strong>forceful</strong> <strong>Valsalva</strong> or <strong>barotrauma</strong>. It can result from <strong>sudden</strong> <strong>pressure</strong> <strong>changes</strong> in the <strong>middle</strong> <strong>ear</strong> (e.g. barotrauma, <strong>flying</strong>, diving, forceful Valsalva) or <strong>raised intracranial pressure</strong> (<strong>weightlifting</strong> or vigorous coughing).</p>\n<p>A perilymph fistula causes <strong>intermittent</strong> <strong>vertigo</strong>, <strong>fluctuating</strong> <strong>sensorineural</strong> <strong>hearing</strong> <strong>loss</strong>, <strong>tinnitus</strong> and sense of <strong>fullness</strong> in the ear. This can be triggered by <strong>fistula test</strong> (intermittent pressure over tragus) and the <strong>valsalva</strong> <strong>maneuver</strong>. <strong>High-resolution computed tomography</strong> (HRCT) of the temporal bone is <strong>highly</strong> <strong>sensitive</strong> for detecting the fistula. <strong>Management</strong> of perilymphatic fistula can be <strong>conservative</strong> or surgical. Conservative measures involve<strong> avoiding activities that increase</strong> <strong>inner ear </strong>or <strong>intracranial</strong> <strong>pressure</strong>.<br /><br />The sudden onset of symptoms following trauma (barotrauma) and disequilibirum following valsalva maneuver (hennebert's phenomenon) points in favor of perilymph fistula over meniere's disease (option A). <strong>Meniere's disease</strong> (MD) or <strong>endolymphatic</strong> <strong>hydrops</strong> is a disorder of the inner ear caused by <strong>impaired endolymph resorption</strong>. It is characterized by an episodic sudden onset of <strong>vertigo</strong>, <strong>low-frequency hearing loss</strong> (in the early stages of the disorder), <strong>low-frequency roaring tinnitus</strong>, and a sensation of <strong>fullness</strong> in the affected ear. Pure tone audiometry (PTA) will reveal <strong>sensorineural</strong> <strong>hearing</strong> <strong>loss</strong>. <strong>Hennebert\u2019s</strong> <strong>sign</strong> and <strong>Tullio</strong> <strong>phenomenon</strong> are also seen in cases of Meniere's disease.<br /><br />Other options :\u00a0<br /><br />Option C : <strong>Superior semicircular canal dehiscence</strong> syndrome is characterized by <strong>conductive</strong> <strong>hearing</strong> <strong>loss</strong> and <strong>noise</strong> <strong>induced</strong> (<strong>Tullio's</strong> phenomenon) or <strong>pressure</strong>-<strong>induced</strong> <strong>dizziness</strong> (<strong>Hennebert's</strong> <strong>sign</strong>). It occurs due to the <strong>third window effect </strong>created by the thin/dehiscent wall of the superior semicircular canal. This causes endolymph in the labyrinthine system to move with sound or pressure, causing an activation of the vestibular system.\u00a0<br /><br />Option D : <strong>Vestibular neuritis</strong> presents with vestibular symptoms like <strong>sudden onset of persistent vertigo</strong> with associated symptoms such as <strong>nausea</strong> and <strong>vomiting</strong>. It is <strong>not associated</strong> with<strong> cochlear symptoms </strong>like hearing loss and tinnitus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old boy presents with dizziness, unsteadiness and difficulty walking since the past few hours. On examination, the child has ataxia, wide-based gait, decreased responsiveness and peri oral rash. His father reports that he has been behaving strangely and was caught bunking school. What is the most likely cause of the child's symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Friedrich's ataxia"
      },
      {
        "id": 2,
        "text": "Toluene intoxication"
      },
      {
        "id": 3,
        "text": "Post infectious cerebellitis"
      },
      {
        "id": 4,
        "text": "Ataxia telangiectasia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This is a scenario of <strong>toluene inhalation</strong> <strong>intoxication</strong> presenting <strong>acutely</strong> with neurologic symptoms and signs of <strong>symmetric ataxia</strong>, <strong>wide based gait</strong> and <strong>peri oral rash</strong> (<strong>glue sniffer's rash</strong>).</p>\n<p><strong>Inhalants</strong> are compounds like <strong>butane, propane, freons and toluene</strong>. These are present in household items like <strong>glue</strong>, <strong>paint thinners</strong>, <strong>whiteners</strong> and <strong>hairsprays</strong>. These compounds are easily available, thus they're easy to abuse.</p>\n<p>Inhalant intoxication presents with symptoms like <strong>euphoria, agitation, anxiety</strong> and <strong>decreased responsiveness</strong>. The effects last for a <strong>few hours</strong> after the inhalation. Inhalant use can also acutely cause <strong>symmetric ataxia</strong>, and long term use is also associated with <strong>local</strong> <strong>perioral dermatitis</strong> known as \"<strong>glue sniffer's rash</strong>\".</p>\n<p>Inhalant intoxication can be harmful as <strong>repeated inhalation</strong> can lead to <strong>hypoxia</strong>, <strong>coma</strong> and long term use has been associated with <strong>delirium</strong> and <strong>dementia</strong>.</p>\n<p>Use of intoxicants or drugs must be elicited in patient visits to determine early symptoms of mental disorders and functional impairment in pediatric populations. This can be done through a <strong>HEADSSS assessment</strong> (<strong>Home, Education, Activities, Drugs, Sexuality, Suicide/Depression, Safety).</strong></p>\n<p>Other toxic causes of ataxia include alcohol, lithium, phenytoin, barbiturates, mercury, gasoline and glue inhalation.</p>\n<p>Other options :\u00a0<br /><br />Option A : <strong>Friedrich's ataxia</strong> would present as <strong>chronic ataxia</strong>, and not acutely as in this patient. Friedreich's ataxia is the <strong>most</strong> <strong>common form of inherited ataxia</strong>. It is an <strong>autosomal recessive</strong> disorder generally occurring in individuals less than 25 years of age. It is caused by the <strong>expansion of a GAA trinucleotide repeat</strong> in the first intron of a gene on chromosome <strong>9q13</strong> that encodes <strong>frataxin</strong>. Patients present with clinical features of <strong>dysarthria</strong>, <strong>progressive staggering gait, frequent falls, nystagmus, and titubation</strong> (nodding head and body movements).</p>\n<p>Option C : <strong>Postinfectious cerebellitis</strong> is a <strong>reversible cerebellar ataxia</strong> and a rare acute or subacute complication of <strong>varicella zoster </strong>infection.</p>\n<p>Option D : <strong>Ataxia telangiectasia</strong> is a rare inherited cause of ataxia. Patients present in the first decade of life with <strong>progressive</strong> <strong>telangiectatic lesions</strong> associated with <strong>deficits in cerebellar function and nystagmus</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly male patient comes with complaints of dizziness and a feeling of unsteadiness over the past few months. Examination reveals pill-rolling tremor, shuffling gait, and mask facies. What is the most specific symptom that can describe dizziness in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Near syncope"
      },
      {
        "id": 2,
        "text": "Vertigo"
      },
      {
        "id": 3,
        "text": "Ill-defined lightheadedness"
      },
      {
        "id": 4,
        "text": "Dysequilibrium"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This is a scenario of <strong>parkinsonism</strong> characterized by <strong>pill-rolling tremor, shuffling gait, and mask facies</strong>. Patients with <strong>Parkinsonism</strong> can complain of <strong>dizziness</strong> which is better specified as <strong>dysequilibrium</strong>.</p>\n<p><strong>Dysequilibrium</strong> can result from anomalies in the <strong>brain, cerebellum, spinal cord, or peripheral nerves</strong>. It is the feeling of <strong>falling or imbalance</strong> accompanied by <strong>difficulty in standing or walking</strong>. Normal-pressure hydrocephalus, <strong>Parkinson's disease</strong>, cerebellar degeneration or cerebellar stroke, vertebrobasilar insufficiency, vitamin B12 deficiency, tabes dorsalis, and diabetes mellitus are common causes.</p>\n<p>Patients who claim to be dizzy are actually experiencing <strong>vertigo, presyncope, or dysequilibrium</strong>, which are different symptoms. <strong>Finding the specific symptom</strong> helps to <strong>focus the evaluation</strong> and reduce the range of possible diagnoses.</p>\n<table style=\"border-collapse: collapse; width: 100.052%; height: 201.578px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 13.2568%; height: 22.3984px; text-align: center;\">\u00a0</td>\n<td style=\"width: 29.4363%; height: 22.3984px; text-align: center;\">Vertigo</td>\n<td style=\"width: 29.1236%; height: 22.3984px; text-align: center;\">Near syncope</td>\n<td style=\"width: 28.1833%; height: 22.3984px; text-align: center;\">Dysequilibrium</td>\n</tr>\n<tr style=\"height: 67.1875px;\">\n<td style=\"width: 13.2568%; height: 67.1875px; text-align: center;\">Description</td>\n<td style=\"width: 29.4363%; height: 67.1875px; text-align: center;\">Sensation of <strong>spinning or motion</strong> (when <strong>none is occurring</strong>)</td>\n<td style=\"width: 29.1236%; height: 67.1875px; text-align: center;\">Sensation of <strong>impending loss of consciousness</strong> or <strong>fainting</strong></td>\n<td style=\"width: 28.1833%; height: 67.1875px; text-align: center;\"><strong>Instability</strong> or sensation of <strong>falling</strong> while <strong>seated, standing, or walking</strong></td>\n</tr>\n<tr style=\"height: 111.992px;\">\n<td style=\"width: 13.2568%; height: 111.992px; text-align: center;\">Differential diagnoses</td>\n<td style=\"width: 29.4363%; height: 111.992px; text-align: center;\">BPPV, vestibular neuritis, Meniere's disease, multiple sclerosis, cerebrovascular disease\u00a0</td>\n<td style=\"width: 29.1236%; height: 111.992px; text-align: center;\">Cardiac arrhythmias, aortic stenosis, vasovagal syncope, orthostatic hypotension, hypoglycemia</td>\n<td style=\"width: 28.1833%; height: 111.992px; text-align: center;\"><strong>Parkinson's disease</strong>, cerebellar degeneration, cerebellar stroke, vitamin B12 deficiency, Tabes dorsalis, normal pressure hydrocephalus</td>\n</tr>\n</tbody>\n</table>\n<p><br />Other options :</p>\n<p>Option C: Patients are said to have <strong>ill-defined light-headedness</strong> if they are <strong>unable to articulate their complaints of dizziness</strong>. Differentials include depression, anxiety, panic attacks, somatization disorder, medications, and subtle presentations of vertigo, near syncope, or dysequilibrium.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Dizziness Mini Test - -Tmt';
        const quizFilename = 'dizziness-mini-test-tmt-2a16a134.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>