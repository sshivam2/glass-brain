<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>082 Pathology Neet 2020 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Pathology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">26</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following is the correct statement regarding Huntington's chorea?",
    "choices": [
      {
        "id": 1,
        "text": "It is a trinucleotide repeat disorder"
      },
      {
        "id": 2,
        "text": "There is loss of function type of mutation"
      },
      {
        "id": 3,
        "text": "There are abnormal repeats of CUG"
      },
      {
        "id": 4,
        "text": "Abnormality is seen due to mutation in chromosome 6"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Huntington's chorea</strong>&nbsp;is a<strong> trinucleotide repeat </strong>disorder.</p>\n<p>It is an <strong>autosomal dominant</strong> neurodegenerative disorder. It is caused by <strong>CAG </strong>trinucleotide<strong>&nbsp;repeats</strong> (&gt;40). It occurs due to a <strong>gain-of-function</strong> (expansion) mutation in the huntingtin gene on <strong>chromosome 4p</strong>.&nbsp;</p>\n<p>The disease shows <strong>genetic anticipation</strong> and has an early-onset (2-3 decades) if inherited from the father.&nbsp;</p>\n<p><strong>Cognitive impairment</strong> is an early feature. Pathologically, <strong>atrophy</strong> of <strong>caudate</strong> and <strong>putamen</strong> with ex vacuo ventriculomegaly is seen. Decreased acetylcholine leads to <strong>dementia</strong> and decreased GABA and increased dopamine lead to <strong>chorea.</strong></p>\n<p><strong>Treatment</strong> consists of <strong>haloperidol</strong> and<strong> tetrabenazine.</strong></p>\n<p>Trinucleotide repeat disorders:</p>\n<table style=\"height: 697px; width: 401px;\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 141px; height: 18px;\"><strong>Disease</strong></td>\n<td style=\"width: 83px; height: 18px;\"><strong>Repeats</strong></td>\n<td style=\"width: 155px; height: 18px;\">Clinical features</td>\n</tr>\n<tr style=\"height: 91px;\">\n<td style=\"width: 141px; height: 91px;\"><strong>Fragile X- syndrome</strong></td>\n<td style=\"width: 83px; height: 91px;\">&nbsp; <strong>CGG</strong></td>\n<td style=\"width: 155px; height: 91px;\">Mental retardation, large ears,&nbsp;and jaws, macroorchidism in males</td>\n</tr>\n<tr style=\"height: 107.2px;\">\n<td style=\"width: 141px; height: 107.2px;\">\n<p>Myotonic Dystrophy</p>\n<p>(<strong>chromosome 19)</strong></p>\n</td>\n<td style=\"width: 83px; height: 107.2px;\">&nbsp; CTG</td>\n<td style=\"width: 155px; height: 107.2px;\">Muscle loss, cardiac arrhythmia,<br /><strong>cataracts</strong>, frontal balding</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 141px; height: 36px;\"><strong>Huntington&rsquo;s disease</strong></td>\n<td style=\"width: 83px; height: 36px;\">&nbsp; <strong>CAG</strong></td>\n<td style=\"width: 155px; height: 36px;\">Affective disorder</td>\n</tr>\n<tr style=\"height: 72px;\">\n<td style=\"width: 141px; height: 72px;\">Spinocerebellar ataxia type 1</td>\n<td style=\"width: 83px; height: 72px;\">&nbsp; CAG</td>\n<td style=\"width: 155px; height: 72px;\">Progressive ataxia, dysarthria,<br />dysmetria.</td>\n</tr>\n<tr style=\"height: 91px;\">\n<td style=\"width: 141px; height: 91px;\"><strong>Friedreich's ataxia</strong></td>\n<td style=\"width: 83px; height: 91px;\">&nbsp; <strong>GAA</strong></td>\n<td style=\"width: 155px; height: 91px;\">Progressive ataxia,<br />dysarthria, hypertrophic<br />cardiomyopathy.</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is true about the pathology of achalasia cardia?",
    "choices": [
      {
        "id": 1,
        "text": "Relaxation of lower esophageal sphincter"
      },
      {
        "id": 2,
        "text": "Defective peristalsis"
      },
      {
        "id": 3,
        "text": "Decreased release of NO and VIP in the distal part of esophagus"
      },
      {
        "id": 4,
        "text": "Decreased tone of the  lower esophageal sphincter"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Achalasia cardia is characterized by <strong>decreased\u00a0</strong>release of<strong> NO</strong>(nitric oxide)<strong> and VIP</strong>(vasoactive intestinal polypeptide) in the<strong> distal part </strong>of<strong> esophagus.</strong></p>\n<p>Normally, NO and VIP are secreted by the <strong>inhibitory</strong> neurons of the\u00a0<strong>Auerbach's</strong> <strong>plexus</strong> in the distal esophagus. This leads to relaxation of the lower esophageal sphincter (LES). In achalasia cardia, these inhibitory neurons <strong>degenerate</strong> leading to decreased release of NO and VIP. This causes increased LES tone.</p>\n<p>The triad of achalasia cardia is as follows:</p>\n<ol>\n<li>Incomplete relaxation of LES</li>\n<li>Increased tone of LES</li>\n<li>Absent peristalsis (aperistalisis)</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents with midline swelling in the neck. Biopsy revealing Orphan Annie eye nuclei is shown in the image below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Follicular carcinoma"
      },
      {
        "id": 2,
        "text": "Papillary carcinoma"
      },
      {
        "id": 3,
        "text": "Toxic nodular goitre"
      },
      {
        "id": 4,
        "text": "Medullary carcinoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Note: Orphan Annie refers to a comic book character with empty appearing eyes.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4a6a83d23af84eafa189a7212a1fc290.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/68ba6b6a16c14c7283fbc2d3d669f0ffx745x529.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b17233c0e5ba4cbdbb85fc5ae096a634x1280x1106.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a203874dea9c4530b2db0e62409e4f4ax1280x1094.JPEG"
    ]
  },
  {
    "text": "A 51-year-old male patient came with complaints of hematuria to the clinic. On examination, he was normotensive and had pedal edema. Investigations revealed the patient had no glycosuria and had a creatinine of 9. His renal biopsy is shown below. Which of the following investigations should be done to identify the disease?",
    "choices": [
      {
        "id": 1,
        "text": "ANA"
      },
      {
        "id": 2,
        "text": "Anti GBM antibodies"
      },
      {
        "id": 3,
        "text": "HIV RNA"
      },
      {
        "id": 4,
        "text": "Urine immunoelectrophoresis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"ng-binding\"><strong>Type 1 RPGN</strong> includes&nbsp;renal limited disease&nbsp;and&nbsp;<strong>Goodpasture's</strong>&nbsp;<strong>disease</strong>. In this condition, antibodies are produced against the non-collagenous domain of the<strong> &alpha;3 chain</strong> of <strong>collagen IV</strong> of the GBM.</p>\n<p>Microscopy findings of Goodpasture's disease are:</p>\n<ul>\n<li>Immunofluorescence -&nbsp;<strong>l</strong><strong>inear deposits </strong>of<strong> Ig </strong>and<strong> complement&nbsp;</strong>along the glomerular basement membrane</li>\n<li>Electron microscopy - <strong>wrinkling</strong> of the glomerular basement membrane with&nbsp;<strong>focal disruptions&nbsp;</strong>without any immune complex deposition.</li>\n</ul>\n<p>A variant of Goodpasture's disease with&nbsp;<strong>pulmonary involvement</strong>&nbsp;is known as&nbsp;<strong>Goodpasture's syndrome.</strong></p>\n<p>Option A: ANA testing is done if SLE is suspected. Electron microscopy will show immune complex deposits.</p>\n<p>Option C: HIV RNA testing is done in immunodeficiency syndrome associated with weight loss. Electron microscopy will show diffuse podocyte injury with complete foot process effacement. Tubuloreticular inclusions will be seen in endothelial cells.</p>\n<p>Option D: Urine electrophoresis is done if nephrotic syndrome is suspected.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4c506e0d17a449329f529ccd4cf95bea.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/75d54a2509d94955929563a40c1e0d4bx1280x1390.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5dd21bfa410a413883265e38b4ecfd71x1280x1390.JPEG"
    ]
  },
  {
    "text": "A 50-year-old man presented with a retroperitoneal mass. Biopsy from the lesion is shown in the image below. Molecular analysis revealed t(12;16).  What is the most likely condition?",
    "choices": [
      {
        "id": 1,
        "text": "Myxoid Liposarcoma"
      },
      {
        "id": 2,
        "text": "Lipoma"
      },
      {
        "id": 3,
        "text": "Spindle lipoma"
      },
      {
        "id": 4,
        "text": "Polymorphic lipoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of <strong>myxoid</strong> <strong>liposarcoma</strong>.&nbsp;</p>\n<p>The image shows abundant <strong>ground substance,</strong> with <strong>branching</strong> <strong>capillaries</strong> and a few <strong>immature</strong> <strong>adipocytes</strong>.&nbsp;</p>\n<p><strong>Liposarcoma</strong>&nbsp;is the <strong>most common sarcoma</strong> in adults and is usually seen in&nbsp;the<strong> 5th to 6th decade</strong> of life. They commonly occur in the <strong>deep soft tissues</strong> of the <strong>proximal</strong> <strong>extremities</strong> and in the <strong>retroperitoneum</strong>.</p>\n<p>Histologically the liposarcomas are divided into three subtypes:</p>\n<ul>\n<li><strong>Well-differentiated liposarcoma:</strong> It consists of <strong>mature</strong> <strong>adipocytes</strong> and <strong>scattered spindle cells</strong> with hyperchromatic nuclei. It is associated with amplification of <strong>12q13-q15.</strong></li>\n<li><strong>Myxoid liposarcoma:&nbsp;</strong>It contains abundant basophilic extracellular matrix with <strong>branching capillaries.</strong> Few <strong>immature adipocytes</strong> are found scattered within the matrix. It is associated with <strong>t(12;16)</strong>.</li>\n<li><strong>Pleomorphic liposarcoma:&nbsp;</strong>It consists of sheets of anaplastic cells with bizarre nuclei and few immature adipocytes.</li>\n</ul>\n<p>Among the three subtypes, the pleomorphic liposarcoma is the most malignant and often metastasizes, while the well-differentiated is least malignant. Myxoid liposarcoma has intermediate malignancy behaviour.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/72ab26145cbb4b56b8c0212591a41601.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Large, friable, irregular vegetations on heart valves are seen in which condition?",
    "choices": [
      {
        "id": 1,
        "text": "Infective endocarditis"
      },
      {
        "id": 2,
        "text": "Rheumatic heart disease"
      },
      {
        "id": 3,
        "text": "Libman-Sacks endocarditis"
      },
      {
        "id": 4,
        "text": "Non-bacterial thrombotic carditis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Large, friable, irregular vegetations on heart valves are seen in <strong>i</strong><strong>nfective endocarditis.</strong></p>\n<p>Infective endocarditis is characterized by the presence of <strong>large, friable, irregular vegetation</strong>s on heart valves.&nbsp;<strong>Aortic </strong>and <strong>mitral valves</strong> are the most commonly affected, however, in some cases, the right heart valves may be involved.</p>\n<p>Vegetations may be single or multiple and may involve one or more valves.&nbsp;<strong>Embolization</strong> often occurs and may lead to <strong>septic</strong> <strong>infarcts</strong> or <strong>mycotic</strong> <strong>aneurysms</strong> at the site of lodgement due to the presence of virulent organisms in the emboli.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 23-year-old male patient presented with a history of fatigue and tiredness. On investigation, he was found to have Hb = 9 gm% and MCV =101 FL. Peripheral smear examination showed macrocytic RBC and hypersegmented neutrophils. Which of the following is the most likely etiology?",
    "choices": [
      {
        "id": 1,
        "text": "Lead poisoning"
      },
      {
        "id": 2,
        "text": "Iron deficiency anemia"
      },
      {
        "id": 3,
        "text": "Hemolytic anemia"
      },
      {
        "id": 4,
        "text": "Chronic alcoholism"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given findings are suggestive of <strong>macrocytic</strong>&nbsp;anaemia, which can be seen in <strong>chronic alcoholics.</strong></p>\n<p>Anemic patients with a peripheral smear showing <strong>macrocytic RBCs</strong> and <strong>hypersegmented neutrophils</strong>&nbsp;are important characteristic features of <strong>megaloblastic anemia.</strong></p>\n<p><strong>Chronic alcoholics </strong>also have<strong> deficiency</strong> of <strong>folic acid</strong> due to:</p>\n<ul>\n<li>Trapping of folate within the liver</li>\n<li>Excessive urinary loss</li>\n<li>Disordered folate metabolism</li>\n<li>Inadequate dietary intake is frequently encountered in chronic alcoholics</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old child was admitted to the hospital with a history of prolapsing rectal mass and painless rectal bleeding. The histopathological image of the mass is as shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Peutz Jegher syndrome"
      },
      {
        "id": 2,
        "text": "Villous adenoma"
      },
      {
        "id": 3,
        "text": "Juvenile polyp"
      },
      {
        "id": 4,
        "text": "Tubular adenoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Juvenile polyps are <strong>malformations</strong> of epithelium and lamina propria commonly located in the rectum. It is seen in children <strong>&lt;5 years </strong>of age.<strong>&nbsp;</strong>The typical presentation is <strong>painless</strong> <strong>rectal</strong> <strong>bleeding</strong>. Sometimes there may be a <strong>proliferating rectal mass</strong>.</p>\n<p>The disease may be sporadic or syndromic.&nbsp;</p>\n<ul>\n<li><strong>Sporadic </strong>juvenile polyp occurs as a single mass and is called <strong>retention polyp</strong>.</li>\n<li><strong>Juvenile polyposis syndrome</strong> is characterized by multiple hamartomatous polyps, which may be <strong>premalignant</strong>.</li>\n</ul>\n<p>Morphologically, both of these types are indistinguishable.</p>\n<ul>\n<li>Gross appearance:&nbsp;They appear as pedunculated, smooth reddish lesions, and with cystic spaces.</li>\n<li>Microscopic appearance: The cysts appear as dilated glands filled with mucin and inflammatory debris.</li>\n</ul>\n<p>Note: Complex <strong>glandular architecture</strong> and the presence of <strong>smooth muscle</strong> cutting through the lamina propria are seen in <strong>Peutz-Jeghers</strong> polyps.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5e55a99a60764258b13c02d5dac55691.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5c8c779d67644e0096bdc30c904ff064x1280x1146.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fa36be8a481e42f3a4b4338176349872x1280x1146.JPEG"
    ]
  },
  {
    "text": "A 20-year-old patient presented to the clinic with a history of malabsorption, diarrhea, and poor appetite. Duodenal biopsy of the patient showed crypt hyperplasia, villi atrophy, and CD8+ cells in lamina propria. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Environmental enteropathy"
      },
      {
        "id": 2,
        "text": "Celiac disease"
      },
      {
        "id": 3,
        "text": "Whipple's disease"
      },
      {
        "id": 4,
        "text": "Chronic pancreatitis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical presentation and the histopathological findings are suggestive of <strong>celiac disease</strong>.</p>\n<p>Celiac disease is an <strong>autoimmune</strong> <strong>gluten</strong>-induced enteropathy where <strong>HLA DQ2</strong> and <strong>DQ8</strong> are expressed. In the small intestine, peptides of gluten are presented to helper T cells which mediate mucosal inflammation. <strong>Antiendomysial</strong> and <strong>anti-tTG</strong> antibodies are found in serological studies.</p>\n<p>Clinically, malabsorption syndrome with <strong>diarrhea</strong>, <strong>abdominal pain</strong>, and marked <strong>weight loss</strong> is seen along with <strong>chronic refractory anemia</strong>. Dermatitis herpetiformis is seen in 10% of patients with celiac disease. Microscopic findings show <strong>villi atrophy</strong>, <strong>villi flattening</strong>, <strong>crypt hyperplasia</strong>, and <strong>increased intraepithelial T lymphocytes</strong> (IEL).</p>\n<p>Option A: <strong>Environmental enteropathy</strong> / tropical sprue is seen in tropical areas with poor sanitation. It is believed to be caused by one or more infectious agents that respond to antibiotics. Mucosa shows variable <strong>villous atrophy</strong>.</p>\n<p>Option C: <strong>Whipple's</strong> disease is a multisystemic disease caused by <em>T.whipplei</em>. Small intestinal biopsy shows <strong>PAS-positive macrophages</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-year-old child was brought to the hospital with complaints of fever, rash and swelling of her hands and feet since past 5 days.  There is desquamative skin rash, oedema of hands and feet, erythema of palms and soles, oral erythema, and cervical lymphadenopathy. What is the likely condition?",
    "choices": [
      {
        "id": 1,
        "text": "Kawasaki disease"
      },
      {
        "id": 2,
        "text": "Measles"
      },
      {
        "id": 3,
        "text": "Scarlet fever"
      },
      {
        "id": 4,
        "text": "Henoch Schonlein Purpura"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of <strong>Kawasaki</strong> <strong>disease</strong> or <strong>mucocutaneous</strong> <strong>lymph</strong> <strong>node</strong> <strong>syndrome</strong>.</p>\n<p>Kawasaki disease is an acute febrile illness associated with <strong>arteritis</strong> of <strong>medium to large-sized vessels.&nbsp;</strong>It is commonly seen in <strong>infants</strong> and <strong>children</strong> <strong>&lt;4 years</strong> of age.</p>\n<p>Clinical features include<strong>:</strong></p>\n<ul>\n<li>Fever</li>\n<li><strong>Conjunctival&nbsp;and oral erythema</strong></li>\n<li>Blistering, edema of hands and feet</li>\n<li>Erythema of palms and soles</li>\n<li><strong>Desquamative</strong> <strong>rash</strong></li>\n<li><strong>Cervical lymphadenopathy</strong></li>\n</ul>\n<p>The disease is usually <strong>self-limiting</strong>. In some cases, the disease may involve coronary artery leading to <strong>thrombosis</strong> and <strong>acute</strong> <strong>myocardial</strong> <strong>infarction</strong>. <strong>Intravenous</strong> <strong>immunoglobulin</strong> and <strong>aspirin</strong> may be given to reduce the risk of coronary artery disease.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Effacement of podocyte foot processes is seen in which of the following diseases?",
    "choices": [
      {
        "id": 1,
        "text": "Steroid resistant glomerulonephritis"
      },
      {
        "id": 2,
        "text": "Minimal change disease"
      },
      {
        "id": 3,
        "text": "Rapidly progressive glomerulonephritis"
      },
      {
        "id": 4,
        "text": "Chronic  glomerulonephritis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Effacement </strong>of the <strong>podocyte foot processes</strong> is characteristically seen in <strong>minimal change disease (MCD), </strong>which is&nbsp;also called <strong>lipoid nephrosis</strong>.</p>\n<p>It is also seen in other conditions such as <strong>membranous nephropathy</strong> and <strong>focal segmental glomerulosclerosis</strong>. Since the podocytes are affected in these diseases, they are also known as <strong>podocytopathies</strong>.</p>\n<p>The effacement of foot process can only be observed on electron microscopy.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Thrombosis is initiated by:",
    "choices": [
      {
        "id": 1,
        "text": "Platelet activation"
      },
      {
        "id": 2,
        "text": "Endothelial injury"
      },
      {
        "id": 3,
        "text": "Coagulation cascade"
      },
      {
        "id": 4,
        "text": "Vasoconstriction of vessels"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Thrombosis</strong> is initiated by<strong> endothelial injury</strong>.</p>\n<p>Thrombosis is&nbsp;is the formation of a <strong>blood clot</strong> inside a blood vessel, <strong>obstructing</strong> the flow of blood through the circulatory system.&nbsp;</p>\n<p>Three primary abnormalities, often referred to as <strong>Virchow</strong> <strong>triad,</strong> are known to induce thrombosis. They include:</p>\n<ul>\n<li>Endothelial injury<strong> -&nbsp;</strong>most important factor</li>\n<li><strong>Stasis</strong> or turbulent blood flow</li>\n<li><strong>Hypercoagulability</strong> of the blood</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged woman presents with thyroid swelling. Blood tests show elevated TSH levels and the presence of thyroid peroxidase antibodies. Histopathological examination revealed the presence of Hurthle \u200bcells. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hashimoto thyroiditis"
      },
      {
        "id": 2,
        "text": "Graves' disease"
      },
      {
        "id": 3,
        "text": "Follicular carcinoma"
      },
      {
        "id": 4,
        "text": "Medullary carcinoma of thyroid"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 1106\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>This clinical scenario with the presence of<strong> Hurthle cells</strong> is suggestive of <strong>Hashimoto's thyroiditis.</strong></p>\n<p>It is an <strong>autoimmune </strong>disease, characterized by the gradual destruction of the thyroid gland leading to thyroid failure. It is commonly seen in<strong>&nbsp;women&nbsp;</strong>between<strong> 45 to 65 years</strong> of age.&nbsp;It is caused by the presence of circulating <strong>autoantibodies</strong>&nbsp;against <strong>thyroglobulin</strong> and <strong>thyroid peroxidase.</strong></p>\n<p>Morphologically, there is a <strong>diffuse enlargement</strong> of the thyroid gland, with an intact capsule. It is well demarcated from the adjacent structures.</p>\n<p>Microscopic features include:</p>\n<ul>\n<li>Intense<strong> lymphocytic infiltrate</strong> containing small lymphocytes, plasma cells, and well developed germinal centers</li>\n<li><strong>Atrophied thyroid follicles</strong>&nbsp;</li>\n<li>The epithelial cells lining the follicles contain eosinophilic granular cytoplasm\n<ul>\n<li>This is called oncocytic metaplasia</li>\n<li>These cells are called Hurthle cells</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/427be9cbc0544231ac9af04e8ae714efx1280x1054.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e0c36d52026042b78ca57172c399591ex1280x1054.JPEG"
    ]
  },
  {
    "text": "A 52-year-old male patient comes with complaints of abdominal pain, nausea, and vomiting. A peripheral blood smear reveals macrocytes and hypersegmented neutrophils and an endoscopy reveals atrophic gastritis. Which of the following conditions is likely to be seen this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin B12 deficiency"
      },
      {
        "id": 2,
        "text": "Folate deficiency"
      },
      {
        "id": 3,
        "text": "Pyridoxine deficiency"
      },
      {
        "id": 4,
        "text": "Niacin deficiency"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given findings are suggestive of <strong>pernicious anemia,</strong>&nbsp;which is associated with <strong>atrophic gastritis</strong> and&nbsp;<strong>vitamin B12 deficiency.</strong></p>\n<p><strong>Anemic patient</strong>&nbsp;with a peripheral smear showing&nbsp;<strong>macrocytic RBCs</strong>&nbsp;and&nbsp;<strong>hypersegmented neutrophils</strong>&nbsp;are important characteristic features of&nbsp;<strong>megaloblastic anemia.</strong>&nbsp;<strong>Vitamin B12</strong> and folic acid deficiency&nbsp;are the main&nbsp;causes&nbsp;of megaloblastic anemia.</p>\n<p><strong>Pernicious anemia</strong> is an autoimmune disease characterized by the presence of <strong>autoantibodies</strong> which impairs the production or activity of the <strong>intrinsic</strong> <strong>factor (IF).&nbsp;</strong>This is required for the <strong>uptake of vitamin B12</strong>. There are three types of autoantibodies namely, type I, II, and III. The action of each of these include:</p>\n<ul>\n<li>Autoantibody type I prevents the binding of vitamin B12 to the intinsic factor (IF).</li>\n<li>Autoantibody type II prevents the binding of vitamin B12-IF complex to the ileal receptors.</li>\n<li>Autoantibody type III acts against the &alpha; and &beta; subunits of the gastric proton pump, which impairs the production of intrinsic factor.</li>\n</ul>\n<p>These patients also develop <strong>chronic</strong>&nbsp;<strong>atrophic gastritis,</strong> characterized by loss of parietal cells, infiltration of lymphocytes and plasma cells and megaloblastic changes in mucosal cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old woman presents with a lump in the upper outer quadrant of her breast. Histopathological examination of the mass showed cells in mucin pools and faint nuclei. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Colloid carcinoma"
      },
      {
        "id": 2,
        "text": "Papillary carcinoma"
      },
      {
        "id": 3,
        "text": "Medullary carcinoma"
      },
      {
        "id": 4,
        "text": "Lobular carcinoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option D: Microscopic image of <strong>lobular carcinoma</strong> of the breast shows infiltrating small monomorphic discohesive tumor cells arranged in an&nbsp;<strong>Indian-file </strong>or <strong>single-file pattern</strong>&nbsp;is shown below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a831220b913e403db15a907a1b52f9a8x1280x1142.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/65cca367fb6b4cb998cf9db0b09db25ax1280x1142.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/96d19a43136f49a38104a1cb77bcf09bx1280x1049.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/618a4a7601e84fe996c2ca3e543c30b8x1280x1048.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/529378204b254d588fea2cc28b5cf5fax1280x1224.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6c534f79aec54514a03858d5601eeedex1280x1253.JPEG"
    ]
  },
  {
    "text": "Which of the following is true about the pathogenesis of Hirschsprung disease?",
    "choices": [
      {
        "id": 1,
        "text": "Failure of migration of neural crest cells"
      },
      {
        "id": 2,
        "text": "Loss of ganglion cells"
      },
      {
        "id": 3,
        "text": "Visceral myopathy"
      },
      {
        "id": 4,
        "text": "Obstruction by inflammatory stricture"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Some conditions may cause&nbsp;<strong>acquired</strong> <strong>megacolon</strong>. These include:</p>\n<ul>\n<li><strong>Chagas</strong> <strong>disease</strong>, due to the <strong>loss of ganglion cells</strong></li>\n<li>Visceral myopathy</li>\n<li>Obstruction by neoplasm or inflammatory stricture</li>\n<li>Toxic megacolon complicating ulcerative colitis</li>\n<li>Functional psychosomatic disorders</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5decec866f4145f3aa6d28f6531eeed9x1280x1554.JPEG"
    ]
  },
  {
    "text": "Premature aging in Werner syndrome is due to:",
    "choices": [
      {
        "id": 1,
        "text": "Increased telomerase activity"
      },
      {
        "id": 2,
        "text": "Defect in DNA helicase"
      },
      {
        "id": 3,
        "text": "Increase in length of telomere due to decrease in telomerase activity"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Premature aging</strong> in <strong>Werner</strong> syndrome is due to a&nbsp;<strong>defect </strong>in<strong> DNA helicase.</strong></p>\n<p><strong>DNA helicase&nbsp;</strong>is involved in DNA <strong>replication</strong> and<strong> repair</strong>&nbsp;and other functions requiring DNA unwinding. A defect in this enzyme causes rapid accumulation of damaged chromosomes that may mimic the injury that normally accumulates&nbsp;during cellular aging.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-year-old presented with swelling in the wrist joint. Histopathological examination of the swelling revealed spindle cells with palisading of the nuclei and Verocay bodies. Which of the following is the most likely condition?",
    "choices": [
      {
        "id": 1,
        "text": "Schwannoma"
      },
      {
        "id": 2,
        "text": "Neurofibroma"
      },
      {
        "id": 3,
        "text": "Neuroma"
      },
      {
        "id": 4,
        "text": "Glioma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image below shows verocay bodies in the Antoni-A area of vestibular schwannoma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/271f9d3800ee4d27b9c8a315959c05d6x800x533.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ed70867158b24442af2a6efe8a3c66a3x800x593.JPEG"
    ]
  },
  {
    "text": "B-cells are induced to produce IgE by which of the following:",
    "choices": [
      {
        "id": 1,
        "text": "IL-2"
      },
      {
        "id": 2,
        "text": "IL-4"
      },
      {
        "id": 3,
        "text": "IL-1"
      },
      {
        "id": 4,
        "text": "IL-6"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>IL-4</strong> stimulates<strong> B-cells</strong> to differentiate into<strong> IgE</strong> secreting plasma cells.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The lining epithelium of the respiratory tract of a middle-aged man who is a chronic smoker shows a change from columnar to stratified squamous epithelium, as depicted in the image below. The change is called:",
    "choices": [
      {
        "id": 1,
        "text": "Dysplasia"
      },
      {
        "id": 2,
        "text": "Hypertrophy"
      },
      {
        "id": 3,
        "text": "Atrophy"
      },
      {
        "id": 4,
        "text": "Metaplasia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The change described in the question is called <strong>metaplasia</strong>.&nbsp;It is defined as a <strong>reversible</strong> change in which one type of differentiated cell is <strong>replaced</strong> by another type.</p>\n<p>The table below shows various types of metaplasia:</p>\n<table style=\"width: 497.516px; height: 1064px;\">\n<tbody>\n<tr>\n<td style=\"width: 83px;\">Tissue</td>\n<td style=\"width: 212px;\">Metaplasia</td>\n<td style=\"width: 177.516px;\">Cause</td>\n</tr>\n<tr>\n<td style=\"width: 83px;\">Airways</td>\n<td style=\"width: 212px;\"><strong>Squamous metaplasia</strong>: Normal pseudostratified epithelium is replaced by the squamous epithelium.&nbsp;</td>\n<td style=\"width: 177.516px;\">\n<p>Chronic smoking,</p>\n<p>Deficiency of retinoic acid</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 83px;\">Urinary bladder</td>\n<td style=\"width: 212px;\"><strong>Squamous metaplasia</strong>: Normal transitional epithelium is replaced by squamous epithelium.</td>\n<td style=\"width: 177.516px;\">Bladder stones&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 83px;\">Esophagus</td>\n<td style=\"width: 212px;\"><strong>Columnar metaplasia</strong>: Normal squamous epithelium is replaced by the glandular columnar epithelium (<strong>Barret's esophagus</strong>)</td>\n<td style=\"width: 177.516px;\">Chronic GERD&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 83px;\">Cervix</td>\n<td style=\"width: 212px;\"><strong>Squamous metaplasia</strong>: Normal glandular epithelium may be replaced by the squamous epithelium.</td>\n<td style=\"width: 177.516px;\">Low pH of the cervix</td>\n</tr>\n<tr>\n<td style=\"width: 83px;\">Muscle</td>\n<td style=\"width: 212px;\"><strong>Connective tissue metaplasia:</strong>&nbsp;Formation of bone in the muscle tissue; (<strong>myositis ossificans).</strong></td>\n<td style=\"width: 177.516px;\">After intramuscular hemorrhage</td>\n</tr>\n</tbody>\n</table>\n<p>GERD: Gastroesophageal reflux disease</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/255c0fac25734eb583c7435bae4ece13.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Graft from identical twin is called:",
    "choices": [
      {
        "id": 1,
        "text": "Allograft"
      },
      {
        "id": 2,
        "text": "Autograft"
      },
      {
        "id": 3,
        "text": "Isograft"
      },
      {
        "id": 4,
        "text": "Xenograft"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A graft from an<strong> identical twin</strong> is called an&nbsp;<strong>isograft</strong>.</p>\n<p><strong>Isograft</strong> is defined as an organ or tissue that is taken from a donor and is transplanted to a recipient who has the <strong>same genetic constitution</strong> as the donor. For example, graft between<strong> identical twins.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Histology of reperfused myocardium:",
    "choices": [
      {
        "id": 1,
        "text": "Wavy fibres"
      },
      {
        "id": 2,
        "text": "Neutrophils in cardiac muscle"
      },
      {
        "id": 3,
        "text": "Swelling of cells"
      },
      {
        "id": 4,
        "text": "Eosinophilc contraction band"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"page\" title=\"Page 554\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Reperfused myocardium</strong> shows <strong>eosinophilic contraction bands</strong> on light microscopy. They occur in&nbsp;irreversibly injured myocytes with damaged membranes, when&nbsp;<strong>blood supply</strong> is <strong>restored 12-24 hours</strong> after MI.</p>\n<div class=\"page\" title=\"Page 554\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>During ischemia, the intracellular levels of calcium are increased due to impaired calcium cycling and sarcolemmal damage. This leads to augmented and uncontrolled contraction of myofibrils after reperfusion.&nbsp;</p>\n<p>On microscopic examination,&nbsp;the irreversibly injured myocytes exhibit <strong>contraction bands</strong>&nbsp;that are intensely <strong>eosinophilic intracellular stripes</strong>. These contraction bands are composed of closely <strong>packed sarcomeres</strong>.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"column\">\n<p><strong>Reperfused infarcts</strong> are usually <strong>hemorrhagic</strong> because the vasculature is injured during ischemia. This leads to&nbsp;<strong>bleeding</strong> after the flow is restored.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All-trans retinoic acid is used in the treatment of tumor that is associated with which of the following genetic aberrations?",
    "choices": [
      {
        "id": 1,
        "text": "PML-RARA"
      },
      {
        "id": 2,
        "text": "BCR ABL"
      },
      {
        "id": 3,
        "text": "cMYC"
      },
      {
        "id": 4,
        "text": "RUNX1 ETO"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>All-trans retinoic acid (ATRA) is used in the treatment of <strong>acute promyelocytic leukemia (APML)</strong>, which is associated with <strong>PML-RARA fusion gene</strong>.</p>\n<p>Acute promyelocytic leukemia (APML) is associated with a reciprocal translocation between chromosomes 15 and 17 producing a PML-RARA fusion gene. This fusion gene encodes for a chimeric protein, which consists of a part of the PML protein and a part of the&nbsp;retinoic acid receptor-&alpha; (RAR&alpha;).</p>\n<p>The normal&nbsp;RAR&alpha; binds to the DNA and activates the transcription in the presence of retinoids. However, the chimeric protein produced by PML-RARA has reduced affinity for retinoids. This causes inhibition of transcription, thereby preventing gene expression for cellular differentiation. This leads to the accumulation of myeloid progenitor cells.</p>\n<p>The condition is treated with all-trans retinoic acid. It binds to the PML-RARA chimeric protein. This causes conformational change such that the protein regains its normal function and activates DNA transcription.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old child presented with 15 days of cough. On examination, cervical lymphadenopathy was noted and the lymph node biopsy showed the following features. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Tuberculosis"
      },
      {
        "id": 2,
        "text": "Leprosy"
      },
      {
        "id": 3,
        "text": "Sarcoidosis"
      },
      {
        "id": 4,
        "text": "Syphilis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The histopathological picture showing the <strong>caseating granuloma, </strong>eosinophilic necrotic debris known as <strong>caseation</strong>, bordered by collections of <strong>epithelioid cells</strong>,&nbsp;<strong>Langhan giant cells</strong> (horse shoe shape<strong>)</strong> and lymphocytes and clinical history is suggestive of <strong>tuberculosis</strong>.</p>\n<p>Clinically, tuberculosis presents with chronic cough, fever, weight loss, swollen lymph nodes.</p>\n<p>Other options:</p>\n<p>Option B- <strong>Leprosy</strong> presents with <strong>skin lesions and nerve involvement</strong> with loss of sensation.</p>\n<p>Option C- <strong>Sarcoidosis</strong> shows giant cells with <strong>cytoplasmic inclusions, non-caseating granuloma</strong> with <strong>fibroblastic</strong> <strong>proliferation</strong> at the periphery.</p>\n<p>Option D- <strong>Syphilis</strong> shows&nbsp;thickened capsule/ hyperplasia of capsule accompanied by <strong>fibrosis, perivascular inflammation,</strong> and infiltration of chronic inflammatory cells.</p>\n<p>The below image shows histopathological findings seen in tuberculosis</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4f9b032f29f248b19d20d6ca099a199f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eacc262d009f4597b2cb175268299b48x1280x1137.JPEG"
    ]
  },
  {
    "text": "A 30-year-old woman with a long history of dyspnea, chronic cough with sputum, and wheezing died of respiratory failure following a bout of lobar pneumonia. She was not a smoker or an alcoholic. The lung at autopsy is shown in the image below. Which of the following is most likely to cause the pathological changes shown?",
    "choices": [
      {
        "id": 1,
        "text": "Alpha-1-antitrypsin deficiency"
      },
      {
        "id": 2,
        "text": "Cystic fibrosis"
      },
      {
        "id": 3,
        "text": "Mutation in dynein arms"
      },
      {
        "id": 4,
        "text": "Antibodies against type-IV collagen"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above gross specimen shows <strong>emphysematous damage</strong> involving enlargement of the entire acinus suggestive of <strong>panacinar</strong> <strong>emphysema.&nbsp;</strong>It&nbsp;is caused due to <strong>alpha-1-antitrypsin deficiency.</strong></p>\n<p>In panacinar (panlobular) emphysema, the acini are uniformly enlarged from the level of the <strong>respiratory</strong> <strong>bronchiole</strong> <strong>to</strong> the terminal blind<strong> alveoli</strong>.&nbsp;It occurs commonly in the <strong>lower</strong> <strong>zones</strong> and in the <strong>anterior margins </strong>of the lung and is most<strong> severe </strong>at the <strong>bases</strong>.</p>\n<p>The image below shows&nbsp;panacinar emphysema.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1e80b6f7a14b464a98286264691d89ab.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17cbaa8cc70949dc91fed3f8939934e5x416x467.JPEG"
    ]
  },
  {
    "text": "A 6-foot-5-inch man undergoing a routine physical examination was found to have an early diastolic murmur. His family pedigree chart is given below. Identify the mode of inheritance of this condition.",
    "choices": [
      {
        "id": 1,
        "text": "Autosomal dominant"
      },
      {
        "id": 2,
        "text": "Autosomal recessive"
      },
      {
        "id": 3,
        "text": "X-linked"
      },
      {
        "id": 4,
        "text": "Mitochondrial"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">Patients with Marfan syndrome have&nbsp;<strong>pleiotropic&nbsp;</strong>manifestations:</p>\n<ul>\n<li>Skeletal&nbsp;systems - Tall and decreased&nbsp;upper to lower segment ratio with<strong>&nbsp;long arms, hands,</strong>&nbsp;and&nbsp;<strong>fingers</strong></li>\n<li><strong>Deformities</strong>&nbsp;of the&nbsp;<strong>chest wall,</strong>&nbsp;vertebral column, and foot arches</li>\n<li><strong>Cardiovascular</strong>&nbsp;abnormalities -&nbsp;<strong>mitral valve prolapse</strong>&nbsp;leading to<strong>&nbsp;mitral regurgitation&nbsp;</strong>and&nbsp;<strong>dilatation of aortic root</strong>&nbsp;leading to&nbsp;<strong>aortic regurgitation,</strong>&nbsp;aortic dissection, and rupture.</li>\n<li>Ocular - superio-temporal lens dislocation&nbsp;</li>\n</ul>\n<p>&nbsp;</p>\n</div>\n<div class=\"ng-scope\">&nbsp;</div>\n</div>\n<div class=\"ng-scope\" style=\"box-sizing: border-box; color: rgba(0, 0, 0, 0.87); font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #f5f5f5; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\">&nbsp;</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/61514dd654c74c95b8cffa569f5a1668.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3a0a20a8c431451c82cef40e00c73cf0x1280x1763.JPEG"
    ]
  }
];
        let quizName = '082 Pathology Neet 2020';
        let hierarchy = ["Marrow", "PYQs", "Pathology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>