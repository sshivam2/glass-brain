<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>045 Biochemistry Neet 2024 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Biochemistry
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">21</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A patient underwent gastrectomy for gastric adenocarcinoma. Which of the following vitamins needs to be supplemented in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin B12"
      },
      {
        "id": 2,
        "text": "Vitamin B1"
      },
      {
        "id": 3,
        "text": "Vitamin A"
      },
      {
        "id": 4,
        "text": "Vitamin D"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A patient who has undergone<strong> gastrectomy</strong> for gastric adenocarcinoma needs to be supplemented with <strong>vitamin B12.</strong></p>\n<p><strong>Vitamin B12 absorption</strong> is a complex process that relies on several factors. <strong>Intrinsic factor</strong>, a glycoprotein secreted by the <strong>parietal cells</strong> in the <strong>stomach</strong>, is essential for this process. <strong>Gastric acid</strong> and <strong>pepsin</strong> release vitamin B12 from dietary proteins, allowing it to bind with <strong>cobalophilin</strong> in the saliva. In the jejunum, cobalophilin is broken down, freeing vitamin B12 to bind with intrinsic factor. This complex is then <strong>absorbed</strong> in the <strong>distal ileum</strong> through specific receptors.\u00a0 Following <strong>gastrectomy</strong>, the <strong>production</strong> of <strong>intrinsic factor</strong> is <strong>impaired</strong> due to the removal of gastric tissue, making vitamin B12 absorption difficult. Therefore, <strong>vitamin B12 supplementation</strong> is necessary after gastrectomy to <strong>prevent deficiency</strong>.</p>\n<p>Other<strong> complications </strong>of <strong>gastrectomy </strong>include:</p>\n<ul>\n<li>Nutritional deficiencies- <strong>Iron deficiency anemia (most common), Vitamin B12 deficiency</strong>, and osteoporosis</li>\n<li>Dumping syndrome: early and late</li>\n<li>Diarrhea</li>\n<li>Duodenal stump leak/blow out</li>\n<li>Bile reflux gastritis and esophagitis</li>\n<li>Gall stones</li>\n<li>Roux syndrome</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old child from a southern Indian state, hailing from a poor family, presents with rough and scaly skin. The child\u2019s diet lacks vegetables and fruits. After treatment with linseed oil, Vitamin A, and Vitamin B, the symptoms subsided. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Lichen planus"
      },
      {
        "id": 2,
        "text": "Erythroderma"
      },
      {
        "id": 3,
        "text": "Phrynoderma"
      },
      {
        "id": 4,
        "text": "Keratosis pilaris"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option B: <strong>Erythroderma</strong> is a serious skin condition characterized by <strong>widespread redness</strong> (erythema) and scaling affecting more than <strong>90%</strong> of the <strong>body's surface area.</strong> It is also known as <strong>exfoliative dermatitis</strong> and often results from <strong>underlying skin disorders, systemic diseases,</strong> or <strong>drug reactions.</strong></p>\n<p>Option D: <strong>Keratosis pilaris</strong> is an inherited abnormality of <strong>keratinization.</strong> It affects the follicular orifices leading to <strong>keratotic follicular plugging, perifollicular erythema,</strong> and <strong>follicular atrophy.</strong> It usually occurs during puberty. They present as <strong>small, keratotic papules</strong> on the extensor aspects of the limbs, particularly the arms which can lead to ingrowing of the hair. Treatment is purely reserved for cosmetic purposes.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e487fa61df854ab7894ce2b5d0d63010x720x434.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/22f1a7f935d44bc68f7fe39709fd1971x1280x1187.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b29c313687194d5ab1b4de38e3193a12x1280x1237.JPEG"
    ]
  },
  {
    "text": "A  patient presents to the emergency department with severe abdominal pain, nausea, and vomiting. The laboratory results show serum triglyceride levels > 2000 mg/dl. Which deficiency could be contributing to the patient's condition?",
    "choices": [
      {
        "id": 1,
        "text": "Apolipoprotein C II"
      },
      {
        "id": 2,
        "text": "Apolipoprotein B48"
      },
      {
        "id": 3,
        "text": "Apolipoprotein B100"
      },
      {
        "id": 4,
        "text": "Apolipoprotein A I"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>elevated triglyceride levels </strong>and symptoms of <strong>acute pancreatitis</strong> are likely related to a <strong>deficiency</strong> in <strong>apolipoprotein C II</strong>.</p>\n<p>Apolipoprotein C2 is a <strong>lipoprotein lipase</strong> cofactor that catalyzes cleavage of chylomicrons.\u00a0Defective apo C II results in <strong>type I hyperlipoproteinemia/ familial lipoprotein lipase deficiency</strong>. The resulting inactive lipoprotein lipase leads to<strong> slow clearance</strong> of <strong>chylomicrons</strong> and <strong>VLDL</strong>, and <strong>low levels</strong> of <strong>LDL </strong>and<strong> HDL</strong>. Patients present with <strong>eruptive xanthomas</strong> and <strong>acute pancreatitis</strong>.</p>\n<p><strong>Lipoprotein lipase</strong> is an extracellular enzyme that is present in the <strong>capillary walls </strong>of most tissues. It is chiefly <strong>synthesized</strong> by the <strong>adipose tissue</strong>, and <strong>cardiac</strong> and <strong>skeletal muscles</strong>. A deficiency of lipoprotein lipase or apo C-II leads to type 1 hyperlipoproteinemia or <strong>familial chylomicronemia</strong> which leads to an <strong>increased risk </strong>of <strong>acute pancreatitis</strong>.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Apo B48</strong> is involved in the <strong>assembly</strong> of <strong>chylomicrons</strong>. Defects in this protein are not associated with familial hypercholesterolemia.</p>\n<p>Option C: <strong>Apo B100</strong> binds <strong>low-density lipoprotein receptors</strong>. For the <strong>uptake</strong> of <strong>LDL</strong>, apo B100 acts as a <strong>ligand</strong> for the low-density lipoprotein receptor.</p>\n<p>Option D: <strong>Apo A1</strong>\u00a0activates<strong> lecithin cholesterol acyltransferase (LCAT)</strong>. LCAT is the enzyme <strong>present </strong>in<strong> HDL</strong>, which is activated by apo A1. LCAT converts <strong>free cholesterol </strong>(amphipathic) in HDL to <strong>cholesterol ester</strong>(hydrophobic). The initial <strong>discoidal</strong> shape now becomes <strong>spherical</strong>. This facilitates <strong>reverse cholesterol transport</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "After the age of 12, the boy had an intellectual disability. On examination, fingernail abrasions, excessive biting of lips, and increased levels of serum uric acid were observed. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hurler syndrome"
      },
      {
        "id": 2,
        "text": "Lesch-Nyhan disease"
      },
      {
        "id": 3,
        "text": "Hunter syndrome"
      },
      {
        "id": 4,
        "text": "Von Gierke syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Orange</strong> <strong>diaper syndrome</strong> can be an <strong>early indicator</strong> of <strong>Lesch-Nyhan syndrome</strong>. At birth, individuals with Lesch-Nyhan syndrome typically appear <strong>asymptomatic</strong>, with normal prenatal growth and development. The condition is often <strong>first detected </strong>through the presence of <strong>orange-coloured crystals</strong> in the <strong>diaper</strong>, resulting from <strong>hyperuricemia</strong>. Since hyperuricemia is a common feature across all variants of HGPRT deficiency, which causes Lesch-Nyhan syndrome, predicting associated neurodevelopmental abnormalities requires enzyme activity testing.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d295845ea4924b19ab07ca33a23f65bex1280x1203.JPEG"
    ]
  },
  {
    "text": "A neonate was brought with features of lethargy, and poor oral intake. On examination, a cataract was seen. Urine Benedict's test was positive but negative for Glucose. What will be the enzyme deficiency in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Hexokinase"
      },
      {
        "id": 2,
        "text": "Galactokinase"
      },
      {
        "id": 3,
        "text": "Galactose-1-phosphate uridyl transferase"
      },
      {
        "id": 4,
        "text": "Phosphofructokinase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Other options:</p>\n<p>Option A: <strong>Hexokinase</strong> is a <strong>glycolytic enzyme</strong>, involved in maintaining intracellular glucose concentration by catalysing the<strong> first step</strong> in <strong>glucose metabolism</strong>, i.e., <strong>phosphorylation</strong> of <strong>intracellular glucose</strong>. \u00a0Its <strong>deficiency</strong> leads to <strong>hemolytic anaemia</strong>. <strong>Splenomegaly</strong> may be another presenting feature.\u00a0</p>\n<p>Option B: <strong>Galactokinase</strong> is the enzyme responsible for the <strong>conversion</strong> of galactose to <strong>galactose 1-phosphate</strong>. <strong>Only cataract</strong> is seen in the deficiency of this enzyme because galactose-1-phosphate is not formed. Hence <strong>no toxic effects</strong> of this compound are manifested.\u00a0</p>\n<p>Option D: <strong>Phosphofructokinase</strong> is a <strong>key regulatory enzyme</strong> of <strong>glycolysis</strong> and is necessary for the <strong>ATP-dependent</strong> conversion of <strong>fructose-6-phosphate</strong> to <strong>fructose-1,6-diphosphate</strong>. <strong>Tauri's disease</strong> is <strong>type VII glycogen storage disorder</strong> that results due to the <strong>deficiency</strong> of phosphofructokinase.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f245b4b2d54f41bf859920682ee1e3f3x1280x1142.JPEG"
    ]
  },
  {
    "text": "A patient diagnosed with a rare homozygous recessive condition presented with ectopia lentis. In the peripheral smear, there was no megaloblastic anemia. Later, he was found to have elevated homocysteine levels in the blood. Which of the following supplementations will help the patient?",
    "choices": [
      {
        "id": 1,
        "text": "Thiamine"
      },
      {
        "id": 2,
        "text": "Pyridoxine"
      },
      {
        "id": 3,
        "text": "Biotin"
      },
      {
        "id": 4,
        "text": "Riboflavin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Demonstration of <strong>elevated total homocysteine</strong> in the blood confirms the diagnosis. 50% of the cases of homocystinuria are termed pyridoxine-responsive because large doses of pyridoxine can enhance the activity of deficient enzymes in these patients. Administration of large doses of pyridoxine (vitamin B6) restores the activity of the deficient enzyme in half of all cases of homocystinuria.</p>\n<p><strong>Folate supplementation</strong> is also added to overcome any folate deficiency that might occur due to increased conversion of homocysteine to methionine. For the other 50% of the patients, the treatment consists of <strong>methionine restriction</strong> and <strong>cysteine supplementation</strong>. In addition, betaine (methyl group donor), folate and vitamin B12 may be added.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8c708756ccdb447c80791b94f81660a2x1280x1045.PNG"
    ]
  },
  {
    "text": "You received a text message from your friend JOHN DOE about occupational exposure after he visited his doctor as shown below. What is the test used to diagnose?",
    "choices": [
      {
        "id": 1,
        "text": "Anthracosis"
      },
      {
        "id": 2,
        "text": "Lead poisoning"
      },
      {
        "id": 3,
        "text": "Silicosis"
      },
      {
        "id": 4,
        "text": "Asbestosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The test for <strong>coproporphyrinogen</strong> levels is used as a <strong>screening test</strong> to diagnose <strong>lead poisoning</strong>.</p>\n<p><strong>Lead</strong> <strong>inhibits</strong> the enzymes <strong>delta-aminolevulinic acid (ALA) dehydratase</strong> and <strong>ferrochelatase</strong>, which are involved in <strong>heme synthesis</strong>. ALA is converted to <strong>porphobilinogen</strong> by <strong>ALA dehydratase</strong>, <strong>inhibited</strong> by <strong>lead</strong>. So, serum <strong>porphobilinogen levels</strong> are <strong>decreased</strong> in <strong>lead poisoning</strong>.</p>\n<p>Laboratory findings include the following:</p>\n<ul>\n<li>An <strong>elevated serum lead level</strong></li>\n<li>An <strong>elevated</strong> level of <strong>protoporphyrin</strong> in blood and <strong>elevated ALA</strong> and <strong>coproporphyrinogen</strong> in<strong> urine</strong></li>\n<li><strong>Microcytic anemia</strong> with <strong>basophilic stippling</strong> in peripheral smear due to ineffective heme synthesis</li>\n</ul>\n<p>Clinical features of <strong>chronic lead poisoning</strong> include <strong>facial pallor</strong>, anemia, basophilic stippling of red cells, <strong>blue lines</strong> in the <strong>gums</strong>, and retinal stippling. In the later phase, the findings are <strong>colic abdominal pain</strong>, constipation, nerve palsy, encephalopathy, and disturbance of the genito-urinary and cardiovascular systems.</p>\n<p>Diagnosis of lead poisoning:</p>\n<table style=\"height: 163px;\" width=\"425\">\n<tbody>\n<tr>\n<td style=\"width: 204px; text-align: center;\"><strong>Laboratory parameter</strong></td>\n<td style=\"width: 205px; text-align: center;\"><strong>Value</strong></td>\n<td style=\"width: 205px; text-align: center;\"><strong>Remarks</strong></td>\n</tr>\n<tr>\n<td style=\"width: 204px;\">Coproporphyrin in urine</td>\n<td style=\"width: 205px;\">&gt;150 mcg/L</td>\n<td style=\"width: 205px;\"><strong>Screening test</strong>- indicates exposure</td>\n</tr>\n<tr>\n<td style=\"width: 204px;\">Aminolevulinic acid (ALA) in urine</td>\n<td style=\"width: 205px;\">&gt;5 mg/L</td>\n<td style=\"width: 205px;\">Indicates lead absorption</td>\n</tr>\n<tr>\n<td style=\"width: 204px;\">Lead in blood</td>\n<td style=\"width: 205px;\">&gt;70 mcg/dL</td>\n<td style=\"width: 205px;\">Clinical symptoms appear</td>\n</tr>\n<tr>\n<td style=\"width: 204px;\">Lead in urine</td>\n<td style=\"width: 205px;\">0.8 mg/L</td>\n<td style=\"width: 205px;\">Indicates lead absorption</td>\n</tr>\n<tr>\n<td style=\"width: 204px;\">Basophilic stippling of RBCs</td>\n<td style=\"width: 205px;\">\u00a0</td>\n<td style=\"width: 205px;\">Sensitive indicator</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f40e712b5fc54f188419f68a701117fe.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 3-year-old child is brought to the OPD with complaints of persistent delayed developmental milestones, and hyperpigmented macular lesions on the body which are more pronounced on exposure to sunlight. What is the error in DNA multiplication?",
    "choices": [
      {
        "id": 1,
        "text": "Base excision repair"
      },
      {
        "id": 2,
        "text": "Nucleotide excision repair"
      },
      {
        "id": 3,
        "text": "DNA mismatch repair"
      },
      {
        "id": 4,
        "text": "Homologous recombination"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The history points to a diagnosis of <strong>xeroderma pigmentosum</strong>. It is characterized by <strong>defective nucleotide excision repair</strong>.</p>\n<p>UV radiation leads to\u00a0<strong>pyrimidine dimerization</strong>\u00a0in DNA strands, preventing further replication by DNA polymerase.\u00a0The nucleotide excision repair mechanism corrects the dimer formation in DNA.\u00a0<strong>Xeroderma pigmentosum</strong> (XP) is an\u00a0<strong>autosomal recessive</strong>\u00a0genetic disorder characterized by an inability<span class=\"fontstyle0\">\u00a0to repair DNA pyrimidine dimers caused by UV exposure</span>. This leads to clinical and cellular hypersensitivity to ultraviolet (UV) radiation.</p>\n<p>In XP the skin is normal at birth and has a three-stage progression:</p>\n<ul>\n<li>Diffuse <strong>erythema,</strong> scaling, and <strong>freckle-like areas</strong> over the sun-exposed regions of the body at around 6 months of age.</li>\n<li>The\u00a0second stage is characterized by <strong>poikiloderma</strong>. This\u00a0results in <strong>skin atrophy, telangiectasias</strong> with mottled hyperpigmentation, and hyperpigmentation.</li>\n<li>In the <strong>third stage</strong> appearance of <strong>cutaneous malignancies</strong> like squamous cell carcinomas, malignant melanoma, basal cell carcinoma, and fibrosarcoma.\u00a0</li>\n</ul>\n<p>Most of the cases with XP have ocular manifestations. Initially, it appears as\u00a0<strong>photophobia</strong>,\u00a0<strong>conjunctivitis</strong>, ectropion, and symblepharon with ulceration.\u00a0Accumulation of pyrimidine dimer\u00a0causes\u00a0<strong>corneal opacification</strong>\u00a0and\u00a0<strong>neovascularization</strong>. Ocular malignancies are common in the lids, conjunctiva, and cornea as they are exposed to as much as facial skin. XP is ultimately fatal, and early detection of the skin lesions and their management with prevention of UV ray exposures prolong life.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with a family history of coronary heart disease presented with tendon xanthomas. His lipid profile showed serum LDL to be 280 mg/dL and triglyceride levels was 398 mg/dl. What is the likely defect in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "LDL receptor defect"
      },
      {
        "id": 2,
        "text": "LDL metabolism"
      },
      {
        "id": 3,
        "text": "VLDL metabolism"
      },
      {
        "id": 4,
        "text": "Lipoprotein lipase deficiency"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Note: <strong>Lipoprotein lipase (LPL) deficiency</strong> causes type I hyperlipoproteinemia due to <strong>defects in LPL</strong> or <strong>apo C-II.</strong> <strong>Eruptive xanthomas</strong> are seen. <strong>Chylomicrons</strong> and <strong>VLDL</strong> are elevated. <strong>LDL</strong> and <strong>HDL</strong> are<strong> low.</strong> There is no risk for coronary disease.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/864ecc007850432da511921ae29204c9x284x178.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3a4d2e15aa1c430891887f2f5685ec09x512x416.PNG"
    ]
  },
  {
    "text": "Which food item among these is the primary source of thiamine in Indians?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Among the various food items given on the plate, the <strong>primary source</strong> of <strong>thiamine </strong>(<strong>vitamin B1</strong>) in the <strong>Indian diet </strong>is option <strong>4 i.e. chapati and rice</strong>.</p>\n<p>The thiamine content in various foods in decreasing order are as follows:</p>\n<ul>\n<li>Gingelly seeds</li>\n<li>Groundnut</li>\n<li>Bengal gram</li>\n<li><strong>Whole wheat</strong></li>\n<li><strong>Rice</strong></li>\n</ul>\n<p><strong>Gingelly (sesame) seeds </strong>have the <strong>highest </strong>content of <strong>thiamine</strong>.</p>\n<p>Thiamine is lost from rice during the process of milling. As it is a water-soluble vitamin, washing, and cooking rice cause further losses. Hence, it is advisable to <strong>avoid highly polished rice</strong> and <strong>eat parboiled</strong> or <strong>under-milled rice</strong>.</p>\n<p>Thiamine is essential for energy metabolism, particularly in carbohydrate processing. Its active form, <strong>thiamine diphosphate</strong>, acts as a <strong>coenzyme</strong> for three critical enzyme complexes: <strong>pyruvate dehydrogenase, \u03b1-ketoglutarate dehydrogenase,</strong> and <strong>branched-chain keto acid dehydrogenase.</strong> This coenzyme facilitates oxidative <strong>decarboxylation</strong> by forming a reactive carbanion that attaches to carbonyl groups like those in pyruvate, leading to the release of CO2. Thiamine diphosphate is also vital for <strong>transketolase</strong> in the <strong>pentose phosphate pathway</strong>.</p>\n<p><strong>Thiamine triphosphate</strong>, another form of thiamin, helps <strong>regulate nerve function</strong> by activating chloride channels in nerve membranes.</p>\n<p>A thiamine deficiency can cause several conditions such as <strong>beriberi,</strong> characterized by <strong>peripheral neuritis</strong>, which can also involve heart failure and edema. Additionally, thiamine deficiency can lead to <strong>Wernicke's encephalopathy </strong>and<strong> Korsakoff's psychosis</strong>, commonly associated with alcohol or drug abuse. The lack of thiamine impairs the conversion of pyruvate to acetyl-CoA, leading to increased levels of lactate and pyruvate in the blood, which can result in dangerous <strong>lactic acidosis</strong>, especially in those consuming high-carbohydrate diets.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/152832312f1d4fb6aa882be575991e79.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f112b7a4bcab45a0b02404863a0eb91ax1280x1411.JPEG"
    ]
  },
  {
    "text": "A young female comes to the emergency department after ingesting 10 tablets of Phenobarbital. Which of the following components of the ETC is inhibited by this drug?",
    "choices": [
      {
        "id": 1,
        "text": "Succinate - Fe"
      },
      {
        "id": 2,
        "text": "Cytochrome I-II"
      },
      {
        "id": 3,
        "text": "Complex I to Q"
      },
      {
        "id": 4,
        "text": "Complex IV"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Phenobarbital</strong> is a barbiturate that<strong> inhibits complex I to Q </strong>of the <strong>electron transport chain</strong>.\u00a0</p>\n<p><strong>Complex I</strong> of the electron transport chain is <strong>NADH-Q oxidoreductase</strong>. It <strong>oxidizes NADH</strong> and <strong>reduces coenzyme Q</strong>. <strong>Phenobarbital</strong> inhibits complex I to Q so that the <strong>electrons</strong> <strong>will not </strong>be able to be <strong>transferred</strong> from <strong>NADH to coenzyme Q</strong>, which is the first step in the electron transport chain. As a result, the rate of <strong>oxygen consumption</strong> will <strong>decrease</strong>.</p>\n<p>The electron transport chain (ETC) represents the <strong>final pathway</strong> through which electrons, originating from the oxidation of carbohydrates, fatty acids, and amino acids, are channeled toward a<strong> final reaction</strong> with <strong>oxygen</strong> to produce <strong>water</strong> and <strong>ATP</strong>. The ETC complexes are embedded in the <strong>inner mitochondrial membrane</strong>.</p>\n<p>The <strong>oxidation</strong> of compounds by ETC complexes leads to the release of <strong>free energy</strong>. This is used to <strong>pump H+ </strong>to the<strong> intermembrane space</strong>. This results in the formation of a <strong>proton motive force</strong> that is used for the <strong>phosphorylation</strong> of ADP to ATP.\u00a0Thus, oxidation is coupled with phosphorylation to generate ATP. <strong>NADH</strong> generates <strong>2.5 ATP</strong> and <strong>FADH2</strong> generates <strong>1.5 ATP</strong>.</p>\n<p>The table below summarizes the inhibitors of the electron transport chain. \u00a0</p>\n<table style=\"border-collapse: collapse; width: 46.0089%; height: 270px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 50.0555%; height: 22.3984px; text-align: center;\"><strong>Complexes of ETC</strong></td>\n<td style=\"width: 50.0555%; height: 22.3984px; text-align: center;\"><strong>Inhibitors</strong></td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 50.0555%; height: 22.3984px;\">\n<p>Complex I:</p>\n<p>NADH-Q oxidoreductase</p>\n</td>\n<td style=\"width: 50.0555%; height: 22.3984px;\">Piericidin A, <strong>phenobarbital</strong>, rotenone</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 50.0555%; height: 22.3984px;\">\n<p>Complex II:</p>\n<p>Succinate-Q reductase</p>\n</td>\n<td style=\"width: 50.0555%; height: 22.3984px;\">TTFA (thenoyltrifluoroacetone), carboxin, malonate</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 50.0555%; height: 22.3984px;\">\n<p>Complex III:</p>\n<p>Q- Cyt c oxidoreductase</p>\n</td>\n<td style=\"width: 50.0555%; height: 22.3984px;\">BAL (British anti-lewisite), antimycin A</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 50.0555%; height: 22.3984px;\">\n<p>Complex IV:</p>\n<p>Cyt c oxidase</p>\n</td>\n<td style=\"width: 50.0555%; height: 22.3984px;\">Hydrogen sulfide, carbon monoxide, cyanide\u00a0</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 50.0555%; height: 22.3984px;\">\n<p>Complex V:</p>\n<p>ATP Synthase</p>\n</td>\n<td style=\"width: 50.0555%; height: 22.3984px;\">Atractyloside, oligomycin</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child presents to you with bone pain, hepatosplenomegaly, and pancytopenia. A trephine biopsy aspirate shows the following finding. Which of the following is the most likely enzyme deficient in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Galactocerebosidase"
      },
      {
        "id": 2,
        "text": "Glucocerebrosidase"
      },
      {
        "id": 3,
        "text": "Sphingomyelinase"
      },
      {
        "id": 4,
        "text": "Alpha 1,4-glucosidase"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of a child with bone pain, hepatosplenomegaly, and trephine biopsy showing <strong>Gaucher's cell</strong> with a characteristic <strong>crumpled tissue paper</strong> appearance is suggestive of <strong>Gaucher's disease.</strong>\u00a0The deficient enzyme is <strong>glucocerebrosidase</strong> (also known as <strong>beta-glucosidase</strong>).</p>\n<p>Gaucher's disease is an inborn error of metabolism caused due to a deficiency of <strong>beta-glucocerebrosidase</strong>. It is the most common <strong>lysosomal storage disorder</strong> and the mode of inheritance is <strong>autosomal recessive</strong>. There is an accumulation of lipid-laden macrophages in the spleen, liver, and other tissues.</p>\n<p>There are three clinical subtypes - type I (chronic non-neuronopathic), type II (acute neuronopathic), and type III (intermediate). Clinical features include anemia, thrombocytopenia, hepatosplenomegaly, and neurological features depending on the subtype.\u00a0</p>\n<p><strong>Gaucher's cells</strong>\u00a0are formed as a result of the accumulation of massive amounts of glucocerebrosides within the phagocytes. The cells have a fibrillary cytoplasm and give a <strong>crumpled tissue paper appearance</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9c593526d9794bf0a6c44ed277bb451e.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old lady comes with complaints of erythematous scaly rash, loose stools, and cognitive dysfunction. The rash involved her forearm, neck, and face. She seems to have difficulty remembering things from the recent past. Her electrolytes are within normal range. She admits to having shifted to a corn-based diet due to economic reasons. Which of the following would improve her symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Oral Nicotinamide supplementation"
      },
      {
        "id": 2,
        "text": "High dose of IV thiamine"
      },
      {
        "id": 3,
        "text": "High Dose Vitamin C"
      },
      {
        "id": 4,
        "text": "Stop corn diet"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical features suggests the diagnosis of <strong>pellagra,</strong> due to her <strong>corn-based diet</strong>. <strong>Oral nicotinamide </strong>supplements can improve her symtpoms.\u00a0</p>\n<p><strong>Niacin</strong> can be synthesized in the body from <strong>tryptophan.</strong> Two compounds, <strong>nicotinic acid</strong> and <strong>nicotinamide,</strong> have the biological activity of <strong>niacin.</strong> The <strong>nicotinamide</strong> ring of the coenzymes <strong>nicotinamide adenine dinucleotide</strong> (NAD) and <strong>nicotinamide adenine dinucleotide phosphate</strong> (NADP) participate in <strong>oxidation/reduction</strong> reactions.</p>\n<p>The initial symptoms of pellagra include <strong>loss</strong> of <strong>appetite, generalized weakness, irritability, abdominal pain,</strong> and <strong>vomiting.</strong> This is followed by bright <strong>red glossitis</strong> and a characteristic <strong>pigmented, scaly skin rash</strong> in <strong>sun-exposed</strong> areas. This rash is known as <strong>Casal\u2019s</strong> <strong>necklace</strong> when it forms a ring around the neck.\u00a0</p>\n<p>The 4Ds of pellagra:</p>\n<ul>\n<li>Diarrhea</li>\n<li>Dermatitis</li>\n<li>Dementia, leading to</li>\n<li>Death</li>\n</ul>\n<p>It is diagnosed by measuring urinary levels of <strong>2-methyl nicotinamide</strong> and <strong>2-pyridone.</strong></p>\n<p>Other options:\u00a0</p>\n<p>Option B: Thiamine (Vitamin B1) deficiency leads to conditions like <strong>beriberi</strong> and <strong>Wernicke-Korsakoff</strong> syndrome, which are characterized by symptoms such as <strong>muscle weakness, peripheral</strong> neuropathy, cardiovascular issues, and confusion. While <strong>cognitive dysfunction</strong> can result from <strong>thiamine deficiency, rash</strong> and <strong>loose stools</strong> do not fit with <strong>thiamine deficiency.</strong> Therefore, thiamine would not address the full spectrum of this patient\u2019s symptoms.</p>\n<p>Option C: <strong>Vitamin</strong> <strong>C deficiency</strong> causes <strong>scurvy,</strong> which is associated with symptoms like <strong>bleeding gums, bruising, joint pain,</strong> and fatigue. Scurvy is not associated with a <strong>rash</strong> like the one described, nor does it typically cause <strong>cognitive dysfunction</strong> or <strong>diarrhea.</strong> Hence, high-dose vitamin C would not improve this patient\u2019s symptoms.</p>\n<p>Option D: <strong>Corn-based diets</strong> are <strong>low</strong> in <strong>niacin</strong> and <strong>tryptophan,</strong> leading to <strong>pellagra</strong> over time, especially if the diet is <strong>not balanced</strong> with other niacin-rich foods. While <strong>stopping</strong> the <strong>corn-based</strong> diet could prevent further <strong>niacin deficiency,</strong> it will not <strong>immediately address</strong> the <strong>existing deficiency</strong> and symptoms like rash, diarrhea, and cognitive dysfunction. The patient would still need <strong>niacin supplementation</strong> to resolve the current symptoms.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-month-old child was brought to the clinic with a history of difficulty in feeding and failure to thrive. On examination,  the child is floppy, 48 cm in length and weighs 2.8 kg. There is generalized hypotonia, macroglossia and hepatomegaly. The chest x-ray of the child is given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ebstein's anomaly"
      },
      {
        "id": 2,
        "text": "Pompe's disease"
      },
      {
        "id": 3,
        "text": "Transposition of great arteries"
      },
      {
        "id": 4,
        "text": "Von- Gierke's disease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Other options:</p>\n<p>Option A- <strong>Ebstein's anomaly </strong>is the teratogenic effect of maternal <strong>lithium </strong>consumption which causes a <strong>cyanotic heart disease</strong> in the newborn with <strong>atrialization of the right ventricle </strong>and<strong> conduction defects</strong>. The chest X-ray will show a <strong>box-shaped enlargement </strong>of the right atrium and <strong>pulmonary oligemia</strong>.</p>\n<p>Option C- <strong>Transposition of great vessels </strong>is <strong>cyanotic congenital heart disease</strong> where there is a switch in the position of two main arteries i.e. <strong>pulmonary artery</strong> and <strong>aorta</strong>. X-ray shows of <strong>egg-on-string</strong> appearance with <strong>pulmonary plethora.</strong></p>\n<p>Option D-\u00a0<strong>Von Gierke disease</strong> occurs due to a deficiency of <strong>glucose-6-phosphatase</strong>. Patients present commonly in 3-4 months of age with hypoglycemia, lactic acidosis, hepatomegaly, growth retardation, hyperuricemia, and hyperlipidemia.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0cbea93263984d668074e77eb4e5c40e.PNG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/7b09badb0f8f4f48893903bd9ba1d070.JPEG"
    ]
  },
  {
    "text": "A patient presented with multiple yellowish raised plaques on eyelids, xanthomas on the achilles tendon. What is the likely cause for the patient's presentation?",
    "choices": [
      {
        "id": 1,
        "text": "Familial hypercholesterolemia"
      },
      {
        "id": 2,
        "text": "Tangier's disease"
      },
      {
        "id": 3,
        "text": "Xanthomatosis"
      },
      {
        "id": 4,
        "text": "Fabry's disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option C: <strong>Xanthomatosis</strong> is the <strong>deposition of lipids </strong>in various parts of the body like tendon xanthomas, xanthelasma, eruptive and tuberous xanthomas. This is a <strong>sign</strong> of underlying <strong>lipid metabolism disorders</strong>.</p>\n<p>Option D: <strong>Fabry's disease</strong> is a<strong> lysosomal storage disorder </strong>with a defect in <strong>alpha-galactosidase</strong>. It causes angiokeratomas, hypohidrosis and characteristic Maltese cross deposits in urine.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/864ecc007850432da511921ae29204c9x284x178.PNG",
      "https://cdn1.dailyrounds.org/uploads/7dbbfa81557f4459849ff45d5b267b06.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dd350316b6c9423d8b3a4b0547759642x225x225.JPEG"
    ]
  },
  {
    "text": "A child presented to the OPD with complaints of fatigue and muscle weakness while exercising. Laboratory investigations found that LCFA oxidation was affected. A muscle biopsy was done which revealed the presence of fat vacuoles. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "LDL defect"
      },
      {
        "id": 2,
        "text": "LPL defect"
      },
      {
        "id": 3,
        "text": "Fatty acid synthase defect"
      },
      {
        "id": 4,
        "text": "Carnitine deficiency"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Clinical features of carnitine deficiency begin in childhood and include poor feeding, lethargy, liver dysfunction and hepatomegaly, hypotonia, and dilated cardiomyopathy. <strong>Treatment</strong> involves <strong>oral supplementation of\u00a0carnitine</strong>.</p>\n<p>Other options:</p>\n<p>Option A: An <strong>increase </strong>in <strong>LDL</strong> can cause <strong>hyperlipoproteinemia</strong>, and reduced LDL can cause defective absorption of fat-soluble vitamins.</p>\n<p>Option B: <strong>LPL</strong> is involved in hydrolysis of lipoproteins in the blood to free fatty acid and glycerol which are then taken up by the tissues. A defective LPL can cause <strong>type 1 familial chylomicronemia syndrome</strong> presenting as<strong> </strong>pancreatitis.</p>\n<p>Option C: <strong>Fatty acid synthase</strong> is a <strong>multienzyme complex</strong> involved in <strong>fatty acid synthesis</strong> in the cytosol which when defective may impair energy production, essential fatty acids, and affect metabolic pathways. There is no accumulation of fat vacuoles since fatty acids are not synthesised.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/29bd1a96f29a402d93683973dfc54bcfx1280x1913.JPEG"
    ]
  },
  {
    "text": "A mother came back home to see her child suffering from difficulty breathing. The child had contact with rotenone while trying to bathe their pet. The child was taken to the emergency department and she later passed away. Inhibition of which of the following enzymes was the likely cause of her death?",
    "choices": [
      {
        "id": 1,
        "text": "Cytochrome c reductase"
      },
      {
        "id": 2,
        "text": "Succinate dehydrogenase"
      },
      {
        "id": 3,
        "text": "NADH-Q oxidoreductase"
      },
      {
        "id": 4,
        "text": "Cytochrome oxidase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given clinical vignette, inhibition of<strong> NADH-Q oxidoreductase </strong>by<strong> rotenone </strong>was the likely cause of breathlessness, followed by death in this child.</p>\n<p>Rotenone inhibits <strong>complex I</strong>, thereby inhibiting the <strong>respiratory chain,</strong> so electrons cannot be transferred to oxygen. This <strong>halts ATP production</strong>,<strong>\u00a0</strong>leading to an energy deficit in the cells, eventually causing cell death. The ETC constitutes four enzyme complexes:</p>\n<ul>\n<li><strong>Complex I: NADH-Q oxidoreductase</strong></li>\n<li>Complex II: Succinate-Q reductase</li>\n<li>Complex III: Q-cytochrome c oxidoreductase</li>\n<li>Complex IV: cytochrome c oxidase</li>\n</ul>\n<p>Components of complex I are <strong>FMN</strong> and <strong>Fe-S complex</strong>. NADH-Q oxidoreductase catalyses the transfer of electrons from NADH to coenzyme Q, along with the transfer of four H+ across the membrane.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child suffering from phenylketonuria was started on necessary dietary modifications but the neurological symptoms persisted. Phenylalanine hydroxylase levels in the serum are normal. Which of the following enzymes is likely to be deficient in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Tyrosine hydroxylase"
      },
      {
        "id": 2,
        "text": "Homogentisate oxidase"
      },
      {
        "id": 3,
        "text": "Tetrahydrobiopterin synthase"
      },
      {
        "id": 4,
        "text": "Dopa decarboxylase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This child with <strong>phenylketonuria </strong>with <strong>neurological symptoms</strong> not improving despite dietary modifications and<strong> normal serum phenylalanine hydroxylase </strong>level is suggestive of <strong>tetrahydrobiopterin (BH4) synthase deficiency.</strong></p>\n<p>A diet low in phenylalanine (eg: tapioca) is the mainstay of treatment for classic phenylketonuria but may not be sufficient in BH4 deficiency where <strong>supplementation </strong>with<strong> BH4 </strong>and<strong> </strong>deficient<strong> neurotransmitter precursors (L-dopa)</strong> is required to overcome the block.</p>\n<p><strong>Phenylketonuria </strong>(PKU) is an inborn error of metabolism seen due to a defect in the enzyme\u00a0<strong>phenylalanine hydroxylase </strong>(classic phenylketonuria) and less commonly, due to a defect in <strong>BH4 synthase </strong>(non-classical). These defects result in the impaired conversion of <strong>phenylalanine </strong>to<strong> tyrosine.</strong> The patient develops clinical features due to elevated levels of<strong> </strong>phenylalanine metabolites and decreased levels of tyrosine. The excess phenylalanine in the blood is metabolized to <strong>phenylpyruvate (positive ferric chloride)</strong>\u00a0and\u00a0<strong>phenylacetate (mousy odour) </strong>which are excreted in the urine. Infants appear normal at birth and gradually develop symptoms of <strong>hyperreflexia</strong>,<strong> seizures</strong>,<strong> hypopigmentation</strong>,<strong> low IQ</strong>,<strong> hyperactivity</strong>, and <strong>tremors.</strong></p>\n<p><strong>Tandem mass spectroscopy</strong> is the investigation of choice. <strong>Guthrie test </strong>is a screening test that shows with absence of growth of <em>Bacillus subtilis</em>. The<strong> ferric chloride</strong> test is positive with the development of a transient blue-green colour.</p>\n<p>Other options -\u00a0</p>\n<p>Option A: <strong>Tyrosine hydroxylase</strong> is the <strong>rate-limiting enzyme </strong>in the synthesis of epinephrine,<strong> </strong>converts<strong> tyrosine </strong>to <strong>DOPA, </strong>its deficiency does not cause phenylketonuria\u00a0</p>\n<p>Option B:\u00a0 <strong>Homogentisic acid oxidase </strong>converts <strong>homogentisic acid </strong>to<strong> maleylacetoacetic acid</strong> in the tyrosine degradation pathway and its deficiency causes <strong>alkaptonuria</strong> with a dark colour of urine on standing, bluish-black pigmentation in connective tissue (ochronosis) and arthritis.</p>\n<p>Option D: <strong>Dopa decarboxylase</strong> is another enzyme involved in the synthesis of epinephrine. It converts <strong>DOPA </strong>to<strong> dopamine</strong> in the presence of <strong>vitamin B6</strong>. While enzymes involved in epinephrine synthesis cause neurological dysfunction, they do not cause phenylketonuria as such.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which micronutrient is most likely deficient in a patient with the radiographic findings given below along with anemia, neutropenia, depigmented hair and skin?",
    "choices": [
      {
        "id": 1,
        "text": "Iron"
      },
      {
        "id": 2,
        "text": "Zinc"
      },
      {
        "id": 3,
        "text": "Copper"
      },
      {
        "id": 4,
        "text": "Fluoride"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>\u00a0</p>\n<p>Early administration of <strong>L-histidine </strong>and<strong> copper chloride</strong> injections may be beneficial.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Iron </strong>deficiency causes <strong>iron deficiency anemia</strong>, and <strong>hair loss</strong> (telogen effluvium. It does not cause neutropenia, depigmentation of hair and skin, or bony abnormalities.</p>\n<p>Option B: <strong>Zinc</strong> deficiency causes <strong>acrodermatitis enteropathica</strong> characterized by periorificial dermatitis, diarrhea, and alopecia.</p>\n<p>Option D: <strong>Fluoride</strong> is essential for bone and teeth mineralization and its deficiency causes decreased bone-mineral density, <strong>osteoporosis,</strong> and tooth decay.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/30549d4b95bd41e29ff34f3527796d9b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3770e97e39894e25b479b174cbb2aaeex630x557.JPEG"
    ]
  },
  {
    "text": "A child presented with recurrent abdominal pain, vomiting, and diarrhea following ingestion of milk-based products. Which enzyme is likely to be deficient?",
    "choices": [
      {
        "id": 1,
        "text": "Lipase"
      },
      {
        "id": 2,
        "text": "Maltase"
      },
      {
        "id": 3,
        "text": "Amylase"
      },
      {
        "id": 4,
        "text": "Lactase"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given scenario indicates intolerance of\u00a0<strong>milk-based</strong> products in this child, hence, the enzyme likely to be deficient is <strong>lactase.</strong></p>\n<p>Lactase is the enzyme that is responsible for breaking down <strong>lactose</strong>, a <strong>disaccharide</strong> found in milk and dairy products. When this enzyme is deficient, it can lead to the accumulation of lactose in the intestinal lumen where it is <strong>fermented by intestinal bacteria</strong> to <strong>lactate</strong> which produces symptoms of lactose intolerance, including recurrent abdominal pain, vomiting, and diarrhea after consuming lactose-rich food items. Lactase and maltase are present in the intestinal brush border.</p>\n<p>Other options:</p>\n<p>Option A- <strong>Lipases</strong> are involved in the hydrolysis of <strong>dietary triglycerides</strong> to free fatty acids and glycerol. It is deficient in <strong>exocrine pancreatic deficiency </strong>states such as chronic pancreatitis, cystic fibrosis, and Crohn's. Although it might also present with abdominal pain and diarrhea, the stools are foul-smelling(due to gut bacteria) and greasy due to the presence of fat (<strong>steatorrhea</strong>) and are also associated with <strong>fat-soluble vitamin deficiency</strong>.</p>\n<p>Option B- <strong>Maltase</strong> breaks down <strong>maltose</strong> which is a disaccharide intermediate of starch breakdown.</p>\n<p>Option C-<strong> Amylase</strong> hydrolyses<strong> starch</strong> which is a glucose homopolymer and is present in germinating cereals, potatoes, legumes, and malt.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In the given Lineweaver-Burk plot, the blue line represents the action of an enzyme, and the red line represents the action of the same enzyme in the presence of an inhibitor.  What is the type of inhibition shown here?",
    "choices": [
      {
        "id": 1,
        "text": "Competitive inhibition"
      },
      {
        "id": 2,
        "text": "Non-competitive inhibition"
      },
      {
        "id": 3,
        "text": "Uncompetitive inhibition"
      },
      {
        "id": 4,
        "text": "Allosteric inhibition"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option C: In<strong>\u00a0uncompetitive inhibition,\u00a0</strong>inhibitors bind with the enzyme-substrate\u00a0<strong>intermediate complex</strong>, and inhibit it. This leads to a decrease in both Vmax and Km. An example is the inhibition of <strong>placental</strong> alkaline phosphate (<strong>ALP</strong>) by <strong>phenylalanine</strong>.\u00a0</p>\n<p>Option D: In <strong>Allosteric inhibition,</strong> inhibitors bind to a site other than the active site i.e. <strong>allosteric site</strong>, and induce a <strong>conformational change</strong> (change in the shape of the active site unlike in non-competitive inhibition) thus, inhibiting the enzyme. <strong>ATP</strong> is an allosteric inhibitor of <strong>Phosphofructokinase</strong> in glycolysis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9dddf28550ee4318a921cb57fb032a01.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ffd327a25fb045959c699d4ffb05e602x1280x2235.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7810bbf695664063b9db9500778f3296x1280x2317.JPEG"
    ]
  }
];
        let quizName = '045 Biochemistry Neet 2024';
        let hierarchy = ["Marrow", "PYQs", "Biochemistry"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>