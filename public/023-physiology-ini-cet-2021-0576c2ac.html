<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>023 Physiology Ini-Cet 2021 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Physiology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">22</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following is not involved in renal auto-regulation?",
    "choices": [
      {
        "id": 1,
        "text": "Tubuloglomerular feedback"
      },
      {
        "id": 2,
        "text": "Myogenic reflex"
      },
      {
        "id": 3,
        "text": "Renin-angiotensin system"
      },
      {
        "id": 4,
        "text": "Renal sympathetic system fibres"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Renal sympathetic system fibres</strong> is not involved in the autoregulation of renal blood flow, because a denervated kidney also maintains the auto regulation of renal blood flow as that of a normal kidney. &nbsp;</p>\n<p>Tubulo glomerular feedback, myogenic reflex, and renin-angiotensin system are all involved in the autoregulation of renal blood flow.&nbsp;</p>\n<p>Tubulo glomerular feedback:</p>\n<ul>\n<li>When the renal artery pressure increases, the renal blood flow and glomerular filtration rate (<strong>GFR</strong>) <strong>increases</strong></li>\n<li>This increased GFR results in increased delivery of solute and water to the early distal tubule, particularly the <strong>macula</strong> <strong>densa</strong></li>\n<li>The macula dense, then secretes a vasoactive substance that constricts afferent arteriole via a paracrine mechanism</li>\n<li>This vasoconstriction then <strong>reduces renal blood flow</strong> and <strong>GFR</strong> back to normal</li>\n</ul>\n<p>Myogenic reflex:</p>\n<ul>\n<li>The increase in renal arterial pressure <strong>stretches</strong> the walls of the afferent arterioles, which then contracts</li>\n<li>This contraction <strong>increases</strong> the afferent arteriolar <strong>resistance</strong></li>\n<li>This increase in resistance then compensates for the increase in blood pressure, thereby keeping the renal blood flow constant.</li>\n</ul>\n<p>Renin-angiotensin system:</p>\n<ul>\n<li><strong>Angiotensin II </strong>is a potent vasoconstrictor of both afferent and efferent arterioles</li>\n<li>However efferent arterioles are more sensitive to angiotensin II than afferent arteriole</li>\n<li>Thus low levels of angiotensin II produce an increase in GFR by constricting efferent arterioles&nbsp;</li>\n<li>High levels of angiotensin II decreases GFR by constricting afferent and efferent arterioles, thereby decreasing the renal blood flow</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The formula for urea clearance is U*V/P, where U is",
    "choices": [
      {
        "id": 1,
        "text": "Urine volume"
      },
      {
        "id": 2,
        "text": "Serum urea in mg /100ml"
      },
      {
        "id": 3,
        "text": "Urine urea in g/24h"
      },
      {
        "id": 4,
        "text": "Urine urea in mg /100ml"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>&lsquo;U&rsquo; in the urea clearance stands for <strong>urine concentration of urea in mg /100ml.&nbsp;</strong></p>\n<p>The formula for renal clearance of a substance is,</p>\n<p>Clearance (C) = U&nbsp;&times; V / P,</p>\n<p>where</p>\n<p>U = Urine concentration of the substance in mg / ml</p>\n<p>V = Urine flow rate in ml/min</p>\n<p>P = Plasma concentration of substance in mg /ml.</p>\n<p><strong>Renal clearance </strong>of a substance is the <strong>volume of plasma</strong> that is completely cleared of the substance by the kidneys per <strong>unit of time</strong>.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The relaxation of the intestinal segment distal to the segment with the bolus of food during peristalsis  is because of",
    "choices": [
      {
        "id": 1,
        "text": "VIP"
      },
      {
        "id": 2,
        "text": "Substance P"
      },
      {
        "id": 3,
        "text": "Dopamine from adrenergic fibres"
      },
      {
        "id": 4,
        "text": "Acetylcholine from myenteric fibres"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The relaxation of the intestinal segment distal to the segment of a bolus of food during peristalsis is due to <strong>Vasoactive Intestinal Peptide </strong>(VIP).&nbsp;</p>\n<p>Peristaltic contractions in the small intestine are designed to propel the food towards the large intestine.</p>\n<p>The food bolus in the small intestine is sensed by enterochromaffin cells of the intestinal mucosa, which release 5-hydroxytryptamine (5-HT)(serotonin). The 5-HT then binds to the receptors on intrinsic primary afferent neurons (IPANs), which when activated, initiate the <strong>peristaltic reflex </strong>in that segment of the small intestine. Behind the bolus, excitatory transmitters like <strong>acetylcholine</strong>, <strong>Substance P</strong>, <strong>neuropeptide Y </strong>are released in the <strong>circular muscle,</strong> while these pathways are inhibited in the longitudinal muscle; thus this segment of small intestine (behind the bolus) <strong>contracts</strong> and <strong>lengthens</strong>.</p>\n<p>(Recall that contraction of circular muscle decreases the diameter of that small intestinal segment whereas contraction of the longitudinal muscle decreases the length of that segment. To prevent the conflict that would occur if circular and longitudinal are contracted at the same time, they are reciprocally innervated)</p>\n<p>In front of the bolus, inhibitory pathways like vasoactive intestinal peptide (VIP) and nitric oxide (NO) are activated in the circular muscle, while excitatory pathways are activated in the longitudinal muscle;thereby relaxing and shortening this segment of small intestine.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presented with severe watery diarrhea resembling that of rice gruel stool.  Damage of which structure is likely to have resulted in this diarrhea?",
    "choices": [
      {
        "id": 1,
        "text": "Zona occludens"
      },
      {
        "id": 2,
        "text": "Gap junction"
      },
      {
        "id": 3,
        "text": "Adherent junction"
      },
      {
        "id": 4,
        "text": "Hemidesmosomes"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p style=\"padding-left: 30px; text-align: left;\">Other options:</p>\n<p style=\"padding-left: 30px; text-align: left;\">B) <strong>Gap junctions:</strong></p>\n<ul>\n<li style=\"padding-left: 30px; text-align: left;\">The gap between the two cells in these types of junctions is about <strong>4nm</strong>.</li>\n<li style=\"padding-left: 30px; text-align: left;\">These junctions are formed by units called <strong>connexons</strong>, which are present in the membrane of each cell.</li>\n<li style=\"padding-left: 30px; text-align: left;\">Each connexon is made up of six protein subunits called <strong>connexins</strong>.&nbsp;</li>\n<li style=\"padding-left: 30px; text-align: left;\">They permit substances to pass between the cells, without entering the ECF.</li>\n<li style=\"padding-left: 30px; text-align: left;\">The pore diameter is around <strong>0.8 to 1.4 &nbsp;nm</strong>, which permits the passage of ions, sugars, amino acids, and other solutes which weigh up to 1000 Da.</li>\n<li style=\"padding-left: 30px; text-align: left;\">They also permit <strong>rapid propagation</strong> of electrical activity from cell to cell, as well as the exchange of various chemical messengers and intracellular signaling molecules.</li>\n</ul>\n<p>C) <strong>Adherent junctions</strong>:</p>\n<ul>\n<li>Adherent junctions or <strong>Zonula adherens</strong> is a continuous structure on the basal side of the zonula occludens.</li>\n<li>It contains <strong>cadherins</strong>.</li>\n</ul>\n<p>D) <strong>Hemidesmosomes</strong>:</p>\n<ul>\n<li>They look like <strong>half-desmosomes.</strong></li>\n<li>They attach cells to the underlying <strong>basal lamina </strong>and are connected intracellularly to intermediate filaments.</li>\n<li>They contain <strong>integrins</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ba621c0af6694374b5b6040adae30523x602x332.PNG"
    ]
  },
  {
    "text": "Beta hCG is structurally similar to which biochemical moiety?",
    "choices": [
      {
        "id": 1,
        "text": "LH"
      },
      {
        "id": 2,
        "text": "FSH"
      },
      {
        "id": 3,
        "text": "ACTH"
      },
      {
        "id": 4,
        "text": "Oxytocin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Beta hCG</strong> (human chorionic gonadotropin) has biological activity similar to that of <strong>luteinizing&nbsp;hormone (LH)</strong>.</p>\n<p><strong>hCG</strong> is a <strong>glycoprotein</strong>&nbsp;produced by <strong>syncytiotrophoblasts</strong>.&nbsp;It is made up of&nbsp;&alpha; and&nbsp;&beta; subunits. Though the&nbsp;<strong>&alpha; subunit</strong> of hCG is similar to the&nbsp;&alpha; subunits of <strong>LH, FSH, </strong>and<strong> TSH,</strong>&nbsp;the&nbsp;&beta; subunit has structural similarity to LH only. Hence, LH is a better answer than FSH.&nbsp;</p>\n<p>hCG is primarily <strong>luteinizing</strong> and <strong>luteotrophic</strong>. It appears to act on the <strong>same receptor</strong> as that of <strong>LH</strong>. The function of hCG is to prevent regression of the&nbsp;<strong>corpus luteum</strong>.&nbsp;It can be <strong>detected in blood</strong> as early as <strong>6</strong> <strong>days</strong> after conception and forms the basis of various tests used to identify pregnancy.</p>\n<p>Its level peaks at <strong>gestational week 9</strong> and then declines gradually but is present in lower concentration till the end of pregnancy. But hCG is <strong>not specific </strong>for pregnancy as it is secreted in a variety of <strong>gastrointestinal</strong>&nbsp;and <strong>genital tumors</strong> in both males and females.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the duration of short term memory?",
    "choices": [
      {
        "id": 1,
        "text": "3-6 Hours"
      },
      {
        "id": 2,
        "text": "12-18 hours"
      },
      {
        "id": 3,
        "text": "30-300 seconds"
      },
      {
        "id": 4,
        "text": "3-4 seconds"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Short-term memory</strong> lasts for<strong> seconds to minutes</strong>, hence of the given 4 options, <strong>30-300&nbsp;seconds </strong>is the most appropriate answer.</p>\n<p>Memory is usually divided into two forms: <strong>Explicit</strong> or declarative memory which is associated with <strong>consciousness</strong> or awareness. <strong>Implicit</strong> or nondeclarative memory does not involve awareness and its retention does not usually involve processing in the hippocampus.&nbsp;</p>\n<p>Explicit and many forms of implicit memory involve</p>\n<ul>\n<li>Short-term memory and</li>\n<li>Long-term memory.</li>\n</ul>\n<p><strong>Short-term memory:</strong></p>\n<p>It lasts <strong>seconds to minutes;</strong> the encoding process for short-term explicit memory involves the <strong>hippocampus</strong>. It lasts only till the person continues to think about the number or facts.</p>\n<p><strong>Working memory </strong>is a form of short-term memory that keeps information available, usually for very short periods of time, until the individual plans action based on it.</p>\n<p><strong>Long-term memory:</strong></p>\n<p>It stores memories that can be recollected after years or even for a lifetime. These memories are stored in various parts of the <strong>neocortex</strong>. The various parts of the memories such as, visual, auditory, olfactory, etc., are localised to the cortical regions concerned with these functions. All these parts of the memories are brought together by long-term changes in the strength of transmission at relevant synaptic junctions so that all the components are brought to consciousness when that particular memory is recalled.</p>\n<p><strong>Neural basis of memory:</strong></p>\n<p>The basis of memory is the <strong>alteration in the strength</strong> of the selected synaptic connections. Second messenger systems contribute to the changes in the neural circuits which are required for learning and memory. Alterations in the cellular membrane channels also contribute to it.&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The stroke volume depends on end-diastolic volume. This is best represented as",
    "choices": [
      {
        "id": 1,
        "text": "Length-force relationship"
      },
      {
        "id": 2,
        "text": "Length- velocity relationship"
      },
      {
        "id": 3,
        "text": "Length-tension relationship"
      },
      {
        "id": 4,
        "text": "Length-viscosity relationship"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The relationship between end-diastolic volume and stroke volume is best represented by <strong>length-tension relationship</strong>.</p>\n<p>This is explained by the &lsquo;<strong>Frank-Starling law of heart</strong>&rsquo; which states that &lsquo; <strong>the volume of blood ejected by the ventricle depends on the volume present in the ventricle at the end of the diastole&rsquo;</strong>. The <strong>length</strong> of the myocytes depend on the <strong>volume</strong> (and hence <strong>tension</strong>) present at the end of the diastole, which in turn, depends on the volume returned to the heart, or the venous return.&nbsp;</p>\n<ul>\n<li>The Frank-Starling law governs the normal ventricular function and ensures that the cardiac output equals venous return, within physiological limits.</li>\n<li>There is a curvilinear relationship between stroke volume or cardiac output and the ventricular end-diastolic volume.&nbsp;</li>\n<li>Agents that increase the contractility of the cardiac muscle have a positive inotropic effect and produce increased stroke volume and thereby increased cardiac output for a given end-diastolic volume. (Eg: Digoxin)</li>\n<li>Agents that decrease the contractility of the cardiac muscle have a negative inotropic effect and produce decreased stroke volume (and cardiac output) for a given end-diastolic volume.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following ions in the thick ascending limb of the loop of Henle is responsible for the resorption of divalent ions?",
    "choices": [
      {
        "id": 1,
        "text": "H+"
      },
      {
        "id": 2,
        "text": "HCO3-"
      },
      {
        "id": 3,
        "text": "K+"
      },
      {
        "id": 4,
        "text": "Na+"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Potassium (K+) in the thick ascending limb of loop of Henle is responsible for the resorption of divalent ions such as, calcium, magnesium, etc.</p>\n<p>This resorption is driven by the <strong>lumen-positive potential difference </strong>across the cells of the thick ascending limb, created by the <strong>potassium leak</strong> into the lumen.</p>\n<p>Mechanism of resorption in thick ascending limb:</p>\n<ul>\n<li>The luminal membrane contains a Na+-K+-2Cl- cotransporter.</li>\n<li>There is net resorption of Na+, K+ and Cl- in the thick ascending limb as follows:</li>\n<li>All three ions are transported into the cell on the cotransporter.</li>\n<li>Na+ is extruded from the cell by the Na+-K+ ATPase in the basolateral membrane.</li>\n<li>K+ and Cl- diffuse through channels in the basolateral membrane, down their respective electrochemical gradients.</li>\n<li>Most of the K+ leaves the cell across the basolateral membrane; the remaining portion of K+ however diffuses back into the lumen.&nbsp;</li>\n<li>This K+ leak into the lumen generates a positive electrochemical potential difference in the lumen.</li>\n<li>This lumen-positive potential difference drives the resorption of ions such as sodium(Na+), magnesium (Mg2+), calcium (Ca+),etc.,</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following sensory receptors are responsible for tactile discrimination?",
    "choices": [
      {
        "id": 1,
        "text": "Merkel disc"
      },
      {
        "id": 2,
        "text": "Ruffini end organ"
      },
      {
        "id": 3,
        "text": "Pacinian corpuscle"
      },
      {
        "id": 4,
        "text": "Meissner\u2019s corpuscle"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Meissner\u2019s Corpuscles</strong> are responsible for <strong>discriminative touch.</strong></p>\n<p>Meissner\u2019s corpuscles are <strong>encapsulated receptors </strong>found in the dermis of the non-hairy skin, most commonly on the fingertips, lips, and other locations where <strong>tactile discrimination is very good</strong>. Their field of reception is very small and hence used for two-point discrimination. These are rapidly adapting receptors that encode</p>\n<ul>\n<li><strong>Point discrimination</strong></li>\n<li><strong>Precise location</strong></li>\n<li><strong>Tapping\u00a0</strong></li>\n<li><strong>Flutter</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following increases gastric acid secretion except:",
    "choices": [
      {
        "id": 1,
        "text": "Gastrin"
      },
      {
        "id": 2,
        "text": "Histamine"
      },
      {
        "id": 3,
        "text": "Acetylcholine"
      },
      {
        "id": 4,
        "text": "Serotonin"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>All of the above increase gastric acid secretion except serotonin.</p>\n<p><strong>Serotonin</strong> is localized in the <strong>enterochromaffin cells</strong> of the gastrointestinal (GI) mucosa and within neurons of the GI tract. Serotonin<strong> inhibits</strong> gastric <strong>acid</strong> secretion. It <strong>stimulates</strong> the production and release of gastric and colonic <strong>mucus</strong>. Serotonin acts as an enteric neurotransmitter and increases intestinal motility.</p>\n<p>The main factors that <strong>stimulate</strong> gastric secretion are <strong>acetylcholine, gastrin, and histamine.&nbsp;</strong>Parasympathetic stimulation releases Ach which stimulates the secretion of</p>\n<ul>\n<li>pepsinogen by peptic cells</li>\n<li>hydrochloric acid by parietal cells</li>\n<li>mucus by mucous cells.</li>\n</ul>\n<p>Both gastrin and histamine strongly stimulate <strong>acid secretion</strong> by <strong>parietal cells</strong>&nbsp;but have little effect on other cells.</p>\n<div class=\"page\" title=\"Page 768\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The stomach mucosa has two important types of tubular glands:</p>\n<ul>\n<li>The oxyntic (gastric) glands secrete hydrochloric acid, pepsinogen, intrinsic factor, and mucus.</li>\n<li>The pyloric glands secrete mainly mucus for protection of the pyloric mucosa from the stomach acid. They also secrete the hormone gastrin.</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<p>Note- <strong>Serotonin</strong> released from the small intestine triggers vomiting by stimulation of <strong>5HT<sub>3</sub> receptors</strong>. Therefore,&nbsp;5HT<sub>3</sub> antagonists like <strong>ondansetron</strong> are used as antiemetics.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Pacinian corpuscle is stimulated by which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Pain"
      },
      {
        "id": 2,
        "text": "Temperature"
      },
      {
        "id": 3,
        "text": "Touch"
      },
      {
        "id": 4,
        "text": "Pressure"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>&nbsp;</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Merkel discs</strong>&nbsp;are seen in the <strong>epidermis</strong> of glabrous skin. They are <strong>slowly adapting</strong> receptors and have very small receptive fields. These receptors detect <strong>vertical indentations of the skin. </strong>They are&nbsp;expanded dendritic endings.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Ruffini corpuscles</strong> are capsulated, enlarged, dendritic endings. They are located in the <strong>dermis</strong> of glabrous and hairy skin, and in joint capsules. They are <strong>slowly adapting</strong> receptors. Ruffini corpuscles detect <strong>stretch</strong> and joint rotation.</li>\n</ul>\n<div class=\"page\" title=\"Page 169\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Pain and temperature</strong> sensations arise from receptors located on unmyelinated sensory neurons present throughout the glabrous skin, hairy skin, and deep tissue. Impulses from nociceptors are transmitted via thinly myelinated A&delta; fibers and unmyelinated C fibers.</p>\n<p>Activation of<strong> A&delta; fibers</strong> is responsible for <strong>first pain</strong> (also called <strong>fast pain</strong>). It is a rapid response and helps in the discrimination of pain or the ability to localize the site and intensity of the noxious stimulus. It is mediated by the release of glutamate. An example is pinprick.</p>\n<p>Activation of <strong>C fibers</strong> is responsible for delayed <strong>second pain</strong>(also called <strong>slow pain</strong>). It is a dull, intense, diffuse, and unpleasant feeling associated with a noxious stimulus. . Second pain is mediated by the release of a combination of glutamate and substance P. Example is visceral pain.</p>\n<p>Types of nociceptors :</p>\n<ul>\n<li>Mechanical nociceptors respond to strong pressure (eg, from a sharp object).&nbsp;</li>\n<li>Thermal nociceptors are activated by skin temperatures above 45&deg;C or by severe cold (&lt;20&deg;C).</li>\n<li>Chemically sensitive nociceptors respond to chemicals such as bradykinin, histamine, high acidity, and environmental irritants.</li>\n<li>Polymodal nociceptors respond to combinations of these stimuli.</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bf37a2b85db640bc9fa30429918aa2cax1280x957.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ab409c8a0dc1478cb5ddaee3e9e14a09x1280x960.JPEG"
    ]
  },
  {
    "text": "Which of the following jugular venous pressure (JVP) waves corresponds to the isovolumetric contraction phase of the cardiac cycle?",
    "choices": [
      {
        "id": 1,
        "text": "a wave"
      },
      {
        "id": 2,
        "text": "c wave"
      },
      {
        "id": 3,
        "text": "x descent"
      },
      {
        "id": 4,
        "text": "y descent"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The waveforms seen in a normal JVP are:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>a wave</strong> corresponds to <strong>atrial contraction</strong> and occurs just after the P wave (on ECG) and just before the first heart sound.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>c wave</strong> represents the <strong>bulging</strong> of the <strong>tricuspid valve</strong> into the right atrium during ventricular systole.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>x descent</strong> corresponds to the <strong>atrial relaxation</strong> during atrial diastole.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>v wave</strong> represents<strong> atrial filling</strong> during ventricular systole and peaks at the second heart sound.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>y descent</strong> represents <strong>passive emptying</strong> of the right atrium into the right ventricle after tricuspid valve opening.</li>\n</ul>\n<p>&nbsp;The Wiggers diagram given below correlates JVP with other aspects of cardiac cycle.&nbsp;<br /><br /></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4a0084f6c7294620bb3e17085244aa99x1280x1063.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/049c50df2f8c440ca9083c6a693ae11dx1280x1280.JPEG"
    ]
  },
  {
    "text": "The extracellular concentration of chloride is 100mmol/L and the intracellular concentration is 10 mmol/L. What is the equilibrium potential of chloride?",
    "choices": [
      {
        "id": 1,
        "text": "+ 10 mV"
      },
      {
        "id": 2,
        "text": "- 10 mV"
      },
      {
        "id": 3,
        "text": "- 60 mV"
      },
      {
        "id": 4,
        "text": "+ 60 mV"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The equilibrium potential of chloride in the given question is <strong>-60 mV.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "After reaching an equilibrium state during exercising, it was found that the body was consuming oxygen\u00a0at the rate of 1500 ml/min. Calculate the MET score if the baseline oxygen consumption at rest is 250 ml/min.",
    "choices": [
      {
        "id": 1,
        "text": "5"
      },
      {
        "id": 2,
        "text": "6"
      },
      {
        "id": 3,
        "text": "1/5"
      },
      {
        "id": 4,
        "text": "1/6"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>MET score</strong> in the given scenario is <strong>6.</strong></p>\n<p><strong>One</strong> <strong>metabolic equivalent</strong> (MET) is defined as the amount of <strong>oxygen consumed</strong> while sitting at <strong>rest.</strong></p>\n<p>Normally, one MET= 3.5 ml O<sub>2</sub> /kg body weight/min</p>\n<p>In the above question, the baseline O<sub>2&nbsp;</sub>consumption at rest is given as 250 ml/min. According to the definition of one MET, we can deduce that the given 250ml/min is one MET.</p>\n<p>O<sub>2&nbsp;</sub>consumption at reaching equilibrium during exercise= 1500ml/min</p>\n<p>MET score= O<sub>2&nbsp;</sub>consumption during exercise/ one MET</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 1500/250</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>= 6</strong></p>\n<p>The MET concept represents a simple, practical, and easily understandable procedure for expressing the <strong>energy cost</strong> of <strong>physical activities</strong> as a multiple of the resting metabolic rate. If the MET score is low, it means that the activity requires less oxygen compared to an activity that has a higher MET score. Eg. Gardening requires around 3-7 METS compared to that jogging that may need around 9-11 METS. We can classify activities as light, moderate or heavy, depending on MET scores. It can also be used to identify the functional capacity of a patient.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following cause a right shift of the oxygen-hemoglobin dissociation curve, except ___.",
    "choices": [
      {
        "id": 1,
        "text": "Increased HbF"
      },
      {
        "id": 2,
        "text": "Raised 2,3 BPG"
      },
      {
        "id": 3,
        "text": "Acidosis"
      },
      {
        "id": 4,
        "text": "Increased CO2"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Causes of the <strong>right shift</strong> of the&nbsp;oxygen-hemoglobin dissociation curve:</p>\n<ul>\n<li dir=\"ltr\" role=\"presentation\">Hypoxia and Hypercarbia - metabolically active tissues utilize O<sub>2</sub> and tissues produce CO<sub>2</sub></li>\n<li dir=\"ltr\" role=\"presentation\">&darr; pH - Secondary to increased CO<sub>2</sub> production</li>\n<li dir=\"ltr\" role=\"presentation\">&uarr; in temperature</li>\n<li dir=\"ltr\" role=\"presentation\">&uarr; in 2,3-DPG - increased anaerobic glycolysis</li>\n<li dir=\"ltr\" role=\"presentation\">Growth hormone, thyroid hormone, androgen - by increasing 2,3 DPG</li>\n<li dir=\"ltr\" role=\"presentation\">Sickle cell anemia - reduced affinity for O<sub>2</sub></li>\n<li dir=\"ltr\" role=\"presentation\">Exercise</li>\n</ul>\n<p dir=\"ltr\">Causes of the <strong>left shift</strong> of&nbsp;oxygen-hemoglobin dissociation curve:</p>\n<ul>\n<li dir=\"ltr\" role=\"presentation\">&uarr; pH (alkalosis)</li>\n<li dir=\"ltr\" role=\"presentation\">&darr; PCO<sub>2</sub></li>\n<li dir=\"ltr\" role=\"presentation\">&darr; 2,3-DPG</li>\n<li dir=\"ltr\" role=\"presentation\">&darr; Temperature&nbsp;</li>\n<li dir=\"ltr\" role=\"presentation\">HbF</li>\n<li dir=\"ltr\" role=\"presentation\">Carboxyhemoglobin</li>\n</ul>\n<p>Bohr's effect- The decrease in the O<sub>2</sub>&nbsp;affinity of hemoglobin when the pH of the blood falls</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e0af2591c1b248b28d22ee452a48616bx600x647.JPEG"
    ]
  },
  {
    "text": "The latent period, contraction period, and relaxation period of a skeletal muscle are 10 ms, 40 ms, and 50 ms respectively. Calculate the tetanizing frequency.",
    "choices": [
      {
        "id": 1,
        "text": "100 per second"
      },
      {
        "id": 2,
        "text": "50 per second"
      },
      {
        "id": 3,
        "text": "20 per second"
      },
      {
        "id": 4,
        "text": "25 per second"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>When there is a repeated stimulus to a muscle fiber before relaxation, it produces an additional contraction of the muscle. The second contraction adds to the first contraction and the total strength of contraction increases. This phenomenon is known as a&nbsp;<strong>summation of contractions.&nbsp;</strong></p>\n<p>With repeated stimulation, contraction occurs repeatedly before any relaxation has occurred. This causes the individual responses to fuse into one continuous contraction. Such a response is called <strong>tetanus</strong> (tetanic contraction). \u200b\u200b\u200b</p>\n<p>Tetanizing frequency is the minimum frequency required for producing tetanus.</p>\n<p>Tetanus is of two types.</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Complete tetanus</strong>- when no relaxation occurs between stimuli&nbsp;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Incomplete tetanus- </strong>when periods of incomplete relaxation occur between the summated stimuli.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/485e515d560c447a94c783f7362878e5x1280x3196.JPEG"
    ]
  },
  {
    "text": "An individual is in an environment of a temperature of 47\u00b0C. What is the mechanism of heat loss?",
    "choices": [
      {
        "id": 1,
        "text": "Radiation"
      },
      {
        "id": 2,
        "text": "Conduction"
      },
      {
        "id": 3,
        "text": "Convection"
      },
      {
        "id": 4,
        "text": "Sweating"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The mechanism of <strong>heat loss</strong> in the given case where the <strong>surrounding</strong> temperatures are <strong>higher</strong> than the <strong>body</strong> temperature is <strong>sweating.</strong></p>\n<p>Different methods of heat loss:</p>\n<ul>\n<li>Radiation is heat loss in the form of infrared rays.</li>\n<li>Conduction is heat loss that occurs by direct contact with an object.</li>\n<li>Convection is heat loss resulting from air movement.</li>\n</ul>\n<div class=\"page\" title=\"Page 856\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>When the <strong>temperature of the surroundings</strong> is <strong>more</strong> than that of the skin, the body <strong>gains heat</strong> by both <strong>radiation</strong> and conduction. Under these conditions,&nbsp;the heat can be<strong> lost</strong> from the body only by&nbsp;<strong>evaporation</strong>&nbsp;or&nbsp;<strong>sweating.</strong></p>\n<p>When the <strong>body temperature</strong> is <strong>greater</strong> than the temperature of the surroundings, heat can be lost by <strong>radiation</strong> and conduction.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following has the highest airway resistance?",
    "choices": [
      {
        "id": 1,
        "text": "Alveolar duct"
      },
      {
        "id": 2,
        "text": "Bronchi"
      },
      {
        "id": 3,
        "text": "Respiratory bronchioles"
      },
      {
        "id": 4,
        "text": "Small bronchioles"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given options,<strong> bronchi</strong><strong>&nbsp;(medium-sized airway) </strong>offer<strong> maximum resistance.</strong></p>\n<p>The best answer here is bronchi, as all the other options suggest smaller airways, while bronchi are the only medium-sized airway.</p>\n<p>Airflow can be derived from&nbsp;<strong>Poiseuille-Hagen formula:</strong>&nbsp;</p>\n<p>Q =&pi;&nbsp;&Delta;P<strong>r<sup>4</sup></strong>/8&eta;L</p>\n<p>Where</p>\n<ul>\n<li>Q is the flow rate</li>\n<li>&pi; is pie symbol</li>\n<li>&Delta;P is the pressure difference</li>\n<li>r is radius</li>\n<li>&eta; is viscosity</li>\n<li>L is length</li>\n</ul>\n<p>Also,</p>\n<p>Flow rate (Q) = pressure difference (&Delta;P)/ resistance (R).</p>\n<p>Therefore, substituting this in Poiseuille- Hagen formula,</p>\n<p>&Delta;P/ R =&nbsp;&pi;&nbsp;&Delta;P<strong>r<sup>4</sup></strong>/8&eta;l</p>\n<p>1/R =&nbsp;&pi;&nbsp;<strong>r<sup>4</sup></strong>/8&eta;l</p>\n<p><strong>R</strong> =&nbsp;8&eta;l/&nbsp;&pi;&nbsp;<strong>r<sup>4</sup></strong></p>\n<p>Therefore it can be derived that&nbsp;<strong>airway resistance</strong> is <strong>inversely proportional</strong> to the <strong>radius</strong> by the&nbsp;<strong>power of four</strong>.</p>\n<p>With&nbsp;Poiseuille- Hagen formula we might feel that the smallest airways are the major site of resistance. However, the contribution by the smallest airways is very little to the overall total resistance. This is because, the airway branches in each generation exist in <strong>parallel</strong> rather than in series. As the parallel branching increases, the resistance decreases. (<strong>Total</strong> cross-sectional diameter of small airways put together is high). Thus the overall resistance of the small airways is very small. Also,&nbsp;airflow velocity decreases substantially as the effective cross-sectional area increases (i.e., the flow becomes laminar).</p>\n<p>Other factors affecting airway resistance :</p>\n<ul>\n<li><strong>Lung volume</strong>, as lung volume increases the resistance decreases and vice versa. Lung volume increases the transairway pressure thus increasing the caliber of the airway.</li>\n<li><strong>Airway mucus, edema</strong>, and <strong>contraction</strong> of bronchial smooth muscle increase the airway resistance. Its clinical application is seen in asthma, bronchitis, and emphysema</li>\n<li>The <strong>density </strong>and <strong>viscosity</strong> of inspired gas also contribute to airway resistance. A gas with more density imparts more resistance.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "If the contractility of the heart is decreased, which of the following is seen",
    "choices": [
      {
        "id": 1,
        "text": "End diastolic volume and pressure curve shifts to left without change in slope"
      },
      {
        "id": 2,
        "text": "Slope changes in ESV pressure curve"
      },
      {
        "id": 3,
        "text": "End systolic volume and pressure curve shifts to left without change in slope"
      },
      {
        "id": 4,
        "text": "Slope changes in EDV and pressure curve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Other options:</p>\n<p>Options A and D- End diastolic volume and pressure curve (<strong>EDPVR</strong>) mainly assesses the <strong>compliance</strong> of the ventricle, rather than contractility. The slope of this curve increases when the compliance decreases, and vice versa.</p>\n<p>Option C- ESPVR shifts to right with change in slope.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9499b8e6649542cb88781f17312c95a4x1280x1596.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/76202439afbd4b4f88576c49193b05c2x1280x1316.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e8152288950741fcb3748d8010af752dx1280x1259.JPEG"
    ]
  },
  {
    "text": "A lesion in which lobe will lead to impairment of hand-eye coordination?",
    "choices": [
      {
        "id": 1,
        "text": "Parietal lobe"
      },
      {
        "id": 2,
        "text": "Frontal lobe"
      },
      {
        "id": 3,
        "text": "Temporal lobe"
      },
      {
        "id": 4,
        "text": "Occipital lobe"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A lesion in the <strong>parietal lobe</strong> will lead to&nbsp;<strong>impairment of hand-eye coordination</strong>.</p>\n<p>The somatic sensory area and related parts of the <strong>posterior parietal lobe</strong> project to the premotor cortex. Some of these neurons are concerned with aiming and manipulating the hands at an object, whereas other neurons are concerned with <strong>hand-eye coordination</strong>. Neurons in this posterior parietal cortex contribute to the descending pathways involved in motor control.</p>\n<p>There are two parietal lobes, the dominant side, and the non-dominant side.</p>\n<ul>\n<li>The functions of the <strong>dominant side</strong> of the <strong>parietal lobe</strong> are calculation, language, planned movement, appreciation of size, shape, weight, and texture. A lesion here causes dyscalculia, dysphasia, dyslexia, apraxia, agnosia, homonymous hemianopia.</li>\n<li>The function of the non-dominant side is <strong>spatial orientation</strong>&nbsp;and constructional skills. Its lesion causes spatial disorientation, constructional apraxia, neglect of the non-dominant side, dressing apraxia, and homonymous hemianopia.&nbsp;</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: The <strong>frontal lobe</strong> is responsible for <strong>personality, </strong>emotional response, <strong>social behavior.</strong> Any lesion in the frontal lobe causes disinhibition, antisocial behavior, impaired memory, incontinence, anosmia.</p>\n<p>Option C: The <strong>temporal lobe</strong> has two lobes and is divided as dominant and non-dominant.</p>\n<ul>\n<li>The <strong>dominant temporal lobe</strong> has important functions like auditory perception, speech, language, verbal memory, smell. Lesions lead to dysphasia, dyslexia, poor memory, complex hallucinations (smell, sound, vision), impaired face recognition (Prosopagnosia) and homonymous hemianopia.</li>\n<li>The <strong>nondominant temporal lobe</strong> auditory perception, music, tone sequences, non-verbal memory (faces, shapes, music). Lesions here leads to poor non-verbal memory, loss of musical skills, complex hallucinations, and homonymous hemianopia.</li>\n</ul>\n<p>Option D: The <strong>occipital lobe</strong> is responsible for the analysis of vision. A lesion in occipital lobe mainly affects vision leading to homonymous hemianopia, visual agnosia, impaired face recognition (prosopagnosia), visual hallucinations (lights, lines and zigzags).</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following ions have decreased concentration on the luminal side of proximal convoluted tubule except :",
    "choices": [
      {
        "id": 1,
        "text": "Amino acids"
      },
      {
        "id": 2,
        "text": "Glucose"
      },
      {
        "id": 3,
        "text": "Chloride"
      },
      {
        "id": 4,
        "text": "Bicarbonate"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The concentration of <strong>chloride</strong> on the <strong>luminal side</strong> is <strong>more</strong> when compared to sodium, glucose, and amino acids.</p>\n<p>In the first half of the proximal tubule, sodium is reabsorbed by co-transport along with glucose, amino acids, and other solutes. As <strong>sodium</strong> is <strong>reabsorbed</strong> in the proximal tubule, it preferentially carries <strong>glucose, amino acids,</strong>&nbsp;<strong><strong>bicarbonate </strong></strong>along with it.&nbsp;Thus, their concentrations decrease markedly along the length of the proximal tubule, and a solution having a <strong>higher concentration of chloride&nbsp;</strong>is left behind. The concentration of chloride here is around 105 mEq/L.</p>\n<p>In the second half of the proximal tubule, sodium gets re-absorbed along with chloride since there is only a little glucose and amino acids yet to be re-absorbed. The second half of the proximal tubule has a concentration of chloride &asymp;140 mEq/L. This higher chloride concentration favors its own diffusion from the lumen into the renal interstitial fluid.&nbsp;</p>\n<p>Although the amount of sodium in the tubular fluid decreases markedly along the proximal tubule, the concentration of sodium and the total osmolarity remain relatively constant. This is because the proximal tubule is highly permeable to water and water reabsorption increases to keep pace with the sodium reabsorption.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bdd09f2731ac4d1a80d199124865c9a0x1280x1725.JPEG"
    ]
  },
  {
    "text": "Sodium iodide symporter is present in all of the following except:",
    "choices": [
      {
        "id": 1,
        "text": "Thyroid gland"
      },
      {
        "id": 2,
        "text": "Placenta"
      },
      {
        "id": 3,
        "text": "Salivary gland"
      },
      {
        "id": 4,
        "text": "Pituitary gland"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Sodium iodide symporter is present in all of the options given above except the pituitary gland.&nbsp;</p>\n<p><strong>Sodium iodide symporter</strong> is expressed mainly in the thyroid gland and is responsible for iodine uptake in the follicular cells of the thyroid gland.</p>\n<p>Sodium iodide symporter (NIS)</p>\n<p>The <strong>NIS</strong> is mainly present in the <strong>basolateral membranes</strong> of the thyrocytes. The NIS transports two Na<sup>+</sup> ions and one I<sup>-</sup> ion into the cell against the concentration gradient. The energy for this transport is derived from the Na<sup>+</sup>-K<sup>+</sup> ATPase pump. Na<sup>+</sup>-K<sup>+</sup> ATPase pumps sodium outside the cell and causes low intracellular sodium concentration. This causes sodium to enter the cell by facilitated diffusion. Along with sodium, iodide ions also enter the cell. Since the energy to transport sodium and iodide ions in NIS is derived from Na<sup>+</sup>-K<sup>+</sup> ATPase pump, this is called <strong>secondary active transport.</strong></p>\n<p>The <strong>NIS</strong> is also expressed in:</p>\n<ul>\n<li>Salivary glands&nbsp;</li>\n<li>Gastric mucosa&nbsp;</li>\n<li>Placenta</li>\n<li>Ciliary body of the eye&nbsp;</li>\n<li>Choroid plexus</li>\n<li>Mammary glands&nbsp;</li>\n<li>Certain cancers are derived from these tissues.</li>\n</ul>\n<p>The significance of these extrathyroidal NIS is not known.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '023 Physiology Ini-Cet 2021';
        let hierarchy = ["Marrow", "PYQs", "Physiology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>