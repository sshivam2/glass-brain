<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 006 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Personal monitoring of radiation is done by:",
    "choices": [
      {
        "id": 1,
        "text": "TLD badge"
      },
      {
        "id": 2,
        "text": "Collimators"
      },
      {
        "id": 3,
        "text": "Linear accelerator"
      },
      {
        "id": 4,
        "text": "Grid"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Personal monitoring of radiation is done by<strong>&nbsp;</strong>a<strong> TLD badge.</strong></p>\n<p><strong>TLD badge</strong> (thermoluminescent dosimeter) is made up of <strong>Li</strong><strong>thium fluoride</strong> or calcium sulfate doped with<strong> </strong>dysprosium.</p>\n<p>The badge should be positioned&nbsp;according to local or national practices. In India, one TLD badge has to be worn at the <strong>chest level inside</strong> the lead <strong>apron,</strong> if the apron is used. An additional <strong>wrist badge</strong> has to be worn for procedures requiring hands close to the primary beam.&nbsp;</p>\n<p>The given image shows a TLD badge.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/218f24956fbb4fae98055edf74168223x240x73.JPEG"
    ]
  },
  {
    "text": "Identify the grip in the image given below:",
    "choices": [
      {
        "id": 1,
        "text": "Second Pelvic grip"
      },
      {
        "id": 2,
        "text": "Abdominal grip"
      },
      {
        "id": 3,
        "text": "Pawlik grip"
      },
      {
        "id": 4,
        "text": "Fundal grip"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The<strong> Leopold's third maneuver is also called the Pawlik&rsquo;s grip</strong>. It is performed by grasping with the thumb and fingers, the lower portion of the maternal abdomen just above the symphysis pubis. If the presenting part is not engaged, a movable mass will be felt.</p>\n<p>Obstetric grips (Leopold maneuvers)</p>\n<ol style=\"list-style-type: lower-alpha;\">\n<li>Fundal grip (1<sup>st</sup> Leopold)</li>\n<li>Lateral/umbilical grip (2<sup>nd</sup> Leopold)</li>\n<li>1st pelvic grip /Pawlik grip (3<sup>rd</sup> Leopold)</li>\n<li>2nd pelvic grip (4<sup>th</sup> Leopold)</li>\n</ol>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/653b2e899d244a10819f08cde91b6359.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f9fb7ccf210e46fbb43ca3a191bfeff4x600x3241.JPEG"
    ]
  },
  {
    "text": "The following catheter is used for?",
    "choices": [
      {
        "id": 1,
        "text": "Gastro-Esophageal varices"
      },
      {
        "id": 2,
        "text": "Embolectomy"
      },
      {
        "id": 3,
        "text": "Pulmonary artery catheterization"
      },
      {
        "id": 4,
        "text": "Urinary catheterization"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shown above is the<strong> Swan-ganz catheter</strong> used for<strong> pulmonary artery catheterization</strong>. It is also called the pulmonary artery catheter. The standard pulmonary artery catheter is 110 cm long with a 7.0 \u2013 9.0 Fr circumference.\u00a0</p>\n<p><strong>Uses:</strong></p>\n<ul>\n<li>Measurement of pressures in right atrium, right ventricle and pulmonary artery</li>\n<li>Indirect measurement of left atrial pressure through pulmonary capillary wedge pressure</li>\n<li>Cardiac output</li>\n<li>Oxygen saturation- pulmonary samples to rule out left-right shunt</li>\n<li>Monitoring left ventricle filling pressure</li>\n<li>Differentiate cardiogenic from non cardiogenic pulmonary edema</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0866408f236145898d41c2cab4bfb072.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What type of skull fracture is shown in the given image:",
    "choices": [
      {
        "id": 1,
        "text": "Diastatic fracture"
      },
      {
        "id": 2,
        "text": "Pond fracture"
      },
      {
        "id": 3,
        "text": "Gutter fracture"
      },
      {
        "id": 4,
        "text": "Depressed fracture"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows a&nbsp;<strong>gutter fracture</strong> of the skull.</p>\n<p class=\"p1\">It is a <strong>furrow in the outer table of the skull</strong>, ordinarily the result of a <strong>glancing blow by a missile from a rifled firearm</strong>. These are frequently accompanied with comminuted depressed fractures of inner table of the skull.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/64cf45c49b6f406ab8d79cd6fd9990b6.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs can be used in the first trimester of pregnancy?",
    "choices": [
      {
        "id": 1,
        "text": "ACE inhibitors"
      },
      {
        "id": 2,
        "text": "Angiotensin receptor blockers"
      },
      {
        "id": 3,
        "text": "Propylthiouracil"
      },
      {
        "id": 4,
        "text": "Statins"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Propylthiouracil</strong>&nbsp;can be used in the <strong>first trimester</strong> of pregnancy. It is indicated in the management of<strong> hyperthyroidism.</strong></p>\n<p>Other options</p>\n<p><strong>ACE</strong> inhibitors and Angiotensin receptor blockers are fetopathic and can cause <strong>fetal growth retardation</strong> and hypoplasia of organs.&nbsp;</p>\n<div class=\"page\" title=\"Page 544\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Statins</strong> can cause Vertebral, anal, cardiac, tracheoesophageal fistula, renal, arterial, limb (<strong>VACTERAL</strong>) defects</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following conditions is normal peristalsis not seen?",
    "choices": [
      {
        "id": 1,
        "text": "Achalasia cardia"
      },
      {
        "id": 2,
        "text": "Esophageal carcinoma"
      },
      {
        "id": 3,
        "text": "Nutcracker esophagus"
      },
      {
        "id": 4,
        "text": "Hypertensive lower esophageal sphincter"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Achalasia cardia <strong>does not show&nbsp;</strong>normal peristalsis.</p>\n<p>Manometric features of achalasia cardia are as follows:</p>\n<ul>\n<li>Incomplete lower esophageal sphincter relaxation</li>\n<li><strong>Aperistalsis </strong>of the esophageal body</li>\n<li><strong>Elevated LES pressure</strong></li>\n</ul>\n<p><strong>Diffuse esophageal spasm</strong> is characterized by simultaneous <strong>multi-peaked contractions of the esophagus.</strong> The contractions are spontaneous and may be of abnormally high amplitude (&gt;120 mmHg) or long duration. <strong>Intermittent normal peristalsis is seen.</strong></p>\n<p><strong>Nutcracker esophagus</strong> is characterized by<strong> high amplitude (&ge;180 mmHg) contractions</strong> with an increased mean duration. The peristaltic sequence is normal.</p>\n<p><strong>Hypertensive lower esophageal sphincter</strong> is characterized by <strong>elevated LES pressure (&ge;26 mmHg).</strong> Normal peristalsis is seen in the body of the esophagus.</p>\n<p><strong>Esophageal carcinoma</strong> will not have any issues with the motility or peristalsis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 14-year-old boy presents with acute onset of pain in his scrotum. He previously had similar pain that would subside spontaneously but the pain this time is unbearable.  Physical examination shows a swollen erythematous scrotum. Cremasteric reflex is absent. What is the next best step in management?",
    "choices": [
      {
        "id": 1,
        "text": "Manual detorsion"
      },
      {
        "id": 2,
        "text": "Doppler ultrasound"
      },
      {
        "id": 3,
        "text": "Surgical exploration"
      },
      {
        "id": 4,
        "text": "Observation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-preserver-spaces=\"true\">The given clinical vignette is suggestive of&nbsp;</span><strong><span data-preserver-spaces=\"true\">testicular torsion</span></strong><span data-preserver-spaces=\"true\">. In cases of <strong>high clinical suspicion</strong>, the next best step is to&nbsp;</span><strong><span data-preserver-spaces=\"true\">explore surgically</span></strong><span data-preserver-spaces=\"true\">.</span></p>\n<p><span data-preserver-spaces=\"true\">Clinical features of testicular torsion are <strong>painful</strong> <strong>scrotal swelling</strong>, erythema, nausea, and vomiting. Testis seems high in the scrotum and the twisted cord can sometimes be palpated.</span></p>\n<p><span data-preserver-spaces=\"true\">Signs seen on torsion of the testis are:</span></p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Deming&rsquo;s sign</strong>: Spasm of the cremaster muscle due to twisting of the spermatic cord causes the affected testis to be positioned higher than the normal testis.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Angell&rsquo;s sign</strong>: The testis on the normal side lies horizontally because of the mesorchium between the testis and epididymis.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Cremastic reflex</strong>: Absent on the side of the affected testis</li>\n</ul>\n<p><strong><span data-preserver-spaces=\"true\">Doppler ultrasound</span></strong><span data-preserver-spaces=\"true\">&nbsp;scanning can confirm the absence of the blood supply to the affected testis, but the false positives are high and hence it is not routinely recommended.&nbsp;The typical window of opportunity for surgical intervention and testicular <strong>salvage</strong> is <strong>6 hours</strong> from <strong>onset</strong> <strong>of</strong> <strong>pain.</strong></span></p>\n<p><span data-preserver-spaces=\"true\">Testicular torsion is a <strong>clinical diagnosis</strong> and an <strong>emergency</strong>, therefore no time is wasted in performing the other investigations.&nbsp;</span></p>\n<div class=\"page\" title=\"Page 1583\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>&nbsp;</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30 -year-old male  with a history of taking medications for rheumatoid arthritis, now presents with obesity, short stature, round face, and his abdominal findings was as in the picture below. On examination, pulse rate is 96/minute, blood pressure is 150/90 mm Hg. The most likely diagnosis is ?",
    "choices": [
      {
        "id": 1,
        "text": "Cushing's syndrome"
      },
      {
        "id": 2,
        "text": "Adrenocorticoid tumor"
      },
      {
        "id": 3,
        "text": "SLE"
      },
      {
        "id": 4,
        "text": "Psoriasis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The probable cause in this case is&nbsp;<strong>Cushing's syndrome.</strong></p>\n<p>History of <strong>Rheumatoid arthritis</strong>&nbsp;suggests that patient had been on exogenous steroids for long term management of rheumatoid arthritis.</p>\n<p>The presenting features with a <strong>round face (moon facies), short stature, along with obesity </strong>and<strong> purple skin striae</strong> suggest a diagnosis of <strong>Cushing's syndrome</strong> and the <strong>most common cause </strong>of Cushing's syndrome is prolonged<strong> exogenous administration of glucocorticoids.&nbsp;</strong></p>\n<p><strong>Cushing's syndrome </strong>is characterized by clinical features that result from chronic exposure of excess glucocorticoids that can be due to</p>\n<ul style=\"list-style-type: disc;\">\n<li class=\"p1\">Prolonged exogenous administration of glucocorticoids<strong> (Iatrogenic: Most common cause of Cushing's syndrome)&nbsp;</strong></li>\n<li class=\"p1\">Excess endogenous cortisol secretion:\n<ul style=\"list-style-type: circle;\">\n<li class=\"p1\">In children &lt;7 years: Most often by a functioning adrenocortical tumor</li>\n<li class=\"p1\">In children &gt;7 years: Most often by an adrenocorticotropic hormone (ACTH)&ndash;producing pituitary adenoma <strong>(Cushing's disease)</strong></li>\n</ul>\n</li>\n</ul>\n<p><strong>Important clinical features&nbsp;</strong></p>\n<ul>\n<li><strong>Obesity</strong> or weight gain (<strong>most common</strong>)</li>\n<li><strong>Moon facies </strong></li>\n<li>Purple <strong>skin striae</strong></li>\n<li>Abnormal masculinization (acne, bruising, enlargement of the clitoris in girls)</li>\n<li>Pubertal developmental delay and amenorrhea in girls</li>\n<li><strong>Proximal muscle weakness </strong></li>\n<li>Osteoporosis</li>\n<li><strong>Hypertension</strong></li>\n<li><strong>Hyperpigmentation </strong></li>\n<li><strong>Hypokalemic alkalosis </strong></li>\n<li>Hyperglycemia</li>\n<li><strong>Sepsis</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/743b5311ca5c42eebb0f49ac022dc713.jpeg"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8debb6c57fbd4a2da10172ffbe8280d6x720x965.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/872972c5d60a4cb9b41b4b61643a29efx1280x2560.JPEG"
    ]
  },
  {
    "text": "Which of the following helminthic infections that is commonly transmitted by soil, is characterized by\u200b the egg in stool as shown in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Trichuris trichiura"
      },
      {
        "id": 2,
        "text": "Ancyclostoma duodenale"
      },
      {
        "id": 3,
        "text": "Necator americanus"
      },
      {
        "id": 4,
        "text": "Ascaris lumbricoides"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows the egg of\u00a0<em><strong>Trichuris</strong> <strong>trichiura</strong></em>\u00a0(whipworm).</p>\n<p><em>Trichuris trichiura</em>\u00a0are <strong>barrel-shaped</strong>, thick-shelled, and have a pair of <strong>polar plugs</strong> at each end. They are commonly transmitted by <strong>soil</strong>. The eggs passed in the stool are unembryonated. Microscopic identification of the eggs in a stool specimen is diagnostic of <strong>whipworm infection</strong>.</p>\n<p>It\u00a0causes <strong>rectal prolapse in children</strong> (characteristic feature) because the rectum loses its internal support as the worms bury their thin heads into the intestinal lining, loosening the elastic epithelium, and weakening the surrounding muscles; also, there is rectal edema because of the infection. All these factors finally lead to rectal prolapse.<strong>Trichuriasis</strong> is caused by the T. trichura (whipworm), which inhabits the cecum and ascending colon.</p>\n<p><strong>Clinical features include c</strong>hronic dysentery, anemia, poor growth and developmental defects.</p>\n<p><strong>Diagnosis</strong>:</p>\n<p>Fecal smears showing barrel-shaped ovum of T. trichura. The eggs of Trichuris trichura does not have a terminal spine. They are <strong>barrel-shaped and have mucus plugs at both ends.\u00a0</strong></p>\n<p><strong>Treatment: A</strong><strong>lbendazole</strong> is the drug of choice (400 mg, orally, for 3 days; for all ages)</p>\n<p>The image of egg of trichuris trichura is given below:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/554c3c5e38114a929a0803396c8af059.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/02c4120fb3574f97bcc799a7be6a7d04x720x720.JPEG"
    ]
  },
  {
    "text": "A 46-year-old male presented with dysphagia and regurgitation. Barium swallow showed the following picture. Weakness of which of the following muscles predisposes to the given condition\u200b?",
    "choices": [
      {
        "id": 1,
        "text": "Superior constrictor"
      },
      {
        "id": 2,
        "text": "Inferior constrictor"
      },
      {
        "id": 3,
        "text": "Middle constrictor"
      },
      {
        "id": 4,
        "text": "Palatopharyngeus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario with a pulsion diverticulum on the barium swallow is suggestive of <strong>Zenker's diverticulum.\u00a0</strong>It originates through\u00a0<strong>Killian's dehiscence,</strong> which\u00a0is a site of weakness present in the <strong>inferior constrictor</strong> muscle.</p>\n<p>The inferior constrictor muscle is made up of 2 parts:</p>\n<ol>\n<li>Upper part -\u00a0<strong>th</strong><strong>yropharyngeus,</strong> made of <strong>oblique</strong> fibres.</li>\n<li>Lower part - <strong>c</strong><strong>ricopharyngeus,\u00a0</strong>made of <strong>transverse</strong> fibres.</li>\n</ol>\n<p>Between the two muscles, there is a potential gap which is\u00a0called the <strong>pharyngeal dimple</strong> or<strong> Killian's dehiscence.</strong></p>\n<p>Another site of weakness in the pharyngeal wall is the <strong>Laimer's triangle</strong>, which is present between the cricopharyngeus and the circular muscle of the oesophagus.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ed59f7d7e1a2468b91d973481cf4082e.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8cb0c66285664842989c193b0c2baeb0x1280x1340.JPEG"
    ]
  },
  {
    "text": "A newborn presents with respiratory distress and drooling of saliva. Nasogastric tube cannot be passed to the stomach. There is history of maternal polyhydramnios. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Congenital diaphragmatic hernia"
      },
      {
        "id": 2,
        "text": "Tracheoesophageal fistula"
      },
      {
        "id": 3,
        "text": "Cleft palate"
      },
      {
        "id": 4,
        "text": "Volvulus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical scenario suggests a diagnosis of <strong>esophageal atresia </strong>with or without TEF<strong>.\u00a0\u00a0</strong>In the setting of early-onset respiratory distress, the <strong>inability to pass a nasogastric or orogastric tube</strong> in the newborn suggests EA.</p>\n<p>Features:</p>\n<ul>\n<li>Esophageal atresia (EA) is the most common congenital anomaly of the esophagus. It is often associated with single umbilical artery.</li>\n<li><strong>&gt;90% of babies with EA </strong>have an <strong>associated tracheoesophageal fistula (TEF).</strong></li>\n<li>In the most common form of EA, the upper esophagus ends in a blind pouch and the TEF is connected to the distal esophagus.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/c34a49f36860436d8f6c2eddf94e9947x148x314.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74fbd3afc78d44879dcf02d992051c51x279x466.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/71ec67690c7a42fa9dcfb26db38ba1aex787x551.JPEG"
    ]
  },
  {
    "text": "A 34-year-old male was on maize as a staple diet for a prolonged period. He presented with diarrhoea and lesion over his neck as shown in the image below. The condition occurs due to deficiency of:",
    "choices": [
      {
        "id": 1,
        "text": "Niacin"
      },
      {
        "id": 2,
        "text": "Zinc"
      },
      {
        "id": 3,
        "text": "Thiamine"
      },
      {
        "id": 4,
        "text": "Iron"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above history and clinical features suggest<strong>&nbsp;niacin/vitamin B3</strong> deficiency.</p>\n<p>Excessive consumption of maize-based diets can cause <strong>pellagra</strong>. Corn/Maize has low levels of niacin and tryptophan.&nbsp;Jowar has high leucine content which inhibits QPRTase, an enzyme in the synthesis of Niacin.</p>\n<p>Niacin deficiency leads to a disease called pellagra which is characterized by</p>\n<ul>\n<li>Diarrhea</li>\n<li>Dermatitis</li>\n<li>Dementia</li>\n</ul>\n<p>The lesion in the neck is characteristic&nbsp;<strong>Casal&rsquo;s necklace pattern</strong>, seen in pellagra. The Casal's collar or Casal's necklace is a clinical sign in which there is an erythematous pigmented skin rash in the distribution of a broad collar (dermatomes C3 and C4).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0bb5f4b18dcf4cc185b5351fc0d1e1ba.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8c0a9800de0f40f5b25c42b0b81bcecfx720x521.JPEG"
    ]
  },
  {
    "text": "A 30-day-old infant is brought with excessive lacrimation and photophobia. He has a large and hazy cornea in both eyes. His lacrimal system is normal. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Megalocornea"
      },
      {
        "id": 2,
        "text": "Keratoconus"
      },
      {
        "id": 3,
        "text": "Congenital glaucoma"
      },
      {
        "id": 4,
        "text": "Hunters syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given scenario fits the description of&nbsp;<strong>congenital glaucoma.</strong></p>\n<p><strong>Primary congenital glaucoma (PCG)</strong></p>\n<p>It can be classified as follows:</p>\n<ul>\n<li><strong>True congenital glaucoma</strong> (40%) in which intraocular pressure (<strong>IOP</strong>) is <strong>elevated</strong> during <strong>intrauterine life</strong>.</li>\n<li><strong>Infantile glaucoma (55%</strong>)<strong>,</strong> which manifests<strong> prior to age 3</strong>.</li>\n<li><strong>Juvenile glaucoma,</strong> the <strong>least</strong> common, in which IOP rises between <strong>3 and 16 years of age</strong>.</li>\n</ul>\n<p>Several genes have been implicated, prominently<em><strong> CYP1B1</strong></em>.</p>\n<p><strong>Diagnosis</strong></p>\n<ul>\n<li><strong>Corneal haze</strong> is due to diffuse edema secondary to raised IOP.</li>\n<li><strong>Buphthalmos</strong> is a <strong>large</strong> <strong>eye</strong> as a result of stretching due to elevated IOP prior to the age of<strong> 3 years</strong>.</li>\n<li><strong>Haab striae</strong> are curvilinear healed breaks in Descemet's membrane.</li>\n<li>Corneal scarring</li>\n<li><strong>Evaluation</strong> under <strong>general anesthesia</strong> is generally required; <strong>sevoflurane</strong> lowers IOP to levels lower than those achieved with other agents.</li>\n</ul>\n<p><strong>Treatment</strong></p>\n<ul>\n<li>Management is essentially <strong>surgical</strong>.</li>\n<li><strong>Goniotomy</strong></li>\n<li><strong>Trabeculotomy</strong></li>\n<li>Other procedures when angle surgery fails include trabeculectomy, tube shunt implantation,&nbsp;and ciliary body ablative procedures.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is least likely physiological change in pregnancy?",
    "choices": [
      {
        "id": 1,
        "text": "Increase in intravascular volume"
      },
      {
        "id": 2,
        "text": "Increase in cardiac output"
      },
      {
        "id": 3,
        "text": "Increase in stroke volume"
      },
      {
        "id": 4,
        "text": "Increase in peripheral vascular resistance"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Decrease</strong> in <strong>peripheral vascular resistance</strong> is a physiologial change in pregnancy.&nbsp;</p>\n<p><strong>Parameters increasing in pregnancy:</strong></p>\n<ul>\n<li>Cardiac output</li>\n<li>Stroke volume</li>\n<li>Heart rate</li>\n</ul>\n<p><strong>Parameters decreasing in pregnancy:</strong></p>\n<ul>\n<li>Peripheral vascular resistance (due to smooth muscle relaxation by progesterone)</li>\n<li>Both diastolic BP and systolic BP (decrease in DBP &gt; SBP)</li>\n<li>Mean arterial BP</li>\n<li>Artery venous O<sub>2</sub> gradient</li>\n</ul>\n<div class=\"page\" title=\"Page 79\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Late pregnancy was associated with decreased systemic vascular and pulmonary vascular resistance both decreased significantly, as did colloid osmotic pressure.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The preparation shown below is used for the diagnosis of  ________",
    "choices": [
      {
        "id": 1,
        "text": "Chlamydia trachomatis"
      },
      {
        "id": 2,
        "text": "Trichomonas vaginalis"
      },
      {
        "id": 3,
        "text": "Gardnerella vaginalis"
      },
      {
        "id": 4,
        "text": "Candida albicans"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Hanging drop preparation is used for <strong>diagnosis of trichomniasis</strong>.</p>\n<ul>\n<li><em>Trichomonas vaginalis</em> is a protozoan, <strong>actively mo&shy;tile</strong> and slightly larger than a leucocyte and is anaerobic.</li>\n<li>A trichomonas has four anterior flagella and one posterior flagella, and they move along the mucous membrane.</li>\n<li><strong>The posterior flagella are respon&shy;sible for motility</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/091c84c147824cf99d6528671020538e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the MRI image.",
    "choices": [
      {
        "id": 1,
        "text": "T1 weighted image"
      },
      {
        "id": 2,
        "text": "T2 weighted image"
      },
      {
        "id": 3,
        "text": "FLAIR"
      },
      {
        "id": 4,
        "text": "STIR"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given MRI is a <strong>T2 weighted image</strong> as the <strong>CSF</strong> appears&nbsp;<strong>bright</strong>/hyperintense and <strong>white matter</strong> appears&nbsp;<strong>dark</strong>.&nbsp;</p>\n<p>In T1 images CSF is dark/hypointense, white matter is white and grey matter is dark.</p>\n<p>Many pulse sequence techniques are used in MRI, of which the most classic are T1 and T2 weighted images.</p>\n<p><strong>FLAIR</strong>&nbsp;(fluid-attenuated inversion recovery) is an inversion recovery technique that nulls fluid from T2. As a result, <strong>CSF is dark.&nbsp;</strong>However,&nbsp;white matter is dark and grey matter is bright similar to T2 imaging.</p>\n<p><strong>STIR</strong>&nbsp;(short tau inversion recovery) is an inversion recovery technique that nulls fat from T2. So,<strong> fat is dark.</strong>&nbsp;It is done to detect bone marrow edema in body part scans.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ff07e7dc67994ced9e00b9d53527c124.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/02a0b4ddc300404a883f372a042e3c06x668x692.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9170f642b45a41fc88ae14ed1739b025x682x682.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e3b41f67550140e5ab37b7936cbf54a4x676x676.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b47d42d43c5d4548b5021b465550c8fax806x942.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/69f31eed0ddb491bb7f438bf5b72f783x802x938.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6f3a7bdb71424ebab8f4fc58cbbfbb61x798x1034.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8db6978a3fd94e2aa9e1f887976fb044x802x922.PNG"
    ]
  },
  {
    "text": "A 55-year-old female presents with complaints of persistent headaches. A CT scan of the head reveals a brain tumour. On histopathology, psammoma bodies are seen. Based on these findings, what is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Retinoblastoma"
      },
      {
        "id": 2,
        "text": "Medulloblastoma"
      },
      {
        "id": 3,
        "text": "Meningioma"
      },
      {
        "id": 4,
        "text": "Oligodendroglioma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical vignette and the histopathology showing a tumour with psammoma bodies is suggestive of <strong>meningioma</strong>.</p>\n<p>Meningiomas are predominantly <strong>benign tumors</strong> in adults, typically attached to the dura and arising from the meningothelial cells of the arachnoid. They can develop along any external surface of the brain or within the ventricular system, originating from the stromal arachnoid cells of the choroid plexus.</p>\n<p>A major risk factor for meningiomas is <strong>prior radiation therapy</strong> to the head and neck. The most common cytogenetic abnormality associated with these tumors is the loss of <strong>chromosome 22,</strong> particularly the long arm (22q). Meningiomas are frequently seen in neurofibromatosis type 2 (NF2), often occurring at multiple sites, especially alongside acoustic neuromas or glial tumors.</p>\n<p>The tumor mass is usually encapsulated but may also grow<strong> en plaque</strong>, where it spreads in a <strong>sheetlike manner</strong> along the dura, often leading to hyperostotic reactive changes in the adjacent bone. Histologically, meningiomas may contain numerous <strong>calcified psammoma bodies</strong>, a characteristic microscopic feature.</p>\n<p>Psammoma bodies are <strong>concentric, lamellated structures</strong> formed as a product of <strong>dystrophic calcification.</strong> They are associated with papillary histomorphology and are caused by infarction and calcification of papillae tips.\u00a0</p>\n<p>The histological section of meningioma showing psammoma bodies is given below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/885fb50542b24436bbba2c7a2e52f59ex1027x628.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/deab76301f0d4eb9b87d8daba8856b47x510x525.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f9d37f45e0854783a73a0412accea66ax510x525.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dbb9bf3d144c47c09c59b74b3a36e7a1x510x525.GIF"
    ]
  },
  {
    "text": "A 60-year-old male who lost his wife 3 months back complains that his intestines have become rotten. He feels that he is responsible for his wife's death and should be sent to prison. He complains of feeling low all the time and has lost interest in daily activities since his wife's death. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Normal grief reaction"
      },
      {
        "id": 2,
        "text": "Psychotic depression"
      },
      {
        "id": 3,
        "text": "Delusional disorder"
      },
      {
        "id": 4,
        "text": "Schizophrenia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of persistent low mood, anhedonia, guilt, and self-critical thought content along with nihilistic delusion (rotten intestine), points towards a diagnosis of <strong>major depression with psychotic features</strong>.</p>\n<p>Differentiating features of grief and depression have been enlisted in the following table:</p>\n<table style=\"height: 506px; width: 290px;\">\n<tbody>\n<tr>\n<td style=\"width: 122px;\"><strong>Grief</strong></td>\n<td style=\"width: 131px;\"><strong>Depression</strong></td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">Feelings of emptyness and loss</td>\n<td style=\"width: 131px;\">Persistent low mood and inability to anticipate pleasure</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">Dysphoria comes in waves and tends to decrease in intentsity over time</td>\n<td style=\"width: 131px;\">Low mood tends to be persistent and consistent</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">Associated with thoughts and reminders of deceased/loss</td>\n<td style=\"width: 131px;\">Not tied to specific thoughts and pre-occupations</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">May be present along with positive emotions and humor</td>\n<td style=\"width: 131px;\">Pervassive unhappiness and misery</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">Thought content associated with thoughts and memories of deceased/loss</td>\n<td style=\"width: 131px;\">Thought content associated with self-critical and pessimistic ruminations</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">Self-esteem is generally preserved</td>\n<td style=\"width: 131px;\">Worthlessness and self-loathing is common</td>\n</tr>\n<tr>\n<td style=\"width: 122px;\">Ideas of death focused on joining the deceased</td>\n<td style=\"width: 131px;\">Ideas of death focused on ending life due to hopelessness</td>\n</tr>\n</tbody>\n</table>\n<p>Note: Tricyclic antidepressants are considered to be the first-line drugs for psychotic depression.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What does number 2 in the given diagram related to hypertension denote?",
    "choices": [
      {
        "id": 1,
        "text": "Normotensive individuals"
      },
      {
        "id": 2,
        "text": "Undiagnosed hypertensive subjects"
      },
      {
        "id": 3,
        "text": "Diagnosed hypertensive subjects not on treatment"
      },
      {
        "id": 4,
        "text": "Diagnosed but treated"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above diagram depicts the&nbsp;<strong>rule of halves</strong>,<strong>&nbsp;</strong>which is observed in hypertension, and \"number 2.\" denotes normotensive subjects.</p>\n<p>The rule of halves depicts that only about half of the hypertensive subjects in the general population of most developed countries were aware of the condition and only half of those aware are being treated and only half of those being treated are considered to be adequately treated.&nbsp;</p>\n<p>The numbers in the diagram denote the following:</p>\n<ol>\n<li>Whole community</li>\n<li>Normotensive subjects</li>\n<li>Hypertensive subjects</li>\n<li>Undiagnosed hypertension</li>\n<li>Diagnosed hypertension</li>\n<li>Diagnosed but untreated</li>\n<li>Diagnosed and treated</li>\n<li>Inadequately treated</li>\n<li>Adequately treated</li>\n</ol>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/54aca909c3c24314a2b0d4817d15ff5d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old woman presented with persistent headaches over the last 1 month. Her father and paternal uncle suffered from kidney disease and both died in their 50's of a 'brain bleed'. Her blood pressure is 160/110 mm Hg and had also been elevated during a previous visit. Which of the following investigations should be avoided in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Ultrasonography of the abdomen"
      },
      {
        "id": 2,
        "text": "Contrast enhanced CT of the abdomen"
      },
      {
        "id": 3,
        "text": "Non-contrast CT scan of the abdomen"
      },
      {
        "id": 4,
        "text": "MR angiography of the cerebral vasculature"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This clinical scenario is suggestive of autosomal dominant polycystic kidney disease <strong>(ADPKD).</strong>&nbsp;These patients usually have impaired renal function. Hence, contrast-enhanced CT (<strong>CECT</strong>) would usually be <strong>avoided</strong> due to the risk of&nbsp;<strong>contrast&nbsp;nephrotoxicity.</strong></p>\n<p>The following investigations are done in patients with ADPKD:</p>\n<ul>\n<li><strong>USG abdomen - </strong>for&nbsp;screening and diagnosis</li>\n<li><strong>Non-contrast CT</strong>&nbsp;abdomen - more sensitive and picks up cysts of smaller size</li>\n<li><strong>MR-angiography</strong>&nbsp;of brain -&nbsp;pre-symptomatic <strong>screening&nbsp;</strong>for&nbsp;intracerebral<strong> aneurysms</strong>&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following items are disposed of in the yellow bag?",
    "choices": [
      {
        "id": 1,
        "text": "Blood bag"
      },
      {
        "id": 2,
        "text": "Gloves"
      },
      {
        "id": 3,
        "text": "Sharps"
      },
      {
        "id": 4,
        "text": "Urine bag"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Blood bags</strong>&nbsp;are disposed of in the <strong>yellow bag</strong>.</p>\n<p><strong>Gloves</strong> are disposed of in the <strong>red bag</strong>.</p>\n<p><strong>Sharps</strong> are disposed of in the <strong>white container.</strong></p>\n<p><strong>Urine bags&nbsp;</strong>are disposed of in the<strong> red bag.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "From the following epidemic curve, identify the type of epidemic depicted.",
    "choices": [
      {
        "id": 1,
        "text": "Point-source epidemic"
      },
      {
        "id": 2,
        "text": "Continuous epidemic"
      },
      {
        "id": 3,
        "text": "Slow epidemic"
      },
      {
        "id": 4,
        "text": "Propagated epidemic"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Point-source epidemic</strong> is depicted in the given image.</p>\n<p>In the epidemic curve for a point-source epidemic, there is a <strong>sharp rise and fall</strong> of the curve with <strong>no secondary waves.&nbsp;</strong>It tends to be <strong>explosive</strong> as all the cases are <strong>clustered</strong> in a narrow period of time and they occur within one <strong>incubation period </strong>of the disease.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/04da45753b6644e59d655562b315b6a2.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Disruption of the axon with an intact endoneurium is seen in which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Axonotmesis"
      },
      {
        "id": 2,
        "text": "Neurotmesis"
      },
      {
        "id": 3,
        "text": "Neuropraxia"
      },
      {
        "id": 4,
        "text": "Neurolysis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Disruption of the axon with an intact endoneurium is seen in<strong>&nbsp;axonotmesis.</strong>&nbsp;There is an&nbsp;<strong>axonal disruption&nbsp;</strong>(inner axon is damaged) and loss of conductivity, with an intact outer sheath.&nbsp;</p>\n<p><strong>Axonotmesis</strong> (axonal interruption): There is a&nbsp;<strong>loss of conduction</strong>, but the <strong>continuity of the nerve is maintained</strong> and the neural tubes are intact.&nbsp;There is <strong>disruption of the axon</strong> i.e., the continuity of the axon is broken. But the <strong>endoneurium</strong> and perineurium are <strong>intact</strong>, maintaining the continuity of the nerve. It occurs following trauma such as <strong>closed</strong>&nbsp;<strong>fractures and dislocations</strong>.</p>\n<p>Distal to the lesion,&nbsp;<strong>Wallerian degeneration</strong> of the disrupted axon occurs, where axons disintegrate and are resorbed by phagocytes. It is then followed by axonal regeneration where numerous fine unmyelinated fibres grow from the proximal stumps to the endoneurial tubes.</p>\n<p>Other options:</p>\n<p>Option A- <strong>Neurapraxia </strong>is the&nbsp;reversible <strong>physiological nerve conduction block</strong> causing some loss of sensation and muscle power. There is spontaneous recovery after a few days or weeks. It occurs following <strong>prolonged compression</strong>, as in Saturday night palsy, and crutch palsy. Here, there is&nbsp;<strong>segmental demyelination</strong> but the <strong>axon is intact</strong>. Nerve conduction is&nbsp;slowed because of the loss of myelin. It is followed by the regeneration of the myelin.</p>\n<p><strong>Option B- Neurotmesis </strong>is the complete transection of the nerve trunk. It is usually associated with open wounds. The endoneurial tubes are destroyed and the scar tissue prevents the regenerating axons from entering the distal segment. The regenerating fibers mingle with proliferating Schwann cells and fibroblasts to form a neuroma at the site of injury.</p>\n<p><strong>Option D- Axonapraxia</strong>&nbsp;is a disruption to the axoplasmic flow of neurochemicals temporarily.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 71-year-old man presented with acute ST segment elevated anterior myocardial infarction and coronary stenting was performed. During follow-up, he reported pain over his toes. On examination, coloured skin lesions were observed at both feet with tenderness as in the image. He also developed progressive deterioration in renal functions. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Sharp syndrome"
      },
      {
        "id": 2,
        "text": "Antiphospholipid antibody syndrome"
      },
      {
        "id": 3,
        "text": "Aortic dissection"
      },
      {
        "id": 4,
        "text": "Atheroembolism"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This is a classical history of <strong>atheroembolism&nbsp;</strong>also called cholesterol embolism or <strong>Blue toe syndrome.</strong></p>\n<p>Key points in the history:</p>\n<ul>\n<li>Patient with ST elevation myocardial infarction presenting with clinical features of limb ischemia (Cyanotic discoloration of the toes with pain and tenderness) following an intraarterial procedure (angioplasty).</li>\n</ul>\n<p><strong>Atheroembolism:</strong></p>\n<ul>\n<li>Atheroembolism is a condition in which multiple small deposits of fibrin, platelets, and cholesterol debris embolize from proximal atherosclerotic lesions or aneurysmal sites.</li>\n<li>Large protruding aortic atheromas are a source of emboli that may lead to limb ischemia, as well as stroke and renal insufficiency.</li>\n<li>Atheroembolism may occur after intraarterial procedures like angioplasty (percutaneous coronary intervention).</li>\n<li>Since atheroemboli to limbs tend to lodge in the small vessels of the muscle and skin and may not occlude the large vessels, distal pulses usually remain palpable.</li>\n<li>Patients complain of acute pain and tenderness at the site of embolization.</li>\n<li>Digital vascular occlusion may result in ischemia and the \"blue toe\" syndrome; digital necrosis and gangrene may develop.</li>\n<li>Localized areas of tenderness, pallor, and livedo reticularis occur at sites of emboli.</li>\n<li>Skin or muscle biopsy may demonstrate cholesterol crystals.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3ce8d5a31a9641f08f103fffb86d2673.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following conditions is not an indication for functional endoscopic sinus surgery?",
    "choices": [
      {
        "id": 1,
        "text": "Chronic sinusitis"
      },
      {
        "id": 2,
        "text": "Epistaxis"
      },
      {
        "id": 3,
        "text": "Nasal polyp"
      },
      {
        "id": 4,
        "text": "Cavernous sinus thrombosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Cavernous sinus thrombosis</strong> is <strong>not</strong> an indication for functional endoscopic sinus surgery(<strong>FESS</strong>).</p>\n<p><strong class=\"ng-binding\">Indications of FESS:</strong></p>\n<ul>\n<li>Chronic bacterial sinusitis unresponsive to adequate medical treatment</li>\n<li>Recurrent acute bacterial sinusitis</li>\n<li>Fungal sinusitis with fungal ball</li>\n<li>Nasal polyps</li>\n<li>Mucocele&nbsp;</li>\n<li>Control of epistaxis&nbsp;</li>\n<li>Removal of foreign body from the nose or sinus</li>\n<li>Barotrauma sinusitis (pain in the face during descent in aircraft or descent whilst scuba diving)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old man is admitted to the hospital with severe pancreatitis. The next day he develops sudden onset breathlessness and severe hypoxia. Below is the CXR obtained. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary embolism"
      },
      {
        "id": 2,
        "text": "ARDS"
      },
      {
        "id": 3,
        "text": "Hospital-acquired pneumonia"
      },
      {
        "id": 4,
        "text": "Left ventricular failure"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The history of <strong>severe pancreatitis</strong> and the chest X-ray findings of <strong>B/L diffuse alveolar opacities</strong> are suggestive of <strong>ARDS.</strong></p>\n<p>Severe pancreatitis gives rise to<strong> inflammatory processes and endothelial damage</strong> that results in ARDS.&nbsp;</p>\n<p><strong>CXR features in ARDS:</strong></p>\n<ul>\n<li>Early findings include normal or <strong>diffuse</strong> alveolar opacities (consolidation), which are often <strong>bilateral</strong> and which obscure the pulmonary vascular markings.</li>\n<li>Later, these opacities progress to more extensive consolidation that is diffuse.</li>\n</ul>\n<p>Prolonged bed rest increases the risk of venous thrombosis and pulmonary embolism. However, the CXR shows diffuse alveolar opacities making the diagnosis of ARDS more likely.</p>\n<p>Hospital-acquired pneumonia usually appears after 48 hours of admission.&nbsp;Areas of consolidation in unilateral or bilateral lung fields may be seen depending on severity.&nbsp;</p>\n<p>Left ventricular failure is an important differential diagnosis for ARDS. However, the patient's history of acute pancreatitis makes the diagnosis of ARDS more likely.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8a4fcbf042b143df8b6d2cda842a39a4.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Insulin acts on glucose metabolism by______",
    "choices": [
      {
        "id": 1,
        "text": "\u2191 facilitated diffusion of glucose"
      },
      {
        "id": 2,
        "text": "\u2193 permeability of glucose across cell membrane"
      },
      {
        "id": 3,
        "text": "\u2191 reabsorption of glucose from renal tubules"
      },
      {
        "id": 4,
        "text": "\u2191 glucose reabsorption from intestine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Insulin stimulates the entry of glucose into cells via <strong>facilitated diffusion</strong> by increasing the number of glucose transporters (GLUTs) in the cell membrane.</p>\n<p>This type of insulin-dependent glucose transport via GLUT 4 is observed in <strong>skeletal muscle, cardiac muscle, </strong>and<strong> adipose tissues.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the type of flap.",
    "choices": [
      {
        "id": 1,
        "text": "Axial flap"
      },
      {
        "id": 2,
        "text": "Islanded flap"
      },
      {
        "id": 3,
        "text": "Free flap"
      },
      {
        "id": 4,
        "text": "Random flap"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The picture shows a radial forearm free flap. In a free flap the <strong>blood supply is isolated</strong>, disconnected and then reconnected using micosurgery at the new site. Other eg: DIEP (Deep inferior epigastric perforators) flap, free fibular flap</p>\n<ul>\n<li>A <strong>random flap</strong> include three sides of a rectangle, bearing no specific relationship to where the blood supply enters.Eg:V-Y plasty, Z plasty, Limberg or rhomboid flap.</li>\n<li><strong>Axial flap</strong> is much longer and is based on known blood vessels. Eg: Latissmus dorsi flap,TRAM (Transverse rectus abdominis myocutaneous) flap</li>\n<li><strong>Islanded flap</strong> are those in which the axial blood supply is swung round on a stalk.</li>\n</ul>\n<p><strong>Note:</strong></p>\n<div class=\"page\" title=\"Page 1968\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Flap defines the tongue of tissue; pedicle is used to describe the base or stem with the vascular supply.</p>\n<p>Skin-bearing flaps are classified according to <strong>three basic characteristics</strong>&mdash;</p>\n<div class=\"page\" title=\"Page 1968\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li><strong>Composition:&nbsp;</strong>refers to the tissue contained within the flap, such as cutaneous, musculocutaneous, fasciocutaneous etc</li>\n<li><strong>Method of movement</strong>:\n<ul>\n<li>Local transfer, eg. advancement or rotation flaps</li>\n<li>Distant transfer, eg. pedicle flaps from the abdomen to the perineum or micro-vascular free flaps.</li>\n</ul>\n</li>\n<li><strong>Blood supply</strong>\n<ul>\n<li>Musculocutaneous arteries travel perpendicularly through muscle to the overlying skin.</li>\n<li>Septocutaneous arteries travel with intermuscular fascial septa to supply the overlying skin.&nbsp;</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5074b024418540069fe8b7a0c986d2ee.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/38a465d7aeef48e38e7ebd9b07c4908ex1280x4958.JPEG"
    ]
  },
  {
    "text": "Identify the following deformity seen in a patient complaining of pain and swelling of her hands.",
    "choices": [
      {
        "id": 1,
        "text": "Swan neck deformity"
      },
      {
        "id": 2,
        "text": "Boutonni\u00e8re deformity"
      },
      {
        "id": 3,
        "text": "Bouchard's nodes"
      },
      {
        "id": 4,
        "text": "Hitchhiker's deformity"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image is showing&nbsp;<strong>flexion of the PIP</strong> joint with <strong>hyperextension of the DIP</strong> joint is suggestive of&nbsp;<strong>Boutonni&egrave;re deformity </strong>seen in patients with <strong>rheumatoid arthritis.</strong></p>\n<p>Heberden&rsquo;s&nbsp;and&nbsp;Bouchard&rsquo;s<strong>&nbsp;</strong>nodes are nodules in osteoarthritis that are palpable in the distal interphalangeal joint and proximal interphalangeal joints respectively.&nbsp;</p>\n<p><strong>Hitchhiker thumb deformity</strong> is a musculoskeletal manifestation of rheumatoid arthritis. It is seen on the thumb. The deformity has flexion at the metacarpophalangeal (MCP) joint hyperextension at the interphalangeal (IP) joint</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/079206c14a08488aa5359d40de365ef9.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the diagnosis.",
    "choices": [
      {
        "id": 1,
        "text": "Atopic dermatitis"
      },
      {
        "id": 2,
        "text": "Adenoma sebaceum"
      },
      {
        "id": 3,
        "text": "Rosacea"
      },
      {
        "id": 4,
        "text": "Ichthyosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image is of Atopic dermatosis.</p>\n<p>Atopic dermatosis is a relapsing inflammatory skin disorder that is common in infancy and presents differently in different age groups. It is characterized by <strong>pruritus leading to lichenification. </strong></p>\n<p>Clinical features:</p>\n<ul style=\"list-style-type: disc;\">\n<li><strong>In infants:&nbsp;</strong>The lesions most frequently start on the face, and then, the <strong>extensor aspect</strong> of the knees and elbows are involved.</li>\n<li><strong>In Children:</strong> Dry, scaly, pruritic, excoriated papules and plaques in the flexural areas and neck.</li>\n<li><strong>In adults:</strong> Lichenification and dry, fissured skin in a <strong>flexural distribution. </strong></li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0c6d22993c00447b9212464a0feffb9c.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 006';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>