<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metabolic Disorders Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 10-year-old boy with intellectual disability is found to have bilaterally subluxated lenses. He also has a history of deep vein thrombosis. Physical examination findings are as shown in the image below. Which of the following vitamins will be the most useful in the treatment of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin C"
      },
      {
        "id": 2,
        "text": "Vitamin B6"
      },
      {
        "id": 3,
        "text": "Vitamin B1"
      },
      {
        "id": 4,
        "text": "Vitamin D"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows <strong>arachnodactyly</strong> and a <strong>positive wrist sign</strong>, indicative of <strong>marfanoid habitus</strong>. The presence of <strong>marfanoid habitus</strong> in a patient with <strong>intellectual disability,</strong> bilaterally <strong>subluxated</strong> <strong>lenses</strong> and a <strong>history of deep vein thrombosis</strong> points to a diagnosis of <strong>homocystinuria</strong>. The <strong>vitamin</strong> which can be used for <strong>treatment</strong> is <strong>pyridoxine</strong> <strong>(vitamin B6)</strong>. Administration of large doses of pyridoxine (vitamin B6) restores the activity of the deficient enzyme in half of all cases of homocystinuria.</p>\n<p>Homocystinuria is an <strong>autosomal recessive</strong> disease that is most commonly caused by a <strong>deficiency</strong> of the enzyme <strong>cystathionine &beta;-synthase</strong>. The deficiency of this enzyme leads to an accumulation of homocysteine in the blood and a clinical syndrome of <strong>intellectual disability, </strong><strong>subluxated ocular lenses</strong>, <strong>long and slender extremities</strong>, arachnodactyly and arterial and venous <strong>thrombi</strong>. The skeletal features of homocystinuria often mimic Marfan syndrome.</p>\n<table style=\"width: 52.3176%; height: 102.992px;\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.9859%; height: 22.3984px;\">&nbsp;</td>\n<td style=\"width: 33.5677%; height: 22.3984px;\"><strong>Marfan syndrome</strong></td>\n<td style=\"width: 34.2707%; height: 22.3984px;\"><strong>Homocystinuria</strong></td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.9859%; height: 22.3984px;\">Inheritance pattern</td>\n<td style=\"width: 33.5677%; height: 22.3984px;\">Autosomal dominant</td>\n<td style=\"width: 34.2707%; height: 22.3984px;\">Autosomal recessive</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.9859%; height: 22.3984px;\">Intellectual disability</td>\n<td style=\"width: 33.5677%; height: 22.3984px;\">Absent</td>\n<td style=\"width: 34.2707%; height: 22.3984px;\">Present</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.9859%; height: 22.3984px;\">Vascular complications</td>\n<td style=\"width: 33.5677%; height: 22.3984px;\">Aortic root dilation</td>\n<td style=\"width: 34.2707%; height: 22.3984px;\">Thrombosis</td>\n</tr>\n<tr style=\"height: 13.3984px;\">\n<td style=\"width: 31.9859%; height: 13.3984px;\">Lens dislocation</td>\n<td style=\"width: 33.5677%; height: 13.3984px;\">Superotemporal</td>\n<td style=\"width: 34.2707%; height: 13.3984px;\">Inferonasal</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>Demonstration of <strong>elevated total homocysteine</strong> in the blood confirms the diagnosis. If there is a deficiency of cystathionine &beta;-synthase enzyme, there will be <strong>elevated</strong> levels of <strong>methionine</strong> as well. <strong>50% of the cases</strong> of homocystinuria are termed <strong>pyridoxine</strong>-<strong>responsive</strong> because large doses of pyridoxine can enhance the activity of deficient enzyme in these patients.</p>\n<p><strong>Folate supplementation</strong> is also added to overcome any folate deficiency which might occur due to increased conversion of homocysteine to methionine. For the other 50% of the patients, the treatment consists of <strong>methionine restriction</strong> and <strong>cysteine supplementation</strong>. In addition, betaine (methyl group donor), folate and vitamin B12 may also be added.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/87438d5c45ef42d0ae84e87387d53031.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 17-year-old patient presents with weakness and atrophy of the proximal muscles of the limb. He has a history of episodes of hypoglycemia since childhood. His serum lactate and uric acid levels are found to be normal. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cori disease"
      },
      {
        "id": 2,
        "text": "Von Gierke disease"
      },
      {
        "id": 3,
        "text": "McArdle disease"
      },
      {
        "id": 4,
        "text": "Pompe disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given clinical scenario of a patient presenting with complaints of <strong>muscle weakness</strong> and <strong>hypoglycemia</strong> with <strong>normal blood lactate and uric acid levels</strong>, the most likely diagnosis is <strong>Cori disease</strong>.&nbsp;</p>\n<p>Cori disease (type III glycogen storage disorder) occurs due to a deficiency of the glycogen <strong>debranching enzyme</strong>. The features of Cori disease include <strong>hypoglycemia</strong>, <strong>hepatomegaly</strong>, and <strong>hyperlipidemia</strong> but with <strong>normal</strong> blood <strong>lactate</strong> and <strong>uric acid</strong> levels. <strong>Muscle weakness</strong> and atrophy can also occur in these patients. Liver biopsy shows the accumulation of glycogen in the form of <strong>limit-dextrins</strong> in hepatocyte cytosol and the presence of fibrous septa.</p>\n<table style=\"width: 68.7471%; height: 196.586px;\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 20.5882%; height: 22.3984px;\">&nbsp;</td>\n<td style=\"width: 49.2004%; height: 22.3984px;\"><strong>Von Gierke Disease</strong></td>\n<td style=\"width: 30.2114%; height: 22.3984px;\"><strong>Cori Disease</strong></td>\n</tr>\n<tr style=\"height: 17.3984px;\">\n<td style=\"width: 20.5882%; height: 17.3984px;\">Deficient enzyme</td>\n<td style=\"width: 49.2004%; height: 17.3984px;\">Glucose-6-phosphatase</td>\n<td style=\"width: 30.2114%; height: 17.3984px;\">Debranching enzyme</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 20.5882%; height: 22.3984px;\">Hypoglycemia</td>\n<td style=\"width: 49.2004%; height: 22.3984px;\">Present</td>\n<td style=\"width: 30.2114%; height: 22.3984px;\">Present</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 20.5882%; height: 22.3984px;\">Hepatomegaly</td>\n<td style=\"width: 49.2004%; height: 22.3984px;\">Present</td>\n<td style=\"width: 30.2114%; height: 22.3984px;\">Present</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 20.5882%; height: 22.3984px;\">Renal disease</td>\n<td style=\"width: 49.2004%; height: 22.3984px;\">Present (proteinuria, hypertension, renal stones)</td>\n<td style=\"width: 30.2114%; height: 22.3984px;\">Absent</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 20.5882%; height: 22.3984px;\">Blood lactate</td>\n<td style=\"width: 49.2004%; height: 22.3984px;\">Elevated</td>\n<td style=\"width: 30.2114%; height: 22.3984px;\">Normal</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 20.5882%; height: 22.3984px;\">Blood uric acid</td>\n<td style=\"width: 49.2004%; height: 22.3984px;\">Elevated</td>\n<td style=\"width: 30.2114%; height: 22.3984px;\">Normal</td>\n</tr>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 20.5882%; height: 44.7969px;\">Gluconeogenesis</td>\n<td style=\"width: 49.2004%; height: 44.7969px;\">Impaired, since glucose-6-phosphatase is required in the final step of gluconeogenesis</td>\n<td style=\"width: 30.2114%; height: 44.7969px;\">Intact</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A newborn presents with poor feeding, vomiting, and hypotonia. The results of his laboratory investigations are as given below, prompting the suspicion of organic acidemia. Further workup reveals it to be propionic acidemia. Which of the following need not be restricted in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Valine"
      },
      {
        "id": 2,
        "text": "Isoleucine"
      },
      {
        "id": 3,
        "text": "Odd-chain fatty acids"
      },
      {
        "id": 4,
        "text": "Leucine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In a newborn presenting with <strong>hypoglycemia</strong>, metabolic acidosis with <strong>ketosis</strong>, and <strong>hyperammonemia</strong>, a diagnosis of <strong>organic acidemia</strong> is most likely. In patients with propionic acidemia and vitamin B12&ndash;unresponsive forms of methylmalonic acidemia, a <strong>diet</strong> <strong>low</strong> <strong>in</strong> <strong>valine</strong>, <strong>isoleucine</strong>, <strong>methionine</strong>, <strong>threonine,</strong> and <strong>odd-chain fatty acids</strong> is required.</p>\n<p id=\"viewer-52g84\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Organic acidemias occur due to a <strong>deficiency</strong> of <strong>propionyl-CoA carboxylase</strong> (propionic acidemia) or <strong>methymalonyl-CoA mutase</strong> (methylmalonic acidemia). Amino acids like valine, isoleucine, methionine, threonine and odd-chain fatty acids are successively metabolized into propionyl-CoA, methylmalonyl-CoA and succinyl-CoA to give rise to citrate cycle intermediates. In the absence of the above-mentioned enzymes, organic acids accumulate and cause a variety of downstream effects. </span></p>\n<p id=\"viewer-7ckq1\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">They cause <strong>inhibition of gluconeogenesis</strong>, causing <strong>hypoglycemia</strong>, <strong>ketosis</strong> and high anion gap metabolic <strong>acidosis</strong>. They also <strong>inhibit the urea cycle</strong>, causing <strong>hyperammonemia</strong>. Patients usually present in infancy with vomiting, poor feeding, hypotonia and seizures. Treatment is mainly by reducing those substances in diet which can get metabolized to form propionyl-CoA or methylmalonyl-CoA. This includes valine, odd-chain fatty acids, methionine, isoleucine and threonine. Carnitine supplementation is also often required. </span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d7364ea8ae2d46cd956b557bdcc91befx600x647.JPEG"
    ]
  },
  {
    "text": "A 3-day-old male newborn is admitted to the hospital because of lethargy and poor feeding. His condition progressively deteriorates and he is now in a coma. Serum ammonia levels are found to be elevated and urine shows the presence of orotic acid. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Orotic aciduria"
      },
      {
        "id": 2,
        "text": "Propionic acidemia"
      },
      {
        "id": 3,
        "text": "Ornithine transcarbamoylase deficiency"
      },
      {
        "id": 4,
        "text": "Medium-chain acyl-CoA dehydrogenase deficiency"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of a <strong>male</strong> <strong>newborn</strong> presenting with features of <strong>hyperammonemia</strong> (lethargy, poor feeding, seizures) along with <strong>elevated</strong> <strong>serum ammonia</strong> levels and <strong>orotic aciduria</strong> is suggestive of <strong>ornithine transcarbamoylase (OTC) deficiency</strong>.&nbsp;</p>\n<p>OTC catalyzes the conversion of carbamoyl phosphate and ornithine to citrulline. OTC deficiency is an <strong>X-linked recessive</strong> disorder. Clinical manifestations vary in severity from lethargy to encephalopathy and coma. Confirmatory tests for OTC deficiency include analyzing the plasma amino acid profile, which will show a <strong>low citrulline level</strong>, and <strong>increased glutamate</strong> and <strong>alanine</strong>. <strong>Urine</strong> shows the presence of <strong>orotic acid.</strong></p>\n<p>Other options:</p>\n<p>Option A: <strong>Orotic aciduria</strong> occurs due to a <strong>defect</strong> in the enzyme <strong>UMP synthase</strong> (de-novo pyrimidine synthesis pathway). This leads to elevation of orotic acid in the blood and the urine. The clinical manifestations include failure to thrive, developmental delay, and <strong>megaloblastic anaemia</strong> <strong>refractory to folate and vitamin B12 supplementation</strong>. There is <strong>no</strong> <strong>hyperammonemia</strong>, which is seen in OTC deficiency. The treatment consists of administrating <strong>uridine</strong> to bypass the deficient enzyme.&nbsp;</p>\n<p>Option B: Propionic acidemia presents with hyperammonemia, hypoglycemia, ketosis, and metabolic acidosis. There will be no orotic acid in the urine.&nbsp;</p>\n<p>Option D: Medium-chain acyl-CoA dehydrogenase deficiency presents with hyperammonemia and hypoketotic hypoglycemia. There will be no orotic acid in the urine.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An infant was brought to the pediatrics department with a history of passing foul-smelling and greasy stools. A small intestine biopsy was taken and is shown below. The peripheral smear showed acanthocytes. Which of the following is unlikely to be deficient in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "LDL"
      },
      {
        "id": 2,
        "text": "HDL"
      },
      {
        "id": 3,
        "text": "VLDL"
      },
      {
        "id": 4,
        "text": "Chylomicron"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of an infant presenting with <strong>steatorrhea</strong>, <strong>acanthocytosis</strong> on peripheral smear and histopathological slide showing<strong> lipid-laden enterocytes&nbsp;</strong>is most likely to be <strong>abetalipoproteinemia</strong>. Abetalipoproteinemia is a rare&nbsp;<strong>autosomal recessive</strong> disease. It is caused due to the <strong>mutation in microsomal triglyceride transfer protein (MTTP)</strong>. MTTP is necessary to transfer lipids to nascent chylomicrons in the small intestine and to VLDL in the liver. In abetalipoproteinemia, there is an <strong>absence of chylomicrons, VLDL, LDL</strong> (<strong>apoB</strong> containing lipoproteins), and deficient levels of plasma cholesterol and triglycerides.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/852e4f838f4d4337819cb283156a2dce.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/60ffdd80c7fc4a239628d5825d0af8cdx1280x1573.JPEG",
      "https://cdn1.dailyrounds.org/uploads/fbf1f3e25b1c428fac8cfcbaee1e5773.JPEG"
    ]
  },
  {
    "text": "A 26-year-old man presented to the ED with a history of severe retrosternal chest pain. His serum cholesterol levels were 380 mg/dL. Despite appropriate resuscitative efforts, the patient did not survive. The given image shows his abdominal aorta at the time of the autopsy. Which of the following correctly describes the pathogenesis of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Defective LDL receptors"
      },
      {
        "id": 2,
        "text": "Deficiency of lipoprotein lipase"
      },
      {
        "id": 3,
        "text": "Absent ApoE"
      },
      {
        "id": 4,
        "text": "Mutation in microsomal transfer protein"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given clinical scenario of a <strong>young patient</strong> with grossly <strong>elevated serum cholesterol</strong>, accelerated <strong>atherosclerosis</strong> (as shown in the image of the aorta), and symptoms suggestive of <strong>myocardial infarction</strong>, a diagnosis of <strong>familial hypercholesterolemia</strong> (type II hyperlipoproteinemia) is likely. In this disorder, there is a <strong>reduction</strong> <strong>in the activity of the LDL receptor</strong>.&nbsp;</p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Familial hypercholesterolemia is an <strong>autosomal dominant</strong> disorder caused due to mutations that reduce the functioning of LDL receptors, the most common being a <strong>mutation in the LDLR gene</strong> itself. Physical findings present in some of the patients include <strong>tendon xanthomas</strong> (especially involving the <strong>Achilles tendons</strong>) and <strong>corneal arcus</strong>. These patients may have a <strong>myocardial infarction</strong> at a young age. </span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Diagnosis is usually established based on biochemical tests. <strong>LDL cholesterol &gt;190 mg/dL</strong> or <strong>total serum cholesterol &gt;300 mg/dL</strong> without any secondary etiology should point to a diagnosis of familial hypercholesterolemia. Homozygotes for the disease might have total serum cholesterol even up to 1000 mg/dL. </span></p>\n<p id=\"viewer-enti0\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Treatment includes restriction of saturated and trans fats in the diet and <strong>high-intensity statin therapy</strong>. If adequate control is not achieved with statins alone, a <strong>cholesterol absorption inhibitor (Ezetimibe)</strong> or a <strong>PCSK9 inhibitor (Alirocumab, Evolocumab)</strong> can be added to the treatment. </span></p>\n<div id=\"viewer-561h8\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"></div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e7c8e457cf47493a81f8b3f69d04eed3.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following is defective in Zellweger syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "\u03b2 oxidation of very-long-chain fatty acids"
      },
      {
        "id": 2,
        "text": "\u03b1 oxidation of unbranched fatty acids"
      },
      {
        "id": 3,
        "text": "\u03b2 oxidation of medium chain fatty acids"
      },
      {
        "id": 4,
        "text": "\u03c9 oxidation of medium chain fatty acids"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Zellweger syndrome is due to <strong>defective</strong> biogenesis of <strong>peroxisomes</strong>. <strong>&beta; oxidation of very long-chain fatty acids&nbsp;</strong>is defective in <strong>Zellweger syndrome.</strong></p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Zellweger syndrome is an autosomal recessive disorder caused by <strong>mutations</strong> in the <strong>PEX</strong> family of genes. Affected newborns show a typical facial appearance consisting of a <strong>high forehead</strong>, <strong>hypoplastic supraorbital ridges</strong>, and <strong>epicanthic folds</strong>. They also have <strong>hypotonia</strong> and neonatal seizures. Patients with Zellweger syndrome often do not survive beyond the first year of life.</span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Defect in peroxisomal structure causes metabolic pathways which are <strong>exclusive to peroxisome</strong> to be affected. These include:</span></p>\n<ul>\n<li class=\"Y9Dpf OZy-3 lnyWN yMZv8w bCMSCT\"><strong>&beta; oxidation of very-long-chain fatty acids</strong></li>\n<li class=\"Y9Dpf OZy-3 lnyWN yMZv8w bCMSCT\"><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">&alpha; oxidation of branched-chain fatty acids </strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">(such as phytanic acid)</span></li>\n<li class=\"Y9Dpf OZy-3 lnyWN yMZv8w bCMSCT\">Synthesis of bile acids and plasmalogens</li>\n</ul>\n<p>There is currently <strong>no</strong> <strong>cure</strong> for Zellweger syndrome, and treatment is generally supportive and focused on managing symptoms and improving quality of life.</p>\n<div id=\"viewer-e9nf8\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"></div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a newborn with a deficiency of pyruvate dehydrogenase enzyme complex, which of the following should be given in the diet?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 5"
      },
      {
        "id": 2,
        "text": "2, 3, 4"
      },
      {
        "id": 3,
        "text": "1, 2, 5"
      },
      {
        "id": 4,
        "text": "1 only"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Since pyruvate dehydrogenase enzyme complex deficiency causes a defect in glucose utilization, <strong>ketogenic</strong> <strong>substances</strong> like <strong>fatty acids</strong>, and amino acids like <strong>leucine</strong> and <strong>lysine</strong> should be given in the diet.</p>\n<p><strong>Pyruvate dehydrogenase enzyme</strong> complex catalyzes the oxidation of <strong>pyruvate to acetyl-CoA</strong>, which then enters the tricarboxylic acid (TCA) cycle for ATP production. A deficiency of this enzyme complex causes a <strong>buildup of pyruvate</strong>, which is then shunted to form <strong>alanine</strong> (via ALT) and <strong>lactate</strong> (via lactate dehydrogenase).</p>\n<p>The disease is characterized by severe <strong>lactic acidosis</strong> and cystic lesions in the white matter of the brain. Giving ketogenic substances in the diet, such as fatty acids, leucine, and lysine decreases the blood lactate level in the patients.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A deficiency of the enzyme which catalyzes the given step will lead to which of the following disorders?",
    "choices": [
      {
        "id": 1,
        "text": "Tay-Sachs disease"
      },
      {
        "id": 2,
        "text": "Gaucher disease"
      },
      {
        "id": 3,
        "text": "Niemann-Pick disease"
      },
      {
        "id": 4,
        "text": "Von Gierke disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The step marked in the given image, conversion of <strong>GM2 ganglioside to GM3 ganglioside</strong>, is catalyzed by <strong>hexosaminidase</strong> <strong>A</strong>. Deficiency of hexosaminidase A enzyme leads to <strong>Tay-Sachs disease.</strong></p>\n<p>Tay-Sachs disease is an <strong>autosomal recessive</strong> lysosomal storage disorder. It is characterized by the <strong>accumulation of GM2 ganglioside</strong>. Clinical features include progressive neurodegeneration, developmental delay, and a <strong>cherry red spot on the macula</strong>. There is <strong>no hepatosplenomegaly</strong>, as is seen in Niemann-Pick disease.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b4c7bfca356447588733e3b017e70a36.JPEG"
    ],
    "explanation_images": [
      "https://trello.com/1/cards/6454e9242a203acc10a9f98d/attachments/64676893243114a2cc06663b/previews/64676893243114a2cc0666b9/download/113514.jpg"
    ]
  },
  {
    "text": "A patient presents with right-sided flank pain and hematuria. The microscopic examination of his urine specimen is shown below. A diet low in which of the following amino acids could theoretically be beneficial for the patient?",
    "choices": [
      {
        "id": 1,
        "text": "Arginine"
      },
      {
        "id": 2,
        "text": "Lysine"
      },
      {
        "id": 3,
        "text": "Ornithine"
      },
      {
        "id": 4,
        "text": "Methionine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario of a patient presenting with right-sided flank pain, hematuria and <strong>hexagonal crystals</strong> on microscopic examination of the urine points to the diagnosis of <strong>cystine stones</strong>. A <strong>diet</strong> <strong>low in methionine</strong> may theoretically reduce the urinary excretion of cystine.</p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Cystinuria</strong> occurs due to a hereditary <strong>defect in an amino acid transporter</strong> in the renal proximal convoluted tubule and intestine. This prevents the reabsorption of amino acids like <strong>cystine</strong>,<strong> ornithine</strong>,<strong> lysine</strong>, and<strong> arginine</strong>. The only known complication of this disease is the formation of <strong>calculi,</strong> because of the low solubility of cystine in the urine. Cystine is more likely to precipitate in acidic urine. </span></p>\n<p id=\"viewer-6t8rp\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Prevention of stone formation in patients with cystinuria can be done by <strong>increasing fluid intake</strong> and <strong>alkalinization</strong> of the urine with sodium bicarbonate or sodium citrate. Chelating agents such as <strong>penicillamine</strong> have also been found to be useful. <strong>Tiopronin</strong> is currently the <strong>best choice</strong> drug for cystine reduction, but side effects like nephrotic syndrome may limit its long-term use. A <strong>diet low in methionine</strong> may theoretically reduce the excretion of cystine in the urine by directly reducing its formation. </span></p>\n<div id=\"viewer-165jr\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"></div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1995b8675ae645eb966248a491e5580d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient was diagnosed to have a deficiency of the enzyme which catalyzes the given metabolic step. Which of the following statements is not true about this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Tandem mass spectrometry is the screening test of choice in newborns"
      },
      {
        "id": 2,
        "text": "Can present with macrocephaly and intellectual disability"
      },
      {
        "id": 3,
        "text": "Mainstay of treatment is low phenylalanine diet"
      },
      {
        "id": 4,
        "text": "Inherited in autosomal recessive pattern"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The enzyme that catalyzes the conversion of <strong>phenylalanine to tyrosine</strong> is <strong>phenylalanine hydroxylase enzyme.</strong> The deficiency of this enzyme leads to <strong>phenylketonuria</strong>. Phenylketonuria presents with <strong>microcephaly </strong>and<strong> intellectual disability.</strong></p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Phenylketonuria </strong>is an <strong>autosomal recessive</strong> inborn error of metabolism, due to the deficiency of an enzyme <strong>phenylalanine hydroxylase </strong>or its cofactor <strong>tetrahydrobiopterin</strong>. The deficiency of this enzyme leads to the accumulation of phenylalanine in the body fluids and the brain. The excess phenylalanine in the blood is metabolized to phenyl ketones, namely, <strong>phenylpyruvate</strong> and <strong>phenylacetate</strong>, which are excreted in the urine. </span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Phenylacetate</strong> gives rise to the characteristic <strong>mousy odour </strong>in the skin and urine in PKU. </span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Other characteristic clinical findings include:</span></p>\n<ul>\n<li class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\">Affected infants are <strong>lighter in complexion</strong></li>\n<li class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Neurological</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">abnormalities</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> like seizures, spasticity and hyperreflexia</span></li>\n<li class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Microcephaly</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> and growth retardation</span></li>\n</ul>\n<p id=\"viewer-escuo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Tandem mass spectroscopy </strong>is the screening method of choice and a <strong>low phenylalanine diet</strong> forms the mainstay of treatment.</span></p>\n<div id=\"viewer-44ccd\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"></div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c92ae6a00a0846b39b5e366eab84bc0d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 4-year-old boy presents with a rash on sun-exposed areas of the body and a history of ataxia and diarrhea. His urine shows the presence of only neutral amino acids. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hartnup disorder"
      },
      {
        "id": 2,
        "text": "Fanconi syndrome"
      },
      {
        "id": 3,
        "text": "Phenylketonuria"
      },
      {
        "id": 4,
        "text": "Vitamin B12 deficiency"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In a patient with manifestations of pellagra (rash in sun-exposed areas, ataxia, and psychiatric manifestations) along with the presence of neutral amino-aciduria, a diagnosis of <strong>Hartnup disorder</strong> is the most likely.&nbsp;&nbsp;</p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Hartnup disorder is an <strong>autosomal recessive</strong> disorder due to a defect in the transporter for <strong>neutral amino acids</strong> like <strong>tryptophan</strong>. Decreased intestinal absorption of tryptophan in conjunction with its increased renal loss leads to its reduced bioavailability. This <strong>hampers</strong> <strong>niacin</strong> <strong>synthesis</strong>, and Hartnup disorder can thus present with manifestations of niacin deficiency (<strong>pellagra</strong>) like diarrhea, dermatitis and dementia.</span></p>\n<p id=\"viewer-1m748\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">The major clinical manifestation is<strong> cutaneous photosensitivity</strong>. The skin becomes erythematous after sun-exposure, and might develop a <strong>pellagra-like rash</strong> and eczema over time. Some patients might have <strong>intermittent ataxia</strong> manifested as unsteady, wide-based gait. Cognitive development is usually normal, but there may be <strong>episodic psychiatric manifestations</strong> such as irritability, emotional instability and depression. </span></p>\n<p id=\"viewer-blu1k\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">The diagnosis of Hartnup disorder is established by typical clinical history and the <strong>presence of neutral amino acids in the urine</strong>. <strong>Urinary excretion of other amino acids remains normal</strong>, which differentiates it from causes of generalized aminoaciduria like Fanconi syndrome.</span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"> Indole derivates like indican may be found in large amounts in some patients due to bacterial breakdown of unabsorbed tryptophan in the intestines. This causes the <strong>Obermeyer test</strong> to be <strong>positive</strong>. Treatment with nicotinamide and a high-protein diet gives a good response in symptomatic patients.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A baby is brought to the OPD with complaints of lethargy and poor feeding. On examination, it is noted that the urine had a smell of burnt sugar. A defect in which of the following enzymes causes this disease?",
    "choices": [
      {
        "id": 1,
        "text": "Branched-chain ketoacid dehydrogenase"
      },
      {
        "id": 2,
        "text": "Branched-chain amino acid dehydrogenase"
      },
      {
        "id": 3,
        "text": "Branched-chain ketoacid oxidase"
      },
      {
        "id": 4,
        "text": "Branched-chain amino acid oxidase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The diagnosis, in this case, is that of <strong>maple syrup urine disease\u00a0</strong>(MSUD).\u00a0This disease occurs due to a defect of the enzyme\u00a0<strong>branched-chain keto acid dehydrogenase.</strong></p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">MSUD is an <strong>autosomal recessive</strong> disorder that occurs due to a <strong>deficiency</strong> of <strong>branched-chain ketoacid dehydrogenase</strong> <strong>complex</strong>. This impairs the metabolism of branched-chain amino acids <strong>valine</strong>, <strong>leucine</strong>, <strong>isoleucine</strong>, and <strong>alloisoleucine</strong>. These amino acids, particularly <strong>leucine</strong> and its metabolite accumulate in the blood, causing toxic effects on the brain.</span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">The affected child develops <strong>poor feeding</strong> and <strong>vomiting</strong> a few days after birth. There is a period of hypertonicity with a period of flaccidity in between. These appear as repetitive <strong>boxing</strong> and<strong> bicycling</strong> <strong>movements</strong>. The babies may also have <strong>hypoglycemia</strong>, but this is <strong>not corrected </strong>by the administration of <strong>glucose</strong>. The <strong>urine</strong>, <strong>sweat</strong>, and <strong>cerumen</strong> of the baby have a <strong>sweetish</strong> maple syrup-like odor.</span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Laboratory investigations will show <strong>increased</strong> levels<strong> </strong>of <strong>branched-chain amino acids</strong> in the plasma and urine. <strong>Leucine</strong> levels are usually higher than isoleucine, valine, and alloisoleucine. Since the patient excretes ketone bodies in the urine, the urine will be positive for the <strong>dinitrophenylhydrazine test</strong>.</span></p>\n<p id=\"viewer-enikm\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Treatment involves controlled intake of branched-chain amino acids using commercially available formulas and judicious supplementation of isoleucine and valine. Very high levels of leucine are removed by <strong>hemodialysis</strong>.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A father reports to a pediatrician with his daughter stating that she has episodes of lethargy, irritability, and vomiting right after she drinks any fruit juice. Urinalysis after such an episode showed that Benedict's test is positive. Which of the following enzyme deficiency is likely?",
    "choices": [
      {
        "id": 1,
        "text": "Aldolase B"
      },
      {
        "id": 2,
        "text": "Fructokinase"
      },
      {
        "id": 3,
        "text": "Glucose 6-phosphatase"
      },
      {
        "id": 4,
        "text": "Hexokinase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given case scenario with symptoms occurring after ingesting fruit juices (containing fructose) points to the diagnosis of\u00a0<strong>hereditary fructose intolerance</strong>, and<strong> aldolase\u00a0B </strong>enzyme deficiency seen here.</p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Fructose-1,6- bisphosphate aldolase/ aldolase B </strong>is present in the liver, kidney, and intestine. It catalyzes the hydrolysis of fructose-1,6-bisphosphate into triose phosphate and glyceraldehyde phosphate. It also hydrolyzes <strong>fructose-1-phosphate</strong>.</span></p>\n<p id=\"viewer-7454k\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Hereditary fructose intolerance is an <strong>autosomal recessive</strong> condition, caused by pathogenic variations in the <strong>ALDOB </strong>gene which causes aldolase deficiency.</span></p>\n<p id=\"viewer-2ho57\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Patients are <strong>asymptomatic</strong> <strong>until fructose or sucrose</strong> is <strong>ingested</strong> (usually from fruit, fruit juice, sweetened cereal, or table sugar). It usually presents during <strong>infancy</strong> when sugar-containing feeds are introduced, but some patients (who are less sensitive) can present at older ages as well.</span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"> Clinical features include jaundice, hepatomegaly, vomiting, lethargy, irritability, and convulsions. <strong>Acute</strong> ingestion causes <strong>symptomatic hypoglycemia</strong>.<strong> Chronic</strong> intake results in <strong>failure to thrive, hepatic disease, kidney failure, </strong>and<strong> death</strong>.</span></p>\n<p id=\"viewer-55g84\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Reducing substance</strong> is seen in the <strong>urine</strong> during an episode (<strong>Benedict's test positive</strong>) as fructose is a reducing sugar. <strong>Reduced levels of</strong> <strong>fructaldolase B activity</strong> in the <strong>liver </strong>and demonstration of two pathogenic variants in ALDOB on molecular genetic testing give a <strong>definitive diagnosis.</strong></span></p>\n<p id=\"viewer-6mbgm\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Treatment involves <strong>complete</strong> <strong>cessation</strong> of all sources of sucrose, fructose, and sorbitol from the diet.</span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">The image summarizes the metabolic pathways involved in the metabolism of fructose. </span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5f39f85ceb46421fbc5a2811f429bb43x1280x1703.JPEG"
    ]
  },
  {
    "text": "An exclusively breastfed newborn was brought with vomiting and diarrhea that developed since birth. On examination, the baby is jaundiced and has hepatomegaly. Blood glucose level was low and erythrocyte galactose-1-phosphate level was elevated. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Fructosuria"
      },
      {
        "id": 2,
        "text": "von Gierke's disease"
      },
      {
        "id": 3,
        "text": "Classical galactosemia"
      },
      {
        "id": 4,
        "text": "Hereditary fructose intolerance"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of an exclusively breastfed infant with vomiting, diarrhea, jaundice, hypotonia, and hepatomegaly with elevated erythrocyte galactose-1-phosphate level is suggestive of <strong>classical galactosemia.</strong></p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Classical galactosemia </strong>is an autosomal recessive disorder.<strong> </strong>The enzyme deficient here is <strong>galactose-1-phosphate uridyl transferase </strong>(GALT).<strong> </strong>Normally, newborns receive up to 40% of their calorie intake as lactose (glucose + galactose). Without GALT, the infant cannot metabolize <strong>galactose 1-phosphate, </strong>which accumulates and causes injury to the kidney, liver, and brain.</span></p>\n<p id=\"viewer-cule6\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Clinical features include <strong>vomiting, hypoglycemia,</strong> hepatomegaly, jaundice, congenital cataracts, aminoaciduria, and <strong>failure to thrive</strong>. There is an increased incidence of <em>Escherichia coli</em> neonatal <strong>sepsis</strong>. Long-term <strong>complications</strong> include speech delays, learning impairment, motor dysfunction, and hypogonadotropic hypogonadism (in females).</span></p>\n<p id=\"viewer-520qv\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">The presence of galactose in urine (positive Benedict's test), elevated blood galactose level, and elevated erythrocyte galactose-1-phosphate level help in confirming the diagnosis.</span></p>\n<p id=\"viewer-7bi4u\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Treatment is a <strong>galactose-free diet</strong>. Supportive therapy and the prevention of complications are important.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/273ae933e27941edbdbe9e4f99d5dbe6x1280x1129.JPEG"
    ]
  },
  {
    "text": "A 35-year-old male patient complains of reduced mobility of the spine & hip and knee joint pain. On examination, bluish-black discoloration of the sclera and ear cartilage was found. The thoracolumbar spine CT showed flattened & calcified intervertebral discs, and the urine sample turned black on standing. This condition is seen due to the deficiency of enzyme _______.",
    "choices": [
      {
        "id": 1,
        "text": "Tyrosine transaminase"
      },
      {
        "id": 2,
        "text": "Homogentisate oxidase"
      },
      {
        "id": 3,
        "text": "Fumarylacetoacetate hydrolase"
      },
      {
        "id": 4,
        "text": "4-hydroxy-phenyl pyruvate dioxygenase"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The given clinical scenario is suggestive of <strong>Alkaptonuria</strong>,\u00a0caused due to the deficiency of\u00a0<strong>homogentisate oxidase\u00a0</strong>enzyme.</p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Alkaptonuria is an autosomal recessive disorder of <strong>tyrosine metabolism</strong>, that develops due to the defect in <strong>homogentisate oxidase/ homogentisic acid 1, 2 - dioxygenase</strong>, which oxidizes homogentisate to maleylacetoacetate. The defect in this enzyme leads to the accumulation of homogentisate, which is then excreted in the urine. </span></p>\n<p id=\"viewer-bkasa\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Alkaptonuria is characterized by <strong>homogentisic aciduria</strong>, <strong>ochronosis,</strong> and <strong>arthropathy</strong> (joint pain).</span></p>\n<p id=\"viewer-1s8np\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Homogentisic aciduria</strong> is the black discolouration of urine on prolonged exposure to air caused due to oxidation of the excreted homogentisate. <strong>Ochronosis</strong>, which is <strong>bluish-black pigmentation</strong> in connective tissue; generally occurs after the third decade of life and it occurs due to the accumulation of homogentisic acid and its oxidation products like benzoquinone acetic acid in connective tissue.</span></p>\n<p id=\"viewer-6c7fv\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Arthritis</strong> generally begins in the third decade. Arthritis often begins in the <strong>spine</strong> and resembles ankylosing spondylitis in its large-joint distribution. Radiographs of the spine showing <strong>flattened</strong> and <strong>calcified intervertebral discs</strong> are pathognomonic. Other findings include degeneration of the intervertebral discs followed by disc calcification and eventually fusion of the vertebral bodies. Osteophyte formation and calcification of the intervertebral ligaments also occur.</span></p>\n<p id=\"viewer-a3uk9\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Diagnosis: <strong>Blackish discoloration</strong> of <strong>urine</strong> on standing is diagnostic of alkaptonuria (shown below). The ferric chloride test<strong> </strong>will be positive.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/91b800ba6e0a4bbaa9233c2073b86841x512x358.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5c2138e0a3be4956a6f97c4e46460777x408x267.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f24c19e813e4bad9c612beb6c866c97x972x1198.JPEG"
    ]
  },
  {
    "text": "A 9-year-old boy is brought to the pediatrician by his mother with complaints of self-biting his lips and nails. On examination, the child has delayed developmental milestones, spasticity, and dystonia. Nail findings are as shown in the image below. Laboratory investigations reveal elevated uric acid levels. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Autism"
      },
      {
        "id": 2,
        "text": "Lesch-Nyhan disease"
      },
      {
        "id": 3,
        "text": "Severe combined immunodeficiency"
      },
      {
        "id": 4,
        "text": "Tourette\u2019s disorder"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical scenario with the image showing <strong>self-mutilation</strong> and laboratory values showing <strong>hyperuricemia</strong> is most likely suggestive of <strong>Lesch-Nyhan disease</strong>.</p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Lesch-Nyhan syndrome is an <strong>X-linked recessive</strong> disorder due to a complete deficiency of the hypoxanthine-guanine phosphoribosyltransferase (<strong>HGPRT</strong>). This deficiency results in an <strong>inability to salvage</strong> hypoxanthine or guanine leading to <strong>increased levels of phospho-ribosyl pyrophosphate (PRPP). </strong>Increased PRPP leads to increased purine synthesis, which is later degraded to <strong>uric acid</strong>. Increased hypoxanthine is also converted to uric acid.</span></p>\n<p id=\"viewer-243m5\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">The patients have <strong>intellectual disability</strong>, behaviors of <strong>self-injury</strong> like lip and finger biting, <strong>developmental delay</strong>, <strong>muscle dystonia,</strong> and extrapyramidal symptoms. </span></p>\n<p id=\"viewer-81sla\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Diagnosis is made by the <strong>elevated</strong> levels of <strong>uric acid</strong> and by HGPRT enzyme assay.</span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">The image given below shows the metabolism of hypoxanthine and guanine by HGPRT.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/244dc955ba19426e96661cb2e34bfe39.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d295845ea4924b19ab07ca33a23f65bex1280x1203.JPEG"
    ]
  },
  {
    "text": "Which of the following is least likely to be seen in a patient with McArdle's disease?",
    "choices": [
      {
        "id": 1,
        "text": "Presentation in the first year of life"
      },
      {
        "id": 2,
        "text": "Exercise-induced muscle cramps"
      },
      {
        "id": 3,
        "text": "Second-Wind phenomenon"
      },
      {
        "id": 4,
        "text": "Myoglobinuria secondary to rhabdomyolysis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>McArdle disease, also known as <strong>type V</strong> glycogen storage disorder is an <strong>autosomal recessive</strong> condition. It typically presents during<strong> late childhood</strong> or in the <strong>second decade</strong> of life. The\u00a0muscle glycogen phosphorylase enzyme deficiency interferes with ATP generation by glycogenolysis in the muscles. This causes muscle <strong>glycogen accumulation</strong>.</p>\n<p>Symptoms are <strong>exercise intolerance</strong> associated with <strong>muscle cramps</strong>. A <strong>second-wind phenomenon</strong> where the symptoms subside after a short period of rest can also be seen. <strong>Myoglobinuria</strong> secondary to<strong> rhabdomyolysis</strong> leads to the passage of <strong>burgundy-colored urine</strong> in some patients.\u00a0</p>\n<p>Rarely, it can present during infancy as hypotonia, muscle weakness, and respiratory complications. It is generally fatal.\u00a0<strong>Muscle biopsy</strong> to measure glycogen content is the standard diagnosis. Avoiding strenuous exercise prevents symptoms. Glucose administration before exercise can improve tolerance. <strong>Vitamin B6</strong> is also recommended.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old male child has delayed developmental milestones and intellectual disability, with the following appearance (image A). On further examination, there is an enlarged tongue, cloudy cornea, and hepatomegaly. A radiograph of the hand is shown in image B. A girl born in their family also had similar symptoms and she died at 9 years of age. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Scheie syndrome"
      },
      {
        "id": 2,
        "text": "Hurler-Scheie syndrome"
      },
      {
        "id": 3,
        "text": "Hurler syndrome"
      },
      {
        "id": 4,
        "text": "Hunter syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most likely diagnosis is <strong>Hurler syndrome.\u00a0</strong>The child is <strong>2 years</strong> of age and has <strong>coarse facial features</strong> like a depressed nasal bridge, thick lips, and an open mouth with protruded tongue. The radiograph shows <strong>enlarged diaphyses</strong> of the metacarpals and phalanges. These features along with severe <strong>developmental delay</strong>, <strong>cloudy cornea</strong>, hepatomegaly, and<strong>\u00a0intellectual\u00a0disability</strong> suggest that the child has <strong>Hurler syndrome</strong>.</p>\n<p id=\"viewer-foo\" class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Hurler syndrome</strong> is a <strong>severe</strong> type of mucopolysaccharidoses <strong>(MPS) I</strong>. It is caused due to deficiency of <strong>\u03b1-L-iduronidase. </strong>This enzyme is required for the breakdown of dermatan and heparan sulfate. The deficiency of the enzyme leads to the accumulation of these mucopolysaccharides. </span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">Patients usually present between <strong>6-24 months</strong> of age. They have</span></p>\n<ul>\n<li class=\"Y9Dpf OZy-3 lnyWN yMZv8w bCMSCT\"><strong>Intellectual disability</strong></li>\n<li class=\"Y9Dpf OZy-3 lnyWN yMZv8w bCMSCT\"><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Skeletal dysplasia,</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> called dysostosis multiplex- thick ribs, ovoid vertebral bodies,</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> enlarged diaphyses</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> of the long bones, macrocephaly, enlarged </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">J-shaped sella</strong></li>\n<li class=\"Y9Dpf OZy-3 lnyWN yMZv8w bCMSCT\"><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Cloudy cornea</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">, glaucoma, retinal degeneration</span></li>\n<li class=\"Y9Dpf OZy-3 lnyWN yMZv8w bCMSCT\">Mixed hearing loss, etc</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: The <strong>Scheie syndrome</strong>\u00a0is a milder form of MPS-I (MPS I-S ). The symptoms appear <strong>after 5 years</strong> of age and the diagnosis is made between 10-20 years. It is characterized by <strong>normal intelligence</strong> and stature, joint stiffness, aortic valve disease, corneal clouding, and mild dysostosis multiplex. Ophthalmic and cardiac involvement might be present.</p>\n<p>Option\u00a0B:\u00a0<strong>Hurler-Scheie syndrome</strong> is an intermediate between Hurler syndrome and\u00a0Scheie syndrome. The onset of symptoms is between <strong>3-8 years of</strong> age. They have <strong>mild</strong> or <strong>no intellectual dysfunction</strong>.\u00a0Ophthalmic and cardiac involvement might be present.</p>\n<p>Option D:\u00a0<strong>Hunter syndrome</strong> is a <strong>type II MPS.\u00a0</strong>It occurs due to the deficiency of <strong>iduronate 2-sulfatase.\u00a0</strong>It shares the same features as type I MPS like coarse facial features, short stature, and dysostosis multiplex. However, there is <strong>no corneal clouding.\u00a0</strong>It is the only MPS with <strong>X-linked recessive</strong> inheritance. So if a\u00a0baby girl is affected in the family, it is less likely to be Hunter syndrome. All the other MPS are autosomal recessive.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f19e63c005e241d3a04271c430d53b32.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 5-month-old child presents with mild diarrhea for the past 3 days. Today, he developed severe lethargy and had an episode of seizures. Laboratory testing reveals hypoketotic hypoglycemia. Deficiency of which of the following enzymes could produce this kind of test result?",
    "choices": [
      {
        "id": 1,
        "text": "Medium-chain acyl CoA dehydrogenase"
      },
      {
        "id": 2,
        "text": "Phenylalanine hydroxylase"
      },
      {
        "id": 3,
        "text": "UMP synthase"
      },
      {
        "id": 4,
        "text": "HMG CoA reductase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This child, with lethargy, seizures, and hypoketotic hypoglycemia, is likely to have <strong>medium-chain acyl CoA dehydrogenase deficiency</strong>.</p>\n<p><span class=\"B2EFF public-DraftStyleDefault-ltr\"><strong>Medium-chain acyl CoA dehydrogenase (MCAD) deficiency</strong> is a disroder associated with <strong>mitochondrial fatty acid beta-oxidation</strong>. It is one of the most common<strong> inborn errors of metabolism</strong>. MCAD is an important enzyme involved in <strong>fatty acid beta-oxidation</strong>, which is important in producing\u00a0<strong>ketone bodies</strong> as an energy source when blood glucose levels are low.</span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">It is usually diagnosed at birth during routine screening for disorders of the newborn. However, sometimes, it can be detected <strong>within</strong> the <strong>first two years of life</strong>. </span><span class=\"B2EFF public-DraftStyleDefault-ltr\">These babies present with <strong>vomiting</strong> that progresses to <strong>lethargy</strong> and <strong>seizures triggered by mild illness</strong>. The common laboratory results seen in these patients result from a failure to synthesize ketone bodies during episodes of hypoglycemia. Hence, the child will present with <strong>hypoketotic hypoglycemia</strong>. </span></p>\n<p class=\"xVISr Y9Dpf bCMSCT OZy-3 lnyWN yMZv8w bCMSCT public-DraftStyleDefault-block-depth0 fixed-tab-size public-DraftStyleDefault-text-ltr\"><span class=\"B2EFF public-DraftStyleDefault-ltr\">The diagnosis can be confirmed with a combination of <strong>biochemical </strong>and <strong>genetic testing</strong>. This illness, once diagnosed, can be easily managed with <strong>small, frequent meals</strong>\u00a0to avoid a state of hypoglycemia. </span></p>\n<p>Other options:</p>\n<p>Option B:\u00a0<strong>Phenylalanine hydroxylase deficiency</strong> can result in <strong>phenylketonuria</strong>. This is an inborn error of metabolism in which phenylalanine is unable to convert to tyrosine, resulting in the <strong>accumulation of phenylalanine</strong>. This results in the characteristic<strong> 'musty' odor</strong> of the urine and body fluids. These children can also present with <strong>seizures </strong>and hyperactivity. In fact, many of the symptoms result from <strong>increased phenylpyruvate (a ketoacid)</strong> derived from the buildup of phenylalanine in this condition.</p>\n<p>Option C:<strong>\u00a0UMP synthase</strong> is an enzyme <strong>deficiency</strong> that results in <strong>orotic aciduria</strong>. This disorder is an <strong>inborn error of pyrimidine metabolism</strong> that presents with developmental delay, failure to thrive, and possibly epilepsy. Laboratory testing reveals <strong>pancytopenia.</strong>\u00a0\u00a0</p>\n<p>Option D:\u00a0<strong>HMG CoA reductase</strong> is an important enzyme involved in the <strong>synthesis of cholesterol.</strong> This enzyme is<strong> targeted by statins</strong>, which are prescribed in hypercholesterolemia and in patients at risk for cardiovascular events.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Metabolic Disorders Mini Test - -Tmt';
        const quizFilename = 'metabolic-disorders-mini-test-tmt-08b6d5a1.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>