<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>54 Previous Year Questions - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Anatomy
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">8</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>Which of the following nerves supplies the muscle that is involved in the moment given below?</p>\n\n<p><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"1000\" src=\"https://image.prepladder.com/content/1bLVTEFHwHdUIS6MWQc01747374011.png\" width=\"1000\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Spinal accessory nerve"
      },
      {
        "id": 2,
        "text": "Long thoracic nerve"
      },
      {
        "id": 3,
        "text": "Spinal branch of axillary nerve"
      },
      {
        "id": 4,
        "text": "Radial nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) <span class=\"customMeta\" data-dictid=\"d816ba952f1692777199fc69bd7c56\">Spinal</span> <span class=\"customMeta\" data-dictid=\"9088e1c7f616927771802e7f6d2541\">accessory</span> nerve</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The movement shown in the image is shrugging, which is carried out by the trapezius muscles and supplied by the <span class=\"customMeta\" data-dictid=\"d816ba952f1692777199fc69bd7c56\">spinal</span> <span class=\"customMeta\" data-dictid=\"9088e1c7f616927771802e7f6d2541\">accessory</span> nerve.</li>\n\t<li>Lesion of the <span class=\"customMeta\" data-dictid=\"9088e1c7f616927771802e7f6d2541\">accessory</span> nerve or <span class=\"customMeta\" data-dictid=\"72fa9105b916927771945aef35e8ed\">paralysis</span> of the trapezius leads to drooping of shoulders and difficulty in shrugging and weakness of overhead abduction.</li>\n</ul>\n\n<p><strong>Trapezius</strong></p>\n\n<ul>\n\t<li>Origin: Occipital bone and <span class=\"customMeta\" data-dictid=\"f140a27e12169277718407f79367c2\">cervicothoracic</span> spine</li>\n\t<li>Insertion: <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">Scapula</span> Bone and Clavicle</li>\n\t<li>Three sets of fiber:\n\t<ul>\n\t\t<li>Upper: Insertion on <span class=\"customMeta\" data-dictid=\"2cb340bacd169277718404028c7d00\">clavicle</span> (lateral 1/3posterior side)</li>\n\t\t<li>Middle: Insertion on <span class=\"customMeta\" data-dictid=\"7ce5726fb0169277718072972038ca\">acromion</span> process anteriorly</li>\n\t\t<li>Lower: Insertion on the spine of the scapula</li>\n\t</ul>\n\t</li>\n</ul>\n\n<ul>\n\t<li>Nerve Supply: <span class=\"customMeta\" data-dictid=\"9088e1c7f616927771802e7f6d2541\">Accessory</span> nerve (CN XI)</li>\n\t<li>Action:\n\t<ul>\n\t\t<li>Elevation (upper fiber) and depression (lower fiber)</li>\n\t\t<li>Retractor (Midline)</li>\n\t\t<li>Rotates the Glenoid <span class=\"customMeta\" data-dictid=\"ddba4206eb169277718335596e86da\">cavity</span> superiorly.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>Long <span class=\"customMeta\" data-dictid=\"3c6021096816927772007954fcc158\">thoracic</span> nerve (Option B): </strong>Supplies <span class=\"customMeta\" data-dictid=\"2462a1d0cf16927771985f03ba098b\">serratus</span> anterior, which is responsible for scapular <span class=\"customMeta\" data-dictid=\"f8ed049d7a1692777196e207fa6a42\">protraction</span> (not related to the given movement).</p>\n\n<p><strong>Spinal branch of axillary nerve (Option C): </strong>Supplies <span class=\"customMeta\" data-dictid=\"70d60276a81692777185b5f6f71fa9\">deltoid</span> and <span class=\"customMeta\" data-dictid=\"8ad930500b1692777200545684a556\">teres</span> minor, involved in shoulder <span class=\"customMeta\" data-dictid=\"69ae073b9f169277718021ae773099\">abduction</span> and <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> rotation.</p>\n\n<p><strong>Radial nerve (Option D):</strong> <strong> </strong>Innervates triceps, wrist extensors, and is involved in elbow extension and wrist extension.</p>",
    "question_images": [
      "https://image.prepladder.com/content/1bLVTEFHwHdUIS6MWQc01747374011.png"
    ],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What is the action of the muscle shown in the image below?</p>\n\n<p><img alt=\"Rhomboid major\" data-author=\"\" data-hash=\"11494\" data-license=\"\" data-source=\"\" data-tags=\"May2025\" height=\"521\" src=\"https://image.prepladder.com/notes/ugHaXHOvtPJyhnCuA46c1746167174.png\" width=\"450\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Retracts the scapula"
      },
      {
        "id": 2,
        "text": "Adduction of the shoulder"
      },
      {
        "id": 3,
        "text": "Extension of the shoulder"
      },
      {
        "id": 4,
        "text": "Medial rotation of the shoulder"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Retracts the scapula</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The muscle identified in the image is the <span class=\"customMeta\" data-dictid=\"0115afa2131692777197b45ae0d136\">rhomboid</span> major.</li>\n\t<li>Originating from the C7 and T1 vertebrae, it inserts along the <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">medial</span> border of the scapula.</li>\n\t<li>Primarily <span class=\"customMeta\" data-dictid=\"bf1b7e7049169277720354c306d716\">functioning</span> as a retractor, the <span class=\"customMeta\" data-dictid=\"0115afa2131692777197b45ae0d136\">rhomboid</span> major also plays roles in elevating the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> and rotating it to depress the <span class=\"customMeta\" data-dictid=\"7649bd0f191692777188dcdf91af69\">glenoid</span> cavity.</li>\n</ul>\n\n<table align=\"center\" cellspacing=\"0\" style=\"border-collapse:collapse\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p><strong>Muscle</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p><strong>Muscle connecting</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p><strong>Origin</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p><strong>Insertion</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p><strong>Action</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p><strong>Nerve supply</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Trapezius</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>vertebral column to scapula</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Spines of <span class=\"customMeta\" data-dictid=\"25c6ce766c1692777184ab9a40305c\">cervical</span> and <span class=\"customMeta\" data-dictid=\"3c6021096816927772007954fcc158\">thoracic</span> vertebrae</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>lateral 1/3\u200b of <span class=\"customMeta\" data-dictid=\"2cb340bacd169277718404028c7d00\">clavicle</span> + <span class=\"customMeta\" data-dictid=\"7ce5726fb0169277718072972038ca\">acromion</span> and spine of scapula</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Rotation of <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> during <span class=\"customMeta\" data-dictid=\"69ae073b9f169277718021ae773099\">abduction</span> of <span class=\"customMeta\" data-dictid=\"a547f4a22716927771897daf6b50e7\">humerus</span> above horizontal. It is made up of 3 fibers:</p>\n\n\t\t\t<p>1- Middle fibers: retract scapula</p>\n\n\t\t\t<p>2- Upper fibers: elevate scapula.</p>\n\n\t\t\t<p>3- Lower fibers: depress scapula.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Accessory nerve (11th <span class=\"customMeta\" data-dictid=\"6b7b5460171692777185e6e2475f8c\">cranial</span> nerve)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Rhomboid major & minor</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Vertebral column to scapula</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Thoracic spines</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Medial border of scapula.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Retract scapula.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Dorsal scapular nerve</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Levator scapulae</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Vertebral column to scapula</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Cervical <span class=\"customMeta\" data-dictid=\"a6260fa86416927772008d36bd7e5f\">transverse</span> processes</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Medial border of scapula</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Elevates scapula</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Dorsal scapular nerve</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Latissimus dorsi</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Vertebral column to Humerus</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Spines of <span class=\"customMeta\" data-dictid=\"3c6021096816927772007954fcc158\">thoracic</span> vertebrae</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Bicipital <span class=\"customMeta\" data-dictid=\"21ee3a5f911692777188099a3310c4\">groove</span> of humerus</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Extension, <span class=\"customMeta\" data-dictid=\"9efe7f9e921692777180ed75f4948a\">adduction</span> & <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">medial</span> <span class=\"customMeta\" data-dictid=\"8342f520cf1692777197dee4e4e5c3\">rotation</span> of humerus</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>Thoracodorsal nerve</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><img alt=\" Muscles of the Back 2\" data-author=\"\" data-hash=\"11550\" data-license=\"\" data-source=\"\" data-tags=\"May2025\" src=\"https://image.prepladder.com/notes/iGzg8vE2ZkUf0apamEIT1746185180.png\" /></p>",
    "question_images": [
      "https://image.prepladder.com/notes/ugHaXHOvtPJyhnCuA46c1746167174.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/iGzg8vE2ZkUf0apamEIT1746185180.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Match the following:</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:584px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p><strong>Muscle</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p><strong>Action</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>a. Pectoralis major</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>1. Extension at shoulder</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>b. Supraspinatus</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>2. Flexion at shoulder</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>c. Infraspinatus</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>3. Lateral rotation of shoulder</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>d. Latissimus dorsi</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>4. Abduction at shoulder</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "choices": [
      {
        "id": 1,
        "text": "a-4, b-3, c-2, d-1"
      },
      {
        "id": 2,
        "text": "a-4, b-2, c-3, d-1"
      },
      {
        "id": 3,
        "text": "a-2, b-4, c-1, d-3"
      },
      {
        "id": 4,
        "text": "a-2, b-4, c-3, d-1"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) a-2, b-4, c-3, d-1</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<p><strong>Correct Option: </strong>a-2, b-4, c-3, d-1</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:584px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p style=\"text-align: center;\"><strong>Muscle</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:1px solid black\">\n\t\t\t<p style=\"text-align: center;\"><strong>Action</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>a. Pectoralis major</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>2. Flexion at shoulder</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>b. Supraspinatus</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>4. <span class=\"customMeta\" data-dictid=\"69ae073b9f169277718021ae773099\">Abduction</span> at shoulder</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>c. Infraspinatus</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>3. <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">Lateral</span> <span class=\"customMeta\" data-dictid=\"8342f520cf1692777197dee4e4e5c3\">rotation</span> of shoulder</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none\">\n\t\t\t<p>d. Latissimus dorsi</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none\">\n\t\t\t<p>1. Extension at shoulder</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:805px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"5\" style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:1px solid black; vertical-align:top\">\n\t\t\t<p><strong>Muscles of the <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">Anterior</span> Axioappendicular Region</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Muscle</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Origin</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Insertion</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Nerve Supply</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Actions</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Pectoralis Major</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Anterior surface of the <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">medial</span> two-thirds of the clavicle</li>\n\t\t\t\t<li>Front of the <span class=\"customMeta\" data-dictid=\"7f52cf1a7f1692777191d49738d6b9\">manubrium</span> and <span class=\"customMeta\" data-dictid=\"a5428882a916927771992a8a0335bf\">sternum</span> up to the 6th <span class=\"customMeta\" data-dictid=\"ece2c20c001692777185d9ca0c08db\">costal</span> cartilages</li>\n\t\t\t\t<li>Second to sixth <span class=\"customMeta\" data-dictid=\"ece2c20c001692777185d9ca0c08db\">costal</span> cartilages and sternal end of the 6th rib</li>\n\t\t\t\t<li>Aponeurosis of the <span class=\"customMeta\" data-dictid=\"787b0ec4661692777187c06c757e51\">external oblique</span> muscle</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Lateral lip of the <span class=\"customMeta\" data-dictid=\"52b488edaa1692777183ab570a7885\">bicipital</span> <span class=\"customMeta\" data-dictid=\"21ee3a5f911692777188099a3310c4\">groove</span> of the <span class=\"customMeta\" data-dictid=\"a547f4a22716927771897daf6b50e7\">humerus</span> (via <span class=\"customMeta\" data-dictid=\"a2dcf8e6c61692777183a477d140bc\">bilaminar</span> tendon)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Medial and <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> <span class=\"customMeta\" data-dictid=\"f991d64bc81692777195b12eec7a84\">pectoral</span> nerves</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Adducts and medially rotates the arm</li>\n\t\t\t\t<li>Flexes the arm (clavicular part)</li>\n\t\t\t\t<li>Extends the flexed arm against resistance (sternocostal part)</li>\n\t\t\t</ul>\n\n\t\t\t<p>\u00a0</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Pectoralis Minor</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>3rd, 4th, and 5th ribs near the <span class=\"customMeta\" data-dictid=\"bfa9e996381692777185cdc8709772\">costochondral</span> junction</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Medial border and upper surface of the <span class=\"customMeta\" data-dictid=\"6d706ad0a916927771852098e31258\">coracoid</span> process</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Medial and <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> <span class=\"customMeta\" data-dictid=\"f991d64bc81692777195b12eec7a84\">pectoral</span> nerves</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Protracts the scapula</li>\n\t\t\t\t<li>Lowers the point of the shoulder</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Subclavius</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>First rib at the <span class=\"customMeta\" data-dictid=\"bfa9e996381692777185cdc8709772\">costochondral</span> junction</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Subclavian <span class=\"customMeta\" data-dictid=\"21ee3a5f911692777188099a3310c4\">groove</span> on the middle third of the clavicle</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Nerve to subclavius (from upper trunk of <span class=\"customMeta\" data-dictid=\"1e4db8b6ad1692777183683f42d44b\">brachial</span> plexus)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Stabilizes the <span class=\"customMeta\" data-dictid=\"2cb340bacd169277718404028c7d00\">clavicle</span> during shoulder movements</li>\n\t\t\t\t<li>Protects axillary vessels and <span class=\"customMeta\" data-dictid=\"1e4db8b6ad1692777183683f42d44b\">brachial</span> plexus</li>\n\t\t\t</ul>\n\n\t\t\t<p>\u00a0</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Serratus Anterior</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Eight digitations from the upper 8 ribs and <span class=\"customMeta\" data-dictid=\"65483c739e169277720294dce50377\">fascia</span> over the <span class=\"customMeta\" data-dictid=\"73796a0ae81692777190a4306a66a3\">intercostal</span> muscles</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Costal surface of the <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">medial</span> border of the scapula</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Long <span class=\"customMeta\" data-dictid=\"3c6021096816927772007954fcc158\">thoracic</span> nerve (C5, C6, C7)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Protracts scapula</li>\n\t\t\t\t<li>Rotates <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> upward for arm <span class=\"customMeta\" data-dictid=\"69ae073b9f169277718021ae773099\">abduction</span> beyond 90 degrees</li>\n\t\t\t\t<li>Stabilizes the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> during weight-bearing activities</li>\n\t\t\t\t<li>Assists in forced inspiration</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"\" data-author=\"OpenStaxCollege \" data-hash=\"\" data-license=\"CC BY 4.0\" data-source=\"https://pressbooks-dev.oer.hawaii.edu/anatomyandphysiology/chapter/muscles-of-the-pectoral-girdle-and-upper-limbs/\" data-tags=\"\" height=\"450\" src=\"https://image.prepladder.com/content/vPd1FBDpvfVHDem0X0Bi1745993400.png\" width=\"975\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:801px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"5\" style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:1px solid black; vertical-align:top\">\n\t\t\t<p><strong>Muscles of the <span class=\"customMeta\" data-dictid=\"a5c6cb079d16927771967e62ffee72\">posterior</span> Axioappendicular Region</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Muscle</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Origin</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Insertion</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Nerve Supply</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Actions</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Trapezius</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Medial one-third of the superior nuchal line of the skull</li>\n\t\t\t\t<li>External <span class=\"customMeta\" data-dictid=\"77dc7a0ab81692777194dba7ab78ab\">occipital</span> protuberance</li>\n\t\t\t\t<li>Ligamentum nuchae</li>\n\t\t\t\t<li>Spinous processes of C7 to T12 vertebrae</li>\n\t\t\t\t<li>Corresponding <span class=\"customMeta\" data-dictid=\"8202a376b11692777199029f89afab\">supraspinous</span> ligaments</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Upper fibers: <span class=\"customMeta\" data-dictid=\"a5c6cb079d16927771967e62ffee72\">Posterior</span> border of the <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> one-third of the clavicle</li>\n\t\t\t\t<li>Middle fibers: <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">Medial</span> margin of the <span class=\"customMeta\" data-dictid=\"7ce5726fb0169277718072972038ca\">acromion</span> and <span class=\"customMeta\" data-dictid=\"a74788e0671692777201de802ad69f\">upper lip</span> of the spine of the scapula</li>\n\t\t\t\t<li>Lower fibers: Apex of a triangular area at the <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">medial</span> end of the spine of the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> (intervening bursa)</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Spinal <span class=\"customMeta\" data-dictid=\"9088e1c7f616927771802e7f6d2541\">accessory</span> nerve (CN XI) and <span class=\"customMeta\" data-dictid=\"cd38f5515716927771969b9fb17e95\">proprioceptive</span> fibers from C3 and C4.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Upper fibers: Elevate the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> (shoulder shrugging), extend the neck (bilaterally)</li>\n\t\t\t\t<li>Middle fibers: Retract the scapula</li>\n\t\t\t\t<li>Lower fibers: <span class=\"customMeta\" data-dictid=\"ed17327223169277719753b0e5d6b4\">Rotate</span> the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> upward, aiding arm <span class=\"customMeta\" data-dictid=\"69ae073b9f169277718021ae773099\">abduction</span> beyond 90 degrees</li>\n\t\t\t\t<li>Trapezius with rhomboids: Retract <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> and tilt <span class=\"customMeta\" data-dictid=\"7649bd0f191692777188dcdf91af69\">glenoid</span> inferiorly.</li>\n\t\t\t\t<li>Trapezius with <span class=\"customMeta\" data-dictid=\"2462a1d0cf16927771985f03ba098b\">serratus</span> anterior: Overhead <span class=\"customMeta\" data-dictid=\"69ae073b9f169277718021ae773099\">abduction</span> and tilt <span class=\"customMeta\" data-dictid=\"7649bd0f191692777188dcdf91af69\">glenoid</span> superiorly.</li>\n\t\t\t\t<li>All fibers together: Stabilize the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> during arm movements</li>\n\t\t\t</ul>\n\n\t\t\t<p>\u00a0</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Latissimus Dorsi</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Posterior one-third of the outer lip of the <span class=\"customMeta\" data-dictid=\"837bfc230c16927771892ece07f94b\">iliac</span> crest</li>\n\t\t\t\t<li>Posterior layer of <span class=\"customMeta\" data-dictid=\"683192f6b21692777191ae16feee76\">lumbar</span> <span class=\"customMeta\" data-dictid=\"65483c739e169277720294dce50377\">fascia</span> (connecting to <span class=\"customMeta\" data-dictid=\"683192f6b21692777191ae16feee76\">lumbar</span> and sacral spines)</li>\n\t\t\t\t<li>Spinous processes of T7 to T12</li>\n\t\t\t\t<li>Lower four ribs</li>\n\t\t\t\t<li>Inferior angle of the scapula</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Fibers twist to insert into the floor of the <span class=\"customMeta\" data-dictid=\"c2349e5c871692777190bf4d1a6ff8\">intertubercular</span> <span class=\"customMeta\" data-dictid=\"2a56f52a921692777199df43853eba\">sulcus</span> of the humerus, <span class=\"customMeta\" data-dictid=\"cea3751d7316927772024f04f8dc99\">wrapping</span> around the lower border of the <span class=\"customMeta\" data-dictid=\"8ad930500b1692777200545684a556\">teres</span> major.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Thoracodorsal nerve (C6, C7, C8).</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Extends, adducts, and medially rotates the arm (e.g., swimming, climbing)</li>\n\t\t\t\t<li>Assists in forceful <span class=\"customMeta\" data-dictid=\"2cbabc42d21692777187c451566867\">expiration</span> (e.g., coughing, sneezing</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Levator Scapulae</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Transverse processes of C1 to C4 vertebrae</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Superior angle and upper part of the <span class=\"customMeta\" data-dictid=\"db46007ad21692777192dcc160a2e2\">medial</span> border of the scapula</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Dorsal scapular nerve (C5) and branches from C3 and C4</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Elevates and stabilizes the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> during arm movements.</p>\n\n\t\t\t<p>\u00a0</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Rhomboid Minor</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Lower part of <span class=\"customMeta\" data-dictid=\"c6d5162a2816927771918bfaa5d7ec\">ligamentum</span> nuchae and <span class=\"customMeta\" data-dictid=\"6ecc9fc8e416927771993c575ccc1e\">spinous</span> processes of C7 and T1</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Medial border of the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> at the base of the triangular area at the root of the spine.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Dorsal scapular nerve (C5)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Retracts and stabilizes the scapula.</p>\n\n\t\t\t<p>\u00a0</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Rhomboid Major</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Spinous processes of T2 to T5 and <span class=\"customMeta\" data-dictid=\"8202a376b11692777199029f89afab\">supraspinous</span> ligaments</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Medial border of the scapula, below the root of the spine</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Dorsal scapular nerve (C5)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p>Retracts and stabilizes the scapula.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"588\" src=\"https://image.prepladder.com/content/j8295G0z6wzbcAMCqD221745993409.png\" width=\"624\" /></p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/vPd1FBDpvfVHDem0X0Bi1745993400.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>The movements at the _______ joint permit a person to look to the right and left</p>",
    "choices": [
      {
        "id": 1,
        "text": "Atlanto-occipital"
      },
      {
        "id": 2,
        "text": "Atlanto -axial"
      },
      {
        "id": 3,
        "text": "C2-C3"
      },
      {
        "id": 4,
        "text": "C3-C4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct</strong> <strong>Option B -</strong> Atlanto-axial joint:</p>\n\n<p>The Atlanto-axial joint is formed between the <span class=\"customMeta\" data-dictid=\"305201d7261692777182bd15a8d297\">atlas</span> (C1 vertebra) and the <span class=\"customMeta\" data-dictid=\"3c28fd47f71692777182efbbaa5f6d\">axis</span> (C2 vertebra) in the spine. This joint is responsible for rotational movements of the head. The <span class=\"customMeta\" data-dictid=\"3c28fd47f71692777182efbbaa5f6d\">axis</span> (C2) has a peg-like structure called the <span class=\"customMeta\" data-dictid=\"9ab18718db1692777185596ddcfd90\">dens</span> or <span class=\"customMeta\" data-dictid=\"9f62a9fb1d16927771946540aa18df\">odontoid</span> process, which fits into the <span class=\"customMeta\" data-dictid=\"305201d7261692777182bd15a8d297\">atlas</span> (C1), allowing for rotation. Therefore, the Atlanto-axial joint permits the specific movements required for looking to the right and left.</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option A - </strong>Atlanto-occipital joint</p>\n\n<p>The Atlanto-occipital joint permits <span class=\"customMeta\" data-dictid=\"85ff8a7ff81692777202a827961a5c\">flexion</span> and extension movements of the head, like nodding. It's mainly for tilting the head forward and backward, rather than side-to-side rotation.</p>\n\n<p>\u00a0<strong>Option C -</strong> C2-C3 <span class=\"customMeta\" data-dictid=\"95a8e326831692777190c5101eb835\">intervertebral</span> joint</p>\n\n<p>The C2-C3 <span class=\"customMeta\" data-dictid=\"95a8e326831692777190c5101eb835\">intervertebral</span> joint permits flexion, extension, <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> bending, and some degree of rotation, but sideways <span class=\"customMeta\" data-dictid=\"8342f520cf1692777197dee4e4e5c3\">rotation</span> is mainly handled by the Atlanto-axial joint, not C2-C3.</p>\n\n<p><strong>Option D - </strong>C3-C4 <span class=\"customMeta\" data-dictid=\"95a8e326831692777190c5101eb835\">intervertebral</span> joint</p>\n\n<p>The C3-C4 joint, similar to C2-C3, allows neck movements like flexion, extension, <span class=\"customMeta\" data-dictid=\"fc380e21321692777191739bd99191\">lateral</span> bending, and some degree of rotation. However, it's not directly involved in sideways rotational movements.</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Retraction of the scapula is primarily done by?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Serratus anterior"
      },
      {
        "id": 2,
        "text": "Trapezius"
      },
      {
        "id": 3,
        "text": "Subscapularis"
      },
      {
        "id": 4,
        "text": "Supraspinatus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Option B - </strong>Trapezius</p>\n\n<ul>\n\t<li>Trapezius: The trapezius muscle is a large muscle that covers the upper back and neck. It plays a key role in the movement and <span class=\"customMeta\" data-dictid=\"6694ddb1db1692777199c9a1e38bf0\">stabilization</span> of the scapula. The middle and lower fibers of the trapezius muscle primarily perform scapular retraction, which involves pulling the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> backward toward the spine.</li>\n</ul>\n\n<p><strong>Incorrect Options: </strong></p>\n\n<p><strong>Option A -</strong> <span class=\"customMeta\" data-dictid=\"2462a1d0cf16927771985f03ba098b\">Serratus</span> anterior: The <span class=\"customMeta\" data-dictid=\"2462a1d0cf16927771985f03ba098b\">serratus</span> <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> muscle protracts and rotates the scapula, stabilizing it against the rib cage. However, it doesn't directly retract the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> at the <span class=\"customMeta\" data-dictid=\"2797924269169277719964d47f4864\">sternoclavicular</span> joint.</p>\n\n<p><strong>Option C - </strong>Subscapularis: The subscapularis muscle, part of the <span class=\"customMeta\" data-dictid=\"78dfa6942216927771971d0733476f\">rotator</span> cuff, sits on the front of the scapula. It internally rotates the <span class=\"customMeta\" data-dictid=\"a547f4a22716927771897daf6b50e7\">humerus</span> and stabilizes the <span class=\"customMeta\" data-dictid=\"f0cdc42a0c1692777198f54a380826\">shoulder joint</span> but doesn't aid in scapular retraction.</p>\n\n<p><strong>Option D -</strong> Supraspinatus: The supraspinatus muscle, part of the <span class=\"customMeta\" data-dictid=\"78dfa6942216927771971d0733476f\">rotator</span> cuff, is located on the back of the scapula. It helps initiate shoulder <span class=\"customMeta\" data-dictid=\"69ae073b9f169277718021ae773099\">abduction</span> but isn't mainly responsible for scapular retraction.\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What is the cause of scapular winging?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Trapezius"
      },
      {
        "id": 2,
        "text": "Serratus anterior"
      },
      {
        "id": 3,
        "text": "Latissimus dorsi"
      },
      {
        "id": 4,
        "text": "Pectroralis major"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Option B - </strong>Serratus anterior:</p>\n\n<ul>\n\t<li><strong>Serratus anterior: </strong>The <span class=\"customMeta\" data-dictid=\"2462a1d0cf16927771985f03ba098b\">serratus</span> <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> muscle is primarily responsible for stabilizing the <span class=\"customMeta\" data-dictid=\"153f2ea4be16927771981ce5d9171f\">scapula</span> against the <span class=\"customMeta\" data-dictid=\"3c6021096816927772007954fcc158\">thoracic</span> wall. When the <span class=\"customMeta\" data-dictid=\"2462a1d0cf16927771985f03ba098b\">serratus</span> <span class=\"customMeta\" data-dictid=\"1ba6a9cfe11692777181950edd7a6d\">anterior</span> muscle is paralyzed or weakened, it can lead to winging of the scapula. This muscle is especially important for maintaining proper scapular position during movements such as pushing, pulling, and reaching. Hence, option B is correct.</li>\n</ul>\n\n<p><strong>Incorrect Options: </strong></p>\n\n<p><strong>Option A -</strong> Trapezius: The trapezius muscle stabilizes and moves the scapula, but its <span class=\"customMeta\" data-dictid=\"72fa9105b916927771945aef35e8ed\">paralysis</span> typically doesn't cause scapular winging.</p>\n\n<p><strong>Option C -</strong> <span class=\"customMeta\" data-dictid=\"12ad4210e4169277719111f356b7ba\">Latissimus</span> dorsi: The <span class=\"customMeta\" data-dictid=\"12ad4210e4169277719111f356b7ba\">latissimus</span> <span class=\"customMeta\" data-dictid=\"5125f3ab2b16927771860f1acf2bad\">dorsi</span> muscle assists in various shoulder movements but is typically not associated with scapular winging, even when weakened or paralyzed.</p>\n\n<p><strong>Option D -</strong> <span class=\"customMeta\" data-dictid=\"afa97794e21692777195a324ffec49\">Pectoralis</span> major: The <span class=\"customMeta\" data-dictid=\"afa97794e21692777195a324ffec49\">pectoralis</span> major muscle aids shoulder movements but usually doesn't cause scapular winging if paralyzed.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Ligamentum flavum has high levels of:-</p>",
    "choices": [
      {
        "id": 1,
        "text": "Type 1 collagen"
      },
      {
        "id": 2,
        "text": "Type 2 collagen"
      },
      {
        "id": 3,
        "text": "Reticular fibres"
      },
      {
        "id": 4,
        "text": "Elastin fibres"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Option D -</strong>\u00a0Elastin fibres:</p>\n\n<p>The <span class=\"customMeta\" data-dictid=\"c6d5162a2816927771918bfaa5d7ec\">ligamentum</span> flavum connects adjacent vertebrae, crucial for <span class=\"customMeta\" data-dictid=\"d816ba952f1692777199fc69bd7c56\">spinal</span> stability and flexibility. <span class=\"customMeta\" data-dictid=\"3ac19345dd169277718722e5f22c2f\">Elastin</span> fibers within it provide elasticity, enabling stretching and recoiling to maintain stability during movement. Its yellowish color <span class=\"customMeta\" data-dictid=\"89f5610ffd1692777184b03f1f88cc\">comes</span> from high <span class=\"customMeta\" data-dictid=\"3ac19345dd169277718722e5f22c2f\">elastin</span> levels.</p>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option A -\u00a0</strong>Type 1 collagen: <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">Type 1</span> <span class=\"customMeta\" data-dictid=\"d215f4a56c16927771842f34a24156\">collagen</span> is abundant in tendons, ligaments, and bone, but the <span class=\"customMeta\" data-dictid=\"c6d5162a2816927771918bfaa5d7ec\">ligamentum</span> flavum contains lower levels compared to other <span class=\"customMeta\" data-dictid=\"67e237a57c16927771859803f93ab3\">connective</span> tissues.</p>\n\n<p><strong>Option B -</strong>\u00a0Type 2 collagen: <span class=\"customMeta\" data-dictid=\"05e8c1df0d1692777201c9acee8b1f\">Type 2</span> <span class=\"customMeta\" data-dictid=\"d215f4a56c16927771842f34a24156\">collagen</span> is primarily found in <span class=\"customMeta\" data-dictid=\"a2ce88e8a0169277718988f5bc31b8\">hyaline</span> cartilage, like in joint <span class=\"customMeta\" data-dictid=\"cd001152fe16927771823275439a2d\">articular</span> <span class=\"customMeta\" data-dictid=\"c6f61cdbe41692777183fdc8f95f96\">cartilage</span> and vertebral discs, but it's not notably present in the <span class=\"customMeta\" data-dictid=\"c6d5162a2816927771918bfaa5d7ec\">ligamentum</span> flavum.</p>\n\n<p><strong>Option C -</strong>\u00a0Reticular fibers: <span class=\"customMeta\" data-dictid=\"0b6b1f44cb1692777197afef785626\">Reticular</span> fibers, composed of <span class=\"customMeta\" data-dictid=\"6f809a27121692777201d1ccde5ace\">type 3</span> collagen, <span class=\"customMeta\" data-dictid=\"a1b06f401f1692777203a53393ba98\">form</span> mesh-like networks in organs like <span class=\"customMeta\" data-dictid=\"4df97a6cbf169277719172fd1af767\">lymph</span> nodes and spleen, but they're not notably present in the <span class=\"customMeta\" data-dictid=\"c6d5162a2816927771918bfaa5d7ec\">ligamentum</span> flavum.\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which of the following is normally seen in lumbar spine?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Scoliosis"
      },
      {
        "id": 2,
        "text": "Kyphosis"
      },
      {
        "id": 3,
        "text": "Lordosis"
      },
      {
        "id": 4,
        "text": "Recurvatum"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Option C - </strong>Lordosis:</p>\n\n<ul>\n\t<li>Lordosis: <span class=\"customMeta\" data-dictid=\"45114cc1d5169277719137b6fba061\">Lordosis</span> refers to the inward <span class=\"customMeta\" data-dictid=\"4bd67d54f016927771850c953dadbc\">curvature</span> of the spine, creating a <span class=\"customMeta\" data-dictid=\"9b5c0ed1601692777184e597f453c9\">concave</span> shape. In the <span class=\"customMeta\" data-dictid=\"683192f6b21692777191ae16feee76\">lumbar</span> spine, <span class=\"customMeta\" data-dictid=\"45114cc1d5169277719137b6fba061\">lordosis</span> is considered a normal <span class=\"customMeta\" data-dictid=\"116f86834a1692777181a914379270\">anatomical</span> feature. It helps to maintain the balance and proper <span class=\"customMeta\" data-dictid=\"3c0c325f4216927771819e5d0eb581\">alignment</span> of the spine, allowing for efficient weight distribution and movement.</li>\n</ul>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option A -</strong> Scoliosis: <span class=\"customMeta\" data-dictid=\"a3e3b052331692777198750eaae63a\">Scoliosis</span> is an <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> sideways <span class=\"customMeta\" data-dictid=\"4bd67d54f016927771850c953dadbc\">curvature</span> of the spine, typically found in the <span class=\"customMeta\" data-dictid=\"3c6021096816927772007954fcc158\">thoracic</span> or <span class=\"customMeta\" data-dictid=\"210c44418c1692777200eb2c3e9879\">thoracolumbar</span> regions, not the <span class=\"customMeta\" data-dictid=\"683192f6b21692777191ae16feee76\">lumbar</span> spine.</p>\n\n<p><strong>Option B -</strong>\u00a0Kyphosis: <span class=\"customMeta\" data-dictid=\"67deccee6a16927771911e0dcd1c3c\">Kyphosis</span> is an excessive forward <span class=\"customMeta\" data-dictid=\"4bd67d54f016927771850c953dadbc\">curvature</span> of the spine, often causing a rounded or hunched-back appearance. While normal in the <span class=\"customMeta\" data-dictid=\"3c6021096816927772007954fcc158\">thoracic</span> spine, it's uncommon in the <span class=\"customMeta\" data-dictid=\"683192f6b21692777191ae16feee76\">lumbar</span> spine.</p>\n\n<p><strong>Option D -</strong>\u00a0Recurvatum: Recurvatum is <span class=\"customMeta\" data-dictid=\"2ad2fb4cc8169277718925a677620c\">hyperextension</span> of a joint, seen notably in the knee but not typically in the <span class=\"customMeta\" data-dictid=\"683192f6b21692777191ae16feee76\">lumbar</span> spine.\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  }
];
        let quizName = '54 Previous Year Questions';
        const quizFilename = '54-previous-year-questions-18a64b7c.html';
        let hierarchy = ["PrepLadder", "qBank", "Anatomy"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>