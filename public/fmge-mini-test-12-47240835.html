<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 12 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The cecal bud arises from _______",
    "choices": [
      {
        "id": 1,
        "text": "Pre-arterial segment of midgut loop"
      },
      {
        "id": 2,
        "text": "Post-arterial segment of midgut loop"
      },
      {
        "id": 3,
        "text": "Pre-arterial segment of hindgut loop"
      },
      {
        "id": 4,
        "text": "Post-arterial segment of hindgut loop"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>cecal bud </strong>arises as&nbsp;a diverticulum in the <strong>post-arterial segment of the midgut loop.</strong></p>\n<p>The <strong>cecal bud</strong> enlarges and gives rise to the <strong>cecum </strong>and the <strong>appendix</strong>.&nbsp;The proximal part of the cecal bud grows rapidly to form the cecum.&nbsp;The distal part remains narrow and forms the appendix.&nbsp;</p>\n<p>The <strong>midgut loop</strong> consists of a cranial limb and a caudal limb.&nbsp;</p>\n<ul>\n<li>The <strong>cranial limb</strong> forms the <strong>jejunum</strong> and <strong>upper part of the ileum</strong>.</li>\n<li>The<strong> caudal limb</strong> forms the&nbsp;<strong>lower part of the ileum,&nbsp;</strong><strong>cecum,</strong>&nbsp;<strong>appendix</strong>,<strong>&nbsp;</strong><strong>ascending colon</strong>, and <strong>proximal two-thirds</strong> of the <strong>transverse colon</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/f8fae6c139e748e2b95b12c1c5f3ea9ax260x224.JPEG"
    ]
  },
  {
    "text": "Positive feedback action of estrogen for inducing luteinizing hormone surge is associated with which of the following steroid hormone ratio in peripheral circulation?",
    "choices": [
      {
        "id": 1,
        "text": "High estrogen: low progesterone"
      },
      {
        "id": 2,
        "text": "Low estrogen: high progesterone"
      },
      {
        "id": 3,
        "text": "High estrogen: high progesterone"
      },
      {
        "id": 4,
        "text": "Low estrogen: low progesterone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Positive feedback action of estrogen</strong> for inducing luteinizing hormone (LH) surge is associated with <strong>high estrogen: low progesterone.</strong></p>\n<table style=\"width: 466px; height: 341px;\">\n<tbody>\n<tr>\n<td style=\"width: 75px;\">\n<p><strong>Phases </strong></p>\n</td>\n<td style=\"width: 93px;\">\n<p><strong>Hormone </strong></p>\n</td>\n<td style=\"width: 89px;\">\n<p><strong>Type of feedback </strong></p>\n</td>\n<td style=\"width: 70px;\">\n<p><strong>Site </strong></p>\n</td>\n<td style=\"width: 105px;\">\n<p><strong>FSH and LH secretion</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 75px;\">\n<p>Follicular</p>\n</td>\n<td style=\"width: 93px;\">\n<p>Estrogen</p>\n</td>\n<td style=\"width: 89px;\">\n<p>Negative</p>\n</td>\n<td style=\"width: 70px;\">\n<p>Anterior pituitary</p>\n</td>\n<td style=\"width: 105px;\">\n<p>Both suppressed</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 75px;\">\n<p>Midcycle</p>\n</td>\n<td style=\"width: 93px;\">\n<p>Estrogen</p>\n</td>\n<td style=\"width: 89px;\">\n<p>Positive</p>\n</td>\n<td style=\"width: 70px;\">\n<p>Anterior pituitary</p>\n</td>\n<td style=\"width: 105px;\">\n<p>Increased LH surge</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 75px;\">\n<p>Luteal</p>\n</td>\n<td style=\"width: 93px;\">\n<p>Estrogen</p>\n<p>Progesterone</p>\n</td>\n<td style=\"width: 89px;\">\n<p>Negative</p>\n<p>Negative</p>\n</td>\n<td style=\"width: 70px;\">\n<p>Anterior pituitary</p>\n<p>Anterior pituitary</p>\n</td>\n<td style=\"width: 105px;\">\n<p>Both are decreased</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false regarding the effect of substrate concentration on the rate of reaction?",
    "choices": [
      {
        "id": 1,
        "text": "As substrate concentration increases, the initial velocity of the reaction increases until it reaches a maximum value (Vmax)"
      },
      {
        "id": 2,
        "text": "The substrate concentration at which the velocity of the reaction is half maximum is called Km"
      },
      {
        "id": 3,
        "text": "The Michaelis-Menten equation says that initial reaction velocity (Vi) = Vmax [S]/ Km+[S]"
      },
      {
        "id": 4,
        "text": "The plot of initial reaction velocity against substrate concentration is linear"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The plot of initial reaction velocity against substrate concentration is<strong> hyperbolic.</strong></p>\n<p>For a typical enzyme, as the substrate concentration increases,<strong> initial velocity (V<sub>i)&nbsp;</sub>increases</strong> until it reaches a <strong>maximum value V<sub>max</sub>.&nbsp;</strong>With further <strong>increase</strong> in the<strong>&nbsp;substrate</strong> concentration, the <strong>enzyme</strong> is said to be <strong>&ldquo;saturated&rdquo;</strong> with the substrate and the <strong>velocity remains the same</strong>. Hence, the shape of the curve that relates to the velocity of the reaction to substrate concentration is hyperbolic.</p>\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The Michaelis-Menten equation illustrates mathematically the relationship between V<sub>i</sub> and [S] i.e,</p>\n<p><strong>V<sub>i</sub> = V<sub>max</sub>&nbsp;&times;[S]/K<sub>m</sub>+[S]</strong></p>\n<div class=\"page\" title=\"Page 92\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The <strong>Michaelis constant (K<sub>m</sub>)</strong> is the substrate concentration at which V<sub>i</sub> is half the maximal velocity (V<sub>max</sub>/2).</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/413d8be477d445bfba9a704ba8b9d81ax1280x549.JPEG"
    ]
  },
  {
    "text": "Increased incidence of cancer in old age is due to _____.",
    "choices": [
      {
        "id": 1,
        "text": "Telomerase reactivation"
      },
      {
        "id": 2,
        "text": "Telomerase deactivation"
      },
      {
        "id": 3,
        "text": "Inactivation of protooncogene"
      },
      {
        "id": 4,
        "text": "Increase in apoptosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Increased incidence of cancer in old age is due to <strong>telomerase reactivation</strong>.</p>\n<p>With every cell division, there is some shortening of <strong>telomeres</strong>&nbsp;at the ends of chromosomes. Once the telomeres are shortened beyond a certain point, it may cause cell-cycle arrest or&nbsp;<strong>apoptosis</strong>. This is called <strong>replicative senescence.</strong></p>\n<p><strong>Telomerase </strong>is the enzyme that prevents the shortening of telomeres.</p>\n<p>This enzyme is present in some cells, like the germ cells, and <strong>absent in most somatic cells.</strong></p>\n<p><strong>Reactivation of telomerase </strong>is a critical step in the development of about 85% of human cancers, which enables the cells to divide for several times than normal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the stain used for identifying cryptococcus?",
    "choices": [
      {
        "id": 1,
        "text": "Giemsa stain"
      },
      {
        "id": 2,
        "text": "Ziehl-Nielsen stain"
      },
      {
        "id": 3,
        "text": "Gram staining"
      },
      {
        "id": 4,
        "text": "Mucicarmine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Mucicarmine</strong> is used to stain cryptococcus.</p>\n<p><strong>Mucicarmine stain of lung tissue:</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/77e3f118793040468caa6688b0a23794x1280x853.JPEG"
    ]
  },
  {
    "text": "A female patient presented with nausea, vomiting and dizziness. She has been taking medication for an amebiasis infection. She was at a party with her friends and had some alcoholic drinks before the symptoms started. The doctors suspect an interaction between alcohol and the anti-amoebic drug she was taking. What could the drug be?",
    "choices": [
      {
        "id": 1,
        "text": "Paromomycin"
      },
      {
        "id": 2,
        "text": "Metronidazole"
      },
      {
        "id": 3,
        "text": "Diloxanide"
      },
      {
        "id": 4,
        "text": "Nitazoxanide"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The patient is probably having a&nbsp;<strong>disulfiram-like reaction,</strong> which can occur when <strong>metronidazole </strong>interacts with<strong> alcohol.&nbsp;</strong></p>\n<p><strong>Disulfiram</strong>&nbsp;is an&nbsp;<strong>aldehyde dehydrogenase inhibitor</strong>&nbsp;and is used in disulfiram aversion therapy to reduce alcohol dependence. If&nbsp;<strong>alcohol</strong>&nbsp;is<strong>&nbsp;ingested</strong>&nbsp;after taking&nbsp;<strong>disulfiram</strong>, there is an&nbsp;<strong>increase</strong>&nbsp;in&nbsp;<strong>blood acetaldehyde concentration</strong>&nbsp;that causes symptoms such as&nbsp;<strong>flushing</strong>, burning sensation,&nbsp;<strong>vomiting</strong>, perspiration,&nbsp;<strong>tightness</strong>&nbsp;of chest, dizziness, throbbing headache,&nbsp;<strong>visual disturbance</strong>, etc. Knowledge of this may help the patient to resist drinking.</p>\n<p><strong>Disulfiram-like reaction</strong>&nbsp;is the same reaction mentioned above that has been noted in patients who take the following drugs with alcohol:</p>\n<ul>\n<li><strong>Metronidazole</strong></li>\n<li>Sulfonylureas</li>\n<li>Cefoperazone</li>\n<li>Procarbazine</li>\n<li>Griseofulvin</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Section 192 of IPC deals with _______",
    "choices": [
      {
        "id": 1,
        "text": "Perjury"
      },
      {
        "id": 2,
        "text": "Fabricating false evidence"
      },
      {
        "id": 3,
        "text": "Punishment for false evidence"
      },
      {
        "id": 4,
        "text": "Using evidence known to be false"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Section <strong>192</strong> of IPC deals with <strong>fabricating false evidence.</strong></p>\n<p><strong>Note:</strong> <strong>Section 177</strong> of the IPC deals with <strong>furnishing false information.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old male with uncontrolled chronic hypertension presented with episodes of coughing out frank blood to the ENT surgeon. On further evaluation, a diagnosis of posterior epistaxis secondary to hypertension was made. What is the location of the artery attributing to this bleed?",
    "choices": [
      {
        "id": 1,
        "text": "Posterior end of superior turbinate"
      },
      {
        "id": 2,
        "text": "Posterior end of inferior turbinate"
      },
      {
        "id": 3,
        "text": "Posterior end of middle turbinate"
      },
      {
        "id": 4,
        "text": "Anterior end of septum"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The artery responsible for posterior epistaxis is sphenopalatine artery. It is located in the <strong>posterior end of middle turbinate.</strong></p>\n<div class=\"page\" title=\"Page 1657\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Most common <strong>artery</strong> involved in both anterior and posterior epistaxis is the <strong>sphenopalatine artery&nbsp;</strong>and not the woodruff's plexus.Woodruff's plexus is a&nbsp;<strong>venous</strong>&nbsp;plexus located in the&nbsp;posterior end of the inferior turbinate and is also sometimes implicated in epistaxis associated with systemic conditions such as&nbsp;hypertension and coagulopathy. However, it only accounts for about 5-10% of all nose bleeds.</p>\n<div class=\"page\" title=\"Page 1657\">\n<div class=\"layoutArea\">\n<div class=\"column\">&nbsp;</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "3 months following cataract surgery, a patient comes with complaints of decreased visual acuity. On examination, posterior capsular opacification is seen. What type of laser can be used to treat this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Femto laser"
      },
      {
        "id": 2,
        "text": "Nd-Yag laser"
      },
      {
        "id": 3,
        "text": "Argon flouride"
      },
      {
        "id": 4,
        "text": "Argon"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given history mentions\u00a0<strong>decreased visual acuity</strong> 3 months post-cataract surgery and the presence of\u00a0<strong>posterior capsular opacification</strong> is suggestive of<strong>\u00a0after-cataract. </strong>A posterior\u00a0capsulotomy (creating a hole in the posterior capsule) using an <strong>Nd: YAG laser</strong> is the mainstay of treatment.</p>\n<p>Posterior capsular opacification, otherwise known as\u00a0<strong>after cataract/</strong><strong>secondary cataract,</strong>\u00a0is the\u00a0<strong>most common late complication</strong>\u00a0of uncomplicated cataract surgery. It occurs due to the<strong> proliferation</strong> of <strong>lens\u00a0epithelial cells</strong>\u00a0that have been left out inside the capsular bag after cataract surgery.\u00a0The rate of posterior capsule opacification following extracapsular cataract extraction (ECCE) and phacoemulsification varies with\u00a0the age of the patient, the surgeon, the surgical technique, the type of intraocular lens used, and the duration after surgery.</p>\n<p>Symptoms of after cataract include:</p>\n<ul>\n<li>Reduction of visual acuity</li>\n<li>Slowly worsening blurring</li>\n<li>Glare and occasionally monocular diplopia</li>\n</ul>\n<p>They can present in different patterns such as:</p>\n<ul>\n<li><strong>Elschnig's pearls</strong>: present as<strong>\u00a0</strong>vacuolated (pearl-type) grape-like clusters of swollen cells\u00a0</li>\n<li><strong>Soemmering's ring</strong>: present as a white annular proliferation that is formed at the periphery of the capsular bag.</li>\n<li><strong>Fibrosis type</strong>: present as fibroblastic metaplasia of the epithelial cells\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2512b89adf444626b1c9613e97042b7ax1279x1441.JPEG"
    ]
  },
  {
    "text": "WHO stage IV HIV includes all except______",
    "choices": [
      {
        "id": 1,
        "text": "Toxoplasmosis"
      },
      {
        "id": 2,
        "text": "Pneumocystis carinii"
      },
      {
        "id": 3,
        "text": "HIV wasting syndrome"
      },
      {
        "id": 4,
        "text": "Oral thrush"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Esophageal candidiasis is present in HIV stage IV and not oral thrush.</p>\n<p>Oral thrush is in stage III</p>\n<p>&nbsp;HIV clinical stage IV includes:</p>\n<ul>\n<li>HIV wasting syndrome or Slim disease</li>\n<li>Pneumocystis jiroveci pneumonia (previously known pneumocystis carinii)</li>\n<li>Recurrent severe bacterial pneumonia</li>\n<li>Chronic herpes simplex infection (orolabial, genital, anorectal)</li>\n<li>Oesophageal candidiasis (or candidiasis of trachea, bronchi or lungs)</li>\n<li>Extrapulmonary TB</li>\n<li>Kaposi sarcoma</li>\n<li>Cytomegalovirus disease</li>\n<li>CNS toxoplasmosis</li>\n<li>HIV encephalopathy</li>\n<li>Extrapulmonary cryptococcosis</li>\n<li>Disseminated non tuberculous mycobacteria</li>\n<li>Progressive multifocal leukoencephalopathy</li>\n<li>Chronic cryptosporidiosis</li>\n<li>Chronic isospriasis</li>\n<li>Disseminated mycosis (histoplasmosis, coccidiomycosis)</li>\n<li>Recurrent septicemia (including nontyphoidal salmonella)</li>\n<li>Lymphoma (cerebral or B cell non-Hodgkin)</li>\n<li>Invasive cervical carcinoma</li>\n<li>Atypical disseminated leishmaniasis</li>\n<li>HIV associated nephropathy or HIV associated cardiomyopathy</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A large number of tests were done in series. Which of the following will be true?",
    "choices": [
      {
        "id": 1,
        "text": "Sensitivity and specificity will increase"
      },
      {
        "id": 2,
        "text": "Sensitivity will decrease, specificity will increase"
      },
      {
        "id": 3,
        "text": "Sensitivity and specificity will decrease"
      },
      {
        "id": 4,
        "text": "Sensitivity will increase, specificity will decrease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>When a large number of tests are done in <strong>series</strong>, net <strong>sensitivity</strong> is<strong> decreased </strong>and net<strong> specificity</strong> is<strong> increased.</strong></p>\n<p>Screening tests are done in <strong>series</strong> when the result of the <strong>first test determines</strong> whether to run the <strong>second test</strong> or not. e.g., HIV screening is done using consecutive ELISA.</p>\n<p>Screening tests are done in<strong> parallel</strong> when the second test is <strong>independently performed</strong> regardless of what the first test result is. Both the tests are done at the same time. E.g., In LFT, multiple tests are done together like SGOT, SGPT, total bilirubin, alkaline phosphatase, etc.</p>\n<p>Following are the trends that are observed while evaluating screening tests:</p>\n<table style=\"width: 404.766px;\">\n<tbody>\n<tr>\n<td style=\"width: 113px;\">\u00a0</td>\n<td style=\"width: 141px;\"><strong>Tests in Series</strong></td>\n<td style=\"width: 133.766px;\"><strong>Tests in parallel</strong></td>\n</tr>\n<tr>\n<td style=\"width: 113px;\">Combined sensitivity</td>\n<td style=\"width: 141px;\">\u00a0Decreases</td>\n<td style=\"width: 133.766px;\">Increases</td>\n</tr>\n<tr>\n<td style=\"width: 113px;\">Combined specificity</td>\n<td style=\"width: 141px;\">Increases</td>\n<td style=\"width: 133.766px;\">Decreases</td>\n</tr>\n<tr>\n<td style=\"width: 113px;\">Combined PPV</td>\n<td style=\"width: 141px;\">Increases</td>\n<td style=\"width: 133.766px;\">Decreases</td>\n</tr>\n<tr>\n<td style=\"width: 113px;\">Combined NPV</td>\n<td style=\"width: 141px;\">Decreases</td>\n<td style=\"width: 133.766px;\">\u00a0Increases</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An Accredited Social Health Worker will visit all the babies born at home upto which day of their life:",
    "choices": [
      {
        "id": 1,
        "text": "20"
      },
      {
        "id": 2,
        "text": "28"
      },
      {
        "id": 3,
        "text": "36"
      },
      {
        "id": 4,
        "text": "42"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Under the Home Based Newborn Care, ASHAs will make visits to all newborns up to&nbsp;<strong>42 days</strong> of their life to record weight, ensure vaccination, and registration.</p>\n<p>The<strong> schedule</strong> of her visit is day 1, 3, 7, 14, 21, 28, and 42. On completion of all these visits, ASHA receives an incentive of Rs.250.</p>\n<p>She will make:</p>\n<ul>\n<li><strong>7 visits</strong> to those born at <strong>home.</strong></li>\n<li><strong>6 visits</strong> to those born in a facility through a <strong>vaginal delivery</strong> (no visit on day 1).</li>\n<li><strong>5 visits</strong> to those born in a facility through a <strong>LSCS</strong> (no visit on day 1 and day 3).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 36-year-old female patient presents with symptoms of hyperparathyroidism, pituitary adenoma, and gastrinoma with cutaneous angiofibromas. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "MEN 1"
      },
      {
        "id": 2,
        "text": "MEN 2"
      },
      {
        "id": 3,
        "text": "MEN 3"
      },
      {
        "id": 4,
        "text": "MEN 4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario suggests a diagnosis of <strong>MEN 1 syndrome</strong>.</p>\n<p><strong>Multiple endocrine neoplasia</strong> (MEN) syndromes are characterized by tumors of two or more endocrine glands. There are <strong>four major types</strong> of MEN (MEN 1&ndash;4), and they either show an <strong>autosomal dominant</strong> pattern of inheritance or occur sporadically.&nbsp;</p>\n<p><strong>MEN 1</strong>,&nbsp;also known as <strong>Wermer&rsquo;s syndrome</strong>,&nbsp;is characterized by the triad of <strong>parathyroid</strong>, <strong>pancreatic islet cell</strong>, and <strong>anterior pituitary&nbsp;</strong><strong>tumors</strong>. Adrenal cortical tumors, carcinoid tumors, facial angiofibromas, collagenomas, thyroid tumors, and lipomas may also occur. MEN 1-associated tumors are usually multiple, larger, and more aggressive, resulting in resistance to treatment and poor patient outcomes.</p>\n<ol>\n<li><strong>Parathyroid tumors-</strong>&nbsp;<strong>primary hyperparathyroidism</strong> is the <strong>most common</strong> feature of MEN 1. <strong>Hypercalcemia</strong> with or without symptoms (polyuria, polydipsia, constipation, dyspepsia), nephrolithiasis, and osteitis fibrosa cystica may also occur.&nbsp;All four parathyroid glands are usually affected with multiple adenomas or hyperplasia.&nbsp;</li>\n<li><strong>Pancreatic islet cell tumors-</strong>&nbsp;these are <strong>neuroendocrine tumors</strong>, including:\n<ul>\n<li><strong>Gastrinoma</strong> (gastrin-secreting tumors)- associated with increased gastric acid secretion and multiple peptic ulcers (Zollinger-Ellison syndrome). Patients may present with diarrhea and steatorrhea. Gastrinomas are the<strong> major cause</strong> of <strong>mortality</strong> and morbidity.&nbsp;</li>\n<li><strong>Insulinoma</strong>&nbsp;(insulin-secreting tumors)- patients present with <strong>hypoglycemic symptoms</strong> (weakness, headaches, sweating, seizures, weight gain) that develop after fasting or exertion and improve after glucose intake. Along with increased plasma insulin levels and hypoglycemia, increased C peptide and proinsulin levels help in diagnosing the condition.</li>\n<li><strong>Glucagonoma</strong>&nbsp;(glucagon-secreting tumors)- may be associated with necrolytic migratory erythema, weight loss, anemia, and stomatitis.&nbsp;</li>\n<li><strong>VIPomas</strong> (Vasoactive intestinal peptide [VIP]-secreting tumors): The VIPoma syndrome, also known as Verner-Morrison syndrome, is characterized by watery diarrhea, hypokalemia, and achlorhydria. These are mostly located in the <strong>tail</strong> of the <strong>pancreas</strong>.</li>\n<li><strong>PPomas</strong> (Pancreatic polypeptide-secreting tumors) and <strong>nonfunctioning pancreatic tumors-</strong>&nbsp;are associated with a <strong>worse prognosis</strong> as they often go undiagnosed due to the absence of both clinical features and biochemical abnormalities.</li>\n</ul>\n</li>\n<li><strong>Pituitary tumors-</strong>&nbsp;manifestations depend on the hormone secreted (symptoms of&nbsp;hyperprolactinemia, acromegaly, or Cushing&rsquo;s disease) and tumor size (visual disturbances or hypopituitarism due to compression of the optic chiasm or normal pituitary tissue).&nbsp;</li>\n</ol>\n<p><strong>Surgical excision</strong> of the nonmetastatic tumor after localization is the <strong>curative treatment</strong>. Appropriate medical therapy can be used for some tumors when surgery is contraindicated or unsuccessful (calcimemetics for parathyroid tumors, parietal cell H<sup>+</sup>-K<sup>+</sup>-ATPase inhibitors for gastrinomas). In case of metastasis, chemotherapy, hormonal therapy, radiation therapy, and artery embolization may be successful.</p>\n<p>MEN 1 occurs due to a mutation in the <em>MEN1&nbsp;</em>gene located on <strong>chromosome 11q13</strong>. Mutational genetic analysis is necessary to confirm the clinical diagnosis and identify family members who harbor the mutation and require screening for tumor detection and early treatment.</p>\n<p>Other options:</p>\n<p>Options B and C: <strong>MEN 2</strong>, also called <strong>Sipple&rsquo;s syndrome</strong>, is characterized by medullary thyroid carcinoma (MTC), pheochromocytomas, and parathyroid tumors. This occurs due to mutations of the <strong>rearranged during transfection (RET) protooncogene</strong>. There are three clinical variants -</p>\n<ol>\n<li><strong>MEN 2A</strong> (most common): MTC is associated with pheochromocytomas in 50% of patients and parathyroid tumors in 20% of patients. MEN 2A may also be associated with Hirschsprung&rsquo;s disease and cutaneous lichen amyloidosis.</li>\n<li>MEN 2B<strong>&nbsp;(MEN</strong> <strong>3</strong>): MTC is associated with pheochromocytoma, along with Marfanoid habitus; mucosal neuromas of the lips, tongue, and eyelids; medullated corneal fibers; and intestinal autonomic ganglion dysfunction leading to multiple diverticulae and megacolon. Parathyroid tumors are usually absent.</li>\n<li><strong>MTC only </strong>(FMTC): MTC is the only manifestation.</li>\n</ol>\n<p>Option D:&nbsp;<strong>MEN 4&nbsp;</strong>is characterized by a combination of&nbsp;<strong>MEN 1&ndash;associated tumors</strong> and&nbsp;<strong><em>CDKN1B</em> mutation-related tumors</strong>&nbsp;(gonadal, adrenal, renal, and thyroid tumors).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "AIDS-defining malignancies include all except :",
    "choices": [
      {
        "id": 1,
        "text": "Kaposi's sarcoma"
      },
      {
        "id": 2,
        "text": "Melanoma"
      },
      {
        "id": 3,
        "text": "Invasive cervical carcinoma"
      },
      {
        "id": 4,
        "text": "Non hodgkins lymphoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Melanoma</strong> is <strong><span style=\"color: #000000;\">not</span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> </span></strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">an AIDS-defining malignancy.</span></p>\n<p><strong>AIDS-defining malignancies</strong>\u00a0are those cancers that a <strong>human immunodeficiency virus</strong> (HIV) <strong>infected person</strong> is at a <strong>high risk</strong> of developing. When a HIV-infected person develops one of the AIDS-defining malignancies it suggests that he has AIDS.</p>\n<p>AIDS-defining malignancies include the following:\u00a0</p>\n<ul>\n<li>Kaposi sarcoma - It is a multicentric neoplasm of vascular origin and has strong association with HHV - 8.</li>\n<li>Non-Hodgkins lymphoma and</li>\n<li>Invasive cervical cancer.\u00a0</li>\n</ul>\n<p>Given below is the image of kaposi sarcoma:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0c142d776b354e2084727e15d318b581x1280x1920.JPEG"
    ]
  },
  {
    "text": "An 80-year-old woman was found to have a restrictive disease with reduced lung volumes on a pulmonary function test. A high-resolution CT of the thorax was done and is shown below.  Which of the following is not a feature of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Clubbing of the digits"
      },
      {
        "id": 2,
        "text": "Inspiratory coarse crackles"
      },
      {
        "id": 3,
        "text": "Breathlessness on exertion"
      },
      {
        "id": 4,
        "text": "Non-productive cough"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above HRCT shows a <strong>honeycomb</strong> appearance of lung parenchyma due to <strong>interstitial fibrosis</strong>&nbsp;in a restrictive lung disorder that is suggestive of <strong>interstitial lung disease</strong> (ILD). Inspiratory coarse crackles are not a feature of&nbsp;interstitial lung disease.</p>\n<p>Auscultating a patient with ILD will reveal bilateral basal<strong> end-inspiratory fine</strong> crackles also called <strong>velcro crackles&nbsp;</strong>or rales.</p>\n<p>Patients with interstitial lung disease&nbsp;usually present with a <strong>non-productive cough</strong> and <strong>breathlessness&nbsp;on exertion</strong>.&nbsp;<strong>Clubbing</strong> may be seen on examination, especially in advanced cases.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e0c637fb3638454991acfb8fa0a0a801.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 38-year-old woman presents to the OPD with nausea, vomiting, fatigue, with oliguria for 3 days. On Investigations, urine osmolality was 800 mOsm/kg, urinary sodium 10meq/l, and BUN: Creatinine ratio was 20:1. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pre-renal AKI"
      },
      {
        "id": 2,
        "text": "Renal AKI"
      },
      {
        "id": 3,
        "text": "Post renal AKI"
      },
      {
        "id": 4,
        "text": "Acute cortical necrosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given picture is highly suggestive of <strong>Prerenal AKI </strong>as&nbsp;urine osmolality is &gt;500 mOsm/kg, urinary sodium&lt;20 meq/l, and BUN: Creatinine ratio is 20:1.</p>\n<p>Difference between pre-renal, renal, and post-renal AKI:</p>\n<table style=\"width: 514px;\">\n<tbody>\n<tr style=\"height: 37px;\">\n<td style=\"width: 133px; text-align: center; height: 37px;\">&nbsp;</td>\n<td style=\"width: 117px; text-align: center; height: 37px;\"><strong><span style=\"font-size: 14pt;\">Pre renal&nbsp;</span></strong></td>\n<td style=\"width: 120.296875px; text-align: center; height: 37px;\"><strong><span style=\"font-size: 14pt;\">Renal</span></strong></td>\n<td style=\"width: 131.703125px; text-align: center; height: 37px;\"><strong><span style=\"font-size: 14pt;\">Post renal</span></strong></td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 133px; text-align: center; height: 36px;\"><strong>Urine osmolality</strong></td>\n<td style=\"width: 117px; text-align: center; height: 36px;\">&gt;500 mOsm/kg</td>\n<td style=\"width: 120.296875px; text-align: center; height: 36px;\">&lt;350mOsm/kg</td>\n<td style=\"width: 131.703125px; text-align: center; height: 36px;\">&lt;400 mOsm/kg</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 133px; text-align: center; height: 18px;\"><strong>Urine Na</strong></td>\n<td style=\"width: 117px; text-align: center; height: 18px;\">&lt;20 meq/l</td>\n<td style=\"width: 120.296875px; text-align: center; height: 18px;\">&gt;40meq/l</td>\n<td style=\"width: 131.703125px; text-align: center; height: 18px;\">Variable</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 133px; text-align: center; height: 18px;\"><strong>FeNa</strong></td>\n<td style=\"width: 117px; text-align: center; height: 18px;\">&lt;1</td>\n<td style=\"width: 120.296875px; text-align: center; height: 18px;\">&gt;2</td>\n<td style=\"width: 131.703125px; text-align: center; height: 18px;\">Variable</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 133px; text-align: center; height: 54px;\"><strong>Urine creatinine/plasma creatinine</strong></td>\n<td style=\"width: 117px; text-align: center; height: 54px;\">&gt;40:1</td>\n<td style=\"width: 120.296875px; text-align: center; height: 54px;\">&lt;20:1</td>\n<td style=\"width: 131.703125px; text-align: center; height: 54px;\">&lt;20:1</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 133px; text-align: center; height: 18px;\"><strong>BUN: Creatinine&nbsp;</strong></td>\n<td style=\"width: 117px; text-align: center; height: 18px;\">&gt;20:1</td>\n<td style=\"width: 120.296875px; text-align: center; height: 18px;\">&lt;20:1</td>\n<td style=\"width: 131.703125px; text-align: center; height: 18px;\">&gt;20:1</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 133px; text-align: center; height: 36px;\"><strong>Urine microscopy&nbsp;</strong></td>\n<td style=\"width: 117px; text-align: center; height: 36px;\">Hyaline</td>\n<td style=\"width: 120.296875px; text-align: center; height: 36px;\">Muddy brown cast</td>\n<td style=\"width: 131.703125px; text-align: center; height: 36px;\">Normal or RBC/WBC</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-year-old male is brought to the ER after he was hit by a motorbike as he was crossing the road. He sustained injuries over his abdomen with visible bruising. His blood pressure is 80/50 and IV fluids are immediately instituted. What is the next best step for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Abdominal CT scan"
      },
      {
        "id": 2,
        "text": "Laparotomy"
      },
      {
        "id": 3,
        "text": "Focused abdominal sonography in trauma"
      },
      {
        "id": 4,
        "text": "Diagnostic peritoneal lavage"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span style=\"font-size: 12pt;\">In this patient with a blunt abdominal injury who is <strong>hemodynamically unstable</strong>, the next best step is to do <strong>FAST-focused abdominal sonography in trauma.</strong></span></p>\n<p><span style=\"font-size: 12pt;\">Management of blunt abdominal injury:<strong>\u00a0</strong></span><span style=\"font-size: 12pt;\">Primary assessment (ie, the primary survey) follows the <strong>ABCDE pattern:</strong> Airway, Breathing, Circulation, Disability (neurologic status), and Exposure.</span></p>\n<div class=\"page\" title=\"Page 428\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span style=\"font-size: 12pt;\">Further management depends on the hemodynamic condition of the patient as shown below.</span></p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ba51352d312c43da80b0856956e9e36cx1280x2558.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/08a4eebb63024ddfa920213055bab5f2x1280x1322.JPEG"
    ]
  },
  {
    "text": "A 50-year-old woman presented with long-standing complaints of dysphagia which was getting worse for the past 4 months. A barium swallow was performed and it showed the following finding. Which of the following is the definitive treatment of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Calcium channel blockers"
      },
      {
        "id": 2,
        "text": "Botulinum toxin injection"
      },
      {
        "id": 3,
        "text": "Pneumatic dilation"
      },
      {
        "id": 4,
        "text": "Heller myotomy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The patient likely has&nbsp;<strong>achalasia cardia</strong>&nbsp;and the definitive treatment is <strong>Heller's myotomy</strong>.&nbsp;Surgical management is the first-line treatment modality.&nbsp;</p>\n<p>Achalasia or 'failure to relax' in Greek occurs due to the <strong>lack of ganglion cells</strong> in the <strong>myenteric plexus (Auerbach's)</strong>. The <strong>lower esophageal sphincter</strong> (LES) fails to relax leading to dysphagia, regurgitation of food, and progressive dilation of the esophagus proximal to the constriction.&nbsp;</p>\n<p>Barium radiology&nbsp;shows hold-up in the distal esophagus, abnormal contractions in the oesophageal body, and a tapering stricture in the distal esophagus often described as a <strong>&lsquo;bird&rsquo;s beak&rsquo;.</strong></p>\n<p><strong>Laparoscopic Heller's myotomy</strong> is the procedure of choice. Here, the muscles of the lower esophagus and cardia are cut. However, this can cause iatrogenic gastroesophageal reflux (GERD) due to damage to the lower esophageal sphincter (LES). Thus, newer techniques involve a <strong>partial fundoplication </strong>like<strong> Dor's procedure</strong> to reinforce the sphincter and reduce GERD symptoms.&nbsp;</p>\n<p>Endoscopic myotomy is a newer, alternate procedure. Here, a submucosal tunnel is formed in the mid esophagus region that allows a long myotomy.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7d7c86c2998346b7be5c8528bb1f8056.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/187a53652a8a47f29ef4e32f1400bfefx1280x1947.JPEG"
    ]
  },
  {
    "text": "A patient presents to the casualty ward with right lower abdominal pain, nausea, and fever. On examination, there is increased pain in the right lower quadrant when palpating the left lower quadrant. What is this sign called?",
    "choices": [
      {
        "id": 1,
        "text": "Rovsing sign"
      },
      {
        "id": 2,
        "text": "Aaron sign"
      },
      {
        "id": 3,
        "text": "Dunphy sign"
      },
      {
        "id": 4,
        "text": "McBurney sign"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given triad of clinical features, namely\u00a0<strong>fever</strong>,\u00a0<strong>nausea,</strong>\u00a0and\u00a0<strong>right lower abdominal pain,</strong>\u00a0is the\u00a0<strong>Murphy triad</strong>. It is suggestive of\u00a0<strong>acute appendicitis</strong>. Deep palpation of the left iliac fossa can cause pain in the right iliac fossa. This sign is called the\u00a0<strong>Rovsing sign.</strong></p>\n<p>This pain is due to the backflow of gases from the colon into the inflamed right intestine when the\u00a0left\u00a0lower abdomen is palpated.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Aaron sign-</strong>Pain or pressure in epigastrium or anterior chest with persistent firm pressure applied to McBurney\u2019s point. It is seen in acute appendicitis.</p>\n<p>Option C:\u00a0<strong>Dunphy sign-</strong>pain on coughing.It is seen in acute appendicitis.</p>\n<p>Option D: <strong>McBurney sign</strong>-it refers to deep tenderness at McBurney's point. It is seen in acute appendicitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A mother brought her 16-year-old daughter to the hospital with the complaints of primary amenorrhea. On evaluation axillary and pubic hair were present and other secondary sexual characteristics normal.LH and FSH levels are normal and USG showed absence of uterus.What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Turner syndrome"
      },
      {
        "id": 2,
        "text": "MRKH syndrome"
      },
      {
        "id": 3,
        "text": "Androgen insensitivity syndrome"
      },
      {
        "id": 4,
        "text": "Sweyer syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The child does not have any uterus but has normal sex hormones and normal secondary sexual characteristics suggesting it is a case of <strong>MRKH(</strong>\u00a0<strong>Mayer-Rokitansky-Kuster-Hauser</strong>).</p>\n<p>A similar presentation is seen in\u00a0<strong>Androgen insensitivity\u00a0</strong>but LH and FSH levels would be abnormal in that case.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4257f8966b544707afce47139f9873bbx1280x2558.PNG"
    ]
  },
  {
    "text": "Ovarian drilling is done in which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Ovarian tumor"
      },
      {
        "id": 2,
        "text": "Polycystic ovarian syndrome"
      },
      {
        "id": 3,
        "text": "Ovarian hyperstimulation syndrome"
      },
      {
        "id": 4,
        "text": "Endometriosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Laparoscopic Ovarian drilling</strong> is a surgical management procedure done for<strong> Polycystic ovarian syndrome</strong>(PCOS)<strong>.\u00a0\u00a0</strong></p>\n<p>PCOS is an endocrinopathy seen in women of reproductive age, affecting multiple systems. The\u00a0<strong>Rotterdam criteria</strong>\u00a0is used to diagnose PCOS. The presence of\u00a0<strong>any two of the three</strong>\u00a0components of this criteria establishes the diagnosis of PCOS.</p>\n<ul>\n<li>Clinical/biochemical hyperandrogenism (<strong>hirsutism</strong>, acne)</li>\n<li><strong>Menstrual abnormalities (Oligo/amenorrhoea)</strong>, anovulation, infertility</li>\n<li><strong>Polycystic ovaries\u00a0</strong>on ultrasound.</li>\n</ul>\n<div class=\"page\" title=\"Page 424\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Sonographic criteria for polycystic ovaries include \u2265 20 follicles and/or an increased ovarian volume (&gt; 10 mL) or both.\u00a0</p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>The ultrasound</strong> image given below shows an <strong>enlarged ovary </strong>seen in PCOS with multiple follicles in the periphery.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/452854eb73d749aea3e9504878fdbb01x533x400.JPEG"
    ]
  },
  {
    "text": "A primigravida was admitted in labor at 38 weeks of gestation. In view of the prolonged second stage of labor, a mediolateral episiotomy was given to aid instrumental delivery.  It is usually angled at ______",
    "choices": [
      {
        "id": 1,
        "text": "15 degrees"
      },
      {
        "id": 2,
        "text": "30 degrees"
      },
      {
        "id": 3,
        "text": "60 degrees"
      },
      {
        "id": 4,
        "text": "45 degrees"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The mediolateral episiotomy is angled at <strong>60&deg;</strong>.</p>\n<p>Episiotomy is a<span style=\"font-size: 14px;\">&nbsp;surgically planned incision on the perineum and the posterior vaginal wall during the second stage of labour. It is done to&nbsp;</span></p>\n<div class=\"page\" title=\"Page 555\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>To enlarge the vaginal introitus&nbsp;<span style=\"font-size: 14px;\">so as to facilitate easy and safe delivery of the fetus.</span></li>\n<li><span style=\"font-size: 14px;\">To minimize overstretching and rupture of the perineal muscles and fascia</span></li>\n<li><span style=\"font-size: 14px;\">To reduce the stress and strain on the fetal head.</span></li>\n</ul>\n<p><span style=\"font-size: 14px;\">It is given <strong>during crowning</strong>&nbsp;</span><span style=\"font-size: 14px;\">when the head is visible. There are many types like median, mediolateral, lateral and j shaped. Among these, mediolateral episiotomy is preferred.</span></p>\n<div class=\"page\" title=\"Page 524\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The mediolateral episiotomy begins at the midline of the fourchette&nbsp;<span style=\"font-size: 14px;\">and is directed to the right or left at an <strong>angle 60 degrees off the midline.&nbsp;</strong></span><span style=\"font-size: 14px;\">This angle accounts for stretch distortion of perineal anatomy during crowning.&nbsp;</span><span style=\"font-size: 14px;\">After delivery and distortion resolution, it ultimately yields an incision 45-degrees from the midline.</span></p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 555\">&nbsp;</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 6 month old child weighing  7 kg with history of 8-10 episodes of loose stools is lethargic with loss of skin turgor and sunken anterior fontanelle. He is evaluated to have severe dehydration. How much fluid should be given in the first 1 hour of fluid resuscitation ?",
    "choices": [
      {
        "id": 1,
        "text": "140 ml"
      },
      {
        "id": 2,
        "text": "210 ml"
      },
      {
        "id": 3,
        "text": "350 ml"
      },
      {
        "id": 4,
        "text": "420 ml"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This child with <strong>severe dehydration</strong> should be resuscitated with<strong> 210 ml</strong> of IV fluids in the <strong>first one hour.</strong></p>\n<p>According to IMNCI guidelines, <strong>severe dehydration</strong> requires treatment with <strong>IV fluids (Plan C)</strong>. Rehydration with <strong>100ml/kg</strong> of IV fluids is done as shown below :</p>\n<table>\n<tbody>\n<tr>\n<td>Age</td>\n<td>30ml/kg</td>\n<td>70ml/kg</td>\n</tr>\n<tr>\n<td><strong>&lt;12 mo</strong></td>\n<td><strong>1 hr</strong></td>\n<td><strong>5 hr</strong></td>\n</tr>\n<tr>\n<td><strong>&gt;12 mo</strong></td>\n<td><strong>30 min</strong></td>\n<td><strong>2.5 hr</strong></td>\n</tr>\n</tbody>\n</table>\n<p>As this child is <strong>&lt; 12 months</strong> of age, in the<strong> first one hour</strong>, fluid requirement = 30ml/kg i.e. 30*7 = <strong>210 ml.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old man with end-stage renal disease presents with back pain. He gives a history of frequent pathological fractures. Identify the characteristic finding seen in his lumbosacral radiograph given below.",
    "choices": [
      {
        "id": 1,
        "text": "Picture frame vertebrae"
      },
      {
        "id": 2,
        "text": "Ivory vertebrae"
      },
      {
        "id": 3,
        "text": "Bamboo spine"
      },
      {
        "id": 4,
        "text": "Rugger jersey spine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The radiograph given above shows a <strong>Rugger jersey spine </strong>which is a characteristic feature of renal osteodystrophy. The given clinical scenario is suggestive of <strong>renal osteodystrophy</strong> which is caused by hyperparathyroidism secondary to chronic renal disease.&nbsp;</p>\n<p>Rugger jersey appearance is seen due to <strong>osteosclerosis </strong>of the superior and inferior <strong>vertebral endplates</strong>. This occurs due to excess osteoid formation by the osteoblasts to counteract increased bone resorption. The term&nbsp;'rugger jersey&rsquo; appearance is used because there are alternating bands of increased and decreased bone density,<strong>&nbsp;</strong>similar to the jersey of a rugby player.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e3c7e2b039be48bab348c1d52f85e646.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/885075e8b2bd4b299d38510c8c033898x487x387.JPEG"
    ]
  },
  {
    "text": "A 35-year-old female complains of headache, backache, decreased sexual desire, vomiting, and diarrhoea. This is associated with weakness and paralysis. On further probing, no organic cause is found. What is your diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hypochondriasis"
      },
      {
        "id": 2,
        "text": "Somatic symptom disorder"
      },
      {
        "id": 3,
        "text": "Adjustment Disorder"
      },
      {
        "id": 4,
        "text": "Malingering"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The presence of one or more<strong> somatic symptoms</strong> in the absence of an organic cause for <strong>more than 6 months</strong> is suggestive of <strong>somatic symptom disorder</strong>.</p>\n<div class=\"page\" title=\"Page 355\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>DSM-5 criteria for the diagnosis of somatic symptom disorder:&nbsp;</strong></p>\n<ul>\n<li>One or more somatic symptoms that are distressing or result in significant disruption of daily life.</li>\n<li>Excessive thoughts, feelings, or behaviors related to the somatic symptoms or associ&shy;ated health concerns as manifested by at least one of the following:\n<ul>\n<li>Disproportionate and persistent thoughts about the seriousness of one&rsquo;s symptoms.</li>\n<li>Persistently high level of anxiety about health or symptoms.</li>\n<li>Excessive time and energy devoted to these symptoms or health concerns.</li>\n</ul>\n</li>\n<li>Although any one somatic symptom may not be continuously present, the state of be&shy;ing symptomatic is persistent (typically more than 6 months).</li>\n</ul>\n<p>&nbsp;Treatment: <strong>Psychotherapy</strong></p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child with tetralogy of fallot is planned for corrective surgery. Which is the ideal induction agent of choice?",
    "choices": [
      {
        "id": 1,
        "text": "Thiopentone"
      },
      {
        "id": 2,
        "text": "Propofol"
      },
      {
        "id": 3,
        "text": "Etomidate"
      },
      {
        "id": 4,
        "text": "Ketamine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Ketamine is the induction agent of choice in patients with Tetralogy of Fallot because it maintains or <strong>increases systemic vascular resistance and increases cardiac output.&nbsp;</strong>Thus it does not aggravate the right to left shunt seen in such cases.</p>\n<p>Tetralogy of Fallot is characterized by subpulmonic stenosis, right ventricular hypertrophy, ventricular septal defect and overriding of the aorta. This results in a right to left shunt through the ventricular septal defect and consequent cyanosis. Ketamine does not increase pulmonary vascular resistance and is safe to administer in children.</p>\n<p>Ketamine is the <strong>agent of choice in all congenital heart diseases with cyanosis.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 17-year-old girl presents with lesions on her face as shown in the image. Identify the disease.",
    "choices": [
      {
        "id": 1,
        "text": "Acne vulgaris"
      },
      {
        "id": 2,
        "text": "Acne rosacea"
      },
      {
        "id": 3,
        "text": "Seborrheic dermatitis"
      },
      {
        "id": 4,
        "text": "Rhinophyma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The Image shows typical erythematous papules and nodules along with few whiteheads. The&nbsp;face appears to be very oily as well which suggests&nbsp;<strong>acne&nbsp;vulgaris. </strong>This comes under grade<strong> III </strong>acne<strong>.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f99cdc75d0bf4983bb61481dfbb0de18.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Obliteration of right cardiac border on chest X-Ray indicates pathology involving which of the following structures?",
    "choices": [
      {
        "id": 1,
        "text": "Right lower lobe"
      },
      {
        "id": 2,
        "text": "Right atrium"
      },
      {
        "id": 3,
        "text": "Right middle lobe"
      },
      {
        "id": 4,
        "text": "Right ventricle"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Right middle lobe pathology causes obliteration of right cardiac border.</p>\n<p>The<strong> silhouette sign</strong> is the loss of clear demarcation between normal lung and soft tissue (e.g., heart, diaphragm). This occurs when the lung parenchyma is no longer filled with air and the contrast between air and soft tissue is lost.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a83317ddbc9a42e7b2b7261e28690774x1024x472.JPEG"
    ]
  },
  {
    "text": "The Bone scan in multiple myeloma shows _____",
    "choices": [
      {
        "id": 1,
        "text": "Hot spot"
      },
      {
        "id": 2,
        "text": "Cold spot"
      },
      {
        "id": 3,
        "text": "Diffusely increased uptake"
      },
      {
        "id": 4,
        "text": "Diffusely decreased uptake"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The Bone scan in <strong>multiple myeloma</strong> shows\u00a0<strong>cold spot,\u00a0</strong>as there is <strong>no compensatory osteoblastic activity.</strong></p>\n<p>Multiple myelomas are the most common primary malignant bone neoplasm in adults arising from red marrow due to the monoclonal proliferation of the <strong>plasma cells.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The most common complication following splenectomy is _______.",
    "choices": [
      {
        "id": 1,
        "text": "Overwhelming post-splenectomy infection (OPSI)"
      },
      {
        "id": 2,
        "text": "Avascular necrosis of greater curvature of stomach"
      },
      {
        "id": 3,
        "text": "Pancreatitis"
      },
      {
        "id": 4,
        "text": "Left lower lobe atelectasis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Left lower lobe atelectasis</strong> is the most common complication after splenectomy.</p>\n<p>Other complications of splenectomy include:</p>\n<ul>\n<li><strong>OPSI</strong>&nbsp;(Overwhelming post-splenectomy infection)is the&nbsp;<strong>most common fatal</strong>&nbsp;late complication of splenectomy.</li>\n<li><strong>Avascular necrosis</strong>&nbsp;of the greater curvature of the stomach is a&nbsp;<strong>rare</strong>&nbsp;complication that can occur after<strong>&nbsp;ligation</strong>&nbsp;of&nbsp;<strong>short gastric vessels</strong>.</li>\n<li>Damage to the&nbsp;<strong>tail&nbsp;</strong>of the<strong>&nbsp;pancreas</strong>&nbsp;during surgery can lead to pancreatitis, a localized abscess, or&nbsp;<strong>pancreatic fistula.</strong></li>\n<li><strong>Hemorrhage&nbsp;</strong>during the perioperative period etc.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 12';
        const quizFilename = 'fmge-mini-test-12-47240835.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>