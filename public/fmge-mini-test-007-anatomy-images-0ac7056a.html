<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 007 (Anatomy Images) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Fibers from the marked structure end in which of the following areas of the thalamus?",
    "choices": [
      {
        "id": 1,
        "text": "Posterior nucleus"
      },
      {
        "id": 2,
        "text": "Reticular nucleus"
      },
      {
        "id": 3,
        "text": "Anterior nucleus"
      },
      {
        "id": 4,
        "text": "Ventral Lateral nucleus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The structure marked in the above image is <strong>mamillary body</strong> and the fibers from the mamillary body end in the&nbsp;<strong>anterior nucleus of the thalamus.</strong></p>\n<p><strong>The mammillary bodies</strong>&nbsp;are two small hemispherical, pea-sized eminences, lying side by side, forming the floor of the third ventricle. The fibres from medial mammillary nucleus project to the <strong>anterior nucleus</strong> of the thalamus.</p>\n<p>The<strong>&nbsp;anterior thalamic nuclei</strong>&nbsp;have 3 subdivisions&mdash;anteroventral nucleus, anteromedial nucleus, and anterodorsal nucleus.</p>\n<ul>\n<li>Major input:&nbsp;<strong>Mamillothalamic tract</strong>&nbsp;from the mammillary nuclei of the hypothalamus.</li>\n<li>Major cortical output:&nbsp;<strong>Anterior limbic area, cingulate, and the parahippocampal gyrus</strong>&nbsp;</li>\n<li>Major function:\n<ul>\n<li>Regulation of&nbsp;<strong>alertness and attention</strong></li>\n<li>Acquisition of&nbsp;<strong>memory</strong></li>\n</ul>\n</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/eb4112f782fa4eafa8945950974bd6ec.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "During a clinical assessment, a neurologist stimulates a specific structure to evaluate the sensory supply from a cranial nerve. Which cranial nerve's sensory function is being assessed by touching the highlighted structure in the image?",
    "choices": [
      {
        "id": 1,
        "text": "IX"
      },
      {
        "id": 2,
        "text": "X"
      },
      {
        "id": 3,
        "text": "XI"
      },
      {
        "id": 4,
        "text": "XII"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The structure marked in the given sagittal section of the head and neck is the <strong>uvula</strong>. The sensory supply by the <strong>glossopharyngeal nerve (CN IX) </strong>\u00a0is tested in this case.</p>\n<p>Innervation of the soft palate:</p>\n<ul>\n<li><strong>General</strong> sensation - <strong>Lesser palatine </strong>nerve(branch of maxillary nerve) and the pharyngeal branches of the <strong>glossopharyngeal</strong> nerve\u00a0</li>\n<li><strong>Taste</strong> sensation - <strong>Lesser palatine</strong> nerve.</li>\n<li><strong>Secretomotor</strong> supply -<strong>Lesser palatine</strong> nerve via postganglionic fibres from the <strong>pterygopalatine</strong> <strong>ganglion</strong>.</li>\n<li><strong>Motor</strong> supply - Pharyngeal branch of the <strong>vagus</strong> nerve (except stylopharyngeus - supplied by the glossopharyngeal nerve)</li>\n</ul>\n<p><strong>Pharyngeal plexus</strong>:\u00a0The nerve supply of the pharynx is mainly from the pharyngeal plexus. The pharyngeal branches of the glossopharyngeal nerve and vagus nerve form it. (It also has contributions from the superior cervical ganglion) The <strong>vagus</strong> nerve provides the <strong>motor supply</strong> and the <strong>glossopharyngeal</strong> nerve provides the <strong>sensory</strong> supply.</p>\n<p>Nerve supply by<strong> glossopharyngeal </strong>nerve:</p>\n<ul>\n<li>Sensory fibres to the\u00a0<strong>uvula</strong>, tympanic cavity, pharyngotympanic tube, tonsils, fauces,\u00a0nasopharynx, and posterior third of the tongue.</li>\n<li>Motor fibres to the <strong>stylopharyngeus</strong> muscle</li>\n<li>Parasympathetic secretomotor fibres to the<strong> parotid gland</strong></li>\n<li><strong>Gustatory</strong> fibres for the posterior<strong> 1/3rd</strong> of the tongue.</li>\n</ul>\n<p>Nerve supply by the <strong>pharyngeal branch of the vagus</strong> nerve:</p>\n<ul>\n<li>All the muscles of the soft palate (except tensor veli palatini - supplied by mandibular division of the trigeminal nerve)</li>\n<li>All the muscles of the pharynx(except stylopharyngeus - supplied by the glossopharyngeal nerve)\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/30f5632b10994a94b9c0f61c5565ba36.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the labelled structure in the image?",
    "choices": [
      {
        "id": 1,
        "text": "Midbrain"
      },
      {
        "id": 2,
        "text": "Pons"
      },
      {
        "id": 3,
        "text": "Medulla"
      },
      {
        "id": 4,
        "text": "Cerebellum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The labelled structure contains the <strong>tectum,</strong>&nbsp;<strong>tegmentum</strong> and <strong>crus cerebri</strong> which are part of the&nbsp;<strong>midbrain.</strong></p>\n<p>The image given below shows the cross-section of the midbrain.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b4f705b7152d44b2b264978b5a8b202d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f58171fcf1e4c1f983f59efc88467bax800x454.PNG"
    ]
  },
  {
    "text": "Identify the thickened nerve marked in the arrow in the image shown below:",
    "choices": [
      {
        "id": 1,
        "text": "Great auricular nerve"
      },
      {
        "id": 2,
        "text": "Lesser occipital nerve"
      },
      {
        "id": 3,
        "text": "Facial nerve"
      },
      {
        "id": 4,
        "text": "Auriculotemporal nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\">The thickened nerve marked with the arrow in the above image is the <strong>great auricular nerve</strong> and&nbsp;the thickened nerve visible below the great auricular nerve is the transverse cervical nerve.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/56d2ae9975f145b4b921e8320113db6b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fd759dee0552424f8ce1aa00fbf6d806x1280x2163.JPEG"
    ]
  },
  {
    "text": "The dermatome of the area marked in the given below image is__.",
    "choices": [
      {
        "id": 1,
        "text": "L4"
      },
      {
        "id": 2,
        "text": "L5"
      },
      {
        "id": 3,
        "text": "S1"
      },
      {
        "id": 4,
        "text": "S2"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The\u00a0<strong>medial side of the leg</strong> and <strong>medial malleolus</strong>\u00a0is supplied by the\u00a0<strong>L4</strong> dermatome.</p>\n<table style=\"width: 379px;\">\n<tbody>\n<tr>\n<td style=\"width: 80.1484px;\"><strong>Dermatome </strong></td>\n<td style=\"width: 287.852px;\"><strong>Area supplied </strong></td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">L1</td>\n<td style=\"width: 287.852px;\">Inguinal area (over inguinal canal)</td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">L2</td>\n<td style=\"width: 287.852px;\">Anterior and lateral part of upper 2/3rd of thigh</td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">L3</td>\n<td style=\"width: 287.852px;\">Anterior, lateral, medial parts of lower 1/3rd of thigh and knee</td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">L4</td>\n<td style=\"width: 287.852px;\"><strong>Medial side of leg</strong>, medial malleolus</td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">L5</td>\n<td style=\"width: 287.852px;\">Lateral side of leg, medial half of dorsum of foot, dorsum of first web space</td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">S1</td>\n<td style=\"width: 287.852px;\">Posterior surface of ankle, lateral half of dorsum of foot</td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">S2</td>\n<td style=\"width: 287.852px;\">Posterior surface of thigh and leg</td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">S3</td>\n<td style=\"width: 287.852px;\">Gluteal area around perianal region, groin</td>\n</tr>\n<tr>\n<td style=\"width: 80.1484px;\">S4</td>\n<td style=\"width: 287.852px;\">Perianal skin and groin</td>\n</tr>\n</tbody>\n</table>\n<p>These dermatomes may vary considerably and overlap with each other. However, the overlap is minimal along the axial lines as shown in the image below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2d2e2781266d4fccaf6ce4f9655ce7bd.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0eedb75dde8946ba982347922b0ac1cex1280x2558.JPEG"
    ]
  },
  {
    "text": "Which of the following structures does not pass through the foramen marked with the black arrow in the image given below?",
    "choices": [
      {
        "id": 1,
        "text": "Emissary veins"
      },
      {
        "id": 2,
        "text": "Middle meningeal artery"
      },
      {
        "id": 3,
        "text": "Lesser petrosal nerve"
      },
      {
        "id": 4,
        "text": "Accessory meningeal artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The foramen marked in the image is the <strong>foramen</strong> <strong>ovale</strong>. The <strong>middle meningeal artery</strong> does not pass through the foramen ovale. It passes through the <strong>foramen spinosum</strong>.</p>\n<p>The structures passing through the foramen ovale are:</p>\n<ul>\n<li><strong>Mandibular division </strong>of the<strong> trigeminal nerve</strong>&nbsp;</li>\n<li><strong>A</strong>ccessory meningeal artery</li>\n<li><strong>L</strong>esser petrosal nerve</li>\n<li><strong>E</strong>missary veins&nbsp;</li>\n</ul>\n<p>These structures can be remembered using the mnemonic 'MALE'. &nbsp;&nbsp;</p>\n<p>The structures passing through the<strong> foramen spinosum</strong> are:</p>\n<ul>\n<li>Middle meningeal artery</li>\n<li>Nervus spinosus (meningeal branch of mandibular nerve)</li>\n<li>Middle meningeal vein</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/095d9eb710234fd58486755251067462.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c2b7083ef012475d9aebef2d54f11f8cx1280x1198.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17218674842e4fa39be51de087788127x1279x1439.JPEG"
    ]
  },
  {
    "text": "Which structure is supplied by the nerve causing this elevation?",
    "choices": [
      {
        "id": 1,
        "text": "Lateral rectus"
      },
      {
        "id": 2,
        "text": "Superior oblique"
      },
      {
        "id": 3,
        "text": "Risorius"
      },
      {
        "id": 4,
        "text": "Levator palpebrae superioris"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows the <strong>floor</strong> of the <strong>fourth ventricle</strong> and the<strong> facial colliculus</strong> which is an elevation caused by the <strong>facial nerve</strong>. Among the given options&nbsp;<strong>risorius</strong> is supplied by&nbsp;the <strong>facial nerve</strong>.</p>\n<p>The fourth ventricle is located between the brainstem and the cerebellum. The <strong>rhomboid&nbsp;fossa </strong>is a diamond-shaped depression seen on&nbsp;the floor of the fourth ventricle. The superior and the inferior part of the floor is triangular in shape. It is divided by a longitudinal median sulcus into two halves. Each half is again divided into the medial and lateral regions.</p>\n<p>The <strong>facial&nbsp;colliculus&nbsp;</strong>is present in&nbsp;the superior part, which presents as a small<strong> elevation</strong> produced by the root of the<strong> facial nerve</strong> winding around the <strong>nucleus of the abducens nerve.</strong>&nbsp; Columns are formed by groups of facial neurones, which innervate individual muscles and give branches of the <strong>facial nerve</strong>. Dorsal neurones innervate muscles in the scalp and upper face and ventral neurons supply the lower facial musculature.&nbsp;</p>\n<p>Risorius falls under the <strong>buccolabial</strong> muscle group and act as the elevator, retractor and evertor of the <strong>upper lip.</strong> Some of its peripheral attachments are&nbsp;the <strong>zygomatic arch</strong>,&nbsp;<strong>parotid fascia</strong> and fascia over the <strong>mastoid process</strong>. It is involved in actions like <strong>grinning</strong> and<strong> laughing</strong> and is innervated by the buccal branches of the <strong>facial nerve.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ee8f2381e642401aa57004046990cb37.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a1f578806088492887e3ff6f6009daeex960x720.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d2f31749f5904aa68b1e90de050f7cbdx1280x1427.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/49e2404964514480b84dd2c92f33e261x1279x1777.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da502ce1c9f246cda9874a89a8b4fda3x1280x1901.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8ddf6e73dd044f34870b54c5ae1d2dcfx960x720.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/95cb33240ab1436b89b9d536cc1de227x960x720.JPEG"
    ]
  },
  {
    "text": "A patient presents with a unilateral throbbing headache, photophobia, and excessive lacrimation. He also complains of hemifacial pain on clenching of teeth. On examination, pupillary reaction, light reflex, and accommodation reflex are normal. Which of the following marked nerves is involved in the above scenario?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above patient presents with features suggesting an involvement of the<strong> trigeminal nerve</strong>. The<strong> structure</strong> marked<strong>&nbsp;3</strong>&nbsp;is the trigeminal nerve.</p>\n<p>Other marked structures:</p>\n<ul>\n<li>1- <strong>Optic nerve.</strong> The normal visual field and light reflex rules&nbsp;out the involvement of the optic nerve.</li>\n<li>2- <strong>Oculomotor nerve.</strong> Normal accommodation&nbsp;and pupillary&nbsp;reflex rule out the involvement of the oculomotor nerve.</li>\n<li>4- <strong>Facial nerve.</strong> Absence of motor involvement of the face rule out the involvement of the facial nerve.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/26938d5dfe474fd38d2249e96980a70b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ca464937a5cd4c08b205e6c0fca6ff30x600x817.JPEG"
    ]
  },
  {
    "text": "Identify the marked structure:",
    "choices": [
      {
        "id": 1,
        "text": "Asterion"
      },
      {
        "id": 2,
        "text": "Glabella"
      },
      {
        "id": 3,
        "text": "Pterion"
      },
      {
        "id": 4,
        "text": "Nasion"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The structure marked in the image is the&nbsp;<strong>pterion.&nbsp;</strong></p>\n<p>The pterion is an&nbsp;<strong>H-shaped sutural junction</strong>&nbsp;between four bones of the skull:</p>\n<ol>\n<li>Frontal bone</li>\n<li>Squamous part of the temporal bone</li>\n<li>Greater wing of the sphenoid bone</li>\n<li>Parietal bone</li>\n</ol>\n<p>It is located approximately <strong>4 cm above</strong> the <strong>midpoint</strong> of the&nbsp;<strong>zygomatic</strong> arch.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/87328ba0712c435084c2cdbbd54edb4b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dc81c0a94d7a40f28052b990aa39f8e8x1280x1525.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3dea3f58f8aa498d81f60998535a309bx600x666.JPEG"
    ]
  },
  {
    "text": "A middle-aged female comes to the clinic for follow-up three weeks after left parotidectomy. She complains of flushing, sweating, and burning sensation on the left side of her face every time she sits down to have a meal. The postganglionic parasympathetic nerve fibers of which of the following nerves is the likely culprit for this patient's symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "A"
      },
      {
        "id": 2,
        "text": "C"
      },
      {
        "id": 3,
        "text": "D"
      },
      {
        "id": 4,
        "text": "B"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-preserver-spaces=\"true\">The symptom complex in this patient along with a history of recent parotid surgery is indicative of\u00a0</span><strong><span data-preserver-spaces=\"true\">Frey's syndrome</span></strong><span data-preserver-spaces=\"true\">\u00a0in which the</span><strong><span data-preserver-spaces=\"true\">\u00a0auriculotemporal nerve\u00a0</span></strong><span data-preserver-spaces=\"true\">marked as \"D\" is involved.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c3c0d42a5deb4c20bc4fe6b43865763a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4207d4989f2f495b906deda0fb198537x646x582.PNG"
    ]
  },
  {
    "text": "What is the structure marked in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Genioglossus"
      },
      {
        "id": 2,
        "text": "Hyoglossus"
      },
      {
        "id": 3,
        "text": "Styloglossus"
      },
      {
        "id": 4,
        "text": "Palatoglossus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The structure marked in the image is the Genioglossus muscle.</p>\n<p><strong>Genioglossus</strong>\u00a0is one of the extrinsic muscles of the tongue which<strong>\u00a0</strong>bring about the forward traction of the tongue to protrude its apex from the mouth. Hence, it is also called the<strong> safety muscle of the tongue.</strong></p>\n<p>Origin: <strong>The superior mental spine</strong> (also called the superior genial tubercle) of the mandible, located on the internal surface of the mandible near the symphysis (midline).<br />Insertion: The muscle fans out and inserts into the entire length of the inferior surface of the tongue and the<strong> body of the hyoid bone.</strong></p>\n<p>Acting bilaterally, the two muscles depress the central part of the tongue, making it concave from side to side. Acting unilaterally, the tongue diverges to the opposite side.</p>\n<p>Other options:</p>\n<p>Option B:<strong> Hyoglossus:</strong> depresses the tongue</p>\n<p>Option C: <strong>Styloglossus:</strong> draws the tongue up and backward.</p>\n<p>Option D:<strong> Palataglossus:</strong> elevate the posterior portion of the tongue</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c0cc942ba9fe4ac4b028e66354bb2e47.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/087f05c6f44f4001bceaecd5f2a50037x600x554.JPEG"
    ]
  },
  {
    "text": "Which of the following nerve can be injured, when a fracture is sustained at the area marked with the red arrow in the given image?",
    "choices": [
      {
        "id": 1,
        "text": "Radial nerve"
      },
      {
        "id": 2,
        "text": "Median nerve"
      },
      {
        "id": 3,
        "text": "Ulnar nerve"
      },
      {
        "id": 4,
        "text": "Musculocutaneous nerve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given image the arrow points to the medial epicondyle. Fracture at the\u00a0<strong>medial epicondyle</strong>\u00a0damages the<strong>\u00a0ulnar nerve</strong>.\u00a0</p>\n<p>The nerves related to the<strong>\u00a0humerus </strong>are:</p>\n<ul>\n<li><strong>Axillary</strong>\u00a0nerve is at the\u00a0<strong>surgical neck</strong>\u00a0</li>\n<li><strong>Ulnar</strong>\u00a0nerve is at the\u00a0<strong>medial epicondyle</strong></li>\n<li><strong>Radial</strong>\u00a0nerve is at the\u00a0<strong>spiral groove</strong>\u00a0of the shaft of the humerus.\u00a0</li>\n</ul>\n<p><strong>Ulnar nerve branches and supply:\u00a0</strong></p>\n<p><strong>Superficial branch\u00a0</strong>supplies\u00a0<strong>palmaris brevis</strong>, skin on the\u00a0<strong>palmar surface</strong>\u00a0of\u00a0<strong>medial 1\u00bd\u00a0fingers</strong>. The\u00a0<strong>deep\u00a0branch</strong>\u00a0runs within the concavity of deep palmar arch and supplies\u00a0<strong>all</strong>\u00a0<strong>intrinsic muscles</strong>\u00a0of the hand (<strong>except</strong>\u00a0first\u00a0<strong>2 lumbricals</strong>\u00a0<strong>and thenar muscles</strong>).</p>\n<p>Injury to the ulnar nerve can be as follows:</p>\n<table style=\"height: 898px; width: 379px;\">\n<tbody>\n<tr style=\"height: 47px;\">\n<td style=\"width: 64px; height: 47px; text-align: center;\">\u00a0</td>\n<td style=\"width: 131.213px; height: 47px; text-align: center;\"><strong>High lesion <br />(Elbow)\u00a0</strong></td>\n<td style=\"width: 161.787px; height: 47px; text-align: center;\"><strong>Low lesion\u00a0<br />(Wrist)\u00a0</strong></td>\n</tr>\n<tr style=\"height: 241px;\">\n<td style=\"width: 64px; height: 241px;\"><strong>Site of injury</strong></td>\n<td style=\"width: 131.213px; height: 241px; text-align: left; vertical-align: top;\">\n<ul>\n<li>Fracture/dislocation of the <strong>medial epicondyle</strong></li>\n<li>Cubital tunnel syndrome</li>\n<li>Compression between the two heads of FCU</li>\n<li>Tardy ulnar nerve palsy (Valgus deformity)</li>\n</ul>\n</td>\n<td style=\"width: 161.787px; height: 241px; text-align: left; vertical-align: top;\">\n<ul>\n<li style=\"text-align: left;\">Wrist laceration/ slashing</li>\n<li style=\"text-align: left;\"><strong>Guyon's canal</strong> syndrome</li>\n</ul>\n</td>\n</tr>\n<tr style=\"height: 347px;\">\n<td style=\"width: 64px; height: 347px;\"><strong>Motor loss</strong></td>\n<td style=\"width: 131.213px; height: 347px; text-align: left; vertical-align: top;\">\n<ul>\n<li><strong>Claw-hand</strong> deformity</li>\n<li>Hypothenar &amp; interosseous wasting</li>\n<li>Loss of:\n<ul>\n<li>Abduction &amp; adduction of fingers <br />(<strong>Card test</strong> - Positive)</li>\n<li>Adduction of thumb <br />(<strong>Froment sign-</strong> Positive)</li>\n<li>Flexion of MCP joints</li>\n</ul>\n</li>\n<li>Weakness of wrist flexion (radial deviation)</li>\n</ul>\n</td>\n<td style=\"width: 161.787px; height: 347px; text-align: left; vertical-align: top;\">\n<ul>\n<li><strong>Claw-hand</strong> deformity <br /><strong>(more pronounced)</strong></li>\n<li>Hypothenar &amp; interosseous wasting</li>\n<li>Loss of:\n<ul>\n<li>Abduction &amp; adduction of fingers <br />(<strong>Card test</strong> - Positive)</li>\n<li>Adduction of thumb <br />(<strong>Froment sign-</strong> Positive)</li>\n</ul>\n</li>\n</ul>\n</td>\n</tr>\n<tr style=\"height: 162px;\">\n<td style=\"width: 64px; height: 162px;\"><strong>Sensory loss</strong></td>\n<td style=\"width: 131.213px; height: 162px; text-align: left; vertical-align: top;\">\n<ul>\n<li>Over palmar &amp; dorsal aspect of the <strong>medial third</strong> of the <strong>hand</strong></li>\n<li>Over palmar &amp; dorsal aspect of the <strong>medial 1 <sup>1</sup>/<sub>2</sub> fingers</strong></li>\n</ul>\n</td>\n<td style=\"width: 161.787px; height: 162px; text-align: left; vertical-align: top;\">\n<ul>\n<li><strong>No sensory loss</strong> over palmar &amp; dorsal aspect of the medial third of the hand</li>\n<li>Over palmar &amp; dorsal aspect of the <strong>medial 1 <sup>1</sup>/<sub>2</sub> fingers</strong></li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Other tests seen in ulnar nerve lesions are as follows:</p>\n<ul>\n<li>Claw hand deformity</li>\n<li>Froment's sign positive</li>\n<li>Wartenberg sign</li>\n<li>Palmaris brevis sign</li>\n</ul>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>The image below shows a positive card test:</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5b8c1f21807b41fc98cbe25aa398abcd.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ae6e924757bf4462a2bf2f9b5fd4a34bx1280x1335.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/26e784d60e25418088be895be2b2a58bx1279x395.PNG"
    ]
  },
  {
    "text": "What is the nerve supply of the structure marked in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Oculomotor nerve"
      },
      {
        "id": 2,
        "text": "Trochlear nerve"
      },
      {
        "id": 3,
        "text": "Trigeminal nerve"
      },
      {
        "id": 4,
        "text": "Abducens nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The structure marked in the image is the&nbsp;<strong>superior oblique muscle. </strong>It is innervated by the <strong>trochlear nerve.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c3c2824c7bc44df1b2f7f6406a7dce12.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5097a95cafdf444a82041fa0c7851b89x1280x1777.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/516b48623b864fa99d8279e24983201bx1280x1523.JPEG"
    ]
  },
  {
    "text": "What is the nerve supply of the structure marked in the image?",
    "choices": [
      {
        "id": 1,
        "text": "Radial nerve"
      },
      {
        "id": 2,
        "text": "Median nerve"
      },
      {
        "id": 3,
        "text": "Ulnar nerve"
      },
      {
        "id": 4,
        "text": "Musculocutaneous nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>median nerve</strong> supplies the <strong>1st lumbrical&nbsp;</strong>which is marked.&nbsp;</p>\n<p>There are<strong> four</strong> lumbrical muscles. They originate from the&nbsp;tendons of the&nbsp;<strong>flexor digitorum profundus.&nbsp;</strong>It passes to the radial side of the corresponding fingers and is <strong>inserted</strong> into the <strong>dorsal digital expansion</strong> of the extensor digitorum.</p>\n<p>The action of lumbricals is <strong>flexion</strong> at the <strong>metacarpophalangeal joint</strong> and <strong>extension</strong> of interphalangeal joints.&nbsp;</p>\n<p>Lumbricals can be tested only along with interosseous muscle.&nbsp;The examiner will hold the metacarpophalangeal joint of the index finger in hyperextension. Then the patient is asked to extend the proximal interphalangeal joint against resistance. The test is repeated on other fingers as well.</p>\n<p>The <strong>median&nbsp;nerve </strong>innervates the first and second lumbricals. The&nbsp;<strong>deep terminal branch</strong> of the <strong>ulnar nerve</strong> innervates the third and the fourth.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dd2aa1b604774606b159c0443a1aa6d9.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bdaee3063f1f4c859a4398c8fb0dfebex960x720.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1e901cf7bad9464986c1a00a985dc4ffx1280x1661.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e1e8863c826d451382e7938ad01a9cc2x602x422.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8aba95265cc5459f894b96f0ad1df948x720x872.PNG"
    ]
  },
  {
    "text": "Third part of vertebral artery is related to which of the following ?",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "3"
      },
      {
        "id": 3,
        "text": "2"
      },
      {
        "id": 4,
        "text": "1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The third part of the vertebral artery (V3) is related to the area <strong>marked 2, </strong>which is\u00a0the <strong>posterior arch</strong> of the <strong>first cervical vertebra</strong> or the\u00a0<strong>atlas.</strong></p>\n<p>The given image shows the first cervical vertebra - atlas.</p>\n<ul>\n<li>The area marked<strong> 1</strong> is the posterior tubercle.</li>\n<li>The area marked <strong>2</strong> is the posterior arch. The superior surface bears a groove for the of <strong>vertebral artery</strong> and venous plexus immediately behind.</li>\n<li>The area marked <strong>3</strong>\u00a0is the <strong>superior articular facet</strong>.</li>\n<li>The area marked<strong> 4</strong>\u00a0is the posterior surface of the anterior arch. It gives attachment to the apex of dens from the second cervical vertebra.\u00a0</li>\n</ul>\n<p>The <strong>vertebral artery</strong> arises from the <strong>first part</strong> of the\u00a0<strong>subclavian artery</strong>. It passes through the foramina of transverse processes of C6 to C1 cervical vertebrae and enters the cranium through the foramen magnum. The vertebral arteries of both sides join to form the basilar artery. In its course, it is divided into four parts:</p>\n<p>The first part, <strong>V1</strong>, begins at its origin from the subclavian artery and <strong>ends</strong> at its entry into the <strong>transverse process of the C6 cervical vertebra</strong>. This part is crossed by the inferior thyroid artery on both sides, and thoracic duct on the left side, and the right lymphatic duct on the right side.\u00a0</p>\n<p>The second part, <strong>V2</strong> is that part of the artery ascending through the <strong>foramina</strong> in the <strong>transverse process</strong> of the cervical vertebrae.\u00a0</p>\n<p>The third part,<strong> V3</strong>\u00a0is curved backward behind the atlas. In this position, it lies in a <strong>groove on the posterior arch of the atlas</strong>. This part of the artery lies in the suboccipital triangle.\u00a0</p>\n<p>The fourth part, <strong>V4</strong> pierces the dura and arachnoid mater and <strong>unites</strong> with the <strong>contralateral vertebral artery</strong> to form the midline <strong>basilar artery</strong> at the lower border of pons.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4961cb3634f048f0b484ef4bcfed7534.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d0712ed74df0407e8984e89c7f14af4fx1280x1208.JPEG"
    ]
  },
  {
    "text": "Identify the tendon marked in the image.",
    "choices": [
      {
        "id": 1,
        "text": "Flexor carpi radialis"
      },
      {
        "id": 2,
        "text": "Flexor carpi ulnaris"
      },
      {
        "id": 3,
        "text": "Palmaris longus"
      },
      {
        "id": 4,
        "text": "Median nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The tendon marked in the image is of Flexor carpi radialis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3381fa3df8ff4fc4be5fd1fcd8fa93cf.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ca7bfc286bd843d5a03c1a146552239ex535x381.JPEG"
    ]
  },
  {
    "text": "Identify the type of muscle marked as A in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Spiral"
      },
      {
        "id": 2,
        "text": "Multipennate"
      },
      {
        "id": 3,
        "text": "Parallel"
      },
      {
        "id": 4,
        "text": "Cruciate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\">The muscle depicted in the diagram is the <strong>Pectoralis major,</strong> which is a&nbsp;<strong>spiral muscle</strong>.</p>\n<p class=\"p1\">&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/adf88bd3625b479482af3e89bb52c65e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1bd6ce16c6ac49a3802e7d4fd41286fbx1280x2136.JPEG"
    ]
  },
  {
    "text": "A boy with a history of a fall from a tree presents with a lurching gait and dragging of his feet. Which of the following structures are involved?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The structure responsible for&nbsp;<strong>lurching gait</strong> in the child is <strong>gluteus medius</strong>&nbsp;represented by <strong>2</strong>.</p>\n<p>The gluteus medius originates from the outer surface of the ileum between the anterior and posterior gluteal lines. Insertion of the muscle is at the lateral surface of the greater trochanter.&nbsp;It is supplied by the <strong>superior gluteal nerve</strong>.</p>\n<p>Gluteus medius and minimus are powerful <strong>abductors</strong> of the hip joint. Mechanism of actions of gluteus medius and minimus:</p>\n<ul>\n<li>When the leg on one side is lifted off the ground, the <strong>gluteus medius and minimus muscles</strong>, on the opposite supported side, exert traction on the hip bone by acting from the femur. This action results in a&nbsp;<strong>slight raising of the pelvis</strong> on the <strong>unsupported side</strong>, which helps maintain the trunk in the upright position.</li>\n<li>The actions of these muscles are affected when there is an injury to the superior gluteal nerve, neck of the femur, or loss of normal angulation of the shaft of the femur. This occurs in conditions like paralysis of the glutei, developmental dysplasia of the hip, etc.</li>\n<li>When the <strong>gluteus medius and minimus are paralyzed</strong>, the <strong>pelvis sinks down on the unsupported (normal) side</strong>, when the patient tries to stand on the affected limb. This leads to a&nbsp;<strong>positive Trendelenburg's sign </strong>with a<strong>&nbsp;</strong>characteristic lurching gait - the patient lurches towards the affected side with contralateral pelvis drop.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/32f3f8913aca4209bc77a5e2edb34eac.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/08c8c95e71014a448774c2a7ac0f0a6dx1280x4280.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ebbde3edd95e43ce84048037a1d66bd8x1280x1141.JPEG"
    ]
  },
  {
    "text": "Identify the bony prominence marked in the image below",
    "choices": [
      {
        "id": 1,
        "text": "Greater trochanter"
      },
      {
        "id": 2,
        "text": "Lesser trochanter"
      },
      {
        "id": 3,
        "text": "Trochanteric crest"
      },
      {
        "id": 4,
        "text": "Intertrochanteric line"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The bone depicted in the above image is the <strong>Femur</strong> and the bony prominence marked \"A\" is the <strong>lesser</strong> <strong>trochanter</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/094f0db8e6114c6ca0d9df4baf62a9ef.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/baa69266eea548cda60e17fa6eb07592x1280x2117.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4436d8bdeb52408a935ed9d93a517a4ex1280x2117.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/861dddebb2bf4bd18ea06845b1862135x1280x2213.PNG"
    ]
  },
  {
    "text": "Which of the following arteries is being palpated in the given image?",
    "choices": [
      {
        "id": 1,
        "text": "Dorsalis pedis artery"
      },
      {
        "id": 2,
        "text": "Posterior tibial artery"
      },
      {
        "id": 3,
        "text": "Popliteal artery"
      },
      {
        "id": 4,
        "text": "Anterior tibial artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows the physician's fingertips <strong>between </strong>the<strong> medial malleolus </strong>and the<strong> calcaneal tendon,</strong> and the artery being palpated here is the <strong>posterior tibial artery</strong>.</p>\n<p>The posterior tibial artery can be felt by keeping the foot relaxed between plantar and dorsiflexion and palpating against the<strong> distal tibia </strong>behind and below the medial malleolus.</p>\n<p>Other options:</p>\n<p><strong>Dorsalis pedis </strong>artery:\u00a0</p>\n<ul>\n<li>Palpated against the underlying tarsals</li>\n<li>It is palpated on the dorsum of the foot in the <strong>first intermetatarsal space</strong> just <strong>lateral</strong> to the extensor<strong>\u00a0hallucis longus</strong>\u00a0tendon.</li>\n</ul>\n<p><strong>Popliteal</strong> artery:\u00a0</p>\n<ul>\n<li>Most difficult of the peripheral pulses to feel because the artery lies deep in the popliteal fossa.</li>\n<li>Examined with the subject lying supine or prone, with the <strong>knee flexed</strong> in order to relax the tense popliteal fascia that roofs the popliteal fossa.</li>\n<li>Felt over the <strong>midline of the fossa </strong>by deep pressure against the popliteal surface of the femur.\u00a0</li>\n</ul>\n<p><strong>Anterior Tibial Artery</strong> -</p>\n<ul>\n<li><strong>Anteriorly midway</strong> between the medial and lateral malleoli, lateral to the EHL tendon, against the lower end of the tibia</li>\n</ul>\n<p>Arteries of the lower limb are:\u00a0 \u00a0\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4c858b0f911747538d3d76264890f1dc.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7a897b2d01514ffa998b1a7efb1837c1x1016x899.JPEG"
    ]
  },
  {
    "text": "Given below is a dissected compartment of the leg. The nerve supplying these muscles does not give articular branches to?",
    "choices": [
      {
        "id": 1,
        "text": "Tarsal joints"
      },
      {
        "id": 2,
        "text": "2nd metatarsophalangeal joint"
      },
      {
        "id": 3,
        "text": "1st metatarsophalangeal joint"
      },
      {
        "id": 4,
        "text": "Tarsometatarsal joints"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given muscle is supplied by the&nbsp;<strong>deep peroneal nerve. </strong>It does not give articular branches to the <strong>2nd metatarsophalangeal joint</strong>.&nbsp;</p>\n<p>The above image shows the anterior compartment of the leg. The deep peroneal nerve is the nerve of the <strong>anterior compartment</strong> of the leg and the <strong>dorsum of the foot</strong>.&nbsp;It is one of the two <strong>terminal branch</strong>es of the <strong>common peroneal nerve</strong> arising <strong>between</strong> the <strong>neck of the fibula</strong> and <strong>peroneus longus</strong>. It accompanies the <strong>anterior tibial artery</strong>.&nbsp;</p>\n<p>The deep peroneal nerve gives <strong>articular branches</strong> to-</p>\n<ul>\n<li>Ankle joint</li>\n<li>Tarsal joints</li>\n<li>Tarsometatarsal joints</li>\n<li>1st metatarsophalangeal joint</li>\n</ul>\n<p><strong>Muscular branches</strong>-</p>\n<ul>\n<li>Tibialis anterior&nbsp;</li>\n<li>Extensor hallucis longus&nbsp;</li>\n<li>Extensor digitorium&nbsp; longus</li>\n<li>Peroneus tertius&nbsp;</li>\n<li>Extensor digitorium brevis&nbsp;</li>\n</ul>\n<p>The 2nd metatarsophalangeal joint is supplied by the medial plantar nerve.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/298164828a8c490483a4774bfefd24de.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4f392042d91240908b0055fce9452ec6x449x337.JPEG"
    ]
  },
  {
    "text": "A defect in which of the following forms the structure marked below?",
    "choices": [
      {
        "id": 1,
        "text": "Internal oblique"
      },
      {
        "id": 2,
        "text": "External oblique"
      },
      {
        "id": 3,
        "text": "Parietal peritoneum"
      },
      {
        "id": 4,
        "text": "Fascia transversalis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The structure marked<span data-preserver-spaces=\"true\">&nbsp;is the <strong>deep inguinal ring,</strong> which is formed by a defect in <strong>fascia transversalis.</strong></span></p>\n<div class=\"page\" title=\"Page 1500\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The<strong> deep inguinal ring</strong> is an opening in the transversalis fascia present 1 cm above the inguinal ligament, midway between the anterior superior iliac spine and the pubic symphysis. An<strong> indirect inguinal hernia</strong> arises through the deep inguinal ring<strong> lateral to the inferior epigastric vessel.</strong></p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7ca41a26af8549fab42a0854ad94bddd.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f3143fe76054c1e890bc0d5083b3f37x1280x1123.JPEG"
    ]
  },
  {
    "text": "Injury at which of the following marked sites causes failure of dorsiflexion?",
    "choices": [
      {
        "id": 1,
        "text": "3"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "1"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The site marked as '3' in the x-ray given above is the <strong>neck of the fibula. </strong>Injury at this site causes <strong>failure of dorsiflexion </strong>(foot drop)<strong>&nbsp;</strong>due to injury to the <strong>common fibular nerve</strong>.&nbsp;</p>\n<p>It runs obliquely along the <strong>lateral side of the popliteal fossa</strong> to the fibular head. It then curves laterally around the <strong>neck of the fibula</strong> and gets divided into <strong>superficial</strong> and <strong>deep fibular nerves.</strong></p>\n<table style=\"height: 151px; width: 469.875px;\">\n<tbody>\n<tr style=\"height: 36px;\">\n<td style=\"width: 92px; text-align: center; height: 36px;\">&nbsp;</td>\n<td style=\"width: 170px; text-align: center; height: 36px;\">Superficial fibular nerve</td>\n<td style=\"width: 157.875px; text-align: center; height: 36px;\">Deep fibular nerve</td>\n</tr>\n<tr style=\"height: 155px;\">\n<td style=\"width: 92px; height: 155px;\">Motor innervation</td>\n<td style=\"width: 170px; height: 155px;\">\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Peroneus longus</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Peroneus brevis</li>\n</ul>\n</td>\n<td style=\"width: 157.875px; height: 155px;\">\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Extensor digitorum longus</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Extensor hallucis longus</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Tibialis anterior</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Peroneus tertius</li>\n</ul>\n</td>\n</tr>\n<tr style=\"height: 144.344px;\">\n<td style=\"width: 92px; height: 144.344px;\">Sensory innervation</td>\n<td style=\"width: 170px; height: 144.344px;\">\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Lateral aspect of the lower leg</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Dorsum of the toes except for the lateral side of the 5th toe and the first interdigital web-space</li>\n</ul>\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 157.875px; height: 144.344px;\">\n<ul>\n<li>The first interdigital space</li>\n</ul>\n&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6469894bb9d34690b54365a7f1ab6569.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4f52af0922164786b337aa8173eb60b6x1280x1571.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3d52bcf03ec442bfa7909cf6ba2a7033x1280x2400.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/755e800e72d9482996ea96813ce4004ex1200x1447.JPEG"
    ]
  },
  {
    "text": "The structure marked in the image drains into:",
    "choices": [
      {
        "id": 1,
        "text": "Junction of superior vena cava and left brachiocephalic veins"
      },
      {
        "id": 2,
        "text": "Junction of left jugular and left subclavian veins"
      },
      {
        "id": 3,
        "text": "Directly into coronary sinus"
      },
      {
        "id": 4,
        "text": "Azygos vein"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows the thoracic duct which drains into the <strong>junction of the left jugular and left subclavian veins.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3c2cc3abba7c46d8b58e4382fb688583.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6b1e3114d19947a0935ef93fb0e83bf3x1280x1623.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2e3505986f3547d791f1dbeb3b204b60x870x678.JPEG"
    ]
  },
  {
    "text": "Which of the following structures develops from the structure marked A?",
    "choices": [
      {
        "id": 1,
        "text": "Medial umbilical ligament"
      },
      {
        "id": 2,
        "text": "Median umbilical ligament"
      },
      {
        "id": 3,
        "text": "Meckel's diverticulum"
      },
      {
        "id": 4,
        "text": "Ligamentum teres"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The structure marked A is the&nbsp;<strong>al</strong><strong>lantois</strong>.&nbsp;Its <strong>distal portion</strong> forms the <strong>urachus,</strong> which in turn gives rise to the <strong>median umbilical ligament</strong>.</p>\n<p>The given image shows an embryo at the end of the third week.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5f2e0e22158048c9ad4854d5a4e9068e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6d4af9003fd24d3aa69e7ca79f209903x1280x1041.JPEG"
    ]
  },
  {
    "text": "The Para-sagittal section of the abdomen is given below. What is the superior border of the marked structure?",
    "choices": [
      {
        "id": 1,
        "text": "Caudate lobe of liver"
      },
      {
        "id": 2,
        "text": "Duodenum"
      },
      {
        "id": 3,
        "text": "Lesser omentum"
      },
      {
        "id": 4,
        "text": "Inferior vena cava"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The structure marked in the given image is\u00a0<strong>epiploic foramen.\u00a0</strong>The\u00a0<strong>superior</strong>\u00a0<strong>border</strong>\u00a0of the\u00a0epiploic foramen\u00a0(foramen of Winslow)\u00a0is formed by the\u00a0<strong>caudate lobe of the liver.\u00a0</strong></p>\n<p>Epiploic foramen\u00a0is a vertical slit of about 3 cm behind the\u00a0free right border of the lesser omentum. It\u00a0<strong>connects</strong>\u00a0the\u00a0<strong>lesser sac</strong>\u00a0to the\u00a0<strong>greater</strong>\u00a0sac. The pearl summarizes the various relations of the foramen.</p>\n<p>The image attached shows the various peritoneal reflections.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6cc5a4c807334b91b43f00b2e4f01892.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c1a6212633554f37af4828804c18d89bx1280x1722.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cc8e7a49d13b4f2ea7a1cca867d8f1e6x720x569.GIF"
    ]
  },
  {
    "text": "Area marked in the given image is supplied by dermatome number?",
    "choices": [
      {
        "id": 1,
        "text": "T8"
      },
      {
        "id": 2,
        "text": "T9"
      },
      {
        "id": 3,
        "text": "T10"
      },
      {
        "id": 4,
        "text": "T11"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The marked dermatome which includes the <strong>umbilicus is supplied by T10.</strong></p>\n<p>The dermatomal distribution of the abdominal region is as follows:&nbsp;</p>\n<ul>\n<li>The skin from the xiphoid process to just above the umbilicus is supplied by T7-T9.</li>\n<li>The skin around the umbilicus is supplied by T10.</li>\n<li>The skin below the umbilicus until the suprapubic region is supplied by T11, T12.&nbsp;</li>\n<li>The skin around genitalia and upper medial thigh is supplied by L1.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/392e0a59f4e64d4c84de2d0da617c95e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d46332cd9eab4a279a8f32d56a50d3ffx1280x1722.JPEG"
    ]
  },
  {
    "text": "Identify the angle shown in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Renal angle"
      },
      {
        "id": 2,
        "text": "Costovertebral angle"
      },
      {
        "id": 3,
        "text": "Lumbar angle"
      },
      {
        "id": 4,
        "text": "Pyelovertebral angle"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The angle shown in the image is the&nbsp;<strong>costovertebral angle,&nbsp;</strong>formed between the&nbsp;<strong>lower border</strong> of the <strong>12<sup>th</sup> rib</strong> and the <strong>vertebral column.&nbsp;</strong></p>\n<p>Causes for&nbsp;pain/tenderness at the&nbsp;costovertebral angle include:</p>\n<ul>\n<li>Nephrolithiasis</li>\n<li>Pelviureteric junction obstruction</li>\n<li>Pyelonephritis</li>\n<li>Hemorrhagic fever with renal syndrome (HFRS) - caused by Hantavirus.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c34f853ddc9b437ca0a8b6b12ff1f3b5.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f74de3fb3dcb4924bddaafd40cf27385x1280x1246.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a852e72c7ebb4073a50a2506d9ba3445x1280x1324.JPEG"
    ]
  },
  {
    "text": "During the evaluation of a cyanotic newborn, the echocardiogram shows pulmonic stenosis involving the root of the pulmonary artery. Defective maturation of which of the following labelled structures would cause this condition?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This newborn is found to have <strong>pulmonic stenosis</strong> involving the root of the pulmonary artery. The structure which gives rise to the root of the pulmonary artery is the <strong>truncus arteriosus</strong> which is marked as <strong>'4'</strong> in the given image.</p>\n<p>Structures marked:</p>\n<ol>\n<li>Sinus venosus</li>\n<li>Atrium</li>\n<li>Bulbus cordis</li>\n<li>Truncus arteriosus</li>\n</ol>\n<p>The <strong>heart tube</strong> begins to <strong>bend</strong> by <strong>day&nbsp;23</strong>. This bending creates the <strong>cardiac loop </strong>which is completed by day 28. The fate of various structures formed as a result of this bending is as follows:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/76e927a072b74130a6b3aa7008faf0c8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ee4d0a2f677746f8837d12d137daa299x1280x2300.JPEG"
    ]
  },
  {
    "text": "The marked structure develops from which of the following structures?",
    "choices": [
      {
        "id": 1,
        "text": "Common cardinal vein"
      },
      {
        "id": 2,
        "text": "Anterior cardinal vein"
      },
      {
        "id": 3,
        "text": "Supracardinal vein"
      },
      {
        "id": 4,
        "text": "Subcardinal vein"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The structure marked in the image is the <strong>azygos vein</strong>, which develops from the <strong>supracardinal&nbsp;vein</strong>.</p>\n<p>The <strong>azygos system</strong> of veins forms a <strong>connecting channel </strong>between the<strong> superior </strong>and<strong> inferior venae cavae</strong>. It occupies the upper part of the posterior abdominal wall and the posterior mediastinum. It also connects the portal, caval system, and vertebral venous systems. It drains the <strong>thoracic wall</strong> and the <strong>upper lumbar region.</strong></p>\n<p><strong>Development:&nbsp;</strong>The azygos venous system arises from the <strong>supra cardinal veins</strong>. The <strong>right</strong> supra cardinal vein becomes the <strong>azygos</strong> vein, while the <strong>left</strong> supra cardinal vein becomes the <strong>hemiazygos</strong> vein.</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The <strong>4th to 11th right intercostal</strong> veins empty into the <strong>right</strong> <strong>supracardinal</strong> vein, which together with a portion of the posterior cardinal vein forms the <strong>azygos vein</strong>.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The<strong> 4th to 7th left intercostal</strong>&nbsp;veins empty&nbsp;into the <strong>left supracardinal</strong> vein, and the left supracardinal vein continues as the <strong>hemiazygos vein</strong>, which also empties into the azygos vein.</li>\n</ul>\n<p>Other options: Cardinal veins form the main venous drainage system of the embryo. It consists of,</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Anterior cardinal veins,</strong> which drain the cephalic part of the embryo, and</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Posterior cardinal veins</strong>, which drain the rest of the embryo.</li>\n</ul>\n<p>During the fifth to the seventh weeks, a number of additional veins are formed. It includes,</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Subcardinal veins</strong>, which mainly drain the kidneys;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Sacrocardinal veins, which drain the lower extremities;</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Supracardinal veins, which drain the body wall by way of the intercostal veins.</li>\n</ul>\n<p>The below image shows the development of cardinal veins</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1eb54a77368f4c04b36bbc899a29bb12.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2cba07cec260404597497fe3ec9ec33fx1279x1984.JPEG"
    ]
  }
];
        let quizName = 'Fmge Mini Test - 007 (Anatomy Images)';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>