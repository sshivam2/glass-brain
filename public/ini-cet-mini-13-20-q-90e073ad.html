<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ini-Cet Mini - 13 (20 Q) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 40-year-old man was brought to the emergency department after a road traffic accident, and an eFAST was performed. What is the additional view that is not possible with FAST but is possible with eFAST?",
    "choices": [
      {
        "id": 1,
        "text": "Subxiphoid view"
      },
      {
        "id": 2,
        "text": "Right flank view"
      },
      {
        "id": 3,
        "text": "Anterior pleural view"
      },
      {
        "id": 4,
        "text": "Pelvic view"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Focussed Assessment with Sonography for Trauma\u00a0</strong>(FAST) is extended into the thoracic cavities and peri\u00adcardium (<strong>eFAST</strong>), where <strong>anterior pleural views</strong> are incorporated. It is a technique in which ultrasonography is used to assess the presence of free fluid in the abdominal cavity.\u00a0</p>\n<p>It is a rapid, non-invasive bedside test for detecting free fluid in the abdomen using sonography, used to assess patients for potential thoracoabdominal injuries.\u00a0</p>\n<p>The patient is placed in a supine position. The following\u00a0regions are scanned:</p>\n<ul>\n<li>Subxiphoid transverse view (also called subcostal view or pericardial view)</li>\n<li>Right upper quadrant view (also called right flank view or perihepatic view)</li>\n<li>Left upper quadrant view (also called perisplenic or left flank view)\u00a0</li>\n<li>Suprapubic view or pelvic view</li>\n</ul>\n<p>An extended FAST or <strong>eFAST</strong> scan incorporates the <strong>anterior pleural</strong> views to assess the<strong> anterior thorax</strong>.</p>\n<p>Drawbacks of FAST:</p>\n<ul>\n<li>Does not reliably detect less than 100 mL of free blood</li>\n<li>Does not directly identify hollow viscus injury or penetrating trauma</li>\n<li>Often requires supplementing with other investigations</li>\n<li>Does not assess the retroperitoneum</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Three weeks following a parotidectomy,  there is an aberrant regeneration of postganglionic parasympathetic fibers of the nerve marked in the image below.  All the following methods are suitable in order to prevent such occurrence except",
    "choices": [
      {
        "id": 1,
        "text": "Sternomastoid muscle flap"
      },
      {
        "id": 2,
        "text": "Temporalis fascial flap"
      },
      {
        "id": 3,
        "text": "Tympanic neurectomy"
      },
      {
        "id": 4,
        "text": "Artificial membrane between skin and parotid bed"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>After parotidectomy, the aberrent regeneration of the postganglionic parasympathetic nerve fibers of the<strong> auriculotemporal nerve </strong>(marked in the image)<strong>\u00a0</strong>leads to<strong> Frey's syndrome (gustatory sweating).\u00a0</strong>All the above-mentioned methods are suitable to<strong> prevent</strong> its occurrence<strong>\u00a0</strong>except tympanic neurectomy\u00a0because it is not a preventive method but is a method of treatment.</p>\n<p>Patients with Frey's syndrome present with <strong>sweating, warmth, and redness</strong> of the <strong>face</strong> as a result of <strong>salivary stimulation</strong> by the smell or taste of food.</p>\n<p>The diagnosis can be <strong>confirmed</strong> with a <strong>starch-iodine test</strong>.\u00a0This test involves <strong>painting</strong> the patient\u2019s surgical <strong>site </strong>with<strong> iodine </strong>and\u00a0<strong>dry starch</strong>, and a <strong>stimulus</strong> that can cause salivation is given to the patient. In the presence of iodine and sweat, the starch over the affected area will <strong>turn blue or brown</strong>.</p>\n<div class=\"page\" title=\"Page 816\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>It is an inevitable consequence of parotidectomy unless preventive measures are taken. These measures replace the barrier between the skin and the parotid bed and minimize the abnormal regeneration of autonomic nerve fibers. The <strong>preventive measures</strong> are:</p>\n<ul>\n<li>Sternomastoid muscle flap</li>\n<li>Temporalis fascial flap</li>\n<li>Insertion of artificial membranes between the skin and the parotid bed.</li>\n</ul>\n<div class=\"page\" title=\"Page 687\">Treatment of Frey's syndrome is with antiperspirants,<strong>\u00a0tympanic neurectomy</strong>, or botulinum toxin injection into the affected area (most effective).</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/72cc580e85f3442a9de60b50be50ef09.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient with degenerative high axial myopia was found to have an outward curvature of a part of the globe when indirect ophthalmoscopy was performed.  Which among the following is likely to be seen?",
    "choices": [
      {
        "id": 1,
        "text": "Ciliary staphyloma"
      },
      {
        "id": 2,
        "text": "Anterior staphyloma"
      },
      {
        "id": 3,
        "text": "Posterior staphyloma"
      },
      {
        "id": 4,
        "text": "Intercalary staphyloma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most common staphyloma to be associated with a <strong>degenerative high axial myopia</strong> is <strong>Posterior staphyloma</strong>.</p>\n<p>Staphyloma refers to ectasia of the outer coats of the eye-\u00a0<strong>cornea</strong>\u00a0or sclera or both, as a result of the weakening of the eyewall due to inflammation or degenerative diseases. The staphyloma is <strong>lined internally by uveal tissue</strong> and <strong>externally by weak cornea or sclera</strong>.</p>\n<p>Types of Staphyloma:</p>\n<ul>\n<li><strong>Posterior</strong> staphyloma: Ectasia of the <strong>posterior pole</strong> of the eye and is lined by the choroid. The ectatic portion is detected by fundoscopy and B-scan ultrasonography. Indirect ophthalmoscopy shows a <strong>posterior outward curvature of the globe</strong> seen as a crescentic shadow in the macular region. The retinal vessels dip down into the region. The staphylomatous area appears pale due to degeneration of the retina, pigment epithelium, and occasionally the choroid. The most common cause is <strong>degenerative high axial myopia</strong>.</li>\n<li><strong>Anterior</strong>\u00a0staphyloma: It is characterized\u00a0by <strong>ectasia of the pseudo-cornea,</strong> which occurs after the total sloughing of the\u00a0cornea. It is lined internally by the iris and externally by the newly formed epithelium. The most common cause is a <strong>perforated sloughing corneal ulcer</strong>.</li>\n<li><strong>Intercalary</strong> staphyloma: This is located <strong>at the limbus</strong> and is lined by the root of the iris and the anterior-most part of the ciliary body. Common causes include:\n<ul>\n<li>perforating injuries and ulcers of the peripheral cornea</li>\n<li>anterior scleritis</li>\n<li>scleromalacia perforans</li>\n<li>poor wound apposition after complicated cataract surgery</li>\n<li>secondary glaucoma</li>\n</ul>\n</li>\n<li><strong>Ciliary</strong> staphyloma: It is characterized by ectasia of weak sclera lined by the\u00a0ciliary body. This affects the <strong>ciliary zone,</strong> which includes the region <strong>up to 8 mm behind the limbus. </strong>Causes include:\n<ul>\n<li>Developmental glaucoma, end-stage primary or secondary glaucoma</li>\n<li>Scleritis</li>\n<li>Ciliary trauma</li>\n</ul>\n</li>\n<li><strong>Equatorial</strong> staphyloma: This occurs at the <strong>equatorial region up to 14 mm behind the limbus</strong> of the eye. Causes include:\n<ul>\n<li>Scleritis</li>\n<li>Degenerative myopia</li>\n<li>Chronic uncontrolled glaucoma</li>\n</ul>\n</li>\n</ul>\n<div class=\"page\" title=\"Page 242\">\u00a0</div>\n<p>Treatment:\u00a0Local excision and repair with a corneal and scleral patch graft. Enucleation and replacement with an implant can be done for disfigured and blind eyes. Degenerative diseases responsible should be treated early to prevent secondary glaucoma and staphyloma formation.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a47e4cc213074b019562ecc97c66aff8x1280x1342.JPEG"
    ]
  },
  {
    "text": "Following general anaesthesia for a procedure, a 45-year-old lady experienced prolonged somnolescence. On administration of physostigmine, she showed rapid improvement of her mental status. Which of the following drugs is not likely to cause this syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Glycopyrrolate"
      },
      {
        "id": 2,
        "text": "Atropine"
      },
      {
        "id": 3,
        "text": "Antihistaminics"
      },
      {
        "id": 4,
        "text": "Tricyclic antidepressants"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical vignette is suggestive of the central anticholinergic syndrome, which is not caused by glycopyrrolate.\u00a0</p>\n<p><strong>Glycopyrrolate</strong>\u00a0usually does not produce central anticholinergic syndrome because is a<strong> quaternary amine compound, lipid insoluble, and\u00a0</strong><strong>does not cross the blood-brain barrier</strong>. Glycopyrrolate blocks the peripheral muscarinic side effects (caused by increased acetylcholine levels by neostigmine) without causing unwanted central anticholinergic effects.</p>\n<p>Drugs that can cause anticholinergic syndrome include:</p>\n<ul>\n<li>Atropine</li>\n<li>Scopolamine</li>\n<li>First-generation antihistamines\u00a0</li>\n<li>Tricyclic antidepressants\u00a0</li>\n<li>Phenothiazines</li>\n</ul>\n<p><span class=\"ej-keyword\" data-value=\"Anticholinergic syndrome\">The anticholinergic syndrome</span>\u00a0can present with central manifestations ranging from delirium and agitation to CNS depression, stupor and coma. It is a rare reaction due to either overdose or any unusual reaction to the usage of the drugs mentioned above.\u00a0Physostigmine is useful in reversing the central anticholinergic syndrome produced by overdosage or an unusual reaction to these drugs.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old nulliparous woman presented with mild dyspareunia. Examination revealed a non-tender, mobile, fluctuant swelling on the vaginal wall. Ultrasound examination revealed a single cyst of size approximately 2 cm, independent from the bowel and bladder. The cyst arises from the part in the image labeled as A. Structure A is a remnant of what?",
    "choices": [
      {
        "id": 1,
        "text": "Mullerian duct"
      },
      {
        "id": 2,
        "text": "Mesonephric duct"
      },
      {
        "id": 3,
        "text": "Urogenital sinus"
      },
      {
        "id": 4,
        "text": "Gubernaculum"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario describes a case of a <strong>Gartner's duct cyst</strong>, which develops from the <strong>Gartner's duct (marked as A)</strong>, a remnant of the <strong>mesonephric duct (Wolffian duct).\u00a0</strong></p>\n<p>The remnants of <strong>Wolffian ducts</strong> (Gartner's duct) in <strong>females</strong> are located in the <strong>broad ligament\u00a0</strong>and<strong> vagina</strong>. It\u00a0is an <strong>imperfect duct</strong> that runs <strong>below</strong> and <strong>parallel</strong> to the <strong>fallopian tube</strong> in the <strong>mesosalpinx</strong>. The <strong>duct</strong> passes <strong>downwards</strong> by the <strong>side</strong> <strong>of</strong> the <strong>uterus</strong> <strong>until</strong> the <strong>internal</strong> <strong>os</strong>, after which it <strong>passes</strong> <strong>into</strong> the <strong>cervix</strong>. It then runs <strong>forwards</strong>, reaching the <strong>anterolateral</strong> part of the <strong>vaginal</strong> <strong>wall</strong>.</p>\n<div class=\"page\" title=\"Page 128\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Gartner's duct cysts</strong> are located in the <strong>vagina</strong> or <strong>broad ligament</strong>. They are usually <strong>asymptomatic</strong> and <strong>found</strong> <strong>within</strong> the <strong>lateral vaginal wall</strong> during a <strong>routine examination</strong>. <strong>Symptoms</strong> if present, might include <strong>dyspareunia</strong>, <strong>pain</strong>, and <strong>difficulty</strong> inserting <strong>tampons</strong>. Examination reveals a <strong>tense cyst</strong>, seen <strong>bulging</strong> from <strong>beneath the vaginal wall</strong>.</p>\n<p><strong>Differentials</strong> include <strong>epidermoid cysts</strong>, <strong>Bartholin's</strong> <strong>gland</strong> <strong>cyst</strong>, <strong>uterine</strong> <strong>prolapse</strong>, cystocele, rectocele, urethral diverticula.</p>\n<p><strong>Treatment</strong> is <strong>observation</strong> in most cases. <strong>Marsupialization</strong> or <strong>excision</strong> may be done if <strong>large</strong> and <strong>symptomatic</strong>.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ec3f58dc35ad46a19e4601d8665bc2ce.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/534b72f1cf9f4cc7b6f8af7de4f06efex1280x1676.JPEG"
    ]
  },
  {
    "text": "A 33-year-old male patient is unable to initiate speech or any voluntary movements but seems to be alert and aware of his surroundings with respect to his eye movements. Which among the following conditions is this clinical feature not associated with?",
    "choices": [
      {
        "id": 1,
        "text": "Psychotic depression"
      },
      {
        "id": 2,
        "text": "Vascular dementia"
      },
      {
        "id": 3,
        "text": "Pick's disease"
      },
      {
        "id": 4,
        "text": "Huntington's disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical vignette is describing <strong>akinetic mutism, </strong>which is not likely to be seen in Pick's disease, which is cortical dementia.</p>\n<p>In akinetic mutism, there is an <strong>absence of voluntary movements and speech</strong> in a patient who appears <strong>alert and aware</strong> of their surroundings (as evidenced by eye movements). It is sometimes also referred to as coma vigil, a coma in which a patient appears to be asleep but can be aroused.</p>\n<p>It can be seen in:</p>\n<ul>\n<li><strong>Psychotic depression</strong></li>\n<li>Schizophrenia with affective psychosis<strong>&nbsp;</strong></li>\n<li>Catatonic states</li>\n<li>Subcortical dementias\n<ul>\n<li><strong>Huntington's disease</strong></li>\n<li>Parkinson's disease</li>\n<li>Normal-pressure hydrocephalus</li>\n<li><strong>Vascular dementia</strong></li>\n<li>Wilson's disease</li>\n</ul>\n</li>\n<li>Brainstem tumors</li>\n<li>Neuroleptic malignant syndrome</li>\n</ul>\n<p>Pick's disease is cortical dementia, which presents with aphasia, agnosia, and apraxia. Other examples of cortical dementia include dementia in Alzheimer's disease and&nbsp;Creutzfeldt-Jakob disease.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the correct statement about the information obtained from the vaccine vial monitor 14 (VVM14) shown in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "It takes 14 days for the inner square to become darker than outer circle"
      },
      {
        "id": 2,
        "text": "It takes 14 days for the inner square and outer circle to reach the same color"
      },
      {
        "id": 3,
        "text": "The vaccine can be used for 14 days after the inner square and outer circle reach the same color"
      },
      {
        "id": 4,
        "text": "The vaccine can be used for 14 days after the outer circle color  becomes darker"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 129\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The correct statement is option 2.</p>\n<p>The given scenario mentions<strong>&nbsp;VVM 14 </strong>(vaccine vial monitor 14), where <strong>14</strong> indicates the&nbsp;<strong>VVM number</strong>. It&nbsp;is the <strong>time in days</strong>&nbsp;for the <strong>inner square </strong>to reach the<strong> color of the outer circle </strong>when the vial is exposed to a constant temperature of 37&deg;C. This color change signifies the&nbsp;<strong>discard point</strong>&nbsp;of the vial.</p>\n</div>\n</div>\n</div>\n<p><strong>Vaccine Vial Monitors (VVM)</strong>&nbsp;are heat-sensitive indicators that are routinely used to monitor vaccine viability as the vaccine vial moves across the supply chain. It&nbsp;records&nbsp;<strong>cumulative heat exposure</strong>&nbsp;through a&nbsp;<strong>gradual change in color</strong>.</p>\n<p>There are currently 4 types of VVMs, they are chosen to match the <strong>heat sensitivity</strong> of the vaccines based on the VVM number.&nbsp;</p>\n<ul>\n<li>VVM 30: High Stability</li>\n<li>VVM 14: Medium Stability</li>\n<li>VVM 7: Moderate Stability</li>\n<li>VVM 2: Least Stable</li>\n</ul>\n<p>If the color of the<strong>&nbsp;inner square </strong>is the<strong> same </strong>or is<strong> darker than the outer</strong>&nbsp;circle, it indicates that the vaccine has been exposed to high temperatures and should be&nbsp;<strong>discarded.</strong></p>\n<p>Purpose of VVMs:</p>\n<ul>\n<li>Ensures that vaccines <strong>damaged by heat</strong> are not administered</li>\n<li>Decision on which vaccines to be kept after a <strong>cold chain break</strong> occurs, minimizing unnecessary vaccine wastage</li>\n<li>Decision on which <strong>vaccine</strong> is<strong> to be used first</strong>. Vaccines showing significant heat exposure should be used before those that show lower heat exposure, even if their expiry date is longer</li>\n</ul>\n<div class=\"page\" title=\"Page 129\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 129\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>There are two different locations for VVMs :</p>\n<ul>\n<li><strong>On the label</strong> of the vaccine: The vaccine vial, once opened, can be kept for subsequent immunization sessions for <strong>up to 28 days</strong>, regardless of the formulation of the product</li>\n<li>In a location <strong>other than on the label</strong> (e.g., cap or neck of ampoule): The vaccine vial, once opened should be discarded at the end of the immunization session or <strong>within six hours of opening</strong>, whichever comes first, regardless of the formulation of the product</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/379a129517164991916eee55809230e8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which among the following sinuses are visible in Caldwell's view?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3"
      },
      {
        "id": 2,
        "text": "1, 2, 4"
      },
      {
        "id": 3,
        "text": "2, 3, 4"
      },
      {
        "id": 4,
        "text": "1, 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The sinuses visible in Caldwell's view are the <strong>frontal, ethmoid and maxillary sinuses</strong>, marked as 1, 2 and 4 in the image.</p>\n<p>Structures seen in <strong>Caldwell's view\u00a0</strong>are:</p>\n<ul>\n<li><strong>Frontal sinuses (seen best)</strong></li>\n<li><strong>Ethmoid</strong> sinuses</li>\n<li><strong>Maxillary</strong> sinuses</li>\n<li>Frontal process of the zygoma and the zygomatic process of the frontal bone</li>\n<li>Superior margin of orbit and lamina papyracea</li>\n<li>Superior orbital fissure</li>\n<li>Foramen rotundum (inferolateral to superior orbital fissure)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6acbb662354b45c18a9ef18305ac16cb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/82bd011fae6c47c8866215f1c9af17e8x1280x1015.5148095909732.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/27e6c88717b24a58b27fabc6e9813bb7x1085x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c97417b2b1b64c0d91dd9744b53dc5c9x1280x1586.9111424541609.JPEG"
    ]
  },
  {
    "text": "A 40-year-old man working in the smelting industry presents with numbness and tingling in his toes and fingertips, which have slowly progressed to involve the feet and hands symmetrically, in a stocking-glove pattern. There are no other associated neurological deficits. On examination, there is diffuse desquamation of the palms and soles with hyperkeratosis. Which of the following findings is unlikely to be seen in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Mees' lines"
      },
      {
        "id": 2,
        "text": "Burtonian line"
      },
      {
        "id": 3,
        "text": "Bowen disease"
      },
      {
        "id": 4,
        "text": "Raindrop hyperpigmentation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical vignette of a <strong>smelting</strong> industry worker presenting with <strong>neuropathy</strong>\u00a0as well as desquamation and <strong>hyperkeratosis</strong> of palms and soles is suggestive of <strong>chronic arsenic poisoning.</strong>\u00a0The <strong>Burtonian line</strong> is seen in\u00a0<strong>chronic lead poisoning</strong> and is not a feature of arsenic poisoning.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d5d88d9266db44c9a442444635fb46bax1280x1034.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a3e1f0a60a2944098225f39e45b182cbx1280x4902.JPEG"
    ]
  },
  {
    "text": "A 60-year-old woman presented with painful swelling of the right calf muscle, 7 days after her knee replacement surgery. On examination, her heart rate 70 beats per min, her blood pressure is 130/80 mm Hg, and her SPO2 is 96% on room air.  The test shown below is positive. She has no history of hemoptysis or significant weight loss. There is no previous history of pulmonary embolism. Based on Well's criteria, which is the most appropriate investigation to be carried out next?",
    "choices": [
      {
        "id": 1,
        "text": "D dimer"
      },
      {
        "id": 2,
        "text": "CT Pulmonary angiography"
      },
      {
        "id": 3,
        "text": "Electrocardiogram"
      },
      {
        "id": 4,
        "text": "Contrast venography"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>From the clinical vignette, Well's score is 7.5, indicating that she is at high risk for developing a pulmonary embolism for which she should undergo a helical CT Pulmonary Angiography. The clinical stem with calf pain and swelling following surgery, along with the given image showing Homan's sign (calf tenderness on forced ankle dorsiflexion) points to the diagnosis of Deep vein thrombosis (DVT).</p>\n<div class=\"page\" title=\"Page 1957\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Wells score criteria help in the estimation of the clinical likelihood of DVT and PE.&nbsp;<strong>Calculation of Well's score in this case:</strong></p>\n</div>\n</div>\n</div>\n</div>\n<ul>\n<li><strong>Signs and symptoms of DVT = 3</strong></li>\n<li><strong>No alternative diagnosis = 3</strong></li>\n<li>Heart rate is 70 beats per min. (&lt;100) = 0</li>\n<li><strong>Surgery in previous 4 weeks = 1.5</strong></li>\n<li>No previous PE = 0</li>\n<li>No Hemoptysis = 0</li>\n<li>No cancer (no significant weight loss) = 0</li>\n</ul>\n<p><strong>Total score = 7.5</strong></p>\n<p>Well's criteria (Three-tiered clinical probability assessment)</p>\n<ul>\n<li>High risk &gt;6</li>\n<li>Moderate risk 2-6</li>\n<li>Low risk &lt;2</li>\n</ul>\n<div class=\"page\" title=\"Page 1957\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Patients with a low-to-moderate likelihood of DVT or PE should undergo diagnostic evaluation with d-dimer testing alone. However, patients with a high clinical risk of venous thromboembolism should skip d-dimer testing and undergo imaging as the next step in the diagnostic algorithm.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e6fec2778a79482791c0cf3c862dbc60.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a9171a639fef438f9c66f4cd98e887e0x1280x1358.JPEG"
    ]
  },
  {
    "text": "A 13-year-old girl is referred for evaluation of a spinal deformity in the mid-thoracic region. She complains of pain during sports and physical activities at school, which is relieved on resting.  On examination, the right shoulder is slightly higher than the left and on forward bending, a right-sided mid-thoracic prominence was noted. Identify the true statements about the progression of this condition.",
    "choices": [
      {
        "id": 1,
        "text": "1 and 3"
      },
      {
        "id": 2,
        "text": "2, 4, 5"
      },
      {
        "id": 3,
        "text": "1, 3, 5"
      },
      {
        "id": 4,
        "text": "2, 3, 4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical\u00a0vignette\u00a0describes a case of <strong>adolescent idiopathic scoliosis</strong>, and statements 1 and 3 are the true statements about the progression of the condition.\u00a0</p>\n<p>The X-ray shows a spine with scoliosis, the curve being convex to the right with Cobb's angle of 40 degrees.</p>\n<div class=\"page\" title=\"Page 2137\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Adolescent idiopathic scoliosis is diagnosed when the spinal deformity is recognized in a child <strong>after the age of 10 years</strong> but <strong>before skeletal maturity</strong>. This is the <strong>most common</strong> type of idiopathic scoliosis. It characteristically includes a lateral curvature of the spine with rotation of the vertebrae. The primary <strong>thoracic curves</strong> are usually <strong>convex to the right</strong>, and lumbar curves are usually convex to the left. Intermediate (thoracolumbar) and combined (double primary) curves may also occur.</p>\n<p>Progression of Adolescent Idiopathic Scoliosis: Progression is defined as an<strong> increase of Cobb's angle by 5 degrees or more</strong>, measured in two or more visits. Factors affecting progression are:</p>\n<ul>\n<li><strong>Girls&gt;Boys</strong>: Girls are more likely to progress than boys</li>\n<li><strong>Younger children&gt;Older children</strong>: Incidence of progression<strong> decreases as the child gets older</strong>. Curve progression occurs during the rapid adolescent growth spurt before the onset of menses</li>\n<li><strong>Risser sign of 0</strong> at presentation: More likely to progress</li>\n<li><strong>Double curves &gt; single curves</strong>: Double curves are more likely to progress than single curves</li>\n<li><strong>Thoracic curves &gt; lumbar curves</strong>: Single thoracic curves tend to be more progressive than single lumbar curves.\u00a0</li>\n<li><strong>Curve magnitude</strong>: Incidence of progression increases with the curve magnitude</li>\n</ul>\n</div>\n</div>\n</div>\n<p><strong>Idiopathic scoliosis</strong> is subclassified as<strong>\u00a0:</strong></p>\n<table style=\"width: 735.297px;\">\n<tbody>\n<tr>\n<td style=\"width: 149px;\">\u00a0</td>\n<td style=\"width: 145px;\"><strong>Infantile scoliosis \u00a0\u00a0</strong></td>\n<td style=\"width: 187px;\"><strong>Juvenile idiopathic scoliosis</strong></td>\n<td style=\"width: 224.297px;\"><strong>Adolescent idiopathic scoliosis</strong></td>\n</tr>\n<tr>\n<td style=\"width: 149px;\">Onset age</td>\n<td style=\"width: 145px;\">Birth to 3 years</td>\n<td style=\"width: 187px;\">4 to 9 years</td>\n<td style=\"width: 224.297px;\">10 years to skeletal maturity</td>\n</tr>\n<tr>\n<td style=\"width: 149px;\">Common curve\u00a0</td>\n<td style=\"width: 145px;\">Left thoracic\u00a0</td>\n<td style=\"width: 187px;\">Right thoracic\u00a0</td>\n<td style=\"width: 224.297px;\">Right thoracic\u00a0</td>\n</tr>\n<tr>\n<td style=\"width: 149px;\">Curve self resolution</td>\n<td style=\"width: 145px;\">\n<p>Resolves in 90%</p>\n</td>\n<td style=\"width: 187px;\">Resolves in 20%</td>\n<td style=\"width: 224.297px;\">Rare</td>\n</tr>\n<tr>\n<td style=\"width: 149px;\">Surgical management</td>\n<td style=\"width: 145px;\">\n<ul>\n<li>&lt;8 yr: Instrumentation without fusion</li>\n<li>After 8 yr: ASF-PSF</li>\n<li>After 11 yr: PSF</li>\n</ul>\n</td>\n<td style=\"width: 187px;\">\n<ul>\n<li>&lt;8 yr: Instrumentation without fusion</li>\n<li>After 8 yr: ASF-PSF</li>\n<li>After 11 yr: PSF</li>\n</ul>\n</td>\n<td style=\"width: 224.297px;\">\n<ul>\n<li class=\"p1\">PSF with instrumentation</li>\n<li class=\"p1\">ASF if &lt; 11 yrs with open triradiate cartilage</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0Note: ASF - Anterior spinal fusion, PSF - Posterior spinal fusion</p>\n<p>The image below shows the measurement of Cobb's angle.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6eb0617728c9491eba3f2a8bfbad4f05.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d457ffff96a9400c8266579055e260dax1280x1703.JPEG"
    ]
  },
  {
    "text": "A full-term male infant was born at 37 weeks by vaginal delivery to a teenage mother. An incidental finding of protruding, violaceous, and wet intestinal loops through the abdomen was noted. There was no membrane surrounding it. Which of the following is associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Beckwith Wiedemann syndrome"
      },
      {
        "id": 2,
        "text": "Meningomyelocoele"
      },
      {
        "id": 3,
        "text": "Intestinal atresia"
      },
      {
        "id": 4,
        "text": "Trisomy 18"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">The clinical vignette is describing a case of <strong>gastroschisis</strong>, which can be associated with <strong>intestinal atresia</strong>.</p>\n<p class=\"p1\">Gastroschisis is the <strong>commonest</strong> defect in babies born to <strong>teenage mothers</strong>. The fetal bowel prolapses through a defect to the right of the umbilicus. The bowel is non&shy;rotated, foreshortened, and is covered by a fibrin&shy;ous peel, but&nbsp;<strong>not covered by a membrane</strong>.</p>\n<div class=\"page\" title=\"Page 157\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Gastroschisis has a <strong>good prognosis</strong> although gut dysmotility may delay recovery. Some infants have associated intestinal atresia, and males may have undescended testes.</p>\n</div>\n</div>\n</div>\n</div>\n<p class=\"p1\">The exposed intestines should be gently placed in a sterile clear plastic bag or a silo (a plastic or plastic bag attached to the abdominal wall) after delivery.&nbsp;The infant should be transferred to a tertiary referral center for surgical correction and evaluation for other associated anomalies.&nbsp;</p>\n<p class=\"p1\">&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d7c2f85b026b4317bb5acf6e47072e16x1280x1242.9640084685957.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0ca28327f17547778f248572c57fdd2ex1280x1242.9640084685957.JPEG"
    ]
  },
  {
    "text": "A 62-year-old known hypertensive woman presented to the emergency with spasticity of both lower limbs. Further neurological examination showed regular, repetitive, rhythmic contractions of a muscle subjected to sudden, maintained stretch. Which of the following is false regarding this phenomenon?",
    "choices": [
      {
        "id": 1,
        "text": "Only sustained clonus with five or more beats is considered abnormal"
      },
      {
        "id": 2,
        "text": "Clonus may also occur in spinal cord injury that disrupts the descending cortical input to a spinal glycinergic inhibitory interneuron called the Renshaw cell"
      },
      {
        "id": 3,
        "text": "The stretch reflex\u2013inverse stretch reflex sequence may contribute to this response"
      },
      {
        "id": 4,
        "text": "This is characteristic of states in which decreased \u03b3-motor neuron discharge is present"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The case scenario indicates <strong>clonus</strong>.&nbsp;A characteristic of states in which<strong> increased</strong> &gamma;-motor neuron discharge is present is clonus.&nbsp;</p>\n<p>All the other options are correct.</p>\n<p>When a muscle is subjected to a&nbsp;sudden and maintained stretch, there occur regular, repetitive, and rhythmic contractions. This is called clonus. Ankle clonus is a typical example.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the phenomenon shown below.",
    "choices": [
      {
        "id": 1,
        "text": "Translation"
      },
      {
        "id": 2,
        "text": "Transformation"
      },
      {
        "id": 3,
        "text": "Complementation"
      },
      {
        "id": 4,
        "text": "Conjugation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows a schematic representation of the <strong>blue-white assay</strong> used in the <strong>screening of recombinant vectors\u00a0for inserted DNA fragments</strong>. It uses the phenomenon of <strong>complementation\u00a0</strong>(\u03b1lpha-complementation of the \u03b2-galactosidase gene).</p>\n<p>Blue white assay: The DNA of interest is ligated into a vector. The vector is then inserted into a competent host cell viable for transformation, which is then grown in the presence of X-gal (X-gal detects active \u03b2-galactosidase). Cells transformed with vectors containing <strong>recombinant DNA </strong>will produce<strong> white colonies </strong>whereas\u00a0cells transformed with non-recombinant plasmids (i.e. only the vector) grow into blue colonies.</p>\n<p>The image below shows the result of a blue-white assay.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e3cfb150996e46179163a897cd3823ca.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/53a706e417e4439889c4fec0a2189b5ex600x600.JPEG"
    ]
  },
  {
    "text": "A 50-year-old male patient presents to the casualty with severe bleeding following a road traffic accident. He is a known cardiac disease patient on anticoagulant therapy.  As an intern, you were asked to collect blood for coagulation studies. Which colour vacutainer will you pick?",
    "choices": [
      {
        "id": 1,
        "text": "Lavender"
      },
      {
        "id": 2,
        "text": "Green"
      },
      {
        "id": 3,
        "text": "Red"
      },
      {
        "id": 4,
        "text": "Blue"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The most commonly used <strong>vacutainer</strong> for <strong>coagulation studies</strong> is<strong>&nbsp;</strong>a<strong> blue </strong>vacutainer<strong>&nbsp;</strong>containing <strong>t</strong><strong>risodium citrate</strong>.</p>\n<p>The benefits of&nbsp;trisodium&nbsp;citrate are that the <strong>calcium</strong> ion is <strong>neutralized</strong> more <strong>rapidly</strong> in citrate.</p>\n<p>Other anticoagulants are unacceptable for coagulation studies. The labile factors (factors V and&nbsp;VIII) are unstable in oxalate (grey), whereas heparin (green) and EDTA (lavender) directly inhibit the coagulation process and interfere with end-point determinations. Also, activated partial thromboplastin time (aPTT) tests are more sensitive to the presence of heparin (green).</p>\n<p>The image given below shows colour coding of vacutainers with the anticoagulant used and their practical uses.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da483a0ca63e4a4d940f3175927ac688x1280x2189.JPEG"
    ]
  },
  {
    "text": "What is the most likely diagnosis based on the given serum electrophoresis image?",
    "choices": [
      {
        "id": 1,
        "text": "Multiple myeloma"
      },
      {
        "id": 2,
        "text": "Tuberculosis"
      },
      {
        "id": 3,
        "text": "Hepatic cirrhosis"
      },
      {
        "id": 4,
        "text": "Nephrotic syndrome"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given electrophoresis shows <strong>hypoalbuminemia</strong> and <strong>increased alpha-2 globulin</strong>, which is classically seen in <strong>nephrotic syndrome</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ba2416b811e04838a8e54ea6c7e522fa.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A male patient weighing 50 kg has acute severe asthma, for which theophylline infusion is planned. The target plasma concentration is 10 mg/L. The volume of distribution of theophylline is  0.6 L/kg. What will be the loading dose in this patient for intravenous administration?",
    "choices": [
      {
        "id": 1,
        "text": "200 mg"
      },
      {
        "id": 2,
        "text": "250 mg"
      },
      {
        "id": 3,
        "text": "300 mg"
      },
      {
        "id": 4,
        "text": "350 mg"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>loading dose</strong> of theophylline in this patient for intravenous administration is <strong>300mg.\u00a0</strong></p>\n<p>The loading dose is the amount or dose of a drug given to achieve target plasma concentration quickly when the treatment requires an immediate therapeutic response. It is usually given at the onset of therapy.</p>\n<p>Loading Dose is given by the formula:\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2daab0c99dbc4a309b3638916161d3dbx1280x361.JPEG"
    ]
  },
  {
    "text": "A 24-year-old patient presented with complaints of mucoid diarrhea and abdominal pain for 1 week.  The stool microscopy revealed the following.  What is the appropriate treatment for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Ivermectin"
      },
      {
        "id": 2,
        "text": "Tinidazole"
      },
      {
        "id": 3,
        "text": "Albendazole"
      },
      {
        "id": 4,
        "text": "Praziquantel"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Mucoid diarrhea, abdominal pain and stool microscopy showing the <strong>rhabditiform larva\u00a0</strong>of <em>S. stercoralis\u00a0</em>are suggestive of <strong>strongyloidiasis</strong>.\u00a0The most appropriate treatment for this condition would be<strong>\u00a0ivermectin.</strong></p>\n<p>Strongyloidiasis is caused by the nematode <strong><em>Strongyloides stercoralis.</em>\u00a0</strong>It is generally a benign and asymptomatic condition. Patients often present with <strong>larva currens </strong>due to larval migration or recurrent urticaria. Gastrointestinal symptoms include abdominal pain aggravated by food ingestion, diarrhea, gastrointestinal bleeding and weight loss.<strong> Eosinophilia</strong> is seen. Diagnosis is by detection of <strong>rhabditiform larvae</strong> in <strong>stool</strong> samples. <strong>Eggs</strong> with rhadbitiform larvae can also be seen, as shown below.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/80d5383ef8b1436ca3e35ca4bf41389d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/567c31a87f5d4e91ba77db54b058f62fx720x664.JPEG"
    ]
  },
  {
    "text": "A patient complaining of vertigo without hearing loss has consulted an ENT surgeon. The surgeon performs a diagnostic maneuver and cautiously performs a therapeutic maneuver. What is the diagnostic maneuver?",
    "choices": [
      {
        "id": 1,
        "text": "Hampton's maneuver"
      },
      {
        "id": 2,
        "text": "Dix-Hallpike maneuver"
      },
      {
        "id": 3,
        "text": "Epley's maneuver"
      },
      {
        "id": 4,
        "text": "Simon's maneuver"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of a patient with <strong>vertigo</strong> <strong>without hearing loss</strong> is suggestive of <strong>b</strong><strong>enign paroxysmal positional vertigo</strong> (BPPV).&nbsp;The <strong>diagnostic maneuver</strong> used in BPPV is the <strong>Dix-Hallpike maneuver</strong>, the gold standard for diagnosing BPPV. The <strong>therapeutic maneuver</strong> is <strong>Epley's maneuver</strong>.</p>\n<p><strong>BPPV</strong> is characterized by <strong>vertigo, recurrent brief (&lt;1 minute) episodes</strong> triggered by specific head movements, and is <strong>not</strong> associated with <strong>hearing loss</strong> or other neurological symptoms.</p>\n<p>It is thought to be caused by the <strong>dislodgement</strong> of crystals of <strong>calcium carbonate</strong> from the degenerating macula of the utricle. When this crystal settles on the cupula of the <strong>posterior canal</strong>, it&nbsp;causes displacement of the cupula and vertigo.&nbsp;</p>\n<p>A patient presenting with vertigo should be evaluated for <strong>ruling out the central lesions</strong> (like a tumor in the fourth ventricle, cerebellum, temporal lobe, or multiple sclerosis) before confirming the diagnosis of BPPV. The <strong>Dix-Hallpike</strong> maneuver helps to <strong>differentiate</strong> a <strong>peripheral</strong> from a <strong>central lesion</strong>.</p>\n<p><strong>Dix-Hallpike maneuver</strong>: The maneuver starts with the patient in a <strong>sitting</strong> position. Their head is turned <strong>45 degrees</strong> towards the ear to be tested. Then the examiner quickly brings the patient to a <strong>supine</strong> position with their head<strong> 30 degrees</strong> <strong>below the horizontal</strong>. The <strong>45-degree head rotation</strong> is maintained during the procedure. Now the examiner observes the patient for nystagmus.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d1dab6693b424b19bd3aca7c49bd81a9x1280x2095.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3bb2fd521fc34b67b82d1bb38db07bf6x1280x2359.JPEG"
    ]
  },
  {
    "text": "The following lesion is seen in a 25-year-old man who came to a primary health centre 5 days after he had unprotected sexual intercourse. On palpation the ulcers were painful. Suppurative inguinal lymphadenopathy was present on the right side. The patient has no previous history of drug allergy. Which kit will be used for the management of this particular sexually transmitted disease?",
    "choices": [
      {
        "id": 1,
        "text": "Kit 6/Yellow"
      },
      {
        "id": 2,
        "text": "Kit 2/green"
      },
      {
        "id": 3,
        "text": "Kit 3/white"
      },
      {
        "id": 4,
        "text": "Kit 1/grey"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The appearance of <strong>painful genital ulcers</strong>, along with <strong>unilateral suppurative</strong> inguinal lymphadenopathy, <strong>5 days</strong>&nbsp;after unprotected sexual intercourse best fits the symptom cluster of a <strong>non - herpetic genital ulcer</strong>. The treatment of which is <strong>kit 3 / white kit</strong> in case of <strong>no penicillin allergy.</strong> &nbsp;</p>\n<p>The above-shown clinical image and the findings are consistent with a diagnosis of&nbsp;<strong>chancroid.</strong></p>\n<p><strong>Soft Chancre/Chancroid:</strong></p>\n<ul>\n<li>The causative organism is <strong>&nbsp;<em>Haemophilus ducreyi</em>.</strong></li>\n<li style=\"font-weight: 400;\"><strong>The incubation</strong> period is <strong>3 to 10 days.</strong></li>\n<li style=\"font-weight: 400;\">It presents with <strong>multiple painful ulcers</strong> on genitals.</li>\n<li style=\"font-weight: 400;\">It may be accompanied by unilateral <strong>painful, suppurative inguinal lymphadenopathy.</strong></li>\n<li style=\"font-weight: 400;\">Treatment: Inj. Benzathine penicillin 2.4 million units + tab. Azithromycin 1 gm single dose</li>\n</ul>\n<p>Note: In the syndromic approach to&nbsp;sexually transmitted infections, kit assignment based on the identification of a cluster of symptoms rather than making an actual diagnosis is given emphasis.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6738004f4fa044a3ac682f955897341b.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Ini-Cet Mini - 13 (20 Q)';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>