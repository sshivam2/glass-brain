<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12 Mendelian And Non-Mendelian Disorders - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Pediatrics
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">27</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A pregnant female arrives at your hospital for her antenatal check-up. As an intern, you were required to draw her family pedigree chart while taking history. She has previously delivered full-term healthy dizygotic twins 5 years back. Which of the following symbol will you use to denote dizygotic twins in a pedigree chart?",
    "choices": [
      {
        "id": 1,
        "text": "Option A"
      },
      {
        "id": 2,
        "text": "Option B"
      },
      {
        "id": 3,
        "text": "Option C"
      },
      {
        "id": 4,
        "text": "Option D"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Pedigree charts</strong> are graphical representations of a person's family tree and are useful for identifying the <strong>pattern of inheritance of genetic disorders</strong>. Thus, they are vital in the history-taking of patients, especially in pregnancy.&nbsp;<strong>Option B</strong> is the symbol denoting <strong>dizygotic twins</strong> in a pedigree chart.</p>\n<p>Option A denotes monozygotic twins in the pedigree chart.<br />Option C denotes offsprings.<br />Option D denotes consanguineous marriage.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7dc9d614587044a3b5703f9e76759084.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which pattern of inheritance does the pedigree chart denote?",
    "choices": [
      {
        "id": 1,
        "text": "Autosomal-dominant disorder"
      },
      {
        "id": 2,
        "text": "X- linked dominant disorder"
      },
      {
        "id": 3,
        "text": "Autosomal-recessive disorder"
      },
      {
        "id": 4,
        "text": "X- linked recessive disorder"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above pedigree chart denotes an <strong>autosomal recessive</strong> pattern. In the above pedigree chart, both <strong>males</strong> and <strong>females</strong> are <strong>carriers</strong>\u00a0(equally affected) which indicates an <strong>autosomal</strong> pattern. Parents<strong>\u00a0are unaffected</strong> (both are carriers/heterozygotes), and <strong>no</strong> <strong>affected members</strong> in<strong> other generations</strong>.<strong>\u00a025%</strong> of the children are normal, 50% are carriers, and only\u00a0<strong>25%</strong> are <strong>affected</strong>. This indicates a a<strong> recessive</strong> pattern.\u00a0</p>\n<p>Pedigree charts in various modes of inheritance:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1e78dce118f54143b1975289a8b41a95.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "While volunteering at the blood donation camp, Ananya came across a case of a thalassemic infant who has an AB-positive blood group. Her father is B-positive and her mother is A-positive. In order to understand more about donor eligibility to explain the concerned parents, she wishes to understand the inheritance pattern of ABO blood grouping. Can you help her out by choosing the correct option?",
    "choices": [
      {
        "id": 1,
        "text": "X-linked inheritance"
      },
      {
        "id": 2,
        "text": "Recessive inheritance"
      },
      {
        "id": 3,
        "text": "Mitochondrial inheritance"
      },
      {
        "id": 4,
        "text": "Codominance"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The inheritance pattern of the&nbsp;<strong>ABO </strong>blood grouping system is<strong> codominance.</strong></p>\n<p><strong>Codominance</strong>:</p>\n<p>Gene expression and mendelian traits are usually described as dominant or recessive; in some cases, both of the alleles of a gene pair contribute to the phenotype&mdash;a condition called codominance. Examples include histocompatibility and ABO blood group antigens.</p>\n<p><strong>Classification of genetic disorders</strong></p>\n<p><strong>Mendelian disorders (Classic inheritance)</strong></p>\n<ul>\n<li>Autosomal dominant</li>\n<li>Autosomal recessive</li>\n<li>X-linked dominant</li>\n<li>X-linked recessive</li>\n</ul>\n<p><strong>Non-mendelian disorders ( Non-classic inheritance)</strong></p>\n<ul>\n<li>Trinucleotide repeat mutations\n<ul>\n<li>Fragile X syndrome</li>\n<li>Friedreich ataxia</li>\n<li>Huntington&rsquo;s disease</li>\n</ul>\n</li>\n<li>Mutations in mitochondrial genes: <em>MELAS</em>, <em>MERRF</em></li>\n<li>Genomic imprinting\n<ul>\n<li>Angelman syndrome</li>\n<li>Prader&ndash;Willi syndrome</li>\n<li>Silver&ndash;Russell syndrome</li>\n</ul>\n</li>\n<li>Gonadal mosaicism</li>\n</ul>\n<p><strong>Chromosomal disorders: </strong></p>\n<ul>\n<li>Microdeletions: Cri du chat syndrome</li>\n<li>Down&rsquo;s syndrome, Turner&rsquo;s syndrome, Klinefelter&rsquo;s syndrome</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An MBBS student, after attending a class on genetic disorders, noticed that a particular disorder appears in three consecutive generations of his family without any sex predilection. While drawing his pedigree chart, it also struck him that phenotypically normal family members were having healthy offspring. Based on this information, he concluded the pattern of inheritance of this disorder. What is the correct pattern?",
    "choices": [
      {
        "id": 1,
        "text": "Autosomal recessive"
      },
      {
        "id": 2,
        "text": "Autosomal dominant"
      },
      {
        "id": 3,
        "text": "Mitochondrial inheritance"
      },
      {
        "id": 4,
        "text": "Uniparental disomy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The pattern of inheritance in this genetic disorder is <strong>autosomal dominant</strong>.</p>\n<p>Points in favour:</p>\n<ul>\n<li>Autosomal dominant disorders have a <strong>vertical mode of transmission</strong> (individuals of two generations are affected&mdash;parent and children affected).</li>\n<li>It appears in three consecutive generations of a family without any sex predilection.</li>\n<li>An affected individual has a&nbsp;<strong>50% chance</strong> of passing on the deleterious gene in each pregnancy.</li>\n<li><strong>Males </strong>and<strong> females </strong>are<strong> equally affected.</strong></li>\n<li>Unaffected individuals do not pass on the disorder to their children.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b2678ebb6cf14dff9f3f810c7df8386fx345x600.PNG"
    ]
  },
  {
    "text": "A young boy presented with a history of a genetic disorder. On further enquiry, his father and grandmother had the same disease as well. Prior to his birth, the doctor had counseled the father that there is a 50% chance of passing the deleterious gene to his offspring irrespective of sex.  Which of the following diseases is an example of this inheritance pattern?",
    "choices": [
      {
        "id": 1,
        "text": "Albinism"
      },
      {
        "id": 2,
        "text": "Sickle cell anemia"
      },
      {
        "id": 3,
        "text": "Thalassemia"
      },
      {
        "id": 4,
        "text": "Tuberous sclerosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Autosomal dominance </strong>is the inheritance pattern seen in his question due to three-generation of affected family members with a 50% chance of passing the deleterious gene to the next generation irrespective of sex.&nbsp;<strong>Tuberous sclerosis</strong> is an example of an&nbsp;<strong>autosomal dominant</strong> (AD) disorder.</p>\n<p>Note:</p>\n<ul>\n<li>All Ehlers&ndash;Danlos syndrome types are autosomal dominant, except types V, VI, and VII.</li>\n<li>All types of osteogenesis imperfecta are autosomal dominant, except types II, III, and VII.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Aryan is the first child born to parents suffering from achondroplasia. Although he is not suffering from this condition, the parents wish to know the chances of developing achondroplasia in the second child. What is the correct response?",
    "choices": [
      {
        "id": 1,
        "text": "0%"
      },
      {
        "id": 2,
        "text": "75%"
      },
      {
        "id": 3,
        "text": "25%"
      },
      {
        "id": 4,
        "text": "100%"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The chances of having an affected baby when both parents have <strong>achondroplasia </strong>(autosomal-dominant disorder)&nbsp;is<strong> 75%.</strong></p>\n<ul>\n<li>Autosomal dominant (AD) disorders are manifested in the heterozygous state.</li>\n<li>If both of the parents are affected, the chances of having an affected baby are 75% (50% - 'Aa', and 25% - 'AA').</li>\n</ul>\n<p><strong>Note:</strong>&nbsp;</p>\n<p>Here, we consider <strong>both parents as 'Aa' (heterozygous)</strong> because 'AA' (homozygous) is usually fatal in the first few months of life. The odds of having an affected baby does not change with subsequent pregnancies.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9e16c02b87f84c408e884675e507cb9bx1200x1736.JPEG"
    ]
  },
  {
    "text": "A 3-year-old boy presented with short stature and delayed motor milestones. An x-ray showed a trident hand as given below. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Achondroplasia"
      },
      {
        "id": 2,
        "text": "Mucopolysaccharidosis"
      },
      {
        "id": 3,
        "text": "Osteopetrosis"
      },
      {
        "id": 4,
        "text": "Cleidocranial dysostosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Radiological features</strong>&nbsp;</p>\n<ul>\n<li><strong>Champagne glass pelvic inlet</strong></li>\n<li><strong>Trident hand</strong></li>\n<li>Shortening of tubular bones with metaphyseal flaring.</li>\n<li>Chevron deformity</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c9e94bd390284589aa7dab8bbd1bea6d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1c86232290fb41328a7c6f7152b2589bx800x635.JPEG"
    ]
  },
  {
    "text": "A 14-year-old child presented with multiple hyperpigmented lesions of around size 15-20 mm in the trunk and extremities. Similar lesions of size 2-3 mm were found in his axillary and inguinal regions. A photograph of his eye showing a characteristic lesion is shown below.  What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Tuberous sclerosis"
      },
      {
        "id": 2,
        "text": "Sturge-Weber syndrome"
      },
      {
        "id": 3,
        "text": "Neurofibromatosis"
      },
      {
        "id": 4,
        "text": "Wilson disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The features of cafe-au-lait macules, axillary and inguinal freckling along with Lisch nodules points toward a diagnosis of <strong>neurofibromatosis-1</strong> (NF-1).&nbsp;<br /><br />The multiple hyperpigmented lesions of more than 15 in the trunk and extremities are known as <strong>cafe-au-lait macules</strong> (&gt;5mm in prepubertal, &gt;15mm in postpubertal) and are present in 100% of NF1 cases. The lesions of around 2-3mm in the axillary and inguinal regions are known as <strong>axillary/inguinal freckling</strong> and are pathognomonic of NF1. The given image shows discrete nodules over the iris, which are referred to as <strong>Lisch nodule</strong>s, and are commonly seen in patients with NF-1. Lisch nodules are <strong>iris hamartomas.</strong><br /><br /></p>\n<p><strong>Neurofibromatosis:</strong> It is an&nbsp;<strong>a</strong><strong>utosomal-dominant</strong> neurocutaneous syndrome with the following types-</p>\n<table style=\"width: 651px; height: 377px;\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 280.508px; height: 18px;\"><strong>&nbsp; &nbsp;NF1 (von Recklinghausen disease)<br /></strong></td>\n<td style=\"width: 354.258px; height: 18px;\"><strong>&nbsp; &nbsp; &nbsp; NF2 (Central neurofibromatosis)<br /></strong></td>\n</tr>\n<tr style=\"height: 24px;\">\n<td style=\"width: 280.508px; height: 24px;\">\n<p style=\"text-align: left;\">&nbsp;Mutation on chromosome <strong>17</strong></p>\n</td>\n<td style=\"width: 354.258px; height: 24px;\">&nbsp;Mutation on chromosome <strong>22</strong></td>\n</tr>\n<tr style=\"height: 206.992px;\">\n<td style=\"width: 280.508px; height: 206.992px;\">\n<p style=\"text-align: center;\"><strong>2 or more of the following should be present:</strong></p>\n<ul>\n<li><strong>6 or more caf&eacute;-au-lait spots</strong></li>\n<li>2 or more neurofibromas or one plexiform neuroma</li>\n<li>Freckling in the axillary or inguinal region&nbsp;</li>\n<li>2 or more Lisch nodules</li>\n<li><strong>Dysplasia of the sphenoidal and tibial bone</strong></li>\n<li>A first degree relative with NF1</li>\n<li><strong>Optic gliomas</strong></li>\n</ul>\n</td>\n<td style=\"width: 354.258px; height: 206.992px;\">\n<ul>\n<li>Predisposes to multiple tumours of the nervous system.</li>\n<li><strong>Most common </strong>are <strong>bilateral vestibular schwannomas</strong>; intracranial and spinal meningiomas, gliomas, neurofibromas, and posterior subcapsular lenticular opacities.</li>\n<li>Vestibular schwannomas are benign tumours that arise from the intracanalicular segment of the&nbsp;<strong>inferior division of the vestibulocochlear nerve</strong>.</li>\n<li>Extracanalicular extension into the cerebellopontine angle can lead to an&nbsp;<strong>\"ice cream cone\" </strong>appearance in<strong> MRI</strong>.<strong><br /></strong></li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Axillary freckling is shown in the image below-</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5428543ff5c94ed6a89516a74c2c33d9.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e9a16b58e7894759a19d1ed3e86e603cx262x358.PNG"
    ]
  },
  {
    "text": "Which one of the following is not included in the criteria for neurofibromatosis 1?",
    "choices": [
      {
        "id": 1,
        "text": "Two or more iris hamartomas"
      },
      {
        "id": 2,
        "text": "Acoustic neuromas"
      },
      {
        "id": 3,
        "text": "Dysplasia of the sphenoidal and tibial bone"
      },
      {
        "id": 4,
        "text": "Cafe-au-lait spots"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In <strong>n</strong><strong>eurofibromatosis 1 (NF1)</strong>, <strong>two or more</strong> of the following clinical manifestations are present:</p>\n<ul>\n<li>Six or more caf&eacute;-au-lait macules</li>\n<li>Axillary or inguinal freckling</li>\n<li>Two or more iris Lisch nodules (hamartomas of iris)</li>\n<li>Two or more neurofibromas or 1 plexiform neurofibroma</li>\n<li>A distinctive osseous lesion such as sphenoidal and tibial bone dysplasia</li>\n<li>Optic gliomas</li>\n<li>A 1st-degree relative with NF-1</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Consider the following statements about  caf\u00e9- au- lait macules associated with neurofibromas:",
    "choices": [
      {
        "id": 1,
        "text": "Statements  A, C and E true,  B and D false"
      },
      {
        "id": 2,
        "text": "Statements  B and C true,  A, D and E false"
      },
      {
        "id": 3,
        "text": "Statements B, D and E true,  A and C false"
      },
      {
        "id": 4,
        "text": "Statements A and B true,  C, D and E false"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Statement C: The spots are scattered over the body surface, with a&nbsp;<strong>predilection for the trunk and extremities</strong>; sparing the face<strong>.</strong></p>\n<p>Statement D: For diagnosis, the macules should be &gt;<strong>5 mm in prepubertal </strong>and &gt;<strong>15 mm in postpubertal </strong>individuals.</p>\n<p>Statement E:&nbsp;6 or more spots should be present for the&nbsp;clinical diagnosis of neurofibromatosis&nbsp;</p>\n<p><strong>Caf&eacute;-au-lait macules:</strong></p>\n<ul>\n<li><strong>Hallmark of neurofibromatosis</strong>, present in around 100% of the patients.</li>\n<li><strong>6 or more caf&eacute;-au-lait spots </strong>should be present for the&nbsp;clinical diagnosis of neurofibromatosis along with other criteria<strong>.<br /></strong></li>\n<li>Present at birth, but increase in size, number, and pigmentation, especially during the first few years of life.</li>\n</ul>\n<p><strong>Note:</strong></p>\n<p>Other diseases associated with multiple caf&eacute;-au-lait spots: Ataxia telangiectasia, Bloom syndrome, Fanconi's anaemia, McCune&ndash;Albright syndrome, tuberous sclerosis, Maffucci syndrome, Hunter syndrome.</p>\n<p><strong>Other neurocutaneous syndromes:</strong></p>\n<ul>\n<li>Sturge&ndash;Weber syndrome:&nbsp;port-wine stain over the trigeminal distribution, contralateral hemiparesis,&nbsp;focal seizures contralateral to the side of facial capillary malformations, calcification of the cerebral cortex, mental retardation<strong>,</strong> and congenital glaucoma</li>\n<li>von Hippel&ndash;Lindau disease:&nbsp;retinal angiomas; cerebellar and spinal hemangioblastomas</li>\n<li>Ataxia telangiectasia</li>\n<li>Tuberous sclerosis</li>\n</ul>\n<p>Caf&eacute;-au-lait spots are shown in the image given below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/47a2e57dc60e4a68a1730c951ca41b59x436x378.PNG"
    ]
  },
  {
    "text": "A 9-month-old child presents with a history of a condition seen in the image below. On examination, a characteristic raised skin lesion of orange peel consistency known as shagreen patch is present in his lumbosacral region. Which one of the following is not seen in this autosomal dominant neurocutaneous syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Astrocytoma"
      },
      {
        "id": 2,
        "text": "Rhabdomyoma"
      },
      {
        "id": 3,
        "text": "Optic glioma"
      },
      {
        "id": 4,
        "text": "Subependymal nodule"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Image below</strong>:&nbsp;Periungual fibroma</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b6fc0736e08248e8bb3381450b8c02d4.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b6a5daefeb854101887c0f4669ae17c7x720x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/afbc756d29d24405baee91267b890904x720x627.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f4c048827d8d4a84ac2a5e4ecc66726ex720x539.JPEG"
    ]
  },
  {
    "text": "The first child of a normal healthy couple was diagnosed to have cystic fibrosis. The parents are anxious and wish to seek advice for future pregnancies. What is the percentage of chances for the second child to be affected?",
    "choices": [
      {
        "id": 1,
        "text": "50 %"
      },
      {
        "id": 2,
        "text": "0%"
      },
      {
        "id": 3,
        "text": "25%"
      },
      {
        "id": 4,
        "text": "100 %"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Cystic fibrosis</strong> follows <strong>autosomal recessive</strong> inheritance. Hence, the disease has a <strong>25%</strong> chance of affecting the offspring.</p>\n<p>If parents are unaffected (both are carriers/heterozygotes):</p>\n<ul>\n<li><strong>25%</strong> chance of&nbsp;<strong>normal genotype</strong></li>\n<li><strong>50%</strong>&nbsp;chance of <strong>carriers</strong></li>\n<li><strong>25%</strong>&nbsp;chance of <strong>homozygous</strong></li>\n</ul>\n<p>In <strong>autosomal recessive</strong> disorders, the disease <strong>manifests</strong> itself when the offspring has a <strong>homozygous</strong> state, which means&nbsp;<strong>each child has</strong>&nbsp;a&nbsp;<strong>25% chance</strong>&nbsp;of being affected by the disease.&nbsp;</p>\n<p>Note:</p>\n<p>There are 2 alleles for this, say for example \"A\" = normal allele and \"a\" = abnormal allele. So, if each parent is phenotypically normal and their child is affected, then they are carriers, i.e., \"Aa\". So, each parent has a 0.5 (50%) probability of passing the affected allele to the next generation. Also, having each child is an independent event, and the chance that the child receives an abnormal allele from the father (0.5), as well as a mother (0.5), is equal to 0.5 x 0.5 = 0.25 i.e. 25%.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/120551e2ffa048ddb7ab6cd898d0dfb0x320x463.PNG"
    ]
  },
  {
    "text": "A 29-year-old woman is homozygous for an autosomal-recessive gene and her husband is heterozygous for the same. They are planning to start a family and wish to know the outcome of their pregnancy. Which out of the following options correctly represent the percentages of the outcome?",
    "choices": [
      {
        "id": 1,
        "text": "75% children affected"
      },
      {
        "id": 2,
        "text": "No child affected, but all are carriers"
      },
      {
        "id": 3,
        "text": "50% children affected, rest are carriers"
      },
      {
        "id": 4,
        "text": "25% children affected, rest are carriers"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>If the husband is heterozygous and the wife is homozygous for an autosomal recessive gene, <strong>50% </strong>of the children will be<strong> affected; </strong>the<strong> rest </strong>will be<strong> carriers.</strong></p>\n<p>This is <strong>pseudo-dominant inheritance,</strong> which refers to the observation of apparent dominant (parent to child) transmission of a known autosomal-recessive disorder, or it can also mean the inheritance&nbsp;of a recessive trait mimics a dominant pattern.</p>\n<p>This occurs when a homozygous affected individual has a partner who is a heterozygous carrier, and their children have a&nbsp;<strong>1 in 2 chance to get affected (50%).</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a2e6f5efebbc45a9837d4d2758e23ffax1280x1147.306064880113.JPEG"
    ]
  },
  {
    "text": "What is the mode of inheritance of Menke's disease?",
    "choices": [
      {
        "id": 1,
        "text": "X- linked recessive"
      },
      {
        "id": 2,
        "text": "X- linked dominant"
      },
      {
        "id": 3,
        "text": "Autosomal recessive"
      },
      {
        "id": 4,
        "text": "Autosomal dominant"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The mode of inheritance of Menke's disease is <strong>X-linked recessive</strong>.</p>\n<p>X-linked recessive disorders have the following features:</p>\n<ul>\n<li><strong>Males are affected </strong>more commonly and more severely than females.</li>\n<li><strong>Female carriers</strong> have a <strong>25% risk </strong>for having an <strong>affected son</strong>, a 25% risk for a carrier daughter, and a 50% chance of having a child that does not inherit the mutated X-linked gene.</li>\n<li>The<strong> affected father</strong> will have all <strong>daughters (100%) to be carriers</strong> and <strong>unaffected sons</strong>&nbsp;because they pass their X chromosome to all of their daughters and their Y chromosome to all of their sons.</li>\n</ul>\n<table style=\"width: 615px; height: 312px;\">\n<tbody>\n<tr style=\"height: 15px;\">\n<td style=\"width: 290px; height: 15px;\"><strong>Kinky hair disease (Menkes disease)</strong></td>\n<td style=\"width: 309px; height: 15px;\"><strong>Wilson's disease</strong></td>\n</tr>\n<tr style=\"height: 43px;\">\n<td style=\"width: 290px; height: 43px;\">\n<p>X- linked recessive</p>\n</td>\n<td style=\"width: 309px; height: 43px;\">Autosomal recessive</td>\n</tr>\n<tr style=\"height: 45.8359px;\">\n<td style=\"width: 290px; height: 45.8359px;\">\n<p>&nbsp;</p>\n<p>Mutation of copper-transporting, P-type adenosine triphosphatase 7A leading to <strong>copper deficiency</strong></p>\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 309px; height: 45.8359px;\">\n<p>&nbsp;</p>\n<p>Mutation of adenosine triphosphatase 7B on chromosome 13q14 leading to <strong>excessive</strong> <strong>copper accumulation</strong>.</p>\n<p>&nbsp;</p>\n</td>\n</tr>\n<tr style=\"height: 43px;\">\n<td style=\"width: 290px; height: 43px;\">\n<p><strong>Low </strong>serum copper and ceruloplasmin levels</p>\n</td>\n<td style=\"width: 309px; height: 43px;\"><strong>Low </strong>ceruloplasmin levels; <strong>low&nbsp;</strong>serum-free copper levels and <strong>increased urinary copper excretion</strong></td>\n</tr>\n</tbody>\n</table>\n<p>X- linked recessive pattern of inheritance is shown in the image given below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5894343eaa7e46fd9d266b29a4ae0992x1280x1900.JPEG"
    ]
  },
  {
    "text": "A  41-year-old father of two has an X-linked genetic disorder. His daughter is a carrier for the same and his son is unaffected. His wife is healthy with no inherited disease. Which of the following is an example of this disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Wiskott-Aldrich syndrome"
      },
      {
        "id": 2,
        "text": "Rett Syndrome"
      },
      {
        "id": 3,
        "text": "Thalassemia"
      },
      {
        "id": 4,
        "text": "Alkaptonuria"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The mode of inheritance is&nbsp;<strong>X- linked recessive</strong> and&nbsp;<strong>Wiskott-Aldrich syndrome </strong>is an example of such a genetic disorder.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an X-linked disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Color blindness"
      },
      {
        "id": 2,
        "text": "Thalassemia"
      },
      {
        "id": 3,
        "text": "Sickle cell anemia"
      },
      {
        "id": 4,
        "text": "Cystic fibrosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In color blindness, the mechanism to appreciate one or more primary colors is either defective (anomalous) or absent (anopia). It may be congenital or acquired. Congenital color blindness can be <strong>dyschromatopsia</strong> (defective color vision of any one of the RGB colors) or <strong>achromatopsia</strong> (complete color blindness of all three RGB colors). RGB colors are red, green, and blue.</p>\n<p>Tests for color blindness include the <strong>Ishihara</strong> test, <strong>Hardy&ndash;Rand&ndash;Rittler</strong> test, and <strong>Farnsworth&ndash;Munsell 100-hue</strong> test.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d4c4cf35eacb4ae4b9ee515f7df570abx1280x1900.JPEG"
    ]
  },
  {
    "text": "Which of the following is not true regarding ataxia-telangiectasia?",
    "choices": [
      {
        "id": 1,
        "text": "Mutations in 11q gene is implicated"
      },
      {
        "id": 2,
        "text": "Follows autosomal dominant mode of inheritance"
      },
      {
        "id": 3,
        "text": "Humoral and cellular immunodeficiency"
      },
      {
        "id": 4,
        "text": "Linked to adenocarcinomas"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Ataxia telangiectasia (AT)</strong> or Louis&ndash;Bar syndrome is an <strong>autosomal recessive</strong> disorder.</p>\n<p>The defect in AT is in the <strong>ATM gene</strong> localized to chromosome <strong>11q22-23</strong>. The ATM gene is involved in the <strong>repair of double-strand DNA breaks</strong>. This defect in DNA repair leads to combined <strong>immunodeficiency</strong> (impaired <strong>immunoglobin</strong> <strong>isotype</strong> <strong>switching</strong> and association with <strong>thymic hypoplasia)</strong> and predisposition to an increased risk of <strong>lymphoreticular</strong> <strong>tumors</strong> such as lymphoma or leukemia.</p>\n<p>AT is characterized by <strong>progressive</strong> <strong>ataxia</strong> (beginning during infancy), <strong>telangiectasia</strong> (initially on bulbar conjunctiva), <strong>sinopulmonary</strong> <strong>infections</strong>, hypogonadism, sensitivity to ionizing radiation, insulin resistance, and <strong>raised</strong> <strong>alpha</strong>-<strong>fetoprotein</strong> levels.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old boy presented with progressive muscular weakness showing the following finding. It was found that the child is unable to get up from a squatting position. He was diagnosed with a hereditary muscular disorder. What is the mode of inheritance in this disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Autosomal dominant"
      },
      {
        "id": 2,
        "text": "X- linked recessive"
      },
      {
        "id": 3,
        "text": "Mitochondrial inheritance"
      },
      {
        "id": 4,
        "text": "X- linked dominant"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This clinical vignette includes an image of a child with\u00a0<strong>pseudohypertrophy of calf muscles </strong>along with a history of inability to get up from a squatting position. This is\u00a0characteristically seen in <strong>Duchenne muscular dystrophy</strong>, which is an <strong>X-linked recessive </strong>disorder.</p>\n<p>Salient features of Duchenne muscular dystrophy:</p>\n<ul>\n<li><strong>Most common </strong>hereditary neuromuscular disease.</li>\n<li>X-linked recessive mutations of <strong>dystrophin gene</strong> on chromosome Xp21.</li>\n</ul>\n<p>Clinical features:</p>\n<ul>\n<li>Progressive weakness, developmental delay, and intellectual impairment</li>\n<li>In toddlers: delayed walking, falling, toe walking, and trouble running or walking upstairs</li>\n<li>Common sites of muscular hypertrophy: <strong>calf &gt; tongue &gt; forearm</strong></li>\n<li><strong>Pseudohypertrophy of calf muscles</strong> due to fibrofatty replacement of muscle</li>\n<li><strong>Gower's sign</strong>: Patients use their arms and hands to walk up their own body from a squatting position due to the reduced strength in the\u00a0<strong>proximal muscles(hip &amp;thigh)\u00a0</strong>of the lower limbs<strong>.</strong></li>\n<li><strong>Trendelenburg gait/</strong>hip waddle</li>\n<li>Inability to walk develops by the age of 10-14 years.</li>\n<li>Complications: Contractures, scoliosis, cardiomyopathy, <strong>malignant hyperthermia after anaesthesia.</strong></li>\n<li>Death occurs by 3rd decade of life due to respiratory failure.</li>\n</ul>\n<p><strong>Note</strong>:</p>\n<p>Becker's Muscular Dystrophy (BMD) vs. Duchenne Muscular Dystrophy (DMD)</p>\n<p>Mnemonic-</p>\n<ul>\n<li>BMD: Badly makes dystrophin (defective)</li>\n<li>DMD: Does not make dystrophin (absent)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3c3693f57eee44f8bac10d84ee140824.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/03a36836634a47498932e41618d909cex510x482.GIF"
    ]
  },
  {
    "text": "Your second cousin, Prakriti, has been recently diagnosed with Wiskott-Aldrich syndrome. Your relatives are worried and keep calling you to confirm the new information that they read on the internet. In an attempt to settle their doubts about the credibility of online resources, you inform them that all of the following are true except:",
    "choices": [
      {
        "id": 1,
        "text": "X- linked recessive mode of inheritance"
      },
      {
        "id": 2,
        "text": "Atopic dermatitis and eczema during infancy"
      },
      {
        "id": 3,
        "text": "Thrombocytopenia"
      },
      {
        "id": 4,
        "text": "IgM is increased"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>IgM is <strong>decreased</strong> in Wiskott&ndash;Aldrich syndrome, not increased. It is a <strong>rare genetic immunodeficiency</strong> that keeps a child's immune system from functioning properly. It also makes it difficult for a child's bone marrow to produce platelets, making a child <strong>prone to bleeding</strong>. This syndrome is associated with decreased IgM, increased IgA, and increased IgE levels.</p>\n<p><strong>Wiskott-Aldrich syndrome:</strong></p>\n<p>Mnemonic <strong>WAXTIE</strong></p>\n<ul>\n<li>WA: Wiskott&ndash;Aldrich</li>\n<li>X: X-linked recessive</li>\n<li>T: Thrombocytopenia</li>\n<li>I: Infections</li>\n<li>E: Eczema</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old girl has been diagnosed with a genetic disorder that follows a Mendelian pattern of inheritance illustrated by the pedigree chart below. Which of the following can be a likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Wiskott-Aldrich syndrome"
      },
      {
        "id": 2,
        "text": "Lesh-Nyhan syndrome"
      },
      {
        "id": 3,
        "text": "Hypophosphatemic rickets"
      },
      {
        "id": 4,
        "text": "Fabry disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Note:</strong></p>\n<p>Mnemonic to remember X-linked dominant disorders:&nbsp;<strong>Ribbons For All Children</strong></p>\n<ul>\n<li>Ribbons - <strong>R</strong>ett&rsquo;s syndrome/ Hypophosphatemic <strong>R</strong>ickets</li>\n<li>For - <strong>F</strong>ragile X tremor/ataxia syndrome (FXTAS)</li>\n<li>All - <strong>Al</strong>port syndrome</li>\n<li>Children - <strong>C</strong>harcot&ndash;Marie&ndash;Tooth disease</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/18a3fea4325b432ba36aba25013d76d4.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 3-year-old girl presented with poor growth and social interaction as well as midline stereotypical movements of the hands as seen in the image below. All milestones were normal for the first 2 years. After that, the milestones delayed and her development slowed down. On examination, her gait was slightly clumsy, her speech had regressed to mere babbling and her anthropometry was below the 50th percentile. Following a battery of investigations, the diagnosis of a rare inherited disease was made. What is the affected gene for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "P53"
      },
      {
        "id": 2,
        "text": "Rb"
      },
      {
        "id": 3,
        "text": "MeCP2"
      },
      {
        "id": 4,
        "text": "FGFR3"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given features of poor growth &amp; social interaction, gradual loss of speech, clumsy gait along with the characteristic&nbsp;hand movements point towards a likely diagnosis of&nbsp;<strong>Rett&rsquo;s syndrome.&nbsp;</strong>The gene involved in Rett&rsquo;s syndrome is the&nbsp;<strong><em>MeCP2</em> gene </strong>located on the X&nbsp;chromosome (Xq28 predominantly of paternal origin).&nbsp;</p>\n<p><strong>Rett&rsquo;s syndrome:</strong></p>\n<ul>\n<li><strong>Almost always affects girls (X- linked dominant)</strong></li>\n<li>Development may proceed normally until 1 year of age slowing down to the <strong>extent of&nbsp;regression</strong>.&nbsp;</li>\n<li>After 1 year of age, rapid regression in language and hand skills, motor milestones, and acquired microcephaly become apparent.</li>\n<li>Clinical features can include <strong>repetitive hand wringing movements</strong>, ataxia, breathing dysfunction, bruxism, scoliosis, and profound mental retardation.</li>\n<li><strong>Autistic behaviour</strong> is a typical finding in all patients.</li>\n</ul>\n<p>Note:</p>\n<ul>\n<li>Rb: Retinoblastoma: 13 chromosome</li>\n<li>P53: Li&ndash;Fraumeni syndrome, Sarcomas: 17</li>\n<li>NF1: Neurofibromatosis 1-17</li>\n<li>NF2: Neurofibromatosis 2-22</li>\n<li>WT1: Wilms's tumour: 11</li>\n<li>FGFR3: Achondroplasia</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bc4d317cd9be434d8c37f665f44ee19c.GIF"
    ],
    "explanation_images": []
  },
  {
    "text": "While reviewing a junior's research manuscript on trinucleotide repeat sequences, you come across the following list of examples and spot an error. Which of the following diseases will you mark for omission?",
    "choices": [
      {
        "id": 1,
        "text": "Huntington\u2019s disease"
      },
      {
        "id": 2,
        "text": "Fredreich\u2019s ataxia"
      },
      {
        "id": 3,
        "text": "Myotonic dystrophy"
      },
      {
        "id": 4,
        "text": "Hereditary motor-sensory neuropathy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Hereditary motor-sensory neuropathy, commonly known as&nbsp;<strong>Charcot-Marie-Tooth neuropathy,</strong>&nbsp;is a type of <strong>X-linked dominant</strong> disorder. The rest of the options are associated with <strong>trinucleotide repeat sequences.</strong></p>\n<p><strong>Triple-repeat mutations </strong>(Allelic expansion disorders).</p>\n<ul>\n<li>Due to an increase in the number of nucleotide repeats above a certain threshold.</li>\n<li>Length of the nucleotide repeat often correlates with the severity of the disease.</li>\n<li><strong>Anticipation</strong>: When repeat length increases from one generation to the next, disease manifestations may worsen or be observed at an earlier age.</li>\n</ul>\n<table style=\"height: 284px; width: 537px;\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 177px; height: 18px;\"><strong>Disease</strong></td>\n<td style=\"width: 68.33334350585938px; height: 18px;\"><strong>Repeats</strong></td>\n<td style=\"width: 260.6666564941406px; height: 18px;\"><strong>Clinical features</strong></td>\n</tr>\n<tr style=\"height: 91px;\">\n<td style=\"width: 177px; height: 91px;\"><strong>Fragile X- syndrome</strong></td>\n<td style=\"width: 68.33334350585938px; height: 91px;\">&nbsp; <strong>CGG</strong></td>\n<td style=\"width: 260.6666564941406px; height: 91px;\">Mental retardation, large ears,&nbsp;and jaws, macroorchidism in males</td>\n</tr>\n<tr style=\"height: 107.2px;\">\n<td style=\"width: 177px; height: 107.2px;\">\n<p>Myotonic Dystrophy</p>\n<p>(<strong>chromosome 19)</strong></p>\n</td>\n<td style=\"width: 68.33334350585938px; height: 107.2px;\">&nbsp; CTG</td>\n<td style=\"width: 260.6666564941406px; height: 107.2px;\">Muscle loss, cardiac arrhythmia,<br /><strong>cataracts</strong>, frontal balding</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 177px; height: 36px;\"><strong>Huntington&rsquo;s disease</strong></td>\n<td style=\"width: 68.33334350585938px; height: 36px;\">&nbsp; <strong>CAG</strong></td>\n<td style=\"width: 260.6666564941406px; height: 36px;\">Affective disorder</td>\n</tr>\n<tr style=\"height: 72px;\">\n<td style=\"width: 177px; height: 72px;\">Spinocerebellar ataxia type 1</td>\n<td style=\"width: 68.33334350585938px; height: 72px;\">&nbsp; CAG</td>\n<td style=\"width: 260.6666564941406px; height: 72px;\">Progressive ataxia, dysarthria,<br />dysmetria.</td>\n</tr>\n<tr style=\"height: 91px;\">\n<td style=\"width: 177px; height: 91px;\"><strong>Friedreich's ataxia</strong></td>\n<td style=\"width: 68.33334350585938px; height: 91px;\">&nbsp; <strong>GAA</strong></td>\n<td style=\"width: 260.6666564941406px; height: 91px;\">Progressive ataxia,<br />dysarthria, hypertrophic<br />cardiomyopathy.</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-year-old child presents with previously diagnosed fragile X syndrome. As an intern posted in the department, you are asked to follow up on his cytogenetic analysis report.\n What is the trinucleotide repeat mutation seen in the report?",
    "choices": [
      {
        "id": 1,
        "text": "CGG"
      },
      {
        "id": 2,
        "text": "GAA"
      },
      {
        "id": 3,
        "text": "CAG"
      },
      {
        "id": 4,
        "text": "CTG"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The trinucleotide repeat mutation associated with&nbsp;<strong>fragile X syndrome</strong>&nbsp;is <strong>CGG</strong> in the familial mental retardation -1 (<strong>FMR1</strong>) gene.</p>\n<p>Other common trinucleotide repeat mutations and their associated conditions:</p>\n<ul>\n<li style=\"font-weight: 400;\">GAA- Friedreich ataxia</li>\n<li style=\"font-weight: 400;\">CAG- Huntington disease</li>\n<li style=\"font-weight: 400;\">CTG- Myotonic dystrophy</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 8-year-old boy was brought for psychiatric evaluation for intellectual disability. On examination, his IQ was 45 and a previous report in his records show a trinucleotide repeat mutation of CGG. Which of the following is not seen in it?",
    "choices": [
      {
        "id": 1,
        "text": "Large head"
      },
      {
        "id": 2,
        "text": "Large nose"
      },
      {
        "id": 3,
        "text": "Large ear"
      },
      {
        "id": 4,
        "text": "Large testis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In fragile-X syndrome, there would be a <strong>small nose, not large.</strong></p>\n<ul>\n<li><strong>Fragile X syndrome or Martin\u2013Bell syndrome:</strong> Trinucleotide repeat mutation of CGG.</li>\n</ul>\n<p>Remember mnemonic <strong>Hello Mr. FRAGILE X Syndrome:</strong></p>\n<ul>\n<li>Hello:\u00a0<strong>H</strong>yperextensible joint or high-arched palate</li>\n<li>Mr:\u00a0<strong>M</strong>itral valve prolapse</li>\n<li>F:\u00a0<strong>F</strong>MR1 P deficiency (fragile X mental retardation 1 protein) - upregulates the metabotropic glutamate receptor (mGluR) 5 pathway and alters the expression of matrix metalloproteinase (MMP) 9.</li>\n<li>R:\u00a0<strong>R</strong>epeating the sequence of 3 nucleotides CGG, recurrent otitis media.</li>\n<li>A:<strong>\u00a0A</strong>utism/Attention deficit\u2013hyperactivity disorder/Anxiety</li>\n<li>G:\u00a0<strong>G</strong>iant brain (macrocephaly) and giant testis (macroorchidism)</li>\n<li>I:\u00a0<strong>I</strong>ntellectual disability, i.e., mental retardation</li>\n<li>L:<strong>\u00a0L</strong>ong face with a <strong>large mandible</strong></li>\n<li>E:\u00a0<strong>E</strong>verted ear</li>\n<li>X:\u00a0<strong>X-</strong>linked disorder (controversial as to whether it is X-linked dominant or recessive)</li>\n</ul>\n<p>The most common genetic cause of mental retardation is <strong>Down\u2019s syndrome &gt; Fragile X Syndrome.<br /></strong></p>\n<p><strong>Sherman's paradox</strong>: Risk of expressing mental retardation in fragile X syndrome increases in later generations (<strong>anticipation</strong>).</p>\n<p><strong>Fragile X-associated tremor or ataxia: </strong>Intention tremors and cerebellar ataxia, which may progress to parkinsonism.</p>\n<p><strong>Note</strong>:</p>\n<p>Inhibitors of the mGluR (overexpressed in fragile X) are undergoing clinical trials. <strong>Minocycline</strong> (lowers MMP9) has resulted in short-term improvements in anxiety, mood, and the Clinical Global Impression Scale.</p>\n<p><strong>Image</strong>: A child with affected fragile X- syndrome; note the everted ears, long face,\u00a0and large mandible.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/25200da08b2e4a35a6db4e5e9673712cx800x591.JPEG"
    ]
  },
  {
    "text": "As a participant in the Indian Academy of Paediatrics quiz, you are asked to mark the type of inheritance in MELAS.  The pedigree chart shown in the image below is provided to explain which family members may be affected (coloured in red). Which of the following will you choose?",
    "choices": [
      {
        "id": 1,
        "text": "X- linked Recessive"
      },
      {
        "id": 2,
        "text": "Autosomal Recessive"
      },
      {
        "id": 3,
        "text": "Mitochondrial"
      },
      {
        "id": 4,
        "text": "X- linked Dominant"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The type of inheritance in<strong> MELAS </strong>is<strong> mitochondrial,</strong> which manifests as <strong>mitochondrial myopathy,&nbsp;</strong><strong>encephalopathy</strong>, <strong>lactic acidosis,</strong> and <strong>stroke-like episodes</strong>.</p>\n<p>Mitochondrial inheritance:</p>\n<ul>\n<li>Inherited <strong>exclusively from the affected mother</strong> (ovum) as an individual&rsquo;s mitochondrial genome is entirely derived from the mother because sperms&nbsp;contain few mitochondria, which are typically shed upon fertilization.</li>\n<li>Both <strong>male and female children</strong> born to an affected mother will inherit the disease.</li>\n<li>80% of mitochondrial DNA codes for mitochondrial RNA, and therefore most mitochondrial DNA mutations lead to functional problems, which may be manifested as <strong>muscle disorders</strong>.</li>\n</ul>\n<p>The following pedigree shows the mitochondrial inheritance pattern-</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6b8ef5a281da4089817ceb7ac871b7ec.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/db99ee6b20454e89a49654cba62b63d6x1280x1243.JPEG"
    ]
  },
  {
    "text": "In order to understand the topic 'Non-Mendelian disorders', you have prepared flashcards. But, while browsing through them before your viva, the order of cards have been jumbled up. Which of the following option will you choose to correctly match the phenomena with their definitions?",
    "choices": [
      {
        "id": 1,
        "text": "1-C, 2-A, 3-D, 4-B"
      },
      {
        "id": 2,
        "text": "1-A, 2-B, 3-C, 4-D"
      },
      {
        "id": 3,
        "text": "1-B, 2-D, 3-A, 4-C"
      },
      {
        "id": 4,
        "text": "1-D, 2-C, 3-B, 4-A"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The phenomena are correctly matched with their definitions as follows-</p>\n<ul>\n<li><strong>Genomic imprinting:</strong> Phenotypic expression of a gene depending on the parent of origin.</li>\n<li><strong>Mosaicism:</strong> Single organism possessing more than one genetic line as the result of genetic mutation.</li>\n<li><strong>Anticipation:</strong> Symptoms become more severe and/or appear at an earlier age as the disorder is passed from one generation to the next.</li>\n<li><strong>Non-penetrance:</strong> A genetic trait that is present in the genome but does not manifest itself in the individual.</li>\n</ul>\n<p><strong>Genomic imprinting: </strong>epigenetic process, that selectively inactivates either the maternal or paternal allele. These defects include:</p>\n<ul>\n<li>Beckwith- Wiedemann syndrome</li>\n<li>Silver Russell syndrome</li>\n<li>Angelman syndrome</li>\n<li>Prader Willi syndrome</li>\n</ul>\n<p><strong>Note: </strong></p>\n<p><strong>Uniparental disomy:&nbsp;</strong>This refers to the situation in which two copies of a chromosome come from the same parent, instead of one from each parent. Eg., <strong>Angelman syndrome </strong>and <strong>Prader Willi syndrome.</strong></p>\n<table>\n<tbody>\n<tr>\n<td>&nbsp;</td>\n<td><strong>P</strong>rader&ndash;Willi syndrome</td>\n<td>Angel<strong>M</strong>an syndrome</td>\n</tr>\n<tr>\n<td>Deletions (70% cases)</td>\n<td><strong>Deletion</strong> of <strong>P</strong>aternal genes after maternal gene silencing</td>\n<td><strong>Deletion</strong> of<strong> M</strong>aternal genes after paternal gene silencing</td>\n</tr>\n<tr>\n<td>\n<p><strong>Uniparental disomy&nbsp;</strong>(UPD) (30%)</p>\n</td>\n<td><strong>UPD of maternal chromosome 15</strong></td>\n<td><strong>UPD of paternal chromosome 15</strong></td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 6-month-old presented with a genetic disorder attributed to multifactorial inheritance. This type of inheritance is most likely to play a significant role in which of the following disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Achondroplasia"
      },
      {
        "id": 2,
        "text": "Lysosomal storage disease"
      },
      {
        "id": 3,
        "text": "Cleft lip"
      },
      {
        "id": 4,
        "text": "Huntington disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<table style=\"height: 193px;\" border=\"1\" width=\"441\">\n<tbody>\n<tr>\n<td style=\"width: 254.281px;\">\n<p><strong>Children (congenital malformation)</strong></p>\n</td>\n<td style=\"width: 170.719px;\">\n<p><strong>&nbsp; &nbsp;Adults</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 254.281px;\">\n<p>Pyloric stenosis</p>\n<p>Neural tube defects</p>\n<p>Congenital heart defects</p>\n<p>Congenital dislocation of the hip</p>\n<p>Cleft lip and cleft palate</p>\n</td>\n<td style=\"width: 170.719px;\">\n<p>&nbsp;Diabetes Mellitus</p>\n<p>&nbsp;Hypertension</p>\n<p>&nbsp;Coronary heart disease</p>\n<p>&nbsp;Gout</p>\n<p>&nbsp;Schizophrenia</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '12 Mendelian And Non-Mendelian Disorders';
        const quizFilename = '12-mendelian-and-non-mendelian-disorders-d70844bf.html';
        let hierarchy = ["Marrow", "qBank", "Pediatrics"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>