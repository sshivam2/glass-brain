<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>102 Community Medicine Neet 2023 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Community Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">15</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "In a village, it is observed that several farmers have crossed gait and use a stick for support to stand up and walk. Due to poor yield from farms, they consume meals containing rice and pulses only. Supplementing their diet with which of the following vitamins could have prevented this?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin A"
      },
      {
        "id": 2,
        "text": "Vitamin D"
      },
      {
        "id": 3,
        "text": "Vitamin C"
      },
      {
        "id": 4,
        "text": "Vitamin B"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The likely diagnosis based on the given clinical scenario is\u00a0<strong>neurolathyrism.\u00a0</strong>\u00a0Administration of\u00a0<strong>vi</strong><strong>tamin C\u00a0</strong>at doses of 500-1000 mg is beneficial for this.</p>\n<p>Lathyrism is a paralyzing disease of humans and animals.\u00a0It is due to the <strong>consumption</strong> of <strong>khesari dal</strong>\u00a0or<strong>\u00a0<em>Lathyrus sativus</em>.\u00a0</strong>When the husk is removed, it\u00a0looks similar to red gram or Bengal gram.\u00a0It is mostly consumed by\u00a0<strong>poor agricultural laborers</strong>\u00a0because it is relatively cheap<strong>. </strong>Lathyrism\u00a0is more prevalent in parts of Madhya Pradesh, Uttar Pradesh, Odisha, and Bihar. The Prevention of Food Adulteration Act in India has\u00a0<strong>banned</strong>\u00a0<em>Lathyrus sativus</em>\u00a0in all forms (whole/ split/ flour).\u00a0</p>\n<p>In<strong>\u00a0humans</strong>, it is referred to as\u00a0<strong>neurolathyrism</strong>\u00a0because it\u00a0affects the\u00a0<strong>nervous</strong>\u00a0system. It is\u00a0characterized by gradually developing\u00a0<strong>spastic\u00a0paralysis</strong>\u00a0of the\u00a0<strong>lower limbs.\u00a0</strong>Beta-oxalyl amino alanine (<strong>BOAA</strong>)\u00a0is the toxic compound causing this disease. It is water-soluble and can be removed by the following methods:</p>\n<ul>\n<li>Soaking\u00a0pulses in <strong>hot water</strong>\u00a0and discarding the water\u00a0</li>\n<li>Overnight soaking in <strong>lime water,</strong> followed by <strong>boiling</strong>\u00a0</li>\n<li><strong>Parboiling</strong>\u00a0- for large-scale detoxification</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old homeless man presented with a 1-month history of fever, cough, and weight loss. Both sputum smears turned out to be negative, but the chest x-ray ordered was suggestive of tuberculosis. According to the recent NTEP guidelines, which is the next best line of management?",
    "choices": [
      {
        "id": 1,
        "text": "Repeat sputum smears"
      },
      {
        "id": 2,
        "text": "Ask for CBNAAT"
      },
      {
        "id": 3,
        "text": "Ask for line probe assay"
      },
      {
        "id": 4,
        "text": "Wait until TB culture results to start ATT"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given case with the classical symptoms of\u00a0<strong>evening rise of temperature</strong>\u00a0and\u00a0<strong>productive cough</strong>\u00a0of\u00a0<strong>more than 2 weeks</strong> in\u00a0duration prompts a diagnosis of\u00a0<strong>pulmonary tuberculosis</strong>.\u00a0According to the NTEP guidelines, the next best line of management is <strong>CBNAAT</strong>.</p>\n<p>The<strong>\u00a0initial diagnosis</strong>\u00a0of pulmonary TB is done with\u00a0<strong>sputum smear examination and chest radiography</strong>. Chest radiography features suggestive of TB include\u00a0<strong>upper lobe infiltrates</strong>\u00a0<strong>and cavities</strong>. However, these are not very specific to TB. The presence of these features\u00a0<strong>should prompt microbiological evaluation</strong>\u00a0for\u00a0<em>Mycobacterium tuberculosis</em>.</p>\n<p>A\u00a0<strong>positive smear</strong>\u00a0examination,<strong> irrespective of CXR findings, </strong>is considered as <strong>microbiologically positive with sensitivity status unknown</strong>. Drug <strong>sensitivity status</strong> via NAAT is to be done following a sputum smear <strong>before</strong> <strong>initiation of treatment</strong>. This helps in the early detection and treatment of drug-resistant TB. This has been integrated into the regular TB services to detect rifampicin resistance at the time of diagnosis. Depending on the sensitivity of the tubercle bacilli, appropriate ATT is started.</p>\n<p>In cases of high <strong>clinical suspicion</strong>, <strong>positive CXR findings</strong>, or in <strong>people with HIV</strong>, a <strong>CB-NAAT</strong> is done. Two sputum samples are sent for cartridge-based nucleic acid amplification (CBNAAT), which detects the presence of <em>Mycobacterium</em> DNA along with resistance against rifampicin within 2 hours. It analyses sputum or any other biological specimen (except blood and blood-contaminated specimens) using real-time PCR technology.</p>\n<p>The interpretation of CBNAAT is as follows:</p>\n<ul>\n<li>If the\u00a0<strong>CBNAAT</strong>\u00a0turns out to be\u00a0<strong>positive/MTB detected,\u00a0</strong>the 2<sup>nd</sup> sample is sent for culture and drug sensitivity testing (C&amp;DST) immediately.</li>\n<li>If the\u00a0<strong>CBNAAT</strong>\u00a0turns out to be\u00a0<strong>negative</strong>\u00a0for rifampicin resistance, a first-line\u00a0line probe assay is ordered, to look for isoniazid resistance.\n<ul>\n<li>If FL-LPA shows no resistance to isoniazid, the patient is\u00a0<strong>treated as drug-sensitive,</strong>\u00a0and a conventional daily regime of 2HRZE and 4HRE is given.</li>\n<li>If FL-LPA shows resistance to isoniazid, reflex testing is done using second-line line probe assay (SL-LPA).\n<ul>\n<li>If SL-LPA turns out to be negative, treat as isoniazid or H-mono-/poly-resistance</li>\n<li>If SL-LPA turns out to be resistant to some drugs, modify the treatment regime accordingly.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>If CBNAAT is\u00a0<strong>positive</strong> for rifampicin resistance, the second sample is sent for first-line line probe assay (FL-LPA), second-line line probe assay (SL-LPA), and BACTEC MGIT 960 to look for isoniazid (H) mono-/poly-resistance\n<ul>\n<li>If there is no resistance/H-mono-/poly- resistance, treat as shorter oral bedaquiline-containing MDR regime.</li>\n<li>If there is resistance, then treat as longer oral bedaquiline-containing MDR regime.</li>\n</ul>\n</li>\n<li>If the\u00a0<strong>2<sup>nd</sup> sample also</strong>\u00a0turns out to be\u00a0<strong>indeterminate</strong>, a\u00a0<strong>fresh sample\u00a0</strong>is taken for <strong>LPA or liquid culture</strong>, to ascertain drug resistance. Meanwhile, treatment initiation is done and modified subsequently, as per results.</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: Repeat sputum smears are not the next best line of management in this case, as the patient already had two negative sputum smears and a chest x-ray suggestive of tuberculosis.</p>\n<p>Option C: Line probe assay would not be the immediate next step in management. First, CBNAAT should be performed to detect Mycobacterium tuberculosis and identify rifampicin resistance.</p>\n<p>Option D: Waiting for TB culture results to start ATT is not the best management strategy, as it can take several weeks for the results to come back, and the patient may deteriorate in the meantime.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Research is being conducted to find the association between aniline dye exposure and bladder cancer in workers who have worked in the industry for >20 years. Two groups were formed: one directly involved with dye handling and the other group consisting of office clerks not directly exposed to the dye. Years of occupation were noted from records. What type of study is being performed?",
    "choices": [
      {
        "id": 1,
        "text": "Retrospective cohort study"
      },
      {
        "id": 2,
        "text": "Prospective cohort study"
      },
      {
        "id": 3,
        "text": "Case-control study"
      },
      {
        "id": 4,
        "text": "Intervention and response"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div style=\"text-align: justify;\">The study given here is a <strong>retrospective cohort&nbsp;</strong><strong>study.&nbsp; </strong></div>\n<div style=\"text-align: justify;\">&nbsp;</div>\n<div style=\"text-align: justify;\"><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">A retrospective cohort study&nbsp;is when both the&nbsp;<strong>exposure and outcome have occurred</strong>&nbsp;before the investigations and study is undertaken. </span></div>\n<div style=\"text-align: justify;\"><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">In this scenario, the workers in the industry were divided into two groups, viz those who are directly exposed and the clerical staff who are not directly exposed to the suspected carcinogen. The incidence of carcinogenesis among these two groups is studied <strong>going backward</strong> tracking their records. </span></div>\n<div style=\"text-align: justify;\">&nbsp;</div>\n<div style=\"text-align: justify;\"><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">An increased risk of bladder cancer was observed among long-term workers directly exposed to the chemical in aniline dye industries when compared with the other study group. </span>It is also called a <strong>historical cohort study</strong>, a <strong>prospective study in retrospect</strong>, or a <strong>non-concurrent prospective study</strong>. The cohort is identified from past records and is assessed to date for the outcome. The same cohort is followed up prospectively in the future for further assessment of the outcome.</div>\n<div style=\"text-align: justify;\">&nbsp;</div>\n<div style=\"text-align: justify;\">Other options:</div>\n<div style=\"text-align: justify;\">&nbsp;</div>\n<div style=\"text-align: justify;\">Option B - <strong>Prospective cohort study</strong>: This type of study involves following a group of participants over time and monitoring their exposure to a risk factor and the development of an outcome. In this case, the outcome (bladder cancer) and exposure (aniline dye) have already occurred, making this a retrospective cohort study.</div>\n<div style=\"text-align: justify;\">&nbsp;</div>\n<div style=\"text-align: justify;\">Option C - <strong>Case-control study</strong>: A case-control study involves comparing individuals with a specific outcome (cases) to those without the outcome (controls) and assessing their exposure history. This study design is not being used in the given scenario, as the workers are divided into two groups based on their exposure status and followed for the development of bladder cancer.</div>\n<div style=\"text-align: justify;\">&nbsp;</div>\n<div style=\"text-align: justify;\">Option D - <strong>Intervention and response</strong>: This option is not a type of epidemiological study design. It could refer to an intervention study, in which an intervention is applied to a group of participants, and the response is measured. However, this is not applicable to the current scenario.</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The blood pressure of a population was tracked from childhood to adulthood. It was observed that those who had lower BP in childhood had low BP in adulthood, while those who had higher BP in childhood had high BP in adulthood. This can be best described as____",
    "choices": [
      {
        "id": 1,
        "text": "Rule of halves"
      },
      {
        "id": 2,
        "text": "Tracking of blood pressure"
      },
      {
        "id": 3,
        "text": "STEPwise approach"
      },
      {
        "id": 4,
        "text": "Primordial approach"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option B:&nbsp;The <strong>WHO STEPwise</strong> approach to <strong>non-communicable disease </strong>(NCD)&nbsp;risk factor surveillance (STEPS) is a simple, standardized method for <strong>collecting, analyzing, and disseminating data</strong> on key NCD risk factors such as tobacco use, alcohol use, physical inactivity, unhealthy diet, overweight and obesity, raised blood pressure, raised blood glucose, and abnormal blood lipids.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c5d72079f7ac42159117e0bc8007cc2dx1280x1833.JPEG"
    ]
  },
  {
    "text": "A 30-week primigravida c/o reduced vision at night. She has been avoiding papaya, mango, and other fruits throughout her pregnancy as she thinks they could be abortifacients. It is the primary duty of which of the following workers to provide counseling and information to the patient?",
    "choices": [
      {
        "id": 1,
        "text": "ANM"
      },
      {
        "id": 2,
        "text": "AWW"
      },
      {
        "id": 3,
        "text": "Trained birth attendant"
      },
      {
        "id": 4,
        "text": "ASHA"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Amongst the given options, it is the duty of the ASHA to provide counseling and information to this pregnant patient</p>\n<p>An ASHA is&nbsp;a trained female community health activist and&nbsp;a <strong>resident woman</strong> of the<strong> village </strong>with<strong>&nbsp;</strong>a <strong>formal education </strong>of at least up to<strong>&nbsp;10th grade.&nbsp;</strong>She should preferably be in the age group of <strong>25 </strong>to<strong> 45 years (married/divorced/widow)&nbsp;</strong>and<strong>&nbsp;</strong>have qualities such as good communication skills and leadership skills. The general norm of selection recommends having<strong>&nbsp;one ASHA</strong> for<strong> 1000 population</strong>,&nbsp;but in tribal, hilly, and desert areas, the norm could be relaxed to one ASHA per habitation.</p>\n<div class=\"page\" title=\"Page 1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>&nbsp;Roles of ASHA:</p>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>To create<strong> awareness </strong>and provide<strong> information</strong> to the community on determinants of<strong> health </strong>such as nutrition, basic sanitation, and hygienic practices</li>\n<li>To <strong>counsel women</strong> on <strong>birth preparedness</strong>, the importance of <strong>safe delivery</strong>, <strong>breast-feeding</strong> and complementary feeding, immunization, and contraception</li>\n<li>To counsel women on the <strong>prevention </strong>of common infections including reproductive tract infection/<strong>sexually transmitted infection</strong>&nbsp;</li>\n<li>To mobilize the community and help them in <strong>accessing</strong> health and <strong>health-related services.</strong></li>\n<li>To arrange and <strong>escort pregnant women </strong>and <strong>children</strong> requiring treatment/admission to the nearest pre-identified health facility</li>\n<li>To <strong>inform&nbsp;sub-center/primary health center</strong>&nbsp;about the <strong>births</strong> and <strong>deaths</strong> in her village and any unusual <strong>health problems</strong>/<strong>disease</strong> <strong>outbreaks</strong> in the community</li>\n<li>To <strong>promote</strong> the construction of household toilets under the&nbsp;<strong>total sanitation campaign</strong></li>\n</ul>\n</div>\n</div>\n</div>\n<p>&nbsp;</p>\n<p>Other Options:</p>\n<p>Option A (ANM): An Auxiliary Nurse Midwife (ANM) is a trained health worker who provides basic healthcare services, including antenatal care, delivery, and postnatal care. Although an ANM can provide counseling and information to pregnant women, the primary responsibility for this role lies with the ASHA worker.</p>\n<p>Option B (AWW): An Anganwadi Worker (AWW) is responsible for providing basic health care, nutrition, and preschool education to children under the age of six, pregnant women, and lactating mothers. While AWWs play a vital role in maternal and child health, counseling pregnant women on health-related issues is not their primary responsibility.</p>\n<p>Option C (Trained birth attendant): A trained birth attendant is responsible for assisting with childbirth and providing postpartum care. Although they may provide some counseling and information, this role is primarily focused on the delivery process rather than ongoing counseling throughout pregnancy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 22-year-old female comes to the STI clinic with minimal vaginal discharge. On speculum examination, erosions are seen on the cervix. Which of the following kit should be given to this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Green"
      },
      {
        "id": 2,
        "text": "Red"
      },
      {
        "id": 3,
        "text": "Gray"
      },
      {
        "id": 4,
        "text": "Yellow"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient with vaginal discharge and <strong>erosions on the cervix</strong> has cervicitis from a <strong>sexually transmitted infection</strong>. She should be given the&nbsp;<strong>gray kit</strong> which contains <strong>cefixime </strong>and<strong>&nbsp;azithromycin.</strong>&nbsp;</p>\n<p>Under the STD control program, pre-packed color-coded&nbsp;kits have been provided for free supply to treat sexually transmitted (STI) or reproductive tract infections (RTI).&nbsp;Management of STDs under the&nbsp;<strong>syndromic approach</strong> is based on specific <strong>signs&nbsp;</strong>and&nbsp;<strong>symptoms</strong>&nbsp;and is <strong>not dependent on laboratory investigations.</strong></p>\n<p>A patient with just <strong>vaginal discharge</strong> is presumed to have<strong> vaginitis</strong> and is given a <strong>green kit</strong> that contains <strong>secnidazole</strong> and <strong>fluconazole.&nbsp;</strong>But this patient also has cervical erosion, which is a sign of cervicitis. She should be treated with the grey kit.&nbsp;This kit contains a single tablet of<strong> 1 gram azithromycin</strong> for <strong>chlamydia</strong> and a single tablet of <strong>400 mg cefixime</strong> for <strong>g<span style=\"font-size: 14px;\">onorrhea.</span></strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The years of potential life lost could be attributed to______.",
    "choices": [
      {
        "id": 1,
        "text": "Years lost to morbidity"
      },
      {
        "id": 2,
        "text": "Years lost due to premature death"
      },
      {
        "id": 3,
        "text": "Years lost to disability"
      },
      {
        "id": 4,
        "text": "Years lost to poor quality of life"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The years of potential life lost could be attributed to the&nbsp;<strong>years lost</strong> due to <strong>premature death</strong>.</p>\n<p>It is a <strong>mortality</strong> indicator that shows the <strong>number of years</strong> that a dying person could have <strong>expected to survive&nbsp;</strong>(usually taken as 75 years). Mortality indicators are used as the starting point in the evaluation of health status. They are used as <strong>indirect indicators</strong> of health.</p>\n<p>The concept of years of potential life lost (YPLL) is used to estimate the societal impact of premature death. It helps prioritize public health interventions and allocate resources to address significant health problems. YPLL, along with other metrics like DALYs and QALYs, aids in assessing the burden of disease and the effectiveness of healthcare interventions. These measurements can help inform policymakers and healthcare providers in making informed decisions about healthcare delivery and resource allocation.</p>\n<p>Strategies to reduce YPLL include prevention and early intervention, improving access to healthcare, and addressing social determinants of health that contribute to health disparities and premature death.</p>\n<p>Other options:</p>\n<p>Option A: Years lost to morbidity refers to the time spent living with a disease or disability, which is not directly related to the concept of years of potential life lost.</p>\n<p>Option C: <strong>Years lost to disability</strong> is a component of disability-adjusted life years (<strong>DALY</strong>). DALY indicates the number of years lost due to ill health, disability, or early death.&nbsp;</p>\n<p><strong>DALY = YLL +YLD&nbsp;</strong></p>\n<ul>\n<li><strong>Years lost to disability</strong> (YLD): Here, the number of cases due to injury and illness is multiplied by the average duration of the disease and a weighting factor. (Severity of the disease on a scale of 0 (perfect health) to 1 (dead))</li>\n<li><strong>Years of lost life</strong> (YLL) - Here, the number of deaths at each age is multiplied by the expected remaining years of life. (according to a global standard of life expectancy)</li>\n</ul>\n<p>Option D: <strong>Quality-adjusted life year&nbsp;</strong>(QALY) indicates how the health status of an individual impacts his <strong>quality</strong> and <strong>quantity of life</strong>. It shows the years of life lost due to injury or illness. It is commonly used in evaluating the <strong>outcomes of medical interventions</strong>.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a 10-year-old school child, which of the following vaccines is given as a part of the school immunization program?",
    "choices": [
      {
        "id": 1,
        "text": "Measles vaccine"
      },
      {
        "id": 2,
        "text": "Rotavirus vaccine"
      },
      {
        "id": 3,
        "text": "TT/Td vaccine"
      },
      {
        "id": 4,
        "text": "Hepatitis B vaccine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A ten-year-old school child will be administered the <strong>TT/Td vaccine</strong>, as part of the <strong>school immunization program</strong>,&nbsp;as per the <strong>National Immunization Schedule.</strong></p>\n<p>Tetanus and adult diphtheria (Td) vaccine is a combination of tetanus and diphtheria antigens, with a lower concentration of diphtheria antigen (d), as recommended for older children and adults. The MoHFW recommends the replacement of the TT vaccine with Td vaccine for all age groups, including pregnant women. A dose of 0.5 mL is administered in the intramuscular route in the upper arm.</p>\n<p>Scheduled to be administered at <strong>10 and 16 years of age</strong>.</p>\n<p>For pregnant women:</p>\n<ul>\n<li>Td-1: early in pregnancy</li>\n<li>Td-2: 4 weeks after Td-1</li>\n<li>Td (Booster): if pregnancy occurs within 3 years of the last pregnancy and 2 Td doses were received.</li>\n</ul>\n<p>Other options:</p>\n<p>Option A - According to the National Immunization Schedule,&nbsp;Measles/MR vaccine is given at 9 completed months (1st dose), and a second dose is given at 16-24 months.&nbsp;<strong>Measles</strong>&nbsp;vaccine can be given&nbsp;till <strong>5 years</strong>&nbsp;of age. A dose of 0.5 mL is administered subcutaneously in the right upper arm.</p>\n<p>Option B - Rotavirus vaccines are&nbsp;<strong>oral</strong>,&nbsp;<strong>live attenuated</strong>&nbsp;vaccines&nbsp;and are of 3 types: Rotavac, RotaTeq, and Rotarix.&nbsp;<strong>Rotavac</strong>&nbsp;(monovalent liquid frozen)&nbsp;vaccine is administered in<strong>&nbsp;3 oral doses,</strong>&nbsp;4 weeks apart at 6, 10, and 14&nbsp;weeks.&nbsp;Though CDC guidelines recommend that it should&nbsp;<strong data-stringify-type=\"bold\">not</strong>&nbsp;be administered to children&nbsp;<strong data-stringify-type=\"bold\">more than 8 months</strong>&nbsp;of age, the&nbsp;<strong data-stringify-type=\"bold\">National Immunisation Guidelines</strong>&nbsp;in India mention that the&nbsp;<strong data-stringify-type=\"bold\">first dose</strong>&nbsp;of rotavirus vaccine can be administered up to the age of&nbsp;<strong data-stringify-type=\"bold\">1 year</strong>.</p>\n<p>Option D -&nbsp;<strong>Hepatitis B</strong>&nbsp;vaccine is an example of a&nbsp;<strong>subunit vaccine</strong>&nbsp;made using<strong>&nbsp;HBsAg. </strong>The first dose (0.5 mL, intramuscular) is given at birth or as early as possible&nbsp;within 24 hours on the anterolateral&nbsp;side of mid-thigh. Subsequent doses are given as a part of the pentavalent vaccine at 6 weeks, 10 weeks, and 14 weeks (can be given until one year of age).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is true about cancer treatment according to the Colombo plan?",
    "choices": [
      {
        "id": 1,
        "text": "Help with PET scan units for diagnosis of cancer"
      },
      {
        "id": 2,
        "text": "Human resource strengthening"
      },
      {
        "id": 3,
        "text": "Setting up chemotherapy units"
      },
      {
        "id": 4,
        "text": "Setting up cobalt therapy units"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Aid to set up <strong>cobalt therapy units for cancer treatment</strong>\u00a0at medical institutions in <strong>India</strong> was a part of the <strong>Colombo plan</strong>.</p>\n<p>The Colombo Plan is a regional organization that upholds the concept of a collective intergovernmental\u00a0effort to strengthen\u00a0the economic and social development\u00a0of member countries in\u00a0the Asia-Pacific region.</p>\n<p>It was formed at a meeting of the commonwealth foreign ministers with the <strong>headquarters</strong> at <strong>Colombo in January 1950</strong>. It comprises 20 developing countries within the region and 6 non-regional members - Australia, Canada, Japan, New Zealand, the UK, and USA. It involves\u00a0foreign aid\u00a0and technical assistance for the\u00a0economic and social development\u00a0of the region.</p>\n<p>The contribution of Canada in supplying cobalt therapy units to medical institutions in India was an important item of aid under the Colombo plan. <strong>AIIMS New Delhi</strong> was established with financial assistance from New Zealand <strong>under the Colombo plan</strong>.<strong>\u00a0</strong>Cobalt therapy is a form of radiotherapy that uses cobalt-60, a radioactive isotope, to generate high-energy gamma rays for treating cancer. Cobalt therapy units were an important tool for cancer treatment in the mid-20th century, and their provision under the Colombo plan significantly improved cancer treatment capabilities in India.<br />The Colombo Plan has evolved over the years and now focuses on a broader range of development goals, including education, public administration, agriculture, and industry. This reflects the changing needs of the Asia-Pacific region and the importance of a comprehensive approach to development.</p>\n<p>Other Options:</p>\n<p>Option A (Help with PET scan units for diagnosis of cancer): While PET scan units are important for cancer diagnosis, they were not part of the Colombo plan's cancer treatment initiatives in India.</p>\n<p>Option B (Human resource strengthening): Although the Colombo plan aims to improve the economic and social development of member countries, human resource strengthening in the context of cancer treatment is not explicitly mentioned as part of the plan.</p>\n<p>Option C (Setting up chemotherapy units): The Colombo plan's focus in cancer treatment was on providing aid for cobalt therapy units, not chemotherapy units.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A poor farmer with a history of successive crop failure develops progressive spastic paraparesis, signs of upper motor neuron paralysis, and gait instability. Name the toxin responsible for this condition.",
    "choices": [
      {
        "id": 1,
        "text": "Aflatoxin"
      },
      {
        "id": 2,
        "text": "Beta-oxalyl-amino-alanine"
      },
      {
        "id": 3,
        "text": "Ergot alkaloids"
      },
      {
        "id": 4,
        "text": "Fusarium toxin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The diagnosis based on the given clinical scenario is\u00a0<strong>neurolathyrism,\u00a0</strong>and the toxin responsible for the condition is<strong> beta-oxalyl-amino-alanine.</strong></p>\n<p>Lathyrism is a paralyzing disease of humans and animals.\u00a0It is due to the consumption of\u00a0<strong>Khesari dal/<em>Lathyrus sativus</em>.\u00a0</strong>It is mostly consumed by <strong>agricultural laborers of\u00a0poor economic status\u00a0</strong>because it is relatively cheap<strong>.\u00a0</strong>It is more prevalent in parts of Madhya Pradesh, Uttar Pradesh, Odisha, and Bihar.</p>\n<p>In<strong>\u00a0humans</strong>, it is referred to as\u00a0<strong>neurolathyrism</strong>\u00a0because it\u00a0affects the <strong>nervous</strong> system. It is\u00a0characterized by gradually developing <strong>spastic\u00a0paralysis</strong> of the <strong>lower limbs</strong>. In\u00a0<strong>animals</strong>, it is referred to as\u00a0<strong>osteolathyrism</strong>\u00a0as it leads to skeletal deformities.\u00a0It usually affects\u00a0<strong>young males</strong>\u00a0aged\u00a0<strong>15-45 years</strong>\u00a0and it is manifested in stages:\u00a0</p>\n<ul>\n<li>Latent stage</li>\n<li>No-stick stage</li>\n<li>One-stick stage</li>\n<li>Two-stick stage</li>\n<li>Crawler stage</li>\n</ul>\n<p><strong>Beta-oxalyl-amino-alanine (BOAA)</strong>\u00a0is the toxic compound causing\u00a0<strong>lathyrism.\u00a0</strong>The water-soluble property of the toxin is used in\u00a0removing it from the pulses by\u00a0<strong>soaking\u00a0it in hot water</strong>\u00a0and <strong>rejecting</strong> the soaked <strong>water</strong>.\u00a0<strong>Vitamin C</strong>\u00a0in doses of 500-1000 mg can be used for the <strong>prevention</strong> and <strong>treatment</strong> of lathyrism.</p>\n<p>Other options:</p>\n<p>Option A:\u00a0<strong>Aflatoxins</strong> are produced by certain fungi, such as <em><strong>Aspergillus flavus</strong></em> and <em><strong>Aspergillus parasiticus</strong>,<strong>\u00a0</strong></em>are the most potent <strong>hepatotoxins</strong>.\u00a0These fungi can contaminate food grains such as groundnut, maize, parboiled rice, sorghum, wheat, and tapioca. It is mainly due to <strong>improper storage</strong>. It can be prevented by proper storage after drying. Moisture content should be kept below 10%.\u00a0They do not cause the neurological symptoms described in the question.</p>\n<div class=\"page\" title=\"Page 710\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Option B:<strong> Ergot alkaloids </strong>are produced by<strong> ergot or\u00a0<em>Claviceps purpurea,</em></strong>\u00a0a field fungus. Food grains like\u00a0<strong>bajra, rye, sorghum,\u00a0</strong>and<strong>\u00a0wheat</strong>\u00a0have a tendency to get contaminated with this ergot fungus. These get harvested along with the food grains and consumption of this ergot-infested grain leads to\u00a0<strong>ergotism</strong>.\u00a0\u00a0</p>\n<p>Acute cases present with\u00a0<strong>nausea, vomiting, giddiness</strong>, and\u00a0<strong>drowsiness</strong>\u00a0for a period of up to 24 to 48 hours after the ingestion of ergot grain. In cases of <strong>chronic</strong> consumption, they present with <strong>painful cramps</strong> in limbs, and peripheral gangrene due to vasoconstriction of capillaries. However, they do not cause the progressive spastic paraparesis and upper motor neuron paralysis characteristic of neurolathyrism. Ergot-infested grains are removed by <strong>floating</strong> them in <strong>20% saltwater</strong>. Handpicking can also be done.</p>\n<p>Option D:\u00a0<strong>Fusarium toxin</strong> is produced by the fungus <em><strong>Fusarium\u00a0incarnatum.</strong></em>\u00a0They are known to contaminate <strong>sorghum</strong> and <strong>rice</strong>.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young male came to the hospital with a clean-cut wound without any bleeding. The patient received a full course of tetanus vaccination 10 years ago. What is the best management for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Human tetanus immunoglobulin and full course of vaccine"
      },
      {
        "id": 2,
        "text": "Human tetanus immunoglobulin only"
      },
      {
        "id": 3,
        "text": "Single-dose tetanus toxoid"
      },
      {
        "id": 4,
        "text": "Full course tetanus toxoid"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The patient with a <strong>clean-cut</strong> wound <strong>without</strong> any <strong>bleeding</strong>, who received a full course of tetanus vaccination <strong>10 years ago,</strong> should be given a <strong>single dose</strong> of <strong>tetanus toxoid vaccine</strong> and appropriate <strong>wound care</strong>.</p>\n<p>Wound management involves cleaning the wound&nbsp;thoroughly to remove soil, foreign bodies, and&nbsp;necrotic tissue.</p>\n<p>Note: In cases where combined immunization is necessary, the patient is given&nbsp;250 units of human tetanus immunoglobulin in one arm and&nbsp;0.5 mL of adsorbed tetanus toxoid (PTAP or APT) in the other arm or gluteal region. The <strong>antitoxin</strong> is given for immediate <strong>temporary</strong> protection, and the <strong>tetanus toxoid</strong> is given for <strong>long-lasting</strong> protection.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "How is water collected for bacteriological examination during a disease outbreak?",
    "choices": [
      {
        "id": 1,
        "text": "Collect water from already leaking taps"
      },
      {
        "id": 2,
        "text": "Before collecting, let water flow for at least 1 minute"
      },
      {
        "id": 3,
        "text": "Water sample container is kept close to the tap avoid spillage"
      },
      {
        "id": 4,
        "text": "Collect from a gentle stream of water to avoid splashing"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>During a disease outbreak, for collection of a water sample for&nbsp;bacteriological examination from a tap in <strong>regular use</strong>, water is <strong>collected from a gentle stream of water to avoid splashing.</strong>&nbsp;</p>\n<p>If water samples are to be collected from a tap <strong>that is not regularly used</strong>, they should be first sterilized by <strong>heating</strong>. Then, the tap is cooled and opened fully and the initial water stream is let out to flow before the sample is collected.&nbsp;</p>\n<p>The sample bottle must be held <strong>near the base</strong> with a hand and the stopper and paper cover over it are removed together and held in the fingers.</p>\n<p>Other options:</p>\n<p>Option A (Collect water from already leaking taps): Collecting water from leaking taps is not recommended as it increases the risk of contamination and may not provide an accurate representation of water quality.</p>\n<p>Option B (Before collecting, let water flow for at least 1 minute): This option is close to the correct answer but falls short, as it is recommended to let the water flow for at least two minutes to flush out stagnant water in the pipe.</p>\n<p>Option C (Water sample container is kept close to the tap to avoid spillage): While keeping the sample container close to the tap is a good practice to avoid spillage, it is not the main concern during the collection of water samples for bacteriological examination.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The average daily dietary nutrient intake level sufficient to meet the nutrient requirements of nearly all (97-98%) healthy individuals in a particular life stage and gender group is known as _____.",
    "choices": [
      {
        "id": 1,
        "text": "Adequate intake"
      },
      {
        "id": 2,
        "text": "Dietary goal"
      },
      {
        "id": 3,
        "text": "Estimated average requirement"
      },
      {
        "id": 4,
        "text": "Recommended dietary allowance"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>average daily dietary nutrient intake level</strong> sufficient to meet the nutrient requirements of <strong>nearly all healthy individuals</strong> in a particular life stage and gender group is known as <strong>recommended dietary allowance (RDA).&nbsp;</strong></p>\n<p>Recommended dietary allowances (<strong>RDAs</strong>) are developed by the Food and Nutrition Board of the Institute of Medicine, National Academy of Sciences, and are part of the <strong>Dietary Reference Intakes</strong> (DRIs). DRIs include not only RDAs but also adequate intakes (AIs), tolerable upper intake levels (ULs), and estimated average requirements (EARs).</p>\n<p>RDAs are <strong>essential for planning and assessing diets</strong> for healthy individuals and serve as the <strong>basis for food labeling, nutrition policy, and dietary guidelines</strong>. Meeting the RDA for a specific nutrient helps ensure that an individual's nutrient intake is <strong>sufficient to prevent deficiency and maintain optimal health</strong>. However, individual nutrient needs may vary depending on factors such as age, gender, health status, and activity level.</p>\n<p>Other options</p>\n<p>Option A: <strong>Adequate intake</strong> is the recommended average daily intake level which is based on experimentally found estimates of nutrient intake by a group of apparently healthy population (assumed to be adequate). It is&nbsp;used when RDA cannot be determined. It is referred to as acceptable intake in the indian context.</p>\n<p>Option B: <strong>Dietary goals</strong> are country-specific quantitative targets for selected nutrients aimed at preventing long-term chronic diseases. They are not directly focused on meeting the nutrient requirements of individuals but rather focus on population-level nutritional health.</p>\n<p>Option C:&nbsp;The estimated average requirement (EAR) is the daily nutrient intake level estimated to meet the requirements of half the healthy individuals in a specific life stage and gender group. It is used to calculate the RDA but is not the same as the RDA.</p>\n<p>The RDA is calculated as the estimated average requirement (EAR) plus twice the standard deviation (SD).</p>\n<p><em>RDA = EAR + (2 &times; SD)</em></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A boys' hostel has an outbreak of fever cases with headache, followed by the development of pleomorphic rashes sparing palms and soles. What is the next best step in the management of suspected cases?",
    "choices": [
      {
        "id": 1,
        "text": "Isolate for 6 days after giving acyclovir, followed by VZIG within 72 hours of exposure"
      },
      {
        "id": 2,
        "text": "Isolate for 12 days after giving acyclovir, followed by VZIG within 48 hours of exposure"
      },
      {
        "id": 3,
        "text": "Isolate for 6 days"
      },
      {
        "id": 4,
        "text": "Only give VZIG"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The scenario describes an outbreak of fever cases with headache followed by the development of pleomorphic rashes sparing palms and soles, which points to the diagnosis of <strong>chickenpox</strong>. In a boys' hostel, it is reasonable to assume that the <strong>majority</strong> of the affected individuals are <strong>not in the high-risk groups</strong> <strong>for severe varicella infection</strong>. For the management of suspected cases in this situation, <strong>isolation for 6 days from the onset of the rash</strong> is the appropriate measure to prevent further spread of the infection. <strong>Acyclovir and VZIG</strong> are <strong>not necessary for healthy individuals.</strong></p>\n<p>Varicella zoster immunoglobulin (VZIG) is not indicated for everyone. <strong>VZIG is a passive immunization</strong> used as post-exposure prophylaxis <strong>for individuals at high risk</strong> of developing severe varicella (chickenpox) infection after being exposed to the varicella-zoster virus. It should be <strong>administered within 72 hours</strong> of exposure to provide the best protection, although it may still be effective if given up to 10 days after exposure.</p>\n<p><strong>High-risk individuals</strong> who may benefit from VZIG include</p>\n<ol>\n<li><strong>Immunocompromised</strong> individuals, such as those receiving immunosuppressive therapy, those with congenital cellular immunodeficiency, and those with acquired immunodeficiency, including HIV/AIDS.</li>\n<li><strong>Pregnant women</strong> who have been exposed to the virus and have no history of chickenpox or vaccination, as varicella infection during pregnancy can lead to congenital varicella syndrome or severe neonatal varicella infection.</li>\n<li><strong>Newborns</strong> <strong>whose mothers developed chickenpox within five days before delivery</strong> or within 48 hours after delivery, as they are at risk of severe neonatal varicella infection.</li>\n</ol>\n<p>For healthy individuals who have been exposed to the varicella-zoster virus, the varicella vaccine is usually recommended as post-exposure prophylaxis, rather than VZIG. The vaccine should be administered within 3 to 5 days of exposure to help prevent or reduce the severity of the disease.</p>\n<p><strong>Live attenuated vaccine</strong> is administered to children who have not had chickenpox between the age of <strong>12 to 18 months</strong>.</p>\n<p>The below image shows multiple&nbsp;<strong>vesicular</strong>&nbsp;lesions on the&nbsp;<strong>trunk</strong>&nbsp;is suggestive of&nbsp;<strong>chickenpox.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e7c9c50b49604c2e9a4e965cee4a00f0x720x540.JPEG"
    ]
  },
  {
    "text": "Which of the following is the sensitive indicator to assess the availability, utilization, and effectiveness of healthcare in a community?",
    "choices": [
      {
        "id": 1,
        "text": "Infant mortality rate"
      },
      {
        "id": 2,
        "text": "Maternal mortality rate"
      },
      {
        "id": 3,
        "text": "Immunization coverage"
      },
      {
        "id": 4,
        "text": "Disability-adjusted life years"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Other options:</p>\n<p>Option B - Maternal mortality rate: While maternal mortality rate is an important indicator of maternal healthcare services, it is not as sensitive as the infant mortality rate in reflecting the availability, utilization, and effectiveness of healthcare in a community.</p>\n<p>Option C - Immunization coverage: Immunization coverage is an essential factor in preventing diseases and promoting public health. However, it is a narrower indicator than infant mortality rate, focusing primarily on preventive healthcare services for children.\u00a0Full immunization coverage is defined as the proportion of infants 9-11 months old who have received the 3 doses of DPT vaccine,\u00a0BCG vaccine, 3 doses of OPV, and one dose of measles vaccine against the estimated number of infants during a specific year.</p>\n<p>Option D - Disability-adjusted life years: DALYs are a useful measure of the overall burden of disease in a population, but they are less sensitive in assessing the availability, utilization, and effectiveness of healthcare services in a community compared to infant mortality rate.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '102 Community Medicine Neet 2023';
        let hierarchy = ["Marrow", "PYQs", "Community Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>