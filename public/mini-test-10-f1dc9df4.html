<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 10 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 56 year old male patient has been on an antipsychotic for the last 2 years. He presents with stereotypical, repetitive and involuntary tic like movements of the face, eyelid spasm, and slow twisting movements of the tongue. Diagnose and identify the proposed mechanism of action of the condition.",
    "choices": [
      {
        "id": 1,
        "text": "Dystonia- dopamine receptor antagonism"
      },
      {
        "id": 2,
        "text": "Tardive dyskinesia- dopamine receptor supersensitivity"
      },
      {
        "id": 3,
        "text": "Dystonia- dopamine receptor supersensitivity"
      },
      {
        "id": 4,
        "text": "Tardive dyskinesia- dopamine receptor antagonism"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The diagnosis is <strong>tardive dyskinesia</strong> and the <strong>proposed</strong> mechanism of action is <strong>dopamine receptor supersensitivity</strong>.</p>\n<p>Tardive dyskinesia is an <strong>extrapyramidal side effect </strong>(EPSE) of antipsychotic drugs that present after long-term usage. It usually presents after <strong>months to years</strong> of drug usage. It is more common in the <strong>elderly population</strong>. It is characterized by <strong>orofacial involvement</strong>. Stereotypical involuntary, repetitive tic-like movements of the face, eyelid spasm, and slow twisting movements of the tongue are the presenting symptoms. The movements <strong>disappear during sleep</strong> and may <strong>vary in intensity</strong> with relation to the degree of <strong>emotional distress</strong>.</p>\n<p>The proposed<strong> mechanism </strong>of action is<strong> dopamine postsynaptic receptor supersensitivity </strong>leading to increased nigrostriatal dopaminergic activity.&nbsp;Management&nbsp;of tardive dyskinesia-</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">FDA-approved<strong> VMAT2 inhibitors</strong>&nbsp;-&nbsp;<strong>valbenazine</strong> and <strong>deutetrabenazine</strong> are used as drugs for treatment.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Anticholinergics</strong>&nbsp;are contraindicated as they <strong>worsen the symptoms.</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Switching&nbsp;</strong>patients to <strong>clozapine&nbsp;</strong>can be effective</li>\n</ul>\n<p>Note:</p>\n<p><strong>Dystonia</strong> - The characteristic symptoms for diagnosis of dystonia are <strong>a</strong><strong>cute</strong> onset within <strong>1-5 days</strong> of starting treatment. It is more common in the <strong>younger</strong> population. The proposed mechanism of action is <strong>D2 blockade</strong> in the <strong>nigrostriatal pathway. </strong>There is typical involvement of <strong>head and neck</strong>&nbsp;muscles and presents in a variety of forms, such as <strong>torticollis</strong>, <strong>trismus</strong>, <strong>&ldquo;mouth opening&rdquo;</strong> dystonia, <strong>grimacing</strong>, <strong>dysarthria,</strong> <strong>oculogyric crisis,</strong> <strong>blepharospasm</strong>, and <strong>swallowing difficulties</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child was brought to the clinic for evaluation of recurrent urinary tract infections. An intravenous urogram was obtained, as shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Duplicated collecting system"
      },
      {
        "id": 2,
        "text": "Ureterocele"
      },
      {
        "id": 3,
        "text": "Autosomal recessive polycystic kidney disease"
      },
      {
        "id": 4,
        "text": "Horseshoe kidney"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above clinical scenario and the intravenous urogram showing the <strong>drooping lily sign</strong> suggest the presence of a <strong>duplicated collecting system</strong>.</p>\n<p>In a duplicated collecting system often, the ureter that supplies the upper half of the kidney becomes obstructed. Suppose the upper pole collecting system of the kidney is completely obstructed. In that case, only the normally draining lower pole collecting system is visualized on the <strong>intravenous urogram</strong> and looks like a <strong>drooping lily</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/627ea2080eb44124b659053532130fe7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/08f87dc6251b4560aa4d195399680284x1280x912.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dff6af70f8514f4684bef0404f80a2e9x1280x2007.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ebc2091aebe344efbe5346ac1e1c89a4x516x630.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bdd7ecd8523a4bca9b034199f6899e21x876x821.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3517c78d64a347f6b3f97b2609c503c3x720x609.JPEG"
    ]
  },
  {
    "text": "Identify the brace given below and its use.",
    "choices": [
      {
        "id": 1,
        "text": "Milwaukee brace, Scoliosis"
      },
      {
        "id": 2,
        "text": "Anterior spinal hyperextension brace, Dorso-lumbar injury"
      },
      {
        "id": 3,
        "text": "Taylor brace, Dorso-lumbar injury"
      },
      {
        "id": 4,
        "text": "Sterno-occipital mandibular immobilization brace, cervical spine injury"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given image shows<strong> a sterno-occipital mandibular immobilization</strong> (SOMI) <strong>brace</strong>\u00a0which is used for <strong>cervical spine injuries.</strong></p>\n<p>The SOMI brace contains a <strong>rigid anterior chest piece</strong> connected to rigid shoulder<strong> </strong>supports by straps across the patient\u2019s back. The <strong>mandibular support</strong> can be removed during eating. The brace provides <strong>good restriction</strong> to <strong>flexion</strong>.</p>\n<p>It is indicated in\u00a0relatively stable injuries to the <strong>lower cervical spine</strong>,\u00a0postoperatively for patients with questionable fixation, or in the treatment of <strong>cervicothoracic injuries</strong>.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5bcba00c32e3491f9644619e4678a5dc.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ef2fa45f06844fdae2e8ea71f1c06dex1280x3139.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fcb707c7b60543b4a882f5427d554f24x330x339.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7e4971332d9d445b849075144447c763x1279x1865.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/519420d3dacd4fb4baa4a166bb674c35x1279x1262.JPEG"
    ]
  },
  {
    "text": "A 6-month-old child is brought to the clinic with a common cold and the parents give a  history of stridor, dyspnea, and intercostal retractions shortly after birth. On examination, you notice that he has biphasic stridor.   What is the most probable etiology of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Laryngomalacia"
      },
      {
        "id": 2,
        "text": "Croup"
      },
      {
        "id": 3,
        "text": "Bilateral vocal cord paralysis"
      },
      {
        "id": 4,
        "text": "Congenital subglottic stenosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The\u00a0finding of biphasic stridor in this scenario is highly suggestive of <strong>congenital subglottic stenosis</strong>.</p>\n<p>Subglottic stenosis is a congenital or acquired condition characterized by a narrowing of the upper airway extending from just below the vocal folds to the lower border of the cricoid cartilage.\u00a0</p>\n<p><strong>Congenital subglottic stenosis</strong> is the most common cause of <strong>biphasic stridor</strong> in children. The subglottis is the narrowest part of the upper airway in a child. The symptoms of congenital subglottic stenosis usually present shortly after birth and include <strong>biphasic stridor</strong>, <strong>dyspnea</strong>, and suprasternal, intercostal, and diaphragmatic retractions. In this child, edema, and secretions caused by the common cold further narrow the subglottic region, leading to the symptoms.\u00a0 Abnormal cry, aphonia, or hoarseness occur when the vocal cords are affected. In <strong>acquired subglottic stenosis</strong>, there is a history of laryngeal insult or prior intubation and symptoms appear 3-4 weeks after the same.</p>\n<p>Diagnosis is made by airway radiographs and confirmed by direct laryngoscopy. The percentage of stenosis is determined and graded using the <strong>Myer Cotton system</strong> from grades I through grade IV, indicating the severity.</p>\n<p>Management includes dilatation and endoscopic laser surgery for grades 1 and 2 subglottic stenosis, and laryngotracheal reconstruction with cartilage graft augmentation in grades III and IV subglottic stenosis.\u00a0<strong>Mitomycin C</strong> is used in the management of subglottic stenosis post-operatively, in order to prevent re-stenosis.</p>\n<p>Other options:</p>\n<p>Option A- <strong>Laryngomalacia</strong> is the most common congenital anomaly causing stridor in a child. which typically presents with low-pitched, <strong>inspiratory stridor</strong> which is exacerbated by crying and agitation.</p>\n<p>Option C- <strong>Croup</strong> is caused by the <strong>parainfluenza</strong> virus, and typically presents with symptoms of fever, barking cough, <strong>inspiratory stridor</strong>, and hoarseness of voice. In severe cases, the child might develop respiratory distress with hypoxia and cyanosis.</p>\n<p>Option D- <strong>Bilateral</strong> <strong>vocal cord paralysis</strong> can also cause stridor in infants and children. Congenital central nervous system lesions such as Chiari malformations and myelomeningoceles can cause bilateral vocal cord paralysis which leads to respiratory distress, high-pitched<strong> inspiratory stridor</strong>, and a weak cry.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74b4c98abb59427c8564c3236d75b224x1280x1826.JPEG"
    ]
  },
  {
    "text": "A 25-year-old patient is brought to the psychiatrist by his mother. She describes him as a strict follower of a rigid schedule every day. He redoes his assignments until they appear perfect to him. He gets annoyed if his schedule is disrupted. The patient bluntly states that he is not doing anything wrong and that his mother is inefficient.  He is unable to complete tasks in time as he strives for perfection. Which of the following is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Obsessive compulsive personality disorder"
      },
      {
        "id": 2,
        "text": "Obsessive compulsive disorder"
      },
      {
        "id": 3,
        "text": "Narcissistic personality trait"
      },
      {
        "id": 4,
        "text": "Schizotypal personality trait"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Rigid&nbsp;</strong>and <strong>perfectionistic</strong>&nbsp;behaviour<strong>&nbsp;</strong>suggests <strong>obsessive-compulsive&nbsp;personality disorder.</strong></p>\n<p>Patients with <strong>obsessive-compulsive&nbsp;personality disorder</strong>&nbsp;often have an obsession with rules,&nbsp;details, regulations, neatness, orderliness, and the achievement of perfection.&nbsp;They can work for long periods provided it is routinized as they generally&nbsp;<strong>lack flexibility</strong> and are<strong> intolerant</strong>. They have <strong>limited interpersonal skills</strong> and are <strong>formal</strong> and serious and often<strong> lack a sense of humor</strong>. They however try to please those they consider superior to them and carry out their orders in an <strong>authoritarian</strong> manner. Additionally, they are<strong> indecisive</strong> as they fear making mistakes.</p>\n<p>Differential diagnosis - outpatients with <strong>minor obsessive-compulsive personality</strong> <strong>traits</strong> are <strong>not occupationally or functionally impaired.</strong></p>\n<p>Other options:</p>\n<p>Option B - <strong>Obsessive-compulsive disorder</strong>&nbsp;unlike&nbsp;obsessive-compulsive&nbsp;personality disorder is associated with obsessions that control the patient's actions. Also, it is associated with recurrent obsessions and compulsions.</p>\n<p>Option C - <strong>Narcissistic</strong> personality trait is characterized by an <strong>increased</strong> sense of <strong>self-importance</strong>,&nbsp;<strong>grandiosity,</strong> and <strong>lack of empathy.</strong></p>\n<p>Option D - <strong>Schizotypal</strong> personality trait is characterized by <strong>eccentric </strong>&amp; <strong>odd thoughts</strong>, perceptions &amp; behavior, <strong>magical thinking</strong>, ideas of reference, illusions, and peculiar notions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A mother who is a hairstylist has noted that her baby's hair looks dull, breaks off easily, and is tufted. She brings the child to you and informs you about the past history of seizures. Investigations reveal elevated plasma ammonia levels and argininosuccinate levels. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Argininemia"
      },
      {
        "id": 2,
        "text": "Argininosuccinic aciduria"
      },
      {
        "id": 3,
        "text": "Hyperammonemia type 1"
      },
      {
        "id": 4,
        "text": "Hyperammonemia type 2"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely diagnosis is <strong>argininosuccinic aciduria</strong> due to <strong>argininosuccinate lyase</strong> deficiency.</p>\n<p>It is accompanied by high levels of argininosuccinate levels in blood, CSF, and urine. It is also associated with friable, tufted hair known as <strong>trichorrhexis nodosa.</strong></p>\n<p>Image showing Trichorrhexis nodosa:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dc7d409a3d8b4a09bbd932eed8f68b73x444x483.JPEG"
    ]
  },
  {
    "text": "The muscle marked as X in the image gets its nerve supply from____.",
    "choices": [
      {
        "id": 1,
        "text": "Radial nerve"
      },
      {
        "id": 2,
        "text": "Median nerve"
      },
      {
        "id": 3,
        "text": "Ulnar nerve"
      },
      {
        "id": 4,
        "text": "Posterior interosseous nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>short triangular muscle</strong> marked in the <strong>posterior part of the elbow joint</strong> is the <strong>anconeus</strong>, it receives its nerve supply from the <strong>radial nerve.</strong></p>\n<p>It arises from the posterior surface of the lateral epicondyle of the humerus and inserts to the lateral aspect of the olecranon and the proximal quarter of the posterior surface of the shaft of the ulna.\u00a0The anconeus is an <strong>extensor of the elbow</strong>.</p>\n<p>It receives its vascular supply by branches of the posterior interosseous recurrent artery. Nerve supply is from radial nerve (<strong>C6, 7, and 8)</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/21b0dfe1dd144fdd880acc136b1fc19b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ccf3983f3a9412db94b365bad66a425x1280x1850.JPEG"
    ]
  },
  {
    "text": "Identify the clinical features expected in the karyotyping given below.",
    "choices": [
      {
        "id": 1,
        "text": "Streak ovaries and  peripheral edema"
      },
      {
        "id": 2,
        "text": "Epicanthic fold and endocardial cushion defects"
      },
      {
        "id": 3,
        "text": "Eunuchoid body habitus with abnormally long legs"
      },
      {
        "id": 4,
        "text": "Rocker bottom feet and umbilical hernia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given karyotyping image shows<strong>&nbsp;&ldquo;45 XO&rdquo;</strong> abnormality, which is seen in <strong>Turner's</strong> <strong>syndrome</strong>. <strong>Streak ovaries</strong> and<strong> peripheral edema</strong> are clinical features of Turner's syndrome.</p>\n<p>Other clinical features of Turner's syndrome include <strong>short stature</strong>, low posterior hairline, broad chest, widely spaced nipples, coarctation of the aorta, bicuspid aortic valve, cubitus valgus, and pigmented nevi.</p>\n<p>Turner's syndrome is the most common sex chromosome abnormality in females. The classical karyotype is <strong>45, X</strong>. Other variants have structural abnormalities of X chromosomes or mosaic patterns.</p>\n<p>Some patients may present during infancy. They mainly present with <strong>edema</strong> of the dorsum of the hand and foot due to<strong> lymphatic stasis.</strong> The most important cause of increased mortality in children with Turner's syndrome is cardiac abnormalities.&nbsp;</p>\n<p>Turner's syndrome is a common cause of <strong>primary amenorrhea</strong>. During embryogenesis, fetal ovaries develop normally and the absence of a second X chromosome leads to accelerated loss of normally formed oocytes. This gets completed by the age of 2. The ovaries are reduced to atrophic fibrous bands without ova and follicles. These are called <strong>s</strong><strong>treak ovaries</strong>.</p>\n<p>At puberty, they fail to develop secondary sexual characteristics.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4ec1ea3472e44ed49aa02ead2de1207d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f94250f7aff04efa976e3a2f91053f76x1280x1769.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2def8a08088c4fe1bf98709d5e0e8c44x310x334.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7e74fac27b9f44a39eb904fc15ceaf1bx320x340.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dbf411239a824ab48d8d3455c94bdcf5x480x284.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1650534e27e34b0ebad1c8bff46a62d6x714x418.JPEG"
    ]
  },
  {
    "text": "Match the following cases with their respective sections associated:",
    "choices": [
      {
        "id": 1,
        "text": "1-c, 2-d, 3-a, 4-b"
      },
      {
        "id": 2,
        "text": "1-d, 2-c, 3-a, 4-b"
      },
      {
        "id": 3,
        "text": "1-c, 2-d, 3-b, 4-a"
      },
      {
        "id": 4,
        "text": "1-d, 2-c, 3-b, 4-a"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correct match is</p>\n<table style=\"height: 169px; width: 502.664px;\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 234px; height: 18px;\">Case</td>\n<td style=\"width: 89px; height: 18px;\">Section</td>\n<td style=\"width: 303.664px; height: 18px;\">&nbsp;Description</td>\n</tr>\n<tr style=\"height: 69px;\">\n<td style=\"width: 234px; height: 69px;\">1. A doctor administers blood without cross-checking the blood bag, causing the death of the patient.</td>\n<td style=\"width: 89px; height: 69px;\">c. 304A IPC</td>\n<td style=\"width: 303.664px; height: 69px;\">S. <strong>304-A</strong>, I.P.C. Causing death by<strong> negligence</strong>: \"Whoever causes the death of any person, by doing any rash or negligent act not amounting to culpable homicide shall be punished with imprisonment for a term which may extend to two years &middot;or with fine, or with both.</td>\n</tr>\n<tr style=\"height: 95px;\">\n<td style=\"width: 234px; height: 95px;\">2. A married woman bought dead with 3rd-degree burns on her body, with a history of harassment by the husband in demand of money.</td>\n<td style=\"width: 89px; height: 95px;\">d. 304B IPC</td>\n<td style=\"width: 303.664px; height: 95px;\">S. <strong>304-B</strong>., I.P.C. (<strong>Dowry Death</strong>): (1) Where the death of a woman is caused by any<strong> burn or bodily injury</strong> or occurs otherwise than under normal circumstances<strong> within seven years </strong>of her<strong> marriage</strong> and it is shown that soon before her death she was subjected to <strong>cruelty</strong> or<strong> harassment</strong> by her husband or any relative of her husband for, or in connection with, any demand for dowry, such death shall be called \"dowry death\", and such husband or relative shall be deemed to have caused her death. (2) Whoever commits dowry death shall be punished with imprisonment of not less than <strong>ten years</strong>, but which may extend to life imprisonment.&nbsp;</td>\n</tr>\n<tr style=\"height: 48px;\">\n<td style=\"width: 234px; height: 48px;\">3. A person murders his cousin due to a property dispute.</td>\n<td style=\"width: 89px; height: 48px;\">a. 302 IPC</td>\n<td style=\"width: 303.664px; height: 48px;\">S. <strong>302</strong>, I.P.C.: Punishment for <strong>murder</strong>: death, or imprisonment for life, and also fine.&nbsp;</td>\n</tr>\n<tr style=\"height: 64px;\">\n<td style=\"width: 234px; height: 64px;\">4. A life convict out on bail commits the murder of his neighbor</td>\n<td style=\"width: 89px; height: 64px;\">b. 303 IPC</td>\n<td style=\"width: 303.664px; height: 64px;\">&nbsp;S. <strong>303</strong>, I.P.C.: Punishment for murder <strong>by life convict</strong> (death).</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>IPC sections related to the death of a person:</p>\n<table style=\"width: 337.466px;\">\n<tbody>\n<tr>\n<td style=\"width: 67px; text-align: center;\"><strong>IPC section</strong></td>\n<td style=\"width: 260.466px; text-align: center;\"><strong>Section it deals with</strong></td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\">299</td>\n<td style=\"width: 260.466px; text-align: center;\">Culpable homicide</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\">300</td>\n<td style=\"width: 260.466px; text-align: center;\">Murder (culpable homicide not amounting to murder is also explained under this section)</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\">301</td>\n<td style=\"width: 260.466px; text-align: center;\">Culpable homicide by causing death of person other than person whose death was intended</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\"><strong>302</strong></td>\n<td style=\"width: 260.466px; text-align: center;\">Punishment for murder</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\"><strong>303</strong></td>\n<td style=\"width: 260.466px; text-align: center;\">Punishment for murder by life convict (compulsory death sentence)</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\">304</td>\n<td style=\"width: 260.466px; text-align: center;\">Punishment for culpable homicide not amounting to murder</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\"><strong>304A</strong></td>\n<td style=\"width: 260.466px; text-align: center;\">Causing death by negligence</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\"><strong>304B</strong></td>\n<td style=\"width: 260.466px; text-align: center;\">Dowry death</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\">305</td>\n<td style=\"width: 260.466px; text-align: center;\">Abetment of suicide of child or insane person</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\">306</td>\n<td style=\"width: 260.466px; text-align: center;\">Abetment of suicide.&mdash;If any person commits suicide, whoever abets the commission of such suicide, shall be punished with imprisonment of either description for a term which may extend to ten years, and shall also be liable to fine.</td>\n</tr>\n<tr>\n<td style=\"width: 67px; text-align: center;\">307</td>\n<td style=\"width: 260.466px; text-align: center;\">Attempt to Murder</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 54-year-old male patient with diabetic neuropathy, on examination, was found to have a loss of sensation to tap and vibration at low frequency (20 Hz). But he has an intact vibration sense at a higher frequency (200 Hz). Which of the following somatosensory receptors is most likely to be affected?",
    "choices": [
      {
        "id": 1,
        "text": "Pacinian corpuscles"
      },
      {
        "id": 2,
        "text": "Ruffini corpuscles"
      },
      {
        "id": 3,
        "text": "Meissner corpuscles"
      },
      {
        "id": 4,
        "text": "Merkel cells"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Sensations of tap and low-frequency vibration (flutter, 5-40 Hz)</strong>\u00a0are\u00a0sensed by the Meissner's corpuscles. Hence, a loss of sensation of tap and flutter is most likely due to the disease affecting the\u00a0<strong>Meissner's corpuscles.</strong>\u00a0</p>\n<p><strong>Cutaneous mechanoreceptors:\u00a0</strong>There are four types of mechanoreceptors for sensing touch and pressure. They include:</p>\n<ul>\n<li>Meissner corpuscles</li>\n<li>Merkel cells</li>\n<li>Ruffini corpuscles</li>\n<li>Pacinian corpuscles\u00a0</li>\n</ul>\n<div class=\"page\" title=\"Page 169\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Meissner corpuscles</strong> are dendrites encapsulated in the connective tissue beneath the epidermis of glabrous (non-hairy) skin. They respond to <strong>tap</strong> and <strong>flutter</strong> (low-frequency vibration - 5-40Hz). They are rapidly adapting receptors.</p>\n<p><strong>Merkel cells</strong> are expanded dendritic endings in the epidermis of glabrous (non-hairy)\u00a0skin. They respond to <strong>sustained pressure</strong> and <strong>touch</strong>. They are slowly adapting receptors.</p>\n<p><strong>Ruffini's corpuscles</strong> are enlarged dendritic endings with elongated capsules in the dermis of glabrous and hairy skin. They respond to <strong>stretch</strong> and <strong>fluttering vibrations. </strong>They are slowly adapting receptors.</p>\n<p><strong>Pacinian corpuscles</strong>\u00a0are the <strong>largest</strong> cutaneous mechanoreceptor, measuring about 2mm in length and 1mm in diameter.\u00a0They are present in the dermis of <strong>glabrous</strong> (non-hairy) and <strong>hairy skin.\u00a0</strong>A Pacinian corpuscle consists of a nerve ending encapsulated by concentric layers of connective tissue, giving it an <strong>onion-like appearance.\u00a0</strong>They respond to <strong>fast vibration</strong> (60-500Hz) and <strong>deep pressure.\u00a0</strong>They are rapidly adapting receptors.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 28-year-old woman conceived while she was on treatment for bipolar disorder and severe acne. Her baby was born at term with features including microtia, micrognathia, ventriculomegaly,  conotruncal heart defects, and thymic aplasia. Which of the following drugs is responsible for these defects?",
    "choices": [
      {
        "id": 1,
        "text": "Isotretinoin"
      },
      {
        "id": 2,
        "text": "Lithium"
      },
      {
        "id": 3,
        "text": "Valproic acid"
      },
      {
        "id": 4,
        "text": "Tetracyclines"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Isotretinoin</strong> is the teratogen that is responsible for the above-mentioned defects.</p>\n<p>It is a <strong>vitamin A derivative</strong> that is <strong>highly teratogenic</strong> when orally administered. It is commonly used to treat cystic nodular acne. It inhibits the migration of neural crest cells during embryogenesis and affects the development of multiple organs. These defects are collectively termed <strong>retinoic acid embryopathy.</strong></p>\n<p>Specific anomalies may include <strong>ventriculomegaly</strong>, <strong>maldevelopment </strong>of<strong> the facial bones</strong> or <strong>cranium</strong>, microtia or anotia, micrognathia, cleft palate, <strong>conotruncal heart defects</strong>, and thymic aplasia or hypoplasia.</p>\n<p>Isotretinoin also <strong>increases </strong>the<strong> risk of spontaneous abortions </strong>and<strong> stillbirths</strong> by up to 40% in pregnancies exposed in the first quarter of this medicine. Presenting with pregnancy during treatment with isotretinoin is a failure of prevention strategies.</p>\n<p>The guidelines for isotretinoin usage are as follows:</p>\n<ul>\n<li>Isotretinoin is a teratogenic drug that<strong> </strong>should not be taken during pregnancy and nursing</li>\n<li>Patients should take <strong>2 pregnancy tests before starting isotretinoin</strong> and take a<strong> monthly pregnancy test</strong> while on the medication and another test 1 month after stopping the medication.</li>\n<li>Two forms of birth control should be simultaneously used starting 1 month before treatment, during the entire course of treatment, and for 1 month after ceasing treatment with isotretinoin.</li>\n</ul>\n<p>Other options:</p>\n<p>Option B:\u00a0Lithium is used in the treatment of bipolar disorder. It is a teratogen associated with <strong>Ebstein's anomaly,</strong> which is a rare cardiac condition characterized by severe tricuspid regurgitation and right atrial enlargement.</p>\n<p>Option C:<strong>\u00a0</strong>Valproic acid is the anti-epileptic which confers the greatest risk to the developing fetus while used in pregnancy. It is associated with an increased risk of <strong>neural tube defects</strong> in the fetus.</p>\n<p>Option D:\u00a0Tetracyclines are associated with yellowish-brown <strong>discolouration</strong> of <strong>deciduous</strong> <strong>teeth</strong> when used after 25 weeks of gestation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Among the statements given below, all are true regarding bisphosphonates except that _________.",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3, and 4"
      },
      {
        "id": 2,
        "text": "2, 3, and 4"
      },
      {
        "id": 3,
        "text": "3 and 4"
      },
      {
        "id": 4,
        "text": "2 and 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>All of the above statements are true regarding bisphosphonates except statements 3 and 4. Oral preparations are advised to be taken on an <strong>empty stomach</strong> and are <strong>not recommended</strong> in patients with&nbsp;<strong>creatinine clearance</strong>&nbsp;of&nbsp;<strong>&lt;</strong> <strong>30 mL/min</strong>.</p>\n<p>Bisphosphonates are analogs of pyrophosphate. They act by<strong> directly inhibiting osteoclast </strong>function, thus preventing bone resorption. It inhibits bone resorption by inducing <strong>apoptosis</strong> of <strong>osteoclasts</strong> and <strong>inhibition</strong> of the&nbsp;<strong>cholesterol biosynthesis pathway</strong>.&nbsp;</p>\n<p>They are poorly absorbed from the intestine and have <strong>very low bioavailability</strong>, which is further reduced upon interaction with food and medication. Hence, bisphosphonates should be taken after an overnight fast, on an <strong>empty stomach</strong>, and at least 30 minutes before breakfast.&nbsp;</p>\n<p>It is excreted unchanged by the kidneys and it declines proportionally with kidney function and is hence <strong>not recommended</strong> for patients with a <strong>creatinine clearance</strong> of <strong>less than 30ml/min.</strong>&nbsp;</p>\n<p>Bisphosphonates are used to treat <strong>Paget's disease</strong>, tumor-associated osteolysis, and <strong>hypercalcemia</strong>. It can also be used to treat <strong>osteoporosis</strong>, including post-menopausal and steroid-induced osteoporosis.</p>\n<p>Oral bisphosphonates can cause&nbsp;adverse effects like gastroesophageal reflux, <strong>esophagitis</strong>, and esophageal ulcers. Intravenous bisphosphonates are associated with flu-like symptoms. Both oral and intravenous bisphosphonates can cause renal toxicity, hypocalcemia, <strong>osteonecrosis of the jaw, </strong>and atypical femur fractures.</p>\n<p>Because of the adverse effects, oral bisphosphonates are contraindicated in the following settings:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Patients with <strong>esophageal</strong> <strong>disorders</strong> such as achalasia cardia, esophageal stricture, Barrett's esophagus, or if they are unable to stay upright for at least 30 minutes after taking the medication.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Patients with chronic kidney disease (<strong>CKD</strong>) and an estimated glomerular filtration rate(eGFR) of&nbsp;<strong>&lt;30</strong> to <strong>35</strong> <strong>mL/min</strong>.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">After any <strong>bariatric surgery</strong> in which surgical anastomosis is present in the gastrointestinal (GI) tract.</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The laboratory results of a patient with congestive cardiac failure are given below. He does not have any preexisting renal condition. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Intrinsic acute kidney injury"
      },
      {
        "id": 2,
        "text": "Prerenal acute kidney injury"
      },
      {
        "id": 3,
        "text": "Nephrotoxic acute kidney injury"
      },
      {
        "id": 4,
        "text": "Glomerulonephritis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Based on the history of <strong>congestive cardiac failure</strong> and given laboratory values, the most likely diagnosis is\u00a0<strong>prerenal acute kidney injury</strong>.\u00a0</p>\n<p>Prerenal acute kidney injury\u00a0occurs due to <strong>reduced renal plasma flow</strong> and intraglomerular hydrostatic pressure. Common causes are hypovolemia, liver failure, and congestive heart failure. The kidney has autoregulatory mechanisms to compensate for the decreased blood flow resulting in the\u00a0<strong>retention</strong> <strong>of</strong> <strong>sodium</strong> and water to preserve blood volume. The urinary sodium and fractional excretion of sodium (<strong>FeNa</strong>) will be also very <strong>low</strong>.\u00a0The ratio of urine creatine/plasma creatinine is usually greater than <strong>40:1</strong>. The urinary sodium is generally\u00a0<strong>&lt;20 mEq/L</strong>.</p>\n<p>Acute kidney injury (AKI) can be prerenal, intrinsic, or postrenal:</p>\n<table style=\"width: 395.188px; height: 190px;\">\n<tbody>\n<tr>\n<td style=\"width: 140px;\">\u00a0</td>\n<td style=\"width: 149px;\"><strong>Pre-renal AKI</strong></td>\n<td style=\"width: 125px;\"><strong>Renal AKI <br />(acute tubular necrosis)</strong></td>\n<td style=\"width: 33.1875px;\"><strong>Post-renal AKI</strong></td>\n</tr>\n<tr>\n<td style=\"width: 140px;\"><strong>Urine osmolality</strong></td>\n<td style=\"width: 149px;\">&gt;500 mOsm/kg</td>\n<td style=\"width: 125px;\">&lt;250-300 mOsm/kg</td>\n<td style=\"width: 33.1875px;\">&lt;400 mOsm/kg</td>\n</tr>\n<tr>\n<td style=\"width: 140px;\"><strong>Urine Na</strong></td>\n<td style=\"width: 149px;\">&lt;20 mEq/L</td>\n<td style=\"width: 125px;\">&gt;20mEq/L</td>\n<td style=\"width: 33.1875px;\">Variable</td>\n</tr>\n<tr>\n<td style=\"width: 140px;\"><strong>FeNa</strong></td>\n<td style=\"width: 149px;\">\u22641%</td>\n<td style=\"width: 125px;\">1-3%</td>\n<td style=\"width: 33.1875px;\">Variable</td>\n</tr>\n<tr>\n<td style=\"width: 140px;\"><strong>Urine creatinine/<br />plasma creatinine</strong></td>\n<td style=\"width: 149px;\">&gt;40:1</td>\n<td style=\"width: 125px;\">&lt;40:1</td>\n<td style=\"width: 33.1875px;\">\u00a0</td>\n</tr>\n<tr>\n<td style=\"width: 140px;\"><strong>BUN: Creatinine\u00a0</strong></td>\n<td style=\"width: 149px;\">&gt;20:1</td>\n<td style=\"width: 125px;\">&lt;20:1</td>\n<td style=\"width: 33.1875px;\">&gt;20:1</td>\n</tr>\n<tr>\n<td style=\"width: 140px;\"><strong>Urine microscopy\u00a0</strong></td>\n<td style=\"width: 149px;\">Hyaline <br />casts</td>\n<td style=\"width: 125px;\">Muddy brown cast</td>\n<td style=\"width: 33.1875px;\">\n<p>Normal. <br />RBCs, WBCs, or crystals may be seen</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p><br />Various causes of acute kidney injury are given below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0596ad0d7f014222a9956ac4ef321c99x1280x2027.JPEG"
    ]
  },
  {
    "text": "While performing the following procedure on a 35-year-old man, at a distance of 1 meter, you find that the red reflex was moving against the movement of the instrument. How will you interpret your findings?",
    "choices": [
      {
        "id": 1,
        "text": "Emmetropia"
      },
      {
        "id": 2,
        "text": "Hypermetropia less than 1D"
      },
      {
        "id": 3,
        "text": "Myopia of more than 1D"
      },
      {
        "id": 4,
        "text": "Myopia of 1D"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above image shows the procedure of <strong>retinoscopy\u00a0</strong>(skiascopy) being performed. Since the red reflex moves against the movement of the retinoscope, the patient is interpreted as having\u00a0<strong>myopia of more than 1D.</strong></p>\n<p>Interpretation of retinoscopy done at 1 m is as follows:</p>\n<ul>\n<li>No movement of red reflex - Myopia of 1D</li>\n<li>With the movement - Emmetropia, hypermetropia, myopia less than 1D</li>\n<li>Against the movement - Myopia more than 1D</li>\n</ul>\n<p><strong>Retinoscopy</strong> is an <strong>objective method</strong> of finding out the <strong>refractive error</strong> by the method of neutralization.</p>\n<p>The patient is made to sit in a dark room, and light is directed onto the patient's eye. If a cycloplegic has been used, the patient can look directly into the light and have the refraction assessed along the actual visual axis.</p>\n<p><strong>Neutralization:</strong> When the red reflex moves with or against the movement of the retinoscope, we do not exactly know the measure of refractive error.\u00a0Therefore, to estimate the degree of refractive error, the movement of the red reflex is <strong>neutralized</strong> by the addition of increasingly <strong>convex</strong> (+) spherical lenses (when the red reflex was <strong>moving with</strong> the movement of the retinoscope) or <strong>concave</strong> (-) spherical lenses (when the red reflex was\u00a0<strong>moving against</strong> the movement of the retinoscope).\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/53bdb5f551fb4ff596d0a1d6863649ba.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/423f69a357c742ed9c65c18dcf560e73x1280x3795.737473535639.JPEG"
    ]
  },
  {
    "text": "Which of the following is a bioterrorism category C agent?",
    "choices": [
      {
        "id": 1,
        "text": "Bacillus anthracis"
      },
      {
        "id": 2,
        "text": "Nipah virus"
      },
      {
        "id": 3,
        "text": "Coxiella burnetti"
      },
      {
        "id": 4,
        "text": "Yersinia pestis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Nipah virus</strong> is a <strong>category C</strong> bioterrorism agent.</p>\n<p><strong>Bioterrorism</strong> is the intentional release or threat of release of biological agents (i.e. viruses, bacteria, fungi, or their toxins) in order to cause disease or death among the human population or food crops and livestock to terrorize a civilian population or manipulate the government.\u00a0</p>\n<p>The agents of bioterrorism are classified into 3 categories:</p>\n<p><strong>Category A</strong> bioterrorism agents are those which are\u00a0<strong>easily transmitted</strong> from one person to the other and are associated with <strong>high mortality</strong> rates and thus have the potential to cause major public health impacts.</p>\n<p>Examples include <em><strong>Bacillus anthracis, Clostridium botulinum</strong></em> and <em><strong>Yersinia pestis</strong>.</em></p>\n<p><strong>Category B</strong> bioterrorism agents are those which are moderately easy to disseminate and are associated with <strong>moderate morbidity</strong> and <strong>low mortality rates</strong>.</p>\n<p>Examples include <em><strong>Coxiella burnetti</strong></em> and<em><strong> Brucella</strong>.</em></p>\n<p><strong>Category C </strong>bioterrorism agents are those which are emerging pathogens that could be engineered for mass dissemination in the future due to ease of availability, high mortality and morbidity rates, and ease of production and dissemination.</p>\n<p>Examples include <strong>Nipah</strong> and Hanta viruses.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-week-old male baby was brought to the pediatrician with complaints of non-bilious vomiting after feeding. A mass could be palpated in the right upper quadrant. Ultrasound of the abdomen showed the thickening of the pylorus muscle. What is the immediate next step of management?",
    "choices": [
      {
        "id": 1,
        "text": "Perform liver function tests"
      },
      {
        "id": 2,
        "text": "Perform pyloromyotomy"
      },
      {
        "id": 3,
        "text": "Correction of electrolyte imbalance"
      },
      {
        "id": 4,
        "text": "Regular follow up to 3 months"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario of a 5-week-old <strong>male infant</strong> presenting with <strong>non-bilious vomiting</strong> <strong>after feeding</strong> along with the palpation of a <strong>mass</strong> in the <strong>right upper quadrant</strong> is suggestive of <strong>infantile hypertrophic pyloric stenosis.</strong> The immediate next step in management is to <strong>correct the electrolyte imbalance.</strong></p>\n<p>The <strong>recurrent vomiting</strong> secondary to the gastric outlet obstruction <strong>leads to dehydration</strong> and <strong>hypochloremic hypokalemic alkalosis</strong>. This <strong>abnormality</strong> has to be <strong>corrected</strong> and <strong>adequate rehydration </strong>ensured <strong>before the surgery</strong> is undertaken. <strong>Normal saline</strong> with <strong>0.15% KCl in 5% dextrose</strong> is used for maintenance and correction of the deficit.</p>\n<p>Infantile hypertrophic pyloric stenosis (IHPS), is an uncommon condition in infants characterized by abnormal<strong> thickening of the pylorus</strong> muscles in the stomach leading to <strong>gastric outlet obstruction.&nbsp;</strong>It is <strong>more commonly</strong> seen in <strong>first-born male infants</strong>. Infants usually present between <strong>2-8 weeks</strong> of age with <strong>non-bilious</strong> <strong>projectile vomiting</strong>. It is a progressive condition and can be distinguished from other causes of vomiting such as infections because the baby is particularly hungry.&nbsp;</p>\n<p>During the <strong>test feed</strong>, gastric <strong>peristalsis</strong> moving from <strong>left to right</strong> of the <strong>upper abdomen</strong> is visible, and in a relaxed baby, an <strong>olive-shaped mass</strong> can be palpated in the <strong>right upper quadrant</strong>.</p>\n<p>IHPS can be diagnosed clinically and <strong>confirmed</strong> by an <strong>ultrasound</strong>. The diagnostic <strong>criteria</strong> for pyloric stenosis are a&nbsp;<strong>muscle thickness </strong>of<strong> &ge;4 mm</strong>&nbsp;and a&nbsp;<strong>pyloric length of &ge;16 mm</strong>. The sonographic appearance of the hypertrophied pylorus resembles that of the uterine cervix and is sometimes referred to as the&nbsp;<strong>cervix sign.&nbsp;</strong>Double-layered hypertrophic mucosa protrudes into the stomach, creating the so-called <strong>nipple sign&nbsp;</strong>(given in the image below).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a74468c8956749d2ab5bb51b1c7650b3x595x630.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e8b8ba12c48147988cddfe1df3db102bx379x511.PNG"
    ]
  },
  {
    "text": "A 35-year-old woman was brought to the casualty ward with a history of head trauma due to a road traffic accident (RTA).  Her eye opens to pain, she moans, and she can localize the site of pain in both hands. On examination, both her pupils are reactive to light. While calculating her GCS-P score, what is the score you would give for pupil reactivity?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "0"
      },
      {
        "id": 3,
        "text": "2"
      },
      {
        "id": 4,
        "text": "3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>\u00a0Her pupil reactivity score is 0 since both her pupils are reactive to light.</p>\n<p>P0- neither pupil is\u00a0<strong>unreactive\u00a0</strong>to light. (Both pupils are reactive to light)</p>\n<p>A new parameter, \"pupil reactivity score\" has been added to Glasgow Coma Scale (GCS), and now, it is referred to as GCS-P. P stands for <strong>\"pupils unreactive to</strong> <strong>light</strong>\"</p>\n<p><strong>The pupillary score is subtracted</strong>\u00a0from the GCS score to give the final value. Therefore, the range of GCS-P is 1\u201315.</p>\n<p>The scoring is as follows-\u00a0</p>\n<ul>\n<li>Both pupils unreactive to light -2</li>\n<li>One pupil unreactive to light -1</li>\n<li>Neither pupil unreactive to light (both pupils react to light) -0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the usual site for fixed drug eruptions caused by nonsteroidal anti-inflammatory drugs (NSAID)?",
    "choices": [
      {
        "id": 1,
        "text": "Face"
      },
      {
        "id": 2,
        "text": "Extremities"
      },
      {
        "id": 3,
        "text": "Trunk"
      },
      {
        "id": 4,
        "text": "Genitals"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The common sites for fixed drug eruption caused by <strong>NSAIDs</strong> are the <strong>genitals</strong> and lips.</p>\n<p>Fixed drug eruption (<strong>FDE</strong>) is a cutaneous adverse drug reaction characterized by recurrent well-defined lesions occurring in the&nbsp;same sites each time the offending drug is taken.&nbsp;</p>\n<p>It is a classical delayed-type hypersensitivity reaction mediated by resident skin T cells. The common drugs implicated in FDE are non-steroidal anti-inflammatory drugs, co-trimoxazole, tetracyclines and paracetamol.</p>\n<p>Drug\u2010specific clinical patterns have been reported. These include the following:</p>\n<ul>\n<li>NSAID\u2010induced FDE -&nbsp;genitals and lips</li>\n<li>Tetracycline and trimethoprim/sulfamethoxazole\u2010induced FDE - genitals</li>\n<li>Metamizole\u2010induced FDE -&nbsp;trunk and extremities</li>\n<li>Carbocysteine\u2010induced FDE - face</li>\n</ul>\n<p>&nbsp;The image shown below is of a healed fixed drug eruption on the glans penis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8ab9c4a192974a9cbce43313e2ad57e5x479x371.JPEG"
    ]
  },
  {
    "text": "Which of the following conditions is a contraindication for endoscopic sinus surgery?",
    "choices": [
      {
        "id": 1,
        "text": "Chronic bacterial rhinosinusitis"
      },
      {
        "id": 2,
        "text": "Allergic fungal sinusitis with mycetoma"
      },
      {
        "id": 3,
        "text": "Subperiosteal abscess"
      },
      {
        "id": 4,
        "text": "Cerebrospinal fluid leak"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Subperiosteal abscess</strong> is a <strong>contraindication</strong> for functional endoscopic sinus surgery.</p>\n<p>The endoscopic approach is contraindicated in the presence of an <strong>intracranial complication</strong> of acute infection such as:</p>\n<ul>\n<li>Meningitis</li>\n<li>Subperiosteal abscess</li>\n<li>Epidural abscess</li>\n<li>Cavernous sinus thrombosis</li>\n<li>Any visual loss\u00a0</li>\n</ul>\n<p>Endoscopic sinus surgery is indicated in the following conditions:</p>\n<ul>\n<li>Long-term treatment of chronic bacterial rhinosinusitis</li>\n<li>Acute and recurrent rhinosinusitis</li>\n<li>Nasal polyposis</li>\n<li>Mucocele</li>\n<li>Allergic fungal sinusitis with mycetoma</li>\n<li>Repair of cerebrospinal fluid leak</li>\n<li>Choanal atresia</li>\n<li>Septal and turbinate surgeries.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An insured 35-year-old woman, who is working in a newspaper establishment, is undergoing a tubectomy procedure. According to the Employees State Insurance Act, she would receive the cash benefit under ____.",
    "choices": [
      {
        "id": 1,
        "text": "Enhanced sickness benefit"
      },
      {
        "id": 2,
        "text": "Extended sickness benefit"
      },
      {
        "id": 3,
        "text": "Maternity benefit"
      },
      {
        "id": 4,
        "text": "Dependant's benefit"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">Insured\u00a0persons in the productive age group undergoing sterilization procedures such as tubectomy and vasectomy are offered cash benefit under the ESI Act as\u00a0<strong>enhanced sickness benefit.\u00a0</strong></p>\n<p class=\"ng-binding\">The enhanced sickness benefit <strong>equal to full wage</strong> is payable to insured persons undergoing sterilization for 7 days for male and 14 days for female workers.\u00a0</p>\n<p class=\"ng-binding\">Other options:\u00a0</p>\n<p class=\"ng-binding\">Option B: <strong>Extended sickness benefit</strong> is offered to insured people who are suffering from certain <strong>chronic diseases</strong>, for a maximum period of 2 years, in addition to the 91 days of leave they are entitled to under the sickness benefit. During this period, they are paid about <strong>80%</strong> of the average daily wages. The insured person should have been working for a continuous period of 2 years. There are 34 listed diseases for which the extended sickness benefit can be availed.\u00a0</p>\n<p class=\"ng-binding\">Option C:<strong> Maternity benefit</strong> is payable in cash to an insured woman for <strong>confinement/miscarriage</strong> or <strong>sickness</strong> arising out of pregnancy, confinement, or premature birth of a child or miscarriage. The benefit is allowed at <strong>full wages</strong> for a period of 26 weeks for confinement, 6 weeks for miscarriage, and 30 days for sickness arising out of confinement.</p>\n<p class=\"ng-binding\">Option D:<strong> Dependant's benefit</strong>\u00a0is offered to the dependants of an insured person who died as a result of an employment injury. Pension up to <strong>90%</strong> of daily wages is paid to the dependants on a monthly basis. Children are entitled to this benefit up to 18 years of age.\u00a0</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test 10';
        const quizFilename = 'mini-test-10-f1dc9df4.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>