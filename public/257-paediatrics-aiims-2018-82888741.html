<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>257 Paediatrics Aiims 2018 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Pediatrics
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">16</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following is not an indicator of fetal lung maturity?",
    "choices": [
      {
        "id": 1,
        "text": "Lecithin-sphingomyelin ratio > 2.5"
      },
      {
        "id": 2,
        "text": "Positive shake test"
      },
      {
        "id": 3,
        "text": "Increased phosphatidyl glycerol"
      },
      {
        "id": 4,
        "text": "Nile blue test showing >50% of blue cells"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Nile blue test&nbsp;</strong>showing <strong>&gt;50% orange cells</strong> is a sign of fetal lung maturity, not blue cells.</p>\n<p>Tests for the assessment of <strong>fetal lung maturity</strong> include:&nbsp;</p>\n<p>The <strong>Nile blue test</strong> involves staining desquamated fetal cells from amniotic fluid with 0.1% Nile blue sulfate. The presence of <strong>orange cells &gt; 50%</strong>&nbsp;suggests<strong>&nbsp;lung maturity.&nbsp;</strong><strong>Lecithin/sphingomyelin ratio</strong> at 31 to 32 weeks is 1, and at 35 weeks ratio is 2. The <strong>ratio&nbsp;&ge;2</strong> indicates lung maturity (option A).&nbsp;</p>\n<p>The <strong>shake test</strong> or <strong>bubble test</strong> (<strong>Clement's test</strong>) (option B) involves mixing <strong>amniotic fluid</strong> with <strong>95% ethanol</strong>, shaking it for 15 seconds, and observing it for 15 minutes. A <strong>complete ring of</strong> <strong>bubbles</strong> at the meniscus is a <strong>positive test</strong> and indicates lung maturity. This is a useful bedside test.</p>\n<p>The presence of <strong>phosphatidylglycerol</strong>, (option C)&nbsp;<strong>saturated phosphatidylcholine</strong>&nbsp;and&nbsp;<strong>lamellar body count (&gt;50,000/mcL)</strong>&nbsp;indicates lung maturity.</p>\n<p><strong>Glucocorticoids</strong> accelerate <strong>lung maturation</strong> and <strong>lower</strong> the incidence of <strong>respiratory distress</strong> and <strong>neonatal mortality</strong> in preterms if the birth was delayed for at least 24 hours after initiation of betamethasone. A single course of corticosteroids is recommended for women between <strong>24 and 36 weeks</strong> who are at risk of delivery within 7 days. Intramuscular injections of either<strong> 2 doses of 12 mg</strong> <strong>betamethasone</strong> are given <strong>24 hourly</strong> or <strong>4 doses of 6 mg dexamethasone</strong> are given <strong>12 hourly</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "How long should a child be isolated after being diagnosed with bacterial meningitis to prevent further transmission?",
    "choices": [
      {
        "id": 1,
        "text": "Till 24 hours after starting antibiotics"
      },
      {
        "id": 2,
        "text": "Till cultures become negative"
      },
      {
        "id": 3,
        "text": "Till antibiotic course is complete"
      },
      {
        "id": 4,
        "text": "Till 12 hours after admission"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Isolation of the child is recommended<strong>&nbsp;until 24 hrs after the initiation of effective therapy&nbsp;</strong>after being diagnosed with acute bacterial meningitis to prevent further transmission.</p>\n<p><strong>Droplet precautions</strong> are recommended for patients with&nbsp;<strong>Neisseria meningitides&nbsp;</strong>and <strong>Haemophilus influenzae<em>&nbsp;</em>type b (Hib) meningitis</strong> until they have received 24 hours of effective therapy. Patients should be in private rooms, and hospital personnel should wear a face mask when they are within 3 feet (1 meter) of the patient.</p>\n<p>The child with meningitis shows nonspecific symptoms like <strong>fever,</strong> anorexia, <strong>poor feeding</strong>, headache, myalgia, <strong>hypotension</strong>,&nbsp;petechia, purpura, or a <strong>rash</strong>. Meningial irritation is indicated by&nbsp;<strong>nuchal rigidity</strong>, back pain, and&nbsp;<strong>Kernig, and Brudzinski signs </strong>(usually not seen in infants). <strong>Seizures</strong> and <strong>altered mental status</strong> may be present.&nbsp;</p>\n<p>The recommended <strong>empirical antibiotic</strong> regimen in a suspected case of meningitis outside the neonatal period is <strong>vancomycin</strong> combined with a <strong>third-generation cephalosporin</strong>. Patients <strong>allergic to penicillin</strong> or cephalosporin can be treated with <strong>meropenem, fluoroquinolones</strong>, or <strong>chloramphenicol</strong>.&nbsp;</p>\n<p><strong>Chemoprophylaxis&nbsp;</strong>with<strong> rifampicin/ceftriaxone/ciprofloxacin</strong> is recommended for all close contacts with <strong>meningococcal</strong> meningitis regardless of age or immunization status.&nbsp;<strong>Rifampicin prophylaxis</strong> should be given to all <strong>household contacts</strong> of patients with invasive disease caused by<strong> Haemophilus influenzae type b</strong>, if an <strong>immunocompromised child</strong> of any age resides in the household or close family member <strong>younger than 48 months</strong> has<strong> not</strong> been<strong> fully immunized</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Choose the correct order of suctioning during neonatal resuscitation.",
    "choices": [
      {
        "id": 1,
        "text": "Mouth-nose"
      },
      {
        "id": 2,
        "text": "Nose-mouth"
      },
      {
        "id": 3,
        "text": "Mouth-nose-oesophagus"
      },
      {
        "id": 4,
        "text": "Trachea-nose-mouth"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Chest compression should be initiated over the <strong>lower third of the sternum</strong> at a rate of<strong> 90/minutes</strong>. The <strong>ratio</strong> of chest compression to ventilation is<strong> 3: 1</strong> (90 compressions: 30 breaths). The <strong>thumb technique </strong>(preferred)&nbsp;and <strong>2 finger technique</strong> are the two different techniques used for performing chest compression. Umbilical vein cannulation is the preferred method for the administration of medications.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/32ea7f0f38c245a5bfa6da3df8fa0322x1280x2558.JPEG"
    ]
  },
  {
    "text": "An adolescent girl complaints of dropping objects from hands precipitated during morning hours and exams. There is no history of loss of consciousness. One of her cousins has been diagnosed with epilepsy. EEG was suggestive of epileptic spikes. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Juvenile myoclonic epilepsy"
      },
      {
        "id": 2,
        "text": "Atypical absence"
      },
      {
        "id": 3,
        "text": "Choreo-athetoid epilepsy"
      },
      {
        "id": 4,
        "text": "Centrotemporal spikes"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario describes an <strong>adolescent</strong> girl with <strong>myoclonic jerks</strong> (a history of <strong>dropping objects</strong>)&nbsp;with <strong>preserved</strong> <strong>consciousness</strong>. This, along with&nbsp;<strong>abnormal EEG </strong>findings strongly suggests <strong>juvenile myoclonic epilepsy</strong>.</p>\n<p><strong>Juvenile myoclonic epilepsy</strong> (<strong>Janz syndrome</strong>) is the most common generalized epilepsy in young adults. It starts in <strong>early adolescence</strong> with one or more of the following features: <strong>bilateral myoclonic jerks</strong> in the <strong>morning</strong>, causing patients to <strong>drop things</strong>, <strong>generalized tonic-clonic</strong> or <strong>clonic-tonic-clonic</strong> seizures upon awakening, and <strong>juvenile absence seizure</strong>.</p>\n<p><strong>Consciousness</strong> is usually<strong> preserved</strong>.&nbsp;<strong>Precipitating factors</strong> include <strong>sleep deprivation</strong>, <strong>alcohol</strong>, and photic stimulation. EEG shows <strong>4 to 5Hz polyspike</strong> and <strong>slow wave</strong> discharges. A <strong>family history</strong>&nbsp;of epilepsy is often present.&nbsp;</p>\n<p>The treatment options for JME include <strong>sodium valproate, levetiracetam, and topiramate.&nbsp;</strong>Benzodiazepine, lamotrigine,&nbsp;perampanel, phenobarbital, primidone, and zonisamide can be considered as add-on drugs.&nbsp;<strong>Complete remission</strong> is <strong>uncommon</strong> and has a high risk of seizure recurrence, hence antiepileptics are continued<strong> lifelong</strong> in a majority of the patients.&nbsp;</p>\n<p>Other options:&nbsp;</p>\n<p>Option B:<strong> Atypical absence seizures</strong> have been associated with myoclonic components and <strong>head drop</strong>. They are precipitated by drowsiness and EEG shows <strong>1 to 2 Hz spike</strong> and <strong>slow wave</strong> discharges.&nbsp;</p>\n<p>Option D: In <strong>benign childhood epilepsy</strong> with <strong>centrotemporal spikes</strong>, the child typically wakes at night due to a focal seizure with preserved awareness. <strong>B</strong><strong>uccal</strong> and <strong>throat</strong> <strong>tingling</strong> and tonic or clonic contractions on one side of the face are seen, with drooling and preserved consciousness. EEG shows typical wide-based centrotemporal spikes.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A newborn female presents with continuous dribbling of urine. The image below shows the pathology from which the patient is suffering. The most likely diagnosis is:",
    "choices": [
      {
        "id": 1,
        "text": "Gastroschisis"
      },
      {
        "id": 2,
        "text": "Bladder exstrophy"
      },
      {
        "id": 3,
        "text": "Superior vesical fissure"
      },
      {
        "id": 4,
        "text": "Anterior ectopic anus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option D: Mild forms of the <strong>imperforate anus</strong> are often called anal stenosis or an <strong>anterior ectopic anus</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b4c12919b32e4db49436be1d5a8592f7.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3214995051d7489a851eb1009c17827cx1280x1728.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9281a3f6c75b435e98f316d6b7db6f59x1279x1242.JPEG"
    ]
  },
  {
    "text": "The absence of which of the following milestones in a 3-year-old child is called as developmental delay?",
    "choices": [
      {
        "id": 1,
        "text": "Hopping on one leg"
      },
      {
        "id": 2,
        "text": "Drawing a square"
      },
      {
        "id": 3,
        "text": "Feeding by spoon"
      },
      {
        "id": 4,
        "text": "Passing a ball to someone"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Feeding by spoon</strong> is a social milestone that typically\u00a0appears by<strong> 18 months</strong>. If this is absent, then the child should be termed as having a developmental delay.\u00a0<strong>Hopping on one leg</strong>, drawing a<strong> square</strong>, and <strong>passing a ball</strong> to someone appear by <strong>48 months</strong> of age.\u00a0</p>\n<p><strong>Red flag signs</strong> in developmental screening and surveillance are indicators that suggest a serious disorder in a child's development, requiring referral to a pediatrician. These are given below:\u00a0</p>\n<p><strong>Positive indicators</strong>: Presence of any of the following</p>\n<ul>\n<li>Loss of developmental skills at any age</li>\n<li>Concerns about vision or confirmed visual impairment</li>\n<li>Hearing loss at any age</li>\n<li>Persistently low muscle tone</li>\n<li>Lack of speech by 18 months without other means of communication</li>\n<li>Asymmetry of movements or features suggestive of cerebral palsy</li>\n<li>Persistent toe walking</li>\n<li>Complex disabilities</li>\n<li>Unusual head circumference compared to norms</li>\n<li>Clinician uncertainty about the developmental disorder.</li>\n</ul>\n<p><strong> Negative Indicators</strong>:</p>\n<ul>\n<li>Inability to sit unsupported by 12 months</li>\n<li>Inability to walk by 18 months in boys or 2 years in girls.</li>\n<li>Inability to walk normally</li>\n<li>Inability to run by 2.5 years</li>\n<li>Inability to hold objects in hand by 5 months or reach for them by 6 months.</li>\n<li>Inability to point at objects to share interest by 2 years\u00a0\u00a0</li>\n</ul>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old child with a history of fall 1 year back with parietal bone fracture, has now presented with a painful and growing parietal swelling. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Growing scalp hematoma"
      },
      {
        "id": 2,
        "text": "Growing fracture"
      },
      {
        "id": 3,
        "text": "Subdural hygroma"
      },
      {
        "id": 4,
        "text": "Chronic abscess"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical presentation of a child with a <strong>painful and growing parietal swelling</strong>, coupled with a history of a <strong>prior parietal bone fracture</strong> one year ago, strongly suggests the diagnosis of a <strong>growing fracture,&nbsp;</strong>also known as&nbsp;<strong>traumatic encephalocele or leptomeningeal cysts</strong>.</p>\n<p>Skull fractures associated with a dural tear may fail to heal properly. The herniated brain, dilated ventricles, or a leptomeningeal cyst may cause an enlargement of this tear. These fractures are called&nbsp;<strong>growing skull fractures. </strong>They are usually seen in children <strong>&lt; 3 years</strong> of age.</p>\n<p>They present&nbsp;as a <strong>localized swelling or palpable</strong> <strong>skull defect</strong> that increases in size, most commonly seen in the <strong>parietal region</strong>. However, they may go <strong>undetected for years</strong> and present with delayed onset of neurologic symptoms (headache, seizure, or neurologic deficit).&nbsp;</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;The extended duration of one year makes scalp hematoma unlikely, as it usually resolves within a few months.</p>\n<p>Option C:&nbsp;<strong>Subdural hygromas</strong> are characterized by fluid accumulation in the subdural space. Most patients with subdural hygromas are asymptomatic, but uncommon symptoms may include headaches, changes in mental status, nausea and vomiting, focal neurological deficits, and seizures. They don't present with scalp swelling.</p>\n<p>Option D: <strong>Chronic abscess</strong> may show <strong>inflammatory</strong> changes like <strong>erythema</strong>, pus, sinus, and systemic features like<strong> fever</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "After the delivery of an infant of a diabetic mother, the blood glucose of the Infant was 60 mg/dl. Which other investigation would you do?",
    "choices": [
      {
        "id": 1,
        "text": "Serum potassium"
      },
      {
        "id": 2,
        "text": "Serum sodium"
      },
      {
        "id": 3,
        "text": "Serum chloride"
      },
      {
        "id": 4,
        "text": "Serum calcium"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In an <strong>infant of a diabetic mother</strong> with normal blood glucose levels, the next investigation to consider is <strong>serum calcium</strong> due to the high risk of developing <strong>hypocalcemia</strong>. Hypocalcemia in these infants is attributed to the <strong>delayed response of the parathyroid hormone system</strong>.\u00a0</p>\n<p><strong>Hypocalcemia</strong> is defined as a total serum calcium concentration of <strong>less than 8 mg/dL</strong> for a <strong>term</strong> baby (<strong>ionized calcium below 4mg/dL</strong>) and <strong>less than 7 mg/dL</strong> for a <strong>preterm</strong> baby. Asymptomatic neonates can be managed conservatively with early nutrition.<strong> Symptomatic neonates</strong> should receive <strong>iv or oral calcium</strong> replacement.\u00a0</p>\n<p><strong>Maternal hyperglycemia</strong> causes <strong>fetal hyperglycemia</strong>, and the fetal pancreatic response leads to <strong>fetal hyperinsulinemia</strong>, which causes neonatal<strong> hypoglycemia</strong>.\u00a0<strong>Neonatal hypoglycemia</strong> is defined as <strong>blood glucose &lt;40 mg/dL </strong>(plasma glucose &lt;45 mg/dL)<strong>.</strong>\u00a0The infant tends to be <strong>jittery</strong>, <strong>tremulous</strong>, hyperexcitable, hypotonic, <strong>lethargic</strong>, and<strong> poor sucking</strong> during the 1st three days after birth. These symptoms can also be related to <strong>hypocalcemia</strong> and <strong>hypomagnesemia</strong> which occur in the 1st 24 to 72 hours of life.\u00a0</p>\n<p><strong>Respiratory distress syndrome</strong>, <strong>macrosomia</strong>, hyperbilirubinemia, polycythemia, renal vein thrombosis,<strong> visceromegaly</strong>, heart failure, and persistent pulmonary hypertension are other features seen in infants of diabetic mothers.\u00a0</p>\n<p><strong>Congenital anomalies</strong> are seen in infants of mothers with pregestational diabetes. <strong>Neural tube defects</strong> (Encephalocele, meningomyelocele, anencephaly), transposition of great vessels (<strong>TGA</strong>), ventricular septal defect (<strong>VSD)</strong>, atrial septal defect (<strong>ASD</strong>), hypoplastic left heart, aortic stenosis and coarctation of the aorta are commonly seen.\u00a0</p>\n<p><strong>Caudal regression syndrome</strong> is rare, but a specific anomaly seen in infants of diabetic mothers. <strong>Small left colon syndrome</strong> is a rare anomaly that develops in the<strong> second</strong> and <strong>third</strong> trimesters.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You have been called to declare the brain death of a 12-year-old child in the ICU.  Which of the following is not seen in brain death?",
    "choices": [
      {
        "id": 1,
        "text": "Normal BP without pharmacological support"
      },
      {
        "id": 2,
        "text": "Positive spinal reflexes on stimulation"
      },
      {
        "id": 3,
        "text": "Sweating and tachycardia"
      },
      {
        "id": 4,
        "text": "Decorticate and decerebrate posturing"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Decerebrate </strong>or<strong> decorticate posturing&nbsp;</strong>is not seen in brain death as they are <strong>motor responses to noxious stimuli</strong> that originate from the midbrain and cortex.&nbsp;</p>\n<p>Brain death, also known as death by neurologic criteria refers to the irreversible and total <strong>cessation</strong> of all functions of the <strong>entire brain</strong>, including the <strong>brainstem</strong>.</p>\n<p>The <strong>three components</strong> for diagnosing brain death are a demonstration of coexisting <strong>irreversible coma</strong> with a known cause, <strong>absence of brain stem reflexes</strong>, and<strong> apnea</strong>. Coma requires the patient to be <strong>unresponsive</strong>, even to noxious stimuli. The <strong>diagnosis of brain death</strong> can <strong>still be made</strong> <strong>despite positive spinal reflexes.&nbsp;</strong>(option B)</p>\n<p><strong>Brainstem reflexes</strong> (pupillary responses, oculocephalic reflex, oculovestibular responses, corneal reflex, jaw reflex, facial grimacing, pharyngeal gag reflex, coughing) are <strong>absent</strong>. <strong>Apnea</strong> is the absence of respiratory drive at PaCO2 of &ge;60mmHg and &gt; 20mmHg above baseline, which is consistent with brain death.</p>\n<p>The following manifestations are occasionally seen and should not be misinterpreted as evidence of brainstem function:&nbsp;</p>\n<ul>\n<li>Normal systolic blood pressure<strong>&nbsp;- SBP &gt;100 mmHg&nbsp;</strong>(option A)</li>\n<li>Movements originating from the spinal cord or peripheral nerve may occur</li>\n<li><strong>Sweating,</strong> flushing, <strong>tachycardia&nbsp;</strong>(option C)</li>\n<li>Deep tendon reflexes; superficial abdominal reflexes; triple flexion response</li>\n<li><strong>Babinski reflex</strong></li>\n<li>Spontaneous movements of limbs other than pathologic flexion or extension response</li>\n<li>Respiratory-like movements (shoulder elevation and adduction, back-arching, intercostal expansion without significant tidal volumes)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Craniopagus is defined as the fusion of ______.",
    "choices": [
      {
        "id": 1,
        "text": "Head and spine"
      },
      {
        "id": 2,
        "text": "Head only"
      },
      {
        "id": 3,
        "text": "Thorax and spine"
      },
      {
        "id": 4,
        "text": "Thorax only"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Craniopagus</strong> is a type of conjoint twin where there is <strong>a fusion of the head or cranium.\u00a0</strong></p>\n<p><strong>Foramen magnum or the skull base never fuses</strong> in the case of craniopagus. They usually will have fused skulls and meninges. A shared cerebral cortex may occasionally be found.</p>\n<p>Craniopagus has an incidence of 5%, and separation of the twins has a poor prognosis.\u00a0</p>\n<p><strong>Dizygotic/fraternal twins</strong> result from the fertilization of <strong>two separate ova</strong>. <strong>Monozygotic/identical twins</strong> arise from the division of a <strong>single fertilized ovum</strong>. The outcome of the monozygotic twinning process depends on when division occurs.</p>\n<table style=\"height: 124px; width: 360.078px;\">\n<tbody>\n<tr>\n<td style=\"width: 214px;\"><strong>Monozygotic types</strong></td>\n<td style=\"width: 128.078px;\"><strong>Time of zygote division</strong></td>\n</tr>\n<tr>\n<td style=\"width: 214px;\">Dichorionic diamniotic</td>\n<td style=\"width: 128.078px;\">&lt;72 hours</td>\n</tr>\n<tr>\n<td style=\"width: 214px;\"><strong>Monochorionic diamniotic</strong> (<strong>more common</strong>)</td>\n<td style=\"width: 128.078px;\">4 to 8 days</td>\n</tr>\n<tr>\n<td style=\"width: 214px;\">Monochorionic monoamniotic</td>\n<td style=\"width: 128.078px;\">8 to 12 days</td>\n</tr>\n<tr>\n<td style=\"width: 214px;\">Conjoined twins</td>\n<td style=\"width: 128.078px;\">&gt;12 days</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Types of conjoined twins</strong>:</p>\n<ul>\n<li><strong>Thoracopagus</strong>: united at the thorax\u00a0</li>\n<li><strong>Craniopagus</strong>: united at the head</li>\n<li><strong>Cephalothoracopagus</strong>: fusion of both head and thorax</li>\n<li><strong>Omphalopagous</strong> or xiphipagous: united anteriorly from the xiphoid to the umbilicus</li>\n<li><strong>Parapagus</strong>: lateral fusion with two heads, sharing a single thorax, abdomen, and pelvis\u00a0</li>\n<li><strong>Ischiopagus</strong>: united at the pelvis</li>\n<li><strong>Pygopagus</strong>: united in the sacral region</li>\n<li><strong>Heteropagous</strong>: asymmetric forms</li>\n</ul>\n<p>The image below shows the types of conjoined twins:\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a4386b27a4514f55bfb8399423ab1df7x1279x1133.PNG"
    ]
  },
  {
    "text": "Which of the following hormones is the major product of the fetal adrenal glands?",
    "choices": [
      {
        "id": 1,
        "text": "DHEA"
      },
      {
        "id": 2,
        "text": "Cortisol"
      },
      {
        "id": 3,
        "text": "Corticosterone"
      },
      {
        "id": 4,
        "text": "Progesterone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>major steroid products</strong> of the <strong>fetal adrenal gland</strong> are <strong>DHEA</strong> (dehydroepiandrosterone) and<strong> DHEA-S</strong>.</p>\n<p>They serve as important <strong>substrates for</strong> <strong>estrogen synthesis</strong> in the placenta.</p>\n<p>The <strong>fetal-adrenal-placental axis</strong> is vital for<strong> normal childbirth</strong>. <strong>Placental corticotropin-releasing hormone</strong> (CRH)<strong> stimulates</strong> the<strong> fetal adrenal gland</strong> to produce DHEA-S and <strong>cortisol</strong>. <strong>Cortisol</strong> further <strong>stimulates</strong> the production of <strong>placental CRH</strong>, creating a <strong>positive feedback loop</strong> that<strong> enhances</strong> adrenal steroid hormone production.</p>\n<p>The steroid products released by the fetal adrenal gland have effects on the placenta and membranes. These effects contribute to <strong>transforming the myometrium</strong> from a <strong>quiescent</strong> to a <strong>contractile state</strong>.&nbsp;</p>\n<p><strong>Congenital adrenal hyperplasia</strong> is an autosomal recessive condition in which cortisol synthesis in the adrenal gland is affected. <strong>Cortisol deficiency increases</strong> the secretion of <strong>ACTH</strong>, which leads to <strong>adrenocortical hyperplasia</strong> and <strong>overproduction of intermediate metabolites</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8a511b86889940589cb2bcb3420a7831x1279x1317.JPEG"
    ]
  },
  {
    "text": "A 2-day-old neonate was admitted to the NICU after he was observed to have movements as shown in the clip. His APGAR scores were 8 and 9 at 1 and 5 minutes, respectively. His blood sugar was within the normal range in the first 24 hours. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Focal tonic seizure"
      },
      {
        "id": 2,
        "text": "Focal clonic seizure"
      },
      {
        "id": 3,
        "text": "Spasms"
      },
      {
        "id": 4,
        "text": "Subtle seizure"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The video clip of a 2-day-old neonate exhibiting <strong>repetitive, rhythmic movement</strong> in <strong>unilateral upper</strong> and <strong>lower limbs</strong> suggests a neonatal seizure of <strong>focal clonic</strong> <strong>type</strong>.&nbsp;</p>\n<p>A <strong>focal clonic seizure</strong> is characterized by <strong>multiple,&nbsp;repetitive</strong>, <strong>rhythmic contractions</strong> of muscle groups of the <strong>limbs, face</strong>, or <strong>trunk</strong>, maybe unifocal or multifocal. It may occur synchronously or asynchronously in muscle groups on <strong>one side</strong> of the body. It may occur simultaneously but asynchronously on both sides. It <strong>cannot be suppressed by restraint</strong>.&nbsp;</p>\n<p>Other options:&nbsp;</p>\n<p>Option A:<strong>&nbsp;Focal tonic seizure</strong><strong>s&nbsp;</strong>are&nbsp;characterized by <strong>sustained posturing</strong> of a&nbsp;<strong>single limb</strong>, sustained <strong>asymmetrical posturing</strong> of the<strong> trunk</strong>, and sustained <strong>eye deviation</strong>. They&nbsp;<strong>cannot</strong> be provoked by stimulation or<strong> suppressed by restraint</strong>.</p>\n<p>Option C: <strong>Spasms</strong> are sudden <strong>generalized jerks</strong> lasting 1-2 sec and are usually associated with a single, very brief, generalized discharge. They may be flexor, extensor, or mixed extensor/flexor and can <strong>occur in clusters</strong>. They too&nbsp;<strong>cannot</strong> be provoked by stimulation or suppressed by restraint.</p>\n<p>Option D:<strong> Subtle seizures</strong> include <strong>transient eye deviations</strong>, <strong>nystagmus</strong>, <strong>blinking</strong>, mouthing, <strong>abnormal extremity movements</strong>&nbsp;(rowing, swimming, cycling, pedalling),&nbsp;fluctuations in heart rate, hypertension episodes, and apnea. They are more common in <strong>preterm&nbsp;</strong>than in term babies.&nbsp;</p>\n<p><strong>Myoclonic seizures</strong> are random, single, <strong>rapid muscle contractions</strong> of the limbs, face, or trunk. They are<strong> not repetitive</strong>&nbsp;or may recur at a slow rate. They can be generalized, focal, or fragmentary. They<strong> can be</strong> provoked by stimulation.</p>\n<p>Clinically apparent seizures in a neonate should be treated if they last <strong>&gt;3 minutes</strong> or are brief <strong>serial</strong> seizures. In<strong> all neonates with seizures</strong>, <strong>hypoglycemia, CNS infection</strong>, and <strong>hypocalcemia</strong> should <strong>be ruled out</strong> before starting anti-epileptic drug treatment.&nbsp;</p>\n<p><strong>Causes of neonatal seizure</strong> according to the age of presentation:&nbsp;</p>\n<table style=\"height: 348px; width: 518.992px;\">\n<tbody>\n<tr style=\"height: 20px;\">\n<td style=\"width: 178px; height: 20px;\"><strong>1 to 4 days</strong></td>\n<td style=\"width: 84px; height: 20px;\"><strong>4 to 14 days</strong></td>\n<td style=\"width: 228.992px; height: 20px;\"><strong>2 to 8 weeks</strong></td>\n</tr>\n<tr style=\"height: 12.8203px;\">\n<td style=\"width: 178px; height: 12.8203px;\">\n<p>Hypoxic ischemic encephalopathy</p>\n<p>Maternal use of narcotics or barbiturates</p>\n<p>Drug toxicity: lidocaine, penicillin</p>\n<p>Intraventricular hemorrhage</p>\n<p>Hypocalcemia, sepsis, hypoglycemia, hypomagnesemia,&nbsp; hypo or hypernatremia</p>\n<p>Galactosemia, urea cycle disorders</p>\n</td>\n<td style=\"width: 84px; height: 12.8203px;\">\n<p>Meningitis (bacterial)</p>\n<p>Encephalitis (enteroviral, herpes simplex)</p>\n<p>Hypocalcemia, hypoglycemia</p>\n<p>Galactosemia, fructosemia,&nbsp;</p>\n<p>Hyperinsulinism, hyperammonemia syndrome</p>\n</td>\n<td style=\"width: 228.992px; height: 12.8203px;\">\n<p>Herpes simplex or enteroviral encephalitis, bacterial meningitis</p>\n<p>Subdural hematoma, child abuse</p>\n<p>Aminoaciduria, urea cycle defects</p>\n<p>Malformations of cortical development</p>\n<p>Tuberous sclerosis</p>\n<p>Sturge-Weber syndrome</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9aa6d8412f1e401ba936d0ef99eb6e58.GIF"
    ],
    "explanation_images": []
  },
  {
    "text": "A male child with coarse facies, macroglossia, thick lips with hepatosplenomegaly presents with copious mucous discharge from the nose. The most probable underlying diagnosis is ________",
    "choices": [
      {
        "id": 1,
        "text": "Hurler disease"
      },
      {
        "id": 2,
        "text": "Beckwith-Wiedemann syndrome"
      },
      {
        "id": 3,
        "text": "Proteus Syndrome"
      },
      {
        "id": 4,
        "text": "Hypothyroidism"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Other options:</p>\n<p>Option B: <strong>Beckwith-Wiedemann</strong> syndrome is an overgrowth syndrome characterized by <strong>macrosomia</strong>, <strong>macroglossia</strong>,<strong> hemihypertrophy</strong>, <strong>omphalocele</strong>, and renal anomalies. It is associated with an increased risk of <strong>Wilms tumor</strong>, hepatoblastoma, rhabdomyosarcoma, neuroblastoma, and adrenal cortical carcinoma.</p>\n<p>Option C: <strong>Proteus syndrome</strong> is a disturbance of cellular growth involving ectodermal and mesodermal tissues, caused by mutation in the AKT1 gene. They present with <strong>hemimegalencephaly</strong>, asymmetric <strong>overgrowth of the extremities</strong>, verrucous cutaneous lesions, thickening of the bone, and excessive growth of muscles.</p>\n<p>Option D: A child with untreated <strong>congenital hypothyroidism</strong> may have stunted growth, short extremities, narrow palpebral fissures, swollen eyelids, depressed nasal bridge, thick broad protruded tongue, and short and thick neck, dry and scaly skin.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bc2784866d7a414fad4a7a7c99f36f1dx720x1757.JPEG"
    ]
  },
  {
    "text": "Which pattern of inheritance does the pedigree chart denote?",
    "choices": [
      {
        "id": 1,
        "text": "Autosomal-dominant disorder"
      },
      {
        "id": 2,
        "text": "X- linked dominant disorder"
      },
      {
        "id": 3,
        "text": "Autosomal-recessive disorder"
      },
      {
        "id": 4,
        "text": "X- linked recessive disorder"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above pedigree chart denotes an <strong>autosomal recessive</strong> pattern. In the above pedigree chart, both <strong>males</strong> and <strong>females</strong> are <strong>carriers</strong>\u00a0(equally affected) which indicates an <strong>autosomal</strong> pattern. Parents<strong>\u00a0are unaffected</strong> (both are carriers/heterozygotes), and <strong>no</strong> <strong>affected members</strong> in<strong> other generations</strong>.<strong>\u00a025%</strong> of the children are normal, 50% are carriers, and only\u00a0<strong>25%</strong> are <strong>affected</strong>. This indicates a a<strong> recessive</strong> pattern.\u00a0</p>\n<p>Pedigree charts in various modes of inheritance:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1e78dce118f54143b1975289a8b41a95.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A preterm infant in the NICU was observed to have marked nasal flare, distinct xiphoid retractions, minimal intercostal retractions, and inspiratory lag with an audible grunt. What would be the Silverman Anderson score?",
    "choices": [
      {
        "id": 1,
        "text": "10"
      },
      {
        "id": 2,
        "text": "7"
      },
      {
        "id": 3,
        "text": "8"
      },
      {
        "id": 4,
        "text": "9"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Downes&rsquo; Score</strong> is also used for assessing the severity of respiratory distress. It is more comprehensive and can be applied to any gestational age and condition.&nbsp;Downe&rsquo;s<strong> score of &gt;7</strong>&nbsp;means <strong>impending respiratory failure.</strong></p>\n<table style=\"height: 191px;\" width=\"621\">\n<tbody>\n<tr>\n<td style=\"width: 148.25px;\">Score</td>\n<td style=\"width: 148.25px;\">0</td>\n<td style=\"width: 148.25px;\">1</td>\n<td style=\"width: 148.25px;\">2</td>\n</tr>\n<tr>\n<td style=\"width: 148.25px;\"><strong>Respiratory rate</strong></td>\n<td style=\"width: 148.25px;\">&lt;60/min</td>\n<td style=\"width: 148.25px;\">60&ndash;80/min</td>\n<td style=\"width: 148.25px;\">&gt;80/min</td>\n</tr>\n<tr>\n<td style=\"width: 148.25px;\"><strong>Air entry</strong></td>\n<td style=\"width: 148.25px;\">Normal</td>\n<td style=\"width: 148.25px;\">Mild decrease</td>\n<td style=\"width: 148.25px;\">Marked decrease</td>\n</tr>\n<tr>\n<td style=\"width: 148.25px;\"><strong>Cyanosis</strong></td>\n<td style=\"width: 148.25px;\">Nil</td>\n<td style=\"width: 148.25px;\">In-room air</td>\n<td style=\"width: 148.25px;\">On &gt;40% O2</td>\n</tr>\n<tr>\n<td style=\"width: 148.25px;\"><strong>Grunting</strong></td>\n<td style=\"width: 148.25px;\">None</td>\n<td style=\"width: 148.25px;\">Only on auscultation</td>\n<td style=\"width: 148.25px;\">Audible with the naked ear</td>\n</tr>\n<tr>\n<td style=\"width: 148.25px;\"><strong>Retraction</strong></td>\n<td style=\"width: 148.25px;\">Nil</td>\n<td style=\"width: 148.25px;\">Mild</td>\n<td style=\"width: 148.25px;\">Moderate</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f8389224afa548be8afcd8bc995b38c8x1280x1839.JPEG"
    ]
  },
  {
    "text": "True regarding the difference between adult and pediatric resuscitation.",
    "choices": [
      {
        "id": 1,
        "text": "Ventricular dysrhythmias are common in children"
      },
      {
        "id": 2,
        "text": "The no flow phase precedes the period of cardiac arrest in children."
      },
      {
        "id": 3,
        "text": "More ventilation to be given compared to chest compressions in children"
      },
      {
        "id": 4,
        "text": "Dysrhythmias are most often due to respiratory insufficiency in children"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Dysrhythmias</strong> in the pediatric age group are most often the result of <strong>respiratory insufficiency or hypoxia </strong>and&nbsp;<strong>not of primary cardiac causes</strong>, as in adults. <br />Hypoxia, hypercapnia, and acidosis lead to bradycardia, hypotension, and secondary cardiac arrest in children.</p>\n<p>Other options:&nbsp;</p>\n<p>Option A: <strong>Supraventricular tachycardia</strong> is the <strong>most common tachydysrhythmia</strong> that necessitates treatment in <strong>pediatric</strong> patients. Ventricular dysrhythmia&nbsp;is an uncommon presenting rhythm in infants and children.</p>\n<p>Option B: The <strong>pre-arrest phase</strong> is the period that <strong>precedes</strong> the period of <strong>cardiac arrest</strong>.&nbsp;</p>\n<p><strong>Four phases of cardiac arrest</strong> have been described as follows:</p>\n<ul>\n<li>The <strong>prearrest phase</strong>- a period that precedes the period of cardiac arrest.</li>\n<li>The <strong>no-flow phase</strong>- reflects untreated cardiac arrest before it is recognized by a bystander in the community or by a medical provider in the hospital</li>\n<li>The <strong>low-flow phase</strong>- begins with the onset of cardiopulmonary resuscitation (CPR)</li>\n<li>The <strong>post-resuscitation phase</strong> - The post-resuscitation phase begins with the return of spontaneous circulation (ROSC).</li>\n</ul>\n<p>Option C: The <strong>chest compression</strong> to <strong>ventilation ratio</strong> should be <strong>30:2 or 15:2</strong>. Excessive ventilation results in decreased venous return into the chest, decreased coronary and cerebral blood flow, diminished cardiac output, and ultimately a decreased likelihood of return of spontaneous circulation.&nbsp;</p>\n<p>Guidelines for pediatric basic life support:&nbsp;</p>\n<table style=\"height: 199px;\" width=\"665\">\n<tbody>\n<tr>\n<td style=\"width: 159.25px;\">Maneuver</td>\n<td style=\"width: 159.25px;\"><strong>Neonate</strong></td>\n<td style=\"width: 159.25px;\"><strong>Infant &lt;1 year</strong></td>\n<td style=\"width: 159.25px;\"><strong>Child 1 year to puberty</strong></td>\n</tr>\n<tr>\n<td style=\"width: 159.25px;\">Rescue breath</td>\n<td style=\"width: 159.25px;\">30-60/minute (every 1 to 2 seconds)</td>\n<td style=\"width: 159.25px;\">12-20/minute (every 3 seconds)</td>\n<td style=\"width: 159.25px;\">12-20/minute (every 3 seconds)</td>\n</tr>\n<tr>\n<td style=\"width: 159.25px;\">Pulse check site</td>\n<td style=\"width: 159.25px;\">Umbilical</td>\n<td style=\"width: 159.25px;\">Brachial</td>\n<td style=\"width: 159.25px;\">Carotid/femoral</td>\n</tr>\n<tr>\n<td style=\"width: 159.25px;\">Chest compression site</td>\n<td style=\"width: 159.25px;\">one finger below the intermammary line</td>\n<td style=\"width: 159.25px;\">One finger below the intermammary line or lower half of the sternum</td>\n<td style=\"width: 159.25px;\">The lower half of the sternum</td>\n</tr>\n<tr>\n<td style=\"width: 159.25px;\">Compression method</td>\n<td style=\"width: 159.25px;\">Two fingers or two thumb</td>\n<td style=\"width: 159.25px;\">Two fingers or two thumb</td>\n<td style=\"width: 159.25px;\">The heel of one hand or two hands</td>\n</tr>\n<tr>\n<td style=\"width: 159.25px;\">Compression depth</td>\n<td style=\"width: 159.25px;\">One-third of the chest</td>\n<td style=\"width: 159.25px;\">One-third to one-half of the chest</td>\n<td style=\"width: 159.25px;\">One-third to one-half of the chest</td>\n</tr>\n<tr>\n<td style=\"width: 159.25px;\">Compression rate</td>\n<td style=\"width: 159.25px;\">120/minute</td>\n<td style=\"width: 159.25px;\">100/minute</td>\n<td style=\"width: 159.25px;\">100/minute</td>\n</tr>\n<tr>\n<td style=\"width: 159.25px;\">Compression to ventilation ratio</td>\n<td style=\"width: 159.25px;\">3: 1</td>\n<td style=\"width: 159.25px;\">15: 2 (single rescuer - 30: 2)</td>\n<td style=\"width: 159.25px;\">15: 2 (single rescuer - 30: 2)</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f8f37dd5c34b439e9595b38f031a2658x1280x4216.JPEG"
    ]
  }
];
        let quizName = '257 Paediatrics Aiims 2018';
        let hierarchy = ["Marrow", "PYQs", "Pediatrics"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>