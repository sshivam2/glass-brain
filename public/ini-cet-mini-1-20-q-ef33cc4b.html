<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ini-Cet Mini - 1 (20 Q) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Choose the correct statements about 2020 ACLS recommendations for adults.",
    "choices": [
      {
        "id": 1,
        "text": "1, 3 and 5 are correct"
      },
      {
        "id": 2,
        "text": "1 and 4 are correct"
      },
      {
        "id": 3,
        "text": "2, 3 ad 4 are correct"
      },
      {
        "id": 4,
        "text": "3, 4 and 5 are correct"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The 2020 AHA guidelines recommend the following about adult cardiopulmonary resuscitation:</p>\n<ul>\n<li>Double sequential defibrillation for refractory shockable rhythm is<strong> not recommended in all cases</strong><strong>&nbsp;usefulness&nbsp;has not been established.</strong></li>\n<li>Airway management should be prioritized during resuscitation from cardiac arrest in pregnancy as <strong>pregnant patients are more prone to hypoxia.</strong></li>\n<li>Providers should always <strong>try one attempt at IV access before establishing IO</strong> access as the IV route is associated with <strong>better clinical outcomes.</strong>&nbsp;Although IV access is preferred, for situations in which IV access is difficult, IO access is still considered a reasonable option.</li>\n<li><strong>Audiovisual aids are recommended</strong> to ensure <strong>optimum CPR performance</strong> as it has been found to be associated with better outcomes</li>\n<li>For <strong>cardiac arrest with non-shockable rhythms</strong>, it is reasonable to <strong>administer epinephrine as soon as possible</strong>. For cardiac arrest with <strong>shockable rhythms,</strong> epinephrine should be <strong>administered after initial defibrillation attempts have failed</strong></li>\n<li><strong>Laypersons may initiate CPR</strong> for presumed cardiac arrest as the <strong>risk of harm</strong> to the patient not in cardiac arrest is <strong>low</strong> even if they receive chest compressions</li>\n<li>Physiological parameters such as a<strong>rterial blood gas pressure of ETCO2</strong> may be used to monitor and <strong>optimize CPR quality</strong></li>\n<li>Cardiac arrest survivors should have a <strong>multimodal rehabilitation assessment</strong> and treatment of physical, cardiopulmonary, cognitive, and neurological impairments before discharge from the hospital</li>\n<li><strong>Debriefings and referral</strong> for follow up and emotional support for all those involved in resuscitation may be beneficial</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly man with hepatocellular carcinoma is scheduled to undergo a left hepatectomy. Which of the following Couinaud's liver segments will be removed during this procedure?",
    "choices": [
      {
        "id": 1,
        "text": "6, 7"
      },
      {
        "id": 2,
        "text": "5, 6, 7, 8"
      },
      {
        "id": 3,
        "text": "2, 3"
      },
      {
        "id": 4,
        "text": "2, 3, 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The surgical term <strong>left hepatectomy</strong> corresponds to the removal of Couinaud segments <strong>2</strong>, <strong>3</strong>, and\u00a0<strong>4.</strong></p>\n<p>The <strong>Couinaud classification</strong> is a system used to categorize the liver into <strong>two primary functional lobes</strong>: the <strong>left</strong> and <strong>right lobes</strong>. The lobes are further divided into <strong>eight functional segments</strong>, based on hepatic portal venous branches.\u00a0Each of these segments is supported by a <strong>biliary triad</strong> comprising branches from the hepatic artery, portal vein, and bile duct.\u00a0</p>\n<p>The given image shows<strong> Couinauds segments</strong> corresponding to various procedures:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3d8428a36ee44fee901f77dd80da033ex1280x3097.JPEG"
    ]
  },
  {
    "text": "A female patient presents to the OPD with redness of the eye. The examination findings of her eye are shown in the image below. She had been previously diagnosed with glaucoma and was receiving a topical drug. Which of the following drugs is most likely to be implicated in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Pilocarpine"
      },
      {
        "id": 2,
        "text": "Timolol"
      },
      {
        "id": 3,
        "text": "Echothiophate"
      },
      {
        "id": 4,
        "text": "Apraclonidine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><span data-preserver-spaces=\"true\">The image in the above clinical scenario shows <strong>conjunctival hyperemia</strong>. It is the side effect of </span><strong><span data-preserver-spaces=\"true\">apraclonidine</span></strong>.<strong><span data-preserver-spaces=\"true\">\u00a0</span></strong><span data-preserver-spaces=\"true\">It occurs due to an <strong>allergic response</strong> to apraclonidine.\u00a0</span></p>\n<p><span data-preserver-spaces=\"true\">Apraclonidine is an <strong>alpha-adrenergic agonist</strong>. It is used in the treatment of ocular hypertension and <strong>glaucoma</strong>. It is available as a topical preparation of 0.5 and 1% solutions.</span></p>\n<p><span data-preserver-spaces=\"true\">The notable side effects of apraclonidine include <strong>conjunctival hyperemia</strong>, sleepiness, and dry mouth.\u00a0</span></p>\n<p><span data-preserver-spaces=\"true\"><strong>Prostaglandin analogs</strong> like latanoprost and bimatoprost can also be associated with conjunctival hyperemia.</span></p>\n<p><span data-preserver-spaces=\"true\">Other options:</span></p>\n<p><span data-preserver-spaces=\"true\">Option A: <strong>Pilocarpine</strong> is associated with side effects that include corneal edema, miosis, induced myopia associated with decreased vision, brow ache, and retinal detachment</span></p>\n<p><span data-preserver-spaces=\"true\">Option B: <strong>Timolol</strong> is associated with\u00a0exacerbation of respiratory conditions like asthma and chronic obstructive pulmonary disease,\u00a0bradycardia, depression, and impotence.</span></p>\n<p><span data-preserver-spaces=\"true\">Option C: <strong>Echothiophate</strong> is associated with retinal detachment, miosis, cataract, pupillary block, glaucoma, iris cysts, brow ache, and punctal stenosis, which may further result in epiphora.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/af2fd7c4f8ae48f582479a3b7de1436e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "An intern placed an intercostal drainage tube in a patient. Which of the following steps is incorrect?",
    "choices": [
      {
        "id": 1,
        "text": "Identified 5th intercostal space anterior to mid axillary line to place the tube"
      },
      {
        "id": 2,
        "text": "Inserted tube along the lower border of upper rib"
      },
      {
        "id": 3,
        "text": "Directed tube posteriorly to prevent injury"
      },
      {
        "id": 4,
        "text": "Incised and digitally explored"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>An intercostal tube <strong>(ICD)</strong> is placed along the <strong>upper border</strong> of the <strong>lower rib</strong> at the 5th intercostal space (ICS) to prevent damage to the neurovascular bundle. Hence, option B is incorrect.</p>\n<p><strong>Chest tube insertion </strong>(thoracostomy) is <strong>indicated</strong> in <strong>pneumothorax</strong>, hemothorax, chylothorax, and pleural effusion in order to drain air/fluid from the pleural space.</p>\n<p>The <strong>triangle of safety</strong>, usually in the 5th intercostal space, is the <strong>safest site</strong> for chest tube insertion, it is bound by:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">anterior to the midaxillary line</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">above the horizontal line marked by the level of the nipple</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">below and lateral to the pectoralis major muscle</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bbb7828e4d654d018050ab754e95a27dx600x577.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/50dafcb6fb95459fb279a729d959b6bex600x1759.JPEG"
    ]
  },
  {
    "text": "You are a part of a project that involves the quality improvement of patient care in the hospital. The plan of the project is given below. What is the duration of the critical pathway in the project?",
    "choices": [
      {
        "id": 1,
        "text": "2 days"
      },
      {
        "id": 2,
        "text": "10 days"
      },
      {
        "id": 3,
        "text": "11 days"
      },
      {
        "id": 4,
        "text": "13 days"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The critical pathway would take<strong> 11 days</strong>\u00a0in the given project plan.\u00a0</p>\n<p>The<strong> critical path</strong> is the<strong> longest path</strong> in the <strong>network analysis</strong>.\u00a0Any delay in the critical path will delay the entire project. Here, the<strong> longest pathway</strong> consists of \"Start---&gt; task B---&gt; task C---&gt; Finish,\" which is (5+6)\u00a0<strong>11 days</strong>.</p>\n<p>Although\u00a0<strong>task D</strong> is the longest <strong>activity taking 7 days</strong>, it is <strong>not</strong> the longest <strong>pathway</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1e71799f286e49cba4ff5eecebfcb4e7.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old lady presented to you with purplish, itchy bumps on her shins along with findings in the buccal mucosa as shown. Which of the following drugs are used as first-line treatment for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 5"
      },
      {
        "id": 2,
        "text": "2, 3, 4, 5"
      },
      {
        "id": 3,
        "text": "1, 2, 3, 4"
      },
      {
        "id": 4,
        "text": "1, 4, 5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario, with an image showing <strong>lacy white streaks</strong> in the buccal mucosa, suggests <strong>oral lichen planus</strong>.<strong> Clobetasol propionate ointment</strong>,<strong> soluble betamethasone tablets</strong>,<strong> </strong>and<strong> oral prednisolone</strong> (1, 3, and 5) <span data-preserver-spaces=\"true\">are first-line drugs for treating oral lichen planus.\u00a0</span></p>\n<div class=\"page\" title=\"Page 1186\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Lichen planus (LP) is an idiopathic inflammatory skin disease that affects the skin and mucosa. It usually follows a chronic course with periods of relapse and remission.</p>\n</div>\n</div>\n</div>\n</div>\n<p><span data-preserver-spaces=\"true\">The most common presentation of lichen planus on the skin is a patch of itchy, firm, purple-red-colored, flat-topped papules with <strong>lacy white lines</strong> on the surface known as <strong>Wickham's striae</strong>. This description is known as the characteristic \"<strong>6 Ps</strong>\" of lichen planus: planar (flat-topped), purple, polygonal, pruritic, papules, and plaques.</span></p>\n<p>On the buccal mucosa, the lesions are characteristically thin white reticular streaks, while on the tongue, they are seen as fixed white plaques.</p>\n<p>Treatment of oral lichen planus:</p>\n<ul>\n<li>First Line\n<ul>\n<li>Clobetasol propionate ointment\u00a0</li>\n<li>Soluble prednisolone tablets, 5 mg in 15 mL water for mouthwash\u00a0</li>\n<li>Betamethasone soluble tablets in water for mouthwash</li>\n<li>Oral prednisolone for severe erosive lichen planus</li>\n</ul>\n</li>\n<li>Second Line\n<ul>\n<li><strong>Topical</strong> retinoids like <strong>retinoic</strong> acid or isotretinoin</li>\n<li>Oral prednisolone</li>\n</ul>\n</li>\n<li>Third line\n<ul>\n<li>Cortico-dependent or cortico-resistant erosive LP: systemic immunosuppressive agents like <strong>azathioprine</strong>, mycophenolate mofetil, methotrexate, cyclosporin, and topical ciclosporin.</li>\n</ul>\n</li>\n</ul>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/459d5f0c2a7a4d49815946f07c346c50.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A pregnant lady with a gestation of 8 weeks comes to your clinic. While examining her, you notice she has severe acne. She tells you she has been taking oral medication and was advised to avoid excessive sun exposure while taking this drug. Which of the following is not a potential teratogenic effect of this drug?",
    "choices": [
      {
        "id": 1,
        "text": "Ventriculomegaly"
      },
      {
        "id": 2,
        "text": "Cleft palate"
      },
      {
        "id": 3,
        "text": "Macrognathia"
      },
      {
        "id": 4,
        "text": "Microtia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Oral medication</strong> for <strong>acne</strong>\u00a0is likely to be\u00a0<strong>isotretinoin. Macrognathia</strong> is not a potential teratogenic effect of isotretinoin.</p>\n<p><strong>Vitamin A\u00a0</strong>derivatives(isotretinoin, acitretin) belong amongst the drugs with <strong>high teratogenic</strong> effects. They result in <strong>retinoic acid embryopathy</strong> by inhibiting neural crest cell migration during <strong>embryogenesis</strong>. This causes cranial neural crest defects involving the <strong>central nervous system</strong>, <strong>face</strong>, <strong>thymus,</strong> and <strong>heart</strong>.\u00a0</p>\n<p><strong>Specific anomalies\u00a0</strong>include</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Ventriculomegaly</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Maldevelopment of the facial bones and cranium</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Microtia</strong> or anotia</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Micrognathia</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Cleft palate</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Conotruncal heart defects</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Thymic aplasia or hypoplasia</li>\n</ul>\n<p><strong>Systemic retinoids</strong> are <strong>highly teratogenic\u00a0</strong>and are absolutely contraindicated in\u00a0pregnant women, those planning to become pregnant, or breastfeeding mothers. Two negative pregnancy tests (on separate occasions) are required for females of childbearing age before starting acitretin or isotretinoin.</p>\n<p><strong>Baseline evaluation</strong> of serum <strong>lipids</strong>, <strong>transaminases</strong>, and <strong>CBC</strong> should be done before starting any systemic retinoids. These values should be checked <strong>monthly</strong> for the <strong>first 3\u20136 months</strong> and<strong> once every 3 months</strong> thereafter.\u00a0<strong>Monthly pregnancy tests</strong> should be done while on the drug.\u00a0Female patients should\u00a0<strong>avoid</strong>\u00a0<strong>conception</strong>\u00a0for<strong>\u00a03 years</strong>\u00a0after discontinuing acitretin treatment for cutaneous psoriasis.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 7-month-old child was brought by her mother with complaints of diarrhea and mucocutaneous lesions as shown in the image. The symptoms have been present since weaning was started. The mineral deficient in this child is a cofactor of many biological enzymes. Which of the below-listed enzymes use this essential mineral as its co-factor?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3, 4, 5"
      },
      {
        "id": 2,
        "text": "1, 2, 3, 4 only"
      },
      {
        "id": 3,
        "text": "1, 4, 5 only"
      },
      {
        "id": 4,
        "text": "2, 3 only"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span data-preserver-spaces=\"true\">A child with&nbsp;</span><strong><span data-preserver-spaces=\"true\">eczematous rash</span></strong><span data-preserver-spaces=\"true\">&nbsp;typically in the&nbsp;</span><strong><span data-preserver-spaces=\"true\">perioral and perineal</span></strong><span data-preserver-spaces=\"true\">&nbsp;region and&nbsp;</span><strong><span data-preserver-spaces=\"true\">diarrhea</span></strong><span data-preserver-spaces=\"true\">&nbsp;is characteristic of&nbsp;</span><strong><span data-preserver-spaces=\"true\">acrodermatitis enteropathica</span></strong><span data-preserver-spaces=\"true\">&nbsp;which is due to&nbsp;</span><strong><span data-preserver-spaces=\"true\">secondary zinc deficiency. Zinc is an important co-factor for enzymes 1, 2, 3, and 4.</span></strong></p>\n<p><span data-preserver-spaces=\"true\">Zinc is a component of many metalloenzymes including:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Carbonic anhydrase II</span></li>\n<li><span data-preserver-spaces=\"true\">Carboxypeptidase A</span></li>\n<li><span data-preserver-spaces=\"true\">Alcohol dehydrogenase</span></li>\n<li><span data-preserver-spaces=\"true\">Adenosine deaminase</span></li>\n<li><span data-preserver-spaces=\"true\">Alkaline phosphatase</span></li>\n<li><span data-preserver-spaces=\"true\">Phospholipase C</span></li>\n<li><span data-preserver-spaces=\"true\">Superoxide dismutase</span></li>\n</ul>\n<p><span data-preserver-spaces=\"true\">Zinc also has&nbsp;</span><strong><span data-preserver-spaces=\"true\">antioxidant activity</span></strong><span data-preserver-spaces=\"true\">&nbsp;as extracellular superoxide dismutase is zinc-dependent.</span></p>\n<p><span data-preserver-spaces=\"true\">&nbsp;</span></p>\n<p><span data-preserver-spaces=\"true\">Selenium is the co-factor for the de-iodinase enzyme.&nbsp;</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/93e3e53938184ba0b2f1dc3e7cc65b89.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a4fdc41f218f4eb5978ce89bd903acdfx1280x1610.JPEG"
    ]
  },
  {
    "text": "A male patient was brought to the emergency room after a road traffic accident. He produces unrecognizable sounds only, opens his eyes only to a painful stimulus and his right pupil alone is unreactive to light. His posture on the bed is shown below.  What is this patient's calculated GCS-P score?",
    "choices": [
      {
        "id": 1,
        "text": "5"
      },
      {
        "id": 2,
        "text": "4"
      },
      {
        "id": 3,
        "text": "6"
      },
      {
        "id": 4,
        "text": "7"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above patient has a <strong>GCS-P score of 6</strong> which is calculated as follows.</p>\n<p>The score for eye-opening - opens only to painful stimulus - 2<br />The score for verbal response - sounds only - 2<br />The score for motor response - decorticate posturing - 3<br />Pupillary score - one pupil non-reactive - 1</p>\n<p><strong>GCS-P score -&nbsp;</strong></p>\n<p>It is the Glasgow Coma Scale score with the incorporation of pupillary function. The pupillary function was added so that the brainstem function is also represented by the score.&nbsp;</p>\n<p>The total score is calculated by adding the score for eye-opening, verbal, and motor responses and <strong>subtracting the pupil score from the sum.</strong></p>\n<p>Total score = 2 + 2 + 3 - 1 = 6</p>\n<p><strong>Decorticate posture:</strong></p>\n<ul>\n<li>The&nbsp;<strong>upper limbs are flexed</strong>, the&nbsp;<strong>lower limbs</strong>&nbsp;are&nbsp;<strong>extended</strong>&nbsp;with toes pointed slightly inward, and the head is extended.</li>\n<li>Decorticate posturing is given a score of&nbsp;<strong>3</strong>&nbsp;in best motor response in Glasgow Coma Scale.</li>\n</ul>\n<p><strong>Decerebrate posture:</strong></p>\n<ul>\n<li>Here,&nbsp;<strong>lower extremities are extended</strong>&nbsp;with toes pointed inward and&nbsp;<strong>upper extremities</strong>&nbsp;<strong>extended</strong>&nbsp;with&nbsp;<strong>fingers flexed</strong>&nbsp;and forearms pronated. The neck and head are extended.&nbsp;</li>\n<li>Decerebrate posture has a score of&nbsp;<strong>2&nbsp;</strong>in best motor response on the Glasgow Coma Scale.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/63c143f67fa748deb8cc8a100e1f6125.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/08b33179f1d54b5e990b756216b4cda6x1280x1314.JPEG"
    ]
  },
  {
    "text": "Reflex responsible for tachycardia during right atrial distension is:",
    "choices": [
      {
        "id": 1,
        "text": "Bezold-Jarisch reflex"
      },
      {
        "id": 2,
        "text": "Bainbridge reflex"
      },
      {
        "id": 3,
        "text": "Cushing reflex"
      },
      {
        "id": 4,
        "text": "J reflex"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Reflex responsible for tachycardia during right atrial distension is&nbsp;<strong>Bainbridge Reflex.</strong></p>\n<p>The <strong>stretch receptors</strong> of the atria that&nbsp;elicit the Bainbridge reflex transmit their afferent signals&nbsp;through the <strong>vagus nerves</strong> to the medulla of the brain.&nbsp;Then efferent signals are transmitted back through <strong>vagal&nbsp;and sympathetic nerves</strong> to increase heart rate and strength&nbsp;of heart contraction. Thus, this reflex helps prevent&nbsp;damming of blood in the veins, atria, and pulmonary&nbsp;circulation.</p>\n<p><strong>Other options:</strong></p>\n<p><strong>Option A: Bezold&ndash;Jarisch Reflex:&nbsp;</strong>Activation of chemosensitive<strong> vagal C fibers</strong> in the cardiopulmonary region causes profound <strong>brady&shy;cardia, hypotension and a brief period of apnoea </strong>followed by rapid shallow breathing.</p>\n<p><strong>Option C: Cushing</strong> <strong>Reflex</strong>:&nbsp;When intracranial&nbsp;pressure<strong>&nbsp;is increased</strong>, the blood supply to Rostral&nbsp;Ventro-Lateral Medulla (RVLM) neurons is compromised.&nbsp;The local hypoxia and hypercapnia cause an increase in discharge from the neurons, producing <strong>hypertension, bradycardia, and irregular respiration.</strong></p>\n<p><strong>Option D: J Reflex:&nbsp;</strong>The stimulation of the J-receptors (C receptors/juxta-pulmonary capillary receptors) causes apnea followed by <strong>rapid breathing, bradycardia,</strong> and<strong> hypotension.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient comes with a complaint of vertigo in a certain head position. She denies any ear fullness or hearing loss. A Dix-Hallpike maneuver confirms the diagnosis and an Epley's maneuver is performed to treat her condition. The symptoms are relieved due to the repositioning of otoconial debris from?",
    "choices": [
      {
        "id": 1,
        "text": "Posterior semicircular canal to utricle"
      },
      {
        "id": 2,
        "text": "Utricle to saccule"
      },
      {
        "id": 3,
        "text": "Utricle to posterior semicircular canal"
      },
      {
        "id": 4,
        "text": "Saccule to utricle"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario of a patient with vertigo and a positive Dix-Hallpike test is suggestive of <strong>benign positional paroxysmal vertigo</strong> (BPPV). The otoconial debris are repositioned from the<strong>&nbsp;posterior semicircular canal to the utricle</strong>&nbsp;to relieve the symptoms of BPPV.</p>\n<p>BPPV is one of the common causes of&nbsp;<strong>recurrent vertigo</strong>, and the episodes are brief (&lt;1min) and are always&nbsp;<strong>provoked</strong>&nbsp;by&nbsp;<strong>changes</strong>&nbsp;in&nbsp;<strong>head position.</strong>&nbsp;The attacks are caused by free-floating calcium carbonate crystals usually dislodged from the posterior canal.&nbsp;</p>\n<p>A positive Dix-Hallpike maneuver confirms the diagnosis of BPPV. It is due to otoconial debris getting into the posterior semicircular canal from the utricle. The patient complains of vertigo on moving or tilting the head to the affected side. In up to 90 percent of the patients, it can be relieved by administering a therapeutic Epley's maneuver on the affected side.</p>\n<p>The Epley's maneuver consists of five positions:</p>\n<table style=\"width: 327px; height: 417px;\">\n<tbody>\n<tr>\n<td style=\"width: 65px;\">&nbsp;</td>\n<td style=\"width: 129px;\"><strong>Head and neck</strong></td>\n<td style=\"width: 111px;\"><strong>Body position</strong></td>\n</tr>\n<tr>\n<td style=\"width: 65px;\"><strong>Position 1</strong></td>\n<td style=\"width: 129px;\">Head turned 45&deg;</td>\n<td style=\"width: 111px;\">&nbsp;to lie down in a head-hanging position</td>\n</tr>\n<tr>\n<td style=\"width: 65px;\"><strong>Position 2</strong></td>\n<td style=\"width: 129px;\">Head turned with<br />affected ear up</td>\n<td style=\"width: 111px;\">-</td>\n</tr>\n<tr>\n<td style=\"width: 65px;\"><strong>Position 3</strong></td>\n<td style=\"width: 129px;\">The whole body and head rotated away from the affected ear in a face-down position</td>\n<td style=\"width: 111px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 65px;\"><strong>Position 4</strong></td>\n<td style=\"width: 129px;\">Head still turned to unaffected side by&nbsp;45&deg;</td>\n<td style=\"width: 111px;\">Brought to sitting position</td>\n</tr>\n<tr>\n<td style=\"width: 65px;\"><strong>Position 5</strong></td>\n<td style=\"width: 129px;\">Head turned forward with chin brought down 20&deg;</td>\n<td style=\"width: 111px;\">-</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/700a367421f14d5a8c4152444ddda54fx1280x2095.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f2f376f96384bb9acee0223ef3e846cx1280x2359.JPEG"
    ]
  },
  {
    "text": "A 34-year-old man has been bitten by a wild dog resulting in multiple, deep lacerated wounds on his leg left. He has a record of previous complete pre-exposure vaccination against rabies that he had taken 6 months back. He presents at the district hospital where you provide him with the appropriate management which should include:",
    "choices": [
      {
        "id": 1,
        "text": "1 and 5 only"
      },
      {
        "id": 2,
        "text": "2, 3, 5"
      },
      {
        "id": 3,
        "text": "1, 2, 3, 4, 5"
      },
      {
        "id": 4,
        "text": "1, 2, 3, 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The patient in the scenario above has been bitten by a wild dog resulting in a category III wound and has a record of previous complete pre-exposure vaccination against rabies that he had taken 6 months back. For such a rabies-exposed person who has documentation of previous complete rabies vaccination(&gt;3 months old), a booster dose of\u00a0<strong>IM/ID</strong>\u00a0vaccination is sufficient on\u00a0<strong>days 0 and 3.</strong></p>\n<p>Rabies\u00a0<strong>immunoglobulin</strong>\u00a0is<strong>\u00a0not indicated</strong>\u00a0in such cases\u00a0because an <strong>anamnestic response will follow the administration of a booster</strong> regardless of the pre-booster antibody titer.</p>\n<p>Proper wound care is essential in all dog bite cases. Washing with soap and water followed by application of antiseptic agent (Any virucidal agent like povidone-iodine, alcohol, etc) is to be done.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old male patient comes to the OPD with a fever. The fever is high-grade and started with a sudden onset 24 hours ago. He also complains of severe headache, retroorbital pain, and myalgias with nausea and vomiting. His appetite is reduced. On examination, his temperature is 100.4 F, pulse rate is 100 bpm and BP is 110/70 mm of Hg. There are multiple small vesicles on the hard palate. Which of the following is the least useful for diagnosing dengue fever in this patient if blood samples are drawn in this visit?",
    "choices": [
      {
        "id": 1,
        "text": "NS1 antigen detection"
      },
      {
        "id": 2,
        "text": "Viral culture and isolation in aedes albopticus c6/36 cell line"
      },
      {
        "id": 3,
        "text": "RT-PCR"
      },
      {
        "id": 4,
        "text": "ELISA for IgG antibody against dengue virus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>On <strong>day 2</strong> of presentation,&nbsp;<strong>ELISA for IgG antibody</strong> against dengue virus is <strong>not advised.</strong></p>\n<p>This patient's presentation of fever with myalgias (<strong>break-bone fever</strong>), retroorbital pain, headache, and palatal vesicles are all seen in Dengue fever. There might be a transient macular rash and cervical lymphadenopathy on day 1. A maculopapular rash beginning in the trunk and spreading to the extremities and face may be seen around the time of defervescence (3-5 days).</p>\n<p>Dengue fever is caused by the <strong>Dengue viruses 1-4</strong> belonging to the genus <strong>Flavivirus</strong> transmitted by the bite of the Aedes mosquito.&nbsp;<strong>ELISA</strong>&nbsp;against <strong>Dengue antibodies</strong>&nbsp;can detect IgM and IgG separately. IgM appears early by 3-5 days of fever (can persist up to 90 days), followed by the appearance of IgG by the end of one week and peaking around 14-21 days of illness.</p>\n<p>However, this patient has symptoms for less than 2 days and IgM ELISA might give a false negative result. Further, the IgG ELISA may give a false-positive result due to cross-reactivity of the&nbsp; Dengue viruses with other members of the Flavivirus genus.</p>\n<p><strong>NS1 antigen</strong>&nbsp;is a non-structural viral protein antigen that is detectable from<strong> day one of fever.</strong> It is highly specific for dengue.</p>\n<p>Dengue virus can be detected from blood <strong>one day before</strong> the onset of symptoms by <strong>viral culture</strong> after inoculation into mosquito cell line or detection of specific genes of viral RNA by <strong>real-time RT-PCR.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient has been bitten by a snake, and the relatives have brought the snake with them. Which of the following findings will assure you that the snake is non-poisonous?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 4"
      },
      {
        "id": 2,
        "text": "2, 3 , 5"
      },
      {
        "id": 3,
        "text": "2, 4, 5"
      },
      {
        "id": 4,
        "text": "1, 4, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Solid</strong> and <strong>short fangs</strong>, <strong>incomplete belly scales</strong> that <strong>do not cover the entire breadth,</strong> and bite wound showing a\u00a0number of <strong>small teeth marks in a row</strong> are usually seen with <strong>non-poisonous snakes</strong>.</p>\n<p>A conspicuous <strong>pit</strong> between the eye and nostril is mostly seen in <strong>pit vipers</strong>, which are <strong>poisonous</strong>. Other features of poisonous snakes include\u00a0<strong>small head scales</strong>, large belly scales that cover the <strong>entire belly</strong>, and<strong> long </strong>and <strong>canalized fangs</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the following.",
    "choices": [
      {
        "id": 1,
        "text": "A- Cancellous screw; B - Malleolar screw; C - Cortical screw"
      },
      {
        "id": 2,
        "text": "A- Malleolar screw; B - Cancellous screw; C - Cortical screw"
      },
      {
        "id": 3,
        "text": "A- Malleolar screw; B - Cortical screw; C - Cancellous screw"
      },
      {
        "id": 4,
        "text": "A- Cancellous screw; B - Cortical screw; C - Malleolar screw"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given image:\u00a0</p>\n<ul>\n<li><strong>A</strong> represents a <strong>malleolar screw</strong></li>\n<li><strong>B</strong> represents a <strong>cortical screw</strong></li>\n<li><strong>C</strong> represents a <strong>cancellous screw</strong></li>\n</ul>\n<p>Identification features of the screws are as follows:</p>\n<p><strong>Malleolar screw</strong>: Modified cancellous screw with a\u00a0<strong>sharp-pointed tip</strong>. It\u00a0can be inserted without pre-drilling. These screws are used for internal fixation of malleolar fractures.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6228bcf33ce34759866899ebed257f24.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2fe729782c1644d8a16c6fb7869213b1x387x480.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ca508689f7284dec8209e099fbaf49fdx387x480.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b6e7ea29ee8a4f928b767c60b82a32d2x387x480.JPEG"
    ]
  },
  {
    "text": "An 8-year-old child is brought to the casualty after a minor accident that occurred when he failed to see a bike coming from sideways. His mother says he is a clumsy child, who sometimes knocks things over accidentally even at home. Visual field examination findings are given below. On imaging, an intracranial mass is seen. The resected specimen shows cholesterol-rich machinery-oil-like fluid. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Prolactinoma"
      },
      {
        "id": 2,
        "text": "Adamantinomatous craniopharyngioma"
      },
      {
        "id": 3,
        "text": "Ependymoma"
      },
      {
        "id": 4,
        "text": "Meningioma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Patients with <strong>adamantinomatous craniopharyngioma</strong> present with <strong>bitemporal hemianopia</strong> (image), and the cystic component of this tumor contains a cholesterol-rich, thick, brownish-yellow fluid that is comparable to \"machine oil.\"</p>\n<p>Craniopharyngiomas&nbsp;develop from remnants of the Rathke pouch.&nbsp;Adamantinomatous variant of craniopharyngioma predominates in childhood.</p>\n<p>These tumors are usually large and heterogeneous, displaying both<strong> solid</strong> and<strong> cystic</strong> components, and occur in the <strong>suprasellar</strong> region.&nbsp;Patients usually present with headache and visual field abnormalities. These children also have endocrinological abnormalities such as growth failure and delayed sexual maturation due to hypopituitarism (GH deficiency).</p>\n<p>These tumors are minimally invasive, adhere to the adjacent brain parenchyma, and engulf normal brain structures.&nbsp;CT may show <strong>calcifications</strong> associated with the solid and cystic components.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c200d9a4af6e42358969df606bdeb37e.png"
    ],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old child is brought to the clinic for evaluation for recurrent hemiparesis. The child has also had two episodes of seizures in the last six months. On examination, the child is short-statured. There is associated motor weakness. Laboratory examination shows lactic acidosis, and muscle biopsy appears as shown below with Gomori trichrome stain. What is the likely mode of inheritance of this disorder?",
    "choices": [
      {
        "id": 1,
        "text": "Condition is not inherited"
      },
      {
        "id": 2,
        "text": "Autosomal dominant"
      },
      {
        "id": 3,
        "text": "X linked dominant"
      },
      {
        "id": 4,
        "text": "Mitochondrial"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">The given clinical complex is suggestive of <strong>mitochondrial encephalomyopathy with lactic acidosis and stroke-like episodes (MELAS)</strong>. The patient presents in childhood, with classical features of hemiparesis and hemianopia, suggestive of stroke-like episodes. The histopathology of the muscle biopsy stained with <strong>Gomori-trichrome stain</strong> shows <strong>ragged red fibers</strong>. This disease has a mitochondrial inheritance.</span></div>\n<div>&nbsp;</div>\n<div><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">In </span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>mitochondrial&nbsp;</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>inheritance</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">, if the&nbsp;</span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>mother is affected&nbsp;</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">and the </span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>father is normal</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">, then </span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>all their children&nbsp;</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z h-lparen\">(both&nbsp;</span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">male and female) </span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\"><strong>will be affected</strong></span><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">. However, children born to an affected father and a normal mother will not be affected.</span></div>\n<div>&nbsp;</div>\n<div><span class=\" author-d-1gg9uz65z1iz85zgdz68zmqkz84zo2qoxwyy7z90zx1z73zz86z8z72z3z70zvjbz81zz122znz90zz74z1z78zz67zz66zz122zz83zjz73ziz69z\">The mitochondrial inheritance pattern is as shown in the image below:</span></div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/04ba5a5e1f844bcbbffccc58eaf89729.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d182e582d6ff49818ad6fd95f2ee88a4x720x475.JPEG"
    ]
  },
  {
    "text": "Which among the following demonstrates Water\u2019s view?",
    "choices": [
      {
        "id": 1,
        "text": "Image 2"
      },
      {
        "id": 2,
        "text": "Image 1"
      },
      {
        "id": 3,
        "text": "Image 3"
      },
      {
        "id": 4,
        "text": "Image 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Image 1 demonstrates <strong>Waters' view</strong>.</p>\n<p>Waters\u2019 view (<strong>occipitomental view</strong> or nose-chin position) is taken such that the patient is erect and facing the detector with the <strong>chin raised</strong>. The <strong>orbitomeatal line</strong> should be at an angle of <strong>37\u00b0 from the receptor</strong>.</p>\n<p>Structures seen in this view are:</p>\n<ul>\n<li><strong>Maxillary sinuses (seen best</strong>)</li>\n<li>Frontal sinuses</li>\n<li><strong>Sphenoid sinus</strong> (if taken with the <strong>mouth open</strong>).</li>\n<li>Zygomatic arch</li>\n<li>Nasal bone</li>\n<li>Frontal process of maxilla</li>\n<li>Superior orbital fissure</li>\n<li>Infratemporal fossa.</li>\n</ul>\n<p>Indications:</p>\n<ul>\n<li>Acute sinusitis</li>\n<li>Facial fractures</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/48ee56d03c4e4dd184f11e1640a3e8e9.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/06fcbe49b70c40d5a7e2f57f71320659x920x601.PNG"
    ]
  },
  {
    "text": "A 42-year-old diabetic male has been in the post-operative surgery ward with a central line inserted for the past 8 days. He develops a high-grade fever, cough, confusion and his respiratory rate is 32/minute and BP is 100/70 mm Hg. Laboratory results show raised blood counts and 1,3 Beta D Glucan levels of\u00a0\u226580 pg/mL. Which of the following organisms is not a likely cause of his condition?",
    "choices": [
      {
        "id": 1,
        "text": "Invasive aspergillosis"
      },
      {
        "id": 2,
        "text": "Invasive candida infection"
      },
      {
        "id": 3,
        "text": "Invasive cryptococcosis"
      },
      {
        "id": 4,
        "text": "Disseminated pneumocystis infection"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given diagnostic assay&nbsp;<strong>1,3 beta D Glucan assay&nbsp;</strong>levels of<strong>&nbsp;&ge;80 pg/mL&nbsp;</strong>is considered&nbsp;<strong>positive</strong>. <strong>Invasive cryptococcosis</strong> is&nbsp;<strong>not&nbsp;</strong>detected by this assay. &nbsp;</p>\n<p>The given scenario can be a case of invasive fungal infection (candida, aspergillus ) which can occur in post-operative cases through contaminated central lines.</p>\n<p>1,3-&beta;-d-glucan (BDG) is a cell wall polysaccharide found in most fungi, more commonly in&nbsp;<strong>candida, aspergillus and pneumocystis jiroveci</strong>. &nbsp;</p>\n<p>However, it is not used in the diagnosis of cryptococci, the zygomycetes, and Blastomyces dermatitidis, which either lack the glucan entirely or produce it at minimal levels. &nbsp;</p>\n<p>This assay is a chromogenic,&nbsp;<strong>quantitative enzyme immunoassay</strong>&nbsp;(EIA) designed to detect beta D Glucan by using purified, lysed horseshoe crab (Limulus polyphemus) amebocytes. These cells contain components of the&nbsp;<em>Limulus</em>&nbsp;clotting cascade, including factors C and G, which initiate coagulation in the presence of bacterial liposaccharide and Beta D Glucan, respectively. By eliminating factor C from the lysate, the manufacturers limit activation of the cascade to BDG alone. &nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 39-year-old man presents for a health check-up, during which the doctor finds that he is reluctant to talk about his illnesses. He is suspicious that the information will be used to harm him. He does not trust his family either for the same reason. He does not forgive easily and bears grudges. What is the type of personality disorder that he has?",
    "choices": [
      {
        "id": 1,
        "text": "Schizoid personality disorder"
      },
      {
        "id": 2,
        "text": "Schizotypal personality disorder"
      },
      {
        "id": 3,
        "text": "Paranoid personality disorder"
      },
      {
        "id": 4,
        "text": "Histrionic personality disorder"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given history of long-standing suspiciousness, not trusting people,<strong> </strong>and bearing grudges for insults is suggestive of <strong>paranoid personality disorder.</strong></p>\n<p><strong>Paranoid personality disorder</strong>, a part of <strong>cluster A</strong> personality disorders,\u00a0is characterized by pervasive<strong>\u00a0suspiciousness and mistrust</strong> in all interpersonal relationships. They are excessively fearful of <strong>perceived threats</strong> and deceit and often read hidden demeaning or <strong>threatening meanings</strong> into benign remarks. They are <strong>reluctant to</strong> <strong>confide</strong> in others due to the fear that the information they provide will be used against them maliciously.</p>\n<p>They tend to be <strong>extremely jealous,</strong>\u00a0<strong>hostile, argumentative,</strong>\u00a0and\u00a0<strong>defensive</strong>. Their paranoia prevents them from establishing any overly involved relationship. They persistently <strong>bear grudges</strong> and can get irritable and angry easily. They use the defense mechanism of <strong>projection</strong>\u00a0by displacing their insecurities on others.\u00a0</p>\n<p>They may not be willing to accept that they need psychiatric help. <strong>Psychotherapy</strong> is the treatment of choice. Care should be taken by the therapist to <strong>not behave defensively</strong> if accused of making a mistake.\u00a0<strong>Pharmacotherapy</strong> is generally used to deal with anxiety and agitation. <strong>Diazepam</strong> is used as an anxiolytic, while antipsychotics like <strong>haloperidol</strong> or <strong>pimozide</strong> may be required to deal with agitation.</p>\n<p>Other options:</p>\n<p>Option A: Individuals with <strong>schizoid personality disorder</strong>\u00a0are usually <strong>eccentric and isolated</strong>. They neither desire nor enjoy close relationships. They always choose to be <strong>alone and lack close friends. </strong>They are <strong>emotionally cold</strong> and appear<strong> indifferent</strong> to praise or criticism.</p>\n<p>Option B: Individuals with <strong>schizotypal personality disorder</strong>\u00a0appear odd and strange to surrounding people. They have <strong>ideas of reference, odd or magical thinking</strong>, <strong>inappropriate or constricted affect</strong>, and suspiciousness.</p>\n<p>Option D: Individuals with <strong>histrionic personality disorder\u00a0</strong>have\u00a0<strong>excessive emotional </strong>and<strong> attention-seeking behaviour</strong>. They are uncomfortable in situations where they are not the centre of attraction. They also have inappropriate, sexually seductive, or provocative behaviour. They try to use their physical appearance to draw others' attention.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Ini-Cet Mini - 1 (20 Q)';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>