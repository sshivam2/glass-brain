<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neet 2021 Mini Test 3  (20 Questions) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following drugs is a soluble guanylate cyclase stimulator that can be used in chronic heart failure with reduced ejection fraction?",
    "choices": [
      {
        "id": 1,
        "text": "Riociguat"
      },
      {
        "id": 2,
        "text": "Vericiguat"
      },
      {
        "id": 3,
        "text": "Omapatrilat"
      },
      {
        "id": 4,
        "text": "Treprostinil"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div><strong>Vericiguat </strong>is an oral\u00a0<strong>soluble guanylate cyclase stimulator</strong> that can be used in the treatment of <strong>chronic heart failure with reduced ejection fraction.</strong></div>\n<div>\u00a0</div>\n<div>By stimulating guanylate cyclase, it enhances the production of cGMP which leads to smooth muscle relaxation and vasodilatation. It also enhances the sensitivity of soluble guanylate cyclase to endogenous NO which further contributes to increased cGMP.\u00a0</div>\n<div>\u00a0</div>\n<div>It <strong>reduces the risk of cardiovascular death</strong> following hospitalization for heart failure in symptomatic chronic heart failure and ejection fraction &lt;45%.</div>\n<div>\u00a0</div>\n<div>Other options:</div>\n<div>\u00a0</div>\n<div>Option A: <strong>Riociguat</strong> is also a <strong>soluble guanylate cyclase stimulator</strong> but it is used in <strong>pulmonary artery hypertension</strong> and not in heart failure.</div>\n<div>\u00a0</div>\n<div>Option C: <strong>Omapatrilat</strong> is a <strong>neprilysin and ACE inhibitor</strong> developed for heart failure that is not used due to the side effect of increased levels of bradykinin.\u00a0</div>\n<div>\u00a0</div>\n<div>Option D: <strong>Treprostinil</strong> is a prostacyclin analog that acts as a <strong>vasodilator</strong> used in the treatment of <strong>pulmonary arterial hypertension.\u00a0</strong></div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year-old boy presented to your clinic with complaints of painful skin eruptions for the past 4 days. They are present on his face, over his wrists, and on the anterior surface of both arms. He also has a fever since yesterday. On examination, pulse rate is 97 beats per minute, BP is 100/70 mm of Hg, and the temperature is 99.8F. The skin eruptions include macules, vesicles, pustules, and crusted lesions. The skin surrounding the lesions is erythematous. There is submandibular and cervical lymphadenopathy. An image of the rash on the face is shown below. On enquiring, the mother says that he has had several episodes of itchy rashes over the last 5 years that are currently seen as dry, scaly, lichenified patches on the flexural surfaces and back.\u00a0What is the most likely diagnosis of the newly formed rash?",
    "choices": [
      {
        "id": 1,
        "text": "Atopic dermatitis"
      },
      {
        "id": 2,
        "text": "Herpes zoster"
      },
      {
        "id": 3,
        "text": "Dermatitis herpetiformis"
      },
      {
        "id": 4,
        "text": "Kaposi varicelliform eruption"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the above case, recurrent itchy, lichenified rashes on the flexural surfaces suggest <strong>atopic dermatitis</strong>. The most probable diagnosis of the new painful eruptions in the setting of preexisting atopic dermatitis is\u00a0<strong>Kaposi varicelliform eruption</strong> or<strong>\u00a0eczema herpeticum.</strong></p>\n<p>Kaposi Varicelliform eruption or Eczema herpeticum refers to widespread cutaneous infection\u00a0with a virus that normally causes localized or mild vesicular eruptions, occurring in a patient with\u00a0pre\u2010existing skin disease.\u00a0</p>\n<p>The <strong>usual causative virus</strong> is <strong>HSV\u20101</strong>. Other viruses that may cause Kaposi varicelliform eruption include HSV-2, VZV, and Coxsackie A.</p>\n<p>The\u00a0<strong>commonest predisposing condition</strong>\u00a0is <strong>atopic dermatitis</strong>,<strong>\u00a0</strong>whereas\u00a0Darier disease and Pemphigus foliaceous are less common predisposing conditions.</p>\n<p>Clinical presentation of Kaposi varicelliform eruption includes-</p>\n<ul>\n<li>Lesions that may be localized or widespread</li>\n<li>Vesicles that erupt in\u00a0massive crops\u00a0for 5 to 7 days\u00a0</li>\n<li>Vesicles that rapidly become pustular or sometimes hemorrhagic. They rupture leaving\u00a0small superficial erosions\u00a0which may then weep and crust</li>\n<li>Skin that is painful\u00a0and erythematous</li>\n<li>Regional lymph nodes that may be enlarged</li>\n<li>High fever that commonly develops 2 or 3 days after the onset of the eruption.</li>\n</ul>\n<p>Localized Kaposi varicelliform eruption may be self-resolving or may be treated with\u00a0oral acyclovir.\u00a0Patients with a widespread disease may need treatment with IV acyclovir.\u00a0\u00a0</p>\n<p>Other options-</p>\n<p>Option A- <strong>Atopic dermatitis</strong> is a recurrent inflammatory skin disorder. In children, it is characterized by dry, scaly, pruritic, excoriated, or lichenified papules, and plaques in flexural areas, back, and neck. This patient's past history is suggestive of atopic dermatitis. However, the newer skin eruption is more characteristic of Kaposi varicelliform eruption.\u00a0</p>\n<p>Option B- <strong>Herpes Zoster</strong>\u00a0or Shingles is a viral infection caused due to the reactivation of the varicella-zoster virus. It typically causes burning, painful vesicles that are usually confined to a single dermatome on one side of the body.\u00a0</p>\n<p>Option C-\u00a0<strong>Dermatitis herpetiformis</strong>\u00a0is a chronic, intensely pruritic, skin condition associated with\u00a0<strong>Celiac disease. </strong>It\u00a0includes intensely pruritic inflammatory papules and vesicles on the forearms, knees, scalp, or buttocks.</p>\n<p>\u00a0</p>\n<div class=\"page\" title=\"Page 606\">\u00a0</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/56ef84d62e5446aab0401a0a3c57fd08.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "An 8-year-old boy is brought with severe pain in his right thigh which has worsened over the last few months. He also has frequent nose bleeds and gets fatigued easily while playing. Examination reveals hepatosplenomegaly. Lab reports show thrombocytopenia and leukocyte assay with low levels of beta-glucosidase activity. What is the inheritance pattern of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "X-linked recessive"
      },
      {
        "id": 2,
        "text": "X-linked dominant"
      },
      {
        "id": 3,
        "text": "Autosomal recessive"
      },
      {
        "id": 4,
        "text": "Autosomal dominant"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of bone pain, epistaxis, hepatosplenomegaly, and <strong>low levels of\u00a0\u03b2-glucosidase</strong> suggests a diagnosis of <strong>Gaucher's disease</strong> that is inherited in an <strong>autosomal recessive</strong> pattern.</p>\n<p>Gaucher's disease is an inborn error of metabolism\u00a0due to the <strong>deficiency</strong> of the enzyme <strong>acid \u03b2-glucosidase.</strong>\u00a0This leads to the <strong>accumulation\u00a0</strong>of\u00a0<strong>glucosylceramide</strong>\u00a0in the cells of the reticuloendothelial system.</p>\n<p>The clinical features result from the accumulation of lipid-laden macrophages in the spleen, liver, bone marrow, bone, and other tissues. It is characterized by <strong>hematologic</strong> abnormalities, <strong>organomegaly</strong>, and <strong>skeletal</strong> <strong>involvement</strong> like bone pain and pathological fractures. There are 3 clinical subtypes :</p>\n<p><strong>Type 1</strong> - presents from early childhood to late adulthood. These patients present with:</p>\n<ul>\n<li>Hepatosplenomegaly</li>\n<li>Bone pain</li>\n<li>Pathological fractures</li>\n<li>Thrombocytopenia</li>\n<li>Chronic fatigue</li>\n<li>Erlenmeyer flask deformity of distal femur</li>\n</ul>\n<p><strong>Type 2</strong> - <strong>acute</strong> <strong>neuronopathic form</strong>. These patients have a rapid neurodegenerative course and present with increased tone, strabismus, and organomegaly. These patients die within 1 year of life.</p>\n<p><strong>Type 3</strong> - juvenile or <strong>subacute neuronopathic form</strong>. It presents in childhood and there is death by 10-15 years of age.</p>\n<p><strong>Gaucher cells</strong>\u00a0are the pathological hallmark of the disease. They are seen in the reticuloendothelial system, especially in the <strong>bone marrow. </strong>It has a <strong>wrinkled paper appearance</strong>\u00a0due to the presence of intracytoplasmic inclusions. The cytoplasm of the Gaucher cell is strongly PAS-positive.</p>\n<p>Gaucher's disease is treated with <strong>enzyme replacement</strong> <strong>therapy</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old motorcycle rider was brought 7 hours after sustaining the following injury in an RTA. On examination, the pulse rate is 120bpm, blood pressure is  80/60mmHg. Distal pulses were not palpable, the limb was cold on touch and paralyzed. The patient couldn't move any of the distal toes. X-ray of the left leg showed a comminuted fracture of the tibia and fibula. As an orthopedic resident on casualty duty, you classify the injury as ____ as per the Gustilo Anderson classification and post it for OT. The consultant surgeon performs a ________. Select the correct set of options.",
    "choices": [
      {
        "id": 1,
        "text": "Type2, debridement and internal fixation and immediate closure"
      },
      {
        "id": 2,
        "text": "Type2, debridement and amputation"
      },
      {
        "id": 3,
        "text": "Type3, debridement and amputation"
      },
      {
        "id": 4,
        "text": "Type4, debridement and reconstruction"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical image shows an open fracture with a wound with extensive soft tissue loss and <strong>periosteal stripping and bone damage belongs to classification III.\u00a0</strong></p>\n<p>The decision to salvage the limb or go for amputation is decided upon by various scores which predict the outcome based on the viability of the limb. Mangled extremity severity score is one such score.</p>\n<p>A score of 6 or less is consistent with the\u00a0salvageable limb. A reconstruction after surgical debridement is a better option here.</p>\n<p>A score of 7 or more is consistent with the limb eventually resulting in amputation.</p>\n<p>Mangled Extremity severity score calculated for this patient is calculated as below:</p>\n<ul>\n<li>Age -45 years (30-50 years) - 1 point</li>\n<li>Shock - Hypotensive - 1 point at least (since the response to fluids is not mentioned)</li>\n<li>Limb ischemia - Cold, pulseless, paralyzed limb - 3*2 points - 6 points</li>\n<li>Skeletal - medium energy injury - multiple fractures -2 points\u00a0</li>\n</ul>\n<p>This totals to about - 10 points. Since it is more than 7, amputation would be a likely option.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e6b10ac5d28745f7a1892bae0c031442.JPG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old baby is brought to you during your rural posting. The child had loose stools for the past 10 days. On examination, there is no fever or associated blood or mucus in stools. Her pulse is 160 bpm and her respiratory rate is 30 per minute. The child doesn't react to your comments and seems lethargic. The skin remains tented after pinching. You ask the mother to make her drink water but the child doesn't readily drink. Which of the following measures would you consider to manage this patient?",
    "choices": [
      {
        "id": 1,
        "text": "1,2,4"
      },
      {
        "id": 2,
        "text": "1,4"
      },
      {
        "id": 3,
        "text": "1,2,3"
      },
      {
        "id": 4,
        "text": "2,3"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The child in this scenario has <strong>severe dehydration</strong> since the\u00a0child is lethargic, hardly drinks water,\u00a0 and the skin goes back very slowly on the skin pinch test and remains tented. Among the given options-<strong>1,2,3</strong> should be given</p>\n<p>She needs to be treated\u00a0according to WHO Integrated Management of Neonatal and Childhood Diseases (<strong>IMNCI) Protocol, Plan C</strong>. It includes</p>\n<ul>\n<li><strong>IV fluid therapy</strong> at 30ml/kg over \u00bd hour followed by 70ml/kg over 2 \u00bd hours. If dehydration persists, continue IV fluids.</li>\n<li>If dehydration improves, low osmolarity <strong>Oral rehydration fluid</strong> to be given when she accepts oral feeds,\u00a0and</li>\n<li><strong>Zinc</strong> supplementation 20mg/d given for 14 days.</li>\n</ul>\n<p>Note: Children who can drink, even poorly, should be given ORS solution by mouth until the IV drip is running.<br />If IV therapy is not available nearby, health workers who have been trained can give ORS solution by NG tube, at a rate of 20 ml/kg body weight per hour for six hours (total of 120 ml/kg body weight)</p>\n<p><strong>Antimicrobials</strong> are <strong>not needed</strong> in acute diarrhoea (&lt;14 days) unless it is due to amebiasis, giardiasis, cholera, and dysentery.\u00a0</p>\n<p>Diarrhoea may be a manifestation of systemic infection or sepsis. It may be suspected in the presence of poor sucking, abdominal distension,\u00a0fever or hypothermia, fast breathing,\u00a0significant lethargy or inactivity in well-nourished, well-hydrated\u00a0infants. In the presence of these, age-appropriate systemic antibiotics may be given.</p>\n<p>Approach to diarrhoea as per IMNCI PLANS:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f174f3e0e9654f8898e1d3176b16b078x510x428.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/faa30532230b4f2a8f6be81f7d14f35bx1280x601.GIF"
    ]
  },
  {
    "text": "Mrs. Rao, a 50-year-old woman with a 10-day history of nasal discharge, headache that increases on bending down, and pain over the medial canthus, now presents to the outpatient department with high-grade fever and chills, headache, and bilateral proptosis. On further inquiry, it is brought to light that the proptosis began in the right eye, and since yesterday, the left eye has also been affected. On examination, her pulse rate is 56 beats per minute, BP is 150/96 mm of Hg, the temperature is 102F.  There is periorbital edema, proptosis, and ophthalmoplegia. The pupillary response is sluggish. Fundoscopy reveals papilloedema.  Which of the following is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Retinoblastoma"
      },
      {
        "id": 2,
        "text": "Orbital pseudotumor"
      },
      {
        "id": 3,
        "text": "Orbital cellulutis"
      },
      {
        "id": 4,
        "text": "Cavernous sinus thrombosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario, with recurrent episodes of headache and pain over the medial canthus and repeated use of nasal decongestants, suggests that the patient was suffering from&nbsp;sinusitis&nbsp;which has most likely resulted in&nbsp;<strong>cavernous sinus thrombosis.</strong></p>\n<p><strong>Cavernous sinus thrombosis</strong> (CST) is a septic thrombus formed in the cavernous sinus. It spreads from infection of the sinuses, teeth, ears, nose, and skin of the face.&nbsp;The contents of the cavernous venous sinus that may be affected include</p>\n<div class=\"page\" title=\"Page 610\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Cavernous segment of the internal carotid artery</li>\n<li>Perivascular sympathetic plexus</li>\n<li>Abducens nerve (running through the Dorello&rsquo;s canal)</li>\n<li><strong>Oculomotor </strong>nerve, <strong>trochlear </strong>nerve, and the <strong>ophthalmic division</strong> of the trigeminal nerve as part of the <strong>lateral wall</strong>.&nbsp;</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c25595eb48fe41ccae200b63c2aa735ex600x657.JPEG"
    ]
  },
  {
    "text": "Mr. Roy comes with pain, itching, and scant, foul-smelling discharge in his left ear after a vacation in Goa. On examination, the ear canal appears oedematous and inflamed, the tympanic membrane is normal, and there is pain when the auricle is pulled upward. What is the most appropriate management for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Surgical debridement"
      },
      {
        "id": 2,
        "text": "Systemic antibiotics"
      },
      {
        "id": 3,
        "text": "Topical antibiotic solution"
      },
      {
        "id": 4,
        "text": "Nystatin ear ointment"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This clinical vignette is strongly suggestive of <strong>acute otitis externa&nbsp;</strong>and the most appropriate management among the given options is prescribing a <strong>topical antibiotic solution</strong>.</p>\n<div class=\"page\" title=\"Page 651\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Otitis externa is the inflammation of the external auditory canal. It is also called the <strong>swimmer's ear</strong>. The pathogenesis primarily involves the disruption of the skin-cerumen barrier. The factors that may contribute to this include heat and humidity seen during warmer months, maceration of the skin of the ear canal as seen during swimming (which is the likely cause in this patient), alkaline pH, and trauma to the ear canal.&nbsp;</p>\n</div>\n</div>\n</div>\n<p>Examination findings of purulent discharge with the debris, as in this case, are suggestive of a bacterial etiology. The most common bacteriae responsible are&nbsp;<strong>Pseudomonas aeruginosa</strong>,&nbsp;Staphylococcus epidermidis, and&nbsp;Staphylococcus aureus.</p>\n<p>Clinically, otitis externa can be classified into the following based on severity-</p>\n<ul>\n<li>\n<p class=\"bulletIndent1\">Mild disease- characterized by minor discomfort and pruritus. There is minimal canal edema.</p>\n</li>\n<li>\n<p class=\"bulletIndent1\">Moderate disease- characterized by an intermediate degree of pain and pruritus. There is partial canal occlusion.&nbsp;</p>\n</li>\n<li>\n<p class=\"bulletIndent1\">Severe disease- characterized by fever, periauricular erythema, lymphadenopathy, and intense pain. There is complete canal occlusion due to edema.&nbsp;</p>\n</li>\n</ul>\n<p>Treatment-</p>\n<ul>\n<li>Mild to moderate cases are treated using topical solutions containing\n<ul>\n<li>Antibiotics such as ofloxacin, ciprofloxacin, polymyxin B, or neomycin</li>\n<li>Acidifying agents</li>\n<li>Corticosteroids.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>Severe otitis externa is managed with systemic antibiotics or wick placement.&nbsp;</li>\n</ul>\n<p>This patient with pruritis, mild pain, and partial canal occlusion due to edema has <strong>moderate otitis externa</strong>. Therefore, <strong>antibiotic drops after aural toilet</strong> by&nbsp;dry mopping, suction clearance, or irrigating the canal with warm, sterile normal saline&nbsp;are the most appropriate course of management.&nbsp;</p>\n<p>Other options-</p>\n<p>Options A and B- <strong>Surgical debridement</strong> along with <strong>systemic antibiotics</strong> may be required in <strong>malignant otitis externa</strong>. It is a severe, fatal complication of acute bacterial otitis externa which is seen in elderly diabetics and immunocompromised individuals. It occurs when the infection spreads to the surrounding soft tissue, cartilage, and skull bones. On examination, the skin of the ear canal appears completely necrotic and granulation tissue is classically seen at the bony-cartilaginous junction of the external canal.&nbsp;</p>\n<div class=\"page\" title=\"Page 651\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 652\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 652\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Option D- <strong>Nystatin</strong> ear ointment or other topical antifungals are used in the management of <strong>otomycosis</strong>. Otomycosis is a fungal infection of the external canal. It is unlikely in this case because otomycosis has characteristic findings such as black spots, or soft white material in the ear canal. It can occur secondarily to a bacterial otitis externa treated with antibiotics.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient was brought to casualty with a history of acute onset of anxiety and hyperactivity. His friend gives a history of substance abuse. On examination, tachycardia, tachypnea, high blood pressure and dilated pupils were noted. The toxicity of which of the following drugs can be suspected in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Benzodiazepines"
      },
      {
        "id": 2,
        "text": "Cannabis"
      },
      {
        "id": 3,
        "text": "Heroin"
      },
      {
        "id": 4,
        "text": "Cocaine"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the given clinical scenario patient presenting with anxiety, hyperactivity, tachycardia, hypertension, and mydriasis with a history of substance abuse points towards a diagnosis of <strong>cocaine</strong> toxicity leading to <strong>sympathetic toxidrome</strong>.</p>\n<p>Cocaine is a <strong>CNS stimulant</strong> obtained from coca plants belonging to the family Erythroxylaceae. It is also known as Coke, snow and white lady. The route of intake is by snorting, IV route and smoking. Tattoos may be made to cover the injection marks.</p>\n<p>It<strong> </strong>inhibits the uptake of dopamine, norepinephrine, and serotonin.</p>\n<p>At lower doses, it leads to alertness but at higher doses, it produces stereotyped behavior, involuntary actions, and paranoia. There is a <strong>transient euphoria</strong>. Tactile hallucinations (Magnan's symptom or cocaine bugs) are characteristic.&nbsp;</p>\n<p>There is a dose-dependent <strong>increase in heart rate </strong>and<strong>&nbsp;blood pressure</strong>. It causes <strong>dilation of pupil</strong>s and is associated with chills and perspiration. In severe cases,<strong> intracranial bleeding </strong>due to increased blood pressure, and <strong>myocardial infarction</strong> due to coronary vasospasm can occur. Ultimately, the patient goes into a stage of depression with loss of reflexes, paralysis of muscles, cardiorespiratory failure, and coma.&nbsp;&nbsp;</p>\n<p>Management - &nbsp;Administration of activated charcoal and gastric lavage with warm water and potassium permanganate in case of ingestion. <strong>Benzodiazepines</strong> to control heart rate/seizures. Amyl nitrite is the antidote given via inhalation. Thiamine 100 mg IV and Naloxone 2 mg IV can also be given.</p>\n<p>Other options:</p>\n<p>Option A - Benzodiazepines is a CNS depressant. They would present with dizziness, diplopia, dysarthria, ataxia and drowsiness. In overdose, respiratory depression and hypotension may occur, unlike the CNS stimulant effects of cocaine.</p>\n<p>Option B - Cannabis acts on THC (tetrahydrocannabinol) receptors. It causes euphoria followed by narcosis. There is inattention, motor incoordination, ataxia, tremors, conjunctival suffusion, and somnolence, unlike cocaine which causes hyperactivity.</p>\n<p>Option C - Heroin (opium) presents with an initial excitement followed by giddiness and headache. There is a fall in BP, heart rate, respiratory rate in the later stages and pupils are constricted.&nbsp;&nbsp;</p>\n<p>The image below shows the <strong><em>Erythroxylum</em> plant:</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/98b1e71928f8480b9877436721ea58a5x800x600.JPEG"
    ]
  },
  {
    "text": "Rama, a 40-year-old female patient came to the hospital with complaints of progressive swelling of the lower limb as shown below. The swelling is more on the distal aspect than proximal and is more at the end of the day. On examination, there is non-pitting edema associated with the thickening of the skin. She says that her place has a lot of people with similar deformities. Which of the following is false regarding this disease?",
    "choices": [
      {
        "id": 1,
        "text": "It is caused due to obstruction of lymphatics by adult worms of Wuchereria bancrofti"
      },
      {
        "id": 2,
        "text": "Culex  mosquito transmits the Wuchereria microfilaria which grow into adults in human"
      },
      {
        "id": 3,
        "text": "Diagnosis can be done by antigen detection using card test and microscopic detection of microfilaria using night-time sample"
      },
      {
        "id": 4,
        "text": "A combination of Ivermectin, DEC and Albendazole is recommended for mass prophylaxis and transmission interruption"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of <strong>lymphatic f</strong><strong>ilariasis.</strong>\u00a0It occurs due to the transmission of stage III\u00a0<strong>filariform larva (not microfilaria)</strong> by the bite of Culex mosquitoes.\u00a0</p>\n<p>The disease <strong>initially</strong> causes <strong>acute attacks</strong> of <strong>lymphangitis</strong> and <strong>lymphadenitis</strong>. Early treatment may even cure the disease.</p>\n<p>As time goes by the <strong>lymphedema worsens</strong> and is associated with thickening of the skin and fibrosis of lymph vessels or blockage by adult worms. Management during the later phase involves the prevention of local infection and disability limitation.</p>\n<p>High yield points to remember:</p>\n<ul>\n<li><strong>W.bancrofti</strong> causes Bancroftian filariasis and is transmitted by C. quinquefasciatus (C. fatigans).\u00a0In India, Wuchereria bancrofti is the commonest cause of filariasis.</li>\n<li><strong>B. malayi</strong> causes Burgian filariasis and the vector is Mansonia mosquito</li>\n<li>It occurs due to transmission of filariform larva (stage III larva), whereas, the microfilaria is the larval stage that circulates in the human blood, which is ingested by mosquito during the blood meal.</li>\n<li>The extrinsic incubation period (duration of the mosquito cycle) is 10-14 days under optimal humidity and temperature</li>\n<li>The reservoir of infection: humans (predominantly in India) and animals\u00b7\u00a0</li>\n</ul>\n<p>Diagnosis:</p>\n<ul>\n<li>Mass blood survey to detect microfilaria in 5-7% of the total population \u2013 done at night time \u2013 10 pm to 4 am (maximum parasite activity at this time)</li>\n<li>The membrane filter concentration (MFC) method is the most sensitive technique, but very-low-density Mf carriers will not be detected\u00b7\u00a0</li>\n</ul>\n<p>Management:</p>\n<ul>\n<li>Use of TDT - Ivermectin + Diethylcarbamazine citrate (DEC) + albendazole \u00a0</li>\n<li>Mass drug administration is done in endemic areas with more than 80% coverage and done for 5-6 years on annual basis. The MDA is done using DEC+ Albendazole or Albendazole + Ivermectin\u00b7\u00a0</li>\n</ul>\n<p>Indicators for lymphatic filariasis under NVBDCP:</p>\n<ul>\n<li>Filarial endemicity rate: Proportion of population showing either microfilaria\u00a0in blood or symptoms of filariasis or both \u00a0</li>\n<li>Microfilaria density: Number of microfilaria/unit volume of blood (20 mm3)</li>\n</ul>\n<p>India accounts for up to 40% of the world's filariasis cases. The majority are transmitted by <strong>Wuchereria bancrofti</strong> (commoner than Brugya malayi). Dedicated efforts have been put by governments to control and eliminate filariasis by mass drug administration of DEC and albendazole for 5 years. It is followed by a transmission assessment survey (TAS) which tests for the presence of filarial antigens in the blood.</p>\n<p>Recently, accelerated efforts have been put towards the elimination of filariasis. A <strong>Triple drug</strong> combination of IDA( <strong>Ivermectin, DEC, and Albendazole</strong>) has been introduced as a faster and effective alternative. A mini-TAS survey is conducted on school-going children.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c3103f2e15c8427e937f1506ff3cb81e.png"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/60e6d14e93db4330a9efb5ff94ae0b2dx513x435.GIF"
    ]
  },
  {
    "text": "A young man who had severe anemia underwent a blood transfusion with packed red blood cells. One hour later he appeared pale and developed fever with chills, flank pain, and dark-colored urine. A direct Coombs test was positive. Which of the following is implicated in this patient's presentation?",
    "choices": [
      {
        "id": 1,
        "text": "Type I hypersensitivity reaction"
      },
      {
        "id": 2,
        "text": "Type II hypersensitivity reaction"
      },
      {
        "id": 3,
        "text": "Type III hypersensitivity reaction"
      },
      {
        "id": 4,
        "text": "Type IV hypersensitivity reaction"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span data-preserver-spaces=\"true\"><strong>Type II hypersensitivity reaction </strong>is implicated in this patient presenting with\u00a0<strong>acute hemolytic transfusion reaction</strong> (AHTR) following blood transfusion. </span><span data-preserver-spaces=\"true\">It occurs most often due to <strong>ABO incompatibility </strong>and commonly occurs</span><span data-preserver-spaces=\"true\">\u00a0due to negligence in patient identification or tube labeling.</span></p>\n<p><span data-preserver-spaces=\"true\">Type II hypersensitivity reaction is antibody-mediated. In <strong>ABO</strong> <strong>incompatibility</strong>, preformed <strong>IgM antibodies</strong> attack the antigens on donor red cells which causes <strong>complement</strong> <strong>fixation</strong>. This results in complement-mediated <strong>lysis</strong>, intravascular hemolysis, and hemoglobinuria. Complement activation produces fever with shaking chills. The patient appears pale due to hemolysis and has acute flank pain with dark-colored urine (hemoglobinuria). </span></p>\n<p><span data-preserver-spaces=\"true\">The <strong>direct Coombs test</strong> is usually <strong>positive</strong>.<strong>\u00a0</strong></span><span data-preserver-spaces=\"true\">Direct<strong> </strong>Coombs<strong> </strong>test/antiglobulin<strong> </strong>test is done on the surface of<strong> </strong>red blood cells<strong>.</strong> The Coombs reagent consists of anti-human antibodies. On combining with the red blood cells,\u00a0the test becomes positive, if there are\u00a0</span><strong>RBC antibodies </strong>present in the sample. This is because the anti-human antibodies in the reagent bind with the human antibodies in the RBCs and form a link.<strong>\u00a0</strong></p>\n<p>Other options:</p>\n<p>Option A: <strong>Type I hypersensitivity</strong> reaction is <strong>IgE mediated</strong>. An anaphylactic<strong>\u00a0blood transfusion reaction</strong> is a type I hypersensitivity reaction. However, it presents within seconds to minutes of blood transfusion with hypotension, urticaria, angioedema, and wheezing.</p>\n<p class=\"p1\">Option C: <strong>Type III hypersensitivity</strong> reaction, also known as <strong>immune complex-mediated</strong> hypersensitivity reaction, occurs when antigen-antibody complexes deposition leads to complement activation. Examples include SLE, serum sickness, and the Arthus reaction.</p>\n<p class=\"p1\">Option D: <strong>Type IV</strong>\u00a0<strong>hypersensitivity</strong> , also known as a <strong>cell-mediated </strong>or <strong>delayed</strong> hypersensitivity reaction, is caused by\u00a0activated T lymphocytes. Examples include contact dermatitis and tuberculin skin testing.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 68-year-old man presents with low backache for three months. On examination, his ankle and knee jerk reflexes were absent. But, pain and temperature sensations were preserved. MRI shows lumbar disc prolapse at L3-L4. What is the diagnosis of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Central cord syndrome"
      },
      {
        "id": 2,
        "text": "Conus medullaris syndrome"
      },
      {
        "id": 3,
        "text": "Cauda equina syndrome"
      },
      {
        "id": 4,
        "text": "Brown-Sequard syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above clinical scenario is suggestive of <strong>cauda equina syndrome </strong>secondary to a <strong>lumbar disc prolapse.</strong></p>\n<p><strong>Compression of the lumbosacral nerve roots</strong> below the level of termination of the spinal cord that is <strong>L1-L2</strong> results in cauda-equina syndrome (CES). Common causes of CES include <strong>ruptured lumbosacral intervertebral disc</strong>, epidural hematoma, vertebral fracture, and compressive tumor.&nbsp;</p>\n<p>Patients with CES usually present with <strong>low back pain</strong>, <strong>asymmetrical weakness</strong>, variable areflexia, diminished sensation in the buttocks and posterosuperior thighs, and perineal region.&nbsp;<strong>Absent</strong> bulbocavernosus, <strong>patellar (knee)</strong>, and <strong>Achilles (ankle) reflexes</strong> are characteristically seen in CES.</p>\n<p><strong>MRI of the entire spine</strong> must be done promptly.</p>\n<p>Management includes starting <strong>dexamethasone</strong> immediately, radiation therapy plus glucocorticoids in case of spinal cord compression, and surgical decompression by laminectomy or diskectomy for disc rupture.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Central cord syndrome</strong> results due to damage to the gray matter nerve cells and the <strong>spinothalamic tract&nbsp;</strong>crossing the central canal. Patients present with features are&nbsp;<strong>loss of pain</strong> and<strong> temperature</strong> sensation which are not seen in this patient.</p>\n<p>Option B: <strong>Conus medullaris syndrome</strong>&nbsp;is characterized by <strong>bilateral saddle anesthesia</strong>, and prominent bowel and bladder dysfunction. Also, anal and bulbocavernosus reflexes are absent.&nbsp;</p>\n<p>Option D: <strong>Brown-Sequard syndrome</strong> is a hemi-transection of the spinal cord. It presents with ipsilateral weakness (corticospinal tract), ipsilateral loss of position, vibration sense (posterior column), and contralateral loss of pain and temperature one or two levels below the lesion.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 72-year-old man is being evaluated for decreased urine output. One week ago, he was admitted to the intensive care unit with pneumonia. He was started on broad-spectrum antibiotics, including a third-generation cephalosporin and gentamicin. His vitals are now stable. The results of laboratory studies are shown below. Which of the following types of casts would you find in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Hyaline casts"
      },
      {
        "id": 2,
        "text": "Muddy granular casts"
      },
      {
        "id": 3,
        "text": "RBC casts"
      },
      {
        "id": 4,
        "text": "WBC casts"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient's presentation of <strong>oliguria</strong> with <strong>increased serum creatinine</strong> and <strong>blood urea nitrogen</strong> (BUN)&nbsp;is suggestive of <strong>acute kidney injury</strong> (AKI), probably following the use of <strong>gentamicin</strong>, a nephrotoxic drug.&nbsp;<strong>Muddy brown granular casts</strong> are seen in <strong>acute tubular necrosis</strong>, which is a type of intrinsic renal failure. Tubular epithelial casts can also be seen in acute tubular necrosis.</p>\n<p>In this patient,</p>\n<ul>\n<li><strong>BUN/Creatinine ratio </strong>is 40/3.8 = 10.5:1 which is&nbsp;<strong>&lt;15:1</strong>, and</li>\n<li><strong>Fractional excretion of sodium (FeNa)</strong> is<strong> &gt;1%</strong>&nbsp;</li>\n</ul>\n<p>Both these parameters are suggestive of&nbsp;<strong>intrinsic acute kidney injury</strong>.</p>\n<p>Common causes of intrinsic AKI:</p>\n<ul>\n<li>Acute glomerulonephritis</li>\n<li>Tubulointerstitial diseases</li>\n<li>Vasculitis</li>\n<li>Hemolytic-uremic syndrome</li>\n<li>Malignant hypertension</li>\n</ul>\n<p><strong>Tubulointerstitial diseases</strong> are caused due to ischemia, sepsis/infection, or nephrotoxins. Nephrotoxins can be exogenous or endogenous.</p>\n<ul>\n<li>Exogenous nephrotoxins: <strong>Aminoglycosides</strong>, cisplatin, amphotericin-B, acyclovir, vancomycin, zoledronate, iodinated contrast</li>\n<li>Endogenous nephrotoxins: Products of hemolysis, rhabdomyolysis, myeloma proteins</li>\n</ul>\n<p>Laboratory findings in AKI due to acute tubular necrosis:</p>\n<ul>\n<li>Acute kidney injury is associated with <strong>anemia</strong>, which is multifactorial in origin. Uremia leads to a reduction in platelet function, although the platelet count remains normal, thereby causing bleeding and leading to anemia.</li>\n<li>AKI is typically associated with <strong>hyperkalemia</strong>, hyperphosphatemia, and hypocalcemia.</li>\n<li>Damage to the tubular cells and interstitium leads to decreased reabsorption of Na<sup>+</sup>, which results in fractional excretion of sodium (FENa) of &gt;1%. This patient has <strong>hyponatremia</strong> due to <strong>increased urinary&nbsp;Na<sup>+</sup> excretion</strong>.&nbsp;</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Hyaline&nbsp;casts</strong> are seen in patients with <strong>prerenal</strong> <strong>acute kidney injury</strong>. In prerenal AKI, <strong>BUN/Creatinine ratio is &gt;20</strong>. Common conditions associated with prerenal AKI include hypovolemia; congestive heart failure; liver failure; and impaired renal autoregulation due to drugs like NSAIDs, ACE inhibitors, and angiotensin receptor blockers (ARBs).</p>\n<p>Option C: <strong>RBC casts</strong> are seen in <strong>acute glomerulonephritis</strong>. This patient does not have <strong>hypertension</strong> or <strong>proteinuria</strong> to signify glomerular pathology.</p>\n<p>Option D: <strong>WBC casts</strong> are seen in patients with <strong>acute interstitial nephritis</strong> (AIN). A patient with AIN presents with <strong>fever, flank pain, rash,</strong> and <strong>arthralgia</strong>. Urinalysis shows sterile pyuria. CBC shows eosinophilia (not seen in this patient).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young man presents to an emergency room with sudden onset of the chest and epigastric pain. An ECG done reveals no abnormality. On palpation, you hear a crunchy sound of the chest and rigidity in the epigastric region. An X-ray chest of the patient is given below. Which among the following contrasts is contraindicated in confirming the diagnosis using fluoroscopy?",
    "choices": [
      {
        "id": 1,
        "text": "Diluted barium"
      },
      {
        "id": 2,
        "text": "Barium sulfate"
      },
      {
        "id": 3,
        "text": "Iohexol"
      },
      {
        "id": 4,
        "text": "Gastrogaffin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical scenario with <strong>crunchy sound</strong> on chest palpation and an x-ray showing <strong>pneumothorax</strong> (white arrow) and pleural effusion (black arrowhead) in the chest points towards a diagnosis of <strong>esophageal perforation</strong>. <strong>Water-insoluble contrast media</strong> like <strong>barium sulphate</strong> is contraindicated\u00a0to confirm the diagnosis using fluoroscopy.\u00a0</p>\n<p><strong>Esophageal perforation</strong> most commonly occurs due to <strong>iatrogenic</strong> instrumentation. <strong>Spontaneous</strong> perforation occurs due to vomiting against a closed glottis\u2014<strong>Boerhaave syndrome</strong>. Clinically, patients typically will have pain in the <strong>chest</strong> and <strong>epigastric</strong> region. On examination, abdominal rigidity and a\u00a0<strong>crunchy sound</strong> on chest palpation (Hamman's sign) due to <strong>subcutaneous emphysema</strong> from leakage of air into subcutaneous space are seen.\u00a0</p>\n<p>The classic chest radiographic findings include pneumomediastinum, left pleural effusion, and left pneumothorax.</p>\n<p>Low-osmolar water-soluble contrast medium like <strong>iopamidol</strong> is used for the diagnostic workup for a suspected case of esophageal perforation\u00a0<strong>instead of barium contrast</strong> to prevent barium-related inflammation of the mediastinum.\u00a0However, if water-soluble contrast media is not available, <strong>diluted barium</strong> can be used.</p>\n<p><strong>Barium sulfate</strong> is not normally absorbed during its passage through the digestive tract. However when the integrity of the gut wall is compromised or when there is abnormal communication between the esophagus and trachea, it can overflow into the lungs, mediastinum, intraperitoneal cavity, and tissue around the rectum and cause inflammation. Hence, it is contraindicated in these cases.</p>\n<p>Contraindications to use of barium:</p>\n<ul>\n<li>Esophageal perforation:\u00a0<strong>Iodinated</strong> contrast media like <strong>iopamidol </strong>and<strong> iohexol </strong>are used; gastrograffin can also be used but is not preferred due to risk of aspiration pneumonitis.</li>\n<li>Tracheoesophageal fistula: <strong>dianosil, </strong>the water-soluble non-ionic agent is used.</li>\n<li>Duodenal perforation:<strong> iohexol </strong>or<strong> gastrograffin </strong>is used.</li>\n</ul>\n<p>The image given below shows contrast esophagogram showing leakage of dye through the leak/perforation site:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fdf5706ee02b499e95833b80091cb010.png"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6942659818304f9eb532a1c506ebbddfx331x420.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dceb4e3266d0438ca13082024ccf1037x523x600.JPEG"
    ]
  },
  {
    "text": "A 34-year-old woman, G2P1L1 comes for her first ANC visit at 10 weeks gestation. Her previous pregnancy was uneventful with a normal vaginal delivery six years ago. The patient is a known hypertensive for 3 years but is non-compliant with her medications and has not had regular follow up. She occasionally smokes but does not consume alcohol or recreational drugs. On examination, her pulse rate is 80 bpm and BP is 150/90 mm of Hg. You prescribe multivitamins and advise her regarding the need for blood pressure control. This patient is at an increased risk of developing ___.",
    "choices": [
      {
        "id": 1,
        "text": "Abruptio placenta"
      },
      {
        "id": 2,
        "text": "Placenta previa"
      },
      {
        "id": 3,
        "text": "Polyhydramnios"
      },
      {
        "id": 4,
        "text": "Placenta accreta"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient with<strong> chronic hypertension </strong>is at increased risk of developing<strong> abruptio placentae. </strong>It is the <strong>p</strong><strong>remature separation</strong> of a&nbsp;<strong>normally implanted placenta</strong>.</p>\n<p>The hemorrhage into decidua basalis causes separation and compression of the placenta. This leads to a compromise of circulation to the fetus leading to fetal distress. The bleeding may escape through the cervix to cause external hemorrhage.</p>\n<p><strong>Hypertension</strong>&nbsp;and smoking are important etiological factors in abruption. Hypertension leads to vasospasm of the placental blood vessels, which causes <strong>uteroplacental insufficiency.&nbsp;</strong></p>\n<p>Placental insufficiency and damage to the vessels cause bleeding from the placental tissue and its separation from the uterine decidua. The fetus is also at risk of intrauterine growth restriction.</p>\n<p>The other common etiological factors for abruptio placentae include:</p>\n<ul>\n<li>Preterm prematurely ruptured membranes</li>\n<li>Advanced maternal age</li>\n<li>Cigarette smoking</li>\n<li>Cocaine abuse</li>\n<li>Trauma</li>\n<li>Uterine fibroids</li>\n<li>Isolated single umbilical artery</li>\n<li>Short umbilical cord</li>\n<li>Prior abruption</li>\n<li>Subclinical hypothyroidism</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: Placenta previa is the implantation of the placenta in the lower uterine segment, either over or very near to the cervical os. It presents with painless vaginal bleeding. Hypertension is not a predisposing factor. High-risk factors include previous placenta previa, previous cesarean delivery, multiple gestation, advanced maternal age, multiparity, cigarette smoking, uterine fibroids, or a previous uterine surgical procedure.&nbsp;</p>\n<p>Option D: Placenta accreta is a type of morbidly adherent placenta where the placental villi are attached to the myometrium. Risk factors include prior cesarian delivery, prior uterine surgery, prior curettage, and endometrial ablation, associated placenta previa.</p>\n<p>Option C:&nbsp;Placental insufficiency from hypertension can result in <strong>oligohydramnios </strong>but&nbsp;not polyhydramnios.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A premature newborn is shifted to NICU with tachypnea, audible respiratory grunting, intercostal retractions, and cyanosis. An X-ray revealed ground glass opacities and air bronchograms. Which of the following cells marked in the respiratory epithelium below are involved in the pathogenesis of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical vignette is suggestive of <strong>acute\u00a0respiratory distress syndrome </strong>(RDS).<strong>\u00a0Type II pneumocytes,</strong> which are<strong> marked</strong> as<strong> 2</strong> in the above image,\u00a0are\u00a0<strong>damaged</strong> in RDS.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fcf111ccee17429693214eeaabd942b8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cad8ed2bfd214fd3b6474b2b4cddaa6cx1279x1449.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/764580d1f47f44c7b2adc5e4bb462fdcx512x384.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/09ac8048f222453688cd0f3bd9ddb570x800x736.PNG"
    ]
  },
  {
    "text": "Considering normal fine motor development, a 3-year-old child will be able to copy a",
    "choices": [
      {
        "id": 1,
        "text": "Square"
      },
      {
        "id": 2,
        "text": "Cross"
      },
      {
        "id": 3,
        "text": "Circle"
      },
      {
        "id": 4,
        "text": "Triangle"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Considering normal fine motor development, a <strong>3-year-old</strong> child will be able to <strong>copy a</strong> <strong>circle.</strong></p>\n<p>Other options:</p>\n<p>Option A: Children with normal fine motor development are able to copy a <strong>square </strong>by<strong> 4.5 years.</strong></p>\n<p>Option B: Children with normal fine motor development are able to copy a <strong>cross </strong>by <strong>4 years.</strong></p>\n<p>Option D: Children with normal fine motor development are able to copy a <strong>triangle </strong>by<strong> 5 years.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 7-year-old girl was brought to the OPD with complaints of development of pubic and axillary hair and a sudden growth spurt. On examination, she has Tanner stage 2 breast development. USG revealed a right-sided adnexal mass. The patient underwent laparotomy to remove the tumor and the biopsy from the tumor showed characteristic Call-Exner bodies. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Granulosa cell tumor"
      },
      {
        "id": 2,
        "text": "Endodermal sinus tumor"
      },
      {
        "id": 3,
        "text": "Sertoli-Leydig cell tumor"
      },
      {
        "id": 4,
        "text": "Theca cell tumor"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given scenario history of a sudden growth spurt with the development of pubic and axillary hair with histopathological examination revealing Call-Exner bodies is suggestive of <strong>Granulosa cell tumor.</strong></p>\n<p>Granulosa cell tumors cell are ovarian <strong>sex-cord stromal tumors</strong> made up of cells closely resembling the granulosa cells of the Graafian follicle.&nbsp;</p>\n<ul>\n<li class=\"p1\">In <strong>prepubertal girls,</strong> estrogen secreted from the granulosa cell tumor results in <strong>precocious puberty</strong>.</li>\n<li>In <strong>women of reproductive age</strong>, increased estrogen from granulosa cell tumors leads to <strong>abnormal uterine bleeding</strong></li>\n<li>In post-menopausal women, <strong>post-menopausal bleeding</strong> is the most characteristic symptom.</li>\n</ul>\n<p class=\"p1\">The cut section is solid/cystic and yellow/orange due to its high lipid content. On microscopy, <strong>Call-Exner bodies</strong> are seen where the <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">granulosa cells are arranged in small clusters around a central cavity.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ac25710341c747349404d7fb34e3e14fx800x423.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8b290cf65ad34ad2abcfc2ec85beb545x720x534.JPEG"
    ]
  },
  {
    "text": "A 28-year-old woman presented to the emergency room with back pain, suprapubic discomfort, and a burning sensation on urination for the past three days. Since yesterday, she has developed a high fever, nausea, and vomiting. She has a past medical history of type 1 diabetes mellitus since the age of 10 years and has been on insulin. On examination, her pulse rate was 100 beats per minute, BP was 98/66 mmHg, and temperature was  103.2\u00b0F. There is focal severe pain at the right costovertebral angle. Urinalysis shows bacteria that were too numerous to count and there were 30\u201350 WBCs per high-power field. Urine leukocyte esterase test and Griess nitrite tests were positive. Organism isolated after urine culture is positive for indole. What is the most likely agent responsible for this patient\u2019s symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Proteus mirabilis"
      },
      {
        "id": 2,
        "text": "Escherichia coli"
      },
      {
        "id": 3,
        "text": "Klebsiella"
      },
      {
        "id": 4,
        "text": "Enterobacter"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given symptoms and laboratory tests suggesting a <strong>nitrate-reducing</strong> and&nbsp;<strong>indole positive</strong> organism point towards the diagnosis of&nbsp;<strong>urinary tract infection</strong>&nbsp;(UTI) due to&nbsp;<strong>E. coli</strong>.</p>\n<p>E. coli is a <strong>gram-negative</strong>, <strong>flagellated rod</strong>. It is the most frequent cause of acute complicated urinary tract infections. It is a <strong>lactose fermenter</strong> and hence, grows on <strong>MacConkey medium</strong> to produce <strong>pink colonies</strong>. Other biochemical features of E.coli are-</p>\n<table style=\"height: 154px; width: 234px;\">\n<tbody>\n<tr>\n<td style=\"width: 132px; text-align: center;\">Indole</td>\n<td style=\"width: 86px; text-align: center;\"><strong>Positive&nbsp;</strong></td>\n</tr>\n<tr>\n<td style=\"width: 132px; text-align: center;\">MR (Methyl Red)</td>\n<td style=\"width: 86px; text-align: center;\"><strong>Positive</strong></td>\n</tr>\n<tr>\n<td style=\"width: 132px; text-align: center;\">VP (Voges Proskauer)</td>\n<td style=\"width: 86px; text-align: center;\"><strong>Negative</strong></td>\n</tr>\n<tr>\n<td style=\"width: 132px; text-align: center;\">Citrate&nbsp;</td>\n<td style=\"width: 86px; text-align: center;\"><strong>Negative</strong></td>\n</tr>\n<tr>\n<td style=\"width: 132px; text-align: center;\">Nitrate reduction</td>\n<td style=\"width: 86px; text-align: center;\"><strong>Positive</strong></td>\n</tr>\n<tr>\n<td style=\"width: 132px; text-align: center;\">Urease&nbsp;</td>\n<td style=\"width: 86px; text-align: center;\"><strong>Negative</strong></td>\n</tr>\n<tr>\n<td style=\"width: 132px; text-align: center;\">H<sub>2</sub>S</td>\n<td style=\"width: 86px; text-align: center;\"><strong>Negative</strong></td>\n</tr>\n<tr>\n<td style=\"width: 132px; text-align: center;\">Gelatin hydrolysis&nbsp;</td>\n<td style=\"width: 86px; text-align: center;\"><strong>Negative</strong></td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>Therefore, E. coli is <strong>IMViC ++&minus;&minus;</strong></p>\n<p>The presence of leukocyte esterase in the urine suggests the presence of WBCs, indicating an infection of the urinary tract. Normal urine does not contain nitrites, therefore, its presence indicates a presence of nitrate-reducing bacteria in the urine. Additionally, the growth of organisms from aseptically collected urine samples in significant numbers makes the diagnosis of UTI. Classically, the growth of <strong>10<sup>5</sup> CFU/ml</strong> of urine is considered <strong>significant</strong>.&nbsp;</p>\n<p>UTI may be asymptomatic or present with clinical features depending on the site of localization. Lower UTI or cystitis generally presents as fever, chills, burning micturition.</p>\n<p>However, flank pain and renal angle tenderness with vomiting and a characteristic high spiking \"picket-fence\" fever suggest a diagnosis of UTI complicated with <strong>acute pyelonephritis</strong> in this diabetic patient. <strong>Fluoroquinolones</strong> such as levofloxacin and ciprofloxacin are the recommended <strong>first-line agents</strong> for treatment. Trimethoprim-sulfamethoxazole may be used in non-resistant cases.&nbsp;</p>\n<p>Other options-</p>\n<p>Options A, C and D are unlikely because Proteus mirabilis, Klebsiella, and Enterobacter species are all indole negative.&nbsp;</p>\n<p>Image showing a positive indole test-</p>\n<div class=\"page\" title=\"Page 289\">&nbsp;</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/874e62a2dc7b48f3ab9070403482173fx448x597.JPEG"
    ]
  },
  {
    "text": "A 40-year-old female librarian is brought to the emergency department. Neurologic examination reveals the following: blood pressure 160/90 mm Hg, weakness on the left side of her inferior face, no weakness in upper or lower limbs, tongue deviating to the left side on the protrusion.  There is no associated sensory loss. In which of the following loci is the lesion causing these symptoms found?",
    "choices": [
      {
        "id": 1,
        "text": "Retrolentiform part of internal capsule"
      },
      {
        "id": 2,
        "text": "Posterior limb of internal capsule"
      },
      {
        "id": 3,
        "text": "Anterior limb of internal capsule"
      },
      {
        "id": 4,
        "text": "Genu of internal capsule"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given case of <strong>acute onset weakness</strong> of the face and <strong>deviation of tongue</strong> points towards a diagnosis of <strong>stroke</strong>. It may arise due to the lesion in the <strong>genu of the internal capsule</strong> carrying the corticonuclear fibers.</p>\n<ul>\n<li>The <strong>corticonuclear</strong> aka corticobulbar fibers originate in the motor cortex - area 4 (specifically from the pyramidal cells in the inferior precentral gyrus).</li>\n<li>It then descends through the corona radiata and the genu of the internal capsule.</li>\n<li>It passes through the midbrain just medial to the corticospinal&nbsp;fibers in the basis pedunculi</li>\n<li>and ends by synapsing&nbsp;either directly with the lower motor neurons within&nbsp;the cranial nerve nuclei or indirectly through the internuncial&nbsp;neurons.</li>\n</ul>\n<p>The <strong>majority</strong> of corticonuclear fibers <strong>cross</strong> in the median plane <strong>before</strong> supplying the <strong>cranial nerve nuclei</strong>.&nbsp;<strong>All</strong> cranial motor nuclei receive <strong>bilateral</strong> corticonuclear connections <strong>except</strong>, <strong>facial</strong> nucleus supplying the lower part of the face, and the <strong>hypoglossal</strong> nucleus supplying the genioglossus muscle. Hence a lesion of these fibers causes contralateral clinical manifestations.</p>\n<p>In the given case, weakness of the face and tongue deviation to the opposite side has resulted from a lesion likely in the Genu of the Internal capsule.</p>\n<p><strong>Other options</strong></p>\n<p><strong>Retrolentiform</strong> part of the internal capsule carries fibers mainly from optic radiation. A lesion here produces&nbsp;homonymous hemianopia, superior quadrantanopia, or inferior quadrantanopia.</p>\n<p><strong>Anterior limb</strong> of the <strong>internal capsule</strong> carries fronto-pontine fibers. A lesion here produces&nbsp;confusion, impaired attention, agitation, and dysarthria.</p>\n<p><strong>Posterior limb</strong> of the <strong>internal capsule</strong> carries cortico-spinal motor fibers in the anterior part and the lesion here produces contralateral hemiparesis. The posterior part of the posterior limb of the internal capsule carries sensory fibers and lesions here may produce contralateral hemi-sensory deficits.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/71ccf08f87d24645be88e7d6826b894b.jpeg"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b1deb43b58fa43c896f888afc0c31c4dx1280x1625.JPEG"
    ]
  },
  {
    "text": "A 38-year-old man presented with a painless inguinoscrotal swelling. Examination revealed a hard, non-tender swelling in the left hemi-scrotum. It was possible to get above the swelling. The left testis was not palpable separate from the swelling. The ultrasound scan of the left and right testes, labeled as A and B respectively, is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Seminoma"
      },
      {
        "id": 2,
        "text": "Epididymal cyst"
      },
      {
        "id": 3,
        "text": "Hydrocoele"
      },
      {
        "id": 4,
        "text": "Cancer of scrotum"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A painless inguinoscrotal swelling and an ultrasound showing a mass that is <strong>homogenous, hypoechoic</strong> compared to surrounding stroma, and arising from within testes (image A- left testicle) are suggestive of <strong>seminoma</strong>.</p>\n<p><strong>Seminoma\u00a0</strong>is the most common type of\u00a0<strong>Germ cell tumor</strong>. The peak incidence is seen in the\u00a0<strong>fourth\u00a0decade.\u00a0</strong>It usually presents as painless testicular enlargement. Ultrasound is mandatory in all suspected cases of testicular tumors.\u00a0</p>\n<p>Seminoma has a homogeneous, grey-white, lobulated cut surface that is devoid of hemorrhage or necrosis. Histology shows sheets of uniform round cells with\u00a0<strong>clear\u00a0</strong>cytoplasm and a large central nucleus, with a prominent nucleolus. It is seen as a\u00a0<strong>\"fried egg appearance\"\u00a0</strong>as shown below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9bd23785a0a44427b2d7e013fa6ae70b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a080b45c33ff4839a3f3a8f015e0852cx720x238.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/33955cc4f7a84d1ca40d34caf5d51e37x800x385.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/54bcc0c24a6843c996cb38864548f84dx799x500.JPEG"
    ]
  }
];
        let quizName = 'Neet 2021 Mini Test 3  (20 Questions)';
        const quizFilename = 'neet-2021-mini-test-3-20-questions-fb1826f9.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>