<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 29 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Select the correct option regarding Mobile Medical Units (MMUs).",
    "choices": [
      {
        "id": 1,
        "text": "Only 1"
      },
      {
        "id": 2,
        "text": "1 and 2"
      },
      {
        "id": 3,
        "text": "1, 2, and 3"
      },
      {
        "id": 4,
        "text": "1, 2, 3, and 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Statements <strong>1, 2, and 3</strong> are correct. <strong>MMUs</strong> can be <strong>run</strong> by <strong>either Government or </strong>an<strong> external agency,</strong> <strong>but</strong> the drugs and medical <strong>supplies</strong> are to be provided always <strong>by Government only.</strong></p>\n<p><strong>Mobile Medical Units (MMU)</strong> is a major initiative under <strong>NRHM</strong> to provide a range of health care services for people living in <strong>remote</strong>, <strong>inaccessible</strong>, un-served, and underserved areas in both <strong>rural</strong> as well as <strong>urban</strong> areas, with the aim of taking<strong> healthcare services to the doorsteps</strong> of such people.</p>\n<p>There are <strong>3 models</strong> of operationalizing MMUs:</p>\n<ol>\n<li>Government operated MMU</li>\n<li>Operation of MMU on outsourcing basis by an external agency but capital expenditure, drugs, and supplies provided by Government.</li>\n<li>Outsourcing by an external agency which provides both capital expenditure and operational expenditure. However, drugs and supplies are to be provided by Government.</li>\n</ol>\n<p>MMUs provide <strong>primary care</strong> services for common diseases (communicable and non-communicable),<strong> RCH</strong> services, <strong>screening</strong> tests, and <strong>referral</strong> to higher facilities and specialists as required. Clinical services are provided by a <strong>Medical Officer</strong> and team, and mobilization and outreach services are provided by <strong>ANMs</strong> and <strong>ASHA</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following instrument is used in which of the following surgery?",
    "choices": [
      {
        "id": 1,
        "text": "Functional Endoscopic Sinus Surgery (FESS)"
      },
      {
        "id": 2,
        "text": "Mastoidectomy"
      },
      {
        "id": 3,
        "text": "Cricothyroidotomy"
      },
      {
        "id": 4,
        "text": "Adenoidectomy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 470\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The given image is of a<strong> Blakesley</strong> straight forceps.<strong>&nbsp;</strong>It is used in <strong>functional endoscopic sinus surgery</strong>&nbsp;(FESS) operations.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/08b73871e6d34c27855a718a0ce57a7d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6384d3d1549b4eb1b019aea6a13ec8e1x1280x1595.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c334f2387b2a406d81da0e6f83461382x1280x3728.JPEG"
    ]
  },
  {
    "text": "Which among the following bones is most useful for sex determination?",
    "choices": [
      {
        "id": 1,
        "text": "Carpal bones"
      },
      {
        "id": 2,
        "text": "Humerus"
      },
      {
        "id": 3,
        "text": "Femur"
      },
      {
        "id": 4,
        "text": "Tibia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">The <strong>femur</strong> is the most useful long bone for <strong>sex</strong> determination, due to its length and massiveness.</p>\n<p class=\"p1\">The <strong>accuracy of sex determination</strong> from bones depends greatly on the <strong>age</strong> of the subject, the <strong>degree</strong> <strong>of</strong> <strong>fragmentation</strong>, and <strong>biological</strong> <strong>variability</strong>. <strong>Obvious differences</strong> in bones between genders do not <strong>become apparent</strong> until <strong>after puberty.</strong> The accuracy of sex determination also depends on whether the <strong>total skeleton</strong> is <strong>available</strong> for <strong>examination</strong>.&nbsp;&nbsp;</p>\n<p class=\"p1\"><strong>All</strong> long <strong>bones</strong> have a <strong>considerable overlap</strong> of <strong>characteristics</strong> between male and female bones. However, there is a significant difference between <strong>male</strong> and <strong>female</strong> <strong>femurs</strong>. For example, the maximum oblique length in the male femur is 459mm but the female femur is only 426mm.&nbsp;</p>\n<p class=\"p1\">Pearson and Bell's criteria for sexing of the femur are:</p>\n<table style=\"height: 27px;\" width=\"396\">\n<tbody>\n<tr>\n<td style=\"width: 92px;\">Criteria</td>\n<td style=\"width: 92px;\">Male</td>\n<td style=\"width: 92px;\">Male or Female</td>\n<td style=\"width: 92px;\">Female</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">\n<p>Vertical diameter of the femoral head</p>\n</td>\n<td style=\"width: 92px;\">&nbsp;&gt;45.5</td>\n<td style=\"width: 92px;\">43.5-41.5</td>\n<td style=\"width: 92px;\">&lt;41.5</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">\n<p>Popliteal length</p>\n</td>\n<td style=\"width: 92px;\">&gt;145</td>\n<td style=\"width: 92px;\">114-132</td>\n<td style=\"width: 92px;\">&lt;106</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">\n<p>Bicondylar width</p>\n</td>\n<td style=\"width: 92px;\">&gt;78</td>\n<td style=\"width: 92px;\">74-76</td>\n<td style=\"width: 92px;\">&lt;72</td>\n</tr>\n<tr>\n<td style=\"width: 92px;\">\n<p>Oblique trochanteric length</p>\n</td>\n<td style=\"width: 92px;\">&gt;450</td>\n<td style=\"width: 92px;\">405-430</td>\n<td style=\"width: 92px;\">&lt;390</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>Among these, the most useful criterion is that of the&nbsp;<strong>vertical diameter </strong>of <strong>femoral</strong> <strong>head.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 48-year-old alcoholic presented to the casualty with fever, productive cough and dyspnea. Chest X-Ray was performed which showed the following finding. Sputum culture was sent which showed lactose fermenting, mucoid colonies on MacConkey agar. What is the causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Streptococcus pneumoniae"
      },
      {
        "id": 2,
        "text": "Klebsiella pneumoniae"
      },
      {
        "id": 3,
        "text": "Pseudomonas aeruginosa"
      },
      {
        "id": 4,
        "text": "Haemophilus influenzae"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario and chest X-ray showing <strong>bulging fissure sign</strong> are highly suggestive of <strong>lobar pneumonia</strong> caused by<em>\u00a0</em><strong><em>Klebsiella pneumonia.</em></strong></p>\n<p><em>K. pneumoniae</em> causes lobar pneumonia\u00a0in <strong>alcoholics</strong> and diabetics. The patient characteristically presents with\u00a0fever, dyspnea, and a productive cough with<strong>\u00a0red currant jelly sputum.</strong></p>\n<p>Classic <strong>chest X-ray</strong> findings include:</p>\n<ul>\n<li><strong>Upper lobe consolidation</strong> - classically on the right side.</li>\n<li>Cavitation</li>\n<li><strong>Bulging fissure sign</strong> - expansive lobar consolidation and inflammatory exudates cause the lower border of the upper lobe to bulge. It can also be seen with space-occupying lesions of the lung, such as pulmonary hemorrhage, lung abscess, and tumor.\u00a0</li>\n</ul>\n<p>The following image shows bulging fissure sign.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/91403ef1642848a896cc0ac697d9ab82.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f45b18e9b6fb4c68b2447b502c2dee40x720x842.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b1884ee13c8642a18c403ee9b11614dbx800x479.JPEG"
    ]
  },
  {
    "text": "Match the following braces to the appropriate clinical scenarios.",
    "choices": [
      {
        "id": 1,
        "text": "1-B, 2-A, 3-D, 4-E"
      },
      {
        "id": 2,
        "text": "1-A, 2-C, 3-E, 4-D"
      },
      {
        "id": 3,
        "text": "1-D, 2-B, 3-E, 4-C"
      },
      {
        "id": 4,
        "text": "1-C, 2-D, 3-B, 4-A"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The correct answer is<strong>\u00a01-A, 2-C, 3-E, 4-D.</strong></p>\n<p>A 13-year-old girl with a <strong>scoliotic curve beginning at T10</strong> should be provided with a <strong>Boston brace</strong>. It\u00a0is the commonest brace prescribed for scoliosis and is a type of thoraco-lumbo-sacral-orthosis (TLSO brace). It has\u00a0a hard polypropylene outer shell with a soft foam lining inside. The Boston brace works by applying corrective pressure on the convex side of the curve. It is used in patients whose <strong>scoliosis curve apex is at T7 or lower.</strong>\u00a0</p>\n<p>Boston brace is also available as a Cervical TLSO brace - which is a TLSO with a neck extension. It is used for the correction of a high thoracic curve.</p>\n<p>Wilmington Brace is another\u00a0common TLSO brace that is custom-fitted based on a cast taken of the patient in the supine position. The\u00a0brace fits onto the body like a tight jacket, known as a full-contact TLSO. There are no gaps or open spots.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/482fdb57414e4926aaca06c501f639c2x720x720.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/233bc10ebcb643e682535a2d1681e705x1280x1451.509167842031.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b534da5f65074c7d8cfc7101125b3bebx1280x1865.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1a22541799724202a309e13f680574e4x1280x3139.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a2fb35028aff4b79b2e7cd48d7217c27x1280x1280.JPEG"
    ]
  },
  {
    "text": "A 48-year-old man is brought due to complaints of hallucinations, abnormal behavior, hydrophobia, and insomnia. He was bitten by a stray dog 4 weeks ago. The patient dies a couple of days later. An autopsy revealed the presence of the following findings in the pyramidal neurons of the hippocampus and Purkinje cells of the cerebellum. What are these pathognomic microscopic findings called?",
    "choices": [
      {
        "id": 1,
        "text": "Ashchoff bodies"
      },
      {
        "id": 2,
        "text": "Negri bodies"
      },
      {
        "id": 3,
        "text": "Cowdry bodies"
      },
      {
        "id": 4,
        "text": "Pick bodies"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient's clinical features of abnormal behavior, hydrophobia, and hallucinations a few weeks after a dog bite is suggestive of <strong>rabies. Negri bodies</strong>&nbsp;are the pathognomonic microscopic finding in rabies.</p>\n<p>Negri bodies are cytoplasmic, round to oval, <strong>eosinophilic inclusions</strong> that can be found in the <strong>pyramidal neurons</strong> of the hippocampus and<strong> Purkinje cells</strong> of the cerebellum, sites that are usually devoid of inflammation.</p>\n<p><strong>The rabies virus</strong> can be detected within Negri bodies by ultrastructural and immunohistochemical methods.</p>\n<p>Image: Characteristic Negri bodies found in the Purkinje cell of the&nbsp;cerebellum.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/46f9133708314379b619c25c4d3bea94.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f79ab341be8346de9c54fac62ccc8fe6x702x454.PNG"
    ]
  },
  {
    "text": "A patient on lithium therapy was started on a drug for hypertension. After few days, he developed coarse tremors and other symptoms suggestive of lithium toxicity. Which of the following anti-hypertensive drug is least likely to be the cause of this toxicity?",
    "choices": [
      {
        "id": 1,
        "text": "Enalapril"
      },
      {
        "id": 2,
        "text": "Furosemide"
      },
      {
        "id": 3,
        "text": "Nifedipine"
      },
      {
        "id": 4,
        "text": "Chlorthalidone"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Except for nifedipine, all the other drugs (Enalapril, thiazide, furosemide) causes lithium toxicity.</p>\n<p><strong>Lithium toxicity </strong>occurs with<strong> concomitant use </strong>of&nbsp;</p>\n<ol>\n<li><strong>Thiazide diurertics (chlorthalidone)</strong></li>\n<li>Angiotensin-converting enzyme inhibitors (enalapril)</li>\n<li>Angiotensin II receptor blocker (telmisartan)</li>\n<li>Nonsteroidal anti-inflammatory drugs (indomethacin)</li>\n<li>Tetracyclines (doxycycline)</li>\n<li>Loop diuretics (furosemide)</li>\n</ol>\n<p>These act by<strong> increasing</strong> the<strong> tubular reabsorption of lithium</strong>,<strong>&nbsp;</strong>resulting in decreased excretion of lithium and thereby increasing the serum lithium levels, causing toxicity.</p>\n<p><strong>Lithium toxicity:&nbsp;</strong></p>\n<p>Serum lithium level greater than<strong> 1.5 mEq/L</strong> are&nbsp;considered toxic. Acute intoxication is characterized by vomiting, profuse diarrhea,&nbsp;coarse tremor, ataxia, dysarthria, and convulsions. It may progress to cardiac&nbsp;arrhythmias,&nbsp;coma, and death.</p>\n<p>Treatment is supportive which includes dialysis, continuous cardiac monitoring, intubation if needed.</p>\n<p><strong>Adverse effects of Lithium:</strong></p>\n<p>Central nervous system: Lithium at therapeutic levels cause <strong>fine tremors</strong> and at toxic levels cause <strong>coarse tremors.</strong> Incoordination, ataxia, and slurred speech can occur at peak serum concentrations.</p>\n<p>Lithium enters into the distal tubular cells in kidney via luminal ENaC. However, it accumulates in the distal tubular cells due to the inability of Na+K+ATPase to secrete lithium via basal membrane. Thereby, lithium inhibits GSK-3&szlig;, leading to vasopressin insensitivity, downregulation of aquaporin-2 channels, and <strong>nephrogenic diabetes insipidus. </strong>Patients present with<strong> polyuria and polydipsia.&nbsp;Amiloride </strong>blocks entry of lithium into renal distal tubule ENaCs and is used to treat lithium induced nephrogenic diabetes insipidus.</p>\n<p>Lithium therapy is associated with <strong>hypothyroidism </strong>and <strong>hypercalcemia </strong>related to hyperparathyroidism.&nbsp;Lithium therapy causes significant <strong>weight gain.</strong></p>\n<p><strong>T wave flattening</strong> in ECG occurs in few patients on lithium. At toxic levels, sinus bradycardia, AV block, and cardiac arrhythmias occur.&nbsp;<strong>Allergic reactions</strong> including dermatitis, folliculitis, and vasculitis can occur with lithium use.</p>\n<p>Lithium use in early pregnancy causes <strong>Ebstein anomaly</strong> in the fetus. Fetal lithium exposure is associated with <strong>neonatal goiter, CNS depression, hypotonia (floppy baby syndrome), and cardiac murmur.</strong></p>\n<p>Due to all these adverse effects, patients on lithium therapy should have routine monitoring of serum electrolytes, serum calcium, thyroid profile, renal function tests, ECG, and serum lithium levels.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The image below shows the effect of various factors on the levels of a hormone. Identify the correct statements regarding the hormone.",
    "choices": [
      {
        "id": 1,
        "text": "2 and 5"
      },
      {
        "id": 2,
        "text": "1, 3, and 5"
      },
      {
        "id": 3,
        "text": "1, 2, and 4"
      },
      {
        "id": 4,
        "text": "2, 3, and 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The hormone depicted in the graph shows&nbsp;<strong>pulsatile secretion</strong>, with an&nbsp;<strong>increase</strong> during strenuous <strong>exercise</strong> and&nbsp;<strong>early period of sleep</strong>, indicating that it&nbsp;is the <strong>growth hormone </strong>(GH). The correct statements regarding GH are&nbsp;<strong>1, 3, </strong>and<strong> 5 </strong>(option B).</p>\n<p><strong>Growth hormon</strong>e is secreted from the <strong>somatotropes</strong> located in the anterior pituitary. Its main role is the growth of the human body.</p>\n<p>The levels of growth hormones show <strong>diurnal variation</strong> as well as variation across different age groups.&nbsp;Adolescents have the highest circulating levels of growth hormone, followed by children and adults. The levels are relatively low during the day and the pulsatile release of this hormone occurs during sleep.</p>\n<p>Important regulators of growth hormone:</p>\n<ul>\n<li><strong>Growth hormone-releasing hormone</strong>- stimulates the production of the hormone</li>\n<li><strong>Somatostatin</strong>- inhibits the release of GH</li>\n<li><strong>Ghrelin</strong>- increases the GH release</li>\n</ul>\n<p>Stimuli that <strong>increase</strong>&nbsp;GH secretion:</p>\n<ul>\n<li>Hypoglycemia, deoxyglucose, fasting</li>\n<li>Exercise</li>\n<li class=\"p1\">Protein meal, infusion of arginine</li>\n<li>Glucagon</li>\n<li>Deep sleep</li>\n<li>Estrogens and androgens</li>\n<li>Stressful stimuli</li>\n</ul>\n<p>Stimuli that <strong>decrease</strong>&nbsp;GH secretion:</p>\n<ul>\n<li>Glucose</li>\n<li>Cortisol</li>\n<li>Free fatty acids</li>\n<li>Growth hormone and IGF-1</li>\n<li>REM sleep</li>\n<li>Medroxyprogesterone</li>\n</ul>\n<p>GH can act directly on the cells or mediate its actions through <strong>insulin-like growth factors (IGF)</strong>. The functions which are mediated through IGFs are insulin-like activity, anti-lipolytic activity, protein synthesis, and epiphyseal growth. Direct actions of GH are <strong>sodium retention, decreased insulin sensitivity</strong>, lipolysis, protein synthesis, and epiphyseal growth.</p>\n<p>Actions of growth hormone:</p>\n<ul>\n<li><strong>Growth</strong> of cartilage, bones, and organs.</li>\n<li>Increases amino acid uptake and <strong>protein synthesis</strong> in the cells and decreases protein breakdown.</li>\n<li><strong>Diabetogenic</strong>&nbsp;action: Increases the hepatic glucose release and decreases the glucose uptake by muscles and fat.</li>\n<li>Increases fat utilization.&nbsp;It is <strong>ketogenic</strong> and increases circulating free fatty acid levels.</li>\n</ul>\n<p>Since somatostatin inhibits the release of GH, somatostatin analogs like <strong>octreotide </strong>and<strong> lanreotide</strong> are used in the treatment of acromegaly.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0b489122838a431b9fcc984492f63f97.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A mother brings her 7-year-old daughter with the complaint that the child wakes up at night screaming, sweating, and terrified. She does not respond to the comforting efforts by her parents. She does not recall the episode in the morning. In which stage of sleep do the episodes experienced by the daughter occur?",
    "choices": [
      {
        "id": 1,
        "text": "NREM stage 1"
      },
      {
        "id": 2,
        "text": "REM sleep"
      },
      {
        "id": 3,
        "text": "NREM stages 3, 4"
      },
      {
        "id": 4,
        "text": "NREM stage 2"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><span data-preserver-spaces=\"true\">The child who wakes up with intense fear and signs of arousal such as sweating, and does not recall the event in the morning is experiencing <strong>sleep terrors</strong> or<strong> n</strong></span><strong>ight terrors.&nbsp;</strong><span data-preserver-spaces=\"true\">Night terrors occur in deep sleep&nbsp;</span><strong><span data-preserver-spaces=\"true\">(stages 3 and 4 of NREM sleep).</span></strong></p>\n<p>Sleep terror or night terror is an <strong>NREM sleep arousal disorder.</strong> In this condition, the patient experiences <strong>sudden arousal</strong> with <strong>intense fearfulness</strong>. They may have a piercing <strong>scream</strong> or <strong>cry</strong> with manifestations of <strong>intense anxiety</strong>.</p>\n<p>On arousal, they sit up in bed, are <strong>unresponsive to stimuli</strong>, and are <strong>confused</strong> and <strong>disoriented</strong> <strong>on</strong> <strong>awakening</strong>. <strong>Autonomic disturbances</strong> may be present. If vocal, they are <strong>incoherent</strong>. The patient <strong>cannot</strong> generally <strong>be awakened</strong> and efforts to calm them are not successful.&nbsp;&nbsp;</p>\n<p>Sleep terrors&nbsp;only have brief frightening or vivid images, or may not have imagery at all. It can be <strong>provoked</strong> by <strong>sleep</strong> <strong>deprivation</strong>, <strong>fever</strong>, and central nervous system <strong>depressant</strong> <strong>withdrawal</strong>.&nbsp;</p>\n<p><span data-preserver-spaces=\"true\">Nightmares have elaborate dream sequences<strong>&nbsp;without autonomic disturbances</strong>. They occur in <strong>REM sleep.</strong> The patient <strong>can be aroused</strong> and typically remembers the dream.</span></p>\n<p><span data-preserver-spaces=\"true\">The various stages of sleep and their appearance on EEG are summarized in the image below.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/85c8452da2eb4fb99f572735f5b40413x1280x2592.JPEG"
    ]
  },
  {
    "text": "A patient is undergoing Doppler ultrasonographic assessment for varicose veins. When the probe was placed inferior to the inguinal crease, the sign shown in the below image was seen on the transverse view in the B-mode. What does it indicate?",
    "choices": [
      {
        "id": 1,
        "text": "Normal anatomy of femoral vessels"
      },
      {
        "id": 2,
        "text": "Thrombosis of common femoral vein"
      },
      {
        "id": 3,
        "text": "Incompetence of saphenofemoral valve"
      },
      {
        "id": 4,
        "text": "Thrombosis of great saphenous vein"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The sign in the image&nbsp;given above is the <strong>Mickey mouse sign</strong>,<strong>&nbsp;</strong>which represents the <strong>normal anatomy of the femoral vessels</strong>.</p>\n<div class=\"page\" title=\"Page 998\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The Mickey mouse sign is seen on the transverse B-mode of USG.</p>\n<p>It includes&nbsp;</p>\n<ul>\n<li>Great saphenous vein (GSV),</li>\n<li>Common femoral vein (CFV), and</li>\n<li>Common femoral artery (CFA)</li>\n</ul>\n<p>Normally, the GSV and CFV lie medial to the common femoral artery, which gives rise to the sign.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9e68622cfa7c4b289b9e5ae0e0b7b97e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8e5752ff1fd34c59aa1fb2ca284338a4x1280x1750.JPEG"
    ]
  },
  {
    "text": "During a preoperative anesthetic evaluation, pharmacologic stress echocardiography is being undertaken for a patient with chronic pulmonary disease. Which of the following agents can be used for inducing pharmacological stress in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Dipyridamole"
      },
      {
        "id": 2,
        "text": "Dobutamine"
      },
      {
        "id": 3,
        "text": "Adenosine"
      },
      {
        "id": 4,
        "text": "Regadenoson"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 1280\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Dobutamine</strong> can be used for the induction of pharmacological stress in a patient with <strong>chronic pulmonary disease</strong>.</p>\n<p><strong>Dobutamine</strong> is a potent <strong>&beta;-receptor agonist</strong> used for stress testing. It increases myocardial oxygen demand by&nbsp;<strong>increasing</strong>&nbsp;<strong>contractility</strong>,&nbsp;<strong>heart</strong>&nbsp;<strong>rate</strong>, and&nbsp;<strong>blood pressure</strong>&nbsp;in a similar manner as exercise.&nbsp;<strong>Dobutamine stress testing&nbsp;</strong>is the preferred choice for the assessment of myocardial viability and is generally used as an alternative to vasodilator stress in patients with <strong>chronic pulmonary disease</strong>, where vasodilators are contraindicated.&nbsp;&nbsp;</p>\n<div class=\"page\" title=\"Page 1731\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Cardiac stress testing is performed in patients with <strong>known</strong> or <strong>suspected</strong> <strong>coronary artery disease</strong>. It is also done for <strong>preoperative CVS monitoring</strong> in a patient with risk factors for myocardial infarction. Generally, <strong>exercise stress</strong> <strong>testing</strong> is <strong>preferred</strong> because it provides information on functional capacity, exercise tolerance, and symptom provocation. However, some patients undergo pharmacologic stress testing.&nbsp;<strong>Indications</strong> for<strong> pharmacologic stress testing</strong> include:&nbsp;</p>\n<ul>\n<li>Unstable angina</li>\n<li>Inability to exercise</li>\n<li>History of uncontrolled heart failure at risk for deterioration</li>\n<li>Poorly controlled blood pressure</li>\n<li>History of aortic stenosis</li>\n<li>Recent myocardial infarction</li>\n<li>Acute pulmonary embolism</li>\n<li>Acute pericarditis or myocarditis</li>\n<li>Severe pulmonary hypertension</li>\n<li>Chronic pulmonary disease</li>\n</ul>\n<div class=\"page\" title=\"Page 1731\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 1731\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Vasodilators</strong> are the <strong>most commonly</strong> used pharmacologic stressors for myocardial perfusion imaging. Vasodilator stress acts by increasing and diverting blood flow to the non-diseased blood vessels so that the diseased vessels can be visualized clearly. It is brought about by drugs such as adenosine, dipyridamole, and regadenoson.</p>\n<p>Contraindications to vasodilator stress testing are:</p>\n<ul>\n<li>Pronounced active bronchospastic airway disease</li>\n<li>Significant hypotension</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old male patient has been brought to the hospital following blunt trauma to the chest and abdomen. On examination, it was found that the structures passing through the most posteroinferior large diaphragmatic opening situated at the level of the T12 vertebra have been injured. All of the following structures are injured in this case except?",
    "choices": [
      {
        "id": 1,
        "text": "Thoracic duct"
      },
      {
        "id": 2,
        "text": "Right vagus nerve"
      },
      {
        "id": 3,
        "text": "Azygous vein"
      },
      {
        "id": 4,
        "text": "Hemiazygous vein"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most <strong>posteroinferior</strong> <strong>large</strong> <strong>diaphragmatic</strong> <strong>opening</strong> situated at the <strong>level</strong> of the <strong>T12</strong> <strong>vertebra</strong> is the aortic opening. The<strong> right vagus nerve</strong> is not injured in the given case as it <strong>passes</strong> <strong>through</strong> the <strong>oesophageal</strong> <strong>opening</strong> while all these other structures are injured. <br /><br />The diaphragm has several openings through which structures can pass between the thorax and abdomen. There are <strong>three large openings</strong> and <strong>several smaller openings</strong>. The large openings are the <strong>aortic</strong> hiatus, the <strong>oesophagal</strong> hiatus, and the <strong>caval</strong> hiatus.</p>\n<p>The<strong> aortic opening</strong> is the most<strong> </strong>posteroinferior large diaphragmatic opening. It is found at the level of the lower border of the twelfth thoracic\u00a0vertebra and the corresponding intervertebral disc. It is bounded by the <strong>diaphragmatic crura</strong> laterally, the <strong>vertebral column</strong> posteriorly, and the <strong>median arcuate ligament</strong> anteriorly.\u00a0</p>\n<p>Structures passing through the aortic opening are,</p>\n<ul>\n<li>Aorta</li>\n<li><strong>Thoracic duct</strong></li>\n<li><strong>Azygous vein</strong></li>\n<li><strong>Hemiazygous vein</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient was advised to take green leafy vegetables as a natural dietary source of vitamin K. Which is the compound that acts as the source of vitamin K in these vegetables?",
    "choices": [
      {
        "id": 1,
        "text": "Menadiol diacetate"
      },
      {
        "id": 2,
        "text": "Menadione"
      },
      {
        "id": 3,
        "text": "Phylloquinone"
      },
      {
        "id": 4,
        "text": "Menaquinone"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The normal dietary source of vitamin K is <strong>phylloquinone</strong> or <strong>vitamin K1</strong>, found in green leafy vegetables.</p>\n<p>Vitamin K is a fat-soluble vitamin and its deficiency leads to bleeding disorders.</p>\n<p>Three compounds have the biological activity of vitamin K:</p>\n<ul>\n<li><strong>Phylloquinone (Vitamin K1)</strong> is the normal dietary source of Vitamin K that is found in <strong>green leafy vegetables</strong>.</li>\n<li><strong>Menaquinone</strong>&nbsp;<strong>(Vitamin K2)</strong>&nbsp;is synthesized by <strong>intestinal bacteria.</strong></li>\n<li><strong>Menadione (Vitamin K3)</strong>&nbsp;and&nbsp;<strong>menadiol</strong> <strong>diacetate</strong> are<strong> synthetic</strong> compounds that are metabolized to phylloquinone.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An asymptomatic 30-year-old man presents with a lesion on his thigh as seen in the below image. He returned a week ago from the US where he inspected farming areas during the summer. The best management for this patient would be:",
    "choices": [
      {
        "id": 1,
        "text": "Chloroquine + Tafenoquine (single dose)"
      },
      {
        "id": 2,
        "text": "Doxycycline 100 mg BD"
      },
      {
        "id": 3,
        "text": "Oral antihistamine"
      },
      {
        "id": 4,
        "text": "Reassurance as it is a fixed drug eruption"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image classically depicts the <strong>bull&rsquo;s eye</strong> <strong>lesion</strong> (<strong>erythema</strong> <strong>chronicum</strong> <strong>migrans</strong>) and the clinical history is suggestive of the diagnosis of Lyme disease. The drug of choice for early asymptomatic Lyme disease is <strong>Doxycycline</strong> <strong>100</strong> <strong>mg</strong> <strong>BD</strong>.</p>\n<p>Lyme disease is caused by the spirochete <strong>Borrelia burgdorferi</strong> and is transmitted by the hard tick, <strong>Ixodes</strong>. It usually occurs after a tick bite while strolling through the farms. Most of them do not recall the bite and the initial presentation is only a skin lesion known as erythema chronicum migrans.</p>\n<p>It is only after dissemination, that the disease spreads to joints (arthritis), heart (AV blocks), and the nervous system (neuroborreliosis).</p>\n<p>The treatment protocol for early Lyme disease includes:</p>\n<ul>\n<li>Doxycycline 100 mg BD (<strong>Drug of choice</strong>) for 2-3 weeks (or)</li>\n<li>Amoxicillin 500 &ndash; 1000 mg for 2-3 weeks (for children &lt; 9 years, pregnant women)</li>\n</ul>\n<p>In severe disseminated cases, Ceftriaxone 2 g IV for 2-3 weeks can be given.&nbsp;</p>\n<p><strong>Other options:</strong></p>\n<p>Option A - <strong>Chloroquine and tafenoquine</strong> are used to <strong>prevent</strong> Plasmodium vivax <strong>malaria</strong> <strong>relapse</strong>. There are no clinical symptoms suggestive of Malaria.&nbsp;</p>\n<p>Option C - <strong>Antihistamines</strong> can be used to <strong>treat</strong> <strong>urticaria</strong>. Patients present with short-lived itchy weals, angioedema, or both.&nbsp;</p>\n<p>Option D - <strong>Fixed drug eruption</strong> presents as a sharply defined oval or round erythematous, edematous plaque. It becomes dusky, violaceous, and vesicular or bullous. It occurs in the lips, genitals, palms, and soles.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/555a29f6293345be804854bfb0f2ca85.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Match the syndromes given in column A with the structures involved given in column B. (CN- cranial nerve, CST- corticospinal tract)",
    "choices": [
      {
        "id": 1,
        "text": "1 - D, 2 - A, 3 - E, 4 - B"
      },
      {
        "id": 2,
        "text": "1 - E, 2 - B, 3 - C, 4 - A"
      },
      {
        "id": 3,
        "text": "1 - A, 2 - B, 3 - C, 4 - D"
      },
      {
        "id": 4,
        "text": "1 - B, 2 - C, 3 - A, 4 - E"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\">The correct match is&nbsp;<strong>1-D, 2-A, 3-E, 4-B.</strong></p>\n<p class=\"p1\">Important syndromes in the brainstem are</p>\n<p class=\"p1\">Midbrain</p>\n<ul>\n<li class=\"p1\"><strong>Weber syndrome</strong>- It affects cranial nerve (CN) III, ventral midbrain, and corticospinal tract. Patients will have contralateral hemiplegia and paralysis of the third cranial nerve.</li>\n<li class=\"p1\"><strong>Benedikt syndrome</strong>- It affects&nbsp;CN III, ventral midbrain, corticospinal tract, and red nucleus. Patients will have contralateral hemiparesis, third nerve palsy, intention tremor, and cerebellar ataxia.</li>\n<li class=\"p1\"><strong>Top of basilar syndrome</strong>- It affects occipital lobes, midbrain oculomotor nuclei, cerebral peduncle, medial and temporal lobe, and thalamus. Patients will have contralateral hemiparesis, cortical blindness, oculomotor deficits, memory difficulty, and contralateral sensory deficit.</li>\n</ul>\n<p class=\"p1\">Pons</p>\n<ul>\n<li class=\"p1\"><strong>Milard Gubler syndrome</strong>- It affects&nbsp;CN VI, CN VII, and ventral pons. Patients will have contralateral hemiparesis, CN VI and CN VII palsies.</li>\n<li class=\"p1\"><strong>Clumsy hand syndrome-</strong> It affects the corticospinal tract. Patients will have contralateral hemiparesis, dysarthria, and facial weakness.</li>\n<li class=\"p1\"><strong>Foville syndrome</strong>- It affects&nbsp;CN VII, ventral pons, and paramedian pontine reticular formation. Patients will have ipsilateral CN VII palsy, contralateral hemiparesis, gaze palsy to the side of the lesion.</li>\n</ul>\n<p>Medulla</p>\n<ul>\n<li class=\"p1\"><strong>Medial medullary syndrome</strong>- It affects the corticospinal tract, medial lemniscus, and hypoglossal nerve. Patients will have contralateral hemiparesis, loss of position and vibratory sensation, and ipsilateral tongue paresis.&nbsp;</li>\n<li class=\"p1\"><strong>Lateral medullary syndrome</strong>- It affects the spinothalamic tract, trigeminal nucleus, cerebellum and inferior cerebellar peduncle, vestibular nuclei, and nucleus ambiguus. Patients will have ataxia, dysphagia, hemisensory loss, facial weakness, and Horner syndrome.</li>\n</ul>\n<p><strong>Brown Sequard syndrome</strong> is the hemisection of the spinal cord. Patients present with ipsilateral weakness, ipsilateral loss of position sense, and contralateral loss of pain and temperature.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old female patient with no significant past history comes to the emergency department with sudden onset of palpitations. On examination, her pulse is 140 bpm and her blood pressure is 110/70 mmHg. Her ECG is given below. What will be the initial line of management?",
    "choices": [
      {
        "id": 1,
        "text": "IV adenosine"
      },
      {
        "id": 2,
        "text": "Carotid sinus massage"
      },
      {
        "id": 3,
        "text": "IV diltiazem"
      },
      {
        "id": 4,
        "text": "IV procainamide"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The ECG is suggestive of<strong>&nbsp;paroxysmal supraventricular tachycardia (PSVT) </strong>as it shows&nbsp;narrow&nbsp;QRS complexes without visible p waves and pseudo R' waves in aVR lead. Since the patient is hemodynamically stable, a&nbsp;<strong>carotid sinus massage</strong> will be provided as<strong>&nbsp;first-line therapy.</strong></p>\n<p><strong>Vagal maneuvers</strong> like the carotid sinus massage and the Valsalva maneuver&nbsp;are techniques used to increase vagal parasympathetic tone.</p>\n<p>Vagal maneuvers transiently <strong>increase the arterial pressure</strong> in the carotid sinuses and aortic arch. This triggers the <strong>baroreceptor reflex,</strong> which increases parasympathetic output to the heart via cranial nerve X.&nbsp;</p>\n<p>The right vagus nerve innervates the sinoatrial (SA) node and the left vagus nerve&nbsp;innervates the atrioventricular (AV) node. Stimulation of the right and left vagus nerve cause&nbsp;<strong>slowing of the electrical activity</strong> within the SA node and AV node.</p>\n<p>Thus, vagal stimulation results in a decrease in the speed and frequency of electrical impulses in the heart, which could ultimately slow or terminate a tachydysrhythmia.</p>\n<p><strong>Treatment of PSVT:</strong></p>\n<p>In&nbsp;hemodynamically <strong>unstable</strong> patients<strong>,&nbsp;</strong>QRS-synchronous <strong>DC cardioversion</strong> should be done.</p>\n<p>In hemodynamically <strong>stable</strong> patients,</p>\n<ol>\n<li><strong>Vagal maneuvers </strong>such as carotid sinus massage are provided as first-line therapy only if there is a low risk of carotid vascular disease. It is contraindicated in patients with <strong>carotid</strong> <strong>bruit</strong> and prior history of <strong>stroke.</strong></li>\n<li>If the vagal maneuvers fail or cannot be performed, <strong>intravenous adenosine</strong> can be used.</li>\n<li>If adenosine does not work, IV <strong>beta-blockers</strong>&nbsp;or <strong>calcium channel blockers </strong>(<strong>verapamil</strong>, <strong>diltiazem</strong>) can be used</li>\n<li>Irregular, wide complex tachycardia can be treated with IV procainamide, ibutilide, or cardioversion.&nbsp;</li>\n</ol>\n<p>Care should be taken to perform continuous ECG monitoring with facilities for emergency cardioversion and defibrillation on standby.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b0d6147390b64e98b761875a9b5f0716.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/32806ab51c6946f18ac65c5475efd5f7x510x812.PNG"
    ]
  },
  {
    "text": "A 26-year-old male presented with complaints of pain, photophobia, and redness in the eye following injury by vegetative matter. On examination, appearance is as shown in the below-given image. Which of the following statements is incorrect about this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Signs are more pronounced than symptoms"
      },
      {
        "id": 2,
        "text": "Wessely\u2019s immune ring is a feature"
      },
      {
        "id": 3,
        "text": "It can occur in immunocompromised patients"
      },
      {
        "id": 4,
        "text": "The hypopyon is sterile"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient with history of ocular injury due to <strong>vegetative matter</strong> with ocular <strong>pain</strong>, <strong>redness</strong>, and the image depicting a <strong>corneal ulcer</strong> with<strong> feathery margins</strong> and a <strong>hypopyon</strong> is likely to have a <strong>fungal corneal ulcer.</strong> In this condition, the hypopyon is not sterile.&nbsp;</p>\n<p><strong>Fungal</strong> or mycotic <strong>keratitis</strong> is seen in <strong>tropical</strong> <strong>countries</strong>, rural areas, and in individuals who are <strong>immunocompromised</strong>. It occurs due to inoculation with <em><strong>Aspergillus</strong>, <strong>Fusarium</strong>,</em> or <em><strong>Candida</strong></em> species. It is generally seen after ocular injury with vegetable matter.&nbsp;</p>\n<p>The <strong>signs</strong> of a fungal corneal ulcer are <strong>generally more pronounced</strong> than the <strong>symptoms</strong>. Signs include:&nbsp;</p>\n<ul>\n<li><strong>Dry slough</strong> with <strong>feathery</strong> <strong>borders</strong></li>\n<li>Thick, immobile, <strong>hypopyon</strong> that occurs due to direct invasion of anterior chamber by <strong>fungal hyphae</strong> in thick exudates</li>\n<li><strong>Wesseley's immune ring</strong> due to deposition of immune complexes and inflammatory cells around the ulcer</li>\n<li>Satellite lesions</li>\n<li><strong>Ciliary</strong> and <strong>conjunctival</strong> <strong>congestion</strong> (symptoms of pain, watering, and photophobia are less severe than in cases of bacterial corneal ulcers)</li>\n</ul>\n<p>Fungal corneal ulcers are treated <strong>topically</strong> with <strong>natamycin</strong>, <strong>voriconazole</strong>, <strong>nystatin</strong>, or <strong>amphotericin B drops</strong>. If the ulcers are severe with hypopyon, perforated, or if there is endophthalmitis, then <strong>systemic antifungals</strong> need to be provided. Examples include<strong> oral ketoconazole </strong>or<strong> voriconazole.</strong> Surgical management is indicated if the ulcer progresses despite medical therapy.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://daily-rounds-staging.s3.amazonaws.com/uploads/b00076e7ecb542d09afcc272f845026b.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Arrange the following in proper order of blood supply to the uterus.",
    "choices": [
      {
        "id": 1,
        "text": "5-3-1-4-2"
      },
      {
        "id": 2,
        "text": "5-1-3-2-4"
      },
      {
        "id": 3,
        "text": "5-2-3-4-1"
      },
      {
        "id": 4,
        "text": "5-4-2-1-3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The correct order of the blood supply of the uterus is <strong>5-1-3-2-4</strong></p>\n<p><strong>The blood supply of the uterus</strong> is as follows:</p>\n<p>Uterine artery (5) -&gt; Arcuate artery (1) -&gt; Radial artery (3) -&gt; Basal artery (2) (Supplies basal layer of endometrium ) -&gt; Spiral artery (4) (Supplies functional endometrium)</p>\n<p>Bleeding during <strong>normal menstruation</strong> is due to the rupture of the <strong>spiral artery.</strong></p>\n<p>During normal menstruation:</p>\n<table style=\"width: 444px;\">\n<tbody>\n<tr>\n<td style=\"width: 191px;\"><strong>Superficial layer (2/3)</strong></td>\n<td style=\"width: 243px;\"><strong>Deep layer (1/3)\u00a0</strong></td>\n</tr>\n<tr>\n<td style=\"width: 191px;\">Consists of stratum compactum and stratum spongiosum</td>\n<td style=\"width: 243px;\">Consists of stratum basalis</td>\n</tr>\n<tr>\n<td style=\"width: 191px;\">Supplied by spiral artery</td>\n<td style=\"width: 243px;\">Supplied by basilar arteries</td>\n</tr>\n<tr>\n<td style=\"width: 191px;\">During the secretory phase, the artery undergoes vasoconstriction due to<strong> PGF-2alpha.</strong></td>\n<td style=\"width: 243px;\">Cannot undergo vasoconstriction as the artery is straight</td>\n</tr>\n<tr>\n<td style=\"width: 191px;\">Shed during menses (Normal shedding and bleeding)</td>\n<td style=\"width: 243px;\">Shed in the absence of progesterone (<strong>Heavy bleeding</strong>)</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/61c94baa7e1b49ef8f51cea62e6a268ex1280x1242.JPEG"
    ]
  },
  {
    "text": "A newborn is being evaluated for yellowish discoloration of the sclera and elevated bilirubin levels. Which of the following are indications to further evaluate the child to identify the cause of jaundice?",
    "choices": [
      {
        "id": 1,
        "text": "1 and 4"
      },
      {
        "id": 2,
        "text": "2, 3 and 4"
      },
      {
        "id": 3,
        "text": "1, 2, and 4"
      },
      {
        "id": 4,
        "text": "1, 2, and 3"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Statements 1, 2, and 3</strong>&nbsp;are suggestive of a <strong>pathological cause of jaundice</strong> and need to be further evaluated for the cause of jaundice.<strong>&nbsp;</strong></p>\n<p>Physiological jaundice occurs due to increased bilirubin production due to the&nbsp;<strong>destruction of the fetal RBCs</strong>&nbsp;along with a&nbsp;<strong>transient limitation in bilirubin conjugation</strong>&nbsp;in the immature neonatal liver.&nbsp;It&nbsp;<strong>first appears</strong>&nbsp;on the&nbsp;<strong>2nd&nbsp;or 3rd&nbsp;</strong>day, usually peaks between 2nd and 4th&nbsp;day at 5&ndash;6 mg/dL, and decreases to &lt;2 mg/dL between the 5th&nbsp;and 7th&nbsp;days after birth.</p>\n<p>Risk factors for physiological jaundice include maternal age, maternal diabetes, prematurity, drugs(Vitamin K3, novobiocin), polycythemia, male sex, trisomy 21, cutaneous bruising, blood extravasation as in cephalhematoma, breastfeeding, weight loss, and a family history of physiological jaundice.</p>\n<p>Jaundice in the newborn is not always physiological and in some cases, there can be an underlying pathology. Given below are the indications to evaluate a newborn to identify the cause of pathological jaundice:</p>\n<ul>\n<li>Jaundice that appears in the <strong>first 24-36 hours</strong> of birth</li>\n<li>A rise in serum bilirubin faster than 5mg/dL/24hr</li>\n<li>Serum bilirubin &gt; 12mg/dL in a full-term infant(especially if there are no risk factors)</li>\n<li>Serum bilirubin &gt; 10-14mg/dL in a preterm infant</li>\n<li>Persistent jaundice after <strong>10-14 days</strong> of birth</li>\n<li><strong>Direct bilirubin &gt; 2mg/dL</strong> at any time</li>\n</ul>\n<p>Other features suggestive of a nonphysiological cause of jaundice are a positive family history of any hemolytic disease, pallor, hepatosplenomegaly, vomiting, lethargy, poor feeding, apnea, bradycardia, hypothermia, light-colored stools, <strong>failure of phototherapy to lower the bilirubin levels</strong>, and signs of kernicterus.</p>\n<p>If there is persistent indirect hyperbilirubinemia for more than 2 weeks it indicates&nbsp;hemolysis, hereditary glucuronyl transferase deficiency, breastmilk jaundice, hypothyroidism, or intestinal obstruction.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Choose the correct statements regarding Hashimoto's thyroiditis:",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3 and 4"
      },
      {
        "id": 2,
        "text": "1, 2 and 3"
      },
      {
        "id": 3,
        "text": "2, 3 and 4"
      },
      {
        "id": 4,
        "text": "2 and 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Statements 2 and 4 are correct regarding&nbsp;Hashimoto's thyroiditis. It is characterized by the presence of antibodies against thyroid peroxidase and is associated with thyroid lymphomas.</p>\n<p>Statements 1 and 3 are false. <strong>Hashimoto's thyroiditis,</strong>&nbsp;most commonly causing <strong>hypothyroidism </strong>(not hyperthyroidism), is associated with <strong>high TSH</strong> and <strong>low T4 levels </strong>(not low TSH and high T4).&nbsp;</p>\n<p><strong>Hashimoto's thyroiditis&nbsp;</strong>is the most common cause of <strong>hypothyroidism</strong> in <strong>iodine-sufficient</strong> areas.&nbsp;It is an <strong>autoimmune disease</strong> that results in the destruction of the thyroid gland and gradual and progressive thyroid failure.</p>\n<p>It occurs most commonly among <strong>middle-aged women</strong>. It is associated with <strong>malignant lymphoma</strong> of thyroid.</p>\n<p>Patients present with <strong>painless</strong>&nbsp;<strong>diffuse enlargement</strong> of the thyroid gland.&nbsp;Since the follicles are damaged and cannot form the hormones anymore, these patients tend to be in a state of <strong>hypothyroidism</strong>. However, initially few patients may present with a transient hyperthyroid state, known as <strong>hashitoxicosis</strong>, due to the release of thyroid hormones by disruption of the thyroid follicles.</p>\n<p><strong>Laboratory investigations:</strong></p>\n<ul>\n<li>T<sub>3</sub> and T<sub>4</sub> are low</li>\n<li>TSH is raised</li>\n<li>Presence of<strong> autoantibodies</strong> against:<br />\n<ul>\n<li>Thyroid peroxidase (TPO)</li>\n<li>Thyroglobulin</li>\n</ul>\n</li>\n</ul>\n<p><strong>Histopathology of&nbsp;Hashimoto's thyroiditis:</strong></p>\n<p>Morphologically, there is a diffuse enlargement of the thyroid gland, with an intact capsule. It is well demarcated from the adjacent structures.</p>\n<p>Microscopic features include:</p>\n<ul>\n<li><strong>Intense lymphocytic infiltrate</strong> containing small lymphocytes, plasma cells, and well-developed germinal centres.</li>\n<li><strong>Atrophied thyroid follicles,</strong> lined by epithelial cells, contain eosinophilic granular cytoplasm. These epithelial cells are referred to as <strong>Hurthle cells.</strong></li>\n</ul>\n<p><strong>H&uuml;rthle cells </strong>arise from the <strong>follicular epithelium</strong>. These oncocytic cells include an <strong>eosinophilic granular cytoplasm.</strong></p>\n<p>The following image shows a histopathological picture of Hashimoto thyroiditis :</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2afa33b441e94f5fa9290177ee0a5d34x800x533.JPEG"
    ]
  }
];
        let quizName = 'Mini Test 29';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>