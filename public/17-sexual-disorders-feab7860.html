<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>17 Sexual Disorders - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Psychiatry
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">8</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>A therapist discusses the sexual response cycle with a patient. Which of the following statements is false about the sexual response cycle?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "The excitement stage involves increased blood pressure and heart rate."
      },
      {
        "id": 2,
        "text": "Males experience swelling of the glans and testes during the plateau stage."
      },
      {
        "id": 3,
        "text": "Females experience contractions of the vagina during orgasm."
      },
      {
        "id": 4,
        "text": "Both genders have a refractory period after orgasm."
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) Both genders have a <span class=\"customMeta\" data-dictid=\"3790c638ab16927771970a0a41d3ab\">refractory</span> period after orgasm.</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>Males experience a <span class=\"customMeta\" data-dictid=\"3790c638ab16927771970a0a41d3ab\">refractory</span> period after ejaculation, during which they cannot become aroused again for a period of time.</li>\n\t<li>Females do not have a <span class=\"customMeta\" data-dictid=\"3790c638ab16927771970a0a41d3ab\">refractory</span> period and can often become aroused again quickly after orgasm.</li>\n</ul>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:755px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align: center;\"><strong>Phases of the sexual response cycle</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Desire phase </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Consists of sex fantasies and the desire to have sex</li>\n\t\t\t\t<li>Associated disorder: <span class=\"customMeta\" data-dictid=\"94c97c561f1692777189792ca4a7d1\">Hypoactive</span> sexual desire disorder (HSDD)</li>\n\t\t\t</ul>\n\n\t\t\t<p>FDA drug approved to treat HSDD in <span class=\"customMeta\" data-dictid=\"a9f4834def16927771962441e4ed98\">premenopausal</span> women</p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Flibanserin- Partial 5HT1A agonist, oral drug</li>\n\t\t\t\t<li>Bremelanotide- Melanocortin <span class=\"customMeta\" data-dictid=\"9e4959f6f316927771978bb152d440\">receptor</span> agonist, <span class=\"customMeta\" data-dictid=\"d446e62c6c1692777199896fc1d4b9\">subcutaneous</span> injection)</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Excitement Stage</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Muscles tense, heart rate and <span class=\"customMeta\" data-dictid=\"263ee5444e1692777183a7e8e704da\">blood pressure</span> increase. <strong>(Option A ruled out)</strong></li>\n\t\t\t\t<li>Males: <span class=\"customMeta\" data-dictid=\"028d70d3e11692777195f204ee2764\">Penis</span> becomes erect.</li>\n\t\t\t\t<li>Females: <span class=\"customMeta\" data-dictid=\"9a1e50b8221692777201b95b66c9de\">Vaginal</span> walls become moist and wider; <span class=\"customMeta\" data-dictid=\"730ba6fe50169277718492019976c7\">clitoris</span> enlarges.</li>\n\t\t\t\t<li><strong>Associated disorder: </strong><strong>Male</strong><strong> <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">erectile</span> dysfunction, </strong><strong>Female Sexual <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> disorder</strong></li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Plateau Stage</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Breathing becomes faster; muscles continue to tense.</li>\n\t\t\t\t<li>Males: <span class=\"customMeta\" data-dictid=\"e62ab50e7a16927771882c6a886b18\">Glans</span> swell; <span class=\"customMeta\" data-dictid=\"52d0e8b461169277720097e2175a05\">testes</span> enlarge. <strong>(Option B ruled out)</strong></li>\n\t\t\t\t<li>Females: Outer <span class=\"customMeta\" data-dictid=\"8537d8358c169277720162f2f6971b\">vagina</span> contracts; <span class=\"customMeta\" data-dictid=\"730ba6fe50169277718492019976c7\">clitoris</span> retracts.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Orgasm Stage</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Neuromuscular tension releases.</li>\n\t\t\t\t<li>Males: <span class=\"customMeta\" data-dictid=\"028d70d3e11692777195f204ee2764\">Penis</span> contracts, ejaculating <span class=\"customMeta\" data-dictid=\"8dc15ef09e1692777198320917e46b\">sperm</span> and semen.</li>\n\t\t\t\t<li>Females: <span class=\"customMeta\" data-dictid=\"8537d8358c169277720162f2f6971b\">Vagina</span> contracts rhythmically. <strong>(Option C ruled out)</strong></li>\n\t\t\t\t<li><strong>Associated disorder: </strong><strong>Female orgasmic disorder,</strong><strong> <span class=\"customMeta\" data-dictid=\"84f13673191692777196762b18e036\">premature</span> ejaculation, delayed ejaculation.</strong></li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Resolution Stage</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>The body gradually returns to its resting state.</li>\n\t\t\t\t<li>Males: <span class=\"customMeta\" data-dictid=\"028d70d3e11692777195f204ee2764\">Penis</span> shrinks; includes a <span class=\"customMeta\" data-dictid=\"3790c638ab16927771970a0a41d3ab\">refractory</span> period where further <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> is not possible.</li>\n\t\t\t\t<li>Females: No <span class=\"customMeta\" data-dictid=\"3790c638ab16927771970a0a41d3ab\">refractory</span> period; can become aroused again quickly.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/VK1dYESqarzUU6R4bqeq1737954906.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/0xSFqTBvqERzag7aiqEj1737955193.mp3"
  },
  {
    "text": "<p>A 50-year-old man reports to his doctor that he is having difficulty achieving an erection during intercourse. He mentions this issue has been ongoing for the past year, despite having previously enjoyed a healthy sex life. Which statement about his condition is TRUE?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Erectile dysfunction is common in all ageing men."
      },
      {
        "id": 2,
        "text": "Phosphodiesterase-5 inhibitors can be safely used with nitrates."
      },
      {
        "id": 3,
        "text": "Situational erectile disorder means he can achieve erections in certain situations."
      },
      {
        "id": 4,
        "text": "Organic Erectile Dysfunction occurs in men with relationship issues."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Situational <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">erectile</span> disorder means he can achieve erections in certain situations.</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Situational <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">erectile</span> disorder allows for erections in specific circumstances.</p>\n\n<p>\u00a0</p>\n\n<p><strong><u>Erectile Dysfunction</u></strong></p>\n\n<ul>\n\t<li>Incidence increases with age; reported in 2-8% of young adults and is more common in older men.</li>\n\t<li>Not universal in aging; factors like having a partner and consistent sexual activity are protective. <strong>(Option A)</strong></li>\n\t<li>Episodes of <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">erectile</span> disorder can increase anxiety in future sexual encounters.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Causes:</strong></p>\n\n<ul>\n\t<li><strong>Organic Causes:</strong> Due to medical conditions or medications.\n\n\t<ul>\n\t\t<li><strong>Medical Conditions:</strong> <span class=\"customMeta\" data-dictid=\"e2b5f013011692777183ea1b11ed9c\">Cardiovascular</span> diseases (hypertension, atherosclerosis, <span class=\"customMeta\" data-dictid=\"bc8bc758371692777185eff2ccabb7\">coronary</span> <span class=\"customMeta\" data-dictid=\"a66cd3adaa1692777182e77cb23021\">artery</span> disease), Diabetes mellitus, Neurological disorders (multiple sclerosis, Parkinson's disease, <span class=\"customMeta\" data-dictid=\"d816ba952f1692777199fc69bd7c56\">spinal</span> cord injuries), <span class=\"customMeta\" data-dictid=\"d8216cf7571692777187baa94b8612\">Endocrine</span> disorders (hypogonadism, hyperprolactinemia, <span class=\"customMeta\" data-dictid=\"799202e6fe16927772009a1501b0a8\">thyroid</span> dysfunction), Chronic <span class=\"customMeta\" data-dictid=\"4aa6035df41692777190b41d4a1583\">kidney</span> disease, Liver cirrhosis, <span class=\"customMeta\" data-dictid=\"7cd6eb19341692777195d83aafdcb3\">Pelvic</span> or <span class=\"customMeta\" data-dictid=\"19c0231fc41692777196ffce23771d\">prostate</span> surgeries, Sleep disorders (obstructive sleep apnea).</li>\n\t\t<li><strong>Medications: </strong>Antihypertensives (beta-blockers, <span class=\"customMeta\" data-dictid=\"74c7df38ec169277720012966920d9\">thiazide</span> diuretics), Antidepressants (SSRIs, <span class=\"customMeta\" data-dictid=\"66bf14385516927772001b3646b855\">tricyclic</span> antidepressants), Antipsychotics (typical and atypical), Anti-androgens (finasteride, spironolactone), Opioids, <span class=\"customMeta\" data-dictid=\"8602c4b260169277718439bb122cb0\">Chemotherapy</span> agents, Anticonvulsants, H2-receptor antagonists (cimetidine).</li>\n\t</ul>\n\t</li>\n\t<li><strong>Psychogenic Causes:</strong> More common in young and middle-aged men; often related to psychological factors such as fear, anxiety, or relationship issues. <strong>(Option D)</strong></li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Types of Male <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">Erectile</span> Disorder:</strong></p>\n\n<ol>\n\t<li><strong>Lifelong Male <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">Erectile</span> Disorder:</strong>\n\n\t<ul>\n\t\t<li>Never able to achieve an <span class=\"customMeta\" data-dictid=\"322d94cd5816927771872f3d8d132b\">erection</span> sufficient for insertion. <strong>(Option B)</strong></li>\n\t\t<li>Rare, occurring in about 1% of <span class=\"customMeta\" data-dictid=\"e48bb8abfa1692777192e3fa06774f\">men</span> under 35.</li>\n\t</ul>\n\t</li>\n\t<li><strong>Acquired Male <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">Erectile</span> Disorder:</strong>\n\t<ul>\n\t\t<li>Previously able to achieve <span class=\"customMeta\" data-dictid=\"31dd0b58bb1692777195e6016ecd51\">penetration</span> but later unable to do so.</li>\n\t\t<li>Affects 10-20% of all men.</li>\n\t</ul>\n\t</li>\n\t<li><strong>Situational Male <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">Erectile</span> Disorder:</strong>\n\t<ul>\n\t\t<li>Able to have erections in certain situations (e.g., with a sex worker) but not with a partner.</li>\n\t</ul>\n\t</li>\n</ol>\n\n<p>\u00a0</p>\n\n<p><strong>Investigations used to record <span class=\"customMeta\" data-dictid=\"d51601f2c41692777193ddfa55d163\">nocturnal</span> erections are:</strong></p>\n\n<ul>\n\t<li>Nocturnal penile tumescence</li>\n\t<li>Penile <span class=\"customMeta\" data-dictid=\"5e7bc7da6d16927771950fcdea984a\">plethysmography</span> (which measures <span class=\"customMeta\" data-dictid=\"263ee5444e1692777183a7e8e704da\">blood pressure</span> in the penis).</li>\n</ul>\n\n<p>These are used to <span class=\"customMeta\" data-dictid=\"c9001edbf216927771860f3475b44c\">differentiate</span> between organic and <span class=\"customMeta\" data-dictid=\"69260ddf071692777196d499092ef6\">psychogenic</span> <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">erectile</span> dysfunction.</p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:767px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align: center;\"><strong>Treatment of <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">Erectile</span> Dysfunction</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td rowspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Pharmacotherapy </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Phosphodiesterase-5 inhibitors (PDE-5 inhibitors)</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Nitric <span class=\"customMeta\" data-dictid=\"e08c004e8f1692777194c9d37e17ad\">oxide</span> enhancers- facilitates <span class=\"customMeta\" data-dictid=\"82cc227a1c169277718387905b50c6\">blood flow</span> into the <span class=\"customMeta\" data-dictid=\"028d70d3e11692777195f204ee2764\">penis</span> and enhances erection.</li>\n\t\t\t\t<li>Drugs- <strong>Sildenafil, tadalafil, </strong> <strong>vardenafil </strong>and <strong>Avanafil.</strong></li>\n\t\t\t\t<li>Not used along with organic nitrates- Can cause sudden fall in <span class=\"customMeta\" data-dictid=\"263ee5444e1692777183a7e8e704da\">blood pressure</span> and can be fatal. <strong>(Option B)</strong></li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Other medications:</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Oral <strong>phentolamine</strong>: May reduce <span class=\"customMeta\" data-dictid=\"5731c5431416927771999e54e2563b\">sympathetic</span> tone and relax muscles of <span class=\"customMeta\" data-dictid=\"8c62bbe6721692777185d6892c1f31\">corpora</span> cavernosa and subsequently improve the erection.</li>\n\t\t\t\t<li><strong>Alprostadil </strong>contains naturally occurring <span class=\"customMeta\" data-dictid=\"42815e46071692777196c90c46f78b\">prostaglandin</span> E (vasodilating agent).</li>\n\t\t\t\t<li>Alprostadil- Directly <span class=\"customMeta\" data-dictid=\"6a367ebd0c169277719091155a5b0f\">injected</span> into <span class=\"customMeta\" data-dictid=\"8c62bbe6721692777185d6892c1f31\">corpora</span> cavernosa or given <span class=\"customMeta\" data-dictid=\"6663e9c245169277719095b99071eb\">intraurethral</span> through a <span class=\"customMeta\" data-dictid=\"7611186da51692777183be9dcf4063\">cannula</span> as a pellet.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td rowspan=\"3\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Psychotherapy</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Dual sex therapy:</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>It was derived by Masters and Johnson.</li>\n\t\t\t\t<li>It is also effective for other sexual disorders as well.</li>\n\t\t\t\t<li>It means it treats the couple (not individual). Both the partners are involved in the treatment.</li>\n\t\t\t\t<li>Couples are taught: To improve their communication and Exercises to increase <span class=\"customMeta\" data-dictid=\"408bcde7f01692777198acadb8e1c6\">sensory</span> awareness.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Sensate focus exercises:</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>It has two stages:</li>\n\t\t\t\t<li><strong>Non-genital sensate focus: </strong>Couples should touch, rub, or kiss each other body parts excluding breasts, and genitals</li>\n\t\t\t\t<li><strong>Genital sensate focus: </strong>Stage II Involves only breasts and genitals. Subsequently, the couple can engage in complete intercourse.</li>\n\t\t\t\t<li>Purpose of exercises is to make the couple aware that pleasure can be given and received by methods other than sexual <span class=\"customMeta\" data-dictid=\"ad25936d1916927771900a1de2dd77\">intercourse</span> (penetration).</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Others:</strong></p>\n\n\t\t\t<ul>\n\t\t\t\t<li>Behavioral therapy</li>\n\t\t\t\t<li>Hypnotherapy</li>\n\t\t\t\t<li>Psychoanalysis</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/SVG4WymjEruzYpqeblJa1737955813.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/WZB2jCfGZXlCmNqbfdoU1737956074.mp3"
  },
  {
    "text": "<p>A 30-year-old man visits his doctor expressing frustration with his sexual performance. He reports that he ejaculates within 30 seconds of vaginal penetration, which has caused distress in his relationship. Which of the following treatments is not typically used for premature ejaculation?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Squeeze technique"
      },
      {
        "id": 2,
        "text": "Stop-start technique"
      },
      {
        "id": 3,
        "text": "SSRI"
      },
      {
        "id": 4,
        "text": "Sildenafil"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) Sildenafil</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li><strong>Sildenafil</strong> is used to treat <span class=\"customMeta\" data-dictid=\"5cc2a2112e16927771874c5d97065a\">erectile</span> dysfunction, not <span class=\"customMeta\" data-dictid=\"84f13673191692777196762b18e036\">premature</span> ejaculation.</li>\n\t<li>It works by increasing <span class=\"customMeta\" data-dictid=\"82cc227a1c169277718387905b50c6\">blood flow</span> to the <span class=\"customMeta\" data-dictid=\"028d70d3e11692777195f204ee2764\">penis</span> but does not address the timing of ejaculation.</li>\n</ul>\n\n<p><strong>Premature <span class=\"customMeta\" data-dictid=\"9ee9011df41692777187bfb1eea894\">Ejaculation</span> (PME)</strong></p>\n\n<ul>\n\t<li>A pattern of persistent or <span class=\"customMeta\" data-dictid=\"c64e3a661b1692777197afc2ff7bca\">recurrent</span> <span class=\"customMeta\" data-dictid=\"9ee9011df41692777187bfb1eea894\">ejaculation</span> with minimal sexual <span class=\"customMeta\" data-dictid=\"7f3792072b1692777199fd8e2c4f59\">stimulation</span> before or immediately after <span class=\"customMeta\" data-dictid=\"9a1e50b8221692777201b95b66c9de\">vaginal</span> penetration.</li>\n\t<li>DSM-5- <span class=\"customMeta\" data-dictid=\"9ee9011df41692777187bfb1eea894\">Ejaculation</span> occurs <strong>within <1 minute</strong> following <span class=\"customMeta\" data-dictid=\"9a1e50b8221692777201b95b66c9de\">vaginal</span> penetration</li>\n\t<li>The cause of PME is usually psychogenic.</li>\n</ul>\n\n<p><img alt=\"Premature <span class=\"customMeta\" data-dictid=\"9ee9011df41692777187bfb1eea894\">Ejaculation</span> (PME) treatment\" data-author=\"\" data-hash=\"1174\" data-license=\"\" data-source=\"\" data-tags=\"March2025\" src=\"https://image.prepladder.com/notes/FEpnBa0ExDBZVS8Yf0SO1742541734.png\" /></p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/741uA3nTic4V5uSE2T6B1737956270.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/glafJjV2UQHXXJs3pdm91737956380.mp3"
  },
  {
    "text": "<p>A 32-year-old woman presents to her gynecologist with concerns about her inability to achieve orgasm during sexual activity with her partner. She reports that this has been an ongoing issue for the past 8 months and is causing distress in her relationship. She has normal sexual desire but is unable to reach orgasm despite adequate stimulation She has no history of medical conditions or medication use that might explain these symptoms. Which of the following is the most likely diagnosis based on the DSM-5 criteria?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Hypoactive sexual desire disorder"
      },
      {
        "id": 2,
        "text": "Female sexual interest/arousal disorder"
      },
      {
        "id": 3,
        "text": "Female orgasmic disorder"
      },
      {
        "id": 4,
        "text": "Sexual aversion disorder"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Female orgasmic disorder</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>The patient's symptoms of persistent inability to achieve <span class=\"customMeta\" data-dictid=\"2d339afb5e1692777194c62366d3b1\">orgasm</span> during sexual activity, lasting for at least 6 months and causing distress, align with the <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> criteria for <strong>female orgasmic disorder,</strong> according to DSM-5.</li>\n</ul>\n\n<p><strong>Female orgasmic disorder (DSM-5)</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Definition</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Recurrent or persistent <span class=\"customMeta\" data-dictid=\"f03ca2d2a716927771901227bc175a\">inhibition</span> of female orgasm, as manifested by delay in, or absence of <span class=\"customMeta\" data-dictid=\"2d339afb5e1692777194c62366d3b1\">orgasm</span> after a normal sexual excitement phase</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Duration</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>\u22656 months</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Symptoms</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Difficulties with orgasms</li>\n\t\t\t\t<li>Delayed/reduced frequency of orgasms</li>\n\t\t\t\t<li>Reduced intensity of orgasms</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Diagnostic Criteria</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>\u22651 symptom during most sexual encounters</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Treatment</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Psychotherapy</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Hypoactive sexual desire disorder (Option A): </strong>Hypoactive sexual desire disorder involves a <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> sexual desire, which is not mentioned in the patient's presentation.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Female sexual interest/arousal disorder (Option B):</strong> Female sexual interest/arousal disorder involves a lack of sexual interest or arousal, which is not the primary complaint here.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Sexual aversion disorder (Option D): </strong>Sexual aversion disorder is not a DSM-5 diagnosis and involves an aversion to sexual contact, which is not described in this case.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/ROIfdjwv3bljERPAaPce1737957098.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/CvNpJE7Gq3rnfTx0xOrq1737957229.mp3"
  },
  {
    "text": "<p>A 7-year-old child assigned female at birth has been consistently expressing a strong desire to be a boy for the past 2.5 years. The child prefers traditionally masculine clothing, toys, and activities, and becomes upset when referred to as a girl. What is the most appropriate diagnosis according to the ICD-11 criteria?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Transsexualism"
      },
      {
        "id": 2,
        "text": "Dual-role transvestism"
      },
      {
        "id": 3,
        "text": "Gender identity disorder of adolescence"
      },
      {
        "id": 4,
        "text": "Gender incongruence in childhood"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) Gender incongruence in childhood</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>This case meets the criteria for <strong>gender incongruence of childhood</strong> as defined by ICD-11:</p>\n\n<ul>\n\t<li>There is a marked incongruence between the child's experienced/expressed gender and assigned sex.</li>\n\t<li>The child shows a strong desire to be a different gender than the assigned sex.</li>\n\t<li>The child exhibits preferences for clothes, toys, and activities typical of the experienced gender.</li>\n\t<li>The duration of symptoms (2.5 years) exceeds the requirement of 2 years.</li>\n\t<li>The child shows <span class=\"customMeta\" data-dictid=\"afafb9026e1692777186e3dd168fa8\">distress</span> when <span class=\"customMeta\" data-dictid=\"ef4efed5d61692777188f931d3254e\">gender identity</span> is not acknowledged (upset when <span class=\"customMeta\" data-dictid=\"047f8930dd1692777197fed61e213c\">referred</span> to as a girl).</li>\n\t<li>The child is prepubertal.</li>\n</ul>\n\n<p>According to <strong>ICD-11</strong>, gender <span class=\"customMeta\" data-dictid=\"08289506491692777186a3dceb93ad\">dysphoria</span> has been classified into:</p>\n\n<ul>\n\t<li><strong>Gender incongruence of <span class=\"customMeta\" data-dictid=\"98d9739e5f1692777180d7de404750\">adolescence</span> or adulthood </strong><strong>(Option C)</strong><strong>: </strong>A marked incongruence between an individual's experienced/expressed gender and assigned sex, lasting at least 6 months, manifesting in <span class=\"customMeta\" data-dictid=\"98d9739e5f1692777180d7de404750\">adolescence</span> or adulthood.</li>\n\t<li><strong>Gender incongruence of childhood: </strong>A marked incongruence between a child's experienced/expressed gender and assigned sex, lasting at least 6 months, manifesting before <span class=\"customMeta\" data-dictid=\"c284c4252f16927771963c07a95e13\">puberty</span> onset.</li>\n\t<li><strong>Gender incongruence, unspecified: </strong>A condition where an individual experiences a mismatch between their <span class=\"customMeta\" data-dictid=\"ef4efed5d61692777188f931d3254e\">gender identity</span> and assigned sex, without specifying age of onset or meeting full <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> criteria.</li>\n</ul>\n\n<p>Previously in <strong>ICD-10</strong>, gender <span class=\"customMeta\" data-dictid=\"08289506491692777186a3dceb93ad\">dysphoria</span> consisted of:</p>\n\n<ul>\n\t<li><strong>Transsexualism (Option A): </strong>Desire to live as the opposite sex, often seeking surgery and hormone therapy.</li>\n\t<li><strong>Dual-role <span class=\"customMeta\" data-dictid=\"7b8b6f473416927772008effa75456\">transvestism</span> (Option B): </strong>Cross-dressing without a desire for permanent sex change.</li>\n\t<li>Gender identity disorder of childhood<strong>: </strong>Persistent discomfort with one's gender starting in childhood.</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/pxCivalEsWLn51LLKN6B1737957742.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/tbeF61HQ3tFGKzRXYkC81737957872.mp3"
  },
  {
    "text": "<p>A 28-year-old male presents to the psychiatric clinic with distressing thoughts and behaviors involving intense sexual arousal from observing unsuspecting individuals in private settings. He reports that he has experienced these urges for several years and has acted on them multiple times, which has caused legal and interpersonal problems. Which of the following paraphilias best fits his symptoms?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Voyeurism"
      },
      {
        "id": 2,
        "text": "Exhibitionism"
      },
      {
        "id": 3,
        "text": "Fetishism"
      },
      {
        "id": 4,
        "text": "Masochism"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Voyeurism, or scopophilia, is a persistent focus on fantasies and behaviors involving the observation of unaware individuals who are nude or involved in sexual activities.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Disorders of Sexual Preference (Paraphilias/Perversions): </strong></p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Fetishism</strong></p>\n\n\t\t\t<p><strong>(Option C)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>In fetishism, sexual interest centers on objects (such as shoes, gloves, or stockings) closely <span class=\"customMeta\" data-dictid=\"8d0fca798b1692777191b6cd41880f\">linked</span> to the human body, or on non-genital body parts.</li>\n\t\t\t\t<li>The latter focus is sometimes called partialism.</li>\n\t\t\t\t<li>Exclusively found in men.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Exhibitionism</strong></p>\n\n\t\t\t<p><strong>(Option B)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Exhibitionism is the <span class=\"customMeta\" data-dictid=\"c64e3a661b1692777197afc2ff7bca\">recurrent</span> urge to expose the <span class=\"customMeta\" data-dictid=\"1588e9cd72169277718891982853b4\">genitals</span> to a stranger or an unsuspecting person.</li>\n\t\t\t\t<li>Almost exclusively found in men.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Transvestism/</strong></p>\n\n\t\t\t<p><strong>Eonism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Previously known as <span class=\"customMeta\" data-dictid=\"5f6a6bae2a1692777200a3a754073a\">transvestic</span> fetishism. <span class=\"customMeta\" data-dictid=\"8da830779416927772004eec86224b\">Trans</span> means opposite and vest means clothes</li>\n\t\t\t\t<li>Persons <span class=\"customMeta\" data-dictid=\"5d07a26d7516927771863e5f43d8d0\">dressing</span> in opposite gender clothes for sexual pleasure.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Frotteurism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Characterized by a man <span class=\"customMeta\" data-dictid=\"97ae59957c1692777197359406f6f4\">rubbing</span> his <span class=\"customMeta\" data-dictid=\"028d70d3e11692777195f204ee2764\">penis</span> against the <span class=\"customMeta\" data-dictid=\"a0af4564cf1692777183e503d226f6\">buttocks</span> or other body parts of a fully clothed woman to achieve orgasm.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Voyeurism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Persistent focus on fantasies and behaviors involving the observation of unaware individuals who are nude or involved in sexual activities</li>\n\t\t\t\t<li>Also known as scopophilia</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Masochism</strong></p>\n\n\t\t\t<p><strong>(Option D)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Recurrent sexual <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> from being humiliated, beaten, bound, or made to suffer.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Sadism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Recurrent sexual <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> from the physical or psychological suffering of another person.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Pedophilia</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Pedophilia involves <span class=\"customMeta\" data-dictid=\"c64e3a661b1692777197afc2ff7bca\">recurrent</span> intense sexual urges toward, or <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> by, children.</li>\n\t\t\t\t<li>As per DSM-5, the child must be under 14 years old, and the patient must be at least 16 years old and at least five years older than the victims.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Other paraphilic disorders</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Necrophilia: </strong>Obtaining sexual gratification from corpses/cadavers.</li>\n\t\t\t\t<li><strong>Zoophilia: </strong>Sexual <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> from animals.</li>\n\t\t\t\t<li><strong>Telephone and computer scatologia:</strong> Sexual <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> involving obscene phone calls or obscene messages/images to unsuspecting persons.</li>\n\t\t\t\t<li><strong>Coprophilia:</strong> Sexual pleasure associated with desire to defecate on a partner/to be defecated on/eat feces.</li>\n\t\t\t\t<li><strong>Urophilia: </strong>Sexual pleasure associated with desire to <span class=\"customMeta\" data-dictid=\"c0b5bbe709169277720177f8c58ad5\">urinate</span> on a partner/to be urinated on.</li>\n\t\t\t\t<li><strong>Klismaphilia:</strong> Use of enemas for sexual stimulation.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Treatment: </strong>Psychotherapy - <span class=\"customMeta\" data-dictid=\"1379c8802a16927771855438a89e1e\">Cognitive Behavior Therapy</span> (CBT)</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/VW5LBMYF82p42wXWqSmz1737958167.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/udUOHUtJZUYKSwxYivJo1737958311.mp3"
  },
  {
    "text": "<p>Which of the following paraphilias involves sexual arousal from interaction with corpses?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Necrophilia"
      },
      {
        "id": 2,
        "text": "Coprophilia"
      },
      {
        "id": 3,
        "text": "Klismaphilia"
      },
      {
        "id": 4,
        "text": "Nymphomania"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Necrophilia</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Necrophilia is a type of <strong>paraphilic disorder </strong>that refers to obtaining sexual gratification from corpses/cadavers.</p>\n\n<p>\u00a0</p>\n\n<ul>\n\t<li><strong>Necrophilia (Option A):</strong> Obtaining sexual gratification from corpses/cadavers.</li>\n\t<li><strong>Zoophilia: </strong>Sexual <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> from animals.</li>\n\t<li><strong>Telephone and computer scatologia:</strong> Sexual <span class=\"customMeta\" data-dictid=\"bf639c9a2316927771825e1632d9fb\">arousal</span> involving obscene phone calls or obscene messages/images to unsuspecting persons.</li>\n\t<li><strong>Coprophilia (Option B):</strong> Sexual pleasure associated with desire to defecate on a partner/to be defecated on/eat feces.</li>\n\t<li><strong>Urophilia:</strong> Sexual pleasure associated with desire to <span class=\"customMeta\" data-dictid=\"c0b5bbe709169277720177f8c58ad5\">urinate</span> on a partner/to be urinated on.</li>\n\t<li><strong>Klismaphilia (Option C):</strong> Use of enemas for sexual stimulation.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Nymphomania (Option D)</strong> is a type of sexual <span class=\"customMeta\" data-dictid=\"f6feed79981692777180c082188cc7\">addiction</span> which includes abnormal, excessive, insatiable desire in a woman for sexual intercourse.</p>\n\n<ul>\n\t<li>In a man, a similar condition is called <strong>satyriasis</strong>, which involves excessive sexual desire in males.</li>\n</ul>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/Hz80J1E4vbsgfW4QrHhJ1737958730.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/GVStgi9B5EFQLrb7Ktea1737958845.mp3"
  },
  {
    "text": "<p>Which of the following sexual pain disorders involves painful intercourse due to involuntary muscle spasms in the pelvic floor?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Sexual aversion disorder"
      },
      {
        "id": 2,
        "text": "Dyspareunia"
      },
      {
        "id": 3,
        "text": "Vaginismus"
      },
      {
        "id": 4,
        "text": "Vulvodynia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Vaginismus</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li><strong>Vaginismus </strong>is a <span class=\"customMeta\" data-dictid=\"4880e9b3761692777185e64eba797c\">constriction</span> of the outer third of the <span class=\"customMeta\" data-dictid=\"8537d8358c169277720162f2f6971b\">vagina</span> due to <span class=\"customMeta\" data-dictid=\"42b110efe11692777190ea5720c867\">involuntary</span> <span class=\"customMeta\" data-dictid=\"7cd6eb19341692777195d83aafdcb3\">pelvic</span> floor muscle tightening or spasm.</li>\n\t<li>It interferes with penile <span class=\"customMeta\" data-dictid=\"c88a7c1a0116927771909b2463968d\">insertion</span> and intercourse.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Genito-Pelvic Pain/Penetration Disorder:</strong></p>\n\n<p>In DSM-5, this disorder refers to one or more of the following complaints, of which any two or more may occur together:</p>\n\n<ul>\n\t<li>Difficulty having intercourse</li>\n\t<li>Genito-pelvic pain</li>\n\t<li>Fear of pain or penetration</li>\n\t<li>Tension of the <span class=\"customMeta\" data-dictid=\"7cd6eb19341692777195d83aafdcb3\">pelvic</span> floor muscles</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>These pain disorders are diagnosed as <span class=\"customMeta\" data-dictid=\"2109919ad7169277718654f3267482\">dyspareunia</span> or vaginismus:</strong></p>\n\n<ul>\n\t<li><strong>Dyspareunia (Option B): </strong>\n\n\t<ul>\n\t\t<li>Recurrent or persistent <span class=\"customMeta\" data-dictid=\"0e919a208b16927771885d9c1f6662\">genital</span> pain occurring before, during, or after intercourse.</li>\n\t\t<li>Although they frequently coexist, it does not specifically involve <span class=\"customMeta\" data-dictid=\"42b110efe11692777190ea5720c867\">involuntary</span> muscle spasms making <span class=\"customMeta\" data-dictid=\"2f60be1cc01692777201b563851cba\">vaginismus</span> a better answer here.</li>\n\t</ul>\n\t</li>\n\t<li><strong>Vaginismus: </strong>\n\t<ul>\n\t\t<li><strong>\u200b\u200b\u200b\u200b\u200b\u200b\u200b</strong>It is the <span class=\"customMeta\" data-dictid=\"4880e9b3761692777185e64eba797c\">constriction</span> of the outer third of the <span class=\"customMeta\" data-dictid=\"8537d8358c169277720162f2f6971b\">vagina</span> due to <span class=\"customMeta\" data-dictid=\"42b110efe11692777190ea5720c867\">involuntary</span> <span class=\"customMeta\" data-dictid=\"7cd6eb19341692777195d83aafdcb3\">pelvic</span> floor muscle tightening or spasm.</li>\n\t\t<li>It interferes with penile <span class=\"customMeta\" data-dictid=\"c88a7c1a0116927771909b2463968d\">insertion</span> and intercourse.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Treatment:</strong></p>\n\n<ul>\n\t<li>Dilating <span class=\"customMeta\" data-dictid=\"8537d8358c169277720162f2f6971b\">vagina</span> (or) opening with fingers or with dilators.</li>\n\t<li>Dilators may also help in dyspareunia.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Sexual aversion disorder (Option A) </strong>is characterized by a strong aversion to sexual activity, rather than physical pain during penetration.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Vulvodynia (Option D) </strong>refers to chronic vulvar pain that is not associated with an identifiable cause, which can occur during sexual activity, but it is not primarily caused by muscle spasms.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/w53c13KUnZVpNlyfKq4i1737959342.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/r1oWYQGYT54fVWAnBXUb1737959479.mp3"
  }
];
        let quizName = '17 Sexual Disorders';
        let hierarchy = ["PrepLadder", "qBank", "Psychiatry"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>