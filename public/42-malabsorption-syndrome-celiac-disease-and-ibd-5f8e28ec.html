<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>42 Malabsorption Syndrome, Celiac Disease, And Ibd - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Pathology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">14</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>A 47-year-old male presents with chronic diarrhoea, unintentional weight loss, joint pain, pallor, and generalised weakness. Upper GI endoscopy and biopsy revealed characteristic histopathological findings suggestive of Whipple's disease. Which of the following histopathological features would have led to the diagnosis?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Foamy macrophages filled with PAS-positive granules"
      },
      {
        "id": 2,
        "text": "Villous atrophy and blunting of the small intestinal mucosa"
      },
      {
        "id": 3,
        "text": "Lymphoplasmacytic infiltrate in the lamina propria"
      },
      {
        "id": 4,
        "text": "Presence of caseating granulomas and acid-fast bacilli"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Foamy macrophages filled with PAS-positive granules</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Whipple's disease is a <span class=\"customMeta\" data-dictid=\"819ebcc6691692777191f968d41a03\">malabsorption</span> problem: Nothing will get absorbed from the intestine, especially fats, leading to Steatorrhea.</p>\n\n<p>\u00a0</p>\n\n<p>Whipple\u2019s disease:</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Feature</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Explanation</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Pathogen</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Tropheryma whipplei (actinomycete) (Gram positive bacteria)</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Symptoms</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Diarrhoea (due to impaired <span class=\"customMeta\" data-dictid=\"4fb6bd90f016927771918d4a2993ed\">lymphatic</span> drainage), weight loss, and arthralgia.</li>\n\t\t\t\t<li>Others: arthritis, fever, lymphadenopathy, neurologic, cardiac, or <span class=\"customMeta\" data-dictid=\"10e2dee19e1692777196673db90c23\">pulmonary</span> involvement</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Histology</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Characterised by foamy macrophages in the small intestinal <span class=\"customMeta\" data-dictid=\"9864ad42b21692777191febeee1002\">lamina</span> propria, which contain <span class=\"customMeta\" data-dictid=\"53ddc0755c1692777195e8d5f9fc68\">periodic</span> acid Schiff (PAS)-positive and diastase-resistant granules, representing partially digested bacteria within lysosomes</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">Diagnosis</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">PCR is a better diagnosis than biopsy</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p style=\"text-align:center\"><img alt=\"Whipple_disease HE\" data-author=\"Nephron, Dr. Don Xu, Hrach Harutyunyan\" data-hash=\"761\" data-license=\"CC BY SA 3.0, CC BY SA 4.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Whipple_disease_-_high_mag.jpg, https://commons.wikimedia.org/wiki/File:Whipple%27s_disease_-_PAS_stain.jpg\" data-tags=\"January2025\" height=\"496\" src=\"https://image.prepladder.com/notes/P2mXtPdSBhgrSQRGeg3A1737003734.jpg\" width=\"773\" /></p>\n\n<p><strong>Villous <span class=\"customMeta\" data-dictid=\"97ff5253fb169277718224c7b0faf8\">atrophy</span> and <span class=\"customMeta\" data-dictid=\"6fd1f7611516927771836db4e712a1\">blunting</span> of the small intestinal mucosa</strong> <strong>(Option B)</strong><strong>: </strong>Seen in <span class=\"customMeta\" data-dictid=\"c2b5c161b71692777184c75775751a\">celiac</span> disease or <span class=\"customMeta\" data-dictid=\"29771deef31692777188c19fb41999\">gluten</span> sensitivity</p>\n\n<p><strong>Lymphoplasmacytic <span class=\"customMeta\" data-dictid=\"8fd5e2898d16927771900855b98180\">infiltrate</span> in the <span class=\"customMeta\" data-dictid=\"9864ad42b21692777191febeee1002\">lamina</span> propria</strong> <strong>(Option C)</strong><strong>:\u00a0</strong>Seen in TB</p>\n\n<p><strong>Presence of caseating granulomas and <span class=\"customMeta\" data-dictid=\"440f2b916316927771808b8ad44a64\">acid-fast</span> bacilli</strong> <strong>(Option D)</strong><strong>: </strong>Seen in\u00a0Crohn's disease</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/P2mXtPdSBhgrSQRGeg3A1737003734.jpg"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/AHccYbwawLq3J6KMzgNe1750750014.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/EmXzEC3BBEG8Ge6cI5ce1750750117.mp3"
  },
  {
    "text": "<p>A 35-year-old female presents with chronic diarrhoea, abdominal bloating, and unintended weight loss. She reports discomfort after consuming gluten-containing foods. Laboratory tests show elevated tissue transglutaminase (tTG) and anti-endomysial antibodies (EMA) levels, prompting a small intestinal biopsy via upper endoscopy. Which of the following combinations of histopathological features will be seen in this condition?</p>\n\n<ol>\n\t<li>Intraepithelial CD8+ T Lymphocytes</li>\n\t<li>Crypt hyperplasia</li>\n\t<li>Villous atrophy</li>\n\t<li>Decreased mitotic activity</li>\n\t<li>Inflammatory cell infiltration in lamina propria</li>\n</ol>\n\n<p><img alt=\"Celiac Disease Histopathology\" data-author=\"GeneFood\" data-hash=\"5500\" data-license=\"CC BY 4.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Histopathology_of_villous_atrophy_in_celiac_disease.jpg\" data-tags=\"\" height=\"511\" src=\"https://image.prepladder.com/notes/gmKzOGKSdadMgZTAPsgK1743430961.png\" width=\"500\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3"
      },
      {
        "id": 2,
        "text": "1, 2, 3, 4"
      },
      {
        "id": 3,
        "text": "2, 4, 5"
      },
      {
        "id": 4,
        "text": "1, 2, 3, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) 1, 2, 3, 5</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The clinical scenario is classic for <strong>Celiac disease</strong>, an <span class=\"customMeta\" data-dictid=\"96ab11a06a16927771823151c8e471\">autoimmune</span> disorder <span class=\"customMeta\" data-dictid=\"3978e9614f1692777200abbe4cfa34\">triggered</span> by <strong>gluten ingestion</strong>, confirmed by:</p>\n\n<ul>\n\t<li>\n\t<p><strong>Positive anti-tTG and anti-EMA antibodies</strong></p>\n\t</li>\n\t<li>\n\t<p><strong>Small <span class=\"customMeta\" data-dictid=\"37863e7aec169277718310f33c6a11\">bowel</span> biopsy</strong> is the gold standard for diagnosis</p>\n\t</li>\n</ul>\n\n<p><strong>Marsh criteria of <span class=\"customMeta\" data-dictid=\"c2b5c161b71692777184c75775751a\">celiac</span> disease:</strong> Because the antibodies are formed due to consumption of gluten, they first attack the <span class=\"customMeta\" data-dictid=\"bbea63556f1692777202e8abdd66a4\">villi</span> of\u00a0intestine <strong>(Villous atrophy)</strong></p>\n\n<p><strong>Histopathological features in <span class=\"customMeta\" data-dictid=\"c2b5c161b71692777184c75775751a\">Celiac</span> disease:</strong></p>\n\n<table>\n\t<thead>\n\t\t<tr>\n\t\t\t<th>Feature</th>\n\t\t\t<th>Seen in Celiac?</th>\n\t\t\t<th>Explanation</th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td><strong>1. Intraepithelial CD8+ T lymphocytes</strong></td>\n\t\t\t<td>Yes</td>\n\t\t\t<td>Early and sensitive marker of immune response</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><strong>2. Crypt hyperplasia</strong></td>\n\t\t\t<td>Yes</td>\n\t\t\t<td>Compensatory response due to <span class=\"customMeta\" data-dictid=\"838d2bdb8516927772023871643ffb\">villous</span> damage</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><strong>3. <span class=\"customMeta\" data-dictid=\"838d2bdb8516927772023871643ffb\">Villous</span> atrophy</strong></td>\n\t\t\t<td>Yes</td>\n\t\t\t<td>Hallmark feature; leads to malabsorption</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><strong>4. Decreased mitotic activity</strong></td>\n\t\t\t<td>No</td>\n\t\t\t<td><strong>Mitotic activity is increased because of increased <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and proliferation</strong>, not decreased</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><strong>5. Inflammatory cell <span class=\"customMeta\" data-dictid=\"669bdcb3111692777190e018ae930e\">infiltration</span> in LP</strong></td>\n\t\t\t<td>Yes</td>\n\t\t\t<td>Mainly lymphocytes and <span class=\"customMeta\" data-dictid=\"a0e40688fa169277719572bdb48c92\">plasma</span> cells in <span class=\"customMeta\" data-dictid=\"9864ad42b21692777191febeee1002\">lamina</span> propria</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"text-align:center\"><img alt=\"celiac_disease\" data-author=\"GeneFood\" data-hash=\"762\" data-license=\"CC BY 4.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Histopathology_of_villous_atrophy_in_celiac_disease.jpg\" data-tags=\"January2025\" height=\"500\" src=\"https://image.prepladder.com/notes/477QOMFPs6D4gdnVNs4w1737004343.jpg\" width=\"500\" /></p>",
    "question_images": [
      "https://image.prepladder.com/notes/gmKzOGKSdadMgZTAPsgK1743430961.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/477QOMFPs6D4gdnVNs4w1737004343.jpg"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/DgZfEjrcsuRvoyXHovVm1749188929.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/3SN186GjM6rVvPYK82SM1749189135.mp3"
  },
  {
    "text": "<p>A 45-year-old woman presents to the clinic with a history of chronic abdominal pain and diarrhoea, worsening notably after consuming wheat-based foods. Physical examination reveals signs suggestive of malabsorption. Considering celiac disease as a possible diagnosis, which of the following statements regarding its pathogenesis is NOT correct?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Gliadin peptides in the lamina propria are deamidated by tissue transglutaminase."
      },
      {
        "id": 2,
        "text": "HLA-DR2 or HLA-DR8 significantly influences celiac disease susceptibility."
      },
      {
        "id": 3,
        "text": "Gliadin peptides may induce epithelial cells to express IL-15, activating CD8+ lymphocytes."
      },
      {
        "id": 4,
        "text": "Type 1 diabetes, Sj\u00f6gren syndrome, and IgA nephropathy are associated with celiac disease."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) </strong><strong>HLA-DR2 or HLA-DR8 </strong><strong>significantly influences <span class=\"customMeta\" data-dictid=\"c2b5c161b71692777184c75775751a\">celiac</span> disease susceptibility.</strong><strong> </strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Celiac disease (aka <span class=\"customMeta\" data-dictid=\"c2b5c161b71692777184c75775751a\">celiac</span> <span class=\"customMeta\" data-dictid=\"15ba4af6a9169277719905f80d2b20\">sprue</span> or gluten-sensitive enteropathy) is an immune-mediated condition <span class=\"customMeta\" data-dictid=\"3978e9614f1692777200abbe4cfa34\">triggered</span> by consuming foods containing gluten, such as\u00a0barley, rye, oats, and\u00a0wheat.</p>\n\n<p>It is influenced by <strong>HLA-DQ2 or HLA-DQ8</strong>, not HLA-DR2 or HLA-DR8</p>\n\n<p>Gliadin is released when these patient consumes gluten.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Pathogenesis of <span class=\"customMeta\" data-dictid=\"c2b5c161b71692777184c75775751a\">Celiac</span> disease:</strong></p>\n\n<p style=\"text-align: center;\">Gliadin peptides</p>\n\n<p style=\"text-align: center;\">\u2193</p>\n\n<p style=\"text-align: center;\">Deamidated by Tissue <span class=\"customMeta\" data-dictid=\"4a47b71b801692777200d06df00a08\">transglutaminase</span> (TTG) <span class=\"customMeta\" data-dictid=\"0f160e4e42169277718771b715516a\">enzyme</span> of intestine</p>\n\n<p style=\"text-align: center;\">\u2193</p>\n\n<p style=\"text-align: center;\">IL-15 expression</p>\n\n<p style=\"text-align: center;\">\u2193</p>\n\n<p style=\"text-align: center;\">CD8+ t-lymphocytes activated</p>\n\n<p style=\"text-align: center;\">\u2193</p>\n\n<p style=\"text-align: center;\">Epithelial damage</p>\n\n<p>\u00a0</p>\n\n<p>Genetic variations may link <span class=\"customMeta\" data-dictid=\"c2b5c161b71692777184c75775751a\">celiac</span> disease to other immune disorders, such as <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">type 1</span> diabetes, thyroiditis, Sjogren syndrome, and IgA nephropathy. <strong>(Option D)</strong></p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/BjmMnFvRg6LgaVYONM3N1750750288.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/G3TUAJJgR7DzRYOSYJzn1750750391.mp3"
  },
  {
    "text": "<p>A 35-year-old female who recently returned from a tropical region presents with persistent diarrhoea, weight loss, fatigue, anaemia, and vitamin deficiencies, along with a small intestine biopsy findings of villous atrophy and chronic mucosal inflammation. Which part of the gastrointestinal tract is typically NOT affected in this condition?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Duodenum"
      },
      {
        "id": 2,
        "text": "Jejunum"
      },
      {
        "id": 3,
        "text": "Ileum"
      },
      {
        "id": 4,
        "text": "Colon"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: C) </strong><strong>Colon</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The clinical scenario, with a history of returning from a tropical region and <span class=\"customMeta\" data-dictid=\"754ab07a2e1692777183ed178c883d\">biopsy</span> findings, points towards diagnosing Tropical <span class=\"customMeta\" data-dictid=\"f541d82b561692777187c75c724452\">enteropathy</span> or Environmental <span class=\"customMeta\" data-dictid=\"f541d82b561692777187c75c724452\">enteropathy</span> that does not affect the colon.</p>\n\n<p>This disease often occurs after E. <span class=\"customMeta\" data-dictid=\"cd0a7121a516927771846d8f5248bb\">coli</span> infection.</p>\n\n<p><strong>Tropical sprue:</strong></p>\n\n<ul>\n\t<li>Predominantly affects the small intestine( duodenum, jejunum, and ileum) and presents with Iron <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> <span class=\"customMeta\" data-dictid=\"53bee2a41216927771814d7ec3a67f\">anemia</span> or megaloblastic anemia.</li>\n</ul>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:518px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Part of the small intestine</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Nutrient absorbed</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Duodenum</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Iron</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Jejunum</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Folic acid</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Ileum</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Vitamin B12</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/zHfqcvJ8YlF40gnM6SHH1750750482.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/M4XvNZxSzPYPESsIG0mt1750750571.mp3"
  },
  {
    "text": "<p>A 6-month-old infant presents with failure to thrive, chronic diarrhoea, and poor weight gain. A peripheral blood smear revealed a characteristic appearance, as shown in the image below. Biochemical investigations reveal very low levels of triglycerides, cholesterol, and fat-soluble vitamins. Which genetic mutation is most likely responsible for these findings?</p>\n\n<p style=\"text-align:center\"><img alt=\"Peripheral_Blood SMEAR OF ABETALIPOPROTEINEMIA\" data-author=\"Ed Uthman \" data-hash=\"763\" data-license=\"CC BY 2.0\" data-source=\"https://en.wikipedia.org/wiki/Acanthocyte\" data-tags=\"January2025\" height=\"422\" src=\"https://image.prepladder.com/notes/keVIo0RAvbftlOj619681737004834.png\" width=\"500\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "APOB gene mutation"
      },
      {
        "id": 2,
        "text": "MTTP gene mutation"
      },
      {
        "id": 3,
        "text": "MYO5B gene mutation"
      },
      {
        "id": 4,
        "text": "LPL gene mutation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) </strong><strong>MTTP gene mutation</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The given clinical scenario and <span class=\"customMeta\" data-dictid=\"255674f3271692777195c172d86daf\">peripheral</span> <span class=\"customMeta\" data-dictid=\"6777533153169277719804fcbbf2d1\">smear</span> findings suggest Abetalipoproteinemia, caused by a <span class=\"customMeta\" data-dictid=\"7a67bdf6f81692777193cfd480f228\">mutation</span> in Microsomal <span class=\"customMeta\" data-dictid=\"482f0bd5841692777200af07c2766c\">triglyceride</span> transfer protein (MTTP), which is required for the transfer of lipids to <span class=\"customMeta\" data-dictid=\"1bd9a7351416927771934b972fb561\">nascent</span> <span class=\"customMeta\" data-dictid=\"5b87202f5b169277718135c3d5f45b\">apolipoprotein</span> B <span class=\"customMeta\" data-dictid=\"287fd897ad1692777196f583338128\">polypeptide</span> in the endoplasmic reticulum.</p>\n\n<p><strong>Abetalipoproteinemia:</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Aetiology</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Mutation in<strong> Microsomal <span class=\"customMeta\" data-dictid=\"482f0bd5841692777200af07c2766c\">triglyceride</span> transfer protein (MTTP)</strong></li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Presentation</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Extremely low cholesterol and triglycerides</li>\n\t\t\t\t<li>Malabsorption of fat-soluble vitamins.</li>\n\t\t\t\t<li>Intestine shows <strong>lipid vacuoles</strong> because of problem in <span class=\"customMeta\" data-dictid=\"a99114a6c216927771916f45ffc66c\">lipid</span> transfer.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">Biochemical investigation</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Low <span class=\"customMeta\" data-dictid=\"482f0bd5841692777200af07c2766c\">triglyceride</span> cholesterol levels</li>\n\t\t\t\t<li>Low fat <span class=\"customMeta\" data-dictid=\"845fedd06d16927771989597afa034\">soluble</span> vitamin levels</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Symptoms</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Presents in <span class=\"customMeta\" data-dictid=\"663d16ec8e169277719095f74c9816\">infancy</span> with failure to thrive, diarrhoea, and steatorrhea.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Peripheral smear</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Presence of <strong>acanthocytes</strong>-RBCs with <span class=\"customMeta\" data-dictid=\"255674f3271692777195c172d86daf\">peripheral</span> spikes</li>\n\t\t\t</ul>\n\n\t\t\t<p><img alt=\"Peripheral_Blood SMEAR OF ABETALIPOPROTEINEMIA\" data-author=\"Ed Uthman \" data-hash=\"763\" data-license=\"CC BY 2.0\" data-source=\"https://en.wikipedia.org/wiki/Acanthocyte\" data-tags=\"January2025\" src=\"https://image.prepladder.com/notes/keVIo0RAvbftlOj619681737004834.png\" /></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>",
    "question_images": [
      "https://image.prepladder.com/notes/keVIo0RAvbftlOj619681737004834.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/keVIo0RAvbftlOj619681737004834.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/BPQQZDQ2JyrEVfq3zG1t1750750716.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/U1hCDwUjFX0me1TCOEdU1750750805.mp3"
  },
  {
    "text": "<p>A 4-week-old infant presents with severe watery diarrhoea and failure to thrive since birth. Stool studies are negative for pathogens. A small bowel biopsy shows villous atrophy, cytoplasmic inclusion bodies within enterocytes, and reduction of microvilli on the enterocyte surface. Which of the following statements is true regarding this condition? <strong> </strong></p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "It is characterised by the absence of ganglion cells in the distal part of the colon."
      },
      {
        "id": 2,
        "text": "It is associated with mutations in the MYO5B or STX3 genes."
      },
      {
        "id": 3,
        "text": "Histological findings include villous atrophy and crypt hyperplasia."
      },
      {
        "id": 4,
        "text": "It is commonly caused by rotavirus infection, which leads to persistent diarrhoea."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) </strong><strong>It is associated with mutations in the MYO5B or STX3 genes.</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The clinical presentation suggests Microvillous <span class=\"customMeta\" data-dictid=\"c3b8b9a17416927771906b1bebb13c\">Inclusion</span> Disease (MVID).</p>\n\n<ul>\n\t<li>It is a rare autosomal <span class=\"customMeta\" data-dictid=\"d54db2110416927771971e7c011a9f\">recessive</span> disorder characterised by severe, <span class=\"customMeta\" data-dictid=\"97bb95941c169277719084f48d2547\">intractable</span> watery diarrhoea from early infancy.</li>\n\t<li>It presents with <span class=\"customMeta\" data-dictid=\"c3b8b9a17416927771906b1bebb13c\">inclusion</span> bodies and reduction in microvilli.</li>\n\t<li><strong>Aetiology:\u00a0</strong>Mutations in the MYO5B or STX3 genes.</li>\n</ul>\n\n<p><strong>It is characterised by the absence of <span class=\"customMeta\" data-dictid=\"bbd799518a169277718867e02de42f\">ganglion</span> cells in the <span class=\"customMeta\" data-dictid=\"5ff25303a01692777186731f6a4f5c\">distal</span> part of the <span class=\"customMeta\" data-dictid=\"0fce15e71f1692777184feb9af5303\">colon</span> (Option A):</strong> Seen in\u00a0Hirschsprung disease.</p>\n\n<p><strong>Histological findings include <span class=\"customMeta\" data-dictid=\"838d2bdb8516927772023871643ffb\">villous</span> <span class=\"customMeta\" data-dictid=\"97ff5253fb169277718224c7b0faf8\">atrophy</span> and <span class=\"customMeta\" data-dictid=\"d2a83e1b4c1692777185c446d81c0c\">crypt</span> <span class=\"customMeta\" data-dictid=\"4c5d5ef6c31692777189820d4b320d\">hyperplasia</span> (Option C):</strong> Seen in <span class=\"customMeta\" data-dictid=\"c2b5c161b71692777184c75775751a\">celiac</span> disease or <span class=\"customMeta\" data-dictid=\"29771deef31692777188c19fb41999\">gluten</span> insensitivity.</p>\n\n<p><strong>It is commonly caused by <span class=\"customMeta\" data-dictid=\"f974df33fe1692777197f92876b44b\">rotavirus</span> infection, which leads to persistent diarrhoea (Option D): </strong>Stool studies are negative for <span class=\"customMeta\" data-dictid=\"ed4634701d16927771942c4408495f\">pathogen</span> in this case.</p>\n\n<p><img alt=\"Microvillous Inclusion Disease\" data-author=\"Conrad E Johanson1 , John A Duncan III1 , Petra M Klinge2 , Thomas Brinker2 , Edward G Stopa1 and Gerald D Silverberg\" data-hash=\"764\" data-license=\"CC BY 2.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Ultrastructure_of_choroid_epithelium.jpg\" data-tags=\"January2025\" src=\"https://image.prepladder.com/notes/vnI6dw0AFZ0BMiYBKCBh1737005152.jpg\" /></p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/vnI6dw0AFZ0BMiYBKCBh1737005152.jpg"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/FZBQc0Dvt77aIf6ZrVSI1750750901.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/B0J2TRaLLcGUDeWEgnZx1750750971.mp3"
  },
  {
    "text": "<p>A 28-year-old female presents with foul-smelling, greasy diarrhoea, bloating, and abdominal cramps following a hiking trip in a remote area. Stool microscopy reveals cysts containing motile trophozoites. A duodenal biopsy shows luminal organisms, as shown in the image, without tissue invasion. Based on the clinical presentation and biopsy findings, what is the most likely causative organism?</p>\n\n<p style=\"text-align:center\"><img alt=\"Giardiasis_duodenum\" data-author=\"Nephron\" data-hash=\"765\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Giardiasis_duodenum_high.jpg\" data-tags=\"January2025\" height=\"337\" src=\"https://image.prepladder.com/notes/X0EyOKTo6EWsEselduhE1737005349.png\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Cryptosporidium"
      },
      {
        "id": 2,
        "text": "Tropheryma whipplei"
      },
      {
        "id": 3,
        "text": "Entamoeba histolytica"
      },
      {
        "id": 4,
        "text": "Giardia lamblia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) </strong><strong>Giardia lamblia</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The scenario is of Giardia <span class=\"customMeta\" data-dictid=\"cf8c63d39d1692777191eaefc48221\">lamblia</span> infestation</p>\n\n<p>Giardia lamblia:</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Definition</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Flagellated <span class=\"customMeta\" data-dictid=\"101b1e083716927771969fdfd388d4\">protozoan</span> parasite</li>\n\t\t\t\t<li>Commonly associated with contaminated water sources.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Symptoms</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Foul-smelling-greasy diarrhoea</li>\n\t\t\t\t<li>Bloating</li>\n\t\t\t\t<li>Abdominal cramps.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td rowspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Biopsy findings</p>\n\t\t\t</td>\n\t\t\t<td rowspan=\"2\" style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Luminal organisms attached to the intestinal epithelium</li>\n\t\t\t\t<li>Blunting of the <span class=\"customMeta\" data-dictid=\"bbea63556f1692777202e8abdd66a4\">villi</span> and</li>\n\t\t\t\t<li>inflammation without tissue invasion.</li>\n\t\t\t</ul>\n\n\t\t\t<p><img alt=\"Giardiasis_duodenum\" data-author=\"Nephron\" data-hash=\"765\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Giardiasis_duodenum_high.jpg\" data-tags=\"January2025\" height=\"337\" src=\"https://image.prepladder.com/notes/X0EyOKTo6EWsEselduhE1737005349.png\" width=\"500\" /></p>\n\t\t\t\u00a0\n\n\t\t\t<ul>\n\t\t\t\t<li>Giardia trophozoites on <span class=\"customMeta\" data-dictid=\"754ab07a2e1692777183ed178c883d\">biopsy</span> are often described as resembling \"falling leaves\"</li>\n\t\t\t</ul>\n\n\t\t\t<figure class=\"caption_element\"><img alt=\"Giardia Trophozoite\" data-author=\"NA\" data-hash=\"5502\" data-license=\"NA\" data-source=\"NA\" data-tags=\"\" height=\"500\" src=\"https://image.prepladder.com/notes/YGethZJxDIyudh8kHdva1743432980.png\" width=\"500\" />\n\t\t\t<figcaption>{{caption_text}}</figcaption>\n\t\t\t</figure>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><strong>Cryptosporidium (Option A)</strong></p>\n\n<ul>\n\t<li>Coccidian parasite</li>\n\t<li>Usually present along <span class=\"customMeta\" data-dictid=\"da5d70d6c016927771839e073ce917\">brush border</span> of the intestine.</li>\n\t<li>Causes watery diarrhoea, especially in <span class=\"customMeta\" data-dictid=\"a3cc9f976916927771895692a1a8a0\">immunocompromised</span> individuals</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"Cryptosporidiosis\" data-author=\"Nephron\" data-hash=\"766\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Cryptosporidiosis_-_very_high_mag.jpg\" data-tags=\"January2025\" height=\"416\" src=\"https://image.prepladder.com/notes/I5MVSGZlnYg48RcsSQO11737005773.png\" width=\"335\" /></p>\n\n<p><strong>Tropheryma whipplei (Option B)</strong></p>\n\n<ul>\n\t<li>Causes Whipple's disease</li>\n\t<li><strong>Histology: </strong>PAS-positive foamy macrophages in the intestinal mucosa</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"Tropheryma whippleI\" data-author=\"Jan Bure\u0161, Marcela Kop\u00e1\u010dov\u00e1, Tom\u00e1\u0161 Douda, Jolana B\u00e1rtov\u00e1, Jan Tom\u0161, Stanislav Rejchrt, Ilja Tachec\u00ed\" data-hash=\"767\" data-license=\"CC BY SA 3.0\" data-source=\"https://www.researchgate.net/publication/241060805_Review_Article_Whipple's_Disease_Our_Own_Experience_and_Review_of_the_Literature\" data-tags=\"January2025\" height=\"374\" src=\"https://image.prepladder.com/notes/LH2iySjDlwegvwOjBu2d1737005868.png\" width=\"500\" /></p>\n\n<p><strong>Entamoeba histolytica (Option C)</strong></p>\n\n<ul>\n\t<li>Protozoan parasite</li>\n\t<li>It causes amoebic <span class=\"customMeta\" data-dictid=\"7b4370a0b01692777201a5bc0739c2\">ulcer</span> in <span class=\"customMeta\" data-dictid=\"7840cca3ed16927771901d2f6cb32b\">intestine</span> identified by <span class=\"customMeta\" data-dictid=\"017d1c6af716927772025c04337815\">flask</span> shaped ulcers.</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"AMOEBIASIS\" data-author=\"KGH Assumed\" data-hash=\"768\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Amoebic_dysentery_in_colon_biopsy_(1).jpg\" data-tags=\"January2025\" height=\"339\" src=\"https://image.prepladder.com/notes/NKixD6LLwifGQRAehHBM1737006004.jpg\" width=\"500\" /></p>\n\n<p>\u00a0</p>",
    "question_images": [
      "https://image.prepladder.com/notes/X0EyOKTo6EWsEselduhE1737005349.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/X0EyOKTo6EWsEselduhE1737005349.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/3RNecgCJN2c1dgXWWySC1750751076.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/cyiMTCaoavHxPRBSYq6j1750751163.mp3"
  },
  {
    "text": "<p>Which type of ulcer is characterised by multiple punched-out ulcers with undermined edges and necrotic bases on histopathological examination?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "TB ulcer"
      },
      {
        "id": 2,
        "text": "Typhoid ulcer"
      },
      {
        "id": 3,
        "text": "Amoebic ulcer"
      },
      {
        "id": 4,
        "text": "Peptic ulcer"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) </strong><strong>Amoebic ulcer</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>On histopathological examination, amoebic ulcers caused by Entamoeba histolytica present as multiple <span class=\"customMeta\" data-dictid=\"7134f7f8681692777196fa644c43bf\">punched-out</span> ulcers with undermined edges and necrotic <span class=\"customMeta\" data-dictid=\"1ec6e3e9e11692777182b1220b131a\">bases</span> (<strong>flask-shaped ulcers</strong>). The ulcers often have surrounding <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and contain trophozoites of Entamoeba histolytica.</p>\n\n<ul>\n\t<li>When\u00a0Entamoeba histolytica goes to liver: It breaks the liver tissue into brown coloured <span class=\"customMeta\" data-dictid=\"e4626b4cea16927771968e59732fef\">pus</span> known as Encovy sauce appearance</li>\n</ul>\n\n<p><strong>TB <span class=\"customMeta\" data-dictid=\"7b4370a0b01692777201a5bc0739c2\">ulcer</span> (Option A):\u00a0</strong>Transverse <span class=\"customMeta\" data-dictid=\"7b4370a0b01692777201a5bc0739c2\">ulcer</span> in direction.</p>\n\n<p><strong>Typhoid <span class=\"customMeta\" data-dictid=\"7b4370a0b01692777201a5bc0739c2\">ulcer</span> (Option B):\u00a0</strong>Longitudinal\u00a0ulcer in direction.</p>\n\n<p style=\"text-align:center\"><img alt=\"AMOEBIASIS\" data-author=\"KGH Assumed\" data-hash=\"768\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Amoebic_dysentery_in_colon_biopsy_(1).jpg\" data-tags=\"January2025\" height=\"339\" src=\"https://image.prepladder.com/notes/NKixD6LLwifGQRAehHBM1737006004.jpg\" width=\"500\" /></p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/NKixD6LLwifGQRAehHBM1737006004.jpg"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/otIwz3XauAWuO71RcP6W1750751248.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/x5ZrOIfoCd8Dbcmfw0KQ1750751331.mp3"
  },
  {
    "text": "<p>A 60-year-old patient presents with severe diarrhoea and abdominal pain after completing a course of broad-spectrum antibiotics for a respiratory infection. Stool studies detect the presence of Clostridioides difficile (C. difficile) toxin. A colonoscopy revealed diffuse yellowish plaques covering the colonic mucosa, as shown in the image. Which inflammatory cell type predominantly infiltrates the lamina propria and surface epithelium in this condition?</p>\n\n<p><img alt=\"Pseudomembranous Colitis Endoscopy\" data-author=\"Klinikum Dritter Orden, M\u00fcnchen. Abteilung Innere Medizin I Vielen Dank an Christoph Kaiser f\u00fcr die \u00dcberlassung des Bildes zur Ver\u00f6ffentlichung\" data-hash=\"5503\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Pseudomembranoese_Colitis_Endo2.jpg\" data-tags=\"\" height=\"500\" src=\"https://image.prepladder.com/notes/rYQEAi5K9gTrQ3VYxSSC1743433164.png\" width=\"500\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Lymphocytes"
      },
      {
        "id": 2,
        "text": "Eosinophils"
      },
      {
        "id": 3,
        "text": "Neutrophils"
      },
      {
        "id": 4,
        "text": "Plasma cells"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Neutrophils</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The given clinical condition suggests Pseudomembranous <span class=\"customMeta\" data-dictid=\"85d2909f961692777187ea2494afd9\">enterocolitis</span> (PMEC).</p>\n\n<ul>\n\t<li><strong>Pseudomembranous:</strong> On colonoscopy, <span class=\"customMeta\" data-dictid=\"89275101301692777186567d1912a0\">diffuse</span> yellowish plaques covering the <span class=\"customMeta\" data-dictid=\"566fcef0991692777184068f36db82\">colonic</span> <span class=\"customMeta\" data-dictid=\"31ae8f4dc51692777193069d92be37\">mucosa</span> are seen.</li>\n\t<li><strong>Enterocolitis:</strong> Inflammation of intestine</li>\n\t<li>Long term antibiotics alters the gut <span class=\"customMeta\" data-dictid=\"0af84af4761692777202fbf6914573\">flora</span> and makes person <span class=\"customMeta\" data-dictid=\"607476ab371692777196d0cb2f13bc\">prone</span> to C. difficile infection, which damages the <span class=\"customMeta\" data-dictid=\"7840cca3ed16927771901d2f6cb32b\">intestine</span> and forms pseudomembrane.\n\t<ul>\n\t\t<li>Necrosis and damaged cells are always associated with <span class=\"customMeta\" data-dictid=\"041f0e547a1692777193350b3f7d39\">neutrophilic</span> infiltrations\u00a0<strong>(Option C)</strong></li>\n\t</ul>\n\t</li>\n\t<li>\u00a0Patient presents with watery diarrhoea (rarely can present with bloody diarrhoea),</li>\n\t<li>Caused by 2 toxins of\u00a0C. difficile: <span class=\"customMeta\" data-dictid=\"41329dc9381692777200a9b6d57cf4\">Toxin</span> A and <span class=\"customMeta\" data-dictid=\"41329dc9381692777200a9b6d57cf4\">Toxin</span> B</li>\n\t<li>On biopsy: Classical volcano like erruptions</li>\n\t<li>Drug of choice: Vancomycin\u00a0\u00b1 Metronidazole\n\t<ul>\n\t\t<li>New drug:\u00a0Fidaxomicin</li>\n\t</ul>\n\t</li>\n</ul>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><img alt=\"Pseudomembranous Colitis Endoscopy\" data-author=\"Klinikum Dritter Orden, M\u00fcnchen. Abteilung Innere Medizin I Vielen Dank an Christoph Kaiser f\u00fcr die \u00dcberlassung des Bildes zur Ver\u00f6ffentlichung\" data-hash=\"5503\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Pseudomembranoese_Colitis_Endo2.jpg\" data-tags=\"\" height=\"494\" src=\"https://image.prepladder.com/notes/rYQEAi5K9gTrQ3VYxSSC1743433164.png\" width=\"494\" />\u00a0\u00a0<img alt=\"-Pseudomembranous_Colitis_(H&E)_\" data-author=\"Ed Uthman \" data-hash=\"770\" data-license=\"CC BY 2.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Pseudomembranous_Colitis_(H%26E)_(7414583578).jpg\" data-tags=\"January2025\" height=\"337\" src=\"https://image.prepladder.com/notes/JGF0nmMfXBKB42W0n3Sm1737007102.png\" width=\"500\" /></p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [
      "https://image.prepladder.com/notes/rYQEAi5K9gTrQ3VYxSSC1743433164.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/rYQEAi5K9gTrQ3VYxSSC1743433164.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/ZSSAj145gTH8nV4fvXoF1750751789.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/pfkllnAOhROLDJoQAD601750751885.mp3"
  },
  {
    "text": "<p>A 32-year-old man presents with chronic abdominal pain, diarrhoea, weight loss, and occasional blood in the stool. A colonoscopy reveals patchy erythema, oedema, and shallow ulcers with intervening normal mucosa in the terminal ileum and colon. The histopathological findings from the affected area are shown below. What histopathological features are observed in this patient's condition?</p>\n\n<p style=\"text-align:center\"><img alt=\"Crohn_s_disease\" data-author=\"   \t Nephron\" data-hash=\"771\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Crohn%27s_disease_-_colon_-_high_mag.jpg\" data-tags=\"January2025\" height=\"290\" src=\"https://image.prepladder.com/notes/fo66Rak4hqjYTP5y4Z991737015624.png\" width=\"500\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Presence of noncaseating granulomas"
      },
      {
        "id": 2,
        "text": "Smooth transition between ulcerated and adjacent normal mucosa"
      },
      {
        "id": 3,
        "text": "Absence of metaplastic changes in the epithelium"
      },
      {
        "id": 4,
        "text": "Uniform distribution of inflammation throughout the affected areas"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Presence of noncaseating granulomas</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The clinical presentation and <span class=\"customMeta\" data-dictid=\"754ab07a2e1692777183ed178c883d\">biopsy</span> findings showing noncaseating granulomas and skip lesions suggest Crohn\u2019s disease.</p>\n\n<ul>\n\t<li>Noncaseating granulomas are round lesions with <span class=\"customMeta\" data-dictid=\"aa085932ce1692777193be7e5198bf\">multinucleated</span> giant cells within them.</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"Crohn's Disease Granuloma\" data-author=\"R. J. Xavier & D. K. Podolsky\" data-hash=\"5742\" data-license=\"NA\" data-source=\"https://www.nature.com/articles/nature06005\" data-tags=\"\" height=\"361\" src=\"https://image.prepladder.com/notes/ysr3Rxf3I5SMldhId9gz1743481575.png\" width=\"500\" /></p>\n\n<p style=\"text-align:center\"><img alt=\"Crohn_s_disease\" data-author=\"Nephron\" data-hash=\"771\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Crohn%27s_disease_-_colon_-_high_mag.jpg\" data-tags=\"January2025\" height=\"290\" src=\"https://image.prepladder.com/notes/fo66Rak4hqjYTP5y4Z991737015624.png\" width=\"500\" /></p>",
    "question_images": [
      "https://image.prepladder.com/notes/fo66Rak4hqjYTP5y4Z991737015624.png"
    ],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/ysr3Rxf3I5SMldhId9gz1743481575.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/JbZXf0Su3rVCvBrku05v1750751944.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/vNkjyQSsRWE2TcrGUJYj1750752002.mp3"
  },
  {
    "text": "<p>A 32-year-old male presents with a 6-month history of abdominal pain, diarrhoea, and weight loss. A colonoscopy reveals findings consistent with Crohn's diseaseWhat histological features would you observe in this patient's biopsy?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Inflammation is limited superficial layer"
      },
      {
        "id": 2,
        "text": "Fibrosis is not seen"
      },
      {
        "id": 3,
        "text": "Ulcers are limited to mucosa"
      },
      {
        "id": 4,
        "text": "Ulcers can extend beyond the mucosa"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer:D) Ulcers can extend beyond the mucosa</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>Crohn\u2019s disease presents with <span class=\"customMeta\" data-dictid=\"53ab411c811692777200e0e1b68984\">transmural</span> inflammation, which causes deep ulcers.</li>\n\t<li>It is characterised by <span class=\"customMeta\" data-dictid=\"53ab411c811692777200e0e1b68984\">transmural</span> <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and can affect the entire intestinal wall thickness, from the <span class=\"customMeta\" data-dictid=\"31ae8f4dc51692777193069d92be37\">mucosa</span> to the serosa, which\u00a0can lead to fissures and fistulas.\u00a0<strong>(Option A ruled out)</strong></li>\n\t<li>Strictures or <span class=\"customMeta\" data-dictid=\"21e2d5a70616927772021fcdec0ca9\">fibrosis</span> are commonly seen in this condition <strong>(Option B ruled out)</strong></li>\n\t<li>Ulcers are intially <span class=\"customMeta\" data-dictid=\"ebb480187d1692777199e233e9e356\">superficial</span> and then goes deep extending to every layer of intestine.\u00a0<strong>(Option C ruled out)</strong></li>\n</ul>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/DP2HqN1PgDsUSh01PTWm1750752076.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/U2UhOfozqaKZaFLsaNDy1750752143.mp3"
  },
  {
    "text": "<p>Which statement is true regarding inflammatory bowel disease (IBD) pathogenesis?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "NOD2 polymorphisms are closely associated with Crohn's disease in Asian populations."
      },
      {
        "id": 2,
        "text": "ATG16L1 mutation promotes ATG16L1 degradation and enhances autophagy."
      },
      {
        "id": 3,
        "text": "Dysbiosis is often established at disease presentation in IBD."
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) <span class=\"customMeta\" data-dictid=\"73bb5b9ea91692777186234a83fc37\">Dysbiosis</span> is often established at disease presentation in IBD.</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>\"Dysbiosis\" refers to an <span class=\"customMeta\" data-dictid=\"2cc844bc9c1692777189739abf1dc5\">imbalance</span> in the gut <span class=\"customMeta\" data-dictid=\"ee4913785d16927771929d78b794c7\">microbiota</span> characterised by shifts in <span class=\"customMeta\" data-dictid=\"04f4b6dbf71692777192ca0c4f70fa\">microbial</span> populations and <span class=\"customMeta\" data-dictid=\"10c83adb331692777197f775bec1aa\">reduced</span> species diversity.</p>\n\n<ul>\n\t<li>This <span class=\"customMeta\" data-dictid=\"2cc844bc9c1692777189739abf1dc5\">imbalance</span> is commonly observed at the onset of <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">inflammatory</span> <span class=\"customMeta\" data-dictid=\"37863e7aec169277718310f33c6a11\">bowel</span> disease (IBD).</li>\n\t<li>Dysbiosis can lead to alterations in the gut environment, including increased <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and impaired barrier function, which may contribute to the <span class=\"customMeta\" data-dictid=\"3c305b384216927771969ca4166493\">progression</span> of IBD.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>NOD2 polymorphisms are closely associated with Crohn's disease in Asian populations (Option A)</strong></p>\n\n<p>NOD2 polymorphisms are closely associated with Crohn's disease but not with Crohn's disease in Asian populations.</p>\n\n<p><strong>ATG16L1 <span class=\"customMeta\" data-dictid=\"7a67bdf6f81692777193cfd480f228\">mutation</span> promotes ATG16L1 <span class=\"customMeta\" data-dictid=\"d395f610461692777185cbe8b8806d\">degradation</span> and enhances <span class=\"customMeta\" data-dictid=\"06d27b773a1692777182ec37e7fb5f\">autophagy</span> (Option B)</strong></p>\n\n<p>The ATG16L1 <span class=\"customMeta\" data-dictid=\"7a67bdf6f81692777193cfd480f228\">mutation</span> limits <span class=\"customMeta\" data-dictid=\"06d27b773a1692777182ec37e7fb5f\">autophagy</span> rather than enhancing it by promoting ATG16L1 degradation.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which of the following statements regarding ulcerative colitis and Crohn's disease is true?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Ulcerative colitis is characterised by skip lesions, whereas Crohn\u2019s disease typically presents with continuous inflammation."
      },
      {
        "id": 2,
        "text": "Cobblestone appearance is a feature seen in ulcerative colitis and Crohn's disease but is more commonly associated with Crohn's disease."
      },
      {
        "id": 3,
        "text": "Ulcerative colitis typically begins in the rectum and extends proximally, whereas Crohn's disease can involve any part of the GI tract."
      },
      {
        "id": 4,
        "text": "Fistulae, strictures, and abscesses are more commonly seen in ulcerative colitis than in Crohn's disease."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Ulcerative <span class=\"customMeta\" data-dictid=\"e6955110f21692777184d2090a400c\">colitis</span> typically begins in the <span class=\"customMeta\" data-dictid=\"9b9c4c412f1692777197ed217e7373\">rectum</span> and extends proximally, whereas Crohn's disease can involve any part of the GI tract.</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>\u00a0</p>\n\n<p><img alt=\"Crohn's disease vs Ulcerative Colitis\" data-author=\"NA\" data-hash=\"5743\" data-license=\"NA\" data-source=\"NA\" data-tags=\"\" height=\"500\" src=\"https://image.prepladder.com/notes/G8Q5CecG71Nc2y9sklbs1743482114.png\" width=\"500\" /></p>\n\n<p>\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:NaN\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Features</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Ulcerative colitis</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Crohn\u2019s disease</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Location</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-color:#000000; border-style:solid; border-width:1px; vertical-align:top\">Typically begins in the <span class=\"customMeta\" data-dictid=\"9b9c4c412f1692777197ed217e7373\">rectum</span> and extends proximally affecting entire large and small intestines:\u00a0<strong>Backwash ileitis</strong></td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Can involve any part of the GI tract:</strong> Primarily it starts most commonly from Ileum and then it can effect any part of GI <span class=\"customMeta\" data-dictid=\"1a1307223f16927772017a994bfc39\">tract</span> in the forn of skip lesions.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Distribution</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Diffused continuous lesion</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Patchy, with <strong>skip lesions</strong>.\u00a0<strong>(Option A)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Gross appearance</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Mucosal <span class=\"customMeta\" data-dictid=\"f0f3e105661692777187df507b1f26\">erythema</span> and granularity</li>\n\t\t\t\t<li>Broad-based ulcers with a continuous pattern</li>\n\t\t\t\t<li>Pseudopolyps</li>\n\t\t\t\t<li>Mucosal atrophy</li>\n\t\t\t\t<li>Smooth, continuous inflammation</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Transmural inflammation</li>\n\t\t\t\t<li>Aphthous ulcers</li>\n\t\t\t\t<li><strong>Cobblestone appearance\u00a0(Option B)</strong></li>\n\t\t\t\t<li>Fistulae, strictures, abscesses</li>\n\t\t\t\t<li><strong>Creeping fat</strong> (mesenteric fat wrapping)</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:middle\">\n\t\t\t<p>Complications</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Toxic megacolon</li>\n\t\t\t\t<li>Colonic dilation</li>\n\t\t\t\t<li>Mucosal bridges.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li><strong>Strictures</strong></li>\n\t\t\t\t<li><strong>Fistulae</strong></li>\n\t\t\t\t<li><strong>Fissures (Option D)</strong></li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/G8Q5CecG71Nc2y9sklbs1743482114.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/MPd5IxQryYAX7tS1zbdV1750752256.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/ZIjB8XfEqaKmUUVTjViK1750752348.mp3"
  },
  {
    "text": "<p>A 32-year-old male presents to the outpatient clinic with a 5-day history of non-bloody, watery diarrhea. He reports that he recently returned from a hiking trip in a rural area where he drank water from a nearby stream. On examination, he appears dehydrated but is otherwise stable. A stool sample was sent for analysis, which revealed the presence of oocysts. Which of the following is the most likely cause of this patient's gastrointestinal symptoms?</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Cryptosporidium"
      },
      {
        "id": 2,
        "text": "Microsporidium"
      },
      {
        "id": 3,
        "text": "Giardia lamblia"
      },
      {
        "id": 4,
        "text": "Entamoeba histolytica"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer:A) Cryptosporidium</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Cryptosporidiosis is a significant cause of <span class=\"customMeta\" data-dictid=\"aaabe672c51692777186a829ebdc0c\">diarrhea</span> worldwide. Cryptosporidium is known to cause non-bloody, watery <span class=\"customMeta\" data-dictid=\"aaabe672c51692777186a829ebdc0c\">diarrhea</span> and is commonly associated with drinking contaminated water, particularly from untreated sources such as <strong>streams or lakes</strong>. The presence of oocysts in the <span class=\"customMeta\" data-dictid=\"44335bb8bf1692777199a956cb31bf\">stool</span> supports this diagnosis</p>\n\n<ul>\n\t<li><strong>C. hominis</strong> and <strong>C. parvum\u00a0</strong>usually presents with waterry <span class=\"customMeta\" data-dictid=\"aaabe672c51692777186a829ebdc0c\">diarrhea</span> and many times the patient is <span class=\"customMeta\" data-dictid=\"a3cc9f976916927771895692a1a8a0\">immunocompromised</span> like HIV+.</li>\n\t<li>Oocysts are present in <span class=\"customMeta\" data-dictid=\"44335bb8bf1692777199a956cb31bf\">stool</span> and measures 4-6\u00b5m.</li>\n\t<li>Cold ZN <span class=\"customMeta\" data-dictid=\"b29a1a16ab1692777199ede1c6e28b\">stain</span> or\u00a0Kinyoun <span class=\"customMeta\" data-dictid=\"b29a1a16ab1692777199ede1c6e28b\">stain</span> is used to see oocytes.</li>\n\t<li>On <span class=\"customMeta\" data-dictid=\"754ab07a2e1692777183ed178c883d\">biopsy</span> of intestine, Cryptosporidium is found along the <span class=\"customMeta\" data-dictid=\"da5d70d6c016927771839e073ce917\">brush border</span> of epithelium.</li>\n</ul>\n\n<p style=\"text-align:center\"><img alt=\"Cryptosporidium Histopathology\" data-author=\"Elliot Weisenberg, M.D.\" data-hash=\"5744\" data-license=\"NA\" data-source=\"https://www.pathologyoutlines.com/topic/coloncryptosporidium.html\" data-tags=\"\" height=\"356\" src=\"https://image.prepladder.com/notes/cCXjiYreWXyZbaIntJcV1743482322.png\" width=\"500\" /></p>\n\n<p><strong>Microsporidium </strong><strong>(Option B): </strong>Rarely presents with oocysts in <span class=\"customMeta\" data-dictid=\"44335bb8bf1692777199a956cb31bf\">stool</span> sample.</p>\n\n<p><strong>Giardia <span class=\"customMeta\" data-dictid=\"cf8c63d39d1692777191eaefc48221\">lamblia</span> </strong><strong>(Option C): </strong>Do not have oocysts.</p>\n\n<p><strong>Entamoeba histolytica (Option D): </strong>Do not have oocysts.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/cCXjiYreWXyZbaIntJcV1743482322.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/3jiHkOAl2rEqoaN0rMvx1750752473.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/qTb9YSYAtmeESR03zTST1750752546.mp3"
  }
];
        let quizName = '42 Malabsorption Syndrome, Celiac Disease, And Ibd';
        const quizFilename = '42-malabsorption-syndrome-celiac-disease-and-ibd-5f8e28ec.html';
        let hierarchy = ["PrepLadder", "qBank", "Pathology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>