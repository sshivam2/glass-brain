<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>03 Cell Ageing, Autophagy And Cellular Adaptations - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Pathology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">14</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>Which of the following statements best describes the role of telomerase in cellular ageing?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Telomerase accelerates ageing by reducing the length of telomeres with each cell division"
      },
      {
        "id": 2,
        "text": "Telomerase maintains the constant telomere length in somatic cells throughout their lifespan."
      },
      {
        "id": 3,
        "text": "Telomerase prevents the shortening of telomeres by adding DNA sequences to the ends of chromosomes, thus potentially extending cell's lifespan."
      },
      {
        "id": 4,
        "text": "Telomerase is a Ribozyme delaying cell aging."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) </strong><strong>Telomerase prevents the shortening of telomeres by adding DNA sequences to the ends of chromosomes, thus potentially extending cells' lifespan.</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Telomerase prevents the shortening of telomeres by adding DNA sequences to the ends of chromosomes, thus potentially extending cells' lifespan.</p>\n\n<p><strong>Telomere:\u00a0</strong>It is the sequence present on the <span class=\"customMeta\" data-dictid=\"16b76d1d1c1692777200240efcb0e2\">terminal</span> of chromosomes. Ageing is due to the shortening of telomeres as the person grows.</p>\n\n<p><strong>Telomerase</strong>, also known as the immortality gene, is an RNA-dependent DNA <span class=\"customMeta\" data-dictid=\"d419920a6616927771969805c3d65d\">polymerase</span> <span class=\"customMeta\" data-dictid=\"0f160e4e42169277718771b715516a\">enzyme</span> that adds DNA sequences to the ends of chromosomes, preventing <span class=\"customMeta\" data-dictid=\"b9d804af7716927772001ebdb234b1\">telomere</span> shortening during cell division.</p>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"600\" src=\"https://image.prepladder.com/content/TncpFcOIw8xNQzm4IWxO1737445987.png\" width=\"600\" /></p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/TncpFcOIw8xNQzm4IWxO1737445987.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/9py85Zj9HdVwBGEwgkiJ1739726194.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/CLgGUZHTUSJnCnyVa3c11739726316.mp3"
  },
  {
    "text": "<p>Which of the following statements is correct about the concept of the Hayflick Limit?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "The ageing of cells is not determined by telomere length."
      },
      {
        "id": 2,
        "text": "It refers to the age at which cells cease all metabolic activities and undergo apoptosis."
      },
      {
        "id": 3,
        "text": "A cell typically undergoes 20-40 cell divisions before reaching senescence."
      },
      {
        "id": 4,
        "text": "It represents the average number of times a cell can divide before experiencing replicative senescence."
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) It represents the maximum number of times a cell can divide before experiencing <span class=\"customMeta\" data-dictid=\"0028076ebe16927771979205994881\">replicative</span> senescence.</strong></p>\n\n<p><strong>Explanation:</strong>\u00a0</p>\n\n<p>The <strong>Hayflick limit or Hayflick\u2019s phenomenon</strong> represents the number of cell divisions a cell undergoes before reaching its <span class=\"customMeta\" data-dictid=\"0028076ebe16927771979205994881\">replicative</span> <span class=\"customMeta\" data-dictid=\"39a6f8bd3a1692777198ce5cfdeff7\">senescence</span> or ageing.</p>\n\n<ul>\n\t<li>Somatic cells typically undergo around <strong>60</strong>-100 divisions before entering a state of <span class=\"customMeta\" data-dictid=\"0028076ebe16927771979205994881\">replicative</span> senescence.</li>\n\t<li>Cells start to show signs of ageing after a finite number of divisions due to factors like <span class=\"customMeta\" data-dictid=\"b9d804af7716927772001ebdb234b1\">telomere</span> shortening and changes in gene expression.</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/2dCMzrMyeG32uLxwneNU1749020165.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/0BIQ7yjwaDCOocad3CKT1749020229.mp3"
  },
  {
    "text": "<p>How do \u201cSirtuins\u201d contribute to cellular ageing?</p>\n\n<ul>\n</ul>",
    "choices": [
      {
        "id": 1,
        "text": "By accelerating telomere shortening."
      },
      {
        "id": 2,
        "text": "By enhancing cell repair mechanisms and exerting anti-ageing effects."
      },
      {
        "id": 3,
        "text": "By functioning as histone acetyltransferases, promoting chromatin condensation."
      },
      {
        "id": 4,
        "text": "By decreasing insulin sensitivity"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) By enhancing cell repair mechanisms and exerting anti-ageing effects.</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<p>Sirtuins are a family of NAD-dependent protein deacetylases produced by SIRT genes (SIRT1-7) that play a key role in DNA repair mechanisms and are involved in maintaining genomic stability</p>\n\n<p>Functions/benefits of sirtuins:</p>\n\n<ul>\n\t<li>Anti-ageing\n\t<ul>\n\t\t<li>Prevents\u00a0telomerase from shortening <strong>(Option A ruled out)</strong></li>\n\t</ul>\n\t</li>\n\t<li>Cell repair\u00a0</li>\n\t<li>Increases the <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> sensitivity of tissues: Beneficial for DM patients and slows down ageing. <strong>(Option D ruled out)</strong></li>\n</ul>\n\n<p>Sirtuins are <span class=\"customMeta\" data-dictid=\"2f9fcbc0831692777189f689777d4f\">histone</span> deacetylases\u00a0<strong>(Option C ruled out)</strong></p>\n\n<p>Sirtuins increase <span class=\"customMeta\" data-dictid=\"b47c9c6144169277719010eaa1a0ee\">insulin</span> sensitivity</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/5qLZSomAcWDMzTtR3c1c1739726483.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/2hVPnpoTwNtBY6bCoDPT1739726624.mp3"
  },
  {
    "text": "<p>A 36-year-old male presents to the clinic with complaints of bilateral cataracts, short stature, premature greying and loss of hair, and skin changes. He also reports joint stiffness and pain, as well as type 2 diabetes mellitus. On examination, the patient appears older than his stated age, with characteristic \"bird-like\" facies and a high-pitched voice. Which of the following conditions is most likely to be associated with his presentation?</p>\n\n<ul>\n</ul>",
    "choices": [
      {
        "id": 1,
        "text": "Hutchinson-Gilford Syndrome"
      },
      {
        "id": 2,
        "text": "Werner syndrome"
      },
      {
        "id": 3,
        "text": "Wermer syndrome"
      },
      {
        "id": 4,
        "text": "Cockayne Syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) </strong><strong>Werner syndrome</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<p>The clinical presentation points towards <strong>Werner syndrome, </strong>also known as <strong>Adult Progeria Syndrome</strong>, an autosomal <span class=\"customMeta\" data-dictid=\"d54db2110416927771971e7c011a9f\">recessive</span> disorder characterized by <span class=\"customMeta\" data-dictid=\"84f13673191692777196762b18e036\">premature</span> ageing features that typically manifest in <strong>adulthood</strong>. It is associated with a <strong>DNA <span class=\"customMeta\" data-dictid=\"b743df46a21692777188fd0624955a\">helicase</span> defect.</strong></p>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"\" data-author=\"Hum genet\" data-hash=\"\" data-license=\"NA\" data-source=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4586253/figure/F1/\" data-tags=\"\" height=\"849\" src=\"https://image.prepladder.com/content/LxXmYxb8xjoMyTque6aT1737446083.png\" width=\"660\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>\n\n<p><strong>Hutchinson-Gilford Syndrome (Option A):\u00a0</strong>It is a rare genetic <span class=\"customMeta\" data-dictid=\"1d410168d116927771969246727ffa\">progeroid</span> syndrome characterized by severe <span class=\"customMeta\" data-dictid=\"84f13673191692777196762b18e036\">premature</span> ageing features that begin in <strong>childhood</strong>.\u00a0It is a Laminopathy due to a\u00a0Lamin-A (LMNA) gene mutation.</p>\n\n<p><strong>Wermer Syndrome (Option C):</strong>\u00a0Wermer Syndrome is for as <strong>multiple <span class=\"customMeta\" data-dictid=\"d8216cf7571692777187baa94b8612\">endocrine</span> <span class=\"customMeta\" data-dictid=\"e212826c171692777193374ca34435\">neoplasia</span> <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">type 1</span> (MEN 1).</strong></p>\n\n<p><strong>Cockayne Syndrome (Option D):\u00a0</strong>It is also a rare autosomal <span class=\"customMeta\" data-dictid=\"d54db2110416927771971e7c011a9f\">recessive</span> <span class=\"customMeta\" data-dictid=\"1d410168d116927771969246727ffa\">progeroid</span> syndrome. However, it typically presents in childhood.\u00a0ERCC gene defect.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/LxXmYxb8xjoMyTque6aT1737446083.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/4PFa6Bk8ZCNoICFOJZks1739726969.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/IOBwVsw4heNnvB3pGtm91739727071.mp3"
  },
  {
    "text": "<p>Which cellular process is primarily responsible for the degradation and recycling of unnecessary or dysfunctional cellular components?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Autophagy"
      },
      {
        "id": 2,
        "text": "Necrosis"
      },
      {
        "id": 3,
        "text": "Apoptosis"
      },
      {
        "id": 4,
        "text": "Pyroptosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Autophagy</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<p><strong>Autophagy (aka\u00a0cell cannibalism)</strong> is a <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> process by which a cell eats its own contents and plays a critical role in maintaining <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> homeostasis, responding to stressors such as nutrient deprivation, and eliminating potentially harmful <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> materials.</p>\n\n<ul>\n\t<li>Autophagy has 4 types:\n\t<ul>\n\t\t<li>Macro-autophagy: Eats <span class=\"customMeta\" data-dictid=\"385d52533a169277719991c090c3d7\">substrate</span> by forming a <span class=\"customMeta\" data-dictid=\"34cd707428169277719272942b7905\">membrane</span> around it (Autophagosome)</li>\n\t\t<li>Micro-autophagy: Eats <span class=\"customMeta\" data-dictid=\"385d52533a169277719991c090c3d7\">substrate</span> by endocytosis</li>\n\t\t<li>Chaperone-mediated autophagy</li>\n\t\t<li>Mitophagy: Mitochondria are eaten</li>\n\t</ul>\n\t</li>\n\t<li>Marker of autophagy: <strong>LC3</strong></li>\n\t<li>Most important gene for autophagy: <strong>ATG1 gene</strong></li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/z0Q2BXi4vKlXlSNCrCjh1739729108.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/LwheLYAqjyfS9INX7puQ1739729264.mp3"
  },
  {
    "text": "<p>What is the mechanism by which chaperone-mediated autophagy (CMA) targets misfolded proteins for degradation?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Direct uptake by lysosomes via endocytosis"
      },
      {
        "id": 2,
        "text": "Activation of mTOR leading to inhibition of ULK1 complex"
      },
      {
        "id": 3,
        "text": "Selective degradation of damaged or dysfunctional mitochondria"
      },
      {
        "id": 4,
        "text": "Binding of chaperones to misfolded proteins, followed by lysosomal entry via LAMP2A for autophagy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) Binding of chaperones to misfolded proteins, followed by lysosomal entry via LAMP2A for autophagy</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>In chaperone-mediated autophagy, <span class=\"customMeta\" data-dictid=\"b7838d3ab0169277718429c132f434\">chaperone</span> proteins (Eg, Heat shock proteins) recognize and bind to specific protein substrates that are misfolded or damaged.\u00a0The chaperone-substrate complex then interacts with the lysosomal-associated <span class=\"customMeta\" data-dictid=\"34cd707428169277719272942b7905\">membrane</span> protein LAMP2A, facilitating the <span class=\"customMeta\" data-dictid=\"385d52533a169277719991c090c3d7\">substrate</span> protein's <span class=\"customMeta\" data-dictid=\"8ba7332e86169277720060bd4507c8\">translocation</span> into the <span class=\"customMeta\" data-dictid=\"a7f502e35b1692777191b110a4b679\">lysosome</span> for degradation.</p>\n\n<p><strong>Direct <span class=\"customMeta\" data-dictid=\"cc20d2d7111692777201fb0caeb3f2\">uptake</span> by lysosomes via <span class=\"customMeta\" data-dictid=\"9026c87b2c169277718729d7c7ce75\">endocytosis</span> (Option A)\u00a0</strong>is mechanism is observed in Microautophagy.</p>\n\n<p><strong>Inhibition of mTOR leading to <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">activation</span> of ULK1 complex (Option B)\u00a0</strong>is seen in Macroautophagy.</p>\n\n<p><strong>Selective <span class=\"customMeta\" data-dictid=\"d395f610461692777185cbe8b8806d\">degradation</span> of damaged or dysfunctional <span class=\"customMeta\" data-dictid=\"18c9e7b9721692777192bd042528cc\">mitochondria</span> (Option C)\u00a0</strong>is seen in Mitophagy.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/G5GoN6MX0SBvnO5VZMry1739729401.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/NZpGjAByXKMqMwkqLV2Q1739729525.mp3"
  },
  {
    "text": "<p>Which of the following biomarkers is associated with autophagy?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Annexin A1"
      },
      {
        "id": 2,
        "text": "Annexin V"
      },
      {
        "id": 3,
        "text": "Beclin 1"
      },
      {
        "id": 4,
        "text": "LC3"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) LC3</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>LC3, or Microtubule-associated protein 1 <span class=\"customMeta\" data-dictid=\"578fe8d7dd16927771913c847ed254\">light chain</span> 3, is a reliable marker of autophagy.</li>\n\t<li>Most important gene for autophagy: ATG1 gene</li>\n</ul>\n\n<p><strong>Annexin A1 (Option A):\u00a0</strong>Annexin A1 is a marker of <span class=\"customMeta\" data-dictid=\"a4789768d21692777188e77f1969cd\">hairy</span> cell leukaemia.</p>\n\n<p><strong>Annexin 5 (Option B):\u00a0</strong>Marker of apoptosis</p>\n\n<p><strong>Beclin 1 (Option C):\u00a0</strong>Beclin-1 is not a direct marker of <span class=\"customMeta\" data-dictid=\"06d27b773a1692777182ec37e7fb5f\">autophagy</span> but plays a crucial role in initiating autophagy</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/ZDBIbZ4rFMW27VSHotR21739729608.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/aLlj9KiTN4YMCIWMY1zT1739729655.mp3"
  },
  {
    "text": "<p>Which statement accurately distinguishes between hypertrophy and hyperplasia?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Hypertrophy involves an increase in cell number, while hyperplasia involves an increase in cell size."
      },
      {
        "id": 2,
        "text": "Hypertrophy increases tissue mass, while hyperplasia maintains tissue mass."
      },
      {
        "id": 3,
        "text": "Hypertrophy is irreversible, while hyperplasia is reversible."
      },
      {
        "id": 4,
        "text": "Hypertrophy results from increased cellular protein production, while hyperplasia involves growth factor-driven proliferation of mature cells."
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) </strong><strong>Hypertrophy results from increased <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> protein production, while <span class=\"customMeta\" data-dictid=\"4c5d5ef6c31692777189820d4b320d\">hyperplasia</span> involves growth factor-driven <span class=\"customMeta\" data-dictid=\"8eedb6cec61692777196a6a3b93d3f\">proliferation</span> of <span class=\"customMeta\" data-dictid=\"0472620c171692777192c655af9c57\">mature</span> cells.</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Hypertrophy results from increased <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> protein production, while <span class=\"customMeta\" data-dictid=\"4c5d5ef6c31692777189820d4b320d\">hyperplasia</span> involves growth factor-driven <span class=\"customMeta\" data-dictid=\"8eedb6cec61692777196a6a3b93d3f\">proliferation</span> of <span class=\"customMeta\" data-dictid=\"0472620c171692777192c655af9c57\">mature</span> cells.</p>\n\n<table align=\"center\" border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:800px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"text-align:center\"><strong>Hypertrophy</strong></td>\n\t\t\t<td style=\"text-align:center\"><strong>Hyperplasia</strong></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t<ul>\n\t\t\t\t<li>Hypertrophy is characterized by increased <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> protein (GATA4, NFAT, MEF2) production, which leads to the <span class=\"customMeta\" data-dictid=\"41e56d9a54169277718724ff8c225f\">enlargement</span> of cells and tissues due to an increase in cell size.</li>\n\t\t\t\t<li>An increase in <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> proteins occurs either through enhanced central <span class=\"customMeta\" data-dictid=\"0027c075df169277718662b6b8f411\">dogma</span> processes (transcription and translation) or through an increase of <span class=\"customMeta\" data-dictid=\"739aa4b5ea1692777200a636ee075f\">transcription</span> factors.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t<ul>\n\t\t\t\t<li>Hyperplasia is described as the result of growth factor-driven <span class=\"customMeta\" data-dictid=\"8eedb6cec61692777196a6a3b93d3f\">proliferation</span> of <span class=\"customMeta\" data-dictid=\"0472620c171692777192c655af9c57\">mature</span> cells.</li>\n\t\t\t\t<li>In hyperplasia, the number of cells within an organ or tissue increases.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<ul>\n\t<li>Hypertrophy involves an increase in cell size, while <span class=\"customMeta\" data-dictid=\"4c5d5ef6c31692777189820d4b320d\">hyperplasia</span> involves an increase in cell number.\u00a0<strong>(Option A ruled out)</strong></li>\n\t<li>Both <span class=\"customMeta\" data-dictid=\"3baac9012a1692777189cb4dc70c04\">hypertrophy</span> and <span class=\"customMeta\" data-dictid=\"4c5d5ef6c31692777189820d4b320d\">hyperplasia</span> increase tissue mass.\u00a0<strong>(Option B ruled out)</strong></li>\n\t<li>Hypertrophy can be reversible.\u00a0<strong>(Option C ruled out)</strong></li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/eAMe7ysR5xQ2TVFcZ8UR1739730346.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/QZibTbPIaUwY6YzzuN2F1739730459.mp3"
  },
  {
    "text": "<p>A 45-year-old female presents with irregular and heavy menstrual bleeding for the past six months. She reports experiencing prolonged periods lasting more than ten days with excessive bleeding, abdominal discomfort, and pelvic pain during her menstrual cycle. On further evaluation, transvaginal ultrasound reveals thickening of the endometrial lining. Endometrial biopsy confirms the presence of abnormal glandular proliferation without cytologic atypia. Which of the following best describes the cellular adaptation observed in this clinical scenario?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Physiological hypertrophy"
      },
      {
        "id": 2,
        "text": "Pathological hypertrophy"
      },
      {
        "id": 3,
        "text": "Physiological hyperplasia"
      },
      {
        "id": 4,
        "text": "Pathological hyperplasia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) <span class=\"customMeta\" data-dictid=\"c0c247b89916927771948bc5e6d39c\">Pathological</span> hyperplasia</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<p>This is a case of endometrial hyperplasia, a <span class=\"customMeta\" data-dictid=\"c0c247b89916927771948bc5e6d39c\">pathological</span> hyperplasia.</p>\n\n<table align=\"center\" cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\u00a0</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Definition</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Examples</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Physiological hypertrophy</strong><br />\n\t\t\t<strong>(Option A)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Increase in the size of cells or organs.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Uterine <span class=\"customMeta\" data-dictid=\"3baac9012a1692777189cb4dc70c04\">hypertrophy</span> during pregnancy due to <span class=\"customMeta\" data-dictid=\"f5499837d31692777187477cd15613\">estrogenic</span> hormone signalling.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p style=\"text-align:center\"><strong>Pathological hypertrophy</strong><br />\n\t\t\t<strong>(Option B)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Cell <span class=\"customMeta\" data-dictid=\"41e56d9a54169277718724ff8c225f\">enlargement</span> occurs in response to increased workload or stress</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Heart <span class=\"customMeta\" data-dictid=\"41e56d9a54169277718724ff8c225f\">enlargement</span> from <span class=\"customMeta\" data-dictid=\"45372f6c361692777189ff3209e642\">hypertension</span> or valvular disease.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Physiological hyperplasia</strong><br />\n\t\t\t<strong>(Option C)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>An increase in the number of cells in response to hormonal or growth factor stimulation.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Breast <span class=\"customMeta\" data-dictid=\"c2f9d01ba91692777188d264244b6a\">glandular</span> <span class=\"customMeta\" data-dictid=\"53782f88d31692777187177cb73b24\">epithelium</span> <span class=\"customMeta\" data-dictid=\"8eedb6cec61692777196a6a3b93d3f\">proliferation</span> during <span class=\"customMeta\" data-dictid=\"c284c4252f16927771963c07a95e13\">puberty</span> or pregnancy.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Pathological hyperplasia</strong><br />\n\t\t\t<strong>(Option D)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Occurs when there is an <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> increase in the number of cells in an organ or tissue due to excessive or inappropriate hormonal or growth factor stimulation</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Endometrial <span class=\"customMeta\" data-dictid=\"4c5d5ef6c31692777189820d4b320d\">hyperplasia</span> due to <span class=\"customMeta\" data-dictid=\"4586eccbe71692777186e577e31829\">disturbance</span> in estrogen-progesterone balance.</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/QkrWfeRpJFm4RJE7Q6lz1739730598.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/9N3cntlqj0fH4LsYOXAz1739730855.mp3"
  },
  {
    "text": "<p>Which of the following statements about the mechanism of hypertrophy is inaccurate?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Activation of G-protein-coupled receptor-initiated pathways"
      },
      {
        "id": 2,
        "text": "Stimulation of growth factor production such as TGF-\u03b2 and IGF1"
      },
      {
        "id": 3,
        "text": "Inhibition of transcription factors like GATA4, MEF2, NFAT"
      },
      {
        "id": 4,
        "text": "Activation of downstream pathways including the PI3K/AKT pathway"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) <span class=\"customMeta\" data-dictid=\"f03ca2d2a716927771901227bc175a\">Inhibition</span> of <span class=\"customMeta\" data-dictid=\"739aa4b5ea1692777200a636ee075f\">transcription</span> factors like GATA4, MEF2, NFAT</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<p><strong>Hypertrophy</strong> actually involves the <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">activation</span> (not inhibition) of <span class=\"customMeta\" data-dictid=\"739aa4b5ea1692777200a636ee075f\">transcription</span> factors such as GATA4, NFAT, and MEF2.</p>\n\n<ul>\n\t<li>They enhance the expression of genes <span class=\"customMeta\" data-dictid=\"b989cb3b0d1692777187dd7965b4d3\">encoding</span> muscle proteins, promoting <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> growth and hypertrophy.</li>\n\t<li>When\u00a0transcription factors will increase:\n\t<ul>\n\t\t<li>More DNA will be converted to RNA, which will create more proteins, leading to an increase in cell size (hypertrophy).</li>\n\t</ul>\n\t</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/kWP3RPbMBuHI6w3hRQVM1739732028.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/UF6ruwryZ0V491lxkRJn1739732157.mp3"
  },
  {
    "text": "<p>Which of the following is an example of physiological atrophy?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Testicular atrophy due to hypogonadism"
      },
      {
        "id": 2,
        "text": "Intestinal villi atrophy in malabsorption syndromes"
      },
      {
        "id": 3,
        "text": "Reduction in thymus gland size during ageing"
      },
      {
        "id": 4,
        "text": "Brain atrophy in neurodegenerative diseases"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Reduction in <span class=\"customMeta\" data-dictid=\"fbd2788fff16927772009c0137de78\">thymus</span> <span class=\"customMeta\" data-dictid=\"4744bb90c21692777188c8957f9faa\">gland</span> size during ageing</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Reduction in <span class=\"customMeta\" data-dictid=\"fbd2788fff16927772009c0137de78\">thymus</span> <span class=\"customMeta\" data-dictid=\"4744bb90c21692777188c8957f9faa\">gland</span> size during ageing is an example of <span class=\"customMeta\" data-dictid=\"6c2c85ae6b16927771950809419a59\">physiological</span> atrophy.</p>\n\n<p><strong>Physiological atrophy</strong> refers to the normal, programmed decrease in the size or mass of tissues, organs, or structures in the body.</p>\n\n<ul>\n\t<li>The <span class=\"customMeta\" data-dictid=\"fbd2788fff16927772009c0137de78\">thymus</span> gland, which is involved in the development of the immune system, tends to decrease in size and activity with age, which is an example of <span class=\"customMeta\" data-dictid=\"6c2c85ae6b16927771950809419a59\">physiological</span> atrophy.</li>\n</ul>\n\n<p><strong>Pathological atrophy</strong>, on the other hand, refers to the <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> decrease in the size or mass of tissues, organs, or structures due to disease, injury, or other <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> conditions.</p>\n\n<ul>\n\t<li>Testicular atrophy, intestinal <span class=\"customMeta\" data-dictid=\"97ff5253fb169277718224c7b0faf8\">atrophy</span> and brain atrophy\u00a0 are examples of <strong>pathological atrophy. (Options A, B,\u00a0D ruled out)</strong></li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/BmO6rgGdtZd1V91PSJxM1739731757.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/aXtaaXrWD1DS5wL6JkmM1739731815.mp3"
  },
  {
    "text": "<p>Which type of atrophy is observed in a patient with smaller and weaker muscles who is bedridden for several weeks?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Disuse atrophy"
      },
      {
        "id": 2,
        "text": "Neurogenic atrophy"
      },
      {
        "id": 3,
        "text": "Endocrine atrophy"
      },
      {
        "id": 4,
        "text": "Senile atrophy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Disuse atrophy</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><strong>Disuse <span class=\"customMeta\" data-dictid=\"97ff5253fb169277718224c7b0faf8\">atrophy</span> </strong>is seen in a patient with smaller, weaker muscles after being bedridden for several weeks.</p>\n\n<ul>\n\t<li>During prolonged periods of immobility, such as extended bed rest, the muscles experience decreased mechanical <span class=\"customMeta\" data-dictid=\"00a5dcc74b16927771913b344e36a3\">loading</span> and activity.</li>\n\t<li>This lack of <span class=\"customMeta\" data-dictid=\"7f3792072b1692777199fd8e2c4f59\">stimulation</span> decreases muscle protein <span class=\"customMeta\" data-dictid=\"3fda45538a1692777199ec2a5478a5\">synthesis</span> and increases protein breakdown, resulting in muscle <span class=\"customMeta\" data-dictid=\"9971eacaaf1692777202d2ece15a2a\">wasting</span> and weakness.</li>\n</ul>\n\n<p><strong>Neurogenic <span class=\"customMeta\" data-dictid=\"97ff5253fb169277718224c7b0faf8\">atrophy</span> (Option B): </strong>Atrophy due to hampered nerve supply.\u00a0E.g.- In\u00a0polio patients, the muscle will become immobile, leading to <span class=\"customMeta\" data-dictid=\"fec88fc386169277719326fdef547f\">neurogenic</span> atrophy.</p>\n\n<p><strong>Endocrine <span class=\"customMeta\" data-dictid=\"97ff5253fb169277718224c7b0faf8\">atrophy</span> (Option C):\u00a0</strong>Atrophy due to a decrease in hormones.\u00a0E.g. - A\u00a0decrease in the level of estrogens\u00a0leading to endometrial atrophy, which is seen in <span class=\"customMeta\" data-dictid=\"c9ba8fa63616927771962d84263e40\">postmenopausal</span> women.</p>\n\n<p><strong>Senile <span class=\"customMeta\" data-dictid=\"97ff5253fb169277718224c7b0faf8\">atrophy</span> (Option D):\u00a0</strong>Seen in old age and in patients with Alzheimer's disease.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/zCp9FelTkMwcgg5IQVDF1739731442.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/mMwEAc7OwuxjqQTgUnvE1739731620.mp3"
  },
  {
    "text": "<p>Which type of metaplasia characterizes the histological changes observed in Barrett's oesophagus?</p>\n\n<ul>\n</ul>",
    "choices": [
      {
        "id": 1,
        "text": "Transformation of columnar epithelium to squamous epithelium"
      },
      {
        "id": 2,
        "text": "Replacement of squamous epithelium with columnar epithelium containing goblet cells"
      },
      {
        "id": 3,
        "text": "Conversion of glandular epithelium to squamous epithelium"
      },
      {
        "id": 4,
        "text": "Substitution of mesenchymal cells with epithelial cells"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: </strong><strong>B) Replacement of <span class=\"customMeta\" data-dictid=\"5be0ee4ea316927771997104326685\">squamous</span> <span class=\"customMeta\" data-dictid=\"53782f88d31692777187177cb73b24\">epithelium</span> with <span class=\"customMeta\" data-dictid=\"8ff554096316927771851cc310435e\">columnar epithelium</span> containing goblet cells</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>Barrett's <span class=\"customMeta\" data-dictid=\"84f4cb0ade16927771940b83eacc37\">oesophagus</span> is characterized by the replacement of the normal <span class=\"customMeta\" data-dictid=\"5be0ee4ea316927771997104326685\">squamous</span> <span class=\"customMeta\" data-dictid=\"53782f88d31692777187177cb73b24\">epithelium</span> of the lower <span class=\"customMeta\" data-dictid=\"84f4cb0ade16927771940b83eacc37\">oesophagus</span> with <span class=\"customMeta\" data-dictid=\"8ff554096316927771851cc310435e\">columnar epithelium</span> containing goblet cells. (Goblet cells contain <span class=\"customMeta\" data-dictid=\"3a983e569716927771805ed22b90d7\">acidic</span> <span class=\"customMeta\" data-dictid=\"7d30ef9aee16927771936bdac2c1ff\">mucin</span> <span class=\"customMeta\" data-dictid=\"3b007026bd16927771997ae809b603\">staining</span> positive with alcian blue, which helps to <span class=\"customMeta\" data-dictid=\"c9001edbf216927771860f3475b44c\">differentiate</span> from intestinal epithelium)</li>\n\t<li>This <span class=\"customMeta\" data-dictid=\"03f835a65f169277719239326cc094\">metaplastic</span> change is considered an adaptive response to <span class=\"customMeta\" data-dictid=\"bf11df6de316927771845ac371b9b6\">chronic exposure</span> to <span class=\"customMeta\" data-dictid=\"12347b15191692777188bc86d226e1\">gastric</span> acid and <span class=\"customMeta\" data-dictid=\"cf978047b61692777183c0569f21f2\">bile</span> <span class=\"customMeta\" data-dictid=\"def94cc96d16927771970d1a5cfb71\">reflux</span> in the setting of <span class=\"customMeta\" data-dictid=\"9f47bfb9a616927771887db45c89c7\">gastroesophageal</span> <span class=\"customMeta\" data-dictid=\"def94cc96d16927771970d1a5cfb71\">reflux</span> disease (GERD).</li>\n</ul>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"\" data-author=\"Nephron\" data-hash=\"\" data-license=\"CC BY SA 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:Esophagus_with_intestinal_metaplasia_--_low_mag.jpg\" data-tags=\"\" height=\"350\" src=\"https://image.prepladder.com/content/LdO4wfwPqkpCmbJBJ6S01737446201.png\" width=\"600\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/content/LdO4wfwPqkpCmbJBJ6S01737446201.png"
    ],
    "explanation_audio_eng": "https://image.prepladder.com/content/8sMw67Cwuh11a8HlkbuD1739731236.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/JXa8GhJMWyIfl5yvsK5j1739731302.mp3"
  },
  {
    "text": "<p>Which of the following statements regarding metaplasia is true?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Metaplasia refers to the abnormal growth of cells, often leading to cancer."
      },
      {
        "id": 2,
        "text": "It is a reversible change in which one adult cell type is replaced by another adult cell type."
      },
      {
        "id": 3,
        "text": "Metaplasia is always a pathological process and never occurs in response to normal physiological stimuli."
      },
      {
        "id": 4,
        "text": "Metaplasia is characterized by the replacement of differentiated cells with undifferentiated stem cells."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: </strong><strong>B) It is a <span class=\"customMeta\" data-dictid=\"a4488d66fc16927771975d043c4ccc\">reversible</span> change in which one adult cell type is replaced by another adult cell type</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Metaplasia is a <span class=\"customMeta\" data-dictid=\"a4488d66fc16927771975d043c4ccc\">reversible</span> process in which one adult cell type is replaced by another, typically in response to chronic <span class=\"customMeta\" data-dictid=\"3a74ed0fcf16927771901a79847565\">irritation</span> or inflammation. Either 1 <span class=\"customMeta\" data-dictid=\"53782f88d31692777187177cb73b24\">epithelium</span> can change into another or 1 mesenchymal cell can change into another mesenchymal cell</p>\n\n<ul>\n\t<li>In metaplasia, normal cells are involved. If cells are abnormal, then it is <strong>Dysplasia</strong>\u00a0<strong>(Option A ruled out)</strong></li>\n\t<li>Metaplasia can sometimes occur in response to normal <span class=\"customMeta\" data-dictid=\"6c2c85ae6b16927771950809419a59\">physiological</span> stimuli\u00a0<strong>(Option C ruled out)</strong></li>\n\t<li>In metaplasis, the programming of stem cells is changing, because of which previous <span class=\"customMeta\" data-dictid=\"53782f88d31692777187177cb73b24\">epithelium</span> is replaced by new epithelium\u00a0<strong>(Option D ruled out)</strong></li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": "https://image.prepladder.com/content/lQcPJoCqkDbnNoIULWOZ1739731074.mp3",
    "explanation_audio_hin": "https://image.prepladder.com/content/YWoVAysJQe2onYKrxPlc1739731166.mp3"
  }
];
        let quizName = '03 Cell Ageing, Autophagy And Cellular Adaptations';
        const quizFilename = '03-cell-ageing-autophagy-and-cellular-adaptations-f5aea07b.html';
        let hierarchy = ["PrepLadder", "qBank", "Pathology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>