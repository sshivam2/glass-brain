<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histopathology  Slides Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 35-year-old patient presents with frequent heartburn. A biopsy of the esophageal mucosa is shown below. Which of the following is true regarding the stain used in this case?",
    "choices": [
      {
        "id": 1,
        "text": "It stains foamy macrophages in Whipple's disease"
      },
      {
        "id": 2,
        "text": "It does not stain mucin of gastric mucosa"
      },
      {
        "id": 3,
        "text": "It can demonstrate hemosiderin and iron"
      },
      {
        "id": 4,
        "text": "It stains calcified tissues in malakoplakia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The patient's symptoms and histology findings are suggestive of&nbsp;<strong>Barrett's esophagus</strong>, and&nbsp;<strong>mucin stain (Alcian blue)&nbsp;</strong>is used&nbsp;to identify&nbsp;<strong>goblet cells,</strong>&nbsp;which are indicative of the intestinal metaplasia occurring in the condition. It does not stain&nbsp;mucin of the&nbsp;<strong>gastric mucosa.</strong> It is a <strong>positive stain</strong> for acidic mucins of the <strong>intestinal mucosa</strong> and a <strong>negative stain</strong> for neutral mucins of <strong>gastric mucosa</strong> and <strong>Brunner's gland.</strong></p>\n<p>Barrett's esophagus is a type of metaplasia at the gastro-esophagal junction due to chronic gastroesophageal reflux disease (GERD). The&nbsp;<strong>squamous</strong>&nbsp;esophageal mucosa is converted to a<strong>&nbsp;columnar/intestinal</strong>&nbsp;type that is better suited to handle acid reflux. It is associated with an increased risk of esophageal adenocarcinoma.</p>\n<p>Grossly it appears as tongues of red, velvety mucosa extending upward from the gastroesophageal junction. This metaplastic mucosa alternates with residual smooth, pale squamous (esophageal) mucosa.&nbsp;<strong>Goblet cells</strong>&nbsp;are diagnostic of Barrett's esophagus and have distinct mucous vacuoles that stain pale blue and impart the shape of a wine goblet to the remaining cytoplasm.</p>\n<p>Option A:&nbsp;The foamy macrophages in Whipple's disease stain positive with&nbsp;<strong>periodic acid&ndash;Schiff (PAS).</strong></p>\n<p><strong><img src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/b89fc65cb20c44f49665d2b5ec68c91fx1280x1920.JPEG\" width=\"201\" height=\"302\" /></strong></p>\n<p>Option C: Hemosiderin and iron is demonstrated by&nbsp;<strong>Perl's Prussian blue</strong>&nbsp;stain. It is used in&nbsp;<strong>hemochromatosis&nbsp;</strong>to stain liver tissue, which shows hepatocellular iron. Iron is stained<strong>&nbsp;blue</strong>&nbsp;with this stain.</p>\n<p><img src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/85e22852d8b240f78fcba1aee09f0fefx720x576.JPEG\" width=\"255\" height=\"204\" /></p>\n<p>Option D:&nbsp;<strong>Von Kossa stain</strong>&nbsp;demonstrating calcium and iron-containing&nbsp;<strong>Michaelis-Gutman bodies</strong>&nbsp;(MG bodies) in&nbsp;<strong>malakoplakia&nbsp;</strong>is shown in the image given below:</p>\n<p><img src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/b537551de2da4da889a63c5cf008e66bx1199x816.JPEG\" width=\"283\" height=\"193\" /></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/72303fc41b19428b832f844b9fd61d9f.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The micrograph of a section of a diseased liver, stained with Masson\u2019s Trichrome stain,  is given below.  The arrow points to:",
    "choices": [
      {
        "id": 1,
        "text": "Copper"
      },
      {
        "id": 2,
        "text": "Collagen"
      },
      {
        "id": 3,
        "text": "Melanin"
      },
      {
        "id": 4,
        "text": "Ferritin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The arrow in the above micrograph of the diseased liver points to <strong>areas of fibrosis</strong> containing <strong>collagen </strong>that\u00a0is<strong> stained blue by Masson\u2019s trichrome stain</strong>.\u00a0</p>\n<p>The liver has a prominent (centrilobular) macrovesicular steatosis (white/clear round/oval spaces) and mild fibrosis (blue). The hepatocytes are stained red.</p>\n<p>The differential diagnoses of centrilobular macrovesicular hepatic steatosis are:</p>\n<ul>\n<li>Diabetes</li>\n<li>Obesity</li>\n<li>Alcohol</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e318cf3cf6eb45b2970c5ec3c95ebbc3.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "An elderly woman presented with complaints of pigmentation on her face. An excisional biopsy was done, and histopathology findings are shown below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Basal cell carcinoma"
      },
      {
        "id": 2,
        "text": "Malignant melanoma"
      },
      {
        "id": 3,
        "text": "Squamous cell carcinoma"
      },
      {
        "id": 4,
        "text": "Merkel cell carcinoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The given clinical scenario of pigmentation in the face and histopathology showing dense intracytoplasmic brownish-black <strong>melanin pigment</strong> are suggestive of <strong>malignant melanoma</strong>.\u00a0</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Malignant melanoma\u00a0primarily arises from\u00a0<strong>melanocytes</strong> at the epidermal-dermal junction.</p>\n<p>The lesions of melanoma can be described using the <strong>ABCDE</strong> criteria. It comprises <strong>A</strong>symmetry, <strong>B</strong>order irregularity, <strong>C</strong>olor variegation, <strong>D</strong>iameter of more than 6 mm and <strong>E</strong>volution or change</p>\n<p>The image below shows a case of malignant melanoma.</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/43fd10506e384fdaa631b7a7cb6750cf.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/28946670ad0a434a850ce85293fb0621x896x1197.JPEG"
    ]
  },
  {
    "text": "A young boy who is a known case of Klinefelter's syndrome presents with a painless scrotal swelling and precocious puberty. After an initial ultrasound that revealed a testicular mass, surgical removal was done. The specimen was sent for histopathological analysis; the findings are shown in the image below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Leydig cell tumor"
      },
      {
        "id": 2,
        "text": "Sertoli cell tumor"
      },
      {
        "id": 3,
        "text": "Yolk-sac tumor"
      },
      {
        "id": 4,
        "text": "Seminoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario with the biopsy findings points towards the <strong>diagnosis</strong> of a <strong>Leydig cell tumor.</strong></p>\n<p>Development of a <strong>painless testicular mass</strong> in a child with a history of <strong>Kleinfelter's</strong> syndrome and <strong>precocious puberty</strong> is suggestive of an androgen-secreting tumor\u00a0like <strong>Leydig cell tumor.</strong> The biopsy shows large polygonal cells with a round to oval nucleus and deeply acidophilic with granular cytoplasm. The cytoplasm also shows <strong>rod-shaped crystals</strong> referred to as <strong>\"crystalloids of Reinke\"</strong>\u00a0which confirms the diagnosis.</p>\n<p><strong>Leydig cell</strong> tumors are <strong>sex-cord stromal cell</strong> tumors of the testis. They predominantly <strong>secrete androgens</strong> and in some cases estrogen and corticosteroids as well. The most common presenting features in prepubertal children are painless testicular swelling and precocious puberty. Leydig-cell tumors are associated with:</p>\n<ul>\n<li><strong>Kleinfelter's syndrome</strong></li>\n<li>Cryptorchidism</li>\n<li>Hereditary leiomyomatosis</li>\n<li>Renal cell carcinoma syndrome caused by germline mutations in the enzyme fumarate hydratase.</li>\n</ul>\n<p>It appears as a homogenous golden-brown tumor, that is usually less than 5cm. On microscopy, round or polygonal cells with a round to oval nucleus and deeply acidophilic with granular cytoplasm are seen. In about 25% of the patients, the cytoplasm contains\u00a0crystalloids of Reinke as shown below:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d4d33f45a9364f9493b7c2f35daaba6a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f5319c981314337b6820d454efbb6bbx1280x1065.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dbcffb3d6905414d93ff73a276a30506x510x409.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b0f8f4eb75874f33a2350d137d983e6ax1280x948.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8db48763b9094bd58b36c4d8615ccb08x800x533.JPEG"
    ]
  },
  {
    "text": "The image given below shows an H&E-stained section of a lung tumor. The immunohistochemical studies of this tumor are most likely to express which of the following tumor markers?",
    "choices": [
      {
        "id": 1,
        "text": "Alpha-fetoprotein"
      },
      {
        "id": 2,
        "text": "Calretinin"
      },
      {
        "id": 3,
        "text": "Carcinoembryonic antigen"
      },
      {
        "id": 4,
        "text": "Cytokeratins"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above H&amp;E stained histopathological image of a lung tumor shows <strong>keratin pearls</strong> suggestive of <strong>squamous</strong> <strong>cell</strong> <strong>carcinoma</strong>. <strong>Cytokeratins</strong> are the tumor markers that are most likely to be expressed.</p>\n<p>Cytokeratins are the intermediate filaments expressed by <strong>epithelial</strong> <strong>cells</strong>. The presence of cytokeratins on immunohistochemistry suggests a carcinoma of epithelial origin. Tumors of <strong>epithelial origin</strong> include <strong>squamous cell carcinoma</strong>, basal cell carcinoma, malignant melanoma etc.</p>\n<p>Squamous cell carcinoma of the lung is commonly seen in men and has an increased risk with smoking. The tumor appears like a cauliflower-like mass that is gray-white, firm to hard, and bulky with hemorrhage or necrosis.&nbsp;Histopathological features include keratinization in the form of <strong>squamous pearls. </strong>The cells have eosinophilic cytoplasm.</p>\n<p>Other options:</p>\n<p>Option A:<strong> Alpha-fetoprotein</strong> is a marker for <strong>hepatocellular carcinoma</strong> and<strong> non-seminomatous germ cell tumors</strong> of the testis.&nbsp;</p>\n<p>Option B: <strong>Calretinin</strong> serves as a marker for <strong>mesothelioma.</strong></p>\n<p>Option C:<strong> Carcinoembryonic</strong> <strong>antigen</strong> (CEA) is a marker for <strong>colon</strong> carcinoma and other malignancies including the&nbsp;<strong>pancreas, stomach</strong>, and <strong>heart.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e539f02914254a399461c5a6f685ca8e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old man with congestive cardiac failure develops difficulty in breathing. A section of his lung tissue is shown below. What are the cells indicated in the image?",
    "choices": [
      {
        "id": 1,
        "text": "Neutrophils"
      },
      {
        "id": 2,
        "text": "Siderophages"
      },
      {
        "id": 3,
        "text": "Type I pneumocytes"
      },
      {
        "id": 4,
        "text": "Lymphocytes"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows heart failure cells and the clinical scenario describes pulmonary edema due to heart failure. Heart failure cells&nbsp;are <strong>siderophages (hemosiderin-containing macrophages) </strong>seen<strong>&nbsp;</strong>in the alveoli of patients with chronic pulmonary edema&nbsp;due to left heart failure.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7f1fdcefa533444fb97d7a3fa2e19074.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e02de160f9294925a4d9e2623458bb30x1280x1856.JPEG"
    ]
  },
  {
    "text": "The tumor cells as shown in the image are seen in:",
    "choices": [
      {
        "id": 1,
        "text": "Mantle cell lymphoma"
      },
      {
        "id": 2,
        "text": "Peripheral T cell lymphoma"
      },
      {
        "id": 3,
        "text": "Anaplastic large cell lymphoma"
      },
      {
        "id": 4,
        "text": "Adult T cell leukemia/lymphoma"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The cells shown in the slide are <strong>cloverleaf or flower cells</strong>\u00a0with\u00a0<strong>multilobulated nuclei </strong>that<strong>\u00a0</strong>are frequently observed in <strong>adult T-cell leukemia/lymphoma.</strong></p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p><strong>Adult T-cell leukemia/ lymphoma</strong>\u00a0occurs in adults infected by human T-cell leukemia retrovirus type 1 (<strong>HTLV-1</strong>). It is a neoplasm of CD4+ cells and is a\u00a0<strong>rapidly progressive</strong>\u00a0disease that is fatal within months to 1 year.</p>\n<p>Common findings include skin lesions, generalized lymphadenopathy, hepatosplenomegaly and hypercalcemia.</p>\n<p>Peripheral smear blood shows characteristic\u00a0<strong>cloverleaf cells</strong>\u00a0or\u00a0<strong>flower cells\u00a0</strong>which\u00a0are tumour cells with\u00a0<strong>multilobulated nuclei</strong>. Lymphocytosis is also observed.</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b6e5d4e871274d8e8db5e131e0e41331.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/415b63b971544091bffd42206ad10f4ex720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9bdff1d318f645d5afaeb6052050d6fcx1280x1024.JPEG"
    ]
  },
  {
    "text": "Perl's Prussian blue staining of the bone marrow aspirate of a patient reveals the following. Which of the following is used in the treatment of his anemia?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin B12"
      },
      {
        "id": 2,
        "text": "Vitamin B6"
      },
      {
        "id": 3,
        "text": "Vitamin B1"
      },
      {
        "id": 4,
        "text": "Iron"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows a <strong>ringed sideroblast</strong>.\u00a0<strong>Vitamin B6 </strong>(Pyridoxine) is used in the treatment of <strong>sideroblastic anaemia</strong>.</p>\n<p><strong>Pyridoxine 100 - 200 mg per day for 2-3 months</strong> is administered routinely to all cases of sideroblastic anaemia. Blood transfusion and other supportive therapy are also indicated. In cases of secondary sideroblastic anaemia, the primary focus is the <strong>removal of the offending agent</strong>. However, <strong>no definitive treatment</strong> is available for hereditary and idiopathic types of sideroblastic anaemia.</p>\n<p>Sideroblasts are <strong>nucleated red cells </strong>(normoblasts) containing siderotic granules which stain positively with <strong>Prussian blue stain</strong>. Based on aetiology, sideroblastic anaemia is classified into <strong>hereditary</strong> and <strong>acquired</strong> types.</p>\n<p>Hereditary sideroblastic anaemia is an\u00a0<strong>X-linked</strong> disorder caused due to a defect in the activity of <strong>aminolevulinic acid (ALA) synthetase</strong> required for heme synthesis. Affected females act as carriers while males have moderate to marked anaemia and manifest in <strong>childhood</strong> or during <strong>early adulthood</strong></p>\n<p>Acquired sideroblastic anaemia:</p>\n<p>I) <strong>Primary acquired:</strong></p>\n<ul>\n<li>Also called\u00a0<strong>idiopathic</strong> or <strong>refractory</strong> acquired sideroblastic anaemia</li>\n<li>Occurs in <strong>middle-aged</strong> and <strong>older individuals</strong> of both sexes</li>\n<li>Due to the reduced activity of the <strong>enzyme ALA synthetase</strong>, there is disturbed growth and maturation of the erythroid precursors at the level of hematopoietic stem cell</li>\n<li><strong>Moderate to severe anaemia</strong>, which appears insidiously</li>\n<li><strong>Neutropenia</strong> and <strong>thrombocytopenia</strong> may also be seen</li>\n<li>Regarded as a <strong>myelodysplastic disorder </strong>in the FAB classification and thus considered <strong>preleukaemic</strong></li>\n</ul>\n<p>II) <strong>Secondary acquired:</strong></p>\n<p>May appear secondary to\u00a0</p>\n<ul>\n<li style=\"text-align: left;\"><strong>Drugs, chemicals and toxins</strong>: Isoniazid, Cycloserine, Chloramphenicol, Cyclophosphamide, Alcohol, Lead, etc.,</li>\n<li><strong>Haematological disorders:</strong> myelofibrosis, polycythemia vera, acute leukaemia, myeloma, lymphoma and hemolytic anaemia.</li>\n<li><strong>Miscellaneous</strong>: Carcinoma, myxoedema, rheumatoid arthritis and SLE.</li>\n</ul>\n<p><strong>Laboratory findings:</strong></p>\n<ul>\n<li>Peripheral smear: <strong>Hypochromic</strong>, <strong>microcytic</strong> (sometimes normocytic) anaemia</li>\n<li>Absolute values: <strong>MCV, MCH </strong>and<strong> MCHC are reduced</strong> except in acquired type, where MCV is raised.</li>\n<li>Bone marrow: <strong>Erythroid hyperplasia</strong> with macronormoblastic erythropoiesis. Marrow iron stores are raised. Pathognomonic <strong>ring sideroblasts</strong> are present.</li>\n<li>Serum ferritin: <strong>Raised</strong></li>\n<li>Serum iron: <strong>Raised</strong></li>\n<li>TIBC: <strong>Normal</strong></li>\n<li>Haemoglobin electrophoresis: <strong>Normal</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cf2aba6429074b44aa035bd16c13311d.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient presents with anemia, weight loss, and fever. A peripheral blood smear was done, and the findings are shown below. Which among the following will indicate a poor prognosis?",
    "choices": [
      {
        "id": 1,
        "text": "Hyperdiploidy"
      },
      {
        "id": 2,
        "text": "t(9;22), t(4;11)"
      },
      {
        "id": 3,
        "text": "Age at presentation is 2-8 years"
      },
      {
        "id": 4,
        "text": "Total leukocyte count <50000"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 601\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The given clinical scenario and peripheral smear showing lymphoblasts with condensed nuclear chromatin, small nucleoli, and scant agranular cytoplasm are suggestive of <strong>acute lymphoblastic leukemia/lymphoma</strong> (ALL). Among the given options, <strong>translocations t(9,22) </strong>and<strong>&nbsp;t(4;11) </strong>are indicators of a&nbsp;poor prognosis in ALL.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d915cba20b1d4c48a6e876aa6221c196.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The bodies shown in this image (highlighted) are seen in which of the following tumors?",
    "choices": [
      {
        "id": 1,
        "text": "Granulosa cell tumour"
      },
      {
        "id": 2,
        "text": "Dysgerminoma"
      },
      {
        "id": 3,
        "text": "Krukenberg tumor"
      },
      {
        "id": 4,
        "text": "Yolk sac tumour"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows <strong>Call exner bodies</strong> which are seen in <strong>Granulosa cell tumour</strong>.</p>\n<p><strong>Granulosa cell tumours&nbsp;</strong>arise from granulosa cells which form part of the developing ovarian follicle. They are unilateral in nature and the mass is cystic and encapsulated.&nbsp;<strong>Call-Exner bodies&nbsp;</strong>are seen in&nbsp;granulosa cell tumours<strong>.&nbsp;</strong>These are gland like small structures with&nbsp;<strong>acidophilic material</strong>&nbsp;and&nbsp;<strong>immature follicles</strong>.</p>\n<p>Mutations of the <strong>FOXL2 </strong>gene&nbsp;is seen in 97% of adult granulosa cell tumors.</p>\n<p>Elevated tissue and serum levels of <strong>inhibin</strong>, a product of granulosa cells, are associated with granulosa cell tumors. It is used in monitoring patients being treated.</p>\n<p>Other options -</p>\n<p>Option B:&nbsp;<strong>Dysgerminoma&nbsp;</strong>is the ovarian counterpart of&nbsp;<strong>seminoma</strong>. They are unilateral tumors composed of vesicular cells and clear cytoplasm. The tumor cells grow in cords or sheets that are separated by scanty fibrous stroma. They are usually infiltrated by lymphocytes. The image below shows the histopathology of a dysgerminoma</p>\n<p><img src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/2d6cc0c1c2564531945ff59d27a24c9dx1280x853.JPEG\" width=\"345\" height=\"230\" /></p>\n<p>Option C:&nbsp;<strong>Krukenberg tumor</strong>&nbsp;is the carcinoma of the stomach that metastasize to the ovary. It is characterized by&nbsp;mucin-producing&nbsp;<strong>signet ring cells</strong>. The appearance of a signet ring often originates from the gastric mucosa.&nbsp;</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>The image below shows signet-ring cells in the Krukenberg tumor.</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/e216464caea84e0fbc258433c5eaaa76x800x600.JPEG\" width=\"323\" height=\"242\" /></div>\n</div>\n</div>\n<p>Option D :&nbsp;A<strong>&nbsp;yolk sac tumor/endodermal sinus tumor</strong>&nbsp;is an aggressive&nbsp;<strong>malignant germ cell tumor</strong>&nbsp;of the ovaries. It<strong>&nbsp;</strong>originates from embryonal structures of the yolk sac by selective differentiation.&nbsp;</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Most of the yolk sac tumors have&nbsp;<strong>Schiller-Duval bodies</strong>&nbsp;and they are&nbsp;<strong>pathognomonic</strong>. These are glomerulus-like structures consisting of a central vessel surrounded by tumor cells within a space that is also lined by tumor cells.</p>\n<p>The image given below shows&nbsp;Schiller-Duval bodies seen in&nbsp;yolk sac tumors<strong>.</strong></p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/b3cd520f5bac400d84fd70001db66503x969x994.JPEG\" width=\"320\" height=\"328\" /></div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a89d8a189ecd4e65adc10c25906b8dee.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 9-year-old child is brought to the dermatology clinic with complaints of reddish-pink nodules on her back. The mother is worried about it being a tumour. A sample is sent for histopathological examination and the findings are shown below. Which variant of melanocytic nevus does this child have?",
    "choices": [
      {
        "id": 1,
        "text": "Spitz nevus"
      },
      {
        "id": 2,
        "text": "Halo nevus"
      },
      {
        "id": 3,
        "text": "Blue nevus"
      },
      {
        "id": 4,
        "text": "Dysplastic nevus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p class=\"p1\"><span class=\"s1\">The clinical vignette with histopathological findings showing <strong>large fusiform plump cells</strong> with <strong>blue-pink cytoplasm</strong> is highly suggestive of the&nbsp;<strong>Spitz nevus (spindle and epithelioid cell nevus)</strong> variant of melanocytic nevus.</span></p>\n<p class=\"p1\"><strong>Melanocytic nevi (moles)</strong> are common benign neoplasms caused by acquired activating mutations in components of the Ras signalling pathway.</p>\n<div class=\"page\" title=\"Page 1146\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Based on the location, it may be junctional nevi, intradermal nevi or compound nevi.</p>\n<div class=\"page\" title=\"Page 1147\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 1146\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Melanocytic nevi are thought to progress through a series of morphologic changes over time. Superficial nevus cells are larger, tend to produce melanin, and grow in nests. Deeper nevus cells are smaller, produce little or no pigment, and appear as cords and single cells. At the deepest extent of the lesions, these cells often acquire fusiform contours and grow in fascicles resembling neural tissue (neurotization).</p>\n<p><span class=\"s1\">Melanocytic nevi with <strong>neurotization </strong>indicate normal maturation change&nbsp;and help in differentiating&nbsp;<strong>benign nevi</strong> from melanomas (which lacks such features)</span></p>\n<p class=\"p1\"><span class=\"s1\">This morphological change in nevus cells occurs due to progressive loss of tyrosinase activity and acquisition of cholinesterase activity in deeper &ldquo;nervelike&rdquo; nevus cells.</span></p>\n<p class=\"p1\">&nbsp;</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7a0a4d1efae14d2db4119b2f099572b0.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The autopsy of a 1-year-old child who died of congestive cardiac failure revealed multiple tumors of the heart located in the ventricles. What is the characteristic histopathologic finding shown in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Stellate cells"
      },
      {
        "id": 2,
        "text": "Anitschkow cells"
      },
      {
        "id": 3,
        "text": "Spider cells"
      },
      {
        "id": 4,
        "text": "Kulchitsky cells"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given scenario and histological slide showing<strong>&nbsp;spider cells</strong>&nbsp;are suggestive of <strong>cardiac rhabdomyoma</strong>.</p>\n<p>Microscopically, cardiac rhabdomyomas are composed of <strong>bizarre, markedly enlarged myocytes</strong>. Histologic processing of the sample usually removes the glycogen and artifactually reduces the cytoplasm to thin strands. These strands stretch from the nucleus to the surface membrane. This gives an appearance that&nbsp;resembles a spider and is hence referred to as <strong>spider cells.</strong></p>\n<p>Rhabdomyomas are&nbsp;mostly seen in the first year of life. They are&nbsp;discovered when there is an obstruction to a valvular orifice or cardiac chamber. Approximately half the cardiac rhabdomyomas are due to <strong>sporadic</strong> mutations. The other<strong>&nbsp;</strong>50% of cases are associated with <strong>tuberous sclerosis.&nbsp;</strong>They are&nbsp;usually<strong> multiple</strong> and appear in<strong> ventricles preferentially.&nbsp;</strong>They often&nbsp;<strong>regress spontaneously</strong> and may,&nbsp;therefore, be considered as <strong>hamartomas&nbsp;</strong>and not true neoplasms.</p>\n<p>The image below shows histopathological findings of cardiac rhabdomyoma with spider cells.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/89cca6ec9efb4c40a13b63f5b508203c.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/86256f14a51246398133d170b9f34989x1280x1118.JPEG"
    ]
  },
  {
    "text": "A 60-year-old man presented with breathlessness, facial flushing, dull aching abdominal pain, and diarrhea. CT abdomen shows a mass in the terminal ileum. The histological image of the resected specimen given below is positive for synaptophysin. What is the characteristic histopathological finding seen?",
    "choices": [
      {
        "id": 1,
        "text": "Keratin pearls"
      },
      {
        "id": 2,
        "text": "Lepidic pattern"
      },
      {
        "id": 3,
        "text": "Salt and pepper chromatin"
      },
      {
        "id": 4,
        "text": "Epitheloid cells"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\"><span class=\"s1\">The given history and histological specimen positive for synaptophysin are suggestive of <strong>carcinoid syndrome. </strong>The characteristic histopathology finding is<strong>&nbsp;salt and pepper chromatin. </strong></span></p>\n<p class=\"p1\"><span class=\"s1\">Carcinoid syndrome is a systemic disorder characterised by diarrhea, skin rashes, bronchospasm, tumors in the gastrointestinal tract, flushing and cyanosis. In some cases, the tumors can be present as cardiac lesions or bronchial tumor. The pathogenesis is mediated by components like <strong>serotonin</strong> (5-hydroxytryptamine), <strong>bradykinin, tachykinin, histamine</strong> and <strong>prostaglandins</strong>. <strong>Ki67</strong> <strong>index</strong> is used to analyse the <strong>prognosis</strong> of the condition. The tumors arise from&nbsp;</span><strong>Kulchitsky</strong> cells. <span class=\"s1\">Carcinoid tumors most commonly occur in the gastrointestinal tract.&nbsp;The most common sites in decreasing order of frequency are the&nbsp;appendix, ileum,&nbsp;and rectum.</span></p>\n<p class=\"p1\">Histology of carcinoids typically reveals islands and nests of uniform cells with scant, pink granular cytoplasm and&nbsp;salt and pepper chromatin.&nbsp;Electron microscopy reveals cytoplasmic dense-core&nbsp;<strong>neurosecretory granules</strong>.</p>\n<p class=\"p1\"><span class=\"s1\">Immunohistochemical (<strong>IHC</strong>) <strong>markers</strong> for carcinoid tumors are:</span></p>\n<ul>\n<li><span class=\"s1\">Neuron-specific enolase</span></li>\n<li><span class=\"s1\">Synaptophysin</span></li>\n<li><span class=\"s1\">Chromogranin A</span></li>\n</ul>\n<p><span class=\"s1\">Other options:</span></p>\n<p><span class=\"s1\">Option A: <strong>Squamous cell carcinoma</strong> is characterized by the presence of <strong>keratin pearls</strong>&nbsp;and intercellular bridges.</span></p>\n<p><span class=\"s1\">Option B: <strong>Adenocarcinoma</strong> shows a <strong>lepidic pattern</strong>&nbsp;of spread with tumor cells crawling along the normal-appearing alveolar septa.</span></p>\n<p><span class=\"s1\">Option D: <strong>GIST</strong> has elongated&nbsp;<strong>spindle cells</strong>&nbsp;or plumper&nbsp;<strong>epithelioid cells</strong>, or a mixed pattern.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6d8cba40691c48d7aa955a3c79cc6045.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c3b230c45a5a44d4b6baacb83e06f8d8x1280x1026.JPEG"
    ]
  },
  {
    "text": "An 18-year-old boy comes to the clinic with pain and swelling in his right chest for 2 months. The pain progressively worsens day by day and it is worse at night and disturbs his sleep. Further examination reveals a mass that is biopsied and shown below. Mutations in CDKN2A are present in this patient. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Osteoclastoma"
      },
      {
        "id": 2,
        "text": "Chondrosarcoma"
      },
      {
        "id": 3,
        "text": "Enchondroma"
      },
      {
        "id": 4,
        "text": "Ewing's tumour"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><span data-preserver-spaces=\"true\">The given clinical vignette describes a case of\u00a0</span><strong><span data-preserver-spaces=\"true\">chondrosarcoma.</span></strong><span data-preserver-spaces=\"true\">\u00a0The histopathological image shown has sheets of malignant chondrocytes that have abundant cytoplasm with the intralesional bone formation which is characteristic of the\u00a0</span><strong><span data-preserver-spaces=\"true\">clear cell subtype</span></strong><span data-preserver-spaces=\"true\">\u00a0of this bone tumor</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Chondrosarcoma</span></strong><span data-preserver-spaces=\"true\">\u00a0are <strong>malignant tumors</strong> that produce <strong>cartilage</strong>.\u00a0</span><span data-preserver-spaces=\"true\">They are subclassified histologically as</span><span data-preserver-spaces=\"true\"> conventional (hyaline cartilage producing), clear cell, dedifferentiated, and mesenchymal variants.</span></p>\n<p><span data-preserver-spaces=\"true\">Conventional central tumors constitute 90% of chondrosarcoma.\u00a0</span><span data-preserver-spaces=\"true\">Individuals with chondrosarcoma are usually in their 40s or older.\u00a0</span><span data-preserver-spaces=\"true\">The clear cell and especially the mesenchymal variants occur in younger patients, in their teens or 20s.</span></p>\n<p><span data-preserver-spaces=\"true\">Chondrosarcomas commonly arise in the <strong>axial skeleton, especially the pelvis, shoulder, and ribs</strong>.\u00a0</span><span data-preserver-spaces=\"true\">A slow-growing, low-grade tumor causes reactive thickening of the cortex but a more aggressive neoplasm destroys the cortex and forms a soft tissue mass.\u00a0</span><span data-preserver-spaces=\"true\">About 15% of these tumors are secondary, arising from preexisting enchondromas and osteosarcoma.</span></p>\n<p><span data-preserver-spaces=\"true\">Chondrosarcomas arising in multiple osteochondroma syndromes carry mutations in the EXT genes and sporadic cases have mutations in <strong>IDH1</strong> and <strong>IDH2</strong>. Silencing of the <strong>CDKN2A tumor suppressor gene</strong> is seen in these cases.</span></p>\n<p><span data-preserver-spaces=\"true\">Histopathology:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">They are large bulky tumors made up of nodules of glistening gray-white, translucent cartilage. The matrix is often gelatinous or myxoid. Spotty calcifications are present and central necrosis may create cystic spaces.</span></li>\n<li><span data-preserver-spaces=\"true\">The cartilage infiltrates the marrow space and surrounds pre-existing bony trabeculae. The tumors have three grades based on cellularity, cytological atypia, and the mitotic activity</span></li>\n<li><span data-preserver-spaces=\"true\"><strong>Clear cell chondrosarcoma</strong> has sheets of <strong>large, malignant chondrocytes</strong> that have<strong> clear cytoplasm</strong>, numerous osteoclast-type giant cells, and intralesional reactive bone formation. </span></li>\n<li><span data-preserver-spaces=\"true\"><strong>Mesenchymal chondrosarcoma</strong> is composed of <strong>islands</strong> of well-differentiated hyaline cartilage surrounded by <strong>small cells</strong> that <strong>mimic Ewing's sarcoma</strong>.</span></li>\n</ul>\n<p><span data-preserver-spaces=\"true\">The image below shows the histopathology of chondrosarcoma with the red arrow showing the large malignant cells with prominent nuclei and the black arrow pointing to the intralesional bone formation.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7cf768f8d2554fe59ee4d9ebcdc6dde7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/05c4258297cd49b68663f6d09b7c1011x684x511.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3229eb57b3394f5cb46ca5d19db65a6cx1280x853.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1fccf3ee92fd4ec78bef0bdcc7134103x1200x864.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0d11fbe898b145e0a4f569ceb74266b6x1280x853.JPEG"
    ]
  },
  {
    "text": "A patient presented with a painless, well-circumscribed swelling near the wrist joint. There are no skin changes or neurological involvement. Histopathological examination of the swelling revealed spindle cells with palisading of the nuclei as shown in the image below. Which of the following is seen in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Verocay bodies"
      },
      {
        "id": 2,
        "text": "Ferruginous bodies"
      },
      {
        "id": 3,
        "text": "Miyagawa bodies"
      },
      {
        "id": 4,
        "text": "Councilman bodies"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span data-preserver-spaces=\"true\">The given clinical scenario of a painless, well-circumscribed swelling near the wrist joint along with the nuclear-free zones between nuclear palisading observed in the given image is suggestive of <strong>schwannoma.\u00a0Verocay bodies\u00a0</strong>are seen in this condition.</span></p>\n<p>Schwannomas<span data-preserver-spaces=\"true\">\u00a0are benign tumors that may arise directly from peripheral nerves and\u00a0exhibit Schwann cell differentiation.</span><span data-preserver-spaces=\"true\">\u00a0They are commonly associated with mutations in the</span><strong><span data-preserver-spaces=\"true\">\u00a0NF2 gene</span></strong><span data-preserver-spaces=\"true\">\u00a0on chromosome 22. This results in the loss of expression of <strong>Merlin</strong>, the NF2 gene product.\u00a0</span></p>\n<p><span data-preserver-spaces=\"true\">Schwannomas are <strong>simple to excise</strong> surgically as they are\u00a0<strong>well-circumscribed, encapsulated masses</strong> that are loosely attached to<strong>\u00a0</strong>the associated nerve but do not invade it. Grossly, they appear as <strong>firm gray masses.\u00a0</strong></span></p>\n<p><span data-preserver-spaces=\"true\">Microscopically, it consists of dense areas called\u00a0</span><strong><span data-preserver-spaces=\"true\">Antoni A area</span></strong><span data-preserver-spaces=\"true\">, and loose areas called\u00a0</span><strong><span data-preserver-spaces=\"true\">Antoni B area.</span></strong></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">The dense eosinophilic Antoni A areas contain\u00a0</span><strong><span data-preserver-spaces=\"true\">spindle cells</span></strong><span data-preserver-spaces=\"true\">\u00a0that are arranged into cellular intersecting fascicles.\u00a0</span><strong><span data-preserver-spaces=\"true\">Palisading of nuclei</span></strong><span data-preserver-spaces=\"true\">\u00a0is seen, with the <strong>nuclear-free zones</strong> between them, called\u00a0</span><strong><span data-preserver-spaces=\"true\">Verocay</span></strong><span data-preserver-spaces=\"true\">\u00a0</span><strong><span data-preserver-spaces=\"true\">bodies</span></strong><span data-preserver-spaces=\"true\">.</span></li>\n<li><span data-preserver-spaces=\"true\">The Antoni B areas contain <strong>spindle-shaped cells</strong> that are <strong>loosely arranged </strong>and separated by<strong>\u00a0a prominent myxoid extracellular matrix.</strong></span></li>\n</ul>\n<p>The symptoms associated with schwannoma arise due to\u00a0local compression of the involved nerve or adjacent structures. Surgical removal is curative. If incompletely excised, the schwannomas can recur locally, but a malignant transformation is extremely rare.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d509e2e9d1f148f79940aaa73515bbef.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/83ad02c0b0c7410d9ce80b29828e1938x800x533.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e73d5b40f18f43e398de87e87400afeax800x593.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/789dab3816104b15b19c2e2745fe50bfx1279x1588.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8efce8e202d347cdbcdaa414b564361dx534x408.JPEG"
    ]
  },
  {
    "text": "A man presented with fatigue and a mass in the left upper abdomen. On examination, there was massive splenomegaly with no lymphadenopathy. Investigations revealed pancytopenia. His peripheral blood smear is given below. Immunohistochemistry revealed tumor cells to be positive for annexin A1, CD22, CD25, and CD103. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Primary myelofibrosis"
      },
      {
        "id": 2,
        "text": "Hairy cell leukemia"
      },
      {
        "id": 3,
        "text": "Multiple myeloma"
      },
      {
        "id": 4,
        "text": "Mantle cell lymphomas"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario along with the image shows <strong>hairy cells</strong> i.e. abnormal B cells having round nuclei and pale blue cytoplasm with thread-like extensions. So the likely diagnosis is <strong>hairy cell leukemia</strong>.&nbsp;</p>\n<p>Hairy cell leukaemia is a rare type of B-cell tumour involving <strong>small lymphocytes</strong>. The specific activating <strong>point mutation</strong> is in the serine/ threonine kinase&nbsp;<strong>BRAFV600E</strong>.</p>\n<p>Symptoms occur due to infiltration of bone marrow, liver and spleen.&nbsp;<strong>Clinical features</strong> include:</p>\n<ul>\n<li><strong>Massive splenomegaly </strong>and hepatomegaly. Lymphadenopathy is rare</li>\n<li><strong>Pancytopenia</strong>&nbsp;- due to marrow involvement can also be seen</li>\n<li><strong>Monocytopenia</strong>&nbsp;-<strong>&nbsp;</strong>leads to <strong>increased&nbsp;</strong>incidence of&nbsp;<strong>atypical mycobacterial infections</strong></li>\n</ul>\n<p>Routine peripheral smear shows <strong>hairy cells</strong> (abnormal B cells) having<strong> round, oblong </strong>or<strong> reniform nuclei </strong>and <strong>pale blue cytoplasm </strong>with thread-like<strong> extensions</strong> as shown below.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e64075adadb143d68845152048c64ccb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d06990d003674513b0c20e51da2a71d6x800x599.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/71cc2c9e0dd3438eb2fde12948adb2bfx1280x853.JPEG"
    ]
  },
  {
    "text": "An autopsy was done on a patient who died from a neurodegenerative disease. The pathological specimen from his brain is shown below. What does the structure marked in the image comprise?",
    "choices": [
      {
        "id": 1,
        "text": "Tau protein"
      },
      {
        "id": 2,
        "text": "Amyloid plaques"
      },
      {
        "id": 3,
        "text": "Alpha-synuclein"
      },
      {
        "id": 4,
        "text": "Prion protein"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image is a histological sample showing neurons with a <strong>Lewy body.&nbsp;</strong><span class=\"notion-enable-hover\" data-token-index=\"0\" data-reactroot=\"\">Lewy bodies</span>&nbsp;are aggregates of insoluble fibrillar proteins called&nbsp;<span class=\"notion-enable-hover\" data-token-index=\"2\" data-reactroot=\"\"><strong>alpha-synuclein</strong>&nbsp;(specific)</span>&nbsp;and <strong>ubiquitin</strong> in the neural cells.&nbsp;These are eosinophilic intracytoplasmic inclusion bodies that stain positive with <strong>periodic acid-Schiff.&nbsp;</strong>They are typically seen in Parkinson's disease, Lewy body dementia, and a few variants of Alzheimer's disease.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Tau protein</strong> is seen in&nbsp;<strong>Alzheimer&rsquo;s disease</strong>&nbsp;and the below image shows&nbsp;<strong>neurofibrillary tangles</strong>&nbsp;inside the neuron.</p>\n<div class=\"page\" title=\"Page 1295\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><img src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/e2431742a8824843ab5f60507f46da33x1280x945.JPEG\" width=\"264\" height=\"195\" /></p>\n<p>Option B:&nbsp;<strong>Amyloid plaques</strong>&nbsp;are made of&nbsp;<strong>beta-amyloid precursor protein&nbsp;</strong>(APP). They are deposited around the neurons. Amyloid plaque is shown in the image below:</p>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/f1df345d47814d16afa92b7e82d3d0edx700x527.JPEG\" width=\"270\" height=\"203\" /></div>\n<div class=\"h-400-scroll mb-2 ng-star-inserted\">&nbsp;</div>\n<div class=\"h-400-scroll mb-2 ng-star-inserted\">Option D:&nbsp;<strong>Prion proteins</strong>&nbsp;deposit in the neurons and cause apoptosis. The degeneration of these&nbsp;neurons leads to&nbsp;<strong>spongiform encephalopathy</strong>. The protein gets deposited as plaques. The image given below shows the spongiform appearance of the brain seen in prion disease.\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/e26bb4efad0b4c1e91bb41ea67f87f06x600x600.JPEG\" width=\"267\" height=\"267\" /></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8078df47cbae400dbdc3be8532af59fe.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old female presented to the OPD with an asymmetrical nevus with irregular margins and variegated colour on her arm. Recently, the nevus had become pruritic. The histopathological examination of the lesion is shown below. Which stain would have been used on the biopsy specimen in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Van Gieson stain"
      },
      {
        "id": 2,
        "text": "Mucicarmine stain"
      },
      {
        "id": 3,
        "text": "Masson Fontana stain"
      },
      {
        "id": 4,
        "text": "Masson trichrome stain"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical features suggest a diagnosis of\u00a0<strong>melanocytic nevus.</strong> In the histopathological examination, the\u00a0<strong>Masson Fontana</strong> stain is used which is used for detecting <strong>melanin</strong> (seen as a dark or black pigmented area) as shown in the above image.</p>\n<p><strong>Stains used for melanin:</strong></p>\n<p><strong>Masson Fontana silver stain</strong>: The ammoniacal silver stains melanin black.\u00a0It is also used to stain argentaffin granules, which are normally present in endocrine cells in duodenal mucosa and pathologically seen in carcinoid syndromes.</p>\n<p><strong>Melanin:</strong></p>\n<ul>\n<li>In general, melanin is considered as the only endogenous brown-black pigment present in the hair, skin, retina, iris, and certain parts of the central nervous system (as neuromelanin). Pathologically, it may be found in skin tumors like melanomas.</li>\n<li>However, another black-colored endogenous pigment called <strong>homogentisic</strong> <strong>acid</strong> may be seen in <strong>alkaptonuria</strong>, where the pigment is deposited in the skin, connective tissue, and cartilage; this pigmentation is known as <strong>ochronosis</strong>.</li>\n</ul>\n<p><strong>DOPA-oxidase method:\u00a0</strong>It is the\u00a0<strong>most specific method\u00a0</strong>for staining melanin. The stain works on the principle that the DOPA substrate is acted upon by DOPA-oxidase in the melanin-producing cells which produce a brownish-black deposit.\u00a0<br /><br /><strong>Schmorl\u2019s method</strong>: Stains melanin blue-green.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c120c438192446fd87b09914b2499204.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 15-year-old boy presents with low-grade fever, pain, and swelling over the right thigh. On examination, a mass was noted over the diaphysis of the femur. Cytogenetic analysis showed translocation (11:22). The histopathology image is given below. Identify the most likely X-ray feature of this condition:",
    "choices": [
      {
        "id": 1,
        "text": "Sunray appearance"
      },
      {
        "id": 2,
        "text": "Soap bubble appearance"
      },
      {
        "id": 3,
        "text": "Onion peel appearance"
      },
      {
        "id": 4,
        "text": "Mottled calcification"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario along with the histopathology image showing <strong>sheaths</strong> of <strong>small round cells</strong>\u00a0that are <strong>PAS-positive</strong> are suggestive of <strong>Ewing's sarcoma</strong>. <strong>Onion peel appearance</strong> is the most likely X-ray feature of this condition.</p>\n<p>Ewing's sarcoma is a <strong>highly</strong>\u00a0<strong>malignant tumor</strong> that occurs mainly in the <strong>age group</strong> between <strong>10-20 years</strong>. The most <strong>common site</strong>\u00a0is the <strong>diaphysis</strong> of <strong>long bones</strong>.\u00a0Karyotyping shows a <strong>translocation (11:22)</strong>.\u00a0</p>\n<p>The gross specimen shows a tumor <strong>involving</strong> the whole <strong>medullary</strong> <strong>cavity.\u00a0</strong>The bone gets expanded, the periosteum gets elevated and subperiosteal new bone formation occurs in layers.</p>\n<p><span class=\"s1\">Microscopically, <strong>solid sheaths</strong>\u00a0of <strong>small round cells</strong> with\u00a0<strong>PAS-positive</strong>\u00a0magenta pink colored cytoplasm are seen.\u00a0</span><span class=\"s1\">The cells<strong>\u00a0</strong>show PAS positivity due to the presence of large amounts of\u00a0<strong>cytoplasmic glycogen</strong>.\u00a0</span><span class=\"s1\">This is an important feature for the differential diagnosis of Ewing's with other small round cell tumors.\u00a0</span></p>\n<p>The clinical features include <strong>persistent pain</strong>, <strong>swelling</strong> over the area and <strong>fever</strong>. On<strong> X-ray</strong>, a <strong>lytic lesion</strong> in the medullary area on the diaphysis of long bones will be seen. It also shows cortical destruction along with new bone formation. This is called <strong>onion peel appearance</strong>.\u00a0</p>\n<p>It is a highly <strong>radiosensitive tumor</strong>. Radiotherapy for control of local tumor and chemotherapy with vincristine, cyclophosphamide, and adriamycin is considered.</p>\n<p>Other options:\u00a0</p>\n<p>Option A:\u00a0<strong>Sunray appearance</strong> is seen in <strong>osteosarcoma</strong>. It occurs predominantly in the age group of 15- 25 years. The common sites are the <strong>metaphysis</strong> of the lower end of the <strong>femur</strong> and the upper end of the <strong>tibia</strong>.</p>\n<p>Option C:\u00a0<strong>Soap bubble appearance</strong> is seen in <strong>osteoclastoma</strong>. It occurs predominantly in the age group of 20-40 years. The common sites are <strong>epiphysis</strong> of the lower end of the <strong>femur</strong>, the upper end of the<strong> tibia</strong>, lower end of the <strong>radius</strong>.</p>\n<p>Option D:\u00a0<strong>Mottled calcification</strong> is seen in <strong>chondrosarcoma</strong>.it occurs predominantly in the age group of 30 - 60 years. The common sites are anywhere in the <strong>flat bones</strong> and upper end of the <strong>femur</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d512e90f9c754d2da4252afa028ca018.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 9-year-old boy presented with complaints of swelling and pain in the left ankle and knee and fever for 3 days. He had a history of sore throat 3 weeks ago. Echocardiography showed the presence of mitral regurgitation. Histopathological findings are given below. Which of the following statements is false regarding the condition?",
    "choices": [
      {
        "id": 1,
        "text": "Small or medium-sized vegetations on either or both sides of the valve leaflets are seen"
      },
      {
        "id": 2,
        "text": "Condition can occur after group A streptococcal pharyngitis"
      },
      {
        "id": 3,
        "text": "Subendocardial irregular thickenings are called MacCallum plaques"
      },
      {
        "id": 4,
        "text": "Fibrinoid necrosis is seen in the lesion in the heart"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The lesion shown in the histopathological slide is <strong>Aschoff's body\u00a0</strong>and the most probable diagnosis is <strong>acute rheumatic fever.</strong><strong>\u00a0</strong>The rheumatic fever phase of rheumatic heart disease is marked by <strong>small, warty vegetations</strong> <strong>along the</strong> <strong>lines</strong> <strong>of closure</strong> of <strong>the</strong> <strong>valve leaflets</strong>.</p>\n<div class=\"page\" title=\"Page 565\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Rheumatic fever</strong> is an acute, immunologically mediated, multisystem inflammatory disease that classically occurs a <strong>few weeks</strong> after <strong>group A streptococcal pharyngitis. </strong>(Option B) Acute rheumatic carditis is a common manifestation of active rheumatic fever. It may progress over time to chronic <strong>rheumatic heart disease.</strong></p>\n</div>\n</div>\n</div>\n</div>\n<p><strong>Aschoff's bodies</strong>\u00a0are composed of foci of T lymphocytes, activated macrophages called <strong>Anitschkow cells</strong>, and\u00a0occasional plasma cells.\u00a0Anitschkow cells have abundant cytoplasm and central round-to-ovoid nuclei with chromatin that is centrally condensed into a slender, wavy ribbon.</p>\n<p>Inflammation of the endocardium and the left-sided valves typically results in <strong>fibrinoid necrosis</strong> within the cusps or tendinous cord. (Option D) Over these necrotic areas, small vegetations called <strong>verrucae</strong> develop along the lines of closure. Irregular thickenings present in the subendocardium are called <strong>MacCallum plaques.\u00a0</strong>(Option C)</p>\n<p>Some major manifestations of rheumatic fever are:</p>\n<ul>\n<li>Migratory polyarthritis of the large joints\u00a0</li>\n<li>Pancarditis (myocarditis, pericarditis, or endocarditis)</li>\n<li>Subcutaneous nodules (typically on extensor surfaces of extremities)</li>\n<li>Erythema marginatum, an irregular circinate skin rash\u00a0</li>\n<li>Sydenham chorea, a neurologic disorder with involuntary\u00a0rapid movements</li>\n</ul>\n<p>In chronic RHD, the mitral valve leaflet is thickened, with commissural fusion and shortening. There is thickening and fusion of the tendinous cords. This can lead to narrowing the mitral orifice, leading to a <strong>fish-mouth appearance (buttonhole)</strong>.</p>\n<p>Image showing button hole appearance is seen in mitral stenosis in case of rheumatic heart disease.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cc612952689d4c58b39e0e85fab116bd.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6031e6ed44f24170b9cdea19937062dax1280x925.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6fe4b58cde5642e99d945ade7d697924x1280x853.JPEG"
    ]
  }
];
        let quizName = 'Histopathology  Slides Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>