<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neet Mini - 21 (20 Q) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 55-year-old female patient presents with complaints of fatigue and severe itching throughout her body. Liver function test shows the following values. A liver biopsy is taken for histopathological examination which is given below. Which of the following is false about this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Mallory-Denk bodies are seen on histopathology"
      },
      {
        "id": 2,
        "text": "Serology is positive for anti-mitochondrial antibodies"
      },
      {
        "id": 3,
        "text": "It is associated with inflammatory bowel disease"
      },
      {
        "id": 4,
        "text": "Ursodeoxycholic acid slows progression in early disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical scenario showing a female patient with increased GGT and ALP and histopathology showing characteristic<strong> florid</strong> duct lesion is suggestive of <strong>primary biliary cirrhosis (PBC)</strong>\u00a0which is associated with Sjogren syndrome in &gt;70% of the cases and is not\u00a0associated with inflammatory bowel disease.</p>\n<p>She is said to suffer from PBC because of the following reasons</p>\n<ul>\n<li>PBC has a strong <strong>female</strong> preponderance and the median age is around <strong>50\u00a0</strong>years at the time of diagnosis</li>\n<li>They present with<strong> fatigue</strong> and intense <strong>pruritus</strong></li>\n<li>Amond the liver enzymes, <strong>GGT and ALP are significantly elevated</strong> with only mild elevation of AST and ALT enzymes</li>\n<li>90% of the patients will have <strong>anti-mitochondrial antibodies (AMA)</strong></li>\n<li>Liver biopsy shows a\u00a0<strong>florid duct lesion\u00a0</strong>(as given in the image), which is considered diagnostic. This is due to the\u00a0<strong>destruction</strong> of interlobular <strong>bile ducts</strong> with <strong>lymphoplasmacytic inflammation</strong> with or without granuloma formation.</li>\n</ul>\n<p>It is associated with feathery degeneration and ballooned, bile-stained hepatocytes with prominent <strong>Mallory-Denk bodies</strong> as seen in chronic duct obstruction.</p>\n<p>Early-stage disease is treated with <strong>oral ursodeoxycholic acid</strong> which greatly slows down progression. The mechanism of action is not entirely known but is related to it's ability to alter the biochemical composition of bile. It is not effective in late-stage disease and for these patients, liver transplantation is the best form of treatment.</p>\n<p>Associated conditions in PBC:</p>\n<ul>\n<li>Sjogren syndrome</li>\n<li>Hashimoto's thyroiditis</li>\n<li>CREST syndrome</li>\n<li>Rheumatoid arthritis</li>\n<li>Celiac disease</li>\n</ul>\n<p>Inflammatory bowel disorders (ulcerative colitis and Crohn's disease) is seen in patients with <strong>primary sclerosing cholangitis.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/64945e7e64b04d2da37cd2793c1071f1.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "During your internship, you notice the cylinder shown below, attached to an anesthetic machine present in the operation theater.  All of the following are the adverse effects of exposure to this inhalational agent, except _______.",
    "choices": [
      {
        "id": 1,
        "text": "Peripheral neuropathy"
      },
      {
        "id": 2,
        "text": "Iron-deficiency anemia"
      },
      {
        "id": 3,
        "text": "Bone marrow depression"
      },
      {
        "id": 4,
        "text": "Subacute myelinopathy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows a&nbsp;<strong>blue color cylinder</strong>,<strong>&nbsp;</strong>and these cylinders are used to store <strong>nitrous oxide</strong>.<strong>&nbsp;</strong>Iron-deficiency anemia is not a side effect of nitrous oxide.</p>\n<p><strong> Nitrous oxide</strong> inhibits vitamin B12-dependent enzymes like <strong>thymidylate synthase</strong>, which is necessary for DNA synthesis. This leads to&nbsp;<strong>megaloblastic bone marrow changes</strong>.</p>\n<p>Megaloblastic anemia is seen with nitrous oxide, especially when exposure is greater than 2&ndash;6 hours (in healthy patients prolonged periods of exposure &gt;12 hours are required whereas, in critically ill patients, much shorter periods of exposure can lead to megaloblastic changes in the bone marrow).</p>\n<p>Other<strong> side effects&nbsp;</strong>of nitrous oxide:</p>\n<ul>\n<li><strong>Bone marrow depression</strong></li>\n<li>Subacute combined degeneration of the cord (<strong>myelinopathy</strong>)</li>\n<li>Teratogenicity</li>\n<li><strong>Peripheral neuropathy</strong></li>\n</ul>\n<p><strong>Contraindications</strong> of nitrous oxide:</p>\n<ul>\n<li>Venous or arterial air embolism</li>\n<li>Pneumothorax</li>\n<li>Acute intestinal obstruction with bowel distention</li>\n<li>Intracranial air (pneumocephalus following dural closure or pneumoencephalography)</li>\n<li>Pulmonary air cysts</li>\n<li>Intraocular air bubbles</li>\n<li>Tympanic membrane grafting</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ef9c8d838e474e519a5c478c71f50a31.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Match the following nail changes in psoriasis with their corresponding images.",
    "choices": [
      {
        "id": 1,
        "text": "1-C, 2-D, 3-B, 4-A"
      },
      {
        "id": 2,
        "text": "1-A, 2-D, 3-B, 4-C"
      },
      {
        "id": 3,
        "text": "1-B, 2-C, 3-A, 4-D"
      },
      {
        "id": 4,
        "text": "1-C, 2-A, 3-D, 4-B"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The correct option matching the nail changes in psoriasis with the corresponding images is <strong>1-C</strong>,<strong> 2-A</strong>,<strong> 3-D</strong>,<strong> </strong>and<strong> 4-B</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3b214f46238a4bd08274cb1e9451c632.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f6128714b35341faa105a008a959f27cx1280x2068.JPEG"
    ]
  },
  {
    "text": "Identify the incorrect statement regarding glucose transporters:",
    "choices": [
      {
        "id": 1,
        "text": "GLUT2 is involved in transport of glucose out of enterocytes"
      },
      {
        "id": 2,
        "text": "SGLT1 is involved in absorption of glucose into the enterocytes"
      },
      {
        "id": 3,
        "text": "GLUT 4 is involved in the transport of fructose in the sperms"
      },
      {
        "id": 4,
        "text": "GLUT 2 acts as a beta cell glucose sensor in the islet cells"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The incorrect statement is option C.\u00a0</p>\n<p>The <strong>transport of fructose in sperms</strong> is carried out by <strong>GLUT 5</strong>, not\u00a0GLUT 4.<br /><br /><strong>GLUT-5</strong> is present in the small intestine, <strong>mature spermatids</strong>, kidneys, and brain.\u00a0It is exclusively involved in the <strong>transport of fructose,</strong> with no ability to transport glucose or galactose.\u00a0</p>\n<p><strong>GLUT 4\u00a0</strong>is involved in insulin-stimulated glucose uptake in skeletal, cardiac, and adipose tissue.\u00a0</p>\n<p>Other options:</p>\n<p>Options A and D: <strong>GLUT2</strong>\u00a0acts as a beta cell glucose sensor in the islet cells of the pancreas and is also involved in the transport of glucose from the enterocyte into the interstitium or out of the enterocytes.</p>\n<p>Option B: <strong>SGLT1</strong> is involved in the absorption of glucose into the enterocyte. SGLT2 is responsible for glucose transport out of the renal tubules.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A  newborn male baby was found to have a very small occiput and posterior fossa. MRI imaging showed the following finding. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Mega cisterna magna"
      },
      {
        "id": 2,
        "text": "Joubert syndrome"
      },
      {
        "id": 3,
        "text": "Dandy-Walker syndrome"
      },
      {
        "id": 4,
        "text": "Chiari malformation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical scenario of a baby with a <strong>very small occiput</strong> and <strong>posterior fossa</strong> and an image showing\u00a0<strong>herniation</strong> of the <strong>cerebellar tonsils</strong> through the <strong>foramen magnum</strong> is suggestive of\u00a0<strong>Chiari malformation</strong>. It is the\u00a0<strong>most common malformation</strong> of the posterior fossa and hindbrain.</p>\n<p>Children present with <strong>headaches that are worse with straining</strong> and other maneuvers that increase intracranial pressure. Symptoms of<br />brainstem compression, such as diplopia, oropharyngeal dysfunction, spasticity, tinnitus, <strong>sleep apnea</strong>, and vertigo, can occur due to brain stem compression. <strong>Incidental Chiari malformation</strong>\u00a0with radiological findings compatible with Chiari malformation with no clinical manifestations of the disease is also seen.\u00a0</p>\n<p>Chiari malformations are <strong>classified</strong> based on their morphology and severity of anatomic defects, typically through imaging or autopsy to <strong>Chiari I - Chiari IV</strong>. The <strong>Chiari I</strong> malformation is the<strong> most common</strong> type evaluated using magnetic resonance imaging (<strong>MRI</strong>), typically in a child or adult.<strong> Chiari II to IV</strong> malformations is often first evaluated by <strong>ultrasound</strong> in utero, with fetal MRI assessment performed for further characterization.</p>\n<p><strong>Muscle relaxants, NSAIDs</strong>, and the temporary use of a cervical collar are used to treat <strong>headaches\u00a0and neck pain</strong>.\u00a0 The <strong>main treatment</strong> for<strong> re-establishing the CSF flow</strong> across the craniovertebral junction and relieving pressure on the cerebellum and hindbrain by decompressing the posterior fossa in\u00a0Chiari malformation is <strong>surgical</strong>. This can be achieved by\u00a0a<strong> suboccipital craniectomy</strong> in conjunction with <strong>C1 and C2 laminectomy.</strong>\u00a0</p>\n<p>Other options:</p>\n<p>Option A- <strong>Mega cisterna magna/ Arachanoid cyst</strong> can also cause hydrocephalus. It\u00a0is characterized by an enlarged CSF space <strong>inferior </strong>and<strong> dorsal to the cerebellar vermis.\u00a0</strong>Persisting Blake pouch is a cyst that obstructs the subarachnoid space.\u00a0</p>\n<p>The image below shows a CT of an arachnoid cyst.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/14f6d2ef398e4133ab3d8aa82a6b0153.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/77f1cf52acfd4baf9321128adb8fd701x503x599.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d0055e1cff2b4dc9a57590c07b39c66bx110x127.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4f4f326adfc34c858633abeb90a71150x578x600.JPEG"
    ]
  },
  {
    "text": "Results of the quadruple screening test are tabulated below for three congenital anomalies. Choose the correctly matched set.",
    "choices": [
      {
        "id": 1,
        "text": "1- Trisomy 21; 2- Trisomy 18; 3- Neural tube defect"
      },
      {
        "id": 2,
        "text": "1- Trisomy 18; 2- Trisomy 21; 3- Neural tube defect"
      },
      {
        "id": 3,
        "text": "1- Trisomy 21; 2-  Neural tube defect; 3- Trisomy 18"
      },
      {
        "id": 4,
        "text": "1- Trisomy 18; 2- Trisomy 13; 3- Neural tube defect"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Quadruple testing is done in the <strong>second trimester between 15-21 weeks </strong>of gestation and involves the following parameters:</p>\n<ul>\n<li>Maternal serum alpha fetal protein (MSAFP)&nbsp;</li>\n<li>&beta; hCG</li>\n<li>Unconjugated estriol</li>\n<li>Inhibin A</li>\n</ul>\n<table style=\"width: 522px; height: 260px;\">\n<tbody>\n<tr>\n<td style=\"width: 109.734375px; text-align: center;\"><strong>Parameter</strong></td>\n<td style=\"width: 123.09375px; text-align: center;\"><strong>Trisomy 21/ Downs syndrome</strong></td>\n<td style=\"width: 119.25px; text-align: center;\"><strong>Trisomy 18/ Edward syndrome</strong></td>\n<td style=\"width: 141.953125px; text-align: center;\"><strong>Neural tube defect or abdominal wall defect</strong>&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 109.734375px; text-align: center;\"><strong>MSAFP</strong></td>\n<td style=\"width: 123.09375px; text-align: center;\">Low</td>\n<td style=\"width: 119.25px; text-align: center;\">Low</td>\n<td style=\"width: 141.953125px; text-align: center;\"><strong>High</strong></td>\n</tr>\n<tr>\n<td style=\"width: 109.734375px; text-align: center;\"><strong>&beta; hCG</strong></td>\n<td style=\"width: 123.09375px; text-align: center;\">High</td>\n<td style=\"width: 119.25px; text-align: center;\">Low</td>\n<td style=\"width: 141.953125px; text-align: center;\">Normal</td>\n</tr>\n<tr>\n<td style=\"width: 109.734375px; text-align: center;\"><strong>Unconjugated estriol</strong></td>\n<td style=\"width: 123.09375px; text-align: center;\">Low</td>\n<td style=\"width: 119.25px; text-align: center;\">Low</td>\n<td style=\"width: 141.953125px; text-align: center;\">Normal</td>\n</tr>\n<tr>\n<td style=\"width: 109.734375px; text-align: center;\"><strong>Inhibin A</strong></td>\n<td style=\"width: 123.09375px; text-align: center;\">High</td>\n<td style=\"width: 119.25px; text-align: center;\">Normal/Low</td>\n<td style=\"width: 141.953125px; text-align: center;\">Normal</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged woman develops hoarseness following a total thyroidectomy. On laryngoscopic examination, the left vocal cord is found to be in the cadaveric position. What is the best management in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Speech therapy, lateralization of cord"
      },
      {
        "id": 2,
        "text": "Speech therapy, medialization of cord"
      },
      {
        "id": 3,
        "text": "Tracheostomy"
      },
      {
        "id": 4,
        "text": "Epiglottopexy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical scenario is suggestive of<strong> unilateral complete vocal cord paralysis.</strong> The treatment of choice in this condition is <strong>speech therapy</strong>, if no improvement then&nbsp;<strong>medialization of the vocal cord</strong> is done.</p>\n<p><strong>Unilateral vocal cord paralysis</strong> is commonly seen following <strong>thyroid surgery</strong>&nbsp;(both recurrent and external laryngeal nerves of one side are affected). It results due to paralysis of all the muscles of the larynx on one side, except the <strong>inter arytenoid,</strong> which receives innervation from the opposite side.</p>\n<p>The vocal cord will assume the <strong>cadaveric position,</strong> i.e., <strong>3.5 mm</strong> from the midline. The healthy cord is unable to approximate the paralyzed cord, thus causing <strong>glottic incompetence</strong>,&nbsp;resulting in <strong>hoarseness of voice </strong>and <strong>aspiration of liquids</strong> through the glottis.</p>\n<p>Treatment includes <strong>speech therapy&nbsp;</strong>and <strong>medialization</strong> of vocal cords by injection of <strong>Teflon paste</strong> lateral to the paralyzed cord (<strong>type I thyroplasty</strong>)<strong>.</strong></p>\n<p><strong>Thyroplasty</strong> is a surgery done to improve the quality of voice. <strong>Isshiki's classification</strong> of thyroplasty includes:</p>\n<ul>\n<li>Type <strong>I</strong>: It is the <strong>m<span class=\"ILfuVd\" lang=\"en\"><span class=\"hgKElc\">edialization</span></span></strong> of the vocal cord. This is done in <strong>unilateral vocal cord</strong> <strong>palsy</strong>. (option B)</li>\n<li>Type <strong>II</strong>: It is <strong>lateralization</strong> of the vocal cord and is used to improve the airway. This is done in <strong>bilateral abductor palsy</strong>. (option A)</li>\n<li>Type III: It is used to shorten or relax the vocal cord. This is done in those who have undergone gender transformation from female to male.</li>\n<li>Type IV: It is used to lengthen or tighten the vocal cord and elevate the pitch. This is done in those who have undergone gender transformation from male to female.</li>\n</ul>\n<p>Other options:</p>\n<p>Options A and C: <strong>Tracheostomy</strong> and <strong>lateralization of the vocal cord</strong> (type 2 thyroplasty) are done in case of<strong> bilateral abductor paralysis. </strong>Patients usually present with <strong>dyspnea</strong> and <strong>stridor.</strong> Both the cords lie in the&nbsp;<strong>median</strong> or <strong>paramedian</strong> position compromising the airway.</p>\n<p>Option D: <strong>Epiglottopexy</strong> is the procedure done for <strong>bilateral vocal cord paralysis. </strong>Patients present with <strong>cough</strong> and choking fits due to inhalation of food and pharyngeal secretions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 19-year-old male patient presents to the OPD with complaints of progressive swelling in his left arm. An X-ray of the patient is given below. Which of the following statements is true regarding the management of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Radiotherapy is mandatory as it is a highly radiosensitive tumor"
      },
      {
        "id": 2,
        "text": "Cisplatin  is the chemotherapeutic agent of choice"
      },
      {
        "id": 3,
        "text": "The goal of neoadjuvant and adjuvant chemotherapy is to\u00a0treat micro metastasis."
      },
      {
        "id": 4,
        "text": "Hindquarter amputation is indicated in tumors involving upper end of tibia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The X-ray showing <strong>periosteal lifting</strong> and <strong>sunburst appearance</strong>\u00a0is suggestive of\u00a0<strong>osteosarcoma </strong>and the goal of neoadjuvant and adjuvant chemotherapy in osteosarcoma is to\u00a0<strong>treat micro-metastasis.</strong></p>\n<p>Osteosarcoma is the\u00a0<strong>most common non-hematologic primary malignancy</strong>\u00a0of bone. It occurs most commonly in the\u00a0<strong>second decade</strong>\u00a0of life. It is typically\u00a0<strong>metaphyseal</strong>.</p>\n<p>The distal femur, proximal tibia, and proximal humerus are the common sites.\u00a0</p>\n<p>In osteosarcoma, the tumor lifts the periosteum and incites an intense <strong>periosteal reaction</strong>. The periosteal reaction is\u00a0<strong>irregular\u00a0</strong>and it may take the form of a \"<strong>Codman's triangle\"</strong> or it may have a \"<strong>sunburst (sunray) appearance\"</strong> on X-ray.</p>\n<p>The image given in question shows the following features:</p>\n<ul>\n<li><strong>Irregular destruction</strong> in the metaphysis overshadowed by the <strong>formation of new bone</strong></li>\n<li><strong>Lifting of the periosteum</strong> due to the formation of new bone inciting a <strong>periosteal reaction</strong></li>\n<li>Bone formation along the <strong>blood vessels</strong> within the tumor centrifugally giving rise to \"<strong>sunburst (sunray) appearance\"</strong> on the radiograph.</li>\n</ul>\n<p>Treatment:</p>\n<p>Osteosarcoma is treated by\u00a0<strong>neoadjuvant chemotherapy, wide excision or radical surgery followed by adjuvant chemotherapy</strong>. Since here safe margins are difficult to achieve\u00a0<strong>limb ablation</strong>\u00a0is done.\u00a0</p>\n<p>Osteosarcoma is a radioresistant tumor</p>\n<p>The goal of neoadjuvant and adjuvant chemotherapy is to<strong>\u00a0treat micrometastasis.</strong></p>\n<p><strong>T-10 protocol</strong>\u00a0of chemotherapy is used in the management of osteosarcoma. It involves:</p>\n<ul>\n<li>High dose methotrexate and Citrovorum factor rescue</li>\n<li>Adriamycin</li>\n<li>BCD (bleomycin, cyclophosphamide, dactinomycin/doxorubicin)</li>\n</ul>\n<p>Note:</p>\n<p>Levels of amputation in osteosarcoma:</p>\n<table style=\"height: 129px; width: 438px;\">\n<tbody>\n<tr>\n<td style=\"width: 166.333px;\">Upper end of humerus</td>\n<td style=\"width: 255.667px;\">Forequarter amputation</td>\n</tr>\n<tr>\n<td style=\"width: 166.333px;\">Upper end of tibia</td>\n<td style=\"width: 255.667px;\">Midthigh amputation</td>\n</tr>\n<tr>\n<td style=\"width: 166.333px;\">Upper end of femur</td>\n<td style=\"width: 255.667px;\">Hindquarter amputation and hip disarticulation</td>\n</tr>\n<tr>\n<td style=\"width: 166.333px;\">Lower end of femur</td>\n<td style=\"width: 255.667px;\">Midthigh amputation and hip disarticulation</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7b9715813f5b4be6ba1c3c5ab1f56c41.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following Filariae exhibit a diurnal periodicity?",
    "choices": [
      {
        "id": 1,
        "text": "Onchocerca volvulus"
      },
      {
        "id": 2,
        "text": "Loa loa"
      },
      {
        "id": 3,
        "text": "Wuchereria bancrofti"
      },
      {
        "id": 4,
        "text": "Brugia malayi"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Loa Loa</strong> exhibits <strong>diurnal periodicity</strong>,\u00a0that peaks between 10:00 a.m. and 2:00 p.m.</p>\n<p>The microfilariae are found in large numbers in the peripheral blood during specific times of the day, depending on the blood-feeding habits of their insect vector. This is known as periodicity. Filarial worms can exhibit nocturnal, diurnal periodicity, or no periodicity at all.</p>\n<ul>\n<li><strong>Nocturnal periodicity</strong>: When the largest number of microfilariae are present in the blood at night. Eg-\u00a0<strong>Wuchereria bancrofti,\u00a0Brugia malayi,\u00a0Brugia timori</strong></li>\n<li><strong>Diurnal periodicity</strong>: When the largest number of microfilariae occur in blood during the day. Eg-\u00a0<strong>Loa loa</strong></li>\n<li><strong>Nonperiodic:</strong> When the number of microfilariae maintains a <strong>constant level</strong> during the day and night. Eg-\u00a0<strong>Onchocerca volvulus</strong></li>\n<li><strong>Subperiodic</strong> or nocturnally subperiodic: When the microfilariae can be detected in the blood throughout the day but are detected in larger numbers in the late afternoon or at night. Eg-\u00a0Wuchereria bancrofti in the eastern pacific and\u00a0Brugia malayi in Indonesia and southeast Asia.</li>\n</ul>\n<p><strong>The\u00a0nematode\u00a0worm\u00a0Loa loa </strong>causes skin and eye disease called<strong> Loa loa\u00a0filariasis.</strong>\u00a0Humans contract this disease through the bite of a Chrysops fly, commonly called\u00a0deer fly or\u00a0mango fly, which are the\u00a0vectors\u00a0for\u00a0Loa loa. It is shown in the image below.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1a672e5f27e5446a9c5723174ddfcf13x1280x866.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/35053a62e1d64af6967249dbd72c8a35x720x622.JPEG"
    ]
  },
  {
    "text": "A patient is undergoing Doppler ultrasonographic assessment for varicose veins. When the probe was placed inferior to the inguinal crease, the sign shown in the below image was seen on the transverse view in the B-mode. What does it indicate?",
    "choices": [
      {
        "id": 1,
        "text": "Normal anatomy of femoral vessels"
      },
      {
        "id": 2,
        "text": "Thrombosis of common femoral vein"
      },
      {
        "id": 3,
        "text": "Incompetence of saphenofemoral valve"
      },
      {
        "id": 4,
        "text": "Thrombosis of great saphenous vein"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The sign in the image&nbsp;given above is the <strong>Mickey mouse sign</strong>,<strong>&nbsp;</strong>which represents the <strong>normal anatomy of the femoral vessels</strong>.</p>\n<div class=\"page\" title=\"Page 998\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The Mickey mouse sign is seen on the transverse B-mode of USG.</p>\n<p>It includes&nbsp;</p>\n<ul>\n<li>Great saphenous vein (GSV),</li>\n<li>Common femoral vein (CFV), and</li>\n<li>Common femoral artery (CFA)</li>\n</ul>\n<p>Normally, the GSV and CFV lie medial to the common femoral artery, which gives rise to the sign.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9e68622cfa7c4b289b9e5ae0e0b7b97e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8e5752ff1fd34c59aa1fb2ca284338a4x1280x1750.JPEG"
    ]
  },
  {
    "text": "A full-term infant with a history of polyhydramnios in utero presents with respiratory distress soon after birth. On examination frothing at the mouth is observed and the child regurgitates the feeds given to him. Abdominal examination reveals an airless scaphoid abdomen. A contrast study is performed and the findings are as shown below. Which of the following statements given about the condition is false?",
    "choices": [
      {
        "id": 1,
        "text": "2 and 3 only"
      },
      {
        "id": 2,
        "text": "2, 3, 4"
      },
      {
        "id": 3,
        "text": "1 and 4 only"
      },
      {
        "id": 4,
        "text": "2, 4, 5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical vignette with the radiograph depicting a defect in the contrast study is suggestive of&nbsp;<strong>oesophagal atresia (EA).&nbsp;</strong>Isolated oesophagal atresia falls under&nbsp;<strong>tracheoesophageal fistula (TEF) type A</strong>.&nbsp;The incorrect statements include&nbsp;<strong>2 and 3 only.</strong></p>\n<p>More than 90% of oesophageal atresia is most commonly associated with TEF (Tracheo-oesophageal fistula). If on examination the child has an air-filled abdomen it should raise the suspicion of TEF, the most common type being&nbsp;<strong>type - C.&nbsp;</strong></p>\n<p>Type H - isolated TEF <strong>(without esophageal atresia)</strong> seldom presents with such symptoms and can be diagnosed with an esophagogram with contrast medium.It can present later in life with chronic respiratory problems like&nbsp;refractory bronchospasm and recurrent pneumonias.</p>\n<p>&nbsp;</p>\n<p>The image below gives Gross classification of TEF.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f9601da4434441a89244203df51f3a26.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9fce2b4af2284eb18ea28a17c456ac2ex1280x1964.JPEG"
    ]
  },
  {
    "text": "Your professor explains a phenomenon wherein there is worsening of angina due to marked vasodilation of the coronary arteries in the non-ischemic zones in patients with partial obstruction of coronary arteries. Which of the following drugs cause this phenomenon?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3 and 4"
      },
      {
        "id": 2,
        "text": "1 and 4 only"
      },
      {
        "id": 3,
        "text": "1 and 3"
      },
      {
        "id": 4,
        "text": "1 only"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The stem explains the <strong>coronary steal phenomenon. 1, 3, </strong>and<strong> 4 </strong>cause this phenomenon.</p>\n<p><strong>Coronary steal phenomenon</strong>&nbsp;:</p>\n<p>In patients with partial obstruction of coronary vasculature, a region of ischemia develops in the myocardium. In the absence of drugs, arterioles in the ischemic areas are usually maximally dilated as a result of local compensatory mechanisms.&nbsp;</p>\n<p>When a&nbsp;nonselective arteriolar dilator is&nbsp;administered, it can only dilate the vessels of the normal myocardium as the vessels of the ischemic myocardium are already maximally dilated. This <strong>diverts (steals) the blood</strong> away from the ischemic myocardium towards the normal myocardium. This is termed as coronary steal phenomenon.</p>\n<p>Drugs causing Coronary steal phenomenon:</p>\n<ul>\n<li>Dipyridamole</li>\n<li>Adenosine</li>\n<li>Regadenoson</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a patient undergoing cataract surgery, which of the following is the most important strategy in the prevention of postoperative endophthalmitis?",
    "choices": [
      {
        "id": 1,
        "text": "Preoperative preparation with povidone iodine"
      },
      {
        "id": 2,
        "text": "One week antibiotic therapy prior to surgery"
      },
      {
        "id": 3,
        "text": "Trimming of eyelashes"
      },
      {
        "id": 4,
        "text": "Use of intravitreal antibiotics"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most important factor in the prevention of postoperative endophthalmitis is <strong>preoperative preparation </strong>with<strong> povidone-iodine</strong>.\u00a0</p>\n<p><strong>Postoperative endophthalmitis</strong> is<strong>\u00a0</strong>most commonly caused by\u00a0<em>Staphylococcus epidermidis. </em><strong>Flora </strong>of the <strong>eyelids</strong> and <strong>conjunctiva</strong> are the most frequent source. Other potential sources include contaminated solutions and instruments, environmental air, and the surgeon and other operating room personnel.</p>\n<p>Prophylaxis for postoperative endophthalmitis includes:\u00a0</p>\n<ul>\n<li>Instillation of<strong> 5% povidone-iodine</strong> into the conjunctival fornices and leaving this undisturbed for at least <strong>3 minutes prior </strong>to<strong> </strong>surgery. This is the most important factor.\u00a0</li>\n<li>Scrupulous preparation of the surgical site</li>\n<li>Treatment of pre-existing infections such as blepharitis</li>\n<li>Antibiotic prophylaxis\n<ul>\n<li><strong>Intracameral</strong> <strong>cefuroxime</strong> (1 mg in 0.1 mL) injected into the anterior chamber (AC) at the end of surgery.</li>\n<li><strong>Post-operative</strong> <strong>subconjunctival</strong> <strong>injection</strong> can achieve bactericidal levels in the AC for at least 1\u20132 hours.</li>\n<li>Preoperative topical <strong>fluoroquinolone antibiotics</strong> are frequently given in regimens from 1 hour to 3 days before surgery</li>\n</ul>\n</li>\n</ul>\n<p>Patients present with ocular pain, diminished vision, circumciliary congestion and hypopyon. The differential diagnosis for postoperative endophthalmitis includes retained lens material in the AC, vitreous hemorrhage, postoperative uveitis and toxic reaction to the use of inappropriate or contaminated irrigating fluid or viscoelastic.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a characteristic feature of a patient with Tourette's syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "Onset before 18 years"
      },
      {
        "id": 2,
        "text": "Persistence of tics for at least 6 months"
      },
      {
        "id": 3,
        "text": "Severity peaks between 10 and 12 years"
      },
      {
        "id": 4,
        "text": "Presence of at least one vocal tic"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Tourette's syndrome</strong> is diagnosed when there is a persistence of tics for <strong>at least 1 year.</strong></p>\n<p class=\"p1\">According to DSM-5 criteria, a diagnosis of Tourette's disorder depends on:</p>\n<ul>\n<li class=\"p1\">A history of <strong>multiple motor tics</strong> and the emergence of <strong>at least one vocal tic</strong> at some point.</li>\n<li class=\"p1\">Tics may wax and wane in frequency but must have persisted for more than<strong> a year</strong>.</li>\n<li class=\"p1\">The average age of onset of tics is between 4 years and 6 years of age, although the <strong>peak age</strong> for the severity of tics is between<strong> 10 and 12 years.</strong></li>\n<li class=\"p1\">The onset of symptoms must occur <strong>before the age of 18 years. </strong>No tic-free period of more than three consecutive months in 1 year.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Dangerous placenta previa is a variation of :",
    "choices": [
      {
        "id": 1,
        "text": "A"
      },
      {
        "id": 2,
        "text": "B"
      },
      {
        "id": 3,
        "text": "C"
      },
      {
        "id": 4,
        "text": "D"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Dangerous placenta previa</strong> is a variation of type II placenta previa(option b). It is the name given to the <strong>type-II posterior </strong>placenta previa.</p>\n<p>It is so called :</p>\n<ul>\n<li>Because of the curved birth canal, the major thickness of the placenta (about 2.5cm) overlies the sacral promontory, thereby diminishing the anteroposterior diameter of the inlet and prevents the engagement of the presenting part. This hinders effective compression of the separated placenta to stop bleeding.</li>\n<li>The placenta is more likely to be compressed if vaginal delivery is allowed.</li>\n<li>More chance of cord compression or cord prolapse.</li>\n</ul>\n<p>The last two may produce fetal anoxia or even death.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e49da97324134d8cb99348ce87b1000a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c9ec45a0f9ae4dab80b07e1b35c844e1x1280x2004.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2b62d51035e3454393838dd246f06587x1280x1597.JPEG"
    ]
  },
  {
    "text": "Identify the structure marked by the red arrow in the dissected specimen of the dorsum of the hand:",
    "choices": [
      {
        "id": 1,
        "text": "Abductor pollicis longus"
      },
      {
        "id": 2,
        "text": "Extensor pollicis brevis"
      },
      {
        "id": 3,
        "text": "Extensor pollicis longus"
      },
      {
        "id": 4,
        "text": "Extensor indices"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The structure marked is the <strong>extensor pollicis longus </strong>tendon<strong>. </strong>It forms the <strong>medial boundary</strong> of the <strong>anatomical snuffbox.</strong></p>\n<p>An anatomical<strong> snuffbox</strong> is a <strong>triangular depression</strong> on the posterolateral side of the wrist. It is best observed when the thumb is extended. Its boundaries are:</p>\n<table style=\"border-collapse: collapse; width: 44.7368%; height: 168px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 50.0454%;\">Lateral wall</td>\n<td style=\"width: 50.0454%;\">Abductor pollicis longus (APL)<br />Extensor pollicis brevis (EPB)</td>\n</tr>\n<tr>\n<td style=\"width: 50.0454%;\">Medial wall</td>\n<td style=\"width: 50.0454%;\">Extensor pollicis longus (EPL)</td>\n</tr>\n<tr>\n<td style=\"width: 50.0454%;\">Roof</td>\n<td style=\"width: 50.0454%;\">Cephalic vein<br />Superficial branch of radial nerve</td>\n</tr>\n<tr>\n<td style=\"width: 50.0454%;\">Floor</td>\n<td style=\"width: 50.0454%;\">Radial styloid, scaphoid, trapezium, and 1st metacarpal</td>\n</tr>\n<tr>\n<td style=\"width: 50.0454%;\">Content</td>\n<td style=\"width: 50.0454%;\">Radial artery</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p>The image below shows the tendons seen on the dissection of the dorsum of the hand.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1ba3e9a5c77544708ecca4108d44f8d4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0ed0552700e44b219d83b1c168cd59b2x800x600.JPEG"
    ]
  },
  {
    "text": "A 65 year old man was admitted with generalised weakness, easy fatigability, itching and jaundice since 1 month. On examination, he was emaciated and had scratch marks all over the body. A mass was palpable in the upper abdomen. Which of the following can be seen on Van den Bergh reaction?",
    "choices": [
      {
        "id": 1,
        "text": "Direct positive"
      },
      {
        "id": 2,
        "text": "Indirect positive"
      },
      {
        "id": 3,
        "text": "Biphasic reaction"
      },
      {
        "id": 4,
        "text": "Negative"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Generalised weakness, easy fatigability, itching and jaundice with a palpable upper abdominal mass is suggestive of <strong>pancreatic malignancy</strong> leading to <strong>obstructive jaundice</strong>. This gives a\u00a0<strong>direct positive</strong> result on Van den Bergh reaction.</p>\n<p>In obstructive jaundice, <strong>obstruction</strong> of the <strong>biliary tree</strong> causes regurgitation of conjugated bilirubin into the blood. Patients present with itching, jaundice and<strong> pale coloured stools</strong>.</p>\n<p>Van den Bergh reaction is a <strong>colorimetric method</strong> to measure the serum bilirubin level. It is based on the formation of <strong>red azodipyrroles</strong> when <strong>diazotized sulfanilic acid</strong> reacts with <strong>bilirubin</strong>.</p>\n<table style=\"width: 484px;\">\n<tbody>\n<tr>\n<td style=\"width: 192px;\"><strong>Clinical condition</strong></td>\n<td style=\"width: 474.8958435058594px;\"><strong>Reaction with reagent</strong></td>\n<td style=\"width: 190.10415649414062px;\"><strong>Interpretation</strong></td>\n</tr>\n<tr>\n<td style=\"width: 192px;\">Normal serum</td>\n<td style=\"width: 474.8958435058594px;\">No reaction</td>\n<td style=\"width: 190.10415649414062px;\">Negative</td>\n</tr>\n<tr>\n<td style=\"width: 192px;\">High <strong>conjugated</strong> bilirubin<br />eg: <strong>Obstructive jaundice</strong></td>\n<td style=\"width: 474.8958435058594px;\">Reacts in the absence of methanol</td>\n<td style=\"width: 190.10415649414062px;\"><strong>Direct</strong> positive</td>\n</tr>\n<tr>\n<td style=\"width: 192px;\">High <strong>unconjugated</strong> bilirubin<br />eg: Hemolytic anemia</td>\n<td style=\"width: 474.8958435058594px;\">Reacts in the presence of methanol</td>\n<td style=\"width: 190.10415649414062px;\"><strong>Indirect</strong> positive</td>\n</tr>\n<tr>\n<td style=\"width: 192px;\">High <strong>conjugated </strong>and<strong> unconjugated</strong> bilirubin<br />eg: Hepatic jaundice</td>\n<td style=\"width: 474.8958435058594px;\">Reacts strongly both with and without methanol</td>\n<td style=\"width: 190.10415649414062px;\"><strong>Biphasic</strong> reaction</td>\n</tr>\n</tbody>\n</table>\n<div dir=\"ltr\" align=\"left\">\u00a0</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 25-year-old lady who was a victim of rape was brought by the lady constable to the gynecologist for examination. The doctor examined the victim and obtained a sample in and around the vagina. Which among the following statements is false regarding this situation?",
    "choices": [
      {
        "id": 1,
        "text": "Seminal stains can be detected by ultraviolet light"
      },
      {
        "id": 2,
        "text": "Acid phosphatase test can be used to detect seminal stain"
      },
      {
        "id": 3,
        "text": "Absence of spermatozoa in the sample collected excludes rape"
      },
      {
        "id": 4,
        "text": "Vaginal and cervical cells can be identified from the penis of the accused using papanicolaou's stain"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\"><span class=\"s1\"><strong>Absence of spermatozoa </strong>in the sample obtained <strong>does not exclude rape.</strong></span></p>\n<p class=\"p1\"><span class=\"s1\">The seminal fluid may have been removed by washing, or discharges or there may not have been an emission, or it may have been aspermic, or ejaculation occured outside.</span></p>\n<p class=\"p1\"><span class=\"s1\">Other options:</span></p>\n<ul class=\"ul1\">\n<li class=\"li2\"><span class=\"s1\">Seminal stains can be detected by ultraviolet light</span></li>\n<li class=\"li2\"><span class=\"s1\"><strong>An acid phosphatase test</strong> is used to identify <strong>seminal stains:\u00a0</strong>The prostatic secretion contains acid phosphatase. Semen recovered from the vagina retains acid phosphatase concentrations upto 36 hours after it's deposition. It is expressed in Bodansky units. Acid phosphatase test is conclusive in case the absence of demonstrable sperms or Aspermia. The absolute proof of semen is finding at least one unbroken spermatozoon or electrophoretic LDH isoenzyme detection of sperms.</span></li>\n<li class=\"li2\"><span class=\"s1\">The suspect's penis is washed with saline and the material is stained with papanicolao's stain. Vaginal and cervical cells and barrbody identification suggest recent intercourse.</span></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A study was conducted to compare the incidence of postpartum depression in mothers as compared to the sex of the child. For assessment, Edinburg Depression scaled score (EDSS) was used. The study was divided into mothers with male babies as one group to be compared with mothers with female babies. Which of the following statistical test will be used to determine the association?",
    "choices": [
      {
        "id": 1,
        "text": "Students t test"
      },
      {
        "id": 2,
        "text": "Paired t test"
      },
      {
        "id": 3,
        "text": "ANOVA"
      },
      {
        "id": 4,
        "text": "Chi square test"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The Chi-square test is used to compare <strong>qualitative</strong> data and compares<strong> 2 groups</strong> with independent measures. The variables used here are yes/no signifying the presence/absence of postpartum depression. Hence it is the most appropriate test here.</p>\n<p>Option A: Student\u2019s t-test is for quantitative data. Here the data is qualitative, hence it can't be used.</p>\n<p>Option B: Paired t-test compares paired data or pre-intervention and post-intervention data of the same group. This doesn't apply here as the groups are not paired.</p>\n<p>Option C: ANOVA is used to compare more than 2 groups.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old female patient has NYHA class III heart failure with dyspnea, pedal edema and K+ levels of 5.5 mg% and creatinine 1.1 mg%. Which of the following drugs can be used in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Digoxin"
      },
      {
        "id": 2,
        "text": "Spironolactone"
      },
      {
        "id": 3,
        "text": "Enalapril"
      },
      {
        "id": 4,
        "text": "Furosemide"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical scenario describes a patient with <strong>symptomatic heart failure</strong> and&nbsp;<strong>K<sup>+ </sup>levels of 5.5 mg%</strong>. She requires a diuretic for symptom control. <strong>Furosemide&nbsp;</strong>can be given safely as it causes <strong>hypokalemia.</strong></p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Digoxin</strong> is not used as a first-line drug in the management of symptomatic heart failure.</p>\n<p>Options B and C:&nbsp;<strong>Spironolactone</strong> (K<sup>+ </sup>sparing diuretic) and <strong>enalapril</strong> (ACE inhibitor) can cause hyperkalemia.&nbsp;&nbsp;</p>\n<p>The first step in managing acute decompensated heart failure (ADHF) is addressing the factors that caused the decompensation. They include&nbsp;<strong>nonadherence</strong> to medications, dietary indiscretion, medication use that exacerbates heart failure, <strong>coronary ischemia</strong>, <strong>arrhythmias</strong>, valvular heart disease, <strong>infection</strong>, and pulmonary <strong>thromboembolism</strong>.</p>\n<p><strong>Volume management</strong> is crucial in ADHF. Intravenous <strong>loop diuretics</strong> are used to relieve congestion. The effectiveness of diuretic therapy can be assessed by changes in weight, improvement in symptoms, and clinical examination findings. <strong>Natriuretic peptide</strong> levels can also help assess the adequacy of therapy and predict risk.</p>\n<p><strong>Cardiorenal syndrome</strong>, characterized by the interplay between heart and kidney dysfunction, is a common complication of ADHF. Diuretic therapy should be carefully managed to avoid worsening renal function in patients with elevated right-sided filling pressures. In cases of severe low cardiac output, inotropic therapy or mechanical circulatory support may be necessary to preserve or improve renal function temporarily.</p>\n<p><strong>Vasodilators</strong> like nitroglycerin, sodium nitroprusside, and <strong>nesiritide&nbsp;</strong>(recombinant BNP) are used to reduce filling pressures and systemic vascular resistance.&nbsp;</p>\n<p><strong>Inotropic therapy</strong> with drugs like <strong>dopamine</strong> and <strong>milrinone</strong> is used to increase myocardial contractility and improve cardiac output in patients with <strong>low-output</strong> ADHF. Dopamine has dose-dependent effects on different receptors, while milrinone is a phosphodiesterase-3 inhibitor.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Neet Mini - 21 (20 Q)';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>