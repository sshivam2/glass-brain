<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>056 Pharmacology Neet 2022 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Pharmacology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">15</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A male patient with chronic obstructive pulmonary disease (COPD) was prescribed theophylline. He noticed that his urine output had increased the following day. This action of the drug is mediated through which of the following receptors?",
    "choices": [
      {
        "id": 1,
        "text": "Interleukin-10"
      },
      {
        "id": 2,
        "text": "Histone deacetylase"
      },
      {
        "id": 3,
        "text": "Adenosine A1"
      },
      {
        "id": 4,
        "text": "Beta 2 adrenergic receptors"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>An <strong>increased urine output</strong> after administering <strong>theophylline</strong> is due to the <strong>antagonism</strong> at <strong>adenosine A1 receptors.</strong></p>\n<p>The <strong>adenosine A1</strong> receptors are present in the <strong>afferent arteriole</strong> of the <strong>glomeruli.</strong> When <strong>activated,</strong> they cause&nbsp;<strong>vasoconstriction</strong> that&nbsp;<strong>reduces</strong> the glomerular filtration rate (GFR) and renal blood flow. This reduces <strong>urine output.</strong> Antagonistic action on these receptors will cause an increased GFR and renal blood flow and hence increased urine output.</p>\n<p>Methylxanthines like theophylline and aminophylline are the <strong>bronchodilators</strong> used mainly in chronic obstructive pulmonary disease (<strong>COPD</strong>) and bronchial asthma. The pharmacological actions of theophylline are:</p>\n<ul>\n<li>It&nbsp;<strong>inhibits&nbsp;phosphodiesterase (PDE) </strong>non-selectively, thereby increasing cellular cAMP and cGMP,&nbsp;causing <strong>bronchodilation.&nbsp;</strong></li>\n<li>Adenosine causes bronchoconstriction by releasing histamine and leukotrienes. Theophylline <strong>antagonizes adenosine A1 receptors</strong> and causes <strong>bronchodilation.</strong></li>\n<li>It <strong>increases IL-10</strong> release, which has&nbsp;<strong>anti-inflammatory</strong> actions.</li>\n<li>It causes a&nbsp;<strong>decrease</strong> in gene transcription of <strong>pro-inflammatory cytokines.</strong></li>\n<li>It <strong>promotes apoptosis</strong> of<strong> granulocytes</strong> and thereby, <strong>reduces</strong> the <strong>inflammatory</strong> load in the airways.</li>\n</ul>\n<p><strong>Adverse effects</strong> of theophylline:</p>\n<ul>\n<li>Headache, nausea, and vomiting (due to inhibition of PDE4)</li>\n<li>Increased acid secretion (due to PDE inhibition)</li>\n<li><strong>Diuresis</strong> (due to inhibition of <strong>adenosine A1</strong> receptors)</li>\n<li>Cardiac arrhythmias (due to inhibition of cardiac <strong>PDE3</strong> and antagonism of <strong>cardiac A1 receptors</strong>).</li>\n<li>Seizures (due to central A1 receptor antagonism).</li>\n</ul>\n<p>Theophylline is mainly metabolized mainly by the enzyme <strong>CYP1A2. </strong>Therefore, it has various<strong> drug interactions, </strong>which include:</p>\n<ol>\n<li>Agents that lower its plasma level are&nbsp;<strong>smoking,</strong> phenytoin, <strong>rifampicin</strong>, and phenobarbitone.</li>\n<li>Drugs that increase its plasma level are erythromycin, ciprofloxacin, <strong>oral contraceptives</strong>, and allopurinol.</li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs is not likely to cause a pleural pathology?",
    "choices": [
      {
        "id": 1,
        "text": "Metformin"
      },
      {
        "id": 2,
        "text": "Methysergide"
      },
      {
        "id": 3,
        "text": "Bleomycin"
      },
      {
        "id": 4,
        "text": "Nitrofurantoin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Metformin is not associated with pleural pathology.</p>\n<p>Metformin belongs to the <strong>biguanides</strong> class of oral hypoglycemic agents. It acts by activation of AMP-dependent protein kinase (<strong>AMPK</strong>). This results in reduced hepatic glucose production.</p>\n<p><strong>Side effects</strong> of <strong>metformin</strong> are <strong>l</strong><strong>actic acidosis, </strong>gastrointestinal disturbance, and <strong>vitamin B12 deficiency.</strong></p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p><strong>Contraindications</strong> for <strong>metformin</strong> include :</p>\n<ul>\n<li><strong>GFR &lt;30 ml/min</strong></li>\n<li>Unstable CHF</li>\n<li>Radiographic contrast studies</li>\n<li>Hospitalized patients who cannot take anything orally</li>\n<li>Acidosis</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: <strong>Methysergide</strong> is a serotonin(<strong>5-HT</strong>) receptor antagonist. It was used for the treatment of <strong>migraine prophylaxis</strong> and carcinoid syndrome. But its use has been discontinued due to side effects like abdominal, <strong>pulmonary</strong> and endocardial <strong>fibrosis</strong>.</p>\n<p>Option C: <strong>Bleomycin </strong>is an anticancer antibiotic used for the treatment of squamous cell cancer and Hodgkin lymphoma. It chelates copper or iron and produces superoxide ions that damage DNA. Side effects are mucocutaneous toxicity and <strong>pulmonary fibrosis.</strong></p>\n<p>Option D: <strong>Nitrofurantoin</strong> is a urinary antiseptic. They are used for the treatment of lower urinary tract infections (<strong>UTIs</strong>). It acts by <strong>damaging DNA</strong> and inhibiting protein synthesis in susceptible bacteria. Important side effects are gastrointestinal disturbances, liver damage and <strong>pulmonary fibrosis</strong>.</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with deep vein thrombosis was started on a new drug. After 2 days, he presented with the given finding. Which of the following drugs is implicated in causing the above condition?",
    "choices": [
      {
        "id": 1,
        "text": "Warfarin"
      },
      {
        "id": 2,
        "text": "Heparin"
      },
      {
        "id": 3,
        "text": "Dabigatran"
      },
      {
        "id": 4,
        "text": "Rivaroxaban"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>The half-life of <strong>proteins C</strong> and <strong>S</strong> are 8 and 24 hours, respectively, which is relatively <strong>shorter </strong>than the half-lives of other clotting factors, particularly factor II. Therefore, the full antithrombotic effect of warfarin is not achieved for <strong>4 to 5 days</strong>. For this reason, warfarin must be bridged with a rapidly acting parenteral anticoagulant, such as <strong>heparin</strong>, low-molecular-weight heparin (<strong>LMWH</strong>), or fondaparinux, in patients with thrombosis or at high risk for thrombosis.</p>\n<p>Uses of warfarin are acute deep vein thrombosis, pulmonary embolism, and <strong>p</strong><strong>reventing stroke </strong>or <strong>systemic embolization</strong> in patients with a <strong>mechanical heart valve</strong>.&nbsp;</p>\n<p>Adverse effects of warfarin are bleeding, skin necrosis, <strong>p</strong><strong>urple toe syndrome,</strong>&nbsp;and&nbsp;<strong>f</strong><strong>etal warfarin syndrome</strong>&nbsp;(hypoplasia of the nose, eye socket, hand bones, and growth retardation).</p>\n<p>The therapeutic dose of warfarin is monitored by an <strong>INR</strong> range of <strong>2-3</strong>. Warfarin toxicity&nbsp;can occur when the INR exceeds <strong>4</strong> and can lead to <strong>fatal bleeding</strong>. Treatment includes withholding warfarin, with&nbsp;<strong>v</strong><strong>itamin K,</strong> and <strong>b</strong><strong>lood transfusions </strong>or <strong>fresh frozen plasma</strong> to replenish clotting factors.</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Warfarin, LMWH, and UFH <strong>do not</strong> accumulate in breast milk and do not have an anticoagulant effect in the newborn. They are <strong>compatible</strong> with breastfeeding.</p>\n<p><strong><span data-preserver-spaces=\"true\">Warfarin</span></strong><span data-preserver-spaces=\"true\">&nbsp;is mainly&nbsp;</span><strong><span data-preserver-spaces=\"true\">metabolized&nbsp;</span></strong><span data-preserver-spaces=\"true\">by the</span><strong><span data-preserver-spaces=\"true\">&nbsp;CYP2C9</span></strong><span data-preserver-spaces=\"true\">&nbsp;enzyme. Drugs that affect the <strong>CYP2C9</strong> enzyme can alter the anticoagulant function of warfarin and these include the following: </span></p>\n<p><span data-preserver-spaces=\"true\">Reduced efficacy:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">CYP2C9 activation by drugs: barbiturates, carbamazepine, rifampin</span></li>\n<li><span data-preserver-spaces=\"true\">Oral contraceptives: increase blood levels of clotting factors</span></li>\n</ul>\n<p><span data-preserver-spaces=\"true\">Increased efficacy:</span></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Drugs causing CYP2C9 inhibition:</span></li>\n<ul>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Amiodarone</span></li>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Azole antifungals</span></li>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Cimetidine</span></li>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Clopidogrel</span></li>\n<li class=\"ql-indent-1\">Cotrimoxazole</li>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Disulfiram</span></li>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Isoniazid</span></li>\n<li class=\"ql-indent-1\"><strong>Metronidazole</strong></li>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Fluoxetine</span></li>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Sulfinpyrazone</span></li>\n<li class=\"ql-indent-1\"><span data-preserver-spaces=\"true\">Zafirlukast</span></li>\n</ul>\n</ul>\n<p><span data-preserver-spaces=\"true\">Other options:</span></p>\n<p><span data-preserver-spaces=\"true\">Option B: <strong><span class=\"col\">Heparin </span></strong><span class=\"col\">acts by activating antithrombin III, thereby inactivating the active form of clotting factors II, IX, X, XI, XII, and XIII. Adverse effects are bleeding and <strong>heparin-induced thrombocytopenia</strong> (HIT) due to the formation of antibodies against the heparin-platelet complex.</span></span></p>\n<p><span data-preserver-spaces=\"true\">Option C: <strong><span class=\"col\">Dabigatran </span></strong><span class=\"col\">is a direct thrombin inhibitor. It is used for the prevention of embolism and stroke in patients with atrial fibrillatio</span>n. <strong>Bleeding</strong> and <strong>dyspepsia</strong> are the most important adverse effects.</span></p>\n<p><span data-preserver-spaces=\"true\">Option D: <strong><span class=\"col\">Rivaroxaban </span></strong><span class=\"col\">is a </span><span class=\"col\">direct inhibitor of factor Xa. It is used for prophylaxis and treatment of deep vein thrombosis. Side effects reported are bleeding, nausea, hypotension, tachycardia, and edema.</span></span></p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/842afb9681c443a99e97961fcb6d416f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2bc835721e6e4ef99b01e279efaeada3x1279x1234.JPEG"
    ]
  },
  {
    "text": "A patient undergoing chemotherapy was given an antiemetic, after which he developed symptoms like acute dystonia, bradykinesia, and tremors. Which of the following drugs would have caused these symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Ondansetron"
      },
      {
        "id": 2,
        "text": "Metoclopramide"
      },
      {
        "id": 3,
        "text": "Meclizine"
      },
      {
        "id": 4,
        "text": "Scopolamine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the above scenario, the patient has developed&nbsp;<strong>extrapyramidal</strong> adverse effects like <strong>acute dystonia,</strong> <strong>bradykinesia</strong>, and<strong> tremors. </strong>This is likely due to<strong>&nbsp;</strong>the&nbsp;<strong>antagonist</strong> action on <strong>dopamine receptors</strong> by <strong>metoclopramide.</strong></p>\n<p>Metoclopramide is a <strong>prokinetic</strong> and <strong>antiemetic.</strong> It has the following <strong>pharmacological actions:</strong></p>\n<ul>\n<li><strong>Dopamine</strong> receptor <strong>antagonist</strong>&nbsp;</li>\n<li>Serotonin (<strong>5HT4</strong>) receptor <strong>agonist</strong>&nbsp;</li>\n<li>Serotonin (<strong>5HT3</strong>) <strong>antagonist</strong></li>\n<li><strong>Sensitization</strong> of <strong>muscarinic receptors</strong> on <strong>smooth muscle.</strong> This results in <strong>increased</strong> lower <strong>esophageal sphincter tone</strong> and stimulates gastric antral contractions.</li>\n</ul>\n<p>Metoclopramide acts on both the gastrointestinal system and central nervous system. It is used as an upper antiemetic for many types of vomiting, especially migraine, drug-induced, and<strong> chemotherapy-induced</strong>. It is also used as a prokinetic in <strong>gastroparesis</strong> to increase gastric emptying.</p>\n<p>Adverse effects of metoclopramide are mainly extrapyramidal effects, and these include <strong>acute dystonia, Parkinson</strong><strong>-like</strong> symptoms (tremors, bradykinesia, rigidity), tardive dyskinesia,<strong> galactorrhea </strong>due to hyperprolactinemia, and methemoglobinemia in neonates.</p>\n<p>Extrapyramidal symptoms can be <strong>treated</strong> by <strong>discontinuation</strong> of metoclopramide and administration of anticholinergics or antihistaminics.</p>\n<p>Other options:</p>\n<p>Option A: <span data-preserver-spaces=\"true\">Ondansetron is a</span><strong><span data-preserver-spaces=\"true\">&nbsp;5-HT<sub>3</sub> receptor antagonist</span></strong>. It blocks impulses at the peripheral origin in GIT. <span data-preserver-spaces=\"true\">It is most commonly indicated for the treatment of&nbsp;</span><strong><span data-preserver-spaces=\"true\">postoperative&nbsp;</span></strong><span data-preserver-spaces=\"true\">and <strong>chemotherapy</strong>-<strong>induced</strong></span><strong><span data-preserver-spaces=\"true\">&nbsp;nausea </span></strong>and <strong><span data-preserver-spaces=\"true\">vomiting. </span></strong><span data-preserver-spaces=\"true\">Headache and dizziness are the common adverse effects.<br /></span></p>\n<p>Option C:<strong> Meclizine</strong> is a&nbsp;long-acting <strong>H1 antihistaminic</strong> drug.&nbsp;It is used for <strong>seasickness</strong>. It is less sedative and less anticholinergic.</p>\n<p>Option D: <strong>Scopolamine (hyoscine)</strong> is a <strong>muscarinic antagonist.</strong> It blocks neural pathways from the vestibular apparatus in the inner ear to the emetic center in the brainstem. A <strong>transdermal patch</strong> of scopolamine is used as an antiemetic in <strong>motion sickness</strong>. Constipation, drowsiness, dry mouth, and blurred vision are the common adverse effects.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young patient started to take a weight loss medication that acts by inhibiting fat absorption from food. After a few weeks, she developed easy bruising and increased menstrual bleeding. Deficiency of which of the following vitamins is responsible for her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin E"
      },
      {
        "id": 2,
        "text": "Vitamin K"
      },
      {
        "id": 3,
        "text": "Vitamin B6"
      },
      {
        "id": 4,
        "text": "Vitamin D"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario of <strong>easy bruising</strong> and <strong>increased menstrual bleeding</strong> following weight loss medication that inhibits fat absorption from food is suggestive of <strong>vitamin</strong> <strong>K</strong> <strong>deficiency</strong>.</p>\n<p>Vitamin K is a <strong>fat-soluble</strong> vitamin. Hence, drugs that inhibit the absorption of fat (eg;\u00a0<strong>ezetimibe</strong>) also inhibit the absorption of fat-soluble vitamin K. The following are the vitamers of vitamin K:</p>\n<div class=\"page\" title=\"Page 2363\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Phylloquinone</strong> (Vitamin <strong>K1</strong>) is the normal dietary source of Vitamin K that is found in green vegetables.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Menaquinone</strong>\u00a0(Vitamin <strong>K2</strong>) is synthesized by intestinal bacteria.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Menadione</strong> (Vitamin <strong>K3</strong>) is a synthetic compound that is metabolized to phylloquinone.</li>\n</ul>\n</div>\n</div>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Vitamin K is required for <strong>\u03b3-</strong><strong>carboxylation</strong> of glutamate residues of clotting factors like <strong>prothrombin</strong> (factor <strong>II</strong>), factors <strong>VII, IX,</strong> and <strong>X</strong>. Warfarin inhibits \u03b3-carboxylation by preventing the conversion of vitamin K to its active hydroquinone form.</p>\n<div class=\"page\" title=\"Page 2363\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Vitamin K deficiency in adults may be seen in patients with liver disease, obstructive jaundice, malabsorption, and prolonged antimicrobial therapy. Vitamin K <strong>deficiency</strong>\u00a0is usually\u00a0<strong>diagnosed</strong> on the basis of an <strong>elevated prothrombin time</strong> or <strong>reduced clotting factors.\u00a0</strong></p>\n<p>Vitamin K deficiency is <strong>treated</strong> with a <strong>parenteral</strong> dose of <strong>10 mg</strong> followed by 5mg (duration depends on the severity of vitamin K deficiency).</p>\n<p>Other options:</p>\n<p>Option A: <strong>Vitamin</strong> <strong>E </strong>is a fat-soluble vitamin. The levels of vitamin E also will get decreased following\u00a0taking weight loss medication that inhibits fat absorption from food. But the symptoms of vitamin E deficiency include <strong>hemolytic anemia</strong> and neuromuscular manifestations.</p>\n<p>Option C: <strong> Vitamin B6 </strong>is a water-soluble vitamin. Drugs that cause vitamin B6 deficiency are isoniazid, hydralazine, cycloserine, penicillamine, and oral contraceptives. Patients usually present with <strong>peripheral neuritis,</strong> anemia, seborrheic dermatitis, glossitis, lowered seizure threshold, or convulsions (due to fall in brain GABA levels).</p>\n<p>Option D: <strong>Vitamin</strong> <strong>D </strong>is a fat-soluble vitamin. Vitamin D levels will also decrease following weight loss medication that inhibits fat absorption from food. Patients with vitamin D deficiency will typically develop <strong>rickets</strong> in children and <strong>osteomalacia</strong> in adults.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman presenting with symptoms of urinary tract infection was prescribed a drug that causes tendon rupture and arthropathy. What is the mechanism of action of the drug?",
    "choices": [
      {
        "id": 1,
        "text": "DNA gyrase inhibition"
      },
      {
        "id": 2,
        "text": "Ribosomal inhibition"
      },
      {
        "id": 3,
        "text": "Cell wall synthesis inhibition"
      },
      {
        "id": 4,
        "text": "Inhibition of folic acid synthesis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the above scenario, the antimicrobial prescribed for <strong>urinary tract infection,</strong> which has a propensity to cause <strong>tendon rupture</strong> and <strong>arthropathy</strong>, is likely to be a <strong>fluoroquinolone</strong>. The mechanism of action of the drug is <strong>DNA gyrase inhibition.</strong></p>\n<p>Normally, during replication, to prevent excessive positive supercoiling of the strands, <strong>DNA gyrase</strong> nicks double-stranded DNA and introduces <strong>negative supercoils.&nbsp;</strong>Fluoroquinolones, by inhibiting DNA gyrase (in <strong>gram-negative</strong> bacteria), result in the production of damaged DNA. This is finally digested by exonucleases, resulting in <strong>bactericidal action.</strong></p>\n<p>Fluoroquinolones inhibit&nbsp;<strong>topoisomerase IV</strong> in <strong>gram-positive</strong> bacteria.</p>\n<p>Fluoroquinolones are used in the treatment of <strong>urinary tract infections</strong>, prostatitis, and gastrointestinal, respiratory infections, and as a&nbsp;<strong>second-line</strong> drug in <strong>anti-tubercular therapy</strong>. They are <strong>avoided</strong> in <strong>children</strong> and <strong>pregnant women</strong>.</p>\n<p>Adverse effects of fluoroquinolones are <strong>arthralgia, t</strong><strong>endon rupture, </strong><em>Clostridium difficile</em> colitis, dysglycemia, prolonged QT interval, rashes, hallucinations, delirium, and seizures.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Ribosomal inhibition</strong> is the mechanism of action of various antimicrobials like <strong>tetracyclines, aminoglycosides, chloramphenicol, and macrolides</strong>.</p>\n<p>Option C: <strong>Cell wall synthesis inhibition</strong> is done by <strong>beta-lactam antibiotics</strong>.</p>\n<p>Option D: <strong>Inhibition of folic acid synthesis</strong> is the mechanism of action of <strong>sulfonamides</strong> and <strong>co-trimoxazole</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient was brought to the emergency with a history of consumption of 8 tablets of digoxin. On examination, he was unstable and his heart rate was 56 bpm. ECG showed a 3rd-degree heart block. What is the next step in the management of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Antibody against digoxin"
      },
      {
        "id": 2,
        "text": "Lidocaine"
      },
      {
        "id": 3,
        "text": "DC cardioversion"
      },
      {
        "id": 4,
        "text": "Phenytoin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Administration of <strong>digibind</strong>\u00a0(<strong>antibody against digoxin</strong>) is the next step in managing\u00a0this patient. An <strong>unstable</strong> patient with <strong>bradycardia</strong> and <strong>3rd-degree</strong> heart block following <strong>digoxin toxicity</strong> should be treated with digibind.</p>\n<p><strong>Digibind</strong> is a nonimmunogenic antibody used to treat cardiotoxicity due to digoxin. It is <strong>nonimmunogenic</strong> because it <strong>lacks</strong> the <strong>Fc</strong> fragment.</p>\n<p><strong>Digoxin</strong> is the cardiac glycoside used to <strong>treat heart failure</strong> and control ventricular rate in <strong>atrial fibrillation/flutter.</strong></p>\n<p>It <strong>inhibits</strong>\u00a0<strong>Na<sup>+</sup>/K<sup>+\u00a0</sup>ATPase</strong>, a membrane-bound transporter to increase intracellular sodium. As a result, there is less expulsion of calcium from the cell by the sodium-calcium exchanger (<strong>NCX).\u00a0Increased calcium</strong> inside the myocyte leads to<strong>\u00a0</strong>an<strong> increase\u00a0</strong>in cardiac <strong>contractility.</strong></p>\n<p>The most common cardiac manifestations of digitalis toxicity are <strong>ventricular tachycardia,</strong> partial to <strong>complete A-V block</strong>, <strong>severe bradycardia</strong>, and atrial fibrillation/flutter.</p>\n<p>Factors that <strong>increase</strong> the <strong>risk</strong> of digoxin <strong>toxicity</strong> are:</p>\n<ul>\n<li><strong>Hypokalemia</strong></li>\n<li><strong>Drugs</strong> that decrease digoxin elimination (<strong>inhibitors of P-glycoprotein</strong>) like <strong>quinidine</strong></li>\n<li>Renal/hepatic failure</li>\n<li>Thyrotoxicosis</li>\n</ul>\n<p>Option B: <strong>Lidocaine</strong> is commonly used as a local anesthetic. It has <strong>anti-arrhythmic</strong> properties and is used to suppress<strong> ventricular tachycardia</strong>\u00a0<strong>caused</strong> by <strong>digitalis toxicity</strong>.</p>\n<p>Option C: <strong>DC cardioversion</strong> is used for tachyarrythmias when pharmacologic treatment fails. It is not used in bradyarrhythmias.</p>\n<p>Option D: <strong>Phenytoin </strong>is an <strong>antiepileptic</strong> used for the treatment of generalized tonic-clonic seizures and partial seizures. It can also be used for the treatment of <strong>polymorphic ventricular tachycardia</strong> due to QT prolongation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly man, who is a known case of diabetic nephropathy, presented to the emergency with palpitations and chest discomfort. ECG showed tall T-waves. Laboratory investigations showed elevated potassium levels. Which of the following drugs will cause the shift of potassium back into the cell?",
    "choices": [
      {
        "id": 1,
        "text": "Epinephrine"
      },
      {
        "id": 2,
        "text": "Glucagon"
      },
      {
        "id": 3,
        "text": "Atropine"
      },
      {
        "id": 4,
        "text": "Lactic acid"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Hyperkalemia is a medical emergency and has to be treated when ECG changes are present or severe hyperkalemia (serum K<sup>+</sup> &gt;6.5) without ECG changes. Management is as follows:</p>\n<ul>\n<li>Intravenous infusion of 10 ml of 10% <strong>calcium gluconate</strong> for 2-3 minutes with cardiac monitoring. It helps to antagonize the cardiac effects.</li>\n<li>Intravenous regular<strong> insulin</strong> 10 units followed by 50mL of 50 % <strong>dextrose</strong>. This helps in <strong>shifting</strong> the <strong>plasma</strong> <strong>K</strong><sup>+</sup> into the cells.</li>\n<li><strong>Nebulisation</strong> with&nbsp;<strong>&beta;<sub>2&nbsp;</sub>agonists</strong> such as albuterol or salbutamol.</li>\n<li><strong>Cation exchange resins</strong>, <strong>diuretics,</strong> and/or<strong> dialysis</strong> are useful to remove the excess potassium.&nbsp;</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a1895eaf52fb4c3d8d913d05be51e13dx1279x1256.JPEG"
    ]
  },
  {
    "text": "A patient with a pituitary tumor that overproduced growth hormone underwent surgical removal of the tumor. The resection was found to be incomplete. What is the first-line treatment for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Leuprolide"
      },
      {
        "id": 2,
        "text": "Goserelin"
      },
      {
        "id": 3,
        "text": "Nafarelin"
      },
      {
        "id": 4,
        "text": "Octreotide"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above scenario with a <strong>pituitary tumor</strong> producing <strong>growth hormone</strong> is likely to cause&nbsp;<strong>acromegaly&nbsp;</strong>in the patient. <strong>Octreotide</strong> is the <strong>first-line</strong> treatment for this condition.</p>\n<p>Octreotide is a <strong>synthetic analog</strong> of<strong> somatostatin</strong>.</p>\n<p>Octreotide can be used in the following conditions:</p>\n<ul>\n<li><strong>Acromegaly </strong></li>\n<li><strong>Secretory diarrheas</strong> associated with carcinoid, AIDS, cancer chemotherapy, or diabetes- by suppression of hormones that enhance intestinal mucosal secretion.</li>\n<li><strong>Bleeding</strong> esophageal<strong> varices-</strong>&nbsp;reduces hepatic blood flow and helps stop bleeding.</li>\n<li><strong>Dumping syndrome</strong> in post gastric surgery patients</li>\n</ul>\n<p><strong>Adverse effects</strong> of octreotide are:</p>\n<ul>\n<li>Abdominal pain</li>\n<li>Nausea</li>\n<li><strong>Steatorrhea</strong></li>\n<li><strong>Gall stones</strong> (due to biliary stasis)</li>\n<li>Hyperglycemia</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Leuprolide</strong> is a long-acting GnRH agonist. It is used for palliation of <strong>carcinoma prostate,</strong> uterine fibroids, endometriosis, and precocious puberty. Side effects include hot flashes, decreased bone mineral density, vaginal dryness, and erectile dysfunction.</p>\n<p>Option B: <strong>Goserelin</strong> is also a GnRH agonist used for the treatment of <strong>endometriosis,</strong> dysfunctional uterine bleeding, and for prostate and breast cancer.</p>\n<p>Option C: <strong>Nafarelin</strong> is a long-acting GnRH agonist. It is used for the treatment of endometriosis, uterine fibroids, and <strong>central precocious puberty.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged male patient presents with protrusion of the chin, excessive sweating, impaired glucose tolerance, and enlargement of hands and feet. Which of the following is a growth hormone receptor antagonist used to treat this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Octreotide"
      },
      {
        "id": 2,
        "text": "Pegvisomant"
      },
      {
        "id": 3,
        "text": "Cabergoline"
      },
      {
        "id": 4,
        "text": "Olcegepant"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical features of <strong>protrusion</strong> of the<strong> chin, excessive sweating, impaired glucose tolerance, </strong>and<strong> enlargement</strong> of<strong> hands</strong> and<strong> feet</strong> are suggestive of <strong>acromegaly.&nbsp;Pegvisomant </strong>is a<strong> growth hormone receptor antagonist</strong> used to treat this condition.</p>\n<p>Acromegaly is commonly caused due to growth hormone-secreting<strong> somatotroph adenoma. </strong>It occurs secondary to mutations of the pituitary-specific gene <strong>PIT-1. </strong></p>\n<p>Patients present with <strong>f</strong><strong>rontal bossing, i</strong><strong>ncreased hand and foot size, </strong>mandibular enlargement with <strong>prognathism, </strong>widened space between the lower incisor teeth, soft tissue swelling resulting in increased heel pad thickness, coarse facial features, and large fleshy nose.</p>\n<p>Serum<strong> IGF-1</strong> levels (elevated) and <strong>GH suppression test</strong> with oral <strong>glucose</strong> are useful in the <strong>diagnosis.</strong> The levels of GH do not reduce in response to the oral glucose load.&nbsp;</p>\n<p>Transsphenoidal surgical resection of the tumor, octreotide, and <strong>pegvisomant</strong> will be helpful in the management of this condition.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Octreotide</strong> is a synthetic <strong>analog </strong>of<strong> somatostatin</strong>. It is used for the treatment of <strong>acromegaly</strong> and <strong>secretory diarrhea.</strong></p>\n<p>Option C: <strong>Cabergoline</strong> is a dopamine <strong>D2</strong> receptor <strong>agonist.</strong> It is used as a first-line drug for the treatment of <strong>hyperprolactinemia.</strong></p>\n<p>Option D: <strong>Oglcegepant</strong> is a calcitonin gene-related peptide (<strong>CGRP</strong>) <strong>antagonist.</strong> It is used for the treatment of <strong>migraine.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A diabetic patient presented with rhinitis and facial swelling. An intranasal biopsy revealed the presence of broad-based aseptate hyphae with branching at right angle. Evidence of vascular invasion was present.  What will be the drug of choice for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Fluconazole"
      },
      {
        "id": 2,
        "text": "Amphotericin B"
      },
      {
        "id": 3,
        "text": "Ketoconazole"
      },
      {
        "id": 4,
        "text": "Griseofulvin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Treatment of the infection includes 4 steps:</p>\n<ol>\n<li>Initiation of therapy <strong>(amphotericin</strong> <strong>B</strong>) as early as possible.</li>\n<li><strong>Surgical</strong> debridement.</li>\n<li><strong>Reversal</strong> of underlying conditions and <strong>risk factors.</strong></li>\n<li><strong>Treatment</strong> of underlying <strong>malignancy</strong> if present.</li>\n</ol>\n<p><strong>Amphotericin B</strong>&nbsp;binds to <strong>ergosterol</strong> in the fungal membrane and forms <strong>pores or channels</strong> in the<strong> fungal cell membrane</strong>. This allows the leakage of cytosolic molecules and ions, leading to a loss of membrane integrity.</p>\n<p>It is a <strong>broad-spectrum antifungal</strong> that can be used against<em> Candida albicans, Cryptococcus neoformans, Blastomyces dermatitidis, Histoplasma capsulatum, Sporothrix schenckii,&nbsp;</em><em>Coccidioides immitis, Aspergillus.</em></p>\n<p><strong>Amphotericin B</strong> also has <strong>antiprotozoal</strong> action along with antifungal properties and is effective against <strong><em>Leishmania.</em></strong></p>\n<p><strong>Adverse effects</strong> of amphotericin B:</p>\n<ul>\n<li>Infusion-related fever and chills</li>\n<li><strong>Azotemia/nephrotoxicity</strong>- all lipid formulations of amphotericin B are less nephrotoxic than conventional amphotericin B</li>\n<li><strong>Renal tubular acidosis&nbsp;</strong></li>\n<li>Renal wasting of potassium and magnesium</li>\n<li>Hypochromic normocytic anemia- due to decreased erythropoietin production from the kidney</li>\n</ul>\n<p>Note: Mucormycosis recently emerged as an important <strong>superinfection</strong> in <strong>COVID-19</strong> patients, especially in India. The surge in cases is most likely due to diabetes mellitus and steroid use.</p>\n<p>Other options:</p>\n<p><span data-preserver-spaces=\"true\"><span class=\"s1\">Option A: <strong>Fluconazole </strong>is used for the treatment of <strong>candidiasis</strong>&nbsp;and cryptococcosis.<br /></span></span></p>\n<p><span data-preserver-spaces=\"true\"><span class=\"s1\">Option C: <strong>Ketoconazole </strong>is used for both <strong>dermatophytosis</strong> and deep mycosis, but it has been replaced by <strong>itraconazole</strong>.<br /></span></span></p>\n<p><span data-preserver-spaces=\"true\"><span class=\"s1\">Option D: <strong>Griseofulvin</strong></span></span> is used for <strong>dermatophytosis.</strong> It is effective against the mycotic disease of the skin, hair, and nails due to <em>Microsporum, Trichophyton,</em> and <em>Epidermophyton.</em></p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d2ce95171f29405e8b920760512c5d76x800x600.JPEG"
    ]
  },
  {
    "text": "A tuberculosis patient on anti-tubercular treatment presents with a tingling sensation and paresthesia in the lower limbs. He is not a diabetic and occasionally consumes alcohol. Which of the following vitamins must be supplemented to this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Vitamin B6"
      },
      {
        "id": 2,
        "text": "Vitamin B12"
      },
      {
        "id": 3,
        "text": "Vitamin B2"
      },
      {
        "id": 4,
        "text": "Vitamin B3"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Vitamin B6</strong> must be supplemented for this patient. The clinical features of <strong>tingling sensation</strong> and <strong>paresthesias</strong> in a patient on anti-tubercular treatment are suggestive of the adverse effect of <strong>isoniazid</strong>.</p>\n<p><strong>Isoniazid</strong> is the first-line antitubercular drug that inhibits the production of <strong>mycolic acid</strong>. It is a bactericidal drug against tubercle bacilli.</p>\n<p>Adverse effects of isoniazid:</p>\n<ul>\n<li><strong>Peripheral neuritis </strong>(<strong>paresthesias</strong>, numbness, <strong>tingling sensation</strong>) due to interference with the production of active coenzyme pyridoxal phosphate from pyridoxine. Therefore, <strong>pyridoxine 10 mg/day (vitamin B6)</strong> is given prophylactically along with isoniazid to prevent neurotoxicity.</li>\n<li><strong>Hepatitis</strong> - isoniazid must be stopped at the first sign of hepatotoxicity.</li>\n<li>Rashes</li>\n<li>Anemia</li>\n<li>Arthralgia</li>\n</ul>\n<p>Toxicity of isoniazid results in <strong>metabolic acidosis</strong> and <strong>seizures</strong>.&nbsp;</p>\n<p>Note: Vitamin deficiency in alcoholics includes the following:</p>\n<ul>\n<li><strong>Folate</strong> causes megaloblastic anemia. It is treated by supplementation of oral doses of 5-15 mg of folic acid.</li>\n<li><strong>Vitamin B6</strong> results in peripheral neuritis, anemia, and glossitis, and lowers the seizure threshold. It is treated by supplementation of oral doses of 2-5 mg of pyridoxine.</li>\n<li><strong>Thiamine</strong> results in Wernicke's encephalopathy. It is treated with 200 mg of intravenous thiamine three times daily, followed by 10 mg/day until complete recovery.</li>\n<li><strong>Vitamin</strong> <strong>A</strong> results in xerophthalmia and night blindness. It is treated with supplementation of oral vitamin A 3000-5000 IU/day.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly woman received a botox injection for the treatment of wrinkles. Which of the following is the mechanism of action of botulinum toxin?",
    "choices": [
      {
        "id": 1,
        "text": "Inhibits the release of acetylcholine"
      },
      {
        "id": 2,
        "text": "Release of noradrenaline at synaptic cleft"
      },
      {
        "id": 3,
        "text": "Selectively and irreversibly inhibits nicotinic receptors"
      },
      {
        "id": 4,
        "text": "Stimulates muscarinic and nicotinic receptors"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This toxin causes a long-lasting loss of cholinergic transmission. Hence, it can be employed for the treatment of several spastic and neurological conditions caused by the overactivity of cholinergic nerves, such as&nbsp;<strong>age-related facial wrinkles,&nbsp;</strong>blepharospasm, <strong>spastic cerebral palsy</strong>, spasmodic torticollis<strong>, post-stroke spasticity</strong>, and axillary hyperhidrosis.</p>\n<p>Adverse effects occur due to incorrect injection and overdose; they include <strong>ptosis, </strong>diplopia, facial swelling, dry mouth, <strong>muscle weakness,</strong> and<strong> respiratory paralysis.</strong></p>\n<p>Botulinum toxin is an <strong>exotoxin</strong> produced by the bacteria <em>Clostridium botulinum</em>. It is responsible for a type of food poisoning called <strong>botulism</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/679a402efdee47c7b4fd3adaa70f4af1x1280x2234.JPEG"
    ]
  },
  {
    "text": "Which of the following is a PCSK9 inhibitor?",
    "choices": [
      {
        "id": 1,
        "text": "Evolocumab"
      },
      {
        "id": 2,
        "text": "Ezetimibe"
      },
      {
        "id": 3,
        "text": "Bempedoic acid"
      },
      {
        "id": 4,
        "text": "Clofibrate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Evolocumab</strong> is a <strong>PCSK9</strong> inhibitor.</p>\n<p>PCSK9 refers to <span class=\"ILfuVd\" lang=\"en\"><span class=\"hgKElc\"><strong>proprotein convertase subtilisin/kexin type 9</strong></span></span>. They are mainly involved in the downregulation of low-density lipoprotein (<strong>LDL</strong>) receptors in the liver.</p>\n<p><strong>Evolocumab</strong> is a monoclonal antibody that inhibits<strong> PCSK-9&nbsp;</strong>(proprotein convertase subtilisin/kexin). Inhibition of PCSK-9 prevents the degradation of LDL receptors and thus <strong>increases LDL-cholesterol clearance</strong> by the <strong>liver</strong>. They are used in patients with atherosclerotic cardiovascular disease (<strong>ASCVD</strong>) to decrease LDL levels.</p>\n<p>Side effects of PCSK9 inhibitors are <strong>i</strong><strong>njection-site reactions, </strong>nasopharyngitis, urinary tract infection, and upper respiratory tract infection and it does <strong>not</strong> increase the risk of <strong>myopathy</strong>.&nbsp;</p>\n<p>Other options:</p>\n<p>Option B: <strong>Ezetimibe</strong> inhibits cholesterol <strong>absorption</strong> by enterocytes in the small intestine. It lowers the total and LDL-C levels.</p>\n<p>Option C: <strong>Bempedoic acid</strong> <span class=\"ILfuVd\" lang=\"en\"><span class=\"hgKElc\">inhibits adenosine triphosphate-<span tabindex=\"0\" role=\"tooltip\"><span class=\"povykd\" style=\"display: inline-block;\" tabindex=\"0\" role=\"button\" data-enable-toggle-animation=\"true\" data-extra-container-classes=\"ZLo7Eb\" data-hover-hide-delay=\"1000\" data-hover-open-delay=\"500\" data-send-open-event=\"true\" data-theme=\"0\" data-width=\"250\" data-ved=\"2ahUKEwiM5bPV9dD4AhUO9zgGHe8oCMIQmpgGegQIBRAD\"><span class=\"JPfdse\" data-bubble-link=\"\" data-segment-text=\"citrate lyase\">citrate lyase</span></span></span> (ACL) and results in <strong>decreased LDL </strong>in patients not responding to statin therapy. <br /></span></span></p>\n<p>Option D: <strong>Clofibrate</strong> binds to <strong>PPAR-alpha</strong> and causes stimulation of fatty acid oxidation and increased LPL synthesis. This results in reduced triglycerides, LDL and increased high-density lipoprotein (HDL) levels. It causes <strong>myopathy</strong> when combined with statins and is associated with an increased risk of <strong>gallstone</strong> formation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly man presents with rigidity and tremors. On examination, he has blank facial expressions. Which of the following drugs can be used to manage this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Clozapine"
      },
      {
        "id": 2,
        "text": "Donepezil"
      },
      {
        "id": 3,
        "text": "Selegiline"
      },
      {
        "id": 4,
        "text": "Haloperidol"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical features of <strong>rigidity, tremors,</strong>&nbsp;and <strong>blank facial expressions</strong> are suggestive of <strong>Parkinson's disease</strong>. Monoamine oxidase-B (<strong>MAO-B</strong>) <strong>inhibitors</strong> like <strong>selegiline</strong> are used for the treatment of Parkinson disease.</p>\n<p>Normally, MAO-B oxidizes dopamine. Selegiline is a selective and irreversible MAO-B inhibitor. Therefore, it&nbsp;<strong>increases dopamine</strong> levels in the brain. It is used as an <strong>adjuvant</strong> to <strong>levodopa</strong> in Parkinson's disease. It prolongs and enhances the action of levodopa.</p>\n<p>Adverse effects of selegiline are <strong>postural hypotension, </strong>nausea, confusion, involuntary movements, and <strong>psychosis. </strong>Selegiline is <strong>contraindicated</strong> in patients with <strong>convulsive</strong> disorders.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Clozapine </strong>is an atypical antipsychotic that selectively <strong>blocks</strong> dopamine (<strong>D4</strong>) receptors in the brain. It is used in the treatment of&nbsp;<strong>refractory schizophrenia</strong>. <strong>Agranulocytosis</strong> and <strong>metabolic syndrome</strong> are the important <strong>adverse effects.</strong></p>\n<p>Option B: <strong>Donepezil</strong> is a reversible <strong>cholinesterase inhibitor</strong> used for the treatment of <strong>Alzheimer's disease</strong>.</p>\n<p>Option D: <strong>Haloperidol </strong>is a <strong>typical antipsychotic</strong> used for the treatment of <strong>acute schizophrenia</strong>, Huntington&rsquo;s disease, and Gilles de la Tourette syndrome.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '056 Pharmacology Neet 2022';
        let hierarchy = ["Marrow", "PYQs", "Pharmacology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>