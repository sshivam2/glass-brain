<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08  Miscellaneous - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        DAMS / DQB / Anesthesia
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">31</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "id": 50000,
    "choices": [
      {
        "id": 200000,
        "text": "Corneal abrasions"
      },
      {
        "id": 200001,
        "text": "Ischemic optic neuropathy"
      },
      {
        "id": 200002,
        "text": "Central retinal artery occlusion"
      },
      {
        "id": 200003,
        "text": "Ptosis"
      }
    ],
    "text": "Most common ophthalmological complication during anaesthesia is",
    "unique_key": "Q5886948",
    "question_audio": null,
    "question_video": null,
    "map_id": 34242689,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Corneal abrasions The most common ophthalmological complication during anesthesia is corneal abrasions. These occur when the cornea is exposed to mechanical trauma, often due to the inability to blink or excessive dryness of the eye during general anesthesia. The eyelids typically remain open during anesthesia, and without reflexive blinking, the cornea is more vulnerable to abrasion, especially if the eyes are not adequately lubricated or protected with eye ointments or pads. This condition is often self-limiting but can cause discomfort and, in rare cases, lead to infection if not treated properly. Incorrect Answers: B. Ischemic optic neuropathy Ischemic optic neuropathy (ION) is a serious condition that involves damage to the optic nerve due to insufficient blood flow. While this can occur after surgery, it is much less common during anesthesia compared to corneal abrasions. Factors such as long surgeries, prone positioning, or significant blood loss can increase the risk, but it is a rare complication overall. It usually manifests as vision loss, and while it may be linked to anesthesia in some cases, it is not the most frequent complication. C. Central retinal artery occlusion Central retinal artery occlusion (CRAO) is another serious ophthalmological complication, but it is very uncommon during anesthesia. CRAO occurs when the central retinal artery becomes blocked, leading to sudden, severe vision loss. Although factors such as hypotension or embolic events during surgery may predispose someone to CRAO, it is a rare occurrence in the perioperative period and less frequent than corneal abrasions. D. Ptosis Ptosis, or drooping of the eyelid, can result from nerve injury or muscle weakness, but it is not a common complication of anesthesia. While ptosis may be seen in cases where there is damage to the oculomotor nerve or muscle fatigue due to positioning during surgery, it is a less frequent event than corneal abrasions. Ptosis typically resolves after the anesthesia wears off or if treated conservatively, and is not considered one of the primary ophthalmological concerns during anesthesia.",
    "correct_choice_id": 200000,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/28090191698562937/28090191698562937.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/28090191698562937/28090191698562937.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50001,
    "choices": [
      {
        "id": 200004,
        "text": "50ml/hr"
      },
      {
        "id": 200005,
        "text": "25ml/hr"
      },
      {
        "id": 200006,
        "text": "65ml/hr"
      },
      {
        "id": 200007,
        "text": "100ml/hr"
      }
    ],
    "text": "The maintenance fluid requirement for 25 kg child undergoing surgery will be",
    "unique_key": "Q2539136",
    "question_audio": null,
    "question_video": null,
    "map_id": 34688079,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) 65ml/hr The correct maintenance fluid requirement for a 25 kg child undergoing surgery is 65 ml/hr. Maintenance fluid calculations are typically based on the child's weight, and the general formula used is 4 ml per kg for the first 10 kg, 2 ml per kg for the next 10 kg, and 1 ml per kg for each kg thereafter. For a 25 kg child, the total maintenance fluids are calculated as follows: 4 ml/kg for the first 10 kg = 40 ml 2 ml/kg for the next 10 kg = 20 ml 1 ml/kg for the remaining 5 kg = 5 ml This gives a total of 65 ml/hr, which is the correct maintenance fluid rate for this child. Incorrect Answers: A. 50 ml/hr 50 ml/hr is an incorrect option because it underestimates the child's fluid requirements. If we apply the maintenance fluid formula, the required fluids for a 25 kg child should be 65 ml/hr, not 50 ml/hr. This could lead to insufficient hydration during the surgical procedure. B. 25 ml/hr 25 ml/hr is too low for a 25 kg child. According to the formula for maintenance fluids, this would be inadequate for a child of this weight and could result in dehydration or an electrolyte imbalance if the fluid volume is not sufficient. D. 100 ml/hr 100 ml/hr is also too high for a 25 kg child. While it may seem reasonable for a larger child, the maintenance fluid requirement for a 25 kg child is closer to 65 ml/hr, not 100 ml/hr. Administering too much fluid can lead to fluid overload, which may increase the risk of complications during surgery, such as pulmonary edema.",
    "correct_choice_id": 200006,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/22980471698562952/22980471698562952.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/22980471698562952/22980471698562952.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50002,
    "choices": [
      {
        "id": 200008,
        "text": "Supine position"
      },
      {
        "id": 200009,
        "text": "Prone position"
      },
      {
        "id": 200010,
        "text": "Park bench position"
      },
      {
        "id": 200011,
        "text": "Sitting position"
      }
    ],
    "text": "Risk of air embolism is greatest with",
    "unique_key": "Q9794655",
    "question_audio": null,
    "question_video": null,
    "map_id": 34091604,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (D) Sitting position The risk of air embolism is greatest in the sitting position. This occurs because the head and thorax are positioned higher than the heart in the sitting posture, which allows air to more easily enter the venous system. If there is a breach in a vein, such as during central venous catheter placement or certain surgical procedures, the gravitational pull can cause air to be drawn into the circulation. This can lead to air embolism, which is a potentially life-threatening condition. Therefore, the sitting position poses the highest risk for air embolism. Incorrect Answers: A. Supine position The supine position (lying flat on the back) is associated with a relatively low risk of air embolism because the venous system is not exposed in a way that would allow air to easily enter the bloodstream. In this position, gravity does not facilitate the entry of air into the veins, making the risk lower compared to other positions like sitting. B. Prone position The prone position (lying on the stomach) is also not associated with a high risk of air embolism. While air embolism can still theoretically occur in any position, the prone posture is not one where the heart and head are elevated above the venous system, as in the sitting position. The risk of air entering the veins is lower when the body is in a prone position. C. Park bench position The park bench position (where the patient is lying on their side with the upper body elevated) does increase the risk of air embolism slightly compared to supine or prone positions, but it is not as high as the sitting position. The park bench position places the venous system in a more neutral alignment, with the heart and head not as elevated, which reduces the likelihood of air being drawn into the venous circulation.",
    "correct_choice_id": 200011,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/3703211698562966/3703211698562966.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/3703211698562966/3703211698562966.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50003,
    "choices": [
      {
        "id": 200012,
        "text": "Infants have a smaller tongue"
      },
      {
        "id": 200013,
        "text": "Glottic inlet is higher"
      },
      {
        "id": 200014,
        "text": "Narrowest part is just below the cricoid ring"
      },
      {
        "id": 200015,
        "text": "Oxygen demand is lower than adult"
      }
    ],
    "text": "Neonatal Vs adult true is:",
    "unique_key": "Q1940599",
    "question_audio": null,
    "question_video": null,
    "map_id": 34357825,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Glottic inlet is higher In neonates, the glottic inlet is higher compared to adults. This anatomical difference is important because it affects airway management, particularly during intubation. The higher position of the glottis in neonates (located at the level of the C3-C4 vertebrae, compared to C4-C5 in adults) makes visualization during intubation more challenging and requires adjustments in technique. Understanding this difference is crucial for clinicians to avoid complications during airway management in neonates. Incorrect Answers: A. Infants have a smaller tongue This statement is incorrect. Infants actually have a relatively larger tongue in proportion to their airway compared to adults. This can make airway management more difficult, as the larger tongue can obstruct the airway more easily during procedures like intubation. Therefore, the size of the tongue in infants should be considered when assessing the potential for airway obstruction. C. Narrowest part is just below the cricoid ring This is incorrect as well. In neonates, the narrowest part of the airway is at the level of the cricoid cartilage, which is different from adults, where the narrowest part is typically at the level of the glottis. This anatomical variation in the neonatal airway affects both the difficulty of intubation and the approach for airway management, as the cricoid ring is more rigid in neonates than in adults. D. Oxygen demand is lower than adult This statement is incorrect. Neonates actually have a higher oxygen demand per kilogram of body weight compared to adults. This is due to their higher metabolic rate, rapid growth, and need for energy. As a result, neonates are more susceptible to hypoxia, and their oxygen consumption must be closely monitored during surgery or anesthesia. Therefore, their oxygen demand is higher, not lower, than that of adults.",
    "correct_choice_id": 200013,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/30206281698562980/30206281698562980.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/30206281698562980/30206281698562980.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50004,
    "choices": [
      {
        "id": 200016,
        "text": "Malposition of double lumen tube"
      },
      {
        "id": 200017,
        "text": "Increased shunt fraction"
      },
      {
        "id": 200018,
        "text": "Collapse of one lung"
      },
      {
        "id": 200019,
        "text": "Soiling of lung by secretions"
      }
    ],
    "text": "The most common cause of hypoxia during one lung ventilation is:",
    "unique_key": "Q6528251",
    "question_audio": null,
    "question_video": null,
    "map_id": 34308779,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Increased shunt fraction The most common cause of hypoxia during one-lung ventilation (OLV) is increased shunt fraction. In OLV, one lung is ventilated while the other is intentionally non-ventilated or collapsed. The non-ventilated lung may still receive blood flow, leading to a right-to-left shunt where deoxygenated blood bypasses the lungs and enters the systemic circulation, causing hypoxia. This increased shunt fraction is the most frequent reason for hypoxemia during OLV, as the blood that bypasses the ventilated lung is not oxygenated properly. Incorrect Answers: A. Malposition of double lumen tube While malposition of the double-lumen endotracheal tube (DLT) can lead to complications such as inadequate isolation of the lungs or incorrect lung ventilation, it is not the most common cause of hypoxia during OLV. If the tube is mispositioned, it may lead to ventilation of both lungs or insufficient ventilation of the intended lung, but this is less common compared to the physiological issue of increased shunt fraction. C. Collapse of one lung The collapse of one lung is usually a part of the intended management during OLV, especially for thoracic surgeries. It does not typically cause hypoxia on its own unless the collapsed lung is not adequately isolated, or there is a significant problem like atelectasis or obstruction. While collapse of the lung can contribute to hypoxia, increased shunt is a more common and significant factor in causing hypoxemia. D. Soiling of lung by secretions Soiling of the lung by secretions can occur during OLV, especially if there is poor management of airway protection. However, it is not the most common cause of hypoxia. Hypoxia during OLV is primarily due to increased shunt fraction, while soiling generally causes complications like aspiration pneumonia, which may contribute to respiratory distress but is less likely to be the immediate cause of hypoxia compared to shunting.",
    "correct_choice_id": 200017,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/898601698562999/898601698562999.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/898601698562999/898601698562999.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50005,
    "choices": [
      {
        "id": 200020,
        "text": "Hyperthermia"
      },
      {
        "id": 200021,
        "text": "DIC"
      },
      {
        "id": 200022,
        "text": "Resistance to relaxants"
      },
      {
        "id": 200023,
        "text": "Respiratory acidosis"
      }
    ],
    "text": "Malignant hyperthermia is not associated with:",
    "unique_key": "Q1253316",
    "question_audio": null,
    "question_video": null,
    "map_id": 34651729,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Resistance to relaxants Malignant hyperthermia (MH) is not associated with resistance to relaxants. In fact, MH is characterized by an abnormal response to certain anesthetic agents, specifically volatile anesthetics (such as halothane) and depolarizing muscle relaxants (like succinylcholine). During an MH crisis, the body's muscle metabolism becomes dramatically elevated, leading to hyperthermia and other systemic changes, but it does not involve resistance to muscle relaxants. Typically, muscle relaxants like non-depolarizing agents are still effective during an MH crisis, although the patient\u2019s overall response to anesthesia becomes unstable. Incorrect Answers: A. Hyperthermia Hyperthermia is a hallmark of malignant hyperthermia. The disorder causes a drastic increase in body temperature due to an uncontrolled increase in skeletal muscle metabolism. This increase in heat production overwhelms the body's ability to dissipate it, resulting in hyperthermia, which is one of the key signs of MH. Thus, hyperthermia is indeed associated with malignant hyperthermia. B. DIC (Disseminated Intravascular Coagulation) Disseminated intravascular coagulation (DIC) is often associated with malignant hyperthermia. The hypermetabolic state caused by MH leads to widespread muscle breakdown, release of inflammatory mediators, and activation of the clotting cascade. This can result in clot formation throughout the body, leading to the consumption of clotting factors and platelets, which contributes to DIC. Therefore, DIC is a complication that can arise during an MH crisis. D. Respiratory acidosis Respiratory acidosis can also occur during malignant hyperthermia. The increased metabolic activity in the muscles produces excessive carbon dioxide (CO2), which the body may not be able to expel quickly enough, leading to respiratory acidosis. This can be worsened by impaired ventilation due to muscle rigidity and compromised respiratory function. Therefore, respiratory acidosis is indeed associated with malignant hyperthermia.",
    "correct_choice_id": 200022,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/58607911698563020/58607911698563020.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/58607911698563020/58607911698563020.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50006,
    "choices": [
      {
        "id": 200024,
        "text": "Acidosis"
      },
      {
        "id": 200025,
        "text": "High pressure air leak"
      },
      {
        "id": 200026,
        "text": "Aspiration of gastric contents"
      },
      {
        "id": 200027,
        "text": "Nitrous oxide overdose"
      }
    ],
    "text": "Mendelson\u2019s syndrome occurs due to\u2013",
    "unique_key": "Q9577999",
    "question_audio": null,
    "question_video": null,
    "map_id": 34666273,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Aspiration of gastric contents Mendelson's syndrome occurs due to the aspiration of gastric contents into the lungs. This condition is a type of chemical pneumonitis that results from the inhalation of gastric acid and partially digested food, which irritates the lungs and causes inflammation. It is most commonly seen during anesthesia induction when the protective reflexes of the airway are diminished, and the stomach contents are regurgitated and aspirated. The acidic nature of the gastric contents leads to damage to the lung tissue, resulting in severe respiratory complications. Incorrect Answers: A. Acidosis Acidosis is a condition where there is an excess of acid in the body fluids, but it is not the primary cause of Mendelson's syndrome. While acidosis can develop as a consequence of aspiration and lung injury (due to impaired gas exchange and respiratory failure), it is not the direct cause. The primary cause of Mendelson's syndrome is the aspiration of gastric contents, not the acidosis itself. B. High pressure air leak A high-pressure air leak is unrelated to Mendelson's syndrome. This can occur in situations like mechanical ventilation or during certain medical procedures, but it does not lead to aspiration of gastric contents. Mendelson's syndrome specifically involves the inhalation of gastric material, which is a different mechanism. D. Nitrous oxide overdose Nitrous oxide overdose can lead to a variety of symptoms, such as hypoxia, dizziness, and in rare cases, neurologic effects, but it is not the cause of Mendelson's syndrome. The syndrome is primarily linked to aspiration of gastric contents during episodes of regurgitation, especially under anesthesia. Nitrous oxide overdose does not lead to aspiration or cause the chemical pneumonitis seen in Mendelson's syndrome.",
    "correct_choice_id": 200026,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/62263171698563034/62263171698563034.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/62263171698563034/62263171698563034.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50007,
    "choices": [
      {
        "id": 200028,
        "text": "Over dose of inhalational anaesthetic"
      },
      {
        "id": 200029,
        "text": "Circulatory failure"
      },
      {
        "id": 200030,
        "text": "Acid aspiration of stomach contents into the lungs"
      },
      {
        "id": 200031,
        "text": "Renal failure"
      }
    ],
    "text": "the most common cause of death of mother undergoing emergency caesarean section when general anaesthesia is being administered is \u2013",
    "unique_key": "Q9342810",
    "question_audio": null,
    "question_video": null,
    "map_id": 34583290,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Acid aspiration of stomach contents into the lungs The most common cause of death in a mother undergoing an emergency caesarean section under general anesthesia is aspiration of gastric contents into the lungs. This is known as Mendelson's syndrome and is a major risk when anesthesia is administered quickly during emergency situations, where the stomach may not be empty. Aspiration of acidic stomach contents can lead to severe chemical pneumonitis and respiratory failure, which can be fatal if not managed promptly. This complication is a primary concern during emergency cesarean sections when general anesthesia is used, especially if the patient has not been adequately pre-oxygenated or had prophylactic measures against aspiration. Incorrect Answers: A. Overdose of inhalational anaesthetic An overdose of inhalational anesthetics is a serious concern, but it is not the most common cause of maternal death in this scenario. Overdose of anesthetics can lead to deep anesthesia, hypotension, and respiratory depression, but such incidents are less common than aspiration-related complications during emergency caesarean sections. In most cases, proper monitoring and adjustments during anesthesia prevent an overdose from reaching fatal levels. B. Circulatory failure Circulatory failure is another potential cause of death, particularly if there is significant blood loss during the caesarean section or underlying cardiac issues. However, it is not the most common cause of death during general anesthesia for an emergency caesarean section. Blood loss and shock are managed with fluids and transfusion, making circulatory failure less frequent than aspiration events in this context. D. Renal failure Renal failure is not typically an immediate cause of death during an emergency caesarean section under general anesthesia. While renal failure can develop in critically ill patients with prolonged hypotension or sepsis, it is a more distant complication and not usually the direct cause of death in this situation. Aspiration of stomach contents is a much more immediate and common cause of fatality.",
    "correct_choice_id": 200030,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/63151131698563048/63151131698563048.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/63151131698563048/63151131698563048.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50008,
    "choices": [
      {
        "id": 200032,
        "text": "Vertical laparotomy"
      },
      {
        "id": 200033,
        "text": "Horizontal laparotomy"
      },
      {
        "id": 200034,
        "text": "Lateral thoracotomy"
      },
      {
        "id": 200035,
        "text": "Median sternotomy"
      }
    ],
    "text": "Which of the following surgical incisions is associated with the highest risk of postoperative pulmonary complications?",
    "unique_key": "Q2158586",
    "question_audio": null,
    "question_video": null,
    "map_id": 34586811,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Vertical laparotomy A vertical laparotomy is associated with the highest risk of postoperative pulmonary complications. This incision, which is typically made along the midline of the abdomen, can interfere with diaphragmatic movement and lead to impaired lung expansion, which increases the risk of atelectasis, pneumonia, and other respiratory complications after surgery. The incision may also cause pain that restricts deep breathing and coughing, further increasing the likelihood of pulmonary complications. As it involves larger muscle groups and may affect the abdominal and thoracic pressure dynamics, the risk of respiratory issues is higher compared to other types of incisions. Incorrect Answers: B. Horizontal laparotomy A horizontal laparotomy (or Pfannenstiel incision) is less invasive on the diaphragm compared to a vertical laparotomy. While it still carries some risk for postoperative pulmonary complications, it is associated with lower risk than the vertical incision. The muscle groups involved are less extensive, and the incision typically does not compromise diaphragmatic function as much as the vertical one, leading to a reduced risk of pulmonary complications. C. Lateral thoracotomy A lateral thoracotomy, used in procedures such as lung resections or chest surgeries, can lead to significant pulmonary complications, particularly if there is lung tissue manipulation or if the surgery involves a large area of the chest. However, the risk is usually more related to direct lung injury or the need for prolonged mechanical ventilation, rather than the incision itself. It is still associated with a lower incidence of pulmonary complications compared to a vertical laparotomy. D. Median sternotomy A median sternotomy is typically performed in cardiac surgeries. While it can lead to some respiratory complications such as pain and reduced chest wall movement, it does not directly interfere with diaphragmatic function as much as a vertical laparotomy does. The postoperative pulmonary complications associated with sternotomy are generally manageable, and the risk is lower than that associated with a vertical laparotomy.",
    "correct_choice_id": 200032,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/67368581698563061/67368581698563061.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/67368581698563061/67368581698563061.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50009,
    "choices": [
      {
        "id": 200036,
        "text": "Occurs due to traction of intraocular muscles"
      },
      {
        "id": 200037,
        "text": "Most commonly occurs in pediatric pts. Undergoing strabismus surgery."
      },
      {
        "id": 200038,
        "text": "Cholinergic medication is given to prevent it."
      },
      {
        "id": 200039,
        "text": "With repeated traction the reflex is marked leading to VF"
      }
    ],
    "text": "With regard to oculo cardiac reflex which statement is true",
    "unique_key": "Q8378355",
    "question_audio": null,
    "question_video": null,
    "map_id": 34627417,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Most commonly occurs in pediatric patients undergoing strabismus surgery. The oculocardiac reflex (OCR) is most commonly observed in pediatric patients undergoing strabismus surgery. This reflex is triggered by manipulation of the eye or its surrounding tissues, leading to parasympathetic stimulation and resulting in a decrease in heart rate (bradycardia). Strabismus surgery, which involves the manipulation of extraocular muscles, is known to be the procedure most commonly associated with OCR in children. Although it can occur in adults, the reflex is more pronounced and frequent in pediatric patients due to their heightened vagal response. Incorrect Answers: A. Occurs due to traction of intraocular muscles This statement is partially correct, as traction on the extraocular muscles (which control eye movement) during surgery can trigger the oculocardiac reflex. However, the reflex is not caused by traction of the intraocular muscles specifically, but rather by manipulation of the extraocular muscles and surrounding tissues. The reflex involves the parasympathetic pathway, primarily affecting the heart rate. C. Cholinergic medication is given to prevent it Cholinergic medications, such as atropine, are not typically given to prevent the oculocardiac reflex; in fact, atropine is often used to treat it once it occurs by blocking the parasympathetic response and preventing bradycardia. While other methods, such as gentle handling and avoiding excessive traction on the eye, can help minimize the risk, cholinergic agents are not used prophylactically to prevent the reflex. D. With repeated traction the reflex is marked leading to VF While repeated traction can indeed exacerbate the oculocardiac reflex and lead to more pronounced bradycardia or even asystole in extreme cases, it is not typically associated with ventricular fibrillation (VF). The primary consequence of a significant oculocardiac reflex is bradycardia, and while it may lead to more severe cardiac arrhythmias if untreated, VF is not a typical direct consequence. If the reflex is not managed appropriately, it can result in a transient cardiac event, but VF is rare.",
    "correct_choice_id": 200037,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/50305331698563080/50305331698563080.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/50305331698563080/50305331698563080.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50010,
    "choices": [
      {
        "id": 200040,
        "text": "Larynx"
      },
      {
        "id": 200041,
        "text": "T.M. joint"
      },
      {
        "id": 200042,
        "text": "Pharynx"
      },
      {
        "id": 200043,
        "text": "Tongue"
      }
    ],
    "text": "Most common site of injury to airway during anaesthesia is:",
    "unique_key": "Q6945377",
    "question_audio": null,
    "question_video": null,
    "map_id": 34917434,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Larynx The most common site of airway injury during anesthesia is the larynx. The larynx is particularly vulnerable during the insertion of airway devices, such as endotracheal tubes or laryngeal mask airways. Traumatic intubation, improper positioning of the tube, or prolonged pressure on the larynx can lead to injury, which may manifest as hoarseness, laryngeal edema, or even vocal cord damage. Laryngeal injury is a well-recognized complication of anesthesia, especially in cases of difficult intubation or improper technique. Incorrect Answers: B. T.M. joint (Temporomandibular joint) Injury to the temporomandibular (T.M.) joint is not as common as laryngeal injury during anesthesia. While T.M. joint dislocation or damage may occur during procedures involving difficult airway management, it is less frequently encountered compared to laryngeal injuries. The primary concern in airway management is the protection and manipulation of the airway structures, with the larynx being the most susceptible to injury. C. Pharynx While the pharynx can be injured during anesthesia, especially during the insertion of airway devices such as endotracheal tubes or during nasotracheal intubation, pharyngeal injuries are less common compared to laryngeal injuries. Pharyngeal trauma may result from the use of rigid airway devices or improper technique, but the larynx, with its delicate vocal cords and structures, remains the most vulnerable site during airway management. D. Tongue Injury to the tongue during anesthesia is uncommon. The tongue is generally protected during airway procedures, as it is usually retracted gently using an appropriate technique. Though there can be transient injury due to improper positioning of the airway devices, tongue injuries are rare compared to laryngeal injuries, which involve more critical structures in the airway.",
    "correct_choice_id": 200040,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/22716331698563105/22716331698563105.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/22716331698563105/22716331698563105.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50011,
    "choices": [
      {
        "id": 200044,
        "text": "Carbon dioxide"
      },
      {
        "id": 200045,
        "text": "Calcium"
      },
      {
        "id": 200046,
        "text": "Glucose"
      },
      {
        "id": 200047,
        "text": "Heat"
      }
    ],
    "text": "Malignant hyperthermia is caused by abnormal release of",
    "unique_key": "Q1593274",
    "question_audio": null,
    "question_video": null,
    "map_id": 34286649,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Calcium Malignant hyperthermia (MH) is caused by an abnormal release of calcium from the sarcoplasmic reticulum in muscle cells. This excessive calcium release leads to uncontrolled muscle contraction, increased metabolism, and a cascade of metabolic abnormalities, including hyperthermia. The abnormal calcium handling is due to mutations in genes encoding for the ryanodine receptor (RYR1), which is responsible for calcium release during muscle contraction. The sustained muscle contractions and increased metabolism result in the hallmark features of MH, including hyperthermia, muscle rigidity, and acidosis. Incorrect Answers: A. Carbon dioxide Carbon dioxide (CO?) is a product of metabolism, and its accumulation can occur during malignant hyperthermia due to increased muscle activity and metabolic rate. However, carbon dioxide is not the primary cause of the condition. It is a secondary result of the excessive muscle contraction and metabolism associated with MH. The initial pathological event is the abnormal release of calcium, which leads to the metabolic changes, including elevated CO? levels. C. Glucose Glucose is a fuel source for cellular metabolism, but its release is not involved in the pathophysiology of malignant hyperthermia. While glucose metabolism is affected by the increased metabolic demand in MH, it is not the triggering factor. The core issue lies in the abnormal calcium release in the muscles, not in glucose regulation or metabolism. D. Heat Heat is a consequence of the abnormal metabolic processes occurring in malignant hyperthermia, but it is not the cause. The uncontrolled muscle contractions and heightened metabolism generate heat, leading to hyperthermia. The primary cause of MH is the abnormal release of calcium from the sarcoplasmic reticulum, which initiates the hypermetabolic state, not the heat itself.",
    "correct_choice_id": 200045,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/9623991698563121/9623991698563121.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/9623991698563121/9623991698563121.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50012,
    "choices": [
      {
        "id": 200048,
        "text": "Jehovah witness"
      },
      {
        "id": 200049,
        "text": "Hepatic insufficiency"
      },
      {
        "id": 200050,
        "text": "THR"
      },
      {
        "id": 200051,
        "text": "Cerebral aneurysm repair"
      }
    ],
    "text": "Controlled hypotension not indicated in",
    "unique_key": "Q8223778",
    "question_audio": null,
    "question_video": null,
    "map_id": 34195606,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Hepatic insufficiency Induced or controlled hypotension is a method by which the arterial blood pressure is decreased in a predictable and deliberate manner. The intent of deliberate hypotension is to reduce bleeding and thus facilitate surgery and to decrease the amount of blood transfused. Indications: 1: Maxilla facial surgeries 2: Middle ear surgery 3: Neurosurgeries 4: Microvascular surgeries 5: THR \\ TKR 6: Jehovah witness Contraindications: \u2022 Cardiac disease \u2022 Diabetes mellitus \u2022 Gross anemia, hemoglobinopathies, polycythemia \u2022 Hepatic disease \u2022 Intolerance to the drugs available to produce hypotension \u2022 Ischemic cerebrovascular disease \u2022 Renal disease \u2022 Respiratory insufficiency \u2022 Severe systemic hypertension",
    "correct_choice_id": 200049,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/4851381698563139/4851381698563139.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/4851381698563139/4851381698563139.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50013,
    "choices": [
      {
        "id": 200052,
        "text": "Cardiac arrhythmia and ischemia"
      },
      {
        "id": 200053,
        "text": "Decreased peripheral vascular resistance"
      },
      {
        "id": 200054,
        "text": "Reversible platelet dysfunction"
      },
      {
        "id": 200055,
        "text": "Left shift of O2 Hb dissociation curve"
      }
    ],
    "text": "Deleterious effects of hypothermia not true is",
    "unique_key": "Q9303972",
    "question_audio": null,
    "question_video": null,
    "map_id": 34529228,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Decreased peripheral vascular resistance Decreased peripheral vascular resistance is not a deleterious effect of hypothermia. In fact, hypothermia generally causes increased peripheral vascular resistance as the body attempts to conserve heat. The cold causes vasoconstriction in peripheral blood vessels, which helps reduce heat loss from the body. This compensatory mechanism can lead to an increase in blood pressure and workload on the heart. Thus, decreased peripheral vascular resistance is not a typical or harmful effect of hypothermia, making this the correct answer. Incorrect Answers: A. Cardiac arrhythmia and ischemia Hypothermia can indeed cause cardiac arrhythmias and ischemia. As body temperature decreases, the electrical conductivity of the heart becomes altered, leading to a higher risk of arrhythmias, such as bradycardia or ventricular fibrillation. Hypothermia can also lead to myocardial ischemia by reducing blood flow and oxygen delivery to the heart, especially in patients with pre-existing cardiovascular disease. These are well-documented and deleterious effects of hypothermia. C. Reversible platelet dysfunction Platelet dysfunction is a common effect of hypothermia, and it is typically reversible once the body temperature is restored. At lower temperatures, platelet function is impaired, leading to a reduced ability to form clots and an increased risk of bleeding. This dysfunction is temporary and improves with warming, which is why it is considered reversible. Despite being reversible, it is still a significant deleterious effect in the perioperative or trauma setting. D. Left shift of O2 Hb dissociation curve A left shift in the oxygen-hemoglobin dissociation curve is a known consequence of hypothermia. At lower temperatures, hemoglobin's affinity for oxygen increases, making it more difficult for oxygen to be released to tissues. This can impair oxygen delivery to vital organs, particularly in critically ill or injured patients. Although this effect can be harmful, it is a recognized and expected response to hypothermia.",
    "correct_choice_id": 200053,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/73451001698563151/73451001698563151.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/73451001698563151/73451001698563151.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50014,
    "choices": [
      {
        "id": 200056,
        "text": "Fuel"
      },
      {
        "id": 200057,
        "text": "Oxidising agent"
      },
      {
        "id": 200058,
        "text": "Smouldering agent"
      },
      {
        "id": 200059,
        "text": "Secondary ignition source by increasing conductivity of the gas mixture"
      }
    ],
    "text": "A patient is anaesthetised with 50% oxygen, 50% nitrous oxide and 1% sevoflurane for a tracheostomy. When the surgeon cut into the trachea with diathermy, the ETT catches fire. In this case the nitrous oxide is acting as:",
    "unique_key": "Q7431315",
    "question_audio": null,
    "question_video": null,
    "map_id": 34531171,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) \u2022 An airway fire is a fire that occurs within a patient\u2019s airway or involves an in-situ airway device or contiguous breathing circuit \u2022 In order for an airway fire to occur, the essential elements of the classical fire triad must be present: 1. An ignition source: electrocautery and lasers utilised in Ear, Nose and Throat surgeries. Other potential sources are static electricity, heated probes, drills and burrs, argon beam coagulators, fibreoptic light sources and cables, and defibrillator pads and paddles. 2. An oxidiser: supplemental oxygen or nitrous oxide in anaesthetic gases delivered via closed or semi-closed breathing circuits creates an oxidiser-enriched environment within patients\u2019 airways and breathing apparatus 3. A fuel source: The most common source of fuel for airway fires are endotracheal tubes, followed by surgical drapes. - Other sources include alternative airway devices, breathing circuits, scavenging tubes, suction catheters, wound drains, surgical packs, dressings, pledgets, sponges and gauze. 1. Ignition sources include but are not limited to electrosurgery or electrocautery units and lasers. 2. An oxidizer-enriched atmosphere occurs when there is any increase in oxygen concentration above room air level, and/or the presence of any concentration of nitrous oxide. 3. After minimizing delivered oxygen, wait a period of time (e.g., 1-3 min) before using an ignition source. For oxygen dependent patients, reduce supplemental oxygen delivery to the minimum required to avoid hypoxia. Monitor oxygenation with pulse oximetry, and if feasible, inspired, exhaled, and/or delivered oxygen concentration. 4. After stopping the delivery of nitrous oxide, wait a period of time (e.g., 1-3 min) before using an ignition source. 5. Unexpected flash, flame, smoke or heat, unusual sounds ( e.g., a \u201cpop,\u201d snap or \u201cfoomp\u201d) or odors, unexpected movement of drapes, discoloration of drapes or breathing circuit, unexpected patient movement or complaint. 6. In this algorithm, airway fire refers to a fire in the airway or breathing circuit. 7. A CO2 fire extinguisher may be used on the patient if necessary.<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/3(32).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200057,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50015,
    "choices": [
      {
        "id": 200060,
        "text": "Rush the patient to the operating room for urgent craniotomy"
      },
      {
        "id": 200061,
        "text": "Monitor the patient for respiratory depression"
      },
      {
        "id": 200062,
        "text": "Offer epidural blood patch"
      },
      {
        "id": 200063,
        "text": "Reassure the patient that this type of headache is normal after delivery"
      }
    ],
    "text": "A 28-year-old patient G2P2 on a postpartum day 2 complaints about having an \"intense headache.\" The patient reports that the headache started in the morning and describes it as an intense frontal headache, severity 7/10, improves with lying down, worsens with sitting up, accompanied by blurry vision, nausea, and tinnitus, and not relieved by acetaminophen. The patient had an uneventful vaginal delivery at 38 weeks of gestation with continuous epidural infusion for pain management. Which of the following actions is the most appropriate for this patient's current presentation?",
    "unique_key": "Q2977225",
    "question_audio": null,
    "question_video": null,
    "map_id": 34105646,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Offer epidural blood patch \u2022 Accidental dural puncture with an epidural needle when attempting catheter placement in the epidural space is a complication of the procedure. \u2022 Post-dural puncture headache (PDPH) can occur as a consequence. \u2022 Epidural blood patch consists of the injection of autologous blood on the epidural space and has been proven effective on PDPH treatment. \u2022 Patients receiving neuraxial anesthesia with opioids should always be monitored for respiratory depression. \u2022 Subdural hematoma should also be considered in this patient but rushing her to the operating room for craniotomy would not be the most appropriate next action",
    "correct_choice_id": 200062,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50016,
    "choices": [
      {
        "id": 200064,
        "text": "Foreign body aspiration"
      },
      {
        "id": 200065,
        "text": "4.5 were too small for the patient"
      },
      {
        "id": 200066,
        "text": "Funnel shaped paediatric larynx"
      },
      {
        "id": 200067,
        "text": "Chronic lung disease"
      }
    ],
    "text": "A 3-year-old male is about to be intubated in the emergency room who has been admitted with status asthmaticus. The child has a history of being born at 26 weeks gestation, chronic lung disease on inhaled steroids twice a day and albuterol nebulizers as needed, and seasonal allergies on montelukast. His condition is worsening, and the bedside nurse calls for help. The bedside nurse pushes induction drugs and paralytic, and upon direct laryngoscopy, the provider has a grade 1 view of the entire vocal cords, however the 4.5 cuffed endotracheal tube will not pass. The patient is mask ventilated and a 4.0 uncuffed endotracheal tube with a stylet is arranged. A second perfect view of the vocal cords with direct laryngoscopy is obtained, and the endotracheal tube passes easily. Which of the following best explains the reason for this problem recurring?",
    "unique_key": "Q7512558",
    "question_audio": null,
    "question_video": null,
    "map_id": 34179151,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Differences in airway anatomy in pediatric patients Typically, the airway of infants differs from adults in five ways: 1. LARGE TONGUE: increases the likelihood of airway obstruction and technical difficulties during laryngoscopy. 2. HIGH LARYNX: thus, making straight blades more useful than curved blades. 3. The EPIGLOTTIS is shaped differently, being short, stubby, omega shaped, and angled over the laryngeal inlet. Control with the laryngoscope blade is therefore more difficult. 4. The vocal cords are angled; consequently, a blindly passed tracheal tube may easily lodge in the anterior commissure rather than slide into the trachea. 5. Finally, the infant larynx is funnel shaped, the narrowest portion occurring at the cricoid cartilage \u2022 Use of cuffed endotracheal tube is therefore not advised in a paediatric patients up to 8 years of age because a tube that passes through the vocal cards can still get stuck in the cricoid region and on inflation of the cuff can lead to critical decrease in the blood flow of tracheal mucosal capillaries leading to a complication of post extubation tracheal oedema leading to stridor and complete airway obstruction.<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/12(6).jpg\" alt=\"Solution Image\"></p>",
    "correct_choice_id": 200066,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50017,
    "choices": [
      {
        "id": 200068,
        "text": "A 1 liter bolus of normal saline through the central line"
      },
      {
        "id": 200069,
        "text": "urgent CT scan"
      },
      {
        "id": 200070,
        "text": "Insert a chest tube"
      },
      {
        "id": 200071,
        "text": "Obtain an arterial blood gas"
      }
    ],
    "text": "A hemodynamically unstable patient has a right subclavian central line inserted and develops hypotension and shortness of breath ten minutes later.an urgent chest X ray obtained which looks like image below. What is the next most appropriate step in management?<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/14(4).jpg\" alt=\"Question Image\"></p>",
    "unique_key": "Q3674053",
    "question_audio": null,
    "question_video": null,
    "map_id": 34927068,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Insert a chest tube \u2022 The parietal pleural can be encroached especially when inserting central lines. \u2022 The risk of penetrating the parietal pleura is much higher when attempting a subclavian central line. \u2022 While the risk of pneumothorax is less during placement of a jugular central line, deep penetration of the needle into the neck can injure the parietal pleural covering the cupola and induce a pneumothorax. \u2022 Every time a central line is inserted, a post procedure chest x-ray is mandatory to ensure that there is no pneumothorax. \u2022 In case of confirmation of diagnosis of pneumothorax , a chest tube must be inserted to relieve the air from the pleural cavity.",
    "correct_choice_id": 200070,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50018,
    "choices": [
      {
        "id": 200072,
        "text": "Continue invasive mechanical ventilation and reattempt weaning trial once oxygen saturation is over 96%"
      },
      {
        "id": 200073,
        "text": "Continue invasive mechanical ventilation and reattempt weaning trial once incisional pain is resolved"
      },
      {
        "id": 200074,
        "text": "Extubate to high flow nasal cannula and encourage incentive spirometry along with non-opioid analgesics"
      },
      {
        "id": 200075,
        "text": "Extubate to venturi mask 50% and give morphine for incisional pain"
      }
    ],
    "text": "A 65-year-old male underwent coronary artery bypass graft surgery and is currently undergoing ventilator weaning. The patient is hemodynamically stable and has adequate mentation but complains of surgical incisional pain. He is noted to have mild hypoxemia to oxygen saturation of 90% that improves on taking deep breaths. Which of the following is the next best step in the management of this patient?",
    "unique_key": "Q4352672",
    "question_audio": null,
    "question_video": null,
    "map_id": 34320352,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) \u2022 Delay in extubation has been associated with detrimental clinical outcomes such as prolonged mechanical ventilation duration, increased risk of ventilator-associated pneumonia, and intensive care unit (ICU) length of stay. \u2022 Atelectasis is a significant driver of hypoxemia in the immediate post-op period. \u2022 Application of positive end-expiratory pressure (PEEP) prevents or treats alveolar collapse. High flow nasal cannula offers the advantage of providing PEEP when compared to low-flow oxygen supplementation. \u2022 The high-flow nasal cannula has been showed to reduce the need for respiratory support of cardiac surgical patients when compared to low-flow oxygen supplementation. \u2022 High flow nasal cannula has also been associated with higher compliance and comfort rates when compared to conventional oxygen supplementation facilitating pain management in the immediate post-op surgical period. \u2022 Venturi mask will only give a fixed FiO2 of oxygen and use of morphine will lead to delayed respiratory depression so wont be a preferred technique.",
    "correct_choice_id": 200074,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50019,
    "choices": [
      {
        "id": 200076,
        "text": "Maintain the current settings on the ventilator"
      },
      {
        "id": 200077,
        "text": "Increase the tidal volume to achieve a pH of 7.4"
      },
      {
        "id": 200078,
        "text": "Start a bicarbonate drip"
      },
      {
        "id": 200079,
        "text": "Initiate Extra Corporeal Membrane Oxygenation (ECMO)"
      }
    ],
    "text": "A 56-year-old male is in the ICU receiving mechanical ventilation for moderate ARDS due to a near-drowning event. The ICU team has been having difficulties managing the ventilator as the plateau pressure has been reading consistently over 35 cmH2O. The ventilator mode is volume assist control. Changes are made to the ventilator to reduce auto-PEEP by decreasing the tidal volume and reducing the respiratory rate. Arterial blood gas shows pH 7.26, pCO2 54 mmHg, and pO2 76 mmHg. Plateau pressure in the ventilator is now 26 cmH2O after the changes are made. What is the next best step in the management of this patient?",
    "unique_key": "Q8730341",
    "question_audio": null,
    "question_video": null,
    "map_id": 34486795,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) \u2022 Hypercapnia is one of the most common side effects that are seen when managing a patient with lung-protective ventilatory strategies. \u2022 The lower tidal volume may lead to decreased minute ventilation, and in some cases, hypercapnia. \u2022 Guidelines for ARDS management recommend allowing for permissive hypercapnia up to a pH of 7.2. \u2022 Bicarbonate drip should only be considered once the pH drops below 7.2.",
    "correct_choice_id": 200076,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50020,
    "choices": [
      {
        "id": 200080,
        "text": "Low tidal volume, no positive end-expiratory pressure (PEEP)"
      },
      {
        "id": 200081,
        "text": "Low tidal volume, low-moderate PEEP"
      },
      {
        "id": 200082,
        "text": "High tidal volume, Low PEEP"
      },
      {
        "id": 200083,
        "text": "High tidal volume, high PEEP"
      }
    ],
    "text": "A 75-year-old male is being treated in the medical intensive care unit (ICU) for septic shock. The patient has an acute decline in his respiratory status and is intubated due to poor respiratory effort. A chest radiograph reveals bilateral infiltrates, and arterial blood gas shows a PaO2/FiO2 ratio of 100. The patient has no signs of volume overload and has no history of congestive heart failure. Which of the following would be the ideal ventilator settings for this patient?",
    "unique_key": "Q4002211",
    "question_audio": null,
    "question_video": null,
    "map_id": 34324112,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) \u2022 PaO2/FiO2 ratio is used for the diagnosis of severity of ARDS. \u2022 A PaO2/FiO2 ratio of less than or equal to 100 indicates severe ARDS. \u2022 It has been shown that patients with acute respiratory distress syndrome (ARDS) do better with lower tidal volumes to prevent volutrauma. \u2022 Low tidal volumes (titrate to 6 mL/kg) without excessive PEEP helps prevent volutrauma and barotrauma in ARDS. \u2022 High PEEP puts ARDS patients at risk for barotrauma and subsequent pneumothorax. \u2022 Low tidal volumes will help prevent volutrauma, low to moderate PEEP will help prevent barotrauma.",
    "correct_choice_id": 200081,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50021,
    "choices": [
      {
        "id": 200084,
        "text": "Descending inhibition"
      },
      {
        "id": 200085,
        "text": "Gate control theory"
      },
      {
        "id": 200086,
        "text": "Central inhibition"
      },
      {
        "id": 200087,
        "text": "Sensitization"
      }
    ],
    "text": "Transcutaneous electrical nerve stimulation is used to relieve pain. What is the mechanism behind it.",
    "unique_key": "Q4986861",
    "question_audio": null,
    "question_video": null,
    "map_id": 34869915,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) The Gate Control Theory of Pain is a mechanism, in the spinal cord in which pain signals can be sent up to the brain to be processed to accentuate the possible perceived pain, or attenuate it at the spinal cord itself. The 'gate' is the mechanism where pain signals can be let through or restricted. One of two things can happen, the gate can be 'open' or the gate can be 'closed': If the gate is open, pain signals can pass through and will be sent to the brain to perceive the pain. If the gate is closed, pain signals will be restricted from travelling up to the brain, and the sensation of pain won't be perceived. If someone experiences a painful (noxious) stimulus, the application of a non-noxious (soothing or light rubbing or Transcutaneous electrical nerve stimulation) stimulus can help activate the gate control mechanism, and reduce the pain.",
    "correct_choice_id": 200085,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/2613251704707092/2613251704707092.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/2613251704707092/2613251704707092.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50022,
    "choices": [
      {
        "id": 200088,
        "text": "Inspiratory flow 100-120 litres per min"
      },
      {
        "id": 200089,
        "text": "PEEP 0 cm of water"
      },
      {
        "id": 200090,
        "text": "Tidal volume 10ml/kg"
      },
      {
        "id": 200091,
        "text": "Fio2 =100%"
      }
    ],
    "text": "A patient of blunt chest trauma has been started on mechanical ventilation. Which of the following is not correct about initial setting?",
    "unique_key": "Q1066981",
    "question_audio": null,
    "question_video": null,
    "map_id": 34328037,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Option A-Select an inspiratory flow rate of 60 L/min if the patient is breathing quietly or has no spontaneous respirations.Use higher inspiratory flow rates (e.g. 80 L/min) for patients with respiratory distress. Option B-Set the initial PEEP to 5 cm H2O to prevent the collapse of distal airspaces at end expiration. Option C-Select an initial tidal volume of 8 mL/kg using predicted body weight and Reduce the tidal volume to 6 mL/kg over the next 2 hours, if possible. Option D-Keep Fio2 =100% in the initial hours.",
    "correct_choice_id": 200089,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/76244241704707115/76244241704707115.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/76244241704707115/76244241704707115.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50023,
    "choices": [
      {
        "id": 200092,
        "text": "Bleeding"
      },
      {
        "id": 200093,
        "text": "PONV"
      },
      {
        "id": 200094,
        "text": "Pain"
      },
      {
        "id": 200095,
        "text": "Respiratory complication"
      }
    ],
    "text": "Most common cause of admission after day care surgery is:",
    "unique_key": "Q1712144",
    "question_audio": null,
    "question_video": null,
    "map_id": 34192564,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (C) Day care surgery means admission, operation and discharge in the same day.Do not keep patient overnight in hospital. Option A-Bleeding can be a cause,but it is not the most common cause. Option B,D-2nd most common cause is complications associated with opioid use for pain i.e respiratory complications and post operative nausea and vomiting. Option C-Pain is the most common cause of unplanned hospital admission after day care surgery.",
    "correct_choice_id": 200094,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/55610611704707213/55610611704707213.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/55610611704707213/55610611704707213.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50024,
    "choices": [
      {
        "id": 200096,
        "text": "6"
      },
      {
        "id": 200097,
        "text": "1/6"
      },
      {
        "id": 200098,
        "text": "5"
      },
      {
        "id": 200099,
        "text": "1/5"
      }
    ],
    "text": "While exercising and on reaching equilibrium state, it was found that body was consuming 1500 ml/min of oxygen. Calculate MET score if baseline at rest O2 consumption is 250 ml/min",
    "unique_key": "Q8909736",
    "question_audio": null,
    "question_video": null,
    "map_id": 34685970,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) One metabolic equivalent of task (MET) is the amount of oxygen consumed while sitting at rest, and is equivalent to an oxygen consumption of 3.5 mL/min/kg body weight. Since his body was consuming-1500ml/min. and his O2 consumption at rest is 250 ml/min. So,his MET will be:-1500/250=6 MET. >4 METs : adequate functional capacity from cardiac point of view.",
    "correct_choice_id": 200096,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/903661704707342/903661704707342.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/903661704707342/903661704707342.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50025,
    "choices": [
      {
        "id": 200100,
        "text": "Arterial puncture"
      },
      {
        "id": 200101,
        "text": "Chylothorax"
      },
      {
        "id": 200102,
        "text": "Empyema"
      },
      {
        "id": 200103,
        "text": "Thrombophlebitis"
      }
    ],
    "text": "If you want to get venous access below this specific bone, what will be the complication?<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/28(154).jpg\" alt=\"Question Image\"></p>",
    "unique_key": "Q9280859",
    "question_audio": null,
    "question_video": null,
    "map_id": 34751028,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) Option A-The immediate complications of subclavian vein cannulation include puncture of the subclavian artery (5%), pneumothorax (5%), brachial plexus injury (3%), and phrenic nerve injury (1.5%). Option B-Venous access below clavicle :- supraclavicular approach to a subclavian vein. In the given image,we're getting venous access on left side. Left-sided internal jugular or subclavian access carries a higher risk of lymphatic injury due to the anatomic location of the thoracic duct, but lymphatic injury can still occur with right-sided access.Hence, Chylothorax is a specific answer in this question. Option C,D-Empyema and Thrombophlebitis can also occur.",
    "correct_choice_id": 200101,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/45284851704707353/45284851704707353.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/45284851704707353/45284851704707353.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50026,
    "choices": [
      {
        "id": 200104,
        "text": "Venous air embolism"
      },
      {
        "id": 200105,
        "text": "Baroreceptor"
      },
      {
        "id": 200106,
        "text": "Vagal stimulation"
      },
      {
        "id": 200107,
        "text": "Sympathetic stimulation"
      }
    ],
    "text": "Person is under surgery for laryngeal malignancy, while ligating jugular vein, he suddenly developed hypotension ,ventricular arrhythmia and sudden fall in ETC02 . which of the following could have caused this effect?",
    "unique_key": "Q3861278",
    "question_audio": null,
    "question_video": null,
    "map_id": 34548616,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Most common complication of Sitting position surgery is venous air embolism. Diagnosis is based on the clinical picture and risk factors present like Large central vein open to air,Sudden drop of ETC02 while manipulating the large vein,Head and neck surgery where the position of the patient is kept head up so the vein is above the level of the heart. The venous air embolism results in hypotension ,ventricular arrhythmia and sudden fall in ETC02 .",
    "correct_choice_id": 200104,
    "solution_audio": null,
    "solution_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/45312971704707380/45312971704707380.m3u8",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/45312971704707380/45312971704707380.m3u8",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50027,
    "choices": [
      {
        "id": 200108,
        "text": "Reduce FiO2"
      },
      {
        "id": 200109,
        "text": "Reduce respiratory rate"
      },
      {
        "id": 200110,
        "text": "Increase PEEP to 16"
      },
      {
        "id": 200111,
        "text": "Increase tidal volume"
      }
    ],
    "text": "A patient who came to the emergency with acute pancreatitis was shifted to ICU and intubated. The ventilator settings are: FiO2 90%, PEEP 12, RR 16. An arterial blood gas analysis showed PaO2 110 mmHg and PaCO2 58mmHg and SaO2 is 100%. What would be the next step in management?",
    "unique_key": "Q3918344",
    "question_audio": null,
    "question_video": null,
    "map_id": 34924295,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Option A-Pancreatitis is a known cause of ARDS, hence lung protective ventilation is required.FiO2 100% (titrate to 60% or lower as soon as possible).Hence,In this patient, reduction of FiO2 will be the next step. Option B-Respiratory rate is kept 14-16/min. Option C-PEEP of 5 to 10 cm H20. Option D-Low tidal volume ventilation is given in these patients. Tidal volume is maintained at 6-8ml/kg,",
    "correct_choice_id": 200108,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50028,
    "choices": [
      {
        "id": 200112,
        "text": "Allen\u2019s test"
      },
      {
        "id": 200113,
        "text": "Roos test"
      },
      {
        "id": 200114,
        "text": "Elevated arm stress test"
      },
      {
        "id": 200115,
        "text": "Adson\u2019s test"
      }
    ],
    "text": "Which of the following test is depicted in the given image?<p><img src=\"https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/2(61).png\" alt=\"Question Image\"></p>",
    "unique_key": "Q3674660",
    "question_audio": null,
    "question_video": null,
    "map_id": 34973272,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Option A-Allen\u2019s test is done to check the collateral blood supply between the radial and the ulnar artery. A negative Allen test means that the patient likely does not have an adequate dual blood supply to the hand, which may present a contraindication to the planned procedure like ABG. Option B,C-Roos test,also known as Elevated arm stress test is used to diagnose thoracic outlet syndrome. Option D-Adson's sign or Adson's maneuver is used to diagnose thoracic outlet syndrome. The clinician has the patient extend their neck and turn their head to the side that is being tested. The patient then holds their breath and the radial pulse is palpated.",
    "correct_choice_id": 200112,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50029,
    "choices": [
      {
        "id": 200116,
        "text": "Aspiration"
      },
      {
        "id": 200117,
        "text": "Pneumothorax"
      },
      {
        "id": 200118,
        "text": "Refeeding syndrome"
      },
      {
        "id": 200119,
        "text": "Infection"
      }
    ],
    "text": "A central line was inserted for total parenteral nutrition. All of the following complications may be seen except-",
    "unique_key": "Q2334892",
    "question_audio": null,
    "question_video": null,
    "map_id": 34171348,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (A) Option A-Aspiration can not occur in parenteral nutrition as food is not passing through the orogastric route. Option B,C,D-Complications seen after central line insertion are- Infection,Pneumothorax due to injury to lung and Refeeding syndrome.",
    "correct_choice_id": 200116,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "id": 50030,
    "choices": [
      {
        "id": 200120,
        "text": "25%"
      },
      {
        "id": 200121,
        "text": "35%"
      },
      {
        "id": 200122,
        "text": "40%"
      },
      {
        "id": 200123,
        "text": "50%."
      }
    ],
    "text": "FIO2 DELIVERED BY NASAL CANNULA FOR A 5-YEAR-OLD CHILD AT 3 LITRES\\ MIN?",
    "unique_key": "Q8394104",
    "question_audio": null,
    "question_video": null,
    "map_id": 34379786,
    "difficulty_level": "intermediate",
    "subjects_id": [],
    "solution": "Correct Answer (B) FIO2 DELIVERED BY NASAL CANNULA FOR A 5-YEAR-OLD CHILD AT 3 LITRES\\ MIN is 35%.",
    "correct_choice_id": 200121,
    "solution_audio": null,
    "solution_video": "",
    "audio_explanation_heading": null,
    "video_explanation_heading": null,
    "solution_media_position": "bottom",
    "tags": [],
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '08  Miscellaneous';
        const quizFilename = '08-miscellaneous-c655dccf.html';
        let hierarchy = ["DAMS", "DQB", "Anesthesia"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on navigation
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>