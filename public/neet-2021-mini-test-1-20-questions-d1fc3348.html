<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neet 2021 Mini Test 1  (20 Questions) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2020-21
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "An 8-month-old infant is brought to the pediatrician for evaluation of multiple episodes of seizures and hypoglycemia. On examination, there is growth retardation, hepatomegaly, and hypotonia. Lab workup reveals normal serum lactate, uric acid, and serum triglyceride levels. A liver biopsy demonstrates hepatocytes with large glycogen stores. Biochemical analysis reveals glycogen with short outer chains. Which of the following enzymes is most likely deficient in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Glucose-6- phosphatase"
      },
      {
        "id": 2,
        "text": "Liver glycogen phosphorylase"
      },
      {
        "id": 3,
        "text": "Glycogen debranching enzyme"
      },
      {
        "id": 4,
        "text": "Muscle glycogen phosphorylase"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In the given clinical scenario of an infant presenting with hypoglycemia, hepatomegaly, hypotonia, and growth retardation with normal blood lactate and uric acid levels, the most likely diagnosis is <strong>Cori disease</strong>.&nbsp;</p>\n<p>Cori disease (type III glycogen storage disorder) occurs due to a deficiency of the glycogen <strong>debranching enzyme</strong>. The features of Cori disease include <strong>hypoglycemia</strong>, <strong>hepatomegaly</strong>, and hyperlipidemia but with <strong>normal</strong> blood <strong>lactate</strong> and <strong>uric acid</strong> levels. <strong>Muscle weakness</strong> and atrophy can also occur in these patients. Liver biopsy shows the accumulation of glycogen in the form of <strong>limit-dextrins&nbsp;</strong>(glycogen with short outer chain) in hepatocyte cytosol and the presence of fibrous septa. Cori disease can be differentiated from Von Gierke disease on the basis of:</p>\n<table style=\"width: 381.531px;\">\n<tbody>\n<tr>\n<td style=\"width: 108px;\">&nbsp;</td>\n<td style=\"width: 121px;\"><strong>Von Gierke Disease</strong></td>\n<td style=\"width: 127.531px;\"><strong>Cori Disease</strong></td>\n</tr>\n<tr>\n<td style=\"width: 108px;\">Deficient enzyme</td>\n<td style=\"width: 121px;\">Glucose-6-phosphatase</td>\n<td style=\"width: 127.531px;\">Debranching enzyme</td>\n</tr>\n<tr>\n<td style=\"width: 108px;\">Hypoglycemia</td>\n<td style=\"width: 121px;\">Present</td>\n<td style=\"width: 127.531px;\">Present</td>\n</tr>\n<tr>\n<td style=\"width: 108px;\">Hepatomegaly</td>\n<td style=\"width: 121px;\">Present</td>\n<td style=\"width: 127.531px;\">Present</td>\n</tr>\n<tr>\n<td style=\"width: 108px;\">Renal disease</td>\n<td style=\"width: 121px;\">Present (proteinuria, hypertension, renal stones)</td>\n<td style=\"width: 127.531px;\"><strong>Absent</strong></td>\n</tr>\n<tr>\n<td style=\"width: 108px;\">Blood lactate</td>\n<td style=\"width: 121px;\">Elevated</td>\n<td style=\"width: 127.531px;\"><strong>Normal</strong></td>\n</tr>\n<tr>\n<td style=\"width: 108px;\">Blood uric acid</td>\n<td style=\"width: 121px;\">Elevated</td>\n<td style=\"width: 127.531px;\"><strong>Normal</strong></td>\n</tr>\n<tr>\n<td style=\"width: 108px;\">Gluconeogenesis</td>\n<td style=\"width: 121px;\">Impaired, since glucose-6-phosphatase is required in the final step of gluconeogenesis</td>\n<td style=\"width: 127.531px;\"><strong>Intact</strong></td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are asked to opine on the age of an adolescent boy allegedly involved in a crime. He claims to be a juvenile and pleads for a trial in the juvenile court. Based on the X-ray shown below, the likely age of the boy is:",
    "choices": [
      {
        "id": 1,
        "text": ">18 years"
      },
      {
        "id": 2,
        "text": "<17 years"
      },
      {
        "id": 3,
        "text": ">19 years"
      },
      {
        "id": 4,
        "text": "<10 years"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given X-ray shows the <strong>appearance </strong>of <strong>pisiform </strong>but<strong> no fusion</strong> of<strong> base </strong>of<strong> 1st metacarpal. </strong>Therefore, the age is<strong> more </strong>than<strong> 10 years</strong> and <strong>less</strong> than<strong> 17 years</strong>. Among the given options, the age of the boy is likely to be <strong>&lt;17 years</strong>.</p>\n<p>The <strong>base</strong> of <strong>all</strong>\u00a0<strong>metacarpals</strong> appears at 2-3 years of age and fuses at 15 -17 years of age. Since it is not fused in this case, the age is less than 17 years. If it has fused the likely age is more than 15 years.</p>\n<p><strong>Pisiform</strong> <strong>ossification</strong> center appears at <strong>10-12 years</strong> of age (options C and D). Since it is <strong>present</strong> in this case, the age of the child is<strong>\u00a0more than 10 years.\u00a0</strong>If it had not appeared, the likely age is &lt;12 years</p>\n<p style=\"text-align: left;\">The <strong>lower end</strong> of the <strong>radius</strong> appears at <strong>2 </strong>years of age and <strong>fuses</strong> at <strong>18-19</strong> years of age. The <strong>lower end</strong> of the <strong>ulna</strong> appears at <strong>5-6</strong> years of age and <strong>fuses</strong> at <strong>17-18</strong> years of age. Here, both remain unfused indicating further that the age is likely to be less than 18.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4b7350cbccf947868802bac6026e142f.jpg"
    ],
    "explanation_images": []
  },
  {
    "text": "A 1-month-old male baby was brought to you with complaints of a left-sided flank mass. The mother reported that the child cries while urinating and had been treated with antibiotics for urinary tract infection. Ultrasonography was done and revealed dilation of the pelvicalyceal system, with a normal-looking distal urinary tract. What is the likely diagnosis in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Ureteropelvic junction obstruction"
      },
      {
        "id": 2,
        "text": "Vesicoureteral reflux"
      },
      {
        "id": 3,
        "text": "Ureterocele"
      },
      {
        "id": 4,
        "text": "Posterior urethral valve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical vignette and the ultrasonograph showing&nbsp;<strong>hydronephrosis</strong> of the affected kidney indicate a likely diagnosis of&nbsp;<strong>ureteropelvic junction obstruction (UPJ)&nbsp;</strong>associated with UTI.</p>\n<p>Hydronephrosis may be detected on antenatal ultrasound; it can, however, be transient or mild and resolves on its own. Re-evaluation should be done after birth and in cases presenting with <strong>symptoms of recurrent UTI, palpable flank mass or pain, urinary obstruction, and in cases of failure to thrive</strong>.</p>\n<p>If the hydronephrosis is persistent, its <strong>severity</strong> is <strong>graded</strong> by the extent of the dilatation of the pelvicalyceal system and parenchymal thickness. It needs to be ascertained whether the other kidney is involved, the lower ureter is dilated, the bladder wall is thickened, and whether emptying of the bladder is incomplete. Based on these findings, a diagnosis can be made.</p>\n<p>In cases of hydronephrosis, <strong>long-standing urine stasis</strong> and pressure may <strong>damage the kidney</strong>s.</p>\n<p>The causes of UPJ obstruction are</p>\n<ul>\n<li style=\"padding-left: 30px;\">Intrinsic (due to an adynamic or stenotic segment of the proximal ureter) or&nbsp;</li>\n<li style=\"padding-left: 30px;\">Extrinsic (e.g. compression by accessory renal arteries). This needs to be corrected primarily.</li>\n</ul>\n<p>The renal anatomy and function can be assessed using <strong>radioscintigraphy</strong> studies. The&nbsp;<strong>investigation of choice</strong>&nbsp;for UPJ obstruction is<strong>&nbsp;</strong><sup>99m</sup>Tc-MercaptoAcetyl-triGlycine<strong>&nbsp;(MAG3) scan.&nbsp;</strong><strong>Micturating cystourethrogram</strong>&nbsp;is the&nbsp;investigation of choice in&nbsp;<strong>vesicoureteric reflux.</strong> <sup>99m</sup>Tc-dimercaptosuccinic acid&nbsp;<strong>(DMSA) scan</strong>&nbsp;is used for assessing&nbsp;<strong>renal scarring</strong>.</p>\n<p><strong>Treatment</strong> of intrinsic UPJ obstruction is done <strong>surgically if renal function is compromised</strong> or if there is bilateral involvement of the kidneys. In other cases, <strong>serial follow-up with ultrasonography</strong> is done to assess the spontaneous resolution of hydronephrosis.</p>\n<p>Other options:</p>\n<p>Option B:<strong> Vesicoureteral reflux</strong> is the <strong>second most common</strong> cause of hydronephrosis after UPJ obstruction.&nbsp;In vesicoureteric reflux, the&nbsp;valve that prevents the backflow of urine from the bladder into the ureter is defective;&nbsp;hence, abnormal <strong>backflow of urine</strong> occurs <strong>from</strong> the&nbsp;<strong>bladder</strong> into the <strong>ureter</strong>. It may also present with hydronephrosis; however, the distal ureter is also involved, unlike in this case.</p>\n<p>Option C:&nbsp;<strong>Ureterocele</strong> is a cystic dilation of the terminal ureter, thought to result from the persistence of the membrane between the ureteral bud and urogenital sinus. Since the distal urinary tract is normal-looking in this case, this diagnosis is unlikely.</p>\n<p>Option D:<strong> Posterior urethral valve</strong> is an <strong>obstructing membrane</strong> in the posterior male urethra as a result of abnormal in-utero&nbsp;development. It is the most common cause of bladder outlet obstruction in male newborns. As a result, bilateral hydronephrosis and bladder dilatation is seen, unlike the unilateral involvement in this case.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6130abb7e06c47cd8b4cce524a7a7373.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old woman presents with a history of palpitations, panic attacks, and difficulty swallowing. Examination reveals a heart rate of 110 bpm, a blood pressure of 156/100 mmHg, and a neck swelling that moves with swallowing. Labs show hypercalcemia, elevated calcitonin, and parathormone levels and an MRI shows bilateral adrenal masses. What gene is responsible for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "p53 tumor suppressor gene"
      },
      {
        "id": 2,
        "text": "MEN I tumor suppressor gene"
      },
      {
        "id": 3,
        "text": "RET proto-oncogene"
      },
      {
        "id": 4,
        "text": "CDKN1B gene"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient most likely has <strong>multiple endocrine neoplasia 2A</strong>\u00a0(MEN) due to a <strong>gain of function mutation</strong> of <strong>RET proto-oncogene</strong>.\u00a0</p>\n<p>Palpitations, panic attacks, tachycardia, hypertension with bilateral adrenal masses suggest the presence of a <strong>pheochromocytoma</strong>. Difficulty swallowing and a neck swelling that moves with swallowing along with elevated calcitonin indicated <strong>medullary carcinoma of the thyroid</strong>. Hypercalcemia and elevated PTH could reflect <strong>parathyroid hyperplasia.</strong>\u00a0Pheochromocytoma, medullary carcinoma of the thyroid, and parathyroid hyperplasia is seen in MEN 2A.</p>\n<p><strong>MEN type 2 </strong>is classified into MEN 2A and MEN 2B.\u00a0</p>\n<p><strong>MEN 2A</strong> is also called <strong>Sipple syndrome</strong> and characterized by</p>\n<ul>\n<li>Pheochromocytoma</li>\n<li>Medullary carcinoma of the thyroid</li>\n<li>Parathyroid hyperplasia.</li>\n</ul>\n<p><strong>MEN 2B</strong> is characterized by</p>\n<ul>\n<li>Medullary carcinoma of the thyroid</li>\n<li>Pheochromocytoma.</li>\n<li>Mucosal neuromas of lips and tongue, intestinal ganglioneuromas, marfanoid habitus, and lax joints.</li>\n<li><strong>Parathyroid hyperplasia</strong> is <strong>absent</strong>.\u00a0</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: Mutations in the <strong>MEN1 tumor suppressor gene </strong>lead to<strong>\u00a0</strong><strong>MEN 1,\u00a0</strong>also called <strong>Wermer syndrome. </strong>\u00a0It is characterized by</p>\n<ul>\n<li>Parathyroid hyperplasia or adenoma</li>\n<li>Pancreas - endocrine tumors</li>\n<li>Pituitary - the most common anterior pituitary tumor is prolactinoma</li>\n</ul>\n<p>Option D: <strong>CDKN1B mutations</strong>\u00a0cause\u00a0<strong>MEN 4. </strong>This\u00a0is characterized by clinical features similar to MEN 1.</p>\n<p>Option A:\u00a0<strong>p53 tumor suppressor gene</strong> mutations can lead to <strong>Li Fraumeni syndrom</strong>e. This is an autosomal dominant hereditary cancer disorder. Patients develop multiple cancers at a young age such as sarcomas, breast cancer, brain tumors, and leukemias.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 65-year old man comes with complaints of headache in the occipital region. He is known hypertensive who is on antihypertensive therapy. Thorough testing revealed no abnormality. A psychological stress test was performed which increased the blood pressure and the patient complained of a headache during the test. A rise in noradrenaline levels was also noted. The patient's medication was changed from nifedipine to cilnidipine. Which of the following calcium channels does cilnidipine block?",
    "choices": [
      {
        "id": 1,
        "text": "N type and L type"
      },
      {
        "id": 2,
        "text": "L type and T type"
      },
      {
        "id": 3,
        "text": "Only L type"
      },
      {
        "id": 4,
        "text": "Only N type"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Cilnidipine</strong> blocks both <strong>N and L-type calcium channels.\u00a0</strong></p>\n<p>Cilnidipine is a <strong>dihydropyridine</strong> calcium channel blocker. It blocks the L-type calcium channels in blood vessels and inhibits the contraction of blood vessels and blocks the N-type calcium channels located at the sympathetic nerve endings, inhibiting the release of norepinephrine.\u00a0</p>\n<p>It is used in <strong>hypertension</strong> especially in patients with diabetes and albuminuria and chronic kidney disease as it has end-organ protective properties. It has shown to be useful in psychological stress and white coat phenomenon.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-month-old infant is brought to the OPD for a well-baby check-up. The baby has been exclusively breastfed and has received all age-appropriate immunizations.  The baby's mother was treated with antibiotics two weeks ago for typhoid infection, during which she continued to breastfeed the baby. The baby's grandmother was recently diagnosed with malignant melanoma. On examination, the anthropometry is age-appropriate and vitals are within normal limits. The mother is worried about the discoloration of the skin of the baby as shown below. What is the next best step in management?",
    "choices": [
      {
        "id": 1,
        "text": "Reassurance and observation"
      },
      {
        "id": 2,
        "text": "Skin biopsy"
      },
      {
        "id": 3,
        "text": "Serum chloramphenicol levels"
      },
      {
        "id": 4,
        "text": "Topical steroid application"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above image shows <strong>mongolian spots or congenital dermal melanocytosis, </strong>which is a<strong> benign </strong>finding in newborns. Parents must be <strong>reassured</strong> and explained about the condition.</p>\n<p>Mongolian spots are <strong>benign blue or slate-grey macular lesions</strong>, with <strong>clearly defined margins</strong>, that appear over the presacral region (most common), posterior thighs, legs, back, and forearms. These spots occur due to the presence of <strong>melanin-containing melanocytes</strong> in the dermis, which is arrested during the migration from neural crest cells to the epidermis. They are <strong>non-tender</strong> and do not rapidly change in colour or size. They <strong>do not require any treatment</strong> and fade by age 1-6 years of age.</p>\n<p>Congenital dermal melanocytosis is a <strong>clinical diagnosis.</strong> Since this baby has a classic presentation of mongolian spots, skin biopsy is not required for diagnosis. Topical steroid application has no role in the treatment of dermal melanocytosis.</p>\n<p>Grey-baby syndrome is caused by the increased levels of chloramphenicol in the baby, when a breastfeeding mother is treated with chloramphenicol. It is characterized by abdominal distension, flaccidity, cyanosis appearing as ashen-gray color, circulatory collapse and death. This baby has stable vital signs and the bluish-gray discoloration is limited to the buttocks, ruling out gray-baby syndrome. This baby's mother must have received alternate antibiotics for typhoid. Hence, serum chlroramphenicol levels need not be measured.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/56ae25b4641047e2b7a67a5a45bae151.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 9-year-old boy presents with an erythematous rash with central clearing on the back of his right thigh as shown in the image below. No other skin rashes are noted, and the rest of the examination is normal. The child had recently been on vacation with his family in Oregon, USA, and had gone hiking during the last week of his stay there. The parents recall the child developed fever, headache, and body pain immediately after returning from the hike, which resolved in two days. Which of the following diseases can also be transmitted by the vector causing the above disease?",
    "choices": [
      {
        "id": 1,
        "text": "Q fever"
      },
      {
        "id": 2,
        "text": "Ehrlichiosis"
      },
      {
        "id": 3,
        "text": "Eastern equine encephalitis"
      },
      {
        "id": 4,
        "text": "Leptospirosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows a <strong>target sign rash</strong>\u00a0or <strong>bull's eye rash</strong> which is pathognomonic of <strong>Lyme\u2019s disease</strong>, caused by <em>Borrelia burgdorferi</em>, which is transmitted via the bite of <strong>Ixodes ticks (hard ticks)</strong>. <strong>Ehrlichiosis</strong> is also transmitted via the <strong>bite of a hard tick vector</strong>.\u00a0</p>\n<p><strong>Co-infection</strong> may be a potential problem for humans, because the\u00a0<em>Ixodes\u00a0</em>ticks often carry and transmit other pathogens, as well. Other infections that are transmitted by hard ticks are-</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Babesia</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Anaplasma</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Spotted fever rickettsial infections- RMSF, Indian tick typhus, Boutonneuse fever, Kenyan tick typhus.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Francisella tularensis</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Viruses like Crimean-Congo hemorrhagic fever\u00a0(CCHF), Severe fever with thrombocytopenia syndrome\u00a0(SFTS), Coltivirus, Kyasanur forest disease (KFD), tick borne encephalitis (TBE), Omsk hemorrhagic fever.</li>\n</ul>\n<p>In humans, Ehrlichiosis presents with fever and flu-like symptoms. Leukopenia and thrombocytopenia are seen. The bacteria have affinity to blood cells and form mulberry like structures in phagocytes called <strong>morula formation</strong>, which is seen on Giemsa stained blood film.\u00a0</p>\n<p>Other options :</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Q fever</strong> is transmitted to humans via the <strong>inhalation of aerosols</strong> contaminated with Coxiella or unpasteurized milk or percutaneous through handling of infected animal products.\u00a0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Leptospirosis</strong> is typically transmitted via <strong>mucous membrane or abraded skin exposure</strong> to rat urine contaminated water.\u00a0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Eastern equine encephalitis</strong> is transmitted by <strong>mosquito bites</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/450624076119489880811a9db1efde1c.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 14-year-old male patient presents to your clinic with complaints of a large rash-like lesion on the back and left shoulder. He noticed it for the first time 3 months ago during his swimming practice and it has become darker since then. There is no pain or itching associated with the lesion.  His pulse rate is 67, his BP is 110/70 mm of Hg, and his temperature is 98.3F. On examination, there is a 15x20 cm irregular, hyperpigmented patch over the left shoulder and back. There is excessive hair growth over the lesion. The image of the physical examination findings is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Mongolian Spot"
      },
      {
        "id": 2,
        "text": "Naevus of Ito"
      },
      {
        "id": 3,
        "text": "Pityriasis rosea"
      },
      {
        "id": 4,
        "text": "Becker's Naevus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given image shows <strong>Becker's Naevus</strong>.</p>\n<p>Becker's naevus is an <strong>epidermal melanocytic naevus.\u00a0</strong>It is classically seen as a <strong>hyperpigmented, brownish patch</strong> over the <strong>scapular area on the back, shoulders, outer arms, and chest</strong>. It is usually <strong>associated with hypertrichosis and sometimes with acne.</strong></p>\n<p>It is caused due to\u00a0an <strong>aggregation of melanocyte clusters</strong> in the epidermis. It has an\u00a0<strong>onset around adolescence</strong> when there is an <strong>increased sensitivity to androgens.</strong></p>\n<p>Other options:</p>\n<p>Option A- <strong>Mongolian spots</strong> are slate blue areas in the lumbosacral region that spontaneously regresses before puberty, making it unlikely in this case.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d19b1dd900f14af6aa5a79423c7228d6.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5f183813a0da4d45ba31163efe1a9ecfx720x550.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/936659e53ea74801a30bc4ae6b7343f1x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e5a5c6315320487c9d837de341068f5fx720x1278.PNG"
    ]
  },
  {
    "text": "A 45-year-old woman with lung adenocarcinoma comes for her chemotherapy treatment. She has had multiple complaints of nausea and vomiting during her previous treatment visits. In order to prevent this, the physician prescribes a combination of a 5HT3 receptor antagonist and netupitant along with dexamethasone. Which of the following 5HT3 receptor antagonists is used in this combination to prevent chemotherapy-induced emesis and vomiting?",
    "choices": [
      {
        "id": 1,
        "text": "Ondansetron"
      },
      {
        "id": 2,
        "text": "Granisetron"
      },
      {
        "id": 3,
        "text": "Dolasetron"
      },
      {
        "id": 4,
        "text": "Palonosetron"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Palonosetron</strong> is used with <strong>netupitant</strong> in <strong>chemotherapy-induced nausea and vomiting.\u00a0</strong></p>\n<p>Palonosetron is a <strong>5HT3 receptor antagonist</strong> that blocks serotonin in vagal terminals and centrally in the chemoreceptor trigger zone (CTZ). It has a <strong>higher receptor affinity</strong> as compared to the first-generation 5HT3 antagonists making it <strong>more potent</strong>. It is also useful in delayed emesis associated with chemotherapy due to its <strong>long half-life</strong>.\u00a0</p>\n<p>It is used in combination with netupitant in acute and delayed nausea and vomiting. <strong>Netupitant</strong> is an <strong>NK1 receptor antagonist</strong>. It augments the effects of palonosetron. This combination is particularly anti-emetogenic when given along <strong>with dexamethasone.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-year-old boy was brought to the OPD with a history of recurrent abscesses secondary to staphylococcus aureus infection. Primary immunodeficiency was suspected. The nitro-blue tetrazolium test was performed which was negative. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Wiskott Aldrich syndrome"
      },
      {
        "id": 2,
        "text": "Chronic Granulomatous disease"
      },
      {
        "id": 3,
        "text": "Chediak Higashi syndrome"
      },
      {
        "id": 4,
        "text": "Severe Combined Immunodeficiency"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In this patient with a suspected primary immunodeficiency, repeated infections with Staphylococcus aureus (catalase-positive organisms) and a negative nitro-blue tetrazolium test&nbsp;is suggestive of <strong>Chronic Granulomatous Disease (CGD).</strong></p>\n<p>It is due to a <strong>defect in NADPH oxidase</strong>, the enzyme responsible for the generation of superoxide during the respiratory burst. Defective inherent production of reactive oxygen species leads to increased susceptibility to life-threatening infections- <strong>pulmonary, cutaneous, lymphatic, hepatic, and osteomyelitis.</strong> These patients are susceptible to <strong>catalase-positive organisms</strong> like Staphylococcus and Coliforms.</p>\n<p><strong>Nitro blue tetrazolium</strong> test can be used for the <strong>diagnosis</strong> of chronic granulomatous disease. The <strong>leukocytes</strong> <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"><strong>fail</strong> to <strong>reduce</strong> nitroblue tetrazolium <strong>(NBT)</strong> during phagocytosis in chronic granulomatous disease.</span></p>\n<p>Other options:&nbsp;</p>\n<p>Option A<strong>: Wiskott-Aldrich syndrome</strong> is a disorder of T-lymphocytes (<strong>cellular immunity</strong>) and is characterized by the triad of recurrent severe infections, thrombocytopenia, and eczema. This patient does not present with eczema or symptoms of thrombocytopenia like petechiae, recurrent gum bleeds or nose bleeds.</p>\n<p>Option C<strong>: Chediak- Higashi syndrome</strong> is a primary immunodeficiency due to a disorder of the <strong>phagolysosome function</strong> of leukocytes, leading to delayed microbial clearance. In addition, there is a disorder of melanin (<strong>albinism</strong>), nerve defects, and bleeding disorders.</p>\n<p>Option D<strong>: Severe combined immunodeficiency</strong> is a primary immunodeficiency with a disorder of <strong>both cellular and humoral immunity</strong>. Persons with SCID are susceptible to recurrent severe infections caused by a wide variety of pathogens and usually do not survive beyond the first year of life without a stem cell transplant.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old male comes to the OPD with complaints of nausea, vomiting, fatigue, and malaise for the past week. His wife noticed a yellowish discoloration of sclera and skin for the past 3 days. The symptoms started on returning home after attending a village fair. He works as a janitor at a nursing home and upon questioning, he says that he pricked himself with a needle two weeks ago while transferring medical waste. He has no other significant past history.  Pallor and icterus are present. On palpating the abdomen, there is tender hepatomegaly. Liver function test results are given below. In addition to this, which among the following list of investigations are best suited in this case?",
    "choices": [
      {
        "id": 1,
        "text": "1 & 6 only"
      },
      {
        "id": 2,
        "text": "2 only"
      },
      {
        "id": 3,
        "text": "1, 2,  4, 5 & 6"
      },
      {
        "id": 4,
        "text": "1, 2,  3, 5 & 6"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Anti-HAV </strong>(IgM); <strong>HBsAg</strong>,<strong> anti-HBc</strong> (IgM);<strong>\u00a0anti-HCV </strong>(IgM), <strong>HCV RNA</strong>; and <strong>anti-HEV</strong>\u00a0(IgM and IgG) are the most appropriate investigations for the <strong>preliminary examination of a case of suspected acute viral hepatitis</strong>.\u00a0</p>\n<p>The history, clinical presentation, and laboratory results in this clinical vignette are all suggestive of acute viral hepatitis -</p>\n<p>Clinical presentation of acute viral hepatitis is non-specific and includes nausea, vomiting, fever, myalgia, fatigue, etc associated with jaundice.\u00a0</p>\n<p>Physical examination may reveal <strong>icterus and right upper quadrant tenderness</strong> suggesting <strong>hepatomegaly</strong>.\u00a0</p>\n<p>Laboratory investigation suggests acute hepatocellular injury with a sharp rise in ALT and AST (usually over 1000 IU/L) with ALT&gt;AST, hyperbilirubinemia, with elevated GGT and ALP. Additionally, the viral cause of hepatitis may be ascertained using the following serological markers-</p>\n<ul>\n<li>Hepatitis A (The most common cause of acute hepatitis in children): <strong>IgM anti-HAV</strong> antibody\u00a0</li>\n<li>Hepatitis B:\u00a0<strong>HBsAg</strong> (first marker to rise) and <strong>IgM anti-HBc</strong> (most reliable marker of acute infection)</li>\n<li>Hepatitis C:\u00a0<strong>IgM Anti-HCV and HCV RNA</strong></li>\n<li>Hepatitis E (The most common cause of acute viral hepatitis in adults):\u00a0IgM and IgG anti-HEV.</li>\n</ul>\n<p>Note: IgM Anti-HDV antibody is not assessed during the investigation of acute hepatitis since it can only occur as a co-infection or super-infection with hepatitis B. Additionally, anti-HDV only appears in the blood 30-40 days after symptom onset.\u00a0</p>\n<p>Note: The history suggests a possibility of feco-oral transmission, implicating hepatitis A and hepatitis E (Patient attending the village fair) and parenteral transmission, implicating hepatitis B and hepatitis C (accidental needle prick). Since the clinical symptoms of acute viral hepatitis are non-specific for the most part, the detection has to be serological.\u00a0Hepatitis A and E are the most common cause of acute hepatitis in children and adults respectively, and therefore should be evaluated for. Additionally, Option D is the best option because it assesses for IgM\u00a0Anti-HBc which is the most reliable marker of acute infection with hepatitis B.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old nurse working in the pulmonary department presented with a productive cough and evening rise in temperature for 3 weeks duration. A chest X-ray is done and it shows cavities in the upper lobe. The clinician suspects pulmonary TB and orders a sputum smear examination on two samples which turn out to be negative. He further advises CB-NAAT which reveals Mycobacterium presence but is indeterminate on Rifampicin resistance. What should be done next as per the recent NTEP guidelines?",
    "choices": [
      {
        "id": 1,
        "text": "Start treatment as drug sensitive TB and continue Intensive phase for 3 months"
      },
      {
        "id": 2,
        "text": "Repeat CB-NAAT testing to ascertain drug resistance before initiating treatment"
      },
      {
        "id": 3,
        "text": "Consider taking fresh sample and test it using line probe assay to detect resistance"
      },
      {
        "id": 4,
        "text": "Start treatment with MDR TB regimen using oral drugs only for 18 months"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>As per the NTEP guidelines, <strong>repeat CB-NAAT</strong> testing <strong>to ascertain drug resistance,&nbsp;</strong>needs to be carried out <strong>if the first sample tested is</strong> <strong>Rif indeterminate/inconclusive.</strong></p>\n<p>The given case with the typical symptoms of <strong>evening rise of temperature</strong> and <strong>productive cough</strong> of <strong>more than 2 weeks</strong> duration with chest x-ray showing <strong>upper lobe</strong><strong>&nbsp;cavities </strong>prompts a diagnosis of <strong>pulmonary tuberculosis. </strong>The<strong> initial diagnosis</strong> of pulmonary TB is done with <strong>sputum smear examination and chest radiography</strong>. In this case,<strong> despite 2 negative sputum samples</strong>, a <strong>chest X-ray is suggestive</strong> of tuberculosis. Hence <strong>CB-NAAT was performed</strong>.&nbsp;</p>\n<p>In cases of<strong> high clinical suspicion</strong>,<strong> Smear is negative but CXR findings are suggestive</strong>, or in<strong> people with HIV</strong>, a <strong>CB-NAAT is done.</strong> Cartridge-based nucleic acid amplification <strong>(CBNAAT) detects</strong> the presence of <strong>Mycobacterium DNA</strong> along with <strong>resistance against Rifampicin</strong> within 2 hours. It analyses sputum or any other biological specimen (except blood and blood-contaminated specimens) using real-time PCR technology</p>\n<p>If Rifampicin resistance is absent, it is treated as drug-sensitive TB.&nbsp;If Rifampicin resistance is present, it is treated as drug-resistant TB.&nbsp;</p>\n<p>However, if the sample turns out to be <strong>intermediate/inconclusive</strong>, <strong>CB-NAAT is repeated</strong> using 2nd sample.</p>\n<ul>\n<li>If the <strong>2nd sample</strong> turns out to be <strong>positive</strong> for Rifampicin resistance, the patient is <strong>treated as Rifampicin resistant</strong></li>\n<li>If the <strong>2nd sample</strong> turns out to be <strong>negative</strong> for Rifampicin resistance, the patient is <strong>treated as drug-sensitive</strong></li>\n<li>If the <strong>2nd sample also</strong> turns out to be <strong>indeterminate</strong>, a <strong>fresh sample </strong>is taken for <strong>Line probe assay or liquid culture</strong>, to ascertain drug resistance.</li>\n</ul>\n<p>A <strong>positive smear</strong> examination<strong> irrespective of CXR findings</strong> is diagnosed as <strong>microbiologically confirmed TB</strong> and<strong> started on ATT</strong>. <strong>Drug sensitivity is done</strong> for all new cases due to increasing resistance. Once these drug sensitivity results are available,<strong> treatment </strong>can be <strong>modified,</strong> <strong>if resistance is found.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 17-year-old female presents with severe cramping in her legs while exercising in the gym. She has been experiencing these symptoms for the past few months. On examination, radial pulse is 88 beats/min, and distal pulses of the lower limb are barely palpable. Blood pressure is 144/88 mmHg in the right arm and 108/70 mmHg in the right leg. The obtained chest x-ray image is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Total anomalous pulmonary venous return"
      },
      {
        "id": 2,
        "text": "Takayasu arteritis"
      },
      {
        "id": 3,
        "text": "Ebstein anomaly"
      },
      {
        "id": 4,
        "text": "Coarctation of the aorta"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p style=\"text-align: left;\">The clinical vignette and chest x-ray showing<strong> notching of ribs</strong> strongly point towards the diagnosis of\u00a0<strong>coarctation of the aorta</strong>.\u00a0</p>\n<p style=\"text-align: left;\">Coarctation of the aorta is a congenital heart defect characterized by the <strong>narrowing </strong>of the <strong>thoracic aorta</strong> near the insertion of the ductus arteriosus. According to the site of constriction, it is classified into the following types:</p>\n<ul style=\"text-align: left;\">\n<li><strong>Preductal</strong>:\u00a0constriction <strong>proximal</strong> to the <strong>ductus arteriosus\u00a0</strong>(infantile type)</li>\n<li><strong>Postductal</strong>:\u00a0constriction <strong>distal</strong> to the <strong>ductus arteriosus</strong> (adult type)</li>\n</ul>\n<p style=\"text-align: left;\">Clinical presentation of coarctation of the aorta depends on the extent of constriction and age at the presentation:</p>\n<ul style=\"text-align: left;\">\n<li><strong>Infants</strong> with coarctation of the aorta may present with tachypnea, lethargy, <strong>failure to thrive</strong>, or overt <strong>congestive heart failure</strong>. Clinical signs classically <strong>worsen</strong> after the<strong> closure of\u00a0ductus arteriosus.</strong></li>\n<li><strong>Adults</strong> may present with non-specific symptoms, such as headaches and nose bleeds, or <strong>claudication</strong>\u00a0of the lower limbs, which is experienced as cramping pain that increases on exertion.</li>\n</ul>\n<p style=\"text-align: left;\">Coarctation of the aorta is associated with the bicuspid aortic valve, berry aneurysm, and Turner syndrome.</p>\n<p style=\"text-align: left;\"><strong>Physical examination</strong> findings:</p>\n<ul style=\"text-align: left;\">\n<li>Bounding upper limb pulses (radial, carotid) and weak lower limb pulses (femoral,\u00a0popliteal, posterior tibial, and dorsalis pedis)</li>\n<li>Increased radio-femoral delay</li>\n<li>Hypertension in upper limbs and increased difference in blood pressure between upper and lower limbs</li>\n<li>Continuous like murmur (due to collaterals)</li>\n<li>Systolic ejection click and systolic ejection murmur in the left upper sternal border (due to bicuspid aortic valve)</li>\n</ul>\n<p style=\"text-align: left;\"><strong>Radiologic findings on</strong>\u00a0chest x-ray:</p>\n<ul style=\"text-align: left;\">\n<li><strong>Figure 3 sign\u00a0</strong>- It is pathognomonic of coarctation of the aorta. It occurs due to the indentation of the aorta at the site of coarctation and pre- and post-stenotic dilatation along the left para-mediastinum.</li>\n<li><strong>Notching of ribs</strong>\u00a0- This occurs due to rib erosion by dilated collateral vessels.</li>\n<li>Dilated left subclavian artery and dilated ascending aorta</li>\n</ul>\n<p style=\"text-align: left;\">It can be diagnosed using x-ray, CT or MRI, or cardiac catheterization. It is definitively managed surgically or with balloon dilation.\u00a0</p>\n<p style=\"text-align: left;\">The <strong>figure of 3 sign</strong>\u00a0is shown in the image below.<strong>\u00a0</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/af1b1fd503a642c3b6c007d3fc96ec26.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a12cd87d5a494f519d4f0f478426a77bx413x529.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/86538a89afba4fddbdd4fad72aa1e5e3x1280x1561.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6ca372eca6cf41e78ecd9fdaaef9b06ax1200x1429.GIF"
    ]
  },
  {
    "text": "A 10-year-old child is brought for evaluation of repeated lung infections. The bronchial fluid samples show gram-negative, oxidase-positive bacteria that produce a bluish-green pigment. He also has been experiencing foul-smelling diarrhea with pale, floating stools. What is the mode of inheritance of the condition that the child is most likely to have?",
    "choices": [
      {
        "id": 1,
        "text": "Mitochondrial"
      },
      {
        "id": 2,
        "text": "X-linked dominant"
      },
      {
        "id": 3,
        "text": "Autosomal recessive"
      },
      {
        "id": 4,
        "text": "Autosomal dominant"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Repeated lung infections</strong> and <strong>steatorrhea</strong> (foul-smelling diarrhea with pale, floating stools) suggest a diagnosis of<strong> cystic fibrosis.</strong>&nbsp;It has an <strong>autosomal recessive</strong> inheritance pattern.&nbsp;Gram-negative, oxidase-positive bacteria that produce a blue-green pigment indicate infection with&nbsp;<em><strong>Pseudomonas aeruginosa</strong>,&nbsp;</em>which is commonly seen in this condition.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child born in March 2019 at the district hospital is brought to you by his mother. She states that he was given all vaccines till 1 year of age but she did not take him for vaccination since April 2020- till now due to lockdown. She is however apprehensive of her child's health and wants to immunize him. Which of the following vaccines can be given to the child now?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, and 3 Only"
      },
      {
        "id": 2,
        "text": "2 and 4 Only"
      },
      {
        "id": 3,
        "text": "1, 2, 3, and 4"
      },
      {
        "id": 4,
        "text": "Vaccination needs to restart since there has been a gap of 1 year in booster doses"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In this case of <strong>drop-out vaccination</strong> (started vaccination but did not complete it), all 4 mentioned vaccines can be given.</p>\n<p><strong>Catch-up vaccination</strong> involves the administration of vaccines in children who have <strong>not been immunized at all (left-outs)</strong> or for children who <strong>took vaccines, but couldn't complete the course(dropouts)</strong>.&nbsp;Efforts should be made to ensure that all vaccines are given at the recommended ages, or closer to it. However, certain vaccines have an age limit till which they can be given. This is because the child develops immunity against a few diseases or is no longer vulnerable.&nbsp;</p>\n<p>BCG can only be given up to 1 year of age, according to the National Immunisation Schedule.&nbsp;</p>\n<p>Please note that BCG can be given up to 5 years of age, as part of the catch-up immunization schedule which is by the Indian Academy of Paediatrics and that is not followed in government setups.</p>\n<p><strong>OPV</strong> can be given<strong> till 5 years</strong> of age.</p>\n<p><strong>Measles</strong> can be given <strong>till 5 years</strong> of age.</p>\n<p><strong>DPT</strong> can be given<strong> until 7 years</strong> of age (with booster doses).</p>\n<p>Only the above-mentioned vaccines have upper age limits.&nbsp;</p>\n<p>For pentavalent, IPV, PCV, and Rotavirus vaccines, if at least one dose is given before one year of age, then remaining doses can be administered and the schedule must be completed irrespective of the age of the child. If the first dose is not administered before one year of age, then these vaccines cannot be administered to the child under UIP.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 24-year old female G1P0L0 at 12 weeks of gestation complains of burning micturition, vaginal pruritus, and increased frequency of urination. On examination, her vitals are stable. There is no suprapubic or costovertebral angle tenderness. On per vaginal examination, there is redness of the cervix. Urine analysis is positive for leukocyte esterase but negative on Gram staining. Cervical swab Gram staining also does not show any organisms. Which of the following is the treatment of choice in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Azithromycin alone"
      },
      {
        "id": 2,
        "text": "Doxycycline alone"
      },
      {
        "id": 3,
        "text": "Azithromycin + doxycycline"
      },
      {
        "id": 4,
        "text": "Azithromycin + ceftrioxone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above clinical scenario is suggestive of <strong>Chlamydial cervicitis </strong>and is treated with<strong>&nbsp;azithromycin </strong>in<strong> pregnant women</strong>.</p>\n<p>Chlamydia trachomatis is a <strong>gram-negative obligate intracellular bacteria</strong> and is a common cause of sexually transmitted infections.&nbsp;</p>\n<p>Smears prepared from urethral and cervical secretions are used for diagnosis. As these organisms <strong>lack muramic acid</strong> in the cell wall, they <strong>do not stain</strong> well on <strong>gram staining</strong>. Diagnosis can be made through<strong> PCR (gold standard)</strong>, fluorescent antibody stain, or Giemsa stain.&nbsp;<strong>NAATs are the most sensitive tests</strong> for these specimens and therefore are <strong>recommended for detecting C. trachomatis infection.</strong></p>\n<p>Chlamydia trachomatis infection is <strong>most often asymptomatic but may present as urethritis, cervicitis, vulvovaginitis, and pelvic inflammatory disease</strong> in women.&nbsp;Chlamydial infection in pregnancy can lead to abortion, intrauterine growth restriction, and pre-term labor. Chlamydial infections can be transmitted to the baby during birth causing conjunctivitis, nasopharyngitis, otitis media, and pneumonia.</p>\n<p>Treatment with <strong>azithromycin (1 g orally single dose) or doxycycline (100 mg BD for 7 days)</strong> is advised <strong>both to the patient and her sexual partner.</strong> In <strong>pregnant women</strong> like this patient, <strong>doxycycline</strong> is <strong>contraindicated </strong>due to <strong>teratogenicity</strong>. Other drugs which can be used safely in pregnant women with chlamydia include erythromycin and amoxicillin.&nbsp;</p>\n<p><strong>Ceftriaxone</strong> (500 mg IM single dose) is added empirically when there is a suspicion of <strong>gonococcal infection.</strong> It presents with purulent white discharge. In gonococcal cervicitis, gram staining of cervical swabs shows gram-negative diplococci.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 64-year-old male patient who is being treated for diabetic ketoacidosis suddenly becomes hypotensive. His pulse rate is thready and rapid with BP 88/54 mm Hg.  An electrocardiogram is obtained, and laboratory tests are given below. What is the most appropriate management for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Quinidine"
      },
      {
        "id": 2,
        "text": "Magnesium sulfate"
      },
      {
        "id": 3,
        "text": "Dofetilide"
      },
      {
        "id": 4,
        "text": "Disopyramide"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given ECG depicts <strong>torsades de pointes</strong> which is a type of polymorphic ventricular tachycardia.\u00a0The most appropriate management for this patient would be<strong> </strong>IV <strong>magnesium sulfate </strong>infusion.\u00a0</p>\n<p>Polymorphic ventricular tachycardia is characterized by variable QRS morphologies, meaning each QRS complex looks different from another, as they arise from <strong>different ventricular sites</strong>. Torsades de pointes means \u201ctwisting of the points,\u201d as it appears as though the QRS axis is twisting around the baseline.\u00a0</p>\n<p>These patients usually present with <strong>palpitations</strong>, <strong>dizziness</strong>, or<strong> syncope</strong>. The laboratory results may reveal the underlying cause such as <strong>hypomagnesemia</strong> and <strong>hypokalemia</strong>.</p>\n<p><strong>QT interval prolongation </strong>(caused due to a delay in repolarization of the ventricles) is a predisposing factor for torsades de pointes. It can be caused due to:</p>\n<p>Inherited QT prolongation syndromes:</p>\n<ul>\n<li>Jervell and Lange Neilson syndrome</li>\n<li>Ramano-Ward syndrome.</li>\n</ul>\n<p>Acquired causes:</p>\n<ul>\n<li>Drugs like <strong>quinidine</strong>,<strong> procainamide</strong>,<strong> disopyramide</strong>,<strong>\u00a0</strong>and <strong>dofetilide</strong></li>\n<li>Bradycardia</li>\n<li>Acute ischemia or infarction.</li>\n</ul>\n<p>The <strong>drug of choice</strong> for the management of torsades de pointes is <strong>IV magnesium sulfate infusion</strong>. It acts by suppressing early after-depolarizations that are responsible for arrhythmia, by preventing the entry of calcium into the cell. Other measures include discontinuation of the offending drug, correction of underlying electrolyte abnormalities, pH, and hypoxia. Definitive treatment includes electrical pacing.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5142c73bdd7e4ef2a03f4d8bc888bc3c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old male from a hilly area presented to the casualty with dyspnea. On examination, he had a neck swelling which moved with deglutition but with no visible lower border. There was an associated plethora of the face which was increased by overhead abduction of both arms. Chest radiograph revealed a widened mediastinum. During surgery to remove the swelling, the marked structure was found visibly compressed. What is the usual embryological origin of the marked structure?",
    "choices": [
      {
        "id": 1,
        "text": "Right anterior cardinal vein and right common cardinal vein"
      },
      {
        "id": 2,
        "text": "Left anterior cardinal vein and left common cardinal vein"
      },
      {
        "id": 3,
        "text": "Left posterior cardinal vein and right common cardinal vein"
      },
      {
        "id": 4,
        "text": "Right posterior cardinal vein and left common cardinal vein"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The marked structure shows <strong>superior vena cava(SVC)</strong> formed by the joining of the brachiocephalic vein. The symptoms described are likely due to compression of the SVC by a\u00a0<strong>retrosternal goiter </strong>giving rise to Superior vena cava syndrome.</p>\n<p>The<strong> formation of the vena cava system</strong> begins with the formation of anastomoses between the right and left venous channels. Formation of the major veins takes place as follows:\u00a0</p>\n<ul>\n<li>The <strong>proximal part</strong> of the <strong>right anterior cardinal vein</strong> along with the <strong>right common cardinal vein</strong> form the <strong>superior vena cava</strong></li>\n<li>The <strong>distal part</strong> of the <strong>right anterior cardinal vein</strong>\u00a0between the junction with the subclavian vein and the junction with the transverse anastomosis becomes the <strong>right brachiocephalic vein</strong></li>\n<li>The <strong>distal part</strong> of the <strong>left anterior cardinal vein</strong>\u00a0and the <strong>transverse anastomosis</strong> becomes the <strong>left brachiocephalic vein</strong>\u00a0</li>\n<li>The <strong>most cranial part</strong> of both the <strong>anterior cardinal veins</strong>\u00a0above its junction with the subclavian vein become the <strong>internal jugular vein</strong></li>\n</ul>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/29809184093b4f1e800cef47c7067156.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1e249379f2e44becaff042a864f898c0x1280x1984.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b754cd89268b4d30aca1847706f5d387x550x219.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/95ed1709e7aa4e55b53986225298b941x481x516.PNG"
    ]
  },
  {
    "text": "A 36-year old woman P1L1, comes to the gynecologist for contraceptive advice. She mentions multiple times that her work is highly stressful with no clear timings, that it includes long hours of standing, and that she smokes heavily. She informs that she wishes to conceive in the future and emphasizes that this is important to her. She has regular cycles but complains of heavy menstrual bleeding with dysmenorrhea lasting for 5-6 days every cycle. Which of the following contraceptive methods is the best suited for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Combined oral contraceptive pill"
      },
      {
        "id": 2,
        "text": "Norplant"
      },
      {
        "id": 3,
        "text": "Progestin - only pill"
      },
      {
        "id": 4,
        "text": "Copper - T IUD"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>most suitable contraceptive</strong> for this woman is <strong>Norplant</strong>.</p>\n<p><strong>Norplant</strong> is a <strong>subdermal implant</strong> of <strong>progesterone</strong> aimed at a slow, sustained release, long-acting effect, and reduced side effects. The implants suppress ovulation in 50% but the main action is suppressing endometrium.&nbsp;</p>\n<p>The implants can be inserted on the first day of the menstrual cycle, within 5 days of abortion, and 3 weeks after the delivery. The woman needs to use barrier contraception or abstain in the first 7 days post-insertion.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 26-year-old woman comes for a follow-up, 1 week after her first child was born. Her husband reports that his wife appears uninterested in taking care of the baby, has sudden crying outbursts and seems sad for no reason for the last 2 days. Her sleep is disturbed and she feels fatigued. She is able to carry out the daily chores and enjoys watching television like before. The most likely diagnosis is?",
    "choices": [
      {
        "id": 1,
        "text": "Postpartum blues"
      },
      {
        "id": 2,
        "text": "Postpartum depression"
      },
      {
        "id": 3,
        "text": "Postpartum psychosis"
      },
      {
        "id": 4,
        "text": "Postpartum delirium"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given scenario, the patient has <strong>mild depressive symptoms </strong>within the <strong>first week </strong>of <strong>delivery</strong>. So the most likely diagnosis is\u00a0<strong>postpartum blues</strong>.</p>\n<p class=\"p1\">Postpartum blues, also called <strong>maternity blues</strong>, typically develop <strong>within one week </strong>of <strong>delivery, </strong>usually on the fourth or fifth postpartum day. The affected mothers are <strong>emotionally labile</strong> and the symptoms include changes in mood, <strong>sudden crying outbursts</strong>, and a\u00a0<strong>lack </strong>of<strong> interest</strong> in the<strong> baby</strong>. They may also have insomnia, anxiety, poor concentration, and irritability.</p>\n<p class=\"p1\">These feelings have been ascribed to rapid changes in women's hormonal levels, the stress of childbirth, and the awareness of the increased responsibility that motherhood brings. This usually <strong>resolves spontaneously</strong> within <strong>10-14 days</strong>.\u00a0</p>\n<p class=\"p1\">Management involves <strong>reassurance, education,\u00a0</strong>and <strong>support.</strong> The patient must be followed-up and assessed for the possible development of a major depressive disorder.</p>\n<p class=\"p1\">Other options:</p>\n<p class=\"p1\">Option B: Symptoms should<strong> persist </strong>for<strong> &gt;2 weeks</strong> to make the diagnosis of <strong>post-partum depression.</strong> A <strong>minimum</strong> of <strong>5 symptoms</strong> of major depressive disorder i.e. impaired sleep, interest, guilt, energy, concentration, appetite, psychomotor activity, and suicidal ideation must be present. This patient is able to do her daily chores, enjoys watching TV, has a good appetite, and does not have guilt or suicidal ideation. Although this patient has disturbed sleep and fatigue, these are common physiological postpartum findings.</p>\n<p class=\"p1\">Option C:<strong> Post-partum psychosis</strong> is a <strong>psychiatric</strong> <strong>emergency</strong> and usually has a mean time of onset is <strong>2-3</strong> <strong>weeks postpartum</strong>. The predominant symptoms are <strong>hallucinations</strong>, <strong>delusions</strong>, <strong>suicidal</strong> <strong>thoughts</strong>, and<strong> thoughts</strong> of <strong>harming </strong>the <strong>baby</strong>. The onset of psychotic symptoms is usually preceded by signs such as insomnia, restlessness, labile mood, and agitation. <strong>Lithium</strong>, often in combina\u00adtion with an <strong>antidepressant</strong>, is the treatment of choice.</p>\n<p class=\"p1\">Option D: Episodes of\u00a0<strong>delirium </strong>in the <strong>postpartum period</strong> are characterized by a <strong>fluctuating</strong> <strong>level</strong> of <strong>awareness</strong> or attention. In this patient, there is no altered sense of awareness.</p>\n<p>Note:\u00a0 Zuranolone is the first-ever oral drug to be approved specifically for the treatment of postpartum depression. It is a neuroactive steroid that enhances the action of GABA in the brain and regulates mood.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Neet 2021 Mini Test 1  (20 Questions)';
        const quizFilename = 'neet-2021-mini-test-1-20-questions-d1fc3348.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2020-21"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>