<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>219 Medicine Neet 2021 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">21</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 37-year-old woman presents with headaches for 6 months. She has been taking analgesics regularly. The headache recently increased in severity for 3 days but was reduced on stopping the analgesic. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Medication overuse headache"
      },
      {
        "id": 2,
        "text": "Tension headache"
      },
      {
        "id": 3,
        "text": "Chronic migraine"
      },
      {
        "id": 4,
        "text": "Cluster headache"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical features are suggestive of <strong>medication overuse headache</strong>.</p>\n<p><strong>Medication overuse headache:</strong>&nbsp;</p>\n<p>It is also known as&nbsp;analgesic rebound headache, drug-induced headache, or medication-misuse headache. In this condition medications that are used for the treatment of headaches become the cause for headaches. It usually resolves when the overuse is stopped.</p>\n<p>Diagnostic criteria: According to <strong>ICHD-3&nbsp;</strong>(International Classification of Headache Disorders-3)</p>\n<ul>\n<li>Headache occurring on &ge;15 days/month in a patient with a pre-existing headache disorder</li>\n<li>Regular overuse for &gt;3 months of one or more drugs that can be taken for acute and/or symptomatic treatment of headache.</li>\n<li>Not better accounted for by another ICHD-3 diagnosis.</li>\n</ul>\n<p>Management: It includes the following steps:</p>\n<ul>\n<li>Withdrawal of the overused medication</li>\n<li>Rescue therapy or the treatment of withdrawal symptoms</li>\n<li>Initiation of preventative therapy if required</li>\n<li>Alternative symptomatic medication for future headaches</li>\n</ul>\n<p>Other options:</p>\n<p>Option B: <strong>Tension headache&nbsp;</strong>is a chronic headache syndrome characterized by<strong> bilateral, tight band-like discomfort.&nbsp;</strong>It can be episodic or chronic in nature. It is usually not associated with nausea, vomiting, photophobia, photophobia, etc.</p>\n<p>Option C:<strong> Chronic migraine -</strong>&nbsp;Diagnostic criteria for migraine headache is as follows:&nbsp;Repeated attacks of headache lasting 4-72 hours in patients with normal physical examination, no other reasonable cause for headache, and</p>\n<table style=\"height: 194px; width: 553.479px;\">\n<tbody>\n<tr>\n<td style=\"width: 257px;\">At least 2 of the following features</td>\n<td style=\"width: 279.479px;\">Plus at least 1 of the following features</td>\n</tr>\n<tr>\n<td style=\"width: 257px;\">Unilateral pain</td>\n<td style=\"width: 279.479px;\">Nausea or vomiting</td>\n</tr>\n<tr>\n<td style=\"width: 257px;\">Throbbing pain</td>\n<td style=\"width: 279.479px;\">Photophobia and phonophobia</td>\n</tr>\n<tr>\n<td style=\"width: 257px;\">Aggravation by movement</td>\n<td style=\"width: 279.479px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 257px;\">Moderate or severe intensity</td>\n<td style=\"width: 279.479px;\">&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>Option D: <strong>Cluster headache</strong>&nbsp;is characterized by deep, excruciating, nonfluctuating pain which is usually <strong>retroorbital</strong>. The classical feature of this condition is its <strong>periodicity</strong>.&nbsp; At least one of the&nbsp;daily attacks of pain recurs at almost the same hour every day.<br />Typically the patient has&nbsp;daily bouts of one or two attacks of relatively short-duration unilateral&nbsp;pain for 8&ndash;10 weeks a year. In between the clusters, there is a pain-free interval.<br /><br /></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old woman presents with breathlessness and chest pain. She is a known case of mitral stenosis. Her pulse is irregularly irregular. No thrombus is seen on echocardiography. What is the best agent to prevent future thrombotic events?",
    "choices": [
      {
        "id": 1,
        "text": "Dabigatran"
      },
      {
        "id": 2,
        "text": "Aspirin 150mg"
      },
      {
        "id": 3,
        "text": "Oral warfarin"
      },
      {
        "id": 4,
        "text": "Aspirin + Clopidogrel"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical presentation of breathlessness, chest pain, and irregularly irregular pulse is suggestive of <strong>atrial fibrillation</strong>. Since the patient is having mitral stenosis <strong>oral warfarin</strong> is the best agent to reduce the risk of thrombotic events.&nbsp;</p>\n<p>Anticoagulation in atrial fibrillation:</p>\n<p>Anticoagulation is indicated for patients with mitral stenosis, hypertrophic cardiomyopathy, previous history of stroke. In nonvalvular atrial fibrillation, the risk of stroke and the need for anticoagulation is assessed with the&nbsp;<strong>CHA2DS2-VASc</strong> score.</p>\n<p>Anticoagulants that can be used include:</p>\n<ul>\n<li>Vitamin K antagonist - Warfarin</li>\n<li>Antithrombin inhibitor - Dabigatran</li>\n<li>Factor Xa inhibitors - Rivaroxaban, Apixaban, and Edoxaban</li>\n</ul>\n<p>In AF patients with <strong>rheumatic mitral stenosis</strong> or mechanical heart valves, the <strong>anticoagulant of choice</strong> is <strong>warfarin</strong>. The newer anticoagulants are not yet tested for rheumatic heart disease.</p>\n<p>Warfarin is a less compliant drug because it requires routine PT/INR monitoring for dose adjustments and has many drug interactions. The newer oral anticoagulants are easy to use and do not require PT/INR monitoring for dose adjustments.</p>\n<p>Bleeding is an important risk of anticoagulation. The newer oral agents have a lower risk of intracranial bleeding when compared to warfarin. The risk factors for bleeding include age &gt;65&ndash;75 years, renal insufficiency, heart failure, prior bleeding, and excessive alcohol or nonsteroidal anti-inflammatory drug use.</p>\n<p><strong>Reversal agents</strong> for anticoagulants are as follows:</p>\n<ul>\n<li>Warfarin - Vitamin K and fresh frozen plasma</li>\n<li>Dabigatran - <strong>Idarucizumab</strong></li>\n<li>Factor&nbsp;Xa inhibitors - <strong>Andexanet alpha</strong> and <strong>Ciraparantag</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Evalutaion of a patient revealed the presence of a mid diastolic murmur. JVP showed prominent a-waves. What is the likely  diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Mitral stenosis"
      },
      {
        "id": 2,
        "text": "Tricuspid stenosis"
      },
      {
        "id": 3,
        "text": "Mitral regurgitation"
      },
      {
        "id": 4,
        "text": "Tricuspid regurgitation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option D: <strong>Holosystolic murmur</strong> is seen in <strong>tricuspid regurgitation (TR).</strong></p>\n<p>TR is most commonly due to functional defects such as tricuspid annular dilatation and leaflet tethering caused by rheumatic heart disease, myocardial infarction, etc.&nbsp;</p>\n<p>The jugular vein is distended. <strong>Prominent c-v waves </strong>and&nbsp;<strong>rapid y descents</strong> are seen in severe TR.&nbsp;</p>\n<p>A blowing <strong>holosystolic murmur</strong> along the lower left sternal margin, which is augmented during inspiration (<strong>Carvallo's sign</strong>) and reduced during expiration is seen in TR.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/afedf9b401a545439056c8e634bec646x1279x706.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bd6a84905d4d4da881aa4d39941d2023x1279x946.JPEG"
    ]
  },
  {
    "text": "A chronic alcoholic male patient presented with abdominal distension, reduced urine output, and pedal edema. His serum creatinine was 1.6 mg/dL. What is the next line of management in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Methylprednisolone"
      },
      {
        "id": 2,
        "text": "Heparin"
      },
      {
        "id": 3,
        "text": "Torsemide"
      },
      {
        "id": 4,
        "text": "Octreotide plus albumin"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><span data-preserver-spaces=\"true\">The given features of abdominal distension in a chronic alcoholic are suggestive of&nbsp;</span><strong><span data-preserver-spaces=\"true\">liver failure</span></strong><span data-preserver-spaces=\"true\">&nbsp;and reduced urine output, pedal edema and elevated serum creatinine are suggestive of&nbsp;</span><strong><span data-preserver-spaces=\"true\">renal failure</span></strong><span data-preserver-spaces=\"true\">. This points towards the diagnosis of&nbsp;</span><strong><span data-preserver-spaces=\"true\">hepatorenal syndrome</span></strong><span data-preserver-spaces=\"true\">. Among the given options,&nbsp;</span><strong><span data-preserver-spaces=\"true\">octreotide plus albumin</span></strong><span data-preserver-spaces=\"true\">&nbsp;will be the next line of management.</span></p>\n<p><span data-preserver-spaces=\"true\">Octreotide is a somatostatin analogue. It causes splanchnic vasoconstriction and improves renal perfusion.&nbsp;Intravenous albumin is a volume expander and is effective in the management of hepatorenal syndrome. It is used in combination with other vasoconstrictor agents like terlipressin or octreotide.</span></p>\n<p><span data-preserver-spaces=\"true\">A</span><strong><span data-preserver-spaces=\"true\">&nbsp;hepatorenal syndrome&nbsp;</span></strong><span data-preserver-spaces=\"true\">is a form of&nbsp;</span><strong><span data-preserver-spaces=\"true\">functional renal failure</span></strong><span data-preserver-spaces=\"true\">&nbsp;without renal pathology that occurs in patients with advanced cirrhosis or acute liver failure.&nbsp;</span></p>\n<p><span data-preserver-spaces=\"true\">There is an increased splanchnic production of vasodilators (nitric oxide) in patients with cirrhosis and portal hypertension. Splanchnic vasodilation leads to systemic arterial underfilling resulting in activation of the renin-angiotensin-aldosterone system (RAAS). RAAS activation causes renal vasoconstriction which leads to decreased renal perfusion resulting in hepatorenal syndrome.</span></p>\n<p><span data-preserver-spaces=\"true\">International Ascites Club&rsquo;s Diagnostic Criteria of Hepatorenal Syndrome:</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Major criteria</span></strong></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Chronic or acute liver disease with advanced hepatic failure and portal hypertension</span></li>\n<li><span data-preserver-spaces=\"true\">Low GFR: serum creatinine &gt;133 &mu;mol/L or 24h creatinine clearance &lt;40 mL/min</span></li>\n<li><span data-preserver-spaces=\"true\">Absence of shock</span></li>\n<li><span data-preserver-spaces=\"true\">Absence of gastrointestinal or renal fluid losses</span></li>\n<li><span data-preserver-spaces=\"true\">No sustained improvement in renal function following diuretic withdrawal and expansion of plasma volume with 1.5 L of isotonic saline</span></li>\n<li><span data-preserver-spaces=\"true\">Proteinuria &lt;0.5 g/d and no ultrasonographic evidence of obstructive uropathy or parenchymal renal disease</span></li>\n</ul>\n<p><strong><span data-preserver-spaces=\"true\">Additional criteria</span></strong></p>\n<ul>\n<li><span data-preserver-spaces=\"true\">Urine volume &lt;0.5 L/d</span></li>\n<li><span data-preserver-spaces=\"true\">Urine sodium &lt;10 mmol/L</span></li>\n<li><span data-preserver-spaces=\"true\">Urine osmolality &gt; plasma osmolality</span></li>\n<li><span data-preserver-spaces=\"true\">Urine red blood cells &lt;50 high power field</span></li>\n<li><span data-preserver-spaces=\"true\">Serum sodium concentration &lt;130 mmol/L</span></li>\n</ul>\n<p><span data-preserver-spaces=\"true\">Treatment:</span></p>\n<p><span data-preserver-spaces=\"true\">The definitive treatment is&nbsp;</span><strong><span data-preserver-spaces=\"true\">liver transplantation.&nbsp;</span></strong></p>\n<p><span data-preserver-spaces=\"true\">Pharmacotherapy mainly consists of drugs that cause splanchnic vasoconstriction. They include vasopressin analogs (</span><strong><span data-preserver-spaces=\"true\">ornipressin, terlipressin</span></strong><span data-preserver-spaces=\"true\">), somatostatin analogs (</span><strong><span data-preserver-spaces=\"true\">octreotide</span></strong><span data-preserver-spaces=\"true\">), and alpha-adrenergic agonists (</span><strong><span data-preserver-spaces=\"true\">midodrine</span></strong><span data-preserver-spaces=\"true\">). Plasma volume expanders are also effective in the treatment of hepatorenal syndrome.</span></p>\n<p><span data-preserver-spaces=\"true\">Other treatment options include dialysis and transjugular intrahepatic portosystemic shunt.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Option C:</span></strong><span data-preserver-spaces=\"true\">&nbsp;Torsemide is a diuretic. It may trigger hepatorenal syndrome because of intravascular volume depletion.&nbsp;</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 68-year-old man presents with cough with yellowish sputum. Auscultation revealed bronchial breath sounds. He is hemodynamically stable and not confused. On examination, his respiratory rate is 20/min and blood pressure is 110/70 mmHg. Lab reports show urea levels of 44 mg/dL. What is the next best step in the management of this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Give antibiotics and send the patient home"
      },
      {
        "id": 2,
        "text": "Admit to ICU without mechanical ventilation"
      },
      {
        "id": 3,
        "text": "Admit to ICU with invasive mechanical ventilation"
      },
      {
        "id": 4,
        "text": "Consider  admission in a non-ICU setting"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient should be considered for <strong>admission in a non-ICU setting.</strong></p>\n<p>Productive cough along with auscultatory findings of bronchial breath sounds in this patient is suggestive of <strong>community-acquired pneumonia.&nbsp;</strong></p>\n<p>The next step is to determine&nbsp;the need for hospitalization in community-acquired pneumonia&nbsp;based on the<strong>&nbsp;CURB-65 score</strong>.</p>\n<p><strong>CURB-65 scoring:</strong></p>\n<div class=\"page\" title=\"Page 1\">\n<table style=\"height: 353px; width: 383px;\"><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"width: 317.296875px;\"><strong>&nbsp;Clinical factor</strong></td>\n<td style=\"width: 55.703125px;\"><strong>&nbsp;Score</strong></td>\n</tr>\n<tr>\n<td style=\"width: 317.296875px;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>C</strong>onfusion</p>\n</div>\n</div>\n</td>\n<td style=\"width: 55.703125px; text-align: center;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>1</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 317.296875px;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Blood <strong>u</strong>rea nitrogen &gt; 20 mg/dL (&gt; 7 mmol/L)</p>\n</div>\n</div>\n</td>\n<td style=\"width: 55.703125px; text-align: center;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>1</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 317.296875px;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>R</strong>espiratory rate &ge; 30 breaths per minute</p>\n</div>\n</div>\n</td>\n<td style=\"width: 55.703125px; text-align: center;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>1</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 317.296875px;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Systolic <strong>b</strong>lood pressure &lt; 90 mm Hg or</p>\n<p>Diastolic <strong>b</strong>lood pressure &le; 60 mm Hg</p>\n</div>\n</div>\n</td>\n<td style=\"width: 55.703125px; text-align: center;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>1</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 317.296875px;\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Age &ge; <strong>65</strong> years</p>\n</div>\n</div>\n</td>\n<td style=\"width: 55.703125px; text-align: center;\">1&nbsp;</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>The table below shows the decision based on the CURB-65 score:</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Total Score</strong></td>\n<td><strong>Decision</strong></td>\n</tr>\n<tr>\n<td>0</td>\n<td>Treated as outpatient</td>\n</tr>\n<tr>\n<td>1 or 2</td>\n<td>Admission to the hospital</td>\n</tr>\n<tr>\n<td>3 or more</td>\n<td>Admission in ICU</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Calculating the CURB-65 score for the case given in the question:</strong></p>\n<ul>\n<li><strong>No confusion </strong>(score = 0)</li>\n<li><strong>Urea</strong> is 44 mg/dL (score = 1)</li>\n<li><strong>Respiratory</strong> rate is 20/min (score = 0)</li>\n<li><strong>Blood</strong> <strong>pressure</strong> is 110/70 mmHg (score = 0)</li>\n<li>Age is <strong>68 years</strong> (score = 1)</li>\n</ul>\n<p>Therefore, the <strong>total score is 2</strong>, and the patient requires<strong> hospitalization in a non-ICU setting</strong> (medical ward).</p>\n<p>Treatment in a non-ICU setting includes respiratory fluoroquinolones (moxifloxacin) or a beta lactam antibiotic (cephalosporins) plus a macrolide (azithromycin/clarithromycin).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man presented with excessive fatiguability towards the end of the day that improved with rest. He also gives a history of ptosis and difficulty in speech and swallowing. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Myasthenia gravis"
      },
      {
        "id": 2,
        "text": "Lambert-Eaton syndrome"
      },
      {
        "id": 3,
        "text": "Duchenne muscular dystrophy"
      },
      {
        "id": 4,
        "text": "Systemic lupus erythematosus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option D:</p>\n<p><strong>Systemic lupus erythematosus</strong> (SLE) is an autoimmune disease that most commonly presents with arthralgia with early morning stiffness. It predominantly occurs in <strong>middle-aged women</strong>.&nbsp;Other important features of SLE include malar rash, discoid rash, photosensitivity, oral ulcers, pleuritis, pericarditis, and lupus nephritis.</p>\n<p><strong>Anti-nuclear antibodies</strong>, <strong>Anti-dsDNA</strong> antibodies, <strong>anti-Smith</strong> antibodies are positive in SLE.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman with hysteria who was hyperventilating developed carpo-pedal spasm. What could be the likely cause for this?",
    "choices": [
      {
        "id": 1,
        "text": "Respiratory acidosis"
      },
      {
        "id": 2,
        "text": "Metabolic acidosis"
      },
      {
        "id": 3,
        "text": "Respiratory alkalosis"
      },
      {
        "id": 4,
        "text": "Metabolic alkalosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image below shows <strong>Chvostek's sign.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c57748f5f0814bb382575ab1a67d4274x289x240.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/212f7d34a038422299f5101d0045b087x230x277.PNG"
    ]
  },
  {
    "text": "A 10-year old child presented with recurrent pulmonary infections, and bulky greasy stools. Quantitative estimation of the stool fat was more than 10gm/day. Which of the following will be seen in this child?",
    "choices": [
      {
        "id": 1,
        "text": "Protein losing enteropathy"
      },
      {
        "id": 2,
        "text": "Distal intestinal obstruction"
      },
      {
        "id": 3,
        "text": "Hypernatremia"
      },
      {
        "id": 4,
        "text": "Rectal prolapse occurs after treatment"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Cystic fibrosis </strong>is an&nbsp;autosomal recessive exocrinopathy affecting multiple epithelial tissues caused primarily due to a mutation in the CF transmembrane conductance regulator [CFTR] gene which serves as an anion channel in the apical membranes of epithelial cells and regulates the volume and composition of exocrine secretion. A defect in this gene results in thick, hyper-viscous exocrine secretions which lead to the primary pathologies seen in cystic fibrosis.</p>\n<p class=\"p1\"><strong>Disease manifestations include</strong>:</p>\n<ul>\n<li class=\"p1\"><span class=\"s1\"><strong>Respiratory:</strong></span>&nbsp;Copious hyper-viscous and adherent pulmonary secretions obstruct small and medium-sized airways leading to respiratory compromise. Bacterial flora (including&nbsp;<strong><em>Staphylococcus aureus, Haemophilus influenzae</em>, and&nbsp;</strong><em><strong>Pseudomonas aeruginosa)</strong>&nbsp;</em>is routinely cultured from CF sputum.</li>\n<li class=\"p1\"><strong>Pancreas:</strong>&nbsp;Thick and adherent exocrine secretions&nbsp;obstruct pancreatic ducts and impair the production and flow of digestive enzymes. There is tissue destruction of the exocrine pancreas, with fibrotic scarring, cyst proliferation, and loss of acinar tissue.</li>\n<li class=\"p1\"><strong>Hepatic:</strong>&nbsp;Obstruction of intrahepatic bile ducts and parenchymal fibrosis leading to hepatic insufficiency and&nbsp;multilobular cirrhosis.</li>\n<li class=\"p1\"><strong>GIT:</strong>&nbsp;Contents of the intestinal lumen are often difficult to excrete, leading to meconium ileus in the newborns and <strong>distal intestinal obstructive syndrome</strong> in adults. With early diagnostic modalities and pancreatic enzyme replacement therapy, the occurrence of rectal prolapse is fairly rare.</li>\n<li class=\"p1\"><strong>Infertility:</strong>\n<ul>\n<li class=\"p1\"><strong>Males</strong>- developmental abnormality secondary to improper secretion by the vas or associated structures leading to complete involution of the vas deferens and infertility. About 99% of males with CF are infertile</li>\n<li class=\"p1\"><strong>Females</strong>-&nbsp; abnormalities of the reproductive tract secretions leads&nbsp;to an increased incidence of infertility</li>\n</ul>\n</li>\n<li class=\"p1\"><strong>Sinusitis:</strong>&nbsp;Present in most CF patients</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 36-year-old woman presented with claudication in the forearm, transient loss of vision, and abdominal pain. Femoral pulses were weak. Fundus examination revealed retinal hemorrhages. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Polyarteritis nodosa"
      },
      {
        "id": 2,
        "text": "Thromboangitis obliterans"
      },
      {
        "id": 3,
        "text": "Takayasu arteritis"
      },
      {
        "id": 4,
        "text": "Microscopic polyangitis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of a patient presenting with <strong>claudication</strong> in the <strong>forearm</strong>, <strong>weak femoral pulses,</strong> abdominal pain and <strong>transient loss of</strong> <strong>vision</strong> is suggestive of <strong>Takayasu arteritis.&nbsp;</strong></p>\n<p>A patient with <strong>polyarteritis nodosa</strong> will present with abdominal pain, renal involvement, and hypertension. Musculoskeletal symptoms present as arthralgia, arthritis, or myalgia. The presence of large vessel symptoms such as claudication in the forearm and weak femoral pulses makes the diagnosis of polyarteritis nodosa unlikely <strong>(option A).&nbsp;</strong></p>\n<p>Takayasu arteritis is a chronic inflammatory <strong>medium- and large- vessel vasculitis</strong> that commonly affects adolescents and&nbsp;<strong>young females. </strong>It&nbsp;mainly involves the <strong>aortic arch </strong>and its branches. Depending on the artery occluded, patients present with the following symptoms:</p>\n<ul>\n<li><strong>Subclavian artery</strong> (most common) -&nbsp;pain, numbness, <strong>claudication</strong>, and <strong>weak or absent radial pulses</strong> on the affected side</li>\n<li>Common carotid artery - visual&nbsp;symptoms, syncope, and stroke</li>\n<li>Abdominal aorta, superior mesenteric artery, and coeliac axis - <strong>abdominal pain</strong>, nausea, vomiting</li>\n<li>Renal artery - <strong>hypertension</strong> and renal failure</li>\n<li>Aortic arch or root - aortic insufficiency, heart failure</li>\n<li>Pulmonary artery - atypical chest pain, dyspnea</li>\n<li>Coronary artery - chest pain, myocardial infarction</li>\n<li>Iliac artery - Leg <strong>claudication</strong>, weak/absent pulses in the periphery</li>\n</ul>\n<p>Patients also have constitutional symptoms such as malaise, fever, night sweats, weight loss, etc.</p>\n<p>Investigations:</p>\n<ol>\n<li>Lab reports reveal an elevated ESR level, anemia, and elevated immunoglobulin levels.</li>\n<li><strong>Arteriography</strong> is done as a confirmatory test.</li>\n</ol>\n<p>Treatment includes <strong>glucocorticoid</strong> therapy, methotrexate, immunotherapy with anti-TNF agents, and surgery of the stenosed vessels.</p>\n<p><strong>Other options:&nbsp;</strong></p>\n<p><strong>Option A:</strong> <strong>Polyarteritis nodosa (PAN)</strong> is necrotizing arteritis of the medium-sized blood vessels. It can affect the skin, peripheral nerves, renal vessels, mesenteric vessels, heart, and brain. Lungs are usually spared in PAN.The disease initially starts with non-specific symptoms like fever, malaise, arthralgia, and myalgia. Later, depending on the artery involved, patients may develop the following symptoms:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Skin findings - ulcers, digital gangrene, subcutaneous nodules, and livedo reticularis</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Renal arteries - hypertension and renal failure</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Mesenteric arteries - abdominal pain, nausea, vomiting, bleeding, and a bowel perforation</li>\n</ul>\n<p>Patients can have musculoskeletal symptoms (arthralgia, myalgia) and mononeuritis multiplex.</p>\n<p><strong>Option B:</strong> <strong>Thromboangiitis obliterans,</strong> also known as <strong>Buerger's disease,</strong> is an inflammatory occlusive vascular disorder involving medium- and small-sized vessels in the distal extremities. It is most frequently seen in male smokers less than 40 years of age.The patient presents with a triad of claudication of the distal extremities, Raynaud's phenomenon, and migratory superficial vein thrombophlebitis. Proximal pulses (brachial artery, femoral artery, popliteal artery) are normal. But distal pulses (radial, ulnar, tibial artery) are weak/absent.</p>\n<p><strong>Option D:</strong> <strong>Microscopic polyangiitis</strong> is a necrotizing vasculitis affecting small- and medium-sized vessels. It occurs most commonly in elderly males. Patients can present with non-constitutional symptoms such as fever, weight loss, and musculoskeletal pain. Renal involvement is very common (79%) in the form of glomerulonephritis, which can rapidly progress, causing renal failure. It is also associated with mononeuritis multiplex, alveolar hemorrhage (present with hemoptysis as 1st symptom), and cutaneous vasculitis. Lab findings include anemia, raised ESR and or CRP, leukocytosis, thrombocytopenia, and ANCA positive in 75% of patients,</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A diabetic woman is admitted with complaints of vomiting. She gives a history of consuming food from outside. On evaluation, her blood pressure is 90/60 mmHg. Her arterial blood gas (ABG) report shows the following findings. What is the cause of her ABG findings?",
    "choices": [
      {
        "id": 1,
        "text": "Diabetic ketoacidosis"
      },
      {
        "id": 2,
        "text": "Persistent vomiting"
      },
      {
        "id": 3,
        "text": "Septic shock"
      },
      {
        "id": 4,
        "text": "Renal tubular acidosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Other options:</p>\n<p>Option A: Diabetic ketoacidosis is associated with <strong>high anion gap metabolic acidosis</strong> along with hyponatremia and hypochloremia. It may initially present with hyperkalemia.</p>\n<p>Option C: <strong>Septic shock</strong> is characterized by <strong>high anion gap</strong> <strong>metabolic acidosis</strong>.</p>\n<p>Option D: Renal tubular acidosis is characterized by <strong>hyperchloremic</strong>,&nbsp;<strong>normal anion gap metabolic acidosis.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents with fever, nocturnal cough, breathlessness, and wheezing for 4 weeks. Absolute eosinophil count >5000/\u03bcL. Chest  X-ray shows a miliary pattern. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Bronchial asthma"
      },
      {
        "id": 2,
        "text": "Miliary tuberculosis"
      },
      {
        "id": 3,
        "text": "Tropical pulmonary eosinophilia"
      },
      {
        "id": 4,
        "text": "Hypersensitivity pneumonitis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical features along with elevated absolute eosinophil count and miliary pattern in chest x-ray are suggestive of t<strong>ropical pulmonary eosinophilia.</strong></p>\n<p>Tropical pulmonary eosinophilia (TPE)&nbsp;is a&nbsp;hyperresponsive pulmonary syndrome that occurs in response to trapped <strong>microfilariae</strong> within the lung parenchyma. It is a <strong>type 1 hypersensitivity</strong> reaction.</p>\n<p>Clinical features:</p>\n<p>The patient has a history of residence in a filaria endemic area and usually presents with nocturnal paroxysmal wheeze and cough. Other manifestations include weight loss, low-grade fever, and lymphadenopathy.&nbsp;Hepatosplenomegaly may be seen due to the trapping of microfilariae in the reticuloendothelial system.</p>\n<p>Investigations:</p>\n<ul>\n<li><strong>Eosinophilia &gt; 3000/&mu;L,&nbsp;</strong>leucocytosis</li>\n<li>X-ray chest: Mottled opacities or military lesions in the middle and lower lung fields, increased bronchovascular markings</li>\n<li>PFT:&nbsp;<strong>Restrictive changes in most cases&nbsp;</strong>and obstructive defects in half</li>\n<li>Elevated levels of<strong>&nbsp;IgE</strong>&nbsp;and&nbsp;<strong>Antifilarial antibody titers</strong></li>\n<li>Microfilaria are sequestrated in the lungs and hence&nbsp;<strong>not found in blood</strong></li>\n</ul>\n<p>Treatment:<strong> Diethylcarbamazine(DEC)&nbsp;</strong>at a daily dosage of 4-6 mg/kg for 14 days.</p>\n<p>&nbsp;Differntial Diagnosis:</p>\n<ul>\n<li><strong>Bronchial asthma</strong></li>\n<li>Loffler syndrome</li>\n<li>Allergic bronchopulmonary aspergillosis</li>\n<li>Churg strauss syndrome</li>\n<li>\n<div>Chronic eosinophilic pneumonia</div>\n</li>\n<li>\n<div>Hypereosinophilic syndromes</div>\n</li>\n</ul>\n<p>Other options:</p>\n<p>Option A:&nbsp; The classical symptoms of<strong> bronchial asthma</strong> are wheezing, dyspnea, and cough which is worse at night and keeps the patient awake in the early morning hours. Chest auscultation reveals rhonchi throughout the chest. The chest x-ray is usually normal but <strong>hyperinflation</strong> may be seen in severe patients.</p>\n<p>Option B: <strong>Miliary TB</strong> occurs due to the hematogenous spread of tubercle bacilli. Clinical features are nonspecific and depend on the site of involvement. Common manifestations include <strong>fever, night sweats, anorexia</strong>, weakness, and weight loss. Blood investigations may reveal anemia with leukopenia, lymphopenia, neutrophilic leukocytosis, leukemoid reactions, and polycythemia. Chest x-ray shows a <strong>military&nbsp;reticulonodular pattern</strong> in some cases.</p>\n<p>Option D: <strong>Hypersensitivity pneumonitis</strong>, also known as extrinsic allergic alveolitis, is an inflammatory response to various inhaled antigens. The clinical presentation can be acute, subacute, and chronic. History of exposure to the offending antigen is present. Chest x-ray findings are nonspecific and can show<strong> ground-glass opacities</strong> or ill-defined micronodular opacities.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged man with chronic renal failure on dialysis presents with sudden collapse to the casualty with labored breathing. ECG shows tall tented T waves. What is the most likely acid-base imbalance that can be seen in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "pH- 7.14, pCO2- 20 mm Hg, HCO3- 5 mEq/L"
      },
      {
        "id": 2,
        "text": "pH- 7.14, pCO2- 20 mm Hg, HCO3- 34 mEq/L"
      },
      {
        "id": 3,
        "text": "pH - 7.54, HCO3 - 27 mEq/L, pCO2- 34 mm Hg"
      },
      {
        "id": 4,
        "text": "pH- 7.4, HCO3- 27 mEq/L, pCO2 - 40 mm Hg"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Metabolic acidosis</strong> is the most common acid-base abnormality seen in chronic kidney disease (CKD) patients due to the defective production of ammonia which impairs the excretion of H+ ions.&nbsp;</p>\n<p>In metabolic acidosis, there will be <strong>low pH (&lt;7.35), low bicarbonates (&lt;22 mEq/L)</strong>, and<strong> low pCO2 levels (&lt;35 mm Hg)</strong>. Since the pH in options C and D is &gt;7.35, they can be ruled out. A pH of 7.14 indicates acidosis. The bicarbonate level of 34 mEq/L (in option B) is not consistent with metabolic acidosis, thus leaving us with option A.</p>\n<p><span data-preserver-spaces=\"true\">During metabolic acidosis, there is respiratory compensation by hyperventilation resulting in loss of volatile acid causing a reduction in PCO2 levels. The decrease in PCO2 with a decrease in pH indicates that it is a compensatory mechanism.&nbsp;</span>We can use <strong>Winter&rsquo;s formula</strong> to check the degree of respiratory compensation in metabolic acidosis:</p>\n<p><span data-preserver-spaces=\"true\">pCO2= [1 .5 X HCO3-] + 8 &plusmn; 2</span></p>\n<p><span data-preserver-spaces=\"true\">= [1.5 X 5] + 8 &plusmn; 2</span></p>\n<p><span data-preserver-spaces=\"true\">= 13.5-17.5</span></p>\n<p>The expected pCO2 level is 13.5-17.5 mmHg. The pCO2 value of 20mmHg in option A is close to the expected values. Hence, this patient has a <strong>partially compensated metabolic acidosis</strong>.</p>\n<p><span data-preserver-spaces=\"true\">In CKD, the kidneys are unable to produce enough ammonia (NH3) in the proximal tubules to excrete the endogenous acid (H+) into the urine in the form of ammonium (NH4+). Therefore, accumulation of H+ occurs causing metabolic acidosis. In the late stages of CKD, the accumulation of phosphates, sulfates, and other organic anions cause an increase in the&nbsp;</span><strong><span data-preserver-spaces=\"true\">anion gap.&nbsp;</span></strong><span data-preserver-spaces=\"true\">Thus,</span><strong><span data-preserver-spaces=\"true\">&nbsp;non-anion gap metabolic acidosis&nbsp;</span></strong><span data-preserver-spaces=\"true\">is seen in</span><strong><span data-preserver-spaces=\"true\">&nbsp;</span></strong><span data-preserver-spaces=\"true\">the</span><strong><span data-preserver-spaces=\"true\">&nbsp;early stages of CKD&nbsp;</span></strong><span data-preserver-spaces=\"true\">which then progresses to</span><strong><span data-preserver-spaces=\"true\">&nbsp;high anion gap metabolic acidosis&nbsp;</span></strong><span data-preserver-spaces=\"true\">in&nbsp;</span><strong><span data-preserver-spaces=\"true\">later stages of CKD.</span></strong></p>\n<p><span data-preserver-spaces=\"true\">In CKD, the ability to excrete potassium is decreased. This causes hyperkalemia. Also, metabolic acidosis in CKD causes an extracellular shift of K+ and aggravates <strong>hyperkalemia</strong>. This is responsible for the ECG findings of <strong>tall tented T waves</strong> in this patient.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman presents with numbness of her fingertips. On examination, her face is tightened. The antinuclear antibody(ANA) is found to be positive and immunofluorescence shows the nucleolar pattern. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Systemic sclerosis"
      },
      {
        "id": 2,
        "text": "Sjogren's syndrome"
      },
      {
        "id": 3,
        "text": "Systemic lupus erythematosus"
      },
      {
        "id": 4,
        "text": "Rheumatoid arthiritis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option D:&nbsp;<strong>Rheumatoid arthritis</strong> (RA) is a multisystem disease that classically presents with pain, joint swelling, and stiffness of the small joints of the hands, feet, and wrists in a symmetrical manner.</p>\n<p><strong>RF</strong> and <strong>anti-citrullinated peptide</strong> antibodies are positive in RA. <strong>Homogenous staining</strong> is the most common pattern seen in RA.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/59e586d9ed414230bd3c71767291c566x616x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/95bc8244d8f546e7883d65f4934bc778x655x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c4a04e2db5dd4eec9a2ebd9acc2f0308x719x599.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5c92164de4d14a9aa04b17ddb09a662ax720x665.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3278e0bdb5e04a509a588d3eb835e760x1280x1541.JPEG"
    ]
  },
  {
    "text": "A 45-year-old woman with a history of hypertension presented to the emergency room with loss of consciousness, chest pain, and diaphoresis. On examination, she was grossly unstable and the bilateral pulses were unequal. ECG showed nonspecific ST-T changes. What is the next best investigation?",
    "choices": [
      {
        "id": 1,
        "text": "MRI"
      },
      {
        "id": 2,
        "text": "Transesophageal echocardiography"
      },
      {
        "id": 3,
        "text": "Cardiac enzymes"
      },
      {
        "id": 4,
        "text": "X ray"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Treatment:</p>\n<p>The&nbsp;<strong>initial management</strong>&nbsp;is with&nbsp;<strong>b</strong><strong>eta-blockers</strong> to<strong> control hypertension</strong>, along with pain management. The preferred beta-blocker is <strong>esmolol</strong>. These&nbsp;reduce cardiac contractility and blood pressure.</p>\n<p>Isolated use of a direct vasodilator such as<strong> hydralazine</strong> is contraindicated in acute dissection because these agents can increase <strong>hydraulic shear</strong> and <strong>worsen the dissection.&nbsp;</strong>CCBs like verapamil and diltiazem may be used intravenously if nitroprusside or beta-blockers cannot be employed.</p>\n<p>Once hypertension is controlled, definitive surgical repair of aortic dissection is done. Treatment options depend on the classification.</p>\n<ul>\n<li>Stanford Type A (DeBakey types I and II) requires surgical intervention once the patient's blood pressure is stabilized.</li>\n<li>Stanford Type B (DeBakey type III) is best managed by antihypertensive drugs. Surgical intervention is indicated in complicated cases if the pain increases (signaling impending rupture) or when there is evidence of malperfusion of organs or neurological symptoms.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b99f9978e8ee438bbd08eedad63b4d74x1280x3028.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d4668925fa3d4297b60f21f9059bfdc1x1280x1241.JPEG"
    ]
  },
  {
    "text": "A 10-year-old child with AIDS presented with fever and productive cough. On auscultation, bronchial breath sounds and crepitations were heard in the right infra-scapular region. Chest X-ray showed right lower lobe consolidation. The CD4 count was 55 cells/mm3. What is the most common causative organism for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Pneumocystis jirovecii"
      },
      {
        "id": 2,
        "text": "Streptococcus pnuemoniae"
      },
      {
        "id": 3,
        "text": "Staphylococcus aureus"
      },
      {
        "id": 4,
        "text": "Mycoplasma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option D:&nbsp;<strong><span data-preserver-spaces=\"true\">Mycoplasma</span></strong><span data-preserver-spaces=\"true\">&nbsp;causes&nbsp;</span><strong><span data-preserver-spaces=\"true\">atypical pneumonia</span></strong><span data-preserver-spaces=\"true\">. Patients present with&nbsp;</span><strong><span data-preserver-spaces=\"true\">dry cough</span></strong><span data-preserver-spaces=\"true\">, fever, chills, malaise, and upper respiratory tract symptoms. On auscultation, wheezes or rales are heard.&nbsp;</span><span data-preserver-spaces=\"true\">Chest X-ray shows peribronchial pneumonia with prominent bronchial markings, interstitial infiltration, and atelectasis.</span></p>\n<p>The chest X-ray below shows patchy consolidation at the hilum and fanning to the periphery</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/48b59933c93c4200b03927a145220da4x754x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/36daf54e7e104369bd39e7fdd0f354a6x800x351.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a3f2b9d4234948d985eaa3da557abd6ex720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/186c398941d74434a0a17a1ff17f83eax720x476.PNG"
    ]
  },
  {
    "text": "A patient presents with a seizure. On evaluation, urine osmolality is 1000 mOsm/Kg and serum osmolality is 270 mOsm/Kg. Which electrolyte abnormality can be expected in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Hypernatremia"
      },
      {
        "id": 2,
        "text": "Hyponatremia"
      },
      {
        "id": 3,
        "text": "Hyperkalemia"
      },
      {
        "id": 4,
        "text": "Hypokalemia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient has <strong>high urine osmolality</strong> of 1000&nbsp;mOsm/kg (normal 500-800 mOsm/kg) and <strong>low plasma osmolality</strong> of 270 mOsm/kg (normal&nbsp;285-295 mOsm/kg). This is<strong>&nbsp;</strong>seen in<strong>&nbsp;</strong>the&nbsp;syndrome of inappropriate antidiuretic hormone synthesis<strong> (SIADH)&nbsp;</strong>and<strong> hyponatremia </strong>is the most common electrolyte abnormality seen.</p>\n<p>Syndrome of inappropriate antidiuretic hormone ADH release (SIADH) is a condition where there is an unsuppressed release of antidiuretic hormone (ADH) from the pituitary gland or nonpituitary sources or its continued action on vasopressin receptors.</p>\n<p>ADH promotes the reabsorption of water from the collecting duct.&nbsp;Excessive secretion of ADH in SIADH results in enhanced water reabsorption. Therefore, only water is reabsorbed and not the solutes resulting in&nbsp;<strong>concentrated urine</strong>. This is depicted as high urine osmolality.&nbsp;The excess of water reabsorbed from the tubules expand and dilute the extracellular fluid leading to <strong>dilutional hyponatremia</strong>. This is depicted as low plasma osmolality.&nbsp;</p>\n<p>Since there is an increase in body water with little or no change in body sodium in SIADH, this is known as <strong>euvolemic hyponatremia</strong>.</p>\n<p>Patients may be asymptomatic or present with headache, confusion, nausea, vomiting, anorexia, seizures, and coma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A male patient had feeble femoral pulses with upper-limb blood pressure of 186/90 mmHg. Chest X-ray showed enlarged intercostal arteries. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Coarctation of aorta"
      },
      {
        "id": 2,
        "text": "Atrial septal defect"
      },
      {
        "id": 3,
        "text": "Bicuspid aortic valve"
      },
      {
        "id": 4,
        "text": "Patent ductus arteriosus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>Notching of ribs</strong>&nbsp; (Roesler's sign) due to inferior rib erosion by dilated intercostal collateral vessels.&nbsp;\n<ul>\n<li><strong>Collateral blood supply </strong>occurs from the arch of the aorta to the descending thoracic aorta bypassing the narrowed aorta.</li>\n<li>It occurs via the&nbsp;<strong>arch of the aorta&nbsp;</strong><strong>&rarr;</strong> internal thoracic artery&nbsp;<strong>&rarr;</strong> anterior intercostal artery&nbsp;<strong>&rarr;</strong>&nbsp;posterior intercostal artery&nbsp;<strong>&rarr;</strong><strong>&nbsp;descending thoracic aorta.</strong></li>\n<li><strong>4th to 8th ribs </strong>are most commonly involved. <strong>1st </strong>and<strong> 2nd ribs </strong>are<strong> spared </strong>as the intercostal arteries in these ribs do not communicate with the descending aorta.&nbsp;</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c1676537b1654df08af73bc8258c45a8x413x529.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/234da9223a6e43ccbb5264f1c68db824x600x600.JPEG"
    ]
  },
  {
    "text": "A patient who is a known case of atherosclerosis underwent a circumflex artery bypass. The stent is now placed successfully. He is already taking lisinopril, verapamil, metoprolol. Which drug should be added?",
    "choices": [
      {
        "id": 1,
        "text": "PDE 3 inhibitor"
      },
      {
        "id": 2,
        "text": "Direct oral anticoagulant"
      },
      {
        "id": 3,
        "text": "P2Y12 receptor blocker"
      },
      {
        "id": 4,
        "text": "PDE 5 inhibitor"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>P2Y12 receptor blocker</strong> should be added to prevent stent thrombosis.</p>\n<p>Clopidogrel, a P2Y12 receptor blocker, along with aspirin is called dual antiplatelet therapy (DAPT).</p>\n<p>DAPT should be continued for at least 1 year following stent placement to prevent stent thrombosis.&nbsp;After the recommended duration of treatment with dual antiplatelet therapy, aspirin should be continued indefinitely.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statement is incorrect regarding pheochromocytoma?",
    "choices": [
      {
        "id": 1,
        "text": "Diagnosed by  urine VMA & catecholamines"
      },
      {
        "id": 2,
        "text": "Surgical  excision is the definitive  treatment"
      },
      {
        "id": 3,
        "text": "Propranolol is given initially to manage hypertension"
      },
      {
        "id": 4,
        "text": "Can present as hypertension alone and sometimes with vomiting and  pain abdomen"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong><span data-preserver-spaces=\"true\">Alpha-blockers</span></strong><span data-preserver-spaces=\"true\">&nbsp;like phenoxybenzamine are&nbsp;</span><strong><span data-preserver-spaces=\"true\">given initially</span></strong><span data-preserver-spaces=\"true\">&nbsp;to manage hypertension in&nbsp;</span><strong><span data-preserver-spaces=\"true\">pheochromocytoma</span></strong><span data-preserver-spaces=\"true\">. Beta-blockers such as propranolol are given only after adequate alpha blockade is achieved.</span></p>\n<p><span data-preserver-spaces=\"true\">Pheochromocytoma is a catecholamine secreting tumor. High levels of circulating catecholamines stimulate the alpha receptors on the blood vessels and cause vasoconstriction, resulting in hypertension. If &beta;-blockers are given initially, it will lead to&nbsp;</span><strong><span data-preserver-spaces=\"true\">unopposed &alpha;-stimulant action</span></strong><span data-preserver-spaces=\"true\">&nbsp;of catecholamines leading to&nbsp;</span><strong><span data-preserver-spaces=\"true\">hypertensive crisis</span></strong><span data-preserver-spaces=\"true\">. This is the rationale behind prescribing alpha-blockers initially and then followed by &beta;-blockers in pheochromocytoma.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Pheochromocytoma:</span></strong></p>\n<p><span data-preserver-spaces=\"true\">Pheochromocytoma is a catecholamine secreting tumor derived from the chromaffin cells of the adrenal medulla.</span></p>\n<p><span data-preserver-spaces=\"true\">It can be sporadical or hereditary. Hereditary pheochromocytoma occurs in association with syndromes such as&nbsp;</span><strong><span data-preserver-spaces=\"true\">MEN 2</span></strong><span data-preserver-spaces=\"true\">&nbsp;(Multiple endocrine neoplasia type 2),&nbsp;</span><strong><span data-preserver-spaces=\"true\">familial</span></strong><span data-preserver-spaces=\"true\">&nbsp;</span><strong><span data-preserver-spaces=\"true\">paraganglioma syndrome,</span></strong><span data-preserver-spaces=\"true\">&nbsp;Von Hippel Lindau (</span><strong><span data-preserver-spaces=\"true\">VHL</span></strong><span data-preserver-spaces=\"true\">) syndrome, and neurofibromatosis (</span><strong><span data-preserver-spaces=\"true\">NF</span></strong><span data-preserver-spaces=\"true\">) type 1.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Clinical features:</span></strong></p>\n<p><span data-preserver-spaces=\"true\">It most commonly presents as a classic triad of&nbsp;</span><strong><span data-preserver-spaces=\"true\">intermittent headache</span></strong><span data-preserver-spaces=\"true\">,&nbsp;</span><strong><span data-preserver-spaces=\"true\">palpitation</span></strong><span data-preserver-spaces=\"true\">, and&nbsp;</span><strong><span data-preserver-spaces=\"true\">profuse sweating&nbsp;</span></strong><span data-preserver-spaces=\"true\">along with&nbsp;</span><strong><span data-preserver-spaces=\"true\">hypertension.&nbsp;</span></strong><span data-preserver-spaces=\"true\">The patient can also present with anxiety, panic attacks,&nbsp;</span><strong><span data-preserver-spaces=\"true\">nausea, abdominal pain</span></strong><span data-preserver-spaces=\"true\">, weight loss, and weakness.</span></p>\n<p><span data-preserver-spaces=\"true\">Symptoms may be precipitated by surgery, pregnancy, position changes, exercise, and medications such as metoclopramide and tricyclic antidepressants.</span></p>\n<p><strong><span data-preserver-spaces=\"true\">Investigations:</span></strong></p>\n<ol>\n<li><span data-preserver-spaces=\"true\">Biochemical&nbsp;</span><strong><span data-preserver-spaces=\"true\">screening test</span></strong><span data-preserver-spaces=\"true\">&nbsp;- measurement of&nbsp;</span><strong><span data-preserver-spaces=\"true\">urinary and plasma levels</span></strong><span data-preserver-spaces=\"true\">&nbsp;of&nbsp;</span><strong><span data-preserver-spaces=\"true\">catecholamines and metanephrines.</span></strong><span data-preserver-spaces=\"true\">&nbsp;</span></li>\n<li><strong><span data-preserver-spaces=\"true\">MRI&nbsp;</span></strong><span data-preserver-spaces=\"true\">is the</span><strong><span data-preserver-spaces=\"true\">&nbsp;investigation of choice</span></strong><span data-preserver-spaces=\"true\">&nbsp;for localizing the tumor. It is preferred over a CT scan as the contrast used in CT scans can precipitate paroxysms.</span></li>\n<li><span data-preserver-spaces=\"true\">Other imaging modalities like MIBG scintigraphy, DOPA- or FDG- PET scan are used in identifying the primary tumor as well as the extra-adrenal tumors and metastases.</span></li>\n</ol>\n<p><strong><span data-preserver-spaces=\"true\">Treatment:</span></strong></p>\n<p><strong><span data-preserver-spaces=\"true\">Surgical resection</span></strong><span data-preserver-spaces=\"true\">&nbsp;of the tumor is the&nbsp;</span><strong><span data-preserver-spaces=\"true\">definitive treatment</span></strong><span data-preserver-spaces=\"true\">&nbsp;for pheochromocytoma.</span></p>\n<p><span data-preserver-spaces=\"true\">Preoperatively, hypertension is managed initially with&nbsp;</span><strong><span data-preserver-spaces=\"true\">alpha-blockers followed by beta-blockers.</span></strong></p>\n<p><span data-preserver-spaces=\"true\">Postoperatively,&nbsp;</span><strong><span data-preserver-spaces=\"true\">lifelong yearly follow-up</span></strong><span data-preserver-spaces=\"true\">&nbsp;should be done.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with giant cell arteritis presented with headache, jaw claudication, polymyalgia rheumatica, and mononeuritis multiplex. What should be the first-line treatment for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Abatacept"
      },
      {
        "id": 2,
        "text": "Tocilizumab"
      },
      {
        "id": 3,
        "text": "Steroids"
      },
      {
        "id": 4,
        "text": "Aspirin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Histopathology</strong> of giant cell arteritis shows <strong>panarteritis</strong> with infiltration of inflammatory mononuclear cells with giant cell formation. Intimal thickening and fragmentation of the internal elastic lamina is also seen.</p>\n<p>The image below shows <strong>internal elastic lamina fragmentation</strong> (black arrow) and <strong>giant cells</strong> (yellow arrow) in a cerebral artery.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/91a4dacf75d74326b654b64e9d335d11x1280x950.JPEG"
    ]
  },
  {
    "text": "A 50-year-old man presents with a history of recurrent retrosternal chest pain with each episode lasting for 3-5min and subsiding with sublingual nitrate. ECG shows left ventricular hypertrophy and flat T-wave. He is a known case of hypertension, diabetes mellitus, hypercholesterolemia currently on aspirin, atenolol, metformin, and lovastatin. What is the next best step in management?",
    "choices": [
      {
        "id": 1,
        "text": "IV glyceryl trinitrate infusion"
      },
      {
        "id": 2,
        "text": "Injection enoxaparin"
      },
      {
        "id": 3,
        "text": "Add clopidogrel"
      },
      {
        "id": 4,
        "text": "Increase the dose of beta blocker"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of recurrent chest pain relieved on nitrates in a patient with hypertension, diabetes mellitus and hypercholesterolemia are suggestive of<strong> acute coronary syndrome. </strong>ECG showing flat T wave and left ventricular hypertrophy&nbsp;favors the diagnosis of non-ST segment elevated acute coronary syndrome (<strong>NSTE-ACS</strong>). <strong>Injection enoxaparin</strong> is the next best step in management.</p>\n<p>Enoxaparin, a low molecular weight heparin, is used as a first-line anticoagulant therapy to prevent thrombosis in patients with NSTE-ACS.</p>\n<p>Patients with acute coronary syndrome are classified into ST-segment elevated myocardial infarction (STEMI) and NSTE-ACS.</p>\n<p><strong>Management of NSTE-ACS:</strong></p>\n<p>Supportive therapy - supplemental oxygen</p>\n<p><strong>Anti-ischemic drugs:</strong></p>\n<ul>\n<li>Sublingual or IV nitrates</li>\n<li>Beta-blockers</li>\n</ul>\n<p><strong>Antithrombotic treatment</strong> consists of anticoagulants and antiplatelet therapy.</p>\n<p>The anticoagulants used are <strong>low molecular weight heparin</strong> such as enoxaparin, fondaparinux. Other anticoagulants used are <strong>unfractionated heparin</strong>&nbsp;(UFH), bivalirudin, and <strong>direct oral anticoagulants</strong> such as dabigatran, apixaban, and rivaroxaban. UFH is the mainstay of therapy.</p>\n<p>Antiplatelet drug, <strong>aspirin</strong>, is the preferred drug in NSTE-ACS treatment. <strong>P2Y12 receptor inhibitors</strong> like prasugrel, ticagrelor, cangrelor, clopidogrel are also used. Clopidogrel is used only when prasugrel or ticagrelor are not available/ contraindicated.</p>\n<p>GPIIb/IIIa inhibitors - eptifibatide and tirofiban - are also used as alternatives.</p>\n<p><strong>Invasive treatment</strong> - percutaneous coronary intervention- is done after stabilizing the patient with the above-mentioned drugs.</p>\n<p><strong>Other options:</strong></p>\n<p>Option A: <strong>Intravenous glyceryl trinitrate infusion</strong> is only given when chest pain is not relieved by sublingual nitrates. This patient has chest pain controlled by sublingual nitrates. Hence, IV GTN infusion is not recommended.</p>\n<p>Option C: <strong>Clopidogrel</strong> is used in combination with aspirin or when aspirin is intolerable/contraindicated. However, prasugrel or ticagrelor is preferred over clopidogrel and is initiated after anticoagulant therapy.</p>\n<p>Option D: <strong>Beta-blockers</strong> are used to reduce pain. This patient does not present with pain and also mentions that the pain is relieved on sublingual nitrates. Increasing the dose of beta-blocker has no benefit in this situation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '219 Medicine Neet 2021';
        let hierarchy = ["Marrow", "PYQs", "Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>