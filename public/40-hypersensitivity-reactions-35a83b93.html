<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>40 Hypersensitivity Reactions - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Microbiology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">12</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>A 30-year-old woman presents with a rash and difficulty breathing after being administered penicillin. Which of the following types of hypersensitivity reactions is most likely responsible for her symptoms according to the Gell and Coombs classification?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Type I"
      },
      {
        "id": 2,
        "text": "Type II"
      },
      {
        "id": 3,
        "text": "Type III"
      },
      {
        "id": 4,
        "text": "Type IV"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Type I</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation:</strong><br />\n<strong>The Gell and Coombs classification</strong> categorizes <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reactions into four types:</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Description</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Examples </strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type I (Immediate)</strong></p>\n\n\t\t\t<p><strong>(Option A)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>IgE-mediated reactions, leading to <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell <span class=\"customMeta\" data-dictid=\"adb3e39bbf1692777185215fad237b\">degranulation</span> and <span class=\"customMeta\" data-dictid=\"b5d4ddbfe71692777189a12acd5502\">histamine</span> release.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Examples include <span class=\"customMeta\" data-dictid=\"3f1938c99b16927771810c68214ce0\">allergic rhinitis</span> and anaphylaxis.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type II (Cytotoxic)</strong></p>\n\n\t\t\t<p><strong>(Option B)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Mediated by <span class=\"customMeta\" data-dictid=\"2d9b37c62116927771891f3784d2c8\">IgG</span> or <span class=\"customMeta\" data-dictid=\"e4a6fd7fbb169277718986a699e800\">IgM</span> antibodies directed against antigens on cell surfaces or matrix, causing cell lysis.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Conditions include <span class=\"customMeta\" data-dictid=\"96ab11a06a16927771823151c8e471\">autoimmune</span> <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">hemolytic</span> <span class=\"customMeta\" data-dictid=\"53bee2a41216927771814d7ec3a67f\">anemia</span> and rheumatic fever.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type III (Immune Complex)</strong></p>\n\n\t\t\t<p><strong>(Option C)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Caused by the formation of antigen-antibody complexes that deposit in tissues, leading to inflammation.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Examples include <span class=\"customMeta\" data-dictid=\"8f2e7fd96116927771995b451b5c90\">systemic</span> <span class=\"customMeta\" data-dictid=\"ccd536a9071692777191f53538ca30\">lupus</span> erythematosus and post-streptococcal glomerulonephritis.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type IV (Delayed)</strong></p>\n\n\t\t\t<p><strong>(Option D)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Mediated by T cells, occurring hours to days after exposure to an antigen.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Seen in contact <span class=\"customMeta\" data-dictid=\"fedc53b3161692777186553c8f8d7d\">dermatitis</span> and <span class=\"customMeta\" data-dictid=\"0fe92012341692777201bab3db39b1\">tuberculin</span> reactions.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 30-year-old healthcare worker develops a red, itchy rash on her hands two days after using a new brand of latex gloves. She reports no immediate reaction at the time of exposure, but 48 hours later, she noticed redness, swelling, and itching at the site of contact. She has no known history of allergies or similar reactions in the past. Which type of hypersensitivity reaction is most likely responsible for her symptoms?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Type I hypersensitivity"
      },
      {
        "id": 2,
        "text": "Type II hypersensitivity"
      },
      {
        "id": 3,
        "text": "Type III hypersensitivity"
      },
      {
        "id": 4,
        "text": "Type IV hypersensitivity"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) Type IV</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><strong>Duration of the types of <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reactions:</strong></p>\n\n<p><strong>Type I (Immediate):</strong> Occurs within 2\u201330 minutes due to IgE-mediated release of histamine.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Type II (Cytotoxic):</strong> Can occur within 5\u20138 hours; mediated by <span class=\"customMeta\" data-dictid=\"9d7a12cab116927771811a0079086d\">antibody</span> binding to cell antigens, but does not fit the delayed category.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Type III (Immune Complex): </strong>Symptoms can develop 2\u20138 hours later but are generally not as delayed as Type IV.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Type IV (Delayed): </strong>Characterized by delayed hypersensitivity, mediated by T lymphocytes, with symptoms appearing 24 to 72 hours after <span class=\"customMeta\" data-dictid=\"782b31281a1692777181708484c1d1\">antigen</span> exposure, as seen in <span class=\"customMeta\" data-dictid=\"8d98ce2d3616927772013bfc3e0528\">tuberculosis</span> skin tests.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 28-year-old woman with a history of asthma experiences severe wheezing, shortness of breath, and facial swelling minutes after accidentally ingesting peanuts. She is treated promptly in the emergency department with epinephrine, antihistamines, and corticosteroids, and her symptoms improve. However, 8 hours later, she began to develop increased chest tightness and wheezing, requiring additional medical intervention. Which of the following best explains her delayed respiratory symptoms?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Incomplete clearance of histamine from the bloodstream"
      },
      {
        "id": 2,
        "text": "Continuous allergen exposure leading to sustained mast cell degranulation"
      },
      {
        "id": 3,
        "text": "Recruitment of eosinophils and other inflammatory cells, causing a delayed inflammatory response"
      },
      {
        "id": 4,
        "text": "Development of IgG antibodies against the allergen, causing a delayed hypersensitivity reaction"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) <span class=\"customMeta\" data-dictid=\"9bb62ce0f71692777197fcc2b5f29c\">Recruitment</span> of eosinophils and other <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">inflammatory</span> cells, causing a delayed <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">inflammatory</span> response</strong></p>\n\n<p><strong>Explanation</strong>:<br />\nIn the late phase of a <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction, <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">inflammatory</span> cells like eosinophils are recruited to the site, releasing additional mediators that lead to a delayed <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">inflammatory</span> response, which explains the patient\u2019s <span class=\"customMeta\" data-dictid=\"c64e3a661b1692777197afc2ff7bca\">recurrent</span> symptoms hours after the initial reaction.</p>\n\n<p><strong>Phases of <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">type I</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction: </strong></p>\n\n<p><strong>1. Early Phase:</strong></p>\n\n<ul>\n\t<li>Occurs within 2 hours.</li>\n\t<li>Mediators:\n\t<ul>\n\t\t<li><strong>Performed</strong>: Histamine, Tryptase</li>\n\t\t<li><strong>Newly formed</strong>: Prostaglandins, Leukotrienes, <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">Platelet</span> Activating Factor (PAF).</li>\n\t</ul>\n\t</li>\n\t<li><strong>Effects</strong>:\n\t<ul>\n\t\t<li>Histamine causes <span class=\"customMeta\" data-dictid=\"7aa9f8d34616927772018c11493bbc\">vasodilation</span> (blood vessels) and <span class=\"customMeta\" data-dictid=\"c9116ef24d16927771838d51f2946f\">bronchoconstriction</span> (lungs).</li>\n\t\t<li>Other mediators lead to bronchoconstriction.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"Type I hypersensitivity\" data-author=\"Gaurav Sinha\" data-hash=\"10114\" data-license=\"CC BY SA 4.0\" data-source=\"https://en.wikipedia.org/wiki/File:Type_1_hypersensitivity_v1.pdf\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/ZdnX0anyJwvyutw0nV0r1744470694.png\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>\n\n<p><strong>2. Late Phase (Delayed Reaction)</strong></p>\n\n<ul>\n\t<li><strong>Onset</strong>: Begins 4\u201312 hours after the initial reaction, peaks at 24\u201348 hours, and can last for several days.</li>\n\t<li><strong>Mechanism</strong>:\n\t<ul>\n\t\t<li><strong>Cytokine and <span class=\"customMeta\" data-dictid=\"809599d0241692777184db8a8f9935\">Chemokine</span> Release</strong>: <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">Mast</span> cells and basophils release cytokines (e.g., IL-4, IL-5, IL-13) and chemokines that attract and <span class=\"customMeta\" data-dictid=\"dddc752e1716927771807f985bb8bb\">activate</span> other <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">inflammatory</span> cells, particularly <strong>eosinophils</strong>, <strong>neutrophils</strong>, and <strong>T-helper cells (Th2)</strong>.</li>\n\t\t<li><strong>Infiltration of <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">Inflammatory</span> Cells</strong>: These cells migrate to the site of <span class=\"customMeta\" data-dictid=\"7396dd35a41692777181bd7038fa9b\">allergen</span> exposure and release additional mediators like <strong>leukotrienes</strong>, <strong>prostaglandins</strong>, and <strong>proteases</strong>.</li>\n\t\t<li><strong>Sustained Inflammation</strong>: The continued release of these mediators maintains the <span class=\"customMeta\" data-dictid=\"9d21dd5d3116927771907405b181bc\">inflammatory</span> response, causing tissue damage and prolonged symptoms.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>Incomplete <span class=\"customMeta\" data-dictid=\"3a3fb1b8a816927771840e6a344cc0\">clearance</span> of <span class=\"customMeta\" data-dictid=\"b5d4ddbfe71692777189a12acd5502\">histamine</span> from the <span class=\"customMeta\" data-dictid=\"a813884d6016927771838d2d1f9d1d\">bloodstream</span> (Option A),</strong> is incorrect because <strong>histamine</strong>, released in the <strong>early phase</strong>, is typically cleared from the system within minutes to hours, and delayed symptoms are not due to prolonged <span class=\"customMeta\" data-dictid=\"b5d4ddbfe71692777189a12acd5502\">histamine</span> activity alone.</p>\n\n<p><strong>Continuous <span class=\"customMeta\" data-dictid=\"7396dd35a41692777181bd7038fa9b\">allergen</span> exposure leading to sustained <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell <span class=\"customMeta\" data-dictid=\"adb3e39bbf1692777185215fad237b\">degranulation</span> (Option B),</strong> is incorrect, as the patient\u2019s symptoms are not due to continuous <span class=\"customMeta\" data-dictid=\"7396dd35a41692777181bd7038fa9b\">allergen</span> exposure but rather to the<strong> late-phase inflammatory</strong> response <span class=\"customMeta\" data-dictid=\"3978e9614f1692777200abbe4cfa34\">triggered</span> by <strong>cytokines</strong> and <strong>chemokines</strong>.</p>\n\n<p><strong>Developing <span class=\"customMeta\" data-dictid=\"2d9b37c62116927771891f3784d2c8\">IgG</span> antibodies against the allergen, causing a <span class=\"customMeta\" data-dictid=\"4a3d5523ba16927771867465fc3956\">delayed hypersensitivity</span> reaction (Option D),</strong> is incorrect because <span class=\"customMeta\" data-dictid=\"2d9b37c62116927771891f3784d2c8\">IgG</span> antibodies are not primarily involved in <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> hypersensitivity. The patient\u2019s reaction is mediated by <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> and <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cells in the early phase, with <span class=\"customMeta\" data-dictid=\"7eba65a7251692777187eaa3b48258\">eosinophil</span> involvement in the late phase.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/ZdnX0anyJwvyutw0nV0r1744470694.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 28-year-old woman develops sudden hives, facial swelling, and shortness of breath after taking an antibiotic. She is rushed to the emergency room, where she receives epinephrine and improves quickly. Which of the following hypersensitivity reactions best explains her symptoms<strong>?</strong></p>",
    "choices": [
      {
        "id": 1,
        "text": "Type I Hypersensitivity (Early)"
      },
      {
        "id": 2,
        "text": "Type I Hypersensitivity (Delayed)"
      },
      {
        "id": 3,
        "text": "Type III Hypersensitivity"
      },
      {
        "id": 4,
        "text": "Type IV Hypersensitivity"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> (Early)</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li><strong>Type I Hypersensitivity</strong> <strong>(Early</strong>), is an immediate reaction <span class=\"customMeta\" data-dictid=\"3978e9614f1692777200abbe4cfa34\">triggered</span> by IgE-mediated <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell degranulation, causing symptoms like <strong>hives, swelling, and <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> distress</strong> within minutes of <span class=\"customMeta\" data-dictid=\"7396dd35a41692777181bd7038fa9b\">allergen</span> exposure.</li>\n\t<li>Other options describe features inconsistent with her presentation and typical of <span class=\"customMeta\" data-dictid=\"4a3d5523ba16927771867465fc3956\">delayed hypersensitivity</span> types (I (Delayed), III, and IV), which have different mechanisms and symptom timelines.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Type I <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction phases and their features:</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:734px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Phase</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Timing</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Mechanism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Clinical Features</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Early Phase</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Seconds to minutes</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Mast cell/basophil degranulation</strong>: <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> <span class=\"customMeta\" data-dictid=\"2cf4952c63169277718543a0883583\">cross-linking</span> leads to the release of <span class=\"customMeta\" data-dictid=\"b5d4ddbfe71692777189a12acd5502\">histamine</span> and other mediators.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Skin</strong>: <span class=\"customMeta\" data-dictid=\"7e814d15c31692777201fe0d9c1a61\">Urticaria</span> (hives), <span class=\"customMeta\" data-dictid=\"8f179d376f16927771905338bc9387\">itching</span> (pruritus), <span class=\"customMeta\" data-dictid=\"f0f3e105661692777187df507b1f26\">erythema</span> (redness), <span class=\"customMeta\" data-dictid=\"8fb8df140b1692777191702bbc9358\">localized</span> <span class=\"customMeta\" data-dictid=\"5f26e5a9e916927771816a407f7545\">angioedema</span> (swelling around lips, eyes)</p>\n\n\t\t\t<p><strong>Respiratory</strong>: <span class=\"customMeta\" data-dictid=\"c9116ef24d16927771838d51f2946f\">Bronchoconstriction</span> leading to wheezing, shortness of breath, chest tightness, sneezing, <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> <span class=\"customMeta\" data-dictid=\"2dd9736fdf16927771849f5a925f7d\">congestion</span> (allergic rhinitis)</p>\n\n\t\t\t<p><strong>Cardiovascular</strong>: <span class=\"customMeta\" data-dictid=\"7aa9f8d34616927772018c11493bbc\">Vasodilation</span> and <span class=\"customMeta\" data-dictid=\"9402185d4b1692777189cb62891ff1\">hypotension</span> (drop in blood pressure), dizziness, <span class=\"customMeta\" data-dictid=\"9f04fb3f2f1692777199272e3daf84\">syncope</span> (fainting)</p>\n\n\t\t\t<p><strong>Gastrointestinal</strong>: Nausea, vomiting, <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> pain, <span class=\"customMeta\" data-dictid=\"aaabe672c51692777186a829ebdc0c\">diarrhea</span> due to smooth muscle contraction</p>\n\n\t\t\t<p><strong>Systemic Reaction</strong>: <span class=\"customMeta\" data-dictid=\"d6d717efa216927771819fee139235\">Anaphylaxis</span> in severe cases, with generalized urticaria, angioedema, severe hypotension, and <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> <span class=\"customMeta\" data-dictid=\"afafb9026e1692777186e3dd168fa8\">distress</span> (life-threatening)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Late Phase</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>4\u201312 hours, peaks at 24\u201348 hours, lasting up to days</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Inflammatory cell recruitment</strong>: Cytokines/chemokines attract eosinophils, neutrophils, and macrophages, causing sustained inflammation.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Skin</strong>: Persistent redness, swelling, intense itching, and development of an eczema-like <span class=\"customMeta\" data-dictid=\"dc75edd604169277719735ac5b4d5b\">rash</span> (seen in <span class=\"customMeta\" data-dictid=\"afad60190f1692777182663499dc42\">atopic</span> dermatitis)</p>\n\n\t\t\t<p><strong>Respiratory</strong>: <span class=\"customMeta\" data-dictid=\"c64e3a661b1692777197afc2ff7bca\">Recurrent</span> bronchoconstriction, prolonged wheezing, coughing, chest tightness, <span class=\"customMeta\" data-dictid=\"ab75ea330616927771938a64f8ebd6\">mucus</span> production, and <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> <span class=\"customMeta\" data-dictid=\"47610e211516927771892548eb5626\">hyperresponsiveness</span> (chronic <span class=\"customMeta\" data-dictid=\"76891bb6e91692777182cda16e1db6\">asthma</span> exacerbation)</p>\n\n\t\t\t<p><strong>Eyes</strong>: Persistent redness and <span class=\"customMeta\" data-dictid=\"3a74ed0fcf16927771901a79847565\">irritation</span> in <span class=\"customMeta\" data-dictid=\"d168af6e7f1692777185683fea5e7f\">conjunctiva</span> (allergic conjunctivitis)</p>\n\n\t\t\t<p><strong>Chronic Changes</strong>: In prolonged or <span class=\"customMeta\" data-dictid=\"c64e3a661b1692777197afc2ff7bca\">recurrent</span> reactions, there may be tissue remodeling, fibrosis, and thickening of affected areas (e.g., airways in asthma, skin in chronic dermatitis)</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Types of <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reactions and their features: </strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Mechanism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Clinical Features</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Onset</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type I Early</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>IgE-mediated <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell degranulation</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hives, swelling, <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> distress</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Immediate (minutes)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type I Delayed</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>IgE-mediated <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell degranulation</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Wheezing, chest tightness, <span class=\"customMeta\" data-dictid=\"8fb8df140b1692777191702bbc9358\">localized</span> itching</p>\n\n\t\t\t<p><strong>(Option B ruled out)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hours to days</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type II</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Antibody-mediated cell destruction</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hemolytic anemia, thrombocytopenia</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Delayed (hours to days)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type III</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Immune complex deposition</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Joint pain, fever, vasculitis</p>\n\n\t\t\t<p><strong>(Option C ruled out)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Delayed (hours to days)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type IV</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>T-cell mediated response</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Skin rash, contact dermatitis</p>\n\n\t\t\t<p><strong>(Option D ruled out)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Delayed (48-72 hours)</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"Types of <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> reactions\" data-author=\"OpenStax College\" data-hash=\"10115\" data-license=\"CC BY 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:2228_Immune_Hypersensitivity_new.jpg\" data-tags=\"April2025\" height=\"374\" src=\"https://image.prepladder.com/notes/MFQcnPun5TRULhusspjU1744470832.png\" width=\"483\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 5-year-old boy experiences facial swelling, hives, and difficulty breathing after accidentally eating a peanut cookie. He is treated with epinephrine and antihistamines and stabilizes, but later develops wheezing and difficulty breathing. Which pair of Type I hypersensitivity reactions best explains his experience?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Anaphylaxis followed by allergic asthma"
      },
      {
        "id": 2,
        "text": "Urticaria followed by allergic rhinitis"
      },
      {
        "id": 3,
        "text": "Atopic dermatitis followed by urticaria"
      },
      {
        "id": 4,
        "text": "Allergic rhinitis followed by food allergy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) <span class=\"customMeta\" data-dictid=\"d6d717efa216927771819fee139235\">Anaphylaxis</span> followed by allergic asthma</strong></p>\n\n<p><strong>Explanation</strong>:</p>\n\n<ul>\n\t<li>The child's immediate symptoms\u2014facial swelling, hives, and difficulty breathing\u2014are classic signs of <strong>anaphylaxis</strong>, a severe and potentially life-threatening <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction <span class=\"customMeta\" data-dictid=\"3978e9614f1692777200abbe4cfa34\">triggered</span> by the peanuts.</li>\n\t<li>His subsequent wheezing and chest tightness later that night indicate the development of <strong>allergic asthma</strong>, a common late-phase reaction that can occur after an initial allergic response.</li>\n</ul>\n\n<h3><strong>Clinical Examples of <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> Reactions:</strong></h3>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:623px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Condition</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Trigger</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Early Phase Symptoms</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Late Phase Symptoms</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Anaphylaxis</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Foods (e.g., peanuts, shellfish), insect stings, medications (e.g., penicillin)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Sudden onset of hives, <span class=\"customMeta\" data-dictid=\"9fdd7489051692777202cffe3f24cc\">facial</span> swelling, difficulty breathing, low blood pressure, rapid <span class=\"customMeta\" data-dictid=\"3c305b384216927771969ca4166493\">progression</span> to shock</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Persistent wheezing, chest tightness, difficulty breathing, sustained low blood pressure; can last hours after initial exposure</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Allergic <span class=\"customMeta\" data-dictid=\"a8dad7cd171692777197e6d4ac2a1c\">Rhinitis</span> (Hay Fever)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Pollen, dust mites, pet dander</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Sneezing, itchy and watery eyes, runny nose, <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> congestion</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Prolonged <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> congestion, <span class=\"customMeta\" data-dictid=\"b0046463171692777198e0beea83e7\">sinus</span> pressure, and coughing due to <span class=\"customMeta\" data-dictid=\"785b6d19ba16927771965c071acb28\">postnasal</span> drip</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Allergic Asthma</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Pollen, mold, animal dander, air pollutants</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Coughing, wheezing, chest tightness, shortness of breath</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Persistent wheezing, chest tightness, and <span class=\"customMeta\" data-dictid=\"3b9dd3166f1692777180b697887ccb\">airway</span> <span class=\"customMeta\" data-dictid=\"47610e211516927771892548eb5626\">hyperresponsiveness</span> lead to chronic symptoms if untreated</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Food Allergy</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Common allergens include peanuts, tree nuts, eggs, milk, seafood</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hives, itching, <span class=\"customMeta\" data-dictid=\"e3d212ebd316927771996e0c472d4a\">swelling</span> of lips/face, nausea, <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> pain, vomiting, and, in severe cases, anaphylaxis</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Persistent <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> pain, diarrhea, skin <span class=\"customMeta\" data-dictid=\"dc75edd604169277719735ac5b4d5b\">rash</span> (eczema) in some chronic cases, worsening of <span class=\"customMeta\" data-dictid=\"76891bb6e91692777182cda16e1db6\">asthma</span> or other <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> symptoms</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Atopic <span class=\"customMeta\" data-dictid=\"fedc53b3161692777186553c8f8d7d\">Dermatitis</span> (Eczema)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Environmental allergens, certain foods, skin irritants</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Red, itchy rash, often in flexural areas (e.g., inside elbows, behind knees)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Chronic dry, thickened skin due to scratching, possible development of secondary infections due to skin barrier breakdown</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Urticaria (Hives)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Foods, medications, insect stings, temperature changes</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Raised, red, itchy welts (hives) on the skin, can appear within minutes of exposure</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>If chronic, repeated episodes of <span class=\"customMeta\" data-dictid=\"8f179d376f16927771905338bc9387\">itching</span> and welts lasting hours to days after initial exposure</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><strong>Urticaria followed by <span class=\"customMeta\" data-dictid=\"3f1938c99b16927771810c68214ce0\">allergic rhinitis</span> (Option B),</strong> is incorrect because while <strong>urticaria</strong> (hives) can appear in allergic reactions, it does not typically cause significant breathing issues, and <strong>allergic rhinitis</strong> primarily involves <span class=\"customMeta\" data-dictid=\"31c5d0e75f16927771938d8e2daa4c\">nasal</span> symptoms like sneezing and congestion.</p>\n\n<p><strong>Atopic <span class=\"customMeta\" data-dictid=\"fedc53b3161692777186553c8f8d7d\">dermatitis</span> followed by <span class=\"customMeta\" data-dictid=\"7e814d15c31692777201fe0d9c1a61\">urticaria</span> (Option C),</strong> is incorrect because <strong>atopic dermatitis</strong> (eczema) is a chronic skin condition and does not directly lead to the <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> symptoms seen in this case.</p>\n\n<p><strong>Allergic <span class=\"customMeta\" data-dictid=\"a8dad7cd171692777197e6d4ac2a1c\">rhinitis</span> followed by food <span class=\"customMeta\" data-dictid=\"aa1288c36b16927771814fa5aa84eb\">allergy</span> (Option D),</strong> is incorrect because <strong>allergic rhinitis</strong> is not a match for the child's initial <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> symptoms, and <strong>food allergy</strong> alone wouldn\u2019t explain the subsequent wheezing.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 45-year-old patient receives an iodine-based contrast agent for a CT scan. Within minutes, she develops hives, facial swelling, and difficulty breathing. She reports no prior allergies to iodine or contrast agents. Which of the following best describes her reaction and its mechanism?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Anaphylaxis, caused by IgE-mediated mast cell activation"
      },
      {
        "id": 2,
        "text": "Anaphylaxis, caused by T-cell-mediated hypersensitivity"
      },
      {
        "id": 3,
        "text": "Anaphylactoid reaction, caused by direct mast cell activation without IgE"
      },
      {
        "id": 4,
        "text": "Anaphylactoid reaction, requiring prior exposure for mast cell sensitization"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C)</strong> <strong>Anaphylactoid reaction, caused by direct <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">activation</span> without IgE</strong></p>\n\n<p><strong>Explanation</strong>:<br />\nThe patient\u2019s reaction is <strong>anaphylactoid</strong>, directly activating <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cells without needing <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> antibodies or prior sensitization.</p>\n\n<p><strong>Features of <span class=\"customMeta\" data-dictid=\"d6d717efa216927771819fee139235\">Anaphylaxis</span> and <span class=\"customMeta\" data-dictid=\"245b6a0cc91692777181d63c66b3a3\">Anaphylactoid</span> Reactions</strong></p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Feature</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Anaphylaxis</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Anaphylactoid Reaction</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Mechanism</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>IgE-mediated (Type I hypersensitivity)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Non-IgE mediated (direct <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell activation)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Prior <span class=\"customMeta\" data-dictid=\"4fe92aaac71692777198234aaa055a\">Sensitization</span> Needed</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Yes</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>No<strong> (Option D ruled out)</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Trigger</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Specific allergens (e.g., foods, insect stings)</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Direct <span class=\"customMeta\" data-dictid=\"7d7e9fdf401692777199f2038941b6\">stimuli</span> (e.g., radiocontrast, opioids)</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>First-Line Treatment</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Epinephrine</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Epinephrine</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Additional Symptoms</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Hives, swelling, <span class=\"customMeta\" data-dictid=\"cfad80a0f716927771979aae100f95\">respiratory</span> distress, hypotension</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Same as anaphylaxis</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Examples</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Peanuts, shellfish, penicillin</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Radiocontrast dyes, NSAIDs, opioids</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p><strong>Anaphylaxis, caused by IgE-mediated <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">activation</span> (Option A),</strong> is incorrect as <span class=\"customMeta\" data-dictid=\"d6d717efa216927771819fee139235\">anaphylaxis</span> would require IgE-mediated <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">activation</span> after prior exposure.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Anaphylaxis, caused by T-cell-mediated <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> (Option B),</strong> is incorrect, as <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> is IgE-mediated, not T-cell-mediated.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 30-year-old man comes to the ER with coughing up blood and difficulty breathing. He's scared and tells you he's never had symptoms like this before. Lab results reveal he has antibodies against the basement membrane in his lungs and kidneys. His immune system is attacking these tissues, and cell destruction is being triggered through a specific mechanism. Which of the following best explains what's happening inside his body?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Antigen-specific IgE binding to mast cells"
      },
      {
        "id": 2,
        "text": "Antibody binding to cell surface antigens with complement activation"
      },
      {
        "id": 3,
        "text": "Immune complexes depositing in blood vessels"
      },
      {
        "id": 4,
        "text": "Direct T-cell attack on self-antigens"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) <span class=\"customMeta\" data-dictid=\"9d7a12cab116927771811a0079086d\">Antibody</span> binding to cell surface antigens with <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">complement</span> <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">activation</span> </strong><br />\n<br />\n<strong>Explanation</strong>:<br />\nThe patient\u2019s symptoms, involving basement <span class=\"customMeta\" data-dictid=\"34cd707428169277719272942b7905\">membrane</span> antibodies, indicate a <strong>Type II <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction</strong>. Here, <span class=\"customMeta\" data-dictid=\"2d9b37c62116927771891f3784d2c8\">IgG</span> or <span class=\"customMeta\" data-dictid=\"e4a6fd7fbb169277718986a699e800\">IgM</span> antibodies target cell surfaces, activating the <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">complement</span> system and leading to <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and cell destruction.</p>\n\n<p><strong>Mechanism of Type-2 <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> reaction: </strong></p>\n\n<p><img alt=\"Mechanism of Type-2 <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> reaction-01\" data-author=\"\" data-hash=\"10116\" data-license=\"\" data-source=\"\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/NmnlIaMvEjEeRI6mzx0q1744470996.png\" /></p>\n\n<p><strong>1. Antibody-Antigen Interaction</strong></p>\n\n<ul>\n\t<li>In <span class=\"customMeta\" data-dictid=\"bd04ba63bc1692777201f54e0ee060\">Type II</span> HS reactions, <span class=\"customMeta\" data-dictid=\"2d9b37c62116927771891f3784d2c8\">IgG</span> or <span class=\"customMeta\" data-dictid=\"e4a6fd7fbb169277718986a699e800\">IgM</span> antibodies are produced in response to specific antigens on the surfaces of target cells (such as red blood cells or tissues). These antigens can be:\n\t<ul>\n\t\t<li><strong>Intrinsic</strong>: Naturally present on the cell, like <span class=\"customMeta\" data-dictid=\"a3c99b36b6169277718332b20cc393\">blood group</span> antigens in <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">hemolytic</span> reactions.</li>\n\t\t<li><strong>Extrinsic</strong>: Foreign antigens that have attached to cell surfaces, often from medications or infections.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>2. <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">Activation</span> of <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">Complement</span> Cascade</strong></p>\n\n<ul>\n\t<li>When antibodies bind to these cell surface antigens, they <span class=\"customMeta\" data-dictid=\"a1b06f401f1692777203a53393ba98\">form</span> antibody-antigen complexes. This binding activates the <strong>complement system</strong> (a group of proteins in the blood that assist immune responses).</li>\n\t<li>The <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">complement</span> <span class=\"customMeta\" data-dictid=\"3aa5abc2fa169277719488e088076d\">pathway</span> progresses through a series of steps, ultimately forming the <strong>Membrane Attack Complex (MAC)</strong>, which punctures the cell membrane, leading to direct cell <span class=\"customMeta\" data-dictid=\"803b5ed1c8169277719190b446ac83\">lysis</span> (rupture).</li>\n</ul>\n\n<p><strong>3. <span class=\"customMeta\" data-dictid=\"e9a9a08db6169277719417636c0fa9\">Opsonization</span> and Phagocytosis</strong></p>\n\n<ul>\n\t<li>Complement <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">activation</span> also enhances <strong>opsonization</strong>\u2014the process of marking cells with \"tags\" (complement components and antibodies) to attract phagocytes.</li>\n\t<li><strong>Phagocytes</strong> (like macrophages and neutrophils) recognize these \"tags,\" engulf them and digest the targeted cells.</li>\n</ul>\n\n<p><strong>4. <span class=\"customMeta\" data-dictid=\"17764551151692777181b0fa6714a9\">Antibody-Dependent <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">Cellular</span> Cytotoxicity</span> (ADCC)</strong></p>\n\n<ul>\n\t<li><strong>Natural Killer (NK) cells</strong> bind to the Fc region of <span class=\"customMeta\" data-dictid=\"2d9b37c62116927771891f3784d2c8\">IgG</span> antibodies attached to the target cell, releasing cytotoxic substances that further contribute to cell death</li>\n\t<li><strong>Type 5 <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> (ADCC)</strong> involves <strong>antibodies</strong> binding to <strong>cell surface receptors</strong>, leading to altered cell function rather than direct cell destruction.\n\t<ul>\n\t\t<li><strong>Graves' Disease</strong>: Autoantibodies stimulate the <strong>TSH receptor</strong> on <span class=\"customMeta\" data-dictid=\"799202e6fe16927772009a1501b0a8\">thyroid</span> cells, causing <strong>excess <span class=\"customMeta\" data-dictid=\"799202e6fe16927772009a1501b0a8\">thyroid</span> hormone</strong> production (hyperthyroidism).</li>\n\t\t<li><strong>Myasthenia Gravis</strong>: Autoantibodies block <strong>acetylcholine receptors</strong> at the <span class=\"customMeta\" data-dictid=\"8b19cd5e161692777193ad958e52e0\">neuromuscular</span> junction, leading to <strong>muscle weakness</strong>.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>5. Tissue Damage and Inflammation: </strong>The <span class=\"customMeta\" data-dictid=\"8fb8df140b1692777191702bbc9358\">localized</span> <span class=\"customMeta\" data-dictid=\"dc6add5cf91692777189b30a6bae38\">immune response</span> and subsequent cell destruction lead to tissue damage, inflammation, and the clinical symptoms associated with <span class=\"customMeta\" data-dictid=\"bd04ba63bc1692777201f54e0ee060\">Type II</span> HS reactions.</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p><br />\n<br />\n<strong>Antigen-specific <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> binding to <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cells (Option A), </strong>is incorrect as<strong> </strong>this describes a <strong>Type I <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction</strong> (like allergies), where <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> antibodies bind to allergens and cause <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell degranulation, releasing <span class=\"customMeta\" data-dictid=\"b5d4ddbfe71692777189a12acd5502\">histamine</span> and leading to symptoms like <span class=\"customMeta\" data-dictid=\"14ccc7cf1c1692777189d4fb9d1fb5\">hives</span> and bronchoconstriction.</p>\n\n<p><strong>Immune complexes depositing in blood vessels (Option C),</strong> is incorrect as<br />\nthis describes a <strong>Type III <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction</strong>, where immune complexes (antigen-antibody clusters) circulate and lodge in tissues, especially blood vessels.</p>\n\n<p><strong>Direct T-cell attack on self-antigens (Option D), </strong>is incorrect as this describes a <strong>Type IV <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction</strong>, which is T-cell mediated and does not involve antibodies. It causes delayed immune responses, as seen in conditions like contact <span class=\"customMeta\" data-dictid=\"fedc53b3161692777186553c8f8d7d\">dermatitis</span> and tuberculosis.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 45-year-old woman presents with fatigue, jaundice, and shortness of breath. Laboratory tests reveal a hemoglobin level of 7.2 g/dL, elevated bilirubin, and a positive direct Coombs test. Peripheral blood smear shows spherocytes. Which of the following is the most likely diagnosis and its corresponding type of hypersensitivity?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Autoimmune Hemolytic Anemia (AIHA); Type 1"
      },
      {
        "id": 2,
        "text": "Rheumatoid Arthritis; Type 1"
      },
      {
        "id": 3,
        "text": "Autoimmune Hemolytic Anemia (AIHA); Type 2"
      },
      {
        "id": 4,
        "text": "Myasthenia Gravis; Type 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) <span class=\"customMeta\" data-dictid=\"96ab11a06a16927771823151c8e471\">Autoimmune</span> <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">Hemolytic</span> <span class=\"customMeta\" data-dictid=\"53bee2a41216927771814d7ec3a67f\">Anemia</span> (AIHA): <span class=\"customMeta\" data-dictid=\"05e8c1df0d1692777201c9acee8b1f\">Type 2</span> Hypersensitivity</strong><br />\n\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>In AIHA, <strong>antibodies (IgG or IgM</strong>) target <span class=\"customMeta\" data-dictid=\"248111ded81692777197946454db52\">red blood cell</span> antigens, leading to <span class=\"customMeta\" data-dictid=\"8790b4667016927771979066e8958c\">RBC</span> destruction via <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">complement</span> <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">activation</span> or phagocytosis, typical of <strong>Type II <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> </strong>reactions. The direct <span class=\"customMeta\" data-dictid=\"39be9b36e21692777185ebcac8d57f\">Coombs test</span> is positive in AIHA, indicating <strong>antibodies </strong>attached to RBCs, consistent with <span class=\"customMeta\" data-dictid=\"bd04ba63bc1692777201f54e0ee060\">Type II</span> hypersensitivity, which is an antibody-mediated reaction against cell surface antigens.</li>\n\t<li>Type II <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reactions, also known as <strong>cytotoxic hypersensitivity</strong>, occur when antibodies (primarily <span class=\"customMeta\" data-dictid=\"2d9b37c62116927771891f3784d2c8\">IgG</span> or IgM) bind to antigens on the surface of cells or tissues. This binding activates the <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">complement</span> system or mediates <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> destruction via <span class=\"customMeta\" data-dictid=\"aa86b61bdd1692777195ea42ef0356\">phagocytosis</span> and <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> cytotoxicity, leading to tissue damage and inflammation. The damage is <strong>specific to the target cell or tissue</strong> expressing the antigen.</li>\n\t<li>Examples of <span class=\"customMeta\" data-dictid=\"05e8c1df0d1692777201c9acee8b1f\">Type 2</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> reactions:\n\t<ul>\n\t\t<li>Myasthenia Gravis</li>\n\t\t<li>Graves Disease</li>\n\t\t<li>Good pastures syndrome</li>\n\t\t<li>Autoimmune <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">hemolytic</span> anemia</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>\u00a0</p>\n\n<div style=\"text-align:center\">\n<figure class=\"caption_element\" style=\"display:inline-block\"><img alt=\"Type 2 HS reaction\" data-author=\"OpenStax College\" data-hash=\"10117\" data-license=\"CC BY 3.0\" data-source=\"https://commons.wikimedia.org/wiki/File:2228_Immune_Hypersensitivity_new.jpg\" data-tags=\"April2025\" src=\"https://image.prepladder.com/notes/wmj2nLuqoV8Z5gfI9y991744471092.png\" />\n<figcaption>{{caption_text}}</figcaption>\n</figure>\n</div>\n\n<p>\u00a0</p>\n\n<p><br />\n\u00a0</p>\n\n<p><strong>Autoimmune <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">Hemolytic</span> <span class=\"customMeta\" data-dictid=\"53bee2a41216927771814d7ec3a67f\">Anemia</span> (AIHA): <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">Type 1</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> (Option A</strong>) <span class=\"customMeta\" data-dictid=\"3b4c3c13fb169277718004f65ca0b1\">AIHA</span> does not involve <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> hypersensitivity, which is IgE-mediated and usually <span class=\"customMeta\" data-dictid=\"8d0fca798b1692777191b6cd41880f\">linked</span> to allergies.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Rheumatoid Arthritis: <span class=\"customMeta\" data-dictid=\"ebcb7136251692777201ef4b5c5718\">Type 1</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">Hypersensitivity</span> (Option B</strong>) <span class=\"customMeta\" data-dictid=\"40dbde72e41692777197e59d893839\">Rheumatoid</span> <span class=\"customMeta\" data-dictid=\"6f74c7bfe0169277718240005b59d1\">arthritis</span> is primarily associated with <span class=\"customMeta\" data-dictid=\"adcadb82091692777201d084ed114c\">Type III</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> (immune complex-mediated).</p>\n\n<p>\u00a0</p>\n\n<p><strong>Myasthenia Gravis: <span class=\"customMeta\" data-dictid=\"26a46d0aaa169277720147f4f40f57\">Type 4</span> Hypersensitivity</strong> (<strong>Option D)</strong> <span class=\"customMeta\" data-dictid=\"6fa809ad22169277719323eaa30f1e\">Myasthenia</span> gravis is a <span class=\"customMeta\" data-dictid=\"bd04ba63bc1692777201f54e0ee060\">Type II</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction.</p>\n\n<p><br />\n<br />\n\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [
      "https://image.prepladder.com/notes/wmj2nLuqoV8Z5gfI9y991744471092.png"
    ],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 30-year-old woman presents with joint pain, fever, and a malar rash. Laboratory tests show proteinuria, low complement levels, and the presence of anti-nuclear antibodies (ANA) and anti-dsDNA antibodies. Which of the following mechanisms best explains the pathology of her disease?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Direct binding of IgE to mast cells, leading to histamine release"
      },
      {
        "id": 2,
        "text": "Antibody-mediated cytotoxicity targeting red blood cell antigens"
      },
      {
        "id": 3,
        "text": "Deposition of immune complexes in tissues"
      },
      {
        "id": 4,
        "text": "T-cell-mediated cytotoxicity targeting self-antigens on tissue cells"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: Option C) Deposition of immune complexes in tissues</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The patient's symptoms and lab findings suggest <strong>Systemic <span class=\"customMeta\" data-dictid=\"ccd536a9071692777191f53538ca30\">Lupus</span> Erythematosus (SLE)</strong>, a classic <strong>Type III <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction.</strong></li>\n\t<li>In <span class=\"customMeta\" data-dictid=\"adcadb82091692777201d084ed114c\">Type III</span> hypersensitivity, <strong>immune complexes</strong> (e.g., anti-dsDNA antibodies <span class=\"customMeta\" data-dictid=\"d82fcb9d1f16927771836a9f6ccf14\">bound</span> to DNA) are formed in <span class=\"customMeta\" data-dictid=\"337d16dac5169277718474b97f6e4a\">circulation</span> and deposit in tissues such as the kidneys, skin, and joints.</li>\n\t<li>These deposits <span class=\"customMeta\" data-dictid=\"dddc752e1716927771807f985bb8bb\">activate</span> the <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">complement</span> system, leading to <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and tissue damage. This explains the joint pain, proteinuria, and low <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">complement</span> levels commonly seen in SLE.</li>\n</ul>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>\n\n<p><strong>Direct binding of <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> to <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cells, leading to <span class=\"customMeta\" data-dictid=\"b5d4ddbfe71692777189a12acd5502\">histamine</span> release (Option A)</strong> describes the mechanism of <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> (e.g., allergies).</p>\n\n<p>\u00a0</p>\n\n<p><strong>Antibody-mediated <span class=\"customMeta\" data-dictid=\"569eae3b3516927771850ba9123b99\">cytotoxicity</span> <span class=\"customMeta\" data-dictid=\"e4865847fa169277720044d7b530b0\">targeting</span> <span class=\"customMeta\" data-dictid=\"248111ded81692777197946454db52\">red blood cell</span> antigens(Option B)</strong> relates to <span class=\"customMeta\" data-dictid=\"bd04ba63bc1692777201f54e0ee060\">Type II</span> hypersensitivity, where antibodies bind directly to cell surface antigens.</p>\n\n<p>\u00a0</p>\n\n<p><strong>T-cell-mediated <span class=\"customMeta\" data-dictid=\"569eae3b3516927771850ba9123b99\">cytotoxicity</span> <span class=\"customMeta\" data-dictid=\"e4865847fa169277720044d7b530b0\">targeting</span> self-antigens on tissue cells</strong> (<strong>Option D)</strong> is characteristic of <span class=\"customMeta\" data-dictid=\"4019d01072169277720163b0f7ec43\">Type IV</span> hypersensitivity, which involves T-cell-mediated <span class=\"customMeta\" data-dictid=\"12a6f23332169277718402ca6703e2\">cellular</span> destruction.</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 25-year-old male presents with a recent history of sore throat, followed by dark-colored urine, facial swelling, and high blood pressure. Laboratory findings show proteinuria, hematuria, and elevated anti-streptolysin O (ASO) titers. Which of the following best describes the patient\u2019s condition?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Goodpasture syndrome"
      },
      {
        "id": 2,
        "text": "Post-streptococcal glomerulonephritis"
      },
      {
        "id": 3,
        "text": "Myasthenia gravis"
      },
      {
        "id": 4,
        "text": "Contact dermatitis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) Post-streptococcal glomerulonephritis</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The patient\u2019s symptoms and laboratory findings suggest <strong>post-streptococcal <span class=\"customMeta\" data-dictid=\"d3658e1af116927771887bc5b8a57e\">glomerulonephritis</span> (PSGN)</strong>, a <strong>Type III <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction. </strong>In PSGN, immune complexes formed in response to streptococcal antigens deposit in the <span class=\"customMeta\" data-dictid=\"c9bd75ce5f1692777188f7fe800061\">glomeruli</span> of the kidneys, leading to <span class=\"customMeta\" data-dictid=\"f0ff39a3fa1692777184cf743ca1e7\">complement</span> activation, inflammation, and tissue damage.</li>\n\t<li>Type III <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reactions, also known as <strong>immune complex-mediated hypersensitivity</strong>, involve the formation of immune complexes (antigen-antibody complexes) that circulate in the bloodstream.</li>\n\t<li><strong>Examples </strong>of <span class=\"customMeta\" data-dictid=\"6f809a27121692777201d1ccde5ace\">Type 3</span> HS reactions include:\n\t<ul>\n\t\t<li>Serum Sickness: occurs after exposure to <span class=\"customMeta\" data-dictid=\"efe29e9d1c1692777203b2f7930066\">foreign serum</span> proteins, with immune complexes causing fever, rash, and joint pain.</li>\n\t\t<li>SLE: immune complexes deposit in various organs, causing multi-organ inflammation.</li>\n\t\t<li>Henoch Schonelien Purpura: deposition of <span class=\"customMeta\" data-dictid=\"68bae589ad169277718918627baff4\">IgA</span> immune complexes in blood vessels</li>\n\t\t<li>Arthus reaction: <span class=\"customMeta\" data-dictid=\"8fb8df140b1692777191702bbc9358\">localized</span> reaction from immune complex deposition at the <span class=\"customMeta\" data-dictid=\"3509997646169277719014053aa74d\">injection</span> site, causing <span class=\"customMeta\" data-dictid=\"e3d212ebd316927771996e0c472d4a\">swelling</span> and redness.</li>\n\t\t<li>PSGN: immune complexes from streptococcal infection deposit in the kidneys.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><br />\n\u00a0</p>\n\n<table cellspacing=\"0\" style=\"border-collapse:collapse; width:624px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Description</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Examples </strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type I (Immediate)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>IgE-mediated reactions, leading to <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cell <span class=\"customMeta\" data-dictid=\"adb3e39bbf1692777185215fad237b\">degranulation</span> and <span class=\"customMeta\" data-dictid=\"b5d4ddbfe71692777189a12acd5502\">histamine</span> release.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Examples include <span class=\"customMeta\" data-dictid=\"3f1938c99b16927771810c68214ce0\">allergic rhinitis</span> and anaphylaxis.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type II (Cytotoxic)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Mediated by <span class=\"customMeta\" data-dictid=\"2d9b37c62116927771891f3784d2c8\">IgG</span> or <span class=\"customMeta\" data-dictid=\"e4a6fd7fbb169277718986a699e800\">IgM</span> antibodies directed against antigens on cell surfaces or matrix, causing cell lysis.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Conditions include <span class=\"customMeta\" data-dictid=\"96ab11a06a16927771823151c8e471\">autoimmune</span> <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">hemolytic</span> <span class=\"customMeta\" data-dictid=\"53bee2a41216927771814d7ec3a67f\">anemia</span> and rheumatic fever.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type III (Immune Complex)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Caused by the formation of antigen-antibody complexes that deposit in tissues, leading to inflammation.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Examples include <span class=\"customMeta\" data-dictid=\"8f2e7fd96116927771995b451b5c90\">systemic</span> <span class=\"customMeta\" data-dictid=\"ccd536a9071692777191f53538ca30\">lupus</span> erythematosus and post-streptococcal glomerulonephritis.</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p><strong>Type IV (Delayed)</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Mediated by T cells, occurring hours to days after exposure to an antigen.</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid #000000; border-left:1px solid #000000; border-right:1px solid #000000; border-top:1px solid #000000; vertical-align:top\">\n\t\t\t<p>Seen in contact <span class=\"customMeta\" data-dictid=\"fedc53b3161692777186553c8f8d7d\">dermatitis</span> and <span class=\"customMeta\" data-dictid=\"0fe92012341692777201bab3db39b1\">tuberculin</span> reactions.</p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Goodpasture syndrome</strong> (<strong>Option A) </strong>involves <span class=\"customMeta\" data-dictid=\"bd04ba63bc1692777201f54e0ee060\">Type II</span> hypersensitivity, where antibodies target basement <span class=\"customMeta\" data-dictid=\"34cd707428169277719272942b7905\">membrane</span> antigens in the kidneys and lungs.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Myasthenia gravis (Option C)</strong> is a <span class=\"customMeta\" data-dictid=\"bd04ba63bc1692777201f54e0ee060\">Type II</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction <span class=\"customMeta\" data-dictid=\"e4865847fa169277720044d7b530b0\">targeting</span> <span class=\"customMeta\" data-dictid=\"a79a62c36e169277718062f9630d56\">acetylcholine</span> receptors at the <span class=\"customMeta\" data-dictid=\"8b19cd5e161692777193ad958e52e0\">neuromuscular</span> junction.</p>\n\n<p>\u00a0</p>\n\n<p><strong>Contact dermatitis</strong> (<strong>Option D ) </strong>is a <span class=\"customMeta\" data-dictid=\"4019d01072169277720163b0f7ec43\">Type IV</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction mediated by T cells in response to allergens on the skin.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 35-year-old man presents with a red, itchy rash on his hands that developed two days after using a new pair of latex gloves. Physical examination reveals erythematous, scaly patches on both hands. Which of the following best describes the mechanism of this patient\u2019s condition, a Type IV hypersensitivity reaction?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Activation of IgE antibodies bound to mast cells"
      },
      {
        "id": 2,
        "text": "Formation of antigen-antibody complexes"
      },
      {
        "id": 3,
        "text": "Direct binding of antibodies to cell surface antigens"
      },
      {
        "id": 4,
        "text": "Activation of sensitized T cells"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) <span class=\"customMeta\" data-dictid=\"ba6b77f29316927771807350f86ce2\">Activation</span> of <span class=\"customMeta\" data-dictid=\"e1c24f762816927771989a2101cb3c\">sensitized</span> T cells</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The patient\u2019s presentation is consistent with allergic contact <span class=\"customMeta\" data-dictid=\"fedc53b3161692777186553c8f8d7d\">dermatitis</span> due to <span class=\"customMeta\" data-dictid=\"60088572d31692777191346a90b73f\">latex</span> exposure, a classic <strong>Type IV <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction</strong>.</li>\n\t<li>In this delayed-type hypersensitivity, T cells are <span class=\"customMeta\" data-dictid=\"e1c24f762816927771989a2101cb3c\">sensitized</span> to an <span class=\"customMeta\" data-dictid=\"782b31281a1692777181708484c1d1\">antigen</span> (latex in this case). Upon re-exposure, these T cells release cytokines, which attract macrophages and other immune cells, leading to <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and skin changes.</li>\n\t<li>Type IV <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> is characterized by a <strong>T cell-mediated immune</strong> response that results in delayed <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and tissue damage upon re-exposure to an antigen.</li>\n\t<li>Unlike other types of <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> that involve antibodies, <span class=\"customMeta\" data-dictid=\"4019d01072169277720163b0f7ec43\">Type IV</span> is purely <strong>cell-mediated</strong> and plays a crucial role in both protective <span class=\"customMeta\" data-dictid=\"4f9ee631c21692777189b1e0cdc91c\">immunity</span> and <span class=\"customMeta\" data-dictid=\"96ab11a06a16927771823151c8e471\">autoimmune</span> diseases.</li>\n\t<li>The key players in this response are T cells, macrophages, and cytokines, which work together to produce <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and tissue injury.</li>\n\t<li>Seen in <strong>contact <span class=\"customMeta\" data-dictid=\"fedc53b3161692777186553c8f8d7d\">dermatitis</span> </strong>and <strong>tuberculin reactions.</strong></li>\n</ul>\n\n<p>\u00a0</p>\n\n<p><strong>Activation of <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> antibodies <span class=\"customMeta\" data-dictid=\"d82fcb9d1f16927771836a9f6ccf14\">bound</span> to <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cells (Option A)</strong> describes the mechanism of <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> hypersensitivity, involving <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> and <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cells.</p>\n\n<p><strong>Formation of antigen-antibody complexes (Option B)</strong> relates to <span class=\"customMeta\" data-dictid=\"adcadb82091692777201d084ed114c\">Type III</span> hypersensitivity, where immune complexes deposit in tissues.</p>\n\n<p><strong>Direct binding of antibodies to cell surface antigens</strong> (<strong>Option C)</strong> is characteristic of <span class=\"customMeta\" data-dictid=\"bd04ba63bc1692777201f54e0ee060\">Type II</span> hypersensitivity, involving antibodies <span class=\"customMeta\" data-dictid=\"e4865847fa169277720044d7b530b0\">targeting</span> cell surface antigens.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 40-year-old male presents with a rash on his arms and neck that developed several days after he worked in his garden, where he handled several plants. He mentions he has never had a rash before but recently experienced severe itching and redness in the affected areas. A patch test reveals an allergic reaction to a specific plant resin. What type of hypersensitivity does it represent?</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Type II hypersensitivity"
      },
      {
        "id": 2,
        "text": "Type IV hypersensitivity"
      },
      {
        "id": 3,
        "text": "Type III hypersensitivity"
      },
      {
        "id": 4,
        "text": "Type I hypersensitivity"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Answer: B) Allergic contact dermatitis: <span class=\"customMeta\" data-dictid=\"4019d01072169277720163b0f7ec43\">Type IV</span> hypersensitivity</strong></p>\n\n<p><strong>Explanation: </strong></p>\n\n<ul>\n\t<li>The patient's presentation is indicative of <strong>allergic contact dermatitis</strong>, a classic example of <strong>Type IV hypersensitivity</strong>. This occurs when <span class=\"customMeta\" data-dictid=\"e1c24f762816927771989a2101cb3c\">sensitized</span> T cells respond to contact with specific allergens, such as plant resins, leading to delayed local inflammation.</li>\n\t<li>Type IV <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> is characterized by a T cell-mediated <span class=\"customMeta\" data-dictid=\"dc6add5cf91692777189b30a6bae38\">immune response</span> that results in delayed <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and tissue damage upon re-exposure to an antigen.</li>\n\t<li>Some <strong>examples </strong>include:\n\t<ul>\n\t\t<li>Granuloma formation - chronic <span class=\"customMeta\" data-dictid=\"dc6add5cf91692777189b30a6bae38\">immune response</span> seen in tuberculosis, sarcoidosis, and leprosy.</li>\n\t\t<li>Contact <span class=\"customMeta\" data-dictid=\"fedc53b3161692777186553c8f8d7d\">dermatitis</span> - skin reaction to allergens like <span class=\"customMeta\" data-dictid=\"b437be3f051692777196d06a1fa93d\">poison</span> ivy, nickel, or latex.</li>\n\t\t<li>Multiple <span class=\"customMeta\" data-dictid=\"dae4dea0581692777198fdef9fa684\">Sclerosis</span> - T-cell attack on <span class=\"customMeta\" data-dictid=\"47fec911a316927771933b7607bdf0\">myelin</span> in the central nervous system.</li>\n\t\t<li>Rheumatoid <span class=\"customMeta\" data-dictid=\"6f74c7bfe0169277718240005b59d1\">arthritis</span> - T-cell-mediated attack on joint tissues.</li>\n\t\t<li>Tuberculin skin test (Mantoux test) \u2013 reaction to <span class=\"customMeta\" data-dictid=\"6a367ebd0c169277719091155a5b0f\">injected</span> <span class=\"customMeta\" data-dictid=\"0fe92012341692777201bab3db39b1\">tuberculin</span> <span class=\"customMeta\" data-dictid=\"782b31281a1692777181708484c1d1\">antigen</span> in previously <span class=\"customMeta\" data-dictid=\"e1c24f762816927771989a2101cb3c\">sensitized</span> individuals.</li>\n\t\t<li>Hashimoto\u2019s <span class=\"customMeta\" data-dictid=\"df0e1364a11692777200ed67550c12\">thyroiditis</span> \u2013 T-cell-mediated destruction of <span class=\"customMeta\" data-dictid=\"799202e6fe16927772009a1501b0a8\">thyroid</span> cells.</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p><strong>Systemic <span class=\"customMeta\" data-dictid=\"ccd536a9071692777191f53538ca30\">lupus</span> erythematosus</strong> (<strong>Option A)</strong> is an <span class=\"customMeta\" data-dictid=\"96ab11a06a16927771823151c8e471\">autoimmune</span> condition primarily associated with <span class=\"customMeta\" data-dictid=\"adcadb82091692777201d084ed114c\">Type III</span> hypersensitivity.</p>\n\n<p><strong>Serum <span class=\"customMeta\" data-dictid=\"73c1caf8d11692777198b1248373d3\">sickness</span> </strong>(<strong>Option C)</strong> is a <span class=\"customMeta\" data-dictid=\"adcadb82091692777201d084ed114c\">Type III</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction involving immune complexes.</p>\n\n<p><strong>Anaphylaxis (Option D)</strong> is a <span class=\"customMeta\" data-dictid=\"946a9a6be11692777201eb269e8327\">Type I</span> <span class=\"customMeta\" data-dictid=\"2c7e1ce33316927771892ce1da8276\">hypersensitivity</span> reaction mediated by <span class=\"customMeta\" data-dictid=\"a54166a5961692777189c5557f61f3\">IgE</span> antibodies and <span class=\"customMeta\" data-dictid=\"1f95a52091169277719133cc234fe0\">mast</span> cells.</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  }
];
        let quizName = '40 Hypersensitivity Reactions';
        let hierarchy = ["PrepLadder", "qBank", "Microbiology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>