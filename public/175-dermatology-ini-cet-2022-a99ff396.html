<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>175 Dermatology Ini-Cet 2022 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Dermatology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">16</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 10-year-old boy presents with fever, joint pain, and a lesion over his hand as seen in the image below. Which of the following is the clinical finding given and what is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Gottron's papules - Juvenile dermatomyositis"
      },
      {
        "id": 2,
        "text": "Rheumatoid nodules - Juvenile rheumatic arthritis"
      },
      {
        "id": 3,
        "text": "Sclerodactyly - Systemic sclerosis"
      },
      {
        "id": 4,
        "text": "Mechanic's hand - Systemic lupus erythematosus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>Shawl sign</strong>: Erythematous macules over posterior neck and upper back</li>\n<li>Mechanic's hand: Roughening and cracking of the skin of the tips and sides of the fingers, resulting in irregular, dirty-appearing lines that resemble those of a mechanic or manual laborer</li>\n<li><strong>Nail bed telangiectasias</strong></li>\n<li>Subcutaneous calcium deposits</li>\n</ul>\n<p>DM is associated with <strong>interstitial lung diseases</strong> (ILD) and <strong>internal malignancies</strong>, most commonly adenocarcinomas. Adult onset DM has a stronger association with malignancies.</p>\n<p>Laboratory evaluation of patients with dermatomyositis will reveal&nbsp;<strong>elevated serum creatinine kinase</strong>&nbsp;and&nbsp;<strong>antinuclear antibodies</strong>. Electromyography will reveal features of myopathy. Histology will show&nbsp;<strong>perifascicular atrophy.</strong> Immunohistochemical staining will reveal&nbsp;<strong>myxovirus resistance protein A</strong>, a sensitive and specific marker.&nbsp;</p>\n<p>Treatment of dermatomyositis is include:</p>\n<ul>\n<li>Immunotherapy with&nbsp;<strong>high-dose glucocorticoids</strong>&nbsp;- first-line drug</li>\n<li><strong>Methotrexate</strong>&nbsp;-&nbsp;<strong>second line</strong>&nbsp;drug. Indications include -\n<ul>\n<li>When patient presents with severe weakness, or other organ system involvement</li>\n<li>Patients with risk of steroid complications like patients with diabetes, osteoporosis, or postmenopausal women</li>\n<li>Patients who do not show improvement after 2-4 months of treatment with prednisone or those who cannot be maintained on a low dose&nbsp;</li>\n</ul>\n</li>\n<li><strong>Triple therapy</strong>&nbsp;with&nbsp;<strong>intravenous immunoglobulin&nbsp;</strong>or<strong>&nbsp;rituximab</strong>&nbsp;may be required</li>\n</ul>\n<p>The prognosis is favourable in the absence of associated ILD or malignancies.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/97027f2b362b4481b06e4ad54900354c.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c38ff86cefc04031b69ec9c2b9497d08x768x305.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2d18d2831fa54e98b4b3fbb9de281209x281x240.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/532ee519df5240c48206d3239d543d08x768x423.JPEG"
    ]
  },
  {
    "text": "A 12-week pregnant woman who is already on multidrug therapy for leprosy presents with type 2 lepra reaction. What is the treatment of choice for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Stop MDT and start oral steroids"
      },
      {
        "id": 2,
        "text": "Antibiotics"
      },
      {
        "id": 3,
        "text": "Thalidomide"
      },
      {
        "id": 4,
        "text": "Continue MDT and add oral steroids"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The treatment of choice for a <strong>pregnant</strong> lady with <strong>type 2 lepra</strong> reaction is to <strong>continue multidrug therapy (MDT)&nbsp;</strong>and <strong>start oral steroids</strong>.&nbsp;MDT is <strong>not stopped</strong> in lepra reactions. MDT is proven to be<strong> safe</strong>&nbsp;in pregnancy.&nbsp;Thalidomide is contraindicated (especially in the 1st trimester) due to the risk of teratogenic changes in the fetus (phocomelia).</p>\n<div class=\"page\" title=\"Page 1428\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Type 2 lepra reaction</strong> or<strong> erythema nodosum leprosum</strong>&nbsp;(ENL) is an immune complex-mediated syndrome&nbsp;(<strong>type 3 hypersensitivity</strong>) affecting the skin, nerves, and other organs. It is&nbsp;mainly seen in the multibacillary form of leprosy and is commonly recurrent. It usually occurs during treatment, but can also be seen before or after treatment.</p>\n<p>ENL presents with acute onset, painful, erythematous nodules on the face and<strong>&nbsp;extensor surfaces</strong>&nbsp;of limbs that blanch on pressure.&nbsp;<strong>Systemic manifestations</strong>&nbsp;include fever, malaise, anorexia, neuritis, uveitis, dactylitis, arthritis, myositis, etc. can also be seen.&nbsp;</p>\n<p><strong>Treatment</strong>&nbsp;includes:</p>\n<ul>\n<li><strong>Thalidomide&nbsp;</strong>is the drug of choice in young men with severe or recurrent ENL. It is <strong>contraindicated</strong> during <strong>pregnancy</strong> due to its high <strong>teratogenicity </strong>causing <strong>phocomelia</strong>. Even in women of reproductive age, it is given with caution.</li>\n<li><strong>Glucocorticoids</strong>&nbsp;(high doses) are routinely used in all patients and help in <strong>suppressing</strong> the acute signs and symptoms of inflammation.&nbsp;</li>\n<li><strong>Clofazimine</strong> is useful as long-term maintenance therapy for <strong>preventing recurrent reactions</strong>. Clofazimine is not given to this patient because it is already a part of the MDT regimen containing dapsone,&nbsp;rifampicin, and clofazimine.</li>\n</ul>\n<p>&nbsp;</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presents to the outpatient department with a satellite skin lesion. On examination, he has one hypopigmented lesion and one thickened nerve. Images of two blister packs are given below. The treatment best suited for this patient would be:",
    "choices": [
      {
        "id": 1,
        "text": "Packet 1 for 12 months"
      },
      {
        "id": 2,
        "text": "Packet 2 for 12 months"
      },
      {
        "id": 3,
        "text": "Packet 1 for 6 months"
      },
      {
        "id": 4,
        "text": "Packet 2 for 6 months"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p><strong>Chemoprophylaxis</strong> for leprosy should be given in those</p>\n</div>\n</div>\n</div>\n</div>\n<ul>\n<li><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">Age more than 2 years</span></li>\n<li><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">Close contact for more than 20 hours per week for more than 3 months</span></li>\n</ul>\n<p>A <strong>single dose of rifampicin</strong> is recommended for the close contact of a patient with leprosy provided they do not develop any signs or symptoms pertaining to leprosy.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8c2d8461f7a54066a71c7b393a63be11.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/043e8d80f09d40cfac5f975f0baaca64x367x512.JPEG"
    ]
  },
  {
    "text": "Chemoprophylaxis for leprosy should be given to which of the following persons?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 4"
      },
      {
        "id": 2,
        "text": "1, 3, 4"
      },
      {
        "id": 3,
        "text": "2, 3, 4"
      },
      {
        "id": 4,
        "text": "1, 2, 3"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Chemoprophylaxis</strong> for leprosy should be given to <strong>contacts 1,2 </strong>and<strong> 4.</strong></p>\n<p>Chemoprophylaxis for leprosy should be given to the following contacts:</p>\n<ul>\n<li class=\"p1\">A person who has been in close contact with the index case for <strong>20 hours</strong> or more <strong>per week</strong> for <strong>more than 3 months</strong>.</li>\n<li class=\"p1\"><strong>Close contact</strong> if the <strong>age</strong> is more than <strong>2 years</strong></li>\n</ul>\n<p>The contact mentioned in option 4, is with the patient for more than 3 months. Therefore, even this contact will require chemoprophylaxis.</p>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">Chemoprophylaxis cannot be given if there is/are:</span></p>\n<ul>\n<li><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">Possible signs of leprosy</span></li>\n<li><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">Signs or confirmed tuberculosis</span></li>\n<li><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">Liver or kidney disease</span></li>\n<li><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">Pregnancy</span></li>\n<li><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">Received rifampicin in the last 2 years</span></li>\n</ul>\n<p><span data-sheets-value=\"{&quot;1&quot;:2,&quot;2&quot;:&quot;Age more than 2 years&quot;}\" data-sheets-userformat=\"{&quot;2&quot;:769,&quot;3&quot;:{&quot;1&quot;:0},&quot;11&quot;:4,&quot;12&quot;:0}\">A <strong>single dose </strong>of<strong> rifampicin</strong> is used in chemoprophylaxis. Chemoprophylaxis must be initiated only 4 weeks after treatment for leprosy has begun in the patient so as to ensure the patient is non-infectious. </span></p>\n<table style=\"height: 164px; width: 410.5px;\">\n<tbody>\n<tr>\n<td style=\"width: 393.5px;\" colspan=\"2\"><strong>Dose of rifampicin in chemoprophylaxis of leprosy</strong></td>\n</tr>\n<tr>\n<td style=\"width: 205px;\"><strong>Age</strong></td>\n<td style=\"width: 188.5px;\"><strong>Dose</strong></td>\n</tr>\n<tr>\n<td style=\"width: 205px;\">Children 2-5 years</td>\n<td style=\"width: 188.5px;\">10-15 mg/kg</td>\n</tr>\n<tr>\n<td style=\"width: 205px;\">Children 6-9 years (less than 20kg)</td>\n<td style=\"width: 188.5px;\">150 mg</td>\n</tr>\n<tr>\n<td style=\"width: 205px;\">Children 6-9 years (more than 20kg)</td>\n<td style=\"width: 188.5px;\">300 mg</td>\n</tr>\n<tr>\n<td style=\"width: 205px;\">10-14 years</td>\n<td style=\"width: 188.5px;\">450 mg</td>\n</tr>\n<tr>\n<td style=\"width: 205px;\">15 years and above</td>\n<td style=\"width: 188.5px;\">600 mg</td>\n</tr>\n</tbody>\n</table>\n<p class=\"p2\">&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the following types of scales with their associated conditions.",
    "choices": [
      {
        "id": 1,
        "text": "1-b, 2-c, 3-d, 4-a"
      },
      {
        "id": 2,
        "text": "1-a, 2-b, 3-d, 4-c"
      },
      {
        "id": 3,
        "text": "1-d, 2-c, 3-a, 4-b"
      },
      {
        "id": 4,
        "text": "1-c, 2-b, 3-d, 4-a"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correctly matched option is option A: 1-b, 2-c, 3-d, 4-a.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old patient presents with the lesion given in the image below. He also describes having the sensation of spiders crawling in the area of the lesion when he woke up. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Herpes zoster infection"
      },
      {
        "id": 2,
        "text": "Irritant contact dermatitis"
      },
      {
        "id": 3,
        "text": "Allergic contact dermatitis"
      },
      {
        "id": 4,
        "text": "Herpes simplex infection"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image showing<strong>&nbsp;unilateral, red, grouped vesicles&nbsp;</strong>in a single<strong>&nbsp;dermatome</strong>&nbsp;associated with <strong>crawling sensation</strong> is highly<strong>&nbsp;</strong>suggestive of<strong>&nbsp;Herpes zoster infection.&nbsp;</strong></p>\n<p>Herpes zoster infection or <strong>shingles</strong> is a segmental eruption due to the&nbsp;<strong>reactivation</strong>&nbsp;of latent varicella-zoster virus from the&nbsp;<strong>dorsal root ganglia</strong>.&nbsp;An earlier infection with varicella is essential before zoster can occur.&nbsp;</p>\n<p>The first symptom&nbsp;of zoster is usually<strong>&nbsp;pain</strong>. It may also be accompanied by fever, headache, malaise, and tenderness localized to areas of one or more dorsal roots. The <strong>mucous membranes</strong> within the affected dermatomes are involved<strong>.</strong></p>\n<p>The patients are<strong>&nbsp;infectious</strong>, both from the virus in the lesions and the nasopharynx. The most commonly involved dermatomes in decreasing order of frequency are <strong>thoracic</strong> &gt; cervical &gt; <strong>trigeminal</strong> &gt; lumbosacral. The posterior nerve roots and ganglia show inflammatory changes.</p>\n<p>Zoster is a&nbsp;<strong>self\u2010limiting infection</strong>&nbsp;but it is painful and carries a risk of secondary infection and post\u2010herpetic neuralgia.&nbsp;<strong>Analgesia</strong>&nbsp;and treatment of secondary infections are sufficient for mild infections.</p>\n<p>Other options:&nbsp;</p>\n<p>Option B:<strong> Irritant contact dermatitis</strong>&nbsp;is the cutaneous response to the physical/toxic effects of a wide range of environmental exposures. The main clinical features are usually&nbsp;<strong>dryness</strong>&nbsp;or&nbsp;<strong>chapping</strong>. The lesions could commonly develop into patchy or diffuse erythema with&nbsp;<strong>scaling</strong>&nbsp;and&nbsp;<strong>fissuring</strong>.</p>\n<p>Option C: <strong>Allergic contact dermatitis</strong> is an&nbsp;<strong>eczematous reaction</strong>&nbsp;following&nbsp;<strong>exposure</strong>&nbsp;to a substance to which the immune system has previously been&nbsp;<strong>sensitized</strong>.&nbsp;</p>\n<p>Option D: <strong>Herpes simplex lesions</strong> are&nbsp;<strong>thin-walled, umbilicated vesicles,</strong>&nbsp;the roof of which breaks down, leaving tiny superficial&nbsp;<strong>ulcers.</strong>&nbsp;They heal without scarring.&nbsp;The most common site of cutaneous lesions in the face - is on the cheeks, chin, around the mouth, or on the forehead.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f8d7a5d1a5d64799b1f233491fa3e6b3.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old diabetic female patient presents with progressive skin lesions, as shown in the image. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Squamous cell carcinoma"
      },
      {
        "id": 2,
        "text": "Basal cell carcinoma"
      },
      {
        "id": 3,
        "text": "Discoid lupus eryhtematosus"
      },
      {
        "id": 4,
        "text": "Melasma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option D: <strong>Melasma</strong>\u00a0is the\u00a0<strong>most common</strong>\u00a0cause of\u00a0<strong>facial melanosis</strong>\u00a0that manifests as hyperpigmented macules on the face. It is exacerbated by\u00a0<strong>sun exposure</strong>\u00a0and\u00a0<strong>oral contraceptive pills</strong>. The condition is predominantly seen in<strong>\u00a0females</strong>.\u00a0Melasma is very common in the\u00a0<strong>3rd trimester</strong>\u00a0of pregnancy and is most marked in brunettes. It occurs due to increased levels of<strong>\u00a0estrogen</strong>\u00a0and<strong>\u00a0progesterone,</strong>\u00a0stimulating the activity of melanocytes.\u00a0It\u00a0resolves\u00a0on its own after pregnancy. Hypermelanosis affects mainly the upper lip, the malar regions, forehead, and the chin.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f7f305aaf267404e83dc1b7209ce4b2d.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5a5f70a19ea9495894674d3b9581c4bfx720x761.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/526a9613bd5d4f59b4cdf695750d44c7x720x527.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e337d287aabe440599fa0778b316dd1bx720x533.PNG"
    ]
  },
  {
    "text": "A diabetic patient presents with the following lesions in the armpit. Which of the following would be seen on Wood's lamp examination?",
    "choices": [
      {
        "id": 1,
        "text": "Yellow fluorescence"
      },
      {
        "id": 2,
        "text": "Coral red fluorescence"
      },
      {
        "id": 3,
        "text": "Blue fluorescence"
      },
      {
        "id": 4,
        "text": "Green fluorescence"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Coral\u2010red fluorescence</strong> with Wood&rsquo;s light is due to <strong>coproporphyrin III</strong> and suggests erythrasma. The fluorescence may persist after the eradication of the disease.&nbsp;</p>\n<p>Treatment of erythrasma is by using&nbsp;topical <strong>clotrimazole</strong>&nbsp;and&nbsp;<strong>miconazole</strong>&nbsp;for two weeks. For more extensive lesions,&nbsp;erythromycin&nbsp;can be administered. Relapse can occur. In such cases, long-term topical povidone-iodine application with drying agents can be used. Photodynamic therapy can also be attempted.&nbsp;</p>\n<p><strong>Green</strong>&nbsp;and blue-green fluorescence is seen in tinea capitis infections associated with microspora species and favus.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\"><strong>Pityriasis versicolor</strong>&nbsp;is caused by&nbsp;<strong><em>Malassezia</em></strong>&nbsp;species&nbsp;and the typical lesions are&nbsp;asymptomatic&nbsp;<strong>hypopigmented or hyperpigmented</strong>&nbsp;macules and patches and produce&nbsp;<strong>fine scales</strong>.&nbsp;The&nbsp;<strong>color of the scales may vary</strong>&nbsp;from pale ochre to medium brown.&nbsp;<strong>Pale yellow&nbsp;</strong>fluorescence seen in&nbsp;<strong>Wood&rsquo;s lamp&nbsp;</strong>examination is<strong>&nbsp;characteristic</strong>&nbsp;of<strong>&nbsp;tinea versicolor&nbsp;</strong>or<strong>&nbsp;pityriasis versicolor.</strong>&nbsp;</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/10f8f5323e3a4d049b708e0d234b7810.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1275e24bddb244d598449d1640458a15x720x514.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6a3650814ef04cd3ab3b1cbb370f901ex1280x960.JPEG"
    ]
  },
  {
    "text": "A 10-year-old boy is brought with weakness in his lower limbs and rash over the eyelids. The biopsy shows inflammation of the muscle. What is the finding shown in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Gottron's papules"
      },
      {
        "id": 2,
        "text": "Shawl sign"
      },
      {
        "id": 3,
        "text": "Heliotrope rash"
      },
      {
        "id": 4,
        "text": "Scleroderma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The finding shown in the image is&nbsp;<strong>Gottron's</strong>&nbsp;<strong>papules.</strong>&nbsp;The given scenario<strong>&nbsp;</strong>of a patient with weakness, rash, muscle inflammation, and presence of Gottron's papules on the skin is&nbsp;highly suggestive of<strong>&nbsp;dermatomyositis.</strong></p>\n<p><strong>Dermatomyositis</strong>&nbsp;(DM) is an autoimmune disorder predominantly affecting the&nbsp;<strong>skin</strong>&nbsp;and&nbsp;<strong>skeletal muscle</strong>. The following are various manifestations of dermatomyositis:</p>\n<ul>\n<li><strong>Proximal myopathy:</strong> Patients have trouble performing everyday activities like climbing stairs, getting up, and lifting their arms above their heads</li>\n<li><strong>Gottron's papules</strong>: Violaceous, erythematous papules overlying the dorsal interphalangeal or metacarpophalangeal, elbow, or knee joints, as shown in the image below</li>\n<li><strong>Gottron's sign</strong>: Symmetric, non-scaling, violaceous, erythematous macules or plaques, often atrophic, in the same distribution as Gottron's papules</li>\n<li><strong>Shawl sign</strong>/V-sign:&nbsp;Fixed macular erythema, across the shoulders and outer arms (Shawl distribution)</li>\n<li><strong>Periungual telangiectasias</strong>:&nbsp;Dilated capillaries of the nail folds</li>\n<li><strong>Mechanic's hand</strong>:<strong>&nbsp;</strong>Roughening and cracking of the skin of the tips and sides of the fingers, resulting in irregular, dirty-appearing lines that resemble those of a mechanic or manual laborer</li>\n<li>Less common manifestations include:&nbsp;Facial swelling, malignancy, erythroderma, lichen planus</li>\n</ul>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Laboratory evaluation of patients with dermatomyositis will reveal&nbsp;<strong>elevated levels of serum creatine kinase</strong>&nbsp;and&nbsp;<strong>antinuclear antibodies</strong>. Electromyography will reveal features of myopathy. Histology will show&nbsp;<strong>perifascicular atrophy.</strong> Immunohistochemical staining will reveal&nbsp;<strong>myxovirus resistance protein A</strong>, a sensitive and specific marker.&nbsp;</p>\n<p>Treatment of dermatomyositis:</p>\n<ul>\n<li>Immunotherapy with&nbsp;<strong>high-dose glucocorticoids</strong>&nbsp;- first-line drug</li>\n<li><strong>Methotrexate</strong>&nbsp;-&nbsp;<strong>second-line</strong>&nbsp;drug; indications include the following\n<ul>\n<li>When the patient presents with severe weakness, or other organ system involvement</li>\n<li>Patients with a risk of steroid complications like patients with diabetes, osteoporosis, or postmenopausal women</li>\n<li>Patients who do not show improvement after 2&ndash;4 months of treatment with prednisone or those who cannot be maintained on a low dose&nbsp;</li>\n</ul>\n</li>\n<li><strong>Triple therapy</strong>&nbsp;with&nbsp;<strong>intravenous immunoglobulin&nbsp;</strong>or<strong>&nbsp;rituximab</strong>&nbsp;may be required</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bcb0e241a34a48baa3c6a11321ce1702.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Consider the causes of alopecia. Which among the following cause(s) non-scarring alopecia?",
    "choices": [
      {
        "id": 1,
        "text": "3 and 4"
      },
      {
        "id": 2,
        "text": "1, 2, and 3"
      },
      {
        "id": 3,
        "text": "2, 3, and 4"
      },
      {
        "id": 4,
        "text": "Only 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Non-scarring alopecia is caused by androgenic alopecia, alopecia areata, and telogen effluvium (1, 2 and 3).&nbsp;&nbsp;<strong>Frontal fibrosing alopecia</strong> is&nbsp;a type of <strong>primary cicatricial (scarring) alopecia.</strong></p>\n<p><strong>Alopecia areata&nbsp;</strong>is a chronic inflammatory disease that causes&nbsp;<strong>non-scarring hair loss</strong>.&nbsp;It is a&nbsp;<strong>T-cell-mediated inflammatory disease.&nbsp;</strong>It is associated with several autoimmune diseases, including&nbsp;<strong>thyroiditis</strong>, lupus erythematosus<strong>,</strong>&nbsp;vitiligo, and psoriasis. It mainly affects the&nbsp;<strong>scalp,&nbsp;</strong>but can also affect the&nbsp;<strong>beard, eyebrows,&nbsp;</strong>and<strong>&nbsp;eyelashes.&nbsp;</strong>In some cases, this progresses to a total loss of scalp hair&nbsp;<strong>(alopecia totalis)</strong>&nbsp;or a loss of all hair on the body<strong>&nbsp;(alopecia universalis)</strong>.</p>\n<p><strong>Telogen effluvium</strong>&nbsp;is a type of<strong>&nbsp;nonscarring alopecia</strong>&nbsp;that is marked by&nbsp;<strong>diffuse</strong>&nbsp;<strong>shedding</strong>&nbsp;of normal hair. This occurs due to&nbsp;<strong>premature termination</strong>&nbsp;of the anagen phase of the hair cycle.&nbsp; It can be either acute or chronic.&nbsp;</p>\n<ul>\n<li><strong>Acute telogen effluvium</strong>&nbsp;occurs<strong>&nbsp;2&ndash;3 months</strong>&nbsp;after a stressful event such as high&nbsp;<strong>fever</strong>,&nbsp;<strong>surgery</strong>, starvation, and hemorrhage. Hormonal fluctuations during the&nbsp;<strong>postpartum</strong>&nbsp;period can trigger it (<strong>telogen gravidarum</strong>). Telogen effluvium can result in a diffuse reduction in hair density but never total baldness. It generally&nbsp;<strong>resolves</strong>&nbsp;<strong>spontaneously</strong>.&nbsp;</li>\n<li><strong>Chronic telogen effluvium</strong> is used to describe the diffuse shedding of telogen hair for more than<strong>&nbsp;6 months</strong>. Common causes include&nbsp;<strong>thyroid disorders</strong>, iron-deficiency anemia, and malnutrition.&nbsp;</li>\n</ul>\n<p><strong>Androgenetic alopecia </strong>is&nbsp;a disorder characterized by a reduction of hair fiber production by follicles and miniaturization. <strong>Dihydrotestosterone</strong>, an androgenic metabolite, is implicated in the etiology. It is of two types: male-pattern and female-pattern hair loss.&nbsp;Male-pattern hair loss causes <strong>frontal hairline recession</strong> and thinning of the <strong>vertex</strong>.&nbsp;&nbsp;Female-pattern hair loss involves the <strong>mid-frontal scalp</strong> diffusely. There is no or minimal involvement of the temporal region.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Match the following therapeutic methods used in the management of psoriasis with their possible side effects.",
    "choices": [
      {
        "id": 1,
        "text": "1-c, 2-b, 3-a, 4-d"
      },
      {
        "id": 2,
        "text": "1-c, 2-a, 3-b, 4-d"
      },
      {
        "id": 3,
        "text": "1-b, 2-d, 3-c, 4-a"
      },
      {
        "id": 4,
        "text": "1-b, 2-c, 3-a, 4-d"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The correctly matched pairs are as follows:</p>\n<table style=\"height: 163px; width: 375.459px; margin-left: auto; margin-right: auto;\">\n<tbody>\n<tr>\n<td style=\"width: 119px;\">Column A</td>\n<td style=\"width: 242.459px;\">Column B</td>\n</tr>\n<tr>\n<td style=\"width: 119px;\">1. PUVA</td>\n<td style=\"width: 242.459px;\">c. Long-term use increases the risk of skin cancer</td>\n</tr>\n<tr>\n<td style=\"width: 119px;\">2. Cyclosporine</td>\n<td style=\"width: 242.459px;\">b. Effective but is highly nephrotoxic</td>\n</tr>\n<tr>\n<td style=\"width: 119px;\">3. Methotrexate</td>\n<td style=\"width: 242.459px;\">a. Abortifacient</td>\n</tr>\n<tr>\n<td style=\"width: 119px;\">4. Acitretin</td>\n<td style=\"width: 242.459px;\">\u00a0d. Mucositis, teratogenic</td>\n</tr>\n</tbody>\n</table>\n<p style=\"text-align: center;\">\u00a0</p>\n<p style=\"text-align: left;\"><strong>PUVA</strong> is highly effective in clearing psoriasis with clearance rates of over 90%. It is associated with both acute (erythema, blistering) and chronic side effects. <strong>Long-term PUVA use</strong> is associated with the development of<strong> non-melanoma skin cancer</strong> (squamous cell cancer and basal cell cancer).</p>\n<p style=\"text-align: left;\"><strong>Cyclosporine</strong> is associated primarily with <strong>renal impairment</strong> (decreased GFR), metabolic disturbances, and an increased risk of malignancy. Due to its nephrotoxic effects, it is now uncommonly used for the maintenance of psoriasis.</p>\n<p style=\"text-align: left;\">Both <strong>acitretin</strong> and methotrexate are <strong>teratogenic</strong>.</p>\n<p style=\"text-align: left;\"><strong>Acitretin</strong> is associated with dose-dependent mucocutaneous side effects (<strong>mucositis</strong>) and hyperlipidemia. To prevent retinoid-induced embryopathy, female patients should\u00a0<strong>avoid\u00a0conception</strong> for<strong>\u00a03 years\u00a0after discontinuing</strong> acitretin\u00a0treatment.\u00a0</p>\n<p style=\"text-align: left;\">Acitretin is approved for use in the\u00a0<strong>cutaneous</strong>\u00a0manifestations of\u00a0<strong>psoriasis.</strong></p>\n<p style=\"text-align: left;\">Absolute contraindications:</p>\n<ul style=\"text-align: left;\">\n<li>Pregnant women</li>\n<li>Women who are planning to conceive</li>\n<li>Breastfeeding</li>\n</ul>\n<p style=\"text-align: left;\"><strong>Methotrexate</strong> is also associated with <strong>mucositis</strong> and <strong>teratogenicity</strong>, it has been used as an <strong>abortifacient</strong> and is used in the management of molar pregnancies. Methotrexate is also associated with <strong>hepatotoxicity</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Skin manifestations caused by the drug administered for amebic dysentery are due to ______.",
    "choices": [
      {
        "id": 1,
        "text": "Fixed drug eruption"
      },
      {
        "id": 2,
        "text": "Urticaria"
      },
      {
        "id": 3,
        "text": "Maculopapular rash"
      },
      {
        "id": 4,
        "text": "Atopic dermatitis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The skin manifestations are most commonly due to&nbsp;<strong>metronidazole, </strong>which is associated with <strong>fixed drug eruption (FDE)</strong>.</p>\n<p>Although maculopapular rashes can also be seen with metronidazole, <strong>the incidence of a fixed drug eruption is higher with metronidazole.</strong></p>\n<p>Fixed drug eruptions/ reactions are characterized by&nbsp;<strong>sharply demarcated,</strong>&nbsp;<strong>dull red</strong>&nbsp;<strong>to brown</strong>&nbsp;lesions. They occur on lips, hands, legs, face, genitalia, and oral mucosa, and can cause a burning sensation. They are usually solitary or few in number and&nbsp;<strong>recur at the exact location</strong>. But, new lesions can occur on different body parts on re-exposure to the offending drug. <br /><br />FDE is a type of&nbsp;<strong>delayed hypersensitivity reaction</strong>. Paracetamol/NSAIDs are some of the most common drugs causing FDE.</p>\n<p>Drug\u2010specific clinical patterns of FDE include:</p>\n<table style=\"height: 158px; width: 540px;\">\n<tbody>\n<tr>\n<td style=\"width: 244.635px;\"><strong>Drugs</strong>&nbsp;</td>\n<td style=\"width: 279.365px;\"><strong>Drug-specific clinical pattern of FDE</strong></td>\n</tr>\n<tr>\n<td style=\"width: 244.635px;\">NSAIDs</td>\n<td style=\"width: 279.365px;\">Lips and genitals</td>\n</tr>\n<tr>\n<td style=\"width: 244.635px;\">Tetracycline/ Trimethoprim- sulfamethoxazole</td>\n<td style=\"width: 279.365px;\">Genitals</td>\n</tr>\n<tr>\n<td style=\"width: 244.635px;\">Metamizole</td>\n<td style=\"width: 279.365px;\">Trunk and extremities</td>\n</tr>\n<tr>\n<td style=\"width: 244.635px;\">Carbocysteine</td>\n<td style=\"width: 279.365px;\">Face</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>Diagnosis is based on history and lesion morphology.&nbsp;<strong>Discontinuation&nbsp;</strong>of the offending drug is the&nbsp;<strong>first step</strong>&nbsp;in&nbsp;<strong>management</strong>.</p>\n<p>The image below shows a <strong>well-defined hyperpigmented patch</strong> of a <strong>fixed drug eruption</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/345b549e83ab4455865cab5f24863b73x720x581.PNG"
    ]
  },
  {
    "text": "A 40-year-old man presents with erythematous painful lesions on the trunk and face, joint pain, and glove and stocking pattern of anesthesia. Which of the following investigations is used for the diagnosis of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2"
      },
      {
        "id": 2,
        "text": "1, 2, 3"
      },
      {
        "id": 3,
        "text": "1, 3, 4"
      },
      {
        "id": 4,
        "text": "1, 2, 3, 4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario points to a case of <strong>leprosy</strong>. The diagnosis of this condition requires nerve examination, skin biopsy, and a slit skin smear (option B- 1, 2, 3).</p>\n<p><strong>Leprosy</strong> is a chronic granulomatous condition caused by<em><strong> Mycobacterium leprae</strong></em>. It affects the skin, cutaneous and peripheral nerves, and mucous membranes.&nbsp;The most commonly affected peripheral nerves are the&nbsp;<strong>posterior tibial nerve</strong>, followed by the&nbsp;<strong>ulnar</strong>, median, and lateral popliteal nerves. The most commonly involved cranial nerve is the&nbsp;<strong>facial nerve</strong>.&nbsp;</p>\n<p>Leprosy has a <strong>long incubation</strong> period, usually ranging from 2 to 12 years. It commonly presents as an <strong>area of numbness</strong> on the skin or a visible skin lesion which could be a <strong>hypopigmented </strong>or <strong>erythematous macule</strong>. Lesions usually involve the face, extensor aspect of the limbs, trunks, and buttocks. The lesions have <strong>impaired nerve function</strong> and poor hair growth. The patients may also present with burns or ulcers of the anesthetic limb.</p>\n<p>Classification systems of leprosy:&nbsp;</p>\n<ul>\n<li><strong>Ridley-Jopling</strong> classification:\n<ul>\n<li>Tuberculoid (TT)</li>\n<li>Borderline tubercular (BT)</li>\n<li>Borderline (BB)</li>\n<li>Borderline lepromatous (BL)</li>\n<li>Lepromatous (LL)</li>\n</ul>\n</li>\n<li><strong>WHO</strong> classification:\n<ul>\n<li>Paucibacillary</li>\n<li>Multibacillary</li>\n</ul>\n</li>\n</ul>\n<p><strong>Cardinal signs</strong>&nbsp;for the diagnosis of leprosy:</p>\n<ul>\n<li>Characteristic <strong>skin lesions</strong>- hypopigmented or erythematous lesions with definite <strong>impairment of sensation.</strong></li>\n<li><strong>Peripheral nerve</strong> involvement- <strong>thickening</strong> of the nerve with sensory impairment. Nerve tenderness can also be seen.</li>\n<li>Detection of <strong>acid-fast bacilli</strong> in slit-skin smear, skin biopsy, or positive biopsy PCR.</li>\n</ul>\n<p>The presence of two of the three signs can establish the diagnosis of leprosy. Other tests done for diagnosis of leprosy include nerve biopsy in pure neural leprosy and PGL-1 antibody in cases with low bacterial load.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the condition shown in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Paget disease"
      },
      {
        "id": 2,
        "text": "Lichen sclerosus"
      },
      {
        "id": 3,
        "text": "Lichen planus"
      },
      {
        "id": 4,
        "text": "Angioma of vulva"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Angioma of vulva&nbsp;</strong>- Hemangiomas and angiokeratomas are benign lesions of the vulva. Angiokeratomas are benign tumors characterized by hyperplasia of the epidermis along with multiple dilated vessels in the superficial dermis. They present as&nbsp;well-defined, <strong>erythematous, hyperkeratotic papules</strong>.&nbsp;Senile (cherry) hemangiomas usually present as red macules that rapidly progress to well-circumscribed, raised, red, and soft lesions. Excision biopsy of bleeding hemangiomas, cryosurgery, or carbon dioxide laser can be used for management.</p>\n<p>The image below shows a cherry angioma:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/19964030afb84bc7bfea88478d210a5b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/78562cea9ae4445486f25c023794802fx510x496.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b473c6ad5d7f4ec89bfd80f8856d6950x1280x1187.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6843a34749634958860677650fb5808dx542x600.JPEG"
    ]
  },
  {
    "text": "A patient comes to the OPD with the following skin manifestation of a disease associated with Raynaud phenomenon. What is the manifestation?",
    "choices": [
      {
        "id": 1,
        "text": "Poikiloderma"
      },
      {
        "id": 2,
        "text": "Salt and pepper pigmentation"
      },
      {
        "id": 3,
        "text": "Leukotrichia"
      },
      {
        "id": 4,
        "text": "Vitiligo"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario is suggestive of <strong>systemic sclerosis</strong>, and the skin manifestation shown is a&nbsp;<strong>salt-and-pepper appearance</strong>.</p>\n<p>Systemic sclerosis is an <strong>autoimmune disease</strong> of unknown etiology, complex pathogenesis, and variable clinical presentations. It is associated with significant <strong>disability</strong> and <strong>mortality.</strong> Virtually every organ is affected.&nbsp;<strong>Thickened</strong> and <strong>indurated</strong> skin, called <strong>scleroderma</strong>, is the distinguishing hallmark of systemic sclerosis.</p>\n<div class=\"page\" title=\"Page 1523\">\n<div class=\"section\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Cutaneous features of systemic sclerosis:</p>\n<ul>\n<li><strong>Raynaud phenomenon</strong>, with the typical white discoloration of the fingers caused by <strong>vasospasm</strong> and bluish discoloration of the fingertips</li>\n<li>Loss of pigmentation except in the perifollicular areas is known as the salt and pepper appearance of the skin, which is mostly seen in the upper back, chest, and scalp</li>\n<li>Puffy fingers in early disease</li>\n<li><strong>Sclerodactyly</strong> and <strong>sclerosis</strong> extending proximal to the metacarpophalangeal joints with or without contractures&nbsp;</li>\n<li><strong>Vasculopathic ulcers</strong> over the bony prominences</li>\n<li>Loss of fingertip pulp</li>\n<li>Severe flexion contractures</li>\n<li>Facial features include <strong>expressionless facies,</strong> mat\u2010like telangiectases, microstomia, perioral furrowing, and a beak\u2010like nose&nbsp;&nbsp;</li>\n</ul>\n</div>\n</div>\n<div class=\"layoutArea\">&nbsp;</div>\n</div>\n<div class=\"section\">Other options:</div>\n<div class=\"section\">&nbsp;</div>\n<div class=\"section\">Option A: <strong>Poikiloderma</strong> is a skin disorder characterized by hypopigmentation and hyperpigmentation, wrinkling following atrophy, and telangiectasias. It is seen in ionizing radiation-damaged skin and dermatomyositis.</div>\n<div class=\"section\">&nbsp;</div>\n<div class=\"section\">Option C: The hair in the amelanotic lesions of vitiligo can sometimes lose color and become white. This is called <strong>leukotrichia.</strong></div>\n<div class=\"section\">&nbsp;</div>\n<div class=\"section\">Option D: <strong>Vitiligo</strong> is characterized by depigmented macules that have sharp demarcation. It is due to the loss of melanocytes.</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3f8fbb147d334ed5907f39c38c61c3b8.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A  female patient came to the hospital with a history of relapsing, remitting, mildly itchy erythematous plaques over the scalp, sacral area, and knees. She has a  history of joint pain and her nail changes are shown in the image below. What is your diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Adult onset Still's disease"
      },
      {
        "id": 2,
        "text": "Pachyonychia congenita"
      },
      {
        "id": 3,
        "text": "Psoriasis"
      },
      {
        "id": 4,
        "text": "Lichen planus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The diagnosis in this patient with the above clinical features is <strong>psoriasis.</strong></p>\n<p>The image shows&nbsp;<strong>nail pitting, oil drop sign,&nbsp;</strong>and&nbsp;<strong>salmon patches </strong>in fingernails</p>\n<div class=\"page\" title=\"Page 1141\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Psoriasis is a chronic inflammatory condition of the skin with systemic manifestations. The skin lesions can have <strong>exacerbations</strong> and <strong>relapse.</strong> They include <strong>red</strong>, <strong>silvery-white</strong>&nbsp;<strong>well-demarcated scales.</strong> A peripheral clearing known as the <strong>ring of Woronoff</strong> may be present. It is usually seen on the <strong>scalp</strong>, <strong>trunk</strong>, and <strong>extensor surfaces</strong> of the limbs. The appearance of a smooth, glossy red membrane with small bleeding points on the removal of the supra-papillary epidermis by gentle scraping is known as&nbsp;<strong>Auspitz's sign.</strong></p>\n<p><strong>Psoriatic arthritis</strong> presents as&nbsp;<span style=\"font-size: 14px;\">early morning stiffness and joint swelling, heel pain due to enthesitis of the Achilles tendon, or plantar fasciitis. The clinical</span><span style=\"font-size: 14px;\">&nbsp;examination may reveal evidence of dactylitis (sausage fingers) or swollen or tender joints.</span>&nbsp;The distal interphalangeal joint (DIP) is classically involved in causing <strong>pencil-in cup</strong> deformity.</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p><strong>Punctate pitting</strong> is the most common nail finding and others include the&nbsp;<strong>oil-drop sign</strong>,&nbsp;subungual hyperkeratosis, splinter haemorrhages, and <strong>distal onycholysis</strong>.</p>\n<p>The topical application of <strong>steroids</strong>, retinoids, vitamin D, and <strong>emollients</strong> is the mainstay of management. <strong>Phototherapy</strong> and oral <strong>methotrexate</strong>, <strong>acitretin</strong>, and cyclosporine are used for more extensive and systemic diseases.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d9bd6517e74a4f0ea85b34e5c1da6437.PNG"
    ],
    "explanation_images": []
  }
];
        let quizName = '175 Dermatology Ini-Cet 2022';
        let hierarchy = ["Marrow", "PYQs", "Dermatology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>