<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jaundice Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 4 day old baby is active and feeding well. He has a bilirubin level of 8 mg/dl. What is the next step in the management of the baby?",
    "choices": [
      {
        "id": 1,
        "text": "Exchange transfusion"
      },
      {
        "id": 2,
        "text": "Stop breastfeeding and start phototherapy"
      },
      {
        "id": 3,
        "text": "IV fluids and phototherapy"
      },
      {
        "id": 4,
        "text": "Continue breastfeeding"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Since this child has a bilirubin level of only <strong>8 mg/dl</strong> on the 4<sup>th</sup> day, it points to <strong>physiologic jaundice</strong>. The child is active and feeding well, the&nbsp;mother should be encouraged to <strong>continue breastfeeding&nbsp;frequently and exclusively.</strong></p>\n<p><strong>All the other options</strong> would be possible treatment choices if the child had pathological jaundice.&nbsp;</p>\n<p><strong>Physiological jaundice</strong>/Icterus neonatorum is due to&nbsp;<strong>increased bilirubin production</strong>&nbsp;from the&nbsp;<strong>breakdown</strong>&nbsp;of&nbsp;<strong>fetal red</strong>&nbsp;<strong>blood cells</strong>&nbsp;combined with transient&nbsp;<strong>limitation in the conjugation of bilirubin</strong>&nbsp;by the immature&nbsp;<strong>neonatal liver</strong>. It first&nbsp;<strong>appears on the 2nd or 3rd days</strong> usually peaks on the 4th day at 5-6 mg/dL and decreases to &lt;2 mg/dL&nbsp;between the 5th and 7th days after birth.</p>\n<p>On the other hand, in&nbsp;<strong>pathological jaundice, </strong>appearance is<strong>&nbsp;within the first 24 hours</strong> after birth and may be present at or beyond the age of <strong>2 weeks </strong>in<strong> term </strong>babies and<strong> 3 weeks </strong>in<strong> preterms </strong>babies. There may be an elevated <strong>direct (or conjugated) bilirubin level</strong>. Jaundice visible on the <strong>palms and soles</strong>, <strong>unresponsiveness to phototherapy</strong>, and a rapid rise in bilirubin levels during phototherapy indicate pathological jaundice.</p>\n<p><strong>Phototherapy</strong> is initiated in babies with pathological jaundice when the <strong>bilirubin</strong> levels <strong>exceed</strong> the <strong>95th percentile</strong> on the <strong>total serum bilirubin </strong>(TSB)<strong> normogram</strong>. Babies are kept at a distance of <strong>30-45 cm</strong> from the UV lamp (<strong>460-490 nm</strong>) with <strong>eyes and gonads covered</strong>. It is <strong>avoided</strong> in babies with <strong>conjugated</strong> hyperbilirubinemia due to the risk of <strong>bronze-baby syndrome</strong>. <strong>Dehydration</strong> and <strong>hypocalcemia</strong> are potential complications and <strong>breastfeeding</strong> is encouraged.</p>\n<p><strong>Exchange transfusion</strong> (ET) is done in cases of <strong>bilirubin encephalopathy</strong>, <strong>Rh incompatibility with significant hemolysis</strong>, and bilirubin values exceeding TSB cutoffs for ET.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 50 year old man presents to you with intense pruritus, yellowing of the abdomen, palms, soles and sclera. One year ago, the patient received a liver transplant due to a diagnosis of hepatocellular cancer. Lab reports are shown below. Biopsy performed is as follows. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Primary Sclerosing Cholangitis"
      },
      {
        "id": 2,
        "text": "Autoimmune hepatitis"
      },
      {
        "id": 3,
        "text": "Vanishing bile duct syndrome"
      },
      {
        "id": 4,
        "text": "Recurrence of Hepatocellular carcinoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient exhibiting a <strong>cholestatic</strong> pattern of <strong>jaundice</strong>, accompanied by <strong>ductopenia</strong> as observed in the biopsy, and having undergone a <strong>liver transplant one year ago</strong>, may be diagnosed with<strong> vanishing bile duct syndrome</strong>.</p>\n<p><strong>Chronic rejection</strong> is characterized by the presence of focal parenchymal necrosis, mononuclear cell infiltration, progressive cholestasis, and fibrosis. In some patients, this process will lead to the loss of intrahepatic bile ducts, which is called <strong>vanishing bile duct syndrome.\u00a0</strong></p>\n<p>Vanishing Bile Duct Syndrome (<strong>VBDS</strong>) is used to describe a clinicopathological condition characterized by the presence of <strong>cholestasis</strong>, which is the impairment of bile flow, together with the<strong> disappearance of intrahepatic bile ducts</strong>, also known as <strong>ductopenia</strong>. Various factors, such as immune processes, infections, medications, and ischaemia, have been implicated as potential causes of bile duct degeneration. This degradation might manifest within a relatively short period of a few months or progress gradually over an extended period of several years. In this regard, the medical practitioner has the ability to differentiate between an acute or subacute form that progresses over several months. In this form, the presence of ductular reaction and portal fibrosis is not easily noticeable, and the characteristics of acute cholestasis, rather than chronic cholestasis, are more prominent. This can be observed in cases such as ductopenia occurring in allograft rejection, severe graft-versus-host disease (GVHD), certain medications, and treated Hodgkin lymphoma.</p>\n<p><strong>Chronic transplant rejection</strong> typically presents itself following a period of several months to years. This process elicits a response from <strong>both </strong>the <strong>cellular</strong> and <strong>humoral</strong> c<strong>omponents of the immune system</strong>(<strong>Type II and type IV </strong>hypersensitivity reactions). The CD4+ T cells exhibit a response to the recipient antigen-presenting cells (APCs) that present peptides derived from the donor, which may include the allogeneic major histocompatibility complex (MHC). The recipient T cells elicit a response and secrete cytokines, resulting in the proliferation of vascular smooth muscle, parenchymal atrophy, and interstitial fibrosis. It manifests as development of <strong>bronchiolitis obliterans</strong> in the <strong>pulmonary</strong> system, <strong>accelerated atherosclerosis</strong> in the <strong>cardiovascular</strong> system,<strong> graft nephropathy</strong> in the <strong>renal</strong> system, and <strong>vanishing bile duct syndrome</strong> in the <strong>hepatic</strong> system.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/60cbfa9349dd47aa8d73170e5c6bc388.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6025c8fb041a4117b30c654a8b3a51a2x600x450.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad76103db44a4eb78ab1c2ee7dfd8792x720x480.JPEG"
    ]
  },
  {
    "text": "A 2-month-old baby is brought with complaints of lethargy and reduced feeding. Clinical examination reveals yellowing of sclera, hypotonia and an enlarged tongue. Head circumference is at 90th percentile and weight is at 80th percentile. Abdomen is distended with a reducible mass at the umbilicus. Which of the following must be done to best manage this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Thyroid hormone replacement"
      },
      {
        "id": 2,
        "text": "Pyrimethamine + Leucovorin"
      },
      {
        "id": 3,
        "text": "Hepatoportoenterostomy"
      },
      {
        "id": 4,
        "text": "Diazoxide + Umbilical hernia repair"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>A history of constipation, lethargy, reduced feeding, jaundice, and hypotonia is suggestive of <strong>primary hypothyroidism</strong>. Since the child is 2 months of age, this is a case of congenital hypothyroidism. The best way to <strong>manage</strong> these patients would be the <strong>administration of thyroid hormone supplements.</strong></p>\n<p>Causes of Congenital hypothyroidism:</p>\n<table style=\"width: 381px;\">\n<tbody>\n<tr style=\"height: 36px;\">\n<td style=\"width: 154.265625px; height: 36px;\">\n<p><strong>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0Goitrous</strong></p>\n<p>\u00a0 \u00a0 (Palpable goiter)</p>\n</td>\n<td style=\"width: 222.734375px; height: 36px;\">\n<p><strong>\u00a0 \u00a0 \u00a0Non-goitrous</strong></p>\n<p>\u00a0 \u00a0(No palpable goiter)</p>\n</td>\n</tr>\n<tr style=\"height: 146px;\">\n<td style=\"width: 154.265625px; height: 146px;\">\n<ul>\n<li>Thyroid dyshormonogenesis</li>\n<li>Iodine deficiency</li>\n<li>Placental passage of antithyroid drugs</li>\n</ul>\n</td>\n<td style=\"width: 222.734375px; height: 146px;\">\n<ul>\n<li><strong>Thyroid dysgenesis</strong></li>\n<li>Thyroid receptor blocking antibodies</li>\n<li>Central hypothyroidism</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Clinical features of congenital hypothyroidism:</p>\n<ul>\n<li><strong>Prolongation of physiologic hyperbilirubinemia:</strong>\u00a0early sign <strong>(it is due to delayed maturation of glucuronide conjugation)</strong></li>\n<li><strong>Constipation:</strong>\u00a0usually does not respond to treatment</li>\n<li>Wide open anterior and posterior fontanelles\u00a0(&gt;0.5 cm) and cranial sutures</li>\n<li><strong>Developmental delay, delayed bone growth, delayed dentition</strong></li>\n<li><strong>Cardiovascular:</strong>\u00a0slow pulse rate, cardiomegaly, asymptomatic pericardial effusion, edema</li>\n<li><strong>Respiratory:</strong>\u00a0macroglossia, feeding difficulties, choking spells, respiratory difficulties</li>\n<li><strong>Hematological:</strong>\u00a0macrocytic anemia refractory to treatment with haematinics</li>\n<li><strong>Nervous system:</strong>\u00a0hypothermia, hypotonia, slow relaxation of deep tendon reflexes, sluggishness, and somnolence.</li>\n</ul>\n<p>Laboratory Findings:</p>\n<table style=\"width: 435px; height: 188px;\">\n<tbody>\n<tr>\n<td style=\"width: 185.8125px;\">Condition</td>\n<td style=\"width: 75.46875px;\">Goitre</td>\n<td style=\"width: 57.359375px;\">T4</td>\n<td style=\"width: 88.40625px;\">TSH</td>\n</tr>\n<tr>\n<td style=\"width: 185.8125px;\"><strong>Thyroid dysgenesis</strong></td>\n<td style=\"width: 75.46875px;\"><strong>Absent</strong></td>\n<td style=\"width: 57.359375px;\"><strong>Low</strong></td>\n<td style=\"width: 88.40625px;\"><strong>Elevated</strong></td>\n</tr>\n<tr>\n<td style=\"width: 185.8125px;\">Thyroid dyshormonogenesis</td>\n<td style=\"width: 75.46875px;\">Present</td>\n<td style=\"width: 57.359375px;\">Low</td>\n<td style=\"width: 88.40625px;\">Elevated</td>\n</tr>\n<tr>\n<td style=\"width: 185.8125px;\">Thyroid receptor blocking antibodies</td>\n<td style=\"width: 75.46875px;\">Absent</td>\n<td style=\"width: 57.359375px;\">Low</td>\n<td style=\"width: 88.40625px;\">Elevated</td>\n</tr>\n<tr>\n<td style=\"width: 185.8125px;\">Central hypothyroidism</td>\n<td style=\"width: 75.46875px;\">Absent</td>\n<td style=\"width: 57.359375px;\">Low</td>\n<td style=\"width: 88.40625px;\">Normal/Low</td>\n</tr>\n</tbody>\n</table>\n<p>Other options\u00a0</p>\n<p>Option B:<strong> Pyrimethamine + Leucovorin </strong>is used in the management of <strong>congenital toxoplasmosis. Congenital toxoplasmosis </strong>can also present with neonatal jaundice alongwith with an increased head circumference (as seen in this patient), and abdominal distension. But, <strong>umbilical hernia</strong> as well as <strong>macroglossia</strong> points towards a diagnosis of congenital hypothyroidism instead.</p>\n<p>Option C: <strong>Kasai's procedure</strong> ( <strong>Hepatoportoenterostomy</strong> ) is performed in the management of <strong>biliary atresia</strong>. Biliary atresia is characterized by the manifestation of newborn jaundice, which tends to occur with greater frequency following the <strong>first two weeks of an infant's life</strong>. The presence of <strong>hypotonia</strong> and an <strong>enlarged head</strong> in this patient <strong>does not contribute to the diagnosis of biliary atresia</strong>.</p>\n<p>Option D: <strong>Diazoxide, umbilical hernia repair and tongue reduction surgery</strong> can be performed in patients with a diagnosis of <strong>Beckwith-Wiedemann syndrome</strong>. Patients with <strong>Beckwith-Wiedmann syndrome</strong> manifest with enlarged tongue, abdominal distension as well as umbilical hernia. However, it is important to note that these patients <strong>do not have scleral icterus</strong> characteristically as a presenting feature.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 8-day-old neonate presents with yellowish discolouration of skin and sclera. Which of the following may not be a cause of neonatal jaundice that appears after the first week of life?",
    "choices": [
      {
        "id": 1,
        "text": "Congenital atresia of bile ducts"
      },
      {
        "id": 2,
        "text": "Breast milk jaundice"
      },
      {
        "id": 3,
        "text": "Erythroblastosis fetalis"
      },
      {
        "id": 4,
        "text": "Cystic fibrosis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Erythroblastosis fetalis</strong>&nbsp;causes neonatal jaundice and&nbsp;manifests within the <strong>first 24 hours of life,</strong> not after 1st week.</p>\n<p>Jaundice in the first 24 hours of life requires<strong> immediate attention</strong> and can be due to erythroblastosis fetalis, concealed hemorrhage, sepsis, or congenital infections, including syphilis, cytomegalovirus, rubella, and toxoplasmosis. Jaundice appearing on the 2<sup>nd</sup> or 3<sup>rd</sup> day of life is usually physiologic but also can be due to early onset breastfeeding jaundice and Crigler-Najjar syndrome (familial non-hemolytic icterus). Neonatal jaundice appearing after the 3<sup>rd</sup> day but within the 1<sup>st</sup> week of life can be due to bacterial sepsis, urinary tract infections or other infections like syphilis, etc.</p>\n<p>Neonatal jaundice appearing <strong>after the 1<sup>st</sup> week of life</strong> can be due a number of conditions like <strong>breast milk jaundice</strong>, <strong>congenital atresia</strong> or paucity of bile ducts, hepatitis, <strong>cystic fibrosis</strong>, hemolytic anemia, enzyme deficiencies etc.</p>\n<p><strong>Physiological jaundice/Icterus neonatorum</strong> is due to&nbsp;increased bilirubin production&nbsp;from the&nbsp;breakdown&nbsp;of&nbsp;fetal red&nbsp;blood cells&nbsp;combined with transient&nbsp;limitation in the conjugation of bilirubin&nbsp;by the immature&nbsp;neonatal liver. <strong>Continuation of breastfeeding</strong> exclusively resolves most of the cases.</p>\n<p>The image below is of a schematic to approach to the diagnosis of neonatal jaundice:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0be12a483f1d40838d5152d04220b208x1280x2324.JPEG"
    ]
  },
  {
    "text": "A middle-aged man with chronic alcohol consumption presents with yellowish discoloration of the skin, abdominal pain, and fever. Which of the following medicines is most likely to reduce the mortality in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Octreotide for 2 weeks"
      },
      {
        "id": 2,
        "text": "Oral prednisolone for 4 weeks"
      },
      {
        "id": 3,
        "text": "Octreotide for 4 weeks"
      },
      {
        "id": 4,
        "text": "Oral prednisolone for 2 weeks"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of <strong>alcoholic liver disease</strong>.&nbsp;<strong>Oral</strong><strong> prednisolone&nbsp;</strong>for&nbsp;<strong>4 weeks</strong> helps in reducing mortality levels.</p>\n<p><strong>Oral prednisolone</strong> is given at a dose of<strong>&nbsp;40 mg</strong> orally daily for <strong>4 weeks</strong> and then slowly tapered off.&nbsp;For patients unable to take oral medications, <strong>methylprednisolone</strong>, <strong>32 mg</strong> per day <strong>IV,</strong> is used.&nbsp;The combination of glucocorticoids with <strong>N-acetylcysteine</strong> infusion might add short-term survival benefit at 1 month. Long-term prognosis in patients (&gt;1 year) largely depends on&nbsp;<strong>alcohol abstinence</strong> and underlying cirrhosis. <strong>Liver transplantation</strong> should be considered in patients <strong>not responding</strong> to glucocorticoids.</p>\n<p><strong>Octreotide</strong>, a somatostatin analogue, is used in the treatment of esophageal <strong>varices</strong> in patients with alcoholic liver disease and is not prescribed to reduce mortality.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old male had yellowish eyes, dark urine, body itching, and clay-colored feces. He had three similar instances over three years, interspersed with asymptomatic periods. USG shows a normal gall bladder with no calculi. Normal intrahepatic, extrahepatic biliary tree and pancreatic ductal system on MRCP. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Rotor syndrome"
      },
      {
        "id": 2,
        "text": "Benign recurrent intrahepatic cholestasis"
      },
      {
        "id": 3,
        "text": "Dubin Johnsons syndrome"
      },
      {
        "id": 4,
        "text": "Progressive familial intrahepatic cholestasis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The individual presenting with clinical manifestations indicative of <strong>obstructive jaundice</strong> resulting from <strong>intrahepatic cholestasis</strong> and intermittent periods of <strong>asymptomatic episodes</strong> <strong>between</strong> cholestasis episodes aligns with a diagnosis of <strong>Benign Recurrent Intrahepatic Cholestasis (BRIC).</strong></p>\n<p>Patients with <strong>Benign Recurrent Intrahepatic Cholestasis</strong> (<strong>BRIC</strong>) have symptoms of intrahepatic cholestasis ranging from weeks to months and <strong>asymptomatic episodes in between</strong>. A diagnosis is usually made once other causes of obstructive jaundice have been ruled out such as common bile duct stones, cystic duct stones, pancreatic strictures, etc. It can be differentiated from <strong>Progressive familial intrahepatic cholestasis</strong>(Option D) due to the presence of <strong>progressive hyperbilirubinemia</strong> which <strong>begins in infancy</strong> and progresses <strong>gradually to liver failure </strong>and is caused due to<strong> mutations in bile salt excretory protein (BSEP).</strong></p>\n<p><strong>Benign Recurrent Intrahepatic Cholestasis </strong>follows an <strong>autosomal recessive</strong> pattern of inheritance. It is distinguished by recurring bouts of cholestatic jaundice that can persist for several weeks or months. It typically manifests<strong> throughout the period of adolescence</strong>. Prodromal symptoms include itching, nausea, vomiting, and weight loss. Patients have no symptoms during the intervals between bouts. Blood tests commonly indicate the presence of conjugated hyperbilirubinemia accompanied by increased levels of alkaline phosphatase. <strong>Cholangiography</strong> reveals <strong>no evidence of biliary blockage.</strong> The <strong>liver biopsy</strong> reveals the presence of <strong>cholestasis during episodes</strong> while returning to a <strong>normal state between episodes</strong>.<br />The BRIC condition is linked to genetic mutations in two bile acid transporters, namely <strong>ATP8B1</strong> (also known as BRIC1) which encodes <strong>FIC1</strong>, and <strong>ABCB11</strong> (also known as <strong>BRIC2</strong>) which encodes the bile salt export pump (<strong>BSEP</strong>). A combination of rifampin, cholestyramine and prednisone has been tried, leading to reduced episodes. The prognosis of this condition is good.</p>\n<p><strong>Dubin-Johnson syndrome, Rotor syndrome</strong>, and <strong>Byler disease</strong> are disorders of bilirubin metabolism which lead to predominantly conjugated hyperbilirubinemia.</p>\n<p><strong>Mixed </strong>or <strong>predominantly conjugated hyperbilirubinemia occurs either due to impaired excretion of conjugated bilirubin into the bile ductules or </strong>backward leakage of the bile.\u00a0</p>\n<p>Familial defects in hepatic excretory function include:</p>\n<ul>\n<li><strong>Dubin-Johnson syndrome</strong></li>\n<li><strong>Rotor syndrome</strong></li>\n<li>Benign recurrent intrahepatic cholestasis (BRIC)</li>\n<li><strong>Progressive familial intrahepatic cholestasis </strong>(FIC)\n<ul>\n<li>Type 1 - is called <strong>Byler disease</strong></li>\n</ul>\n</li>\n</ul>\n<p>Note: <strong>Byler disease</strong> is a cholestatic disease that presents episodically from infancy. It is due to <strong>FIC1 mutation</strong> and it can lead to malnutrition, growth retardation, and end stage liver disease during childhood.</p>\n<p>Other options\u00a0</p>\n<p>Option A: <strong>Rotor syndrome</strong>(RS) is an autosomal recessive disease characterized by non-hemolytic jaundice due to deficiency in <strong>OATP1B1 </strong>and <strong>OATP1B3</strong> transporters in the hepatocytes. This phenomenon results from impaired hepatocellular storage of <strong>conjugated bilirubin</strong> that leaks into plasma, causing hyperbilirubinemia. Patients with Rotor syndrome d<strong>o not have asymptomatic episodes</strong> in between with <strong>elevated ALP</strong>.</p>\n<p>Option C: <strong>Dubin\u2013Johnson syndrome</strong> is an autosomal recessive disorder with predominantly conjugated hyperbilirubinemia, due to a mutation in the MRP- 2 protein. Liver biopsy shows characteristic black-coloured pigment deposition in the centrilobular hepatocytes' lysosomes. Patients with dubin johnsons syndrome <strong>do not </strong>have <strong>asymptomatic</strong> episodes in between<strong> with elevated ALP.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman at 34 weeks of gestation presents with severe pruritus and yellowish discoloration of the sclera. Her total bilirubin level was 3.8 mg/dL and serum transaminase levels were mildly elevated. A biopsy of the liver would most likely show?",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "1"
      },
      {
        "id": 3,
        "text": "2"
      },
      {
        "id": 4,
        "text": "3"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical features are suggestive of<strong> intrahepatic cholestasis of pregnancy\u00a0</strong>which is caused due to defective transport of bilirubin from the <strong>hepatocytes into the biliary canaliculi</strong> as depicted in the <strong>third histopathological slide</strong>. \u00a0Liver biopsy shows <strong>mild</strong> <strong>cholestasis</strong> with <strong>bile</strong> <strong>plugs</strong> in the <strong>hepatocytes</strong> and <strong>canaliculi</strong> of the <strong>centrilobular</strong> <strong>region</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9e21b1a6b9ca488388ca396afe922d2a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f682eb56a5324b9ba95b51de18f10aa0x1280x1368.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7e11e8180ce64faea18feee573021dfbx936x776.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5805ae5461574ed49d7aa7ab0cfe50e3x924x770.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/de4e826cf7a8408e8da8cd690cd89a50x932x781.PNG"
    ]
  },
  {
    "text": "A 60 year old patient comes to the emergency department with complaints of yellowing of his eyes, abdominal pain and vomiting. Physical examination reveals the presence of jugular venous distension and hepatomegaly. He goes on to say 4 days back he had severe chest pain which self-resolved. The pathophysiological process behind the development of jaundice in this patient may also be observed in which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Secondary sclerosing cholangitis"
      },
      {
        "id": 2,
        "text": "Extravasation of blood into tissues"
      },
      {
        "id": 3,
        "text": "Criggler Najjar syndrome"
      },
      {
        "id": 4,
        "text": "Portosystemic shunts"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient has jaundice due to <strong>ischemic hepatitis</strong> <strong>following</strong> an episode of <strong>myocardial infarction</strong> a few days back which leads to low blood pressure. Formation of <strong>portosystemic shunts</strong> also leads to low blood pressure in cases of <strong>chronic liver cirrhosis</strong> leading to <strong>hepatorenal syndrome.</strong>\u00a0\u00a0</p>\n<table style=\"border-collapse: collapse; width: 76.8242%; height: 270.383px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 67.1953px;\">\n<td style=\"width: 25%; height: 67.1953px;\">Increased bilirubin production</td>\n<td style=\"width: 25%; height: 67.1953px;\">Impaired bilirubin conjugation</td>\n<td style=\"width: 25%; height: 67.1953px;\">Impaired hepatic bilirubin uptake<br />\u00a0</td>\n<td style=\"width: 25%; height: 67.1953px;\">Extrahepatic cholestasis</td>\n</tr>\n<tr style=\"height: 67.7969px;\">\n<td style=\"width: 25%; height: 67.7969px;\">\n<p>Hemolysis</p>\n</td>\n<td style=\"width: 25%; height: 67.7969px;\">\n<p>Gilbert syndrome\u00a0</p>\n<p><strong>Crigler-Najjar syndrome</strong>(Option C)</p>\n</td>\n<td style=\"width: 25%; height: 67.7969px;\"><strong>Heart Failure</strong></td>\n<td style=\"width: 25%; height: 67.7969px;\">\n<p>Common bile duct stone\u00a0</p>\n</td>\n</tr>\n<tr style=\"height: 45.7969px;\">\n<td style=\"width: 25%; height: 45.7969px;\">Dyserythropoiesis</td>\n<td style=\"width: 25%; height: 45.7969px;\">Sepsis\u00a0</td>\n<td style=\"width: 25%; height: 45.7969px;\"><strong>Portosystemic shunts</strong></td>\n<td style=\"width: 25%; height: 45.7969px;\">Benign stricture\u00a0</td>\n</tr>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 25%; height: 44.7969px;\"><strong>Extravasation of blood into tissues </strong>(Option B)</td>\n<td style=\"width: 25%; height: 44.7969px;\">Hyperthyroidism</td>\n<td style=\"width: 25%; height: 44.7969px;\">Fasting</td>\n<td style=\"width: 25%; height: 44.7969px;\">Benign polyp\u00a0</td>\n</tr>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 25%; height: 44.7969px;\">\u00a0</td>\n<td style=\"width: 25%; height: 44.7969px;\">\u00a0</td>\n<td style=\"width: 25%; height: 44.7969px;\">Rifampin, Probenicid, Gemfibrozil</td>\n<td style=\"width: 25%; height: 44.7969px;\"><strong>Primary sclerosing cholangitis</strong> (Option D)</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Ischemic hepatitis</strong>, known by different terms such as ischemic hepatopathy, hypoxic hepatitis, shock liver, or acute cardiogenic liver injury, has a prevalence of 2.5% among patients admitted to an intensive care unit. This condition arises from a <strong>sudden decrease</strong> in <strong>cardiac output</strong> caused by acute <strong>myocardial</strong> <strong>infarction</strong>, <strong>arrhythmia</strong>, or septic or hemorrhagic <strong>shock</strong>. Typically, it occurs in patients with <strong>passive congestion </strong>of the liver. \u00a0The presence or observation of clinical hypotension may be lacking or not documented. In some cases, the triggering event is arterial hypoxemia related to respiratory failure, sleep apnea, severe anaemia, heat stroke, carbon monoxide poisoning, cocaine usage, or bacterial endocarditis. The occurrence of many precipitants is frequently observed. Administration of <strong>statin medication before</strong> hospital <strong>admission</strong> has the potential to confer <strong>protection</strong> <strong>against</strong> the occurrence of<strong> ischemic hepatitis</strong>.</p>\n<p>\u00a0Elevations in blood alkaline phosphatase and bilirubin levels are typically of a modest nature; nevertheless, the <strong>presence of jaundice</strong> is indicative of more <strong>unfavourable outcomes</strong>. The <strong>prolongation of prothrombin time</strong> may lead to the development of <strong>encephalopathy</strong> or <strong>hepatopulmonary</strong> <strong>syndrome</strong>. The mortality rate associated with the underlying disease is notably elevated, especially among patients undergoing vasopressor therapy or experiencing septic shock, acute kidney disease, or coagulopathy. However, in patients who successfully recover, the<strong> levels of aminotransferase return to their normal state rapidly</strong>, typically <strong>within a week</strong>, which stands in contrast to the prolonged normalization period observed in cases of viral hepatitis.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not an example of painless jaundice?",
    "choices": [
      {
        "id": 1,
        "text": "Bile duct stricture"
      },
      {
        "id": 2,
        "text": "Ascending cholangitis"
      },
      {
        "id": 3,
        "text": "Bile duct polyp"
      },
      {
        "id": 4,
        "text": "Cholangiocarcinoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given options <strong>ascending cholangitis</strong> is <strong>not</strong> an example of<strong> painless jaundice</strong>.</p>\n<table style=\"border-collapse: collapse; width: 48.0036%; height: 134.39px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 31.9864%; height: 22.3984px;\"><strong>Painless</strong> Jaundice</td>\n<td style=\"width: 22.6758%; height: 22.3984px;\">Jaundice that may or not be associated with pain</td>\n<td style=\"width: 45.3516%; height: 22.3984px;\"><strong>Painful</strong> Jaundice</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"height: 22.3984px; width: 31.9864%;\" rowspan=\"6\">\n<ul>\n<li>Hemolytic disorders</li>\n<li>Gilbert syndrome</li>\n<li><strong>Cholangiocarcinoma</strong></li>\n<li>Bile duct <strong>stricture</strong></li>\n<li>Bile duct <strong>polyp</strong></li>\n</ul>\n</td>\n<td style=\"height: 22.3984px; width: 22.6758%;\" rowspan=\"6\">\n<ul>\n<li>Pancreatic carcinoma</li>\n<li>Common bile duct (CBD) stone\u00a0</li>\n</ul>\n</td>\n<td style=\"height: 22.3984px; width: 45.3516%;\" rowspan=\"6\">\n<ul>\n<li>Hepatitis (Viral, toxin, drug induced, infective)</li>\n<li>Biliary colic</li>\n<li>Acute cholecystitis</li>\n<li><strong>Ascending cholangitis</strong></li>\n<li>Liver metastasis</li>\n<li>Budd Chiari syndrome</li>\n</ul>\n</td>\n</tr>\n<tr style=\"height: 22.3984px;\"></tr>\n<tr style=\"height: 22.3984px;\"></tr>\n<tr style=\"height: 22.3984px;\"></tr>\n<tr style=\"height: 22.3984px;\"></tr>\n<tr></tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 2-week-old baby presented with yellowish discoloration of the skin. Investigations revealed markedly elevated direct bilirubin levels. Which of the following conditions should be suspected in the newborn?",
    "choices": [
      {
        "id": 1,
        "text": "Biliary atresia"
      },
      {
        "id": 2,
        "text": "Physiological jaundice"
      },
      {
        "id": 3,
        "text": "Breast milk jaundice"
      },
      {
        "id": 4,
        "text": "Hemolytic disease of the newborn"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>raised direct bilirubin levels</strong> indicate <strong>conjugated hyperbilirubinemia</strong>. Among the given options, <strong>biliary atresia</strong> causes conjugated hyperbilirubinemia.</p>\n<p><strong>Biliary atresia</strong> is a disorder characterised by&nbsp;<strong>destruction</strong> or <strong>absence </strong>of<strong> bile ducts</strong> in a newborn. It leads to obstruction to the flow of bile thereby causing leaking of conjugated bilirubin into the circulation.</p>\n<p>Option B:<strong> Physiological jaundice</strong> of the newborn occurs due to&nbsp;<strong>immaturity</strong> of the newborn's<strong>&nbsp;liver.</strong>&nbsp; It is not able to conjugate the excess bilirubin produced after birth. It leads to <strong>unconjugated</strong> hyperbilirubinemia.</p>\n<p>Option C: <strong>Breast milk</strong>&nbsp;may contain certain <strong>factors </strong>that<strong> inhibit </strong>the<strong> conjugation</strong> of bilirubin leading to <strong>unconjugated</strong> hyperbilirubinemia.</p>\n<p>Option D: <strong>Hemolytic disease of the newborn</strong> causes&nbsp;excess production of bilirubin due to<strong> hemolysis</strong> leading to&nbsp;<strong>unconjugated</strong> hyperbilirubinemia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old female patient presents with the following finding as shown in the image below. On further investigation, she is found to have reduced levels of the enzyme UDP-glucuronosyltransferase. The discolouration of the sclera is attributed to the affinity of bilirubin towards ______.",
    "choices": [
      {
        "id": 1,
        "text": "Reticular fibres"
      },
      {
        "id": 2,
        "text": "Elastin"
      },
      {
        "id": 3,
        "text": "Fibroblasts"
      },
      {
        "id": 4,
        "text": "Proteoglycan"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>With the given clinical scenario and with reduced levels of enzyme <strong>UDP-glucuronosyltransferase</strong>, the patient is most likely suffering from <strong>Gilbert syndrome.\u00a0</strong>Scleral discolouration in patients with jaundice is due to the increased affinity of bilirubin to <strong>elastin</strong>.\u00a0</p>\n<p>The high elastin concentration in sclerae results in a specific attraction to bilirubin, and the observation of scleral icterus suggests a <strong>minimum serum bilirubin level of 3 mg/dL</strong>. The identification of scleral icterus is much more <strong>challenging</strong> in the <strong>presence of fluorescent lighting</strong> within the examination room. In the event that the examiner has reason to suspect the presence of scleral icterus, an additional area that should be assessed is the <strong>sublingual region.</strong>\u00a0</p>\n<p><strong>Gilbert syndrome</strong> is an <strong>autosomal recessive </strong>condition characterized by decreased activity of the <strong>enzyme UDP-glucuronosyltransferase</strong>, which is responsible for the conjugation of bilirubin. This leads to unconjugated hyperbilirubinemia, which presents as yellowish discolouration of the sclera (icterus/jaundice) as seen in the given image.</p>\n<p>Individuals with Gilbert syndrome are usually <strong>asymptomatic</strong> except for intermittent episodes of jaundice, which usually occurs for the first time during adolescence, due to changes in the concentration of sex hormones. Some patients may have complaints like malaise, fatigue, nausea, anxiety, loss of appetite, and abdominal discomfort. Symptoms are usually precipitated by triggers such as <strong>fasting</strong>, intercurrent <strong>illness</strong>, <strong>menstruation</strong>, and <strong>dehydration</strong>.</p>\n<p>Administration of <strong>phenobarbital</strong> shows<strong> normalisation of the serum bilirubin concentration</strong> and <strong>hepatic bilirubin clearance</strong>.</p>\n<p>Gilbert syndrome usually <strong>doesn't require any treatment</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9b02079b3dc04088b869dff1eaacb87f.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 5-day-old alert neonate is brought by his mother because of concerns about inadequate consumption of breast milk. He passes stools frequently, the previous stool was dark green in color. He wet 2 diapers on day 4 of life. Total bilirubin is 15mg/dl and direct bilirubin is 0.4mg/dl. Which of the following is the most probable cause of this patient's condition?",
    "choices": [
      {
        "id": 1,
        "text": "Biliary atresia"
      },
      {
        "id": 2,
        "text": "Breastfeeding jaundice"
      },
      {
        "id": 3,
        "text": "Dubin Johnson syndrome"
      },
      {
        "id": 4,
        "text": "Breastmilk jaundice"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient with <strong>increased indirect bilirubin during</strong> the <strong>first week</strong> of life and subtle <strong>signs of dehydration</strong> like <strong>reduced urine output</strong> (2 diapers on day 4) is highly suggestive of a diagnosis of <strong>Breastfeeding</strong> <strong>jaundice</strong>.\u00a0</p>\n<p><strong>Breastfeeding jaundice</strong> commonly presents within the <strong>first week </strong>of life due to inadequate feeds due to <strong>improper latch technique</strong> among other risk factors. This reduced consumption ensues into <strong>reduced elimination</strong> via stool and therefore <strong>increased enterohepatic circulation</strong> of <strong>indirect</strong> <strong>bilirubin</strong>. Signs of dehydration such as reduced urine output which is normally equal to the neonatal age in days( ie, 3 diapers on day 3), while this patient just had 2 wet diapers on day 4 thus necessitating attention.\u00a0</p>\n<table style=\"border-collapse: collapse; width: 67.4621%; height: 314.977px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 18.2561%; height: 44.7969px;\">Type of Jaundice</td>\n<td style=\"width: 39.3713%; height: 44.7969px;\">Breast<strong>feeding</strong> jaundice</td>\n<td style=\"width: 42.3726%; height: 44.7969px;\">Breast <strong>milk</strong> jaundice</td>\n</tr>\n<tr style=\"height: 10px;\">\n<td style=\"height: 113.391px; width: 18.2561%;\" rowspan=\"2\">Onset</td>\n<td style=\"width: 39.3713%; height: 113.391px;\" rowspan=\"2\"><strong>Early</strong>-onset<br />1st week after birth (<strong>usually appears after 24 - 72 hours of birth</strong>)</td>\n<td style=\"height: 113.391px; width: 42.3726%;\" rowspan=\"2\"><strong>Late-onset</strong><br /><strong>after the 7th day </strong>with maximal concentrations as high as 10\u201330 mg/dl reached during the 2nd-3rd week.</td>\n</tr>\n<tr style=\"height: 103.391px;\"></tr>\n<tr style=\"height: 67.1953px;\">\n<td style=\"width: 18.2561%; height: 67.1953px;\">Pathophysiology</td>\n<td style=\"width: 39.3713%; height: 67.1953px;\"><strong>decreased milk intake</strong> with dehydration and/or reduced caloric intake.</td>\n<td style=\"width: 42.3726%; height: 67.1953px;\">presence of <strong>glucuronidase</strong> in breast milk\u00a0</td>\n</tr>\n<tr style=\"height: 89.5938px;\">\n<td style=\"width: 18.2561%; height: 89.5938px;\">Management</td>\n<td style=\"width: 39.3713%; height: 89.5938px;\"><strong>Continue breastfeeding </strong>and supplementation with formula feeds if needed</td>\n<td style=\"width: 42.3726%; height: 89.5938px;\"><strong>Continue breastfeeding</strong> and the bilirubin gradually decreases but may <strong>persist for 3-10 weeks</strong> at lower levels; phototherapy may be of benefit in some cases.</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p>Other options:\u00a0</p>\n<p>Option A: <strong>Biliary atresia</strong> causes <strong>conjugated</strong> <strong>hyperbilirubinemia</strong> in infants aged<strong> 2-8 weeks</strong>. Patients with biliary atresia typically exhibit <strong>acholic</strong> <strong>stools</strong>, <strong>dark</strong> <strong>urine</strong>, and an<strong> enlarged liver</strong> and<strong> not dark green stools </strong>as seen in this patient.</p>\n<p>Option C<strong>: Dubin-Johnson syndrome </strong>is also a cause of <strong>conjugated hyperbilirubinemia </strong>with an<strong> autosomal recessive </strong>inheritance pattern<strong>.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the earliest sign of recovery in a patient with obstructive jaundice?",
    "choices": [
      {
        "id": 1,
        "text": "Reduction in direct bilirubin"
      },
      {
        "id": 2,
        "text": "Decrease in alkaline phosphatase"
      },
      {
        "id": 3,
        "text": "Reduction in liver enzymes"
      },
      {
        "id": 4,
        "text": "Reappearance of urobilinogen"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The<strong> earliest sign of recovery </strong>in patients with <strong>obstructive jaundice </strong>is<strong> the reappearance of urobilinogen in the urine.</strong></p>\n<p>Conjugated hyperbilirubinemia refers to the increase in <strong>direct bilirubin</strong> levels. It usually occurs due to impaired excretion of bilirubin\u00a0due to <strong>obstructive biliary</strong> pathology<strong>. </strong>The diagnosis can be made by elevation of serum direct bilirubin levels, hepatic enzymes (<strong>Alkaline phosphatase</strong> specifically raised in cholestasis), and <strong>absent urinary urobilinogen</strong>. Obstruction of biliary ducts may be intrahepatic or extrahepatic and can be localised by imaging techniques. \u00a0</p>\n<p>Bilirubin is the breakdown product of heme metabolism which is formed in the reticuloendothelial cells of the liver. It is insoluble in water and is known as <strong>unconjugated</strong> (indirect) bilirubin. It is transported to the liver after binding to <strong>albumin,\u00a0</strong>where\u00a0it undergoes conjugation with glucuronic acid. The final product is known as <strong>conjugated bilirubin</strong> (direct bilirubin) which drains into the duodenum. On reaching the colon, the unconjugated form is acted upon by <strong>bacterial beta glucuronidases\u00a0</strong>and\u00a0reduced into colorless<strong> urobilinogen</strong>. Almost 90% is excreted through feces as <strong>stercobilinogen</strong>, and the remaining will undergo <strong>enterohepatic cycling</strong>. A small fraction of this escapes hepatic uptake and will be excreted in the urine as\u00a0<strong>urobilinogen.</strong></p>\n<p>Normally, urine bilirubin is absent. However, in obstructive jaundice, bilirubin cannot drain to the intestine to be converted into urobilinogen. Thus, fecal urobilinogen is absent, which gives the characteristic clay-colored stools. The presence of urine bilirubin is an indication of post-hepatic obstruction and presents as <strong>cola/dark-colored urine.</strong>\u00a0Increase bilirubin deposition in the skin, resulting in <strong>yellowish discoloration</strong> and may lead to pruritus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An adult male patient presents with yellow discolouration of the sclera. There was a history of recurrent mild jaundice since childhood. His lab values are mentioned below. A liver biopsy was performed which revealed normal liver architecture with coarse granular black pigmentation. The mutation of which protein is involved in the following condition?",
    "choices": [
      {
        "id": 1,
        "text": "OATP1B1"
      },
      {
        "id": 2,
        "text": "BSEP"
      },
      {
        "id": 3,
        "text": "MRP-3"
      },
      {
        "id": 4,
        "text": "MRP-2"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Yellow discolouration of the sclera with coarse granular black pigmentation of the liver is suggestive of <strong>Dubin\u2013Johnson syndrome</strong>, characterized by a mutation in the<strong> MRP-2 </strong>protein.<strong><br /></strong></p>\n<p>Dubin\u2013Johnson syndrome is an <strong>autosomal recessive</strong> disorder with predominantly<strong> conjugated hyperbilirubinemia</strong>. It is due to a defect in the <strong>active</strong> <strong>transport </strong>of <strong>bilirubin</strong> across the canalicular membrane, due to a mutation in the MRP-2 protein.<strong>\u00a0</strong>It is also known as <strong>black liver jaundice</strong> due to the accumulation of a<strong> dark pigment</strong>,<strong> </strong>derived from epinephrine metabolites, in the lysosomes of <strong>centrilobular\u00a0hepatocytes</strong>. <strong>Bromosulpthalein</strong> test on plasma shows 2 peaks.</p>\n<p>Option A: <strong>OATP1B1</strong> and<strong> OATP1B3</strong> are mutated in<strong> </strong>Rotor syndrome.<strong> </strong>It is due to defective bilirubin excretion and causes conjugated hyperbilirubinemia.</p>\n<p>Option B:<strong> BSEP</strong> protein is mutated in<strong> </strong>progressive familial intrahepatic cholestasis\u00a0(PFIC type-2) and benign recurrent intrahepatic cholestasis (BRIC-2).</p>\n<p>Option C: <strong>MRP-3</strong> is mutated in<strong> </strong>PFIC type-3.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8518b44c87334f41b2aca086ef0d4abex1280x2025.JPEG"
    ]
  },
  {
    "text": "A patient came to you with symptoms of nausea, vomiting, fever and yellowing of his eyes. 6 days back he had symptoms of TB for which HRZE was started. Laboratory results are as follows. Which of the following represents the mechanism by which this rifampin has caused liver injury?",
    "choices": [
      {
        "id": 1,
        "text": "Impaired hepatic bilirubin uptake"
      },
      {
        "id": 2,
        "text": "Impaired bilirubin conjugation"
      },
      {
        "id": 3,
        "text": "Increased bilirubin production"
      },
      {
        "id": 4,
        "text": "Extrahepatic cholestasis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient's symptoms of yellowing of eyes, fever and vomiting coupled with laboratory results showing predominantly increased indirect bilirubin is seen in patients with <strong>Rifampin-induced hepatitis</strong>. Rifampin <strong>impairs the bilirubin uptake</strong> and thus causes <strong>unconjugated hyperbilirubinemia</strong>.\u00a0</p>\n<p><strong>Rifampin-induced jaundice</strong> is most commonly seen<strong> within 1 week </strong>of initiation of treatment and once other causes of hemolysis have been excluded reinitiation of the drug must be done so as to complete the regimen. Elevated bilirubin production may potentially arise as a result of hemolysis induced by antitubercular medication; however, the <strong>absence of abnormal hemoglobin and lactate dehydrogenase levels</strong> <strong>excludes</strong> this as a potential aetiology for unconjugated bilirubinemia in the present case.</p>\n<table style=\"border-collapse: collapse; width: 51.9964%; height: 182.391px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 26.7486%; text-align: center; height: 22.3984px;\">Increased bilirubin production<br />(Option C)</td>\n<td style=\"width: 27.4433%; height: 22.3984px;\">Impaired bilirubin conjugation (Option A)</td>\n<td style=\"width: 22.2077%; height: 22.3984px;\"><strong>Impaired hepatic bilirubin uptake</strong></td>\n<td style=\"width: 23.6017%; height: 22.3984px;\">Extrahepatic cholestasis <br />(Option D)</td>\n</tr>\n<tr style=\"height: 92.7969px;\">\n<td style=\"width: 26.7486%; height: 92.7969px;\">Hemolysis</td>\n<td style=\"width: 27.4433%; height: 92.7969px;\">\n<p>Gilbert syndrome\u00a0</p>\n<p>Crigler-Najjar syndrome\u00a0</p>\n</td>\n<td style=\"width: 22.2077%; height: 92.7969px;\">Heart Failure</td>\n<td style=\"width: 23.6017%; height: 92.7969px;\">Common bile duct stone\u00a0<br /><br /></td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 26.7486%; height: 22.3984px;\">Dyserythropoiesis</td>\n<td style=\"width: 27.4433%; height: 22.3984px;\"><strong>Sepsis</strong>\u00a0</td>\n<td style=\"width: 22.2077%; height: 22.3984px;\"><strong>Sepsis</strong></td>\n<td style=\"width: 23.6017%; height: 22.3984px;\">Benign stricture\u00a0</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 26.7486%; height: 22.3984px;\">Extravasation of blood into tissues\u00a0</td>\n<td style=\"width: 27.4433%; height: 22.3984px;\">Hyperthyroidism</td>\n<td style=\"width: 22.2077%; height: 22.3984px;\"><strong>Rifampin</strong>, Probenicid, Gemfibrozil</td>\n<td style=\"width: 23.6017%; height: 22.3984px;\">Benign polyp\u00a0</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 26.7486%; height: 22.3984px;\">\u00a0</td>\n<td style=\"width: 27.4433%; height: 22.3984px;\">\u00a0</td>\n<td style=\"width: 22.2077%; height: 22.3984px;\">Fasting</td>\n<td style=\"width: 23.6017%; height: 22.3984px;\">Primary sclerosing cholangitis\u00a0</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly gentleman presents with weight loss, the passage of dark-colored urine, and pale putty stools. On examination, you note a yellowish discoloration of the skin. Which of the following is likely to be elevated in the serum?",
    "choices": [
      {
        "id": 1,
        "text": "Stercobilinogen"
      },
      {
        "id": 2,
        "text": "Urobilinogen"
      },
      {
        "id": 3,
        "text": "Unconjugated bilirubin"
      },
      {
        "id": 4,
        "text": "Conjugated bilirubin"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This case scenario is suggestive of <strong>obstructive jaundice&nbsp;</strong>in which&nbsp;<strong>conjugated bilirubin</strong> levels in the serum will be<strong> elevated</strong>.</p>\n<p>Yellowish discolouration of the skin (<strong>jaundice</strong>), weight loss, dark-coloured urine (<strong>bilirubinuria</strong>), and <strong>pale stools</strong>&nbsp;are all indicative of obstructive jaundice.</p>\n<p>Conjugated hyperbilirubinemia refers to the increase in serum conjugated or <strong>direct bilirubin</strong> levels. It usually occurs due to impaired excretion of bilirubin&nbsp;due to <strong>obstructive biliary</strong> pathology or <strong>hereditary syndromes. </strong>The diagnosis can be made by elevation of serum direct bilirubin levels, hepatic enzymes (<strong>Alkaline phosphatase</strong> specifically raised in cholestasis) and <strong>absent urinary urobilinogen</strong>. Obstruction of biliary ducts may be intrahepatic or extrahepatic and can be localised by imaging techniques. &nbsp;</p>\n<p>Bilirubin is the breakdown product of heme metabolism which is formed in the reticuloendothelial cells of the liver. It is insoluble in water and is known as <strong>unconjugated</strong> (indirect) bilirubin. It is transported to the liver after binding to <strong>albumin,&nbsp;</strong>where&nbsp;it undergoes conjugation with glucuronic acid. The final product is known as <strong>conjugated bilirubin</strong> (direct bilirubin) which drains into the duodenum. On reaching the colon, the unconjugated form is acted upon by <strong>bacterial beta glucuronidases&nbsp;</strong>and&nbsp;reduced into colorless<strong> urobilinogen</strong>. Almost 90% is excreted through faeces as&nbsp;<strong>stercobilinogen</strong>, and the remaining will undergo <strong>enterohepatic cycling</strong>. A small fraction of this escapes hepatic uptake and will be excreted in the urine as&nbsp;<strong>urobilinogen.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3.3 Kg term neonate is admitted on day 3 of life with yellowish discoloration of the skin and is going to undergo phototherapy. What is the most effective wavelength of light used for treatment?",
    "choices": [
      {
        "id": 1,
        "text": "370 to 390 nm"
      },
      {
        "id": 2,
        "text": "390 to 420 nm"
      },
      {
        "id": 3,
        "text": "460 to 490 nm"
      },
      {
        "id": 4,
        "text": "410 to 450 nm"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most effective range of <strong>wavelength of light</strong>\u00a0for phototherapy in <strong>neonatal indirect hyperbilirubinemia</strong> is <strong>460\u2013490 nm (blue-green light).</strong></p>\n<p>Clinical jaundice and indirect hyperbilirubinemia are reduced by exposure to the high intensity of light in the visible spectrum by 3 mechanisms:</p>\n<ul>\n<li><strong>Irreversible</strong>\u00a0<strong>structural isomerization:</strong>\u00a0Most\u00a0<strong>important</strong>\u00a0mechanism; acts by forming\u00a0<strong>lumirubin</strong>\u00a0from native bilirubin. It is then excreted by the\u00a0<strong>kidneys</strong>\u00a0in the unconjugated state.</li>\n<li><strong>Reversible photo-isomerization reaction:</strong>\u00a0converts toxic unconjugated bilirubin into an unconjugated configurational isomer. It is then excreted in\u00a0<strong>bile</strong>\u00a0without conjugation.</li>\n<li><strong>Photo-oxidation</strong>: minor method</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d08227b6a30a45cbac359d780696b8a7x1280x612.JPEG"
    ]
  },
  {
    "text": "A 23-year-old food blogger presents with complaints of icterus and abdominal fullness. She returned yesterday from a vacation in Egypt where she tried fava beans. Her peripheral smear is given below. Which of the following drugs is not contraindicated in her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Ceftriaxone"
      },
      {
        "id": 2,
        "text": "Cotrimoxazole"
      },
      {
        "id": 3,
        "text": "Ciprofloxacin"
      },
      {
        "id": 4,
        "text": "Rasburicase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario and blood film showing\u00a0<strong>bite cells</strong> (arrows) is suggestive of glucose\u00a06-phosphate dehydrogenase<strong> (G6PD) deficiency</strong>. Ceftriaxone is not contraindicated in G6PD deficiency.</p>\n<p>G6PD is an enzyme in the\u00a0hexose monophosphate pathway <strong>(HMP)</strong>\u00a0that maintains the cellular levels of NADPH.\u00a0<strong>NADPH</strong>\u00a0then provides reducing equivalents needed for the conversion of oxidized glutathione to\u00a0<strong>reduced glutathione</strong>. This reduced glutathione acts as a cofactor in reactions that neutralize compounds such as H<sub>2</sub>O<sub>2</sub>, thereby protecting against oxidant injury.\u00a0<strong>\u00a0</strong></p>\n<p>Thus, G6PD deficiency causes acute hemolysis in conditions of high oxidative stress that are triggered by:</p>\n<ul>\n<li>infections</li>\n<li><strong>fava beans</strong>\u00a0(a staple in Egyptian cuisine)</li>\n<li>certain drugs</li>\n</ul>\n<p>Oxidative damage to RBCs leads to crosslinking of reactive sulfhydryl groups on globin chains, which then becomes denatured and form membrane-bound precipitates called <strong>Heinz</strong>\u00a0<strong>bodies.\u00a0</strong>When these cells on pass through spleen, heinz bodies are plucked by macrophages, giving <strong>bite cells.</strong></p>\n<p>Clinically, most patients are asymptomatic. When exposed to the triggers, patient develops:</p>\n<ul>\n<li>Episodic hemolysis, both <strong>intravascular</strong> and <strong>extravascular</strong></li>\n<li>Hemolytic anaemia</li>\n<li>Hemoglobinemia</li>\n<li><strong>Hemoglobinuria</strong></li>\n</ul>\n<p>G6PD deficiency is an X-linked recessive <strong>(XLR)</strong> disorder which is the <strong>most common</strong> cause of <strong>congenital hemolytic anemia</strong> <strong>due to enzyme deficiency.</strong></p>\n<p>\u00a0The image below shows the blood picture of a G6PD deficiency patient:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/16d9f8fb0df74b7e863f4dff79846c26.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4dc646e0a7344b62b2f3ad958aed8038x1279x914.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1fed3123012943dd8852893c0cf05c83x1279x914.JPEG"
    ]
  },
  {
    "text": "A 20-year-old boy presented with yellowish discolouration of the skin and sclerae for the last 3 days. He is otherwise asymptomatic. He had a viral fever one week ago which has now resolved. His investigations are shown below. The dysfunctional enzyme resides in which of the following  sites?",
    "choices": [
      {
        "id": 1,
        "text": "Rough endoplasmic reticulum"
      },
      {
        "id": 2,
        "text": "Golgi apparatus"
      },
      {
        "id": 3,
        "text": "Smooth endoplasmic reticulum"
      },
      {
        "id": 4,
        "text": "Lysosomes"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient has a <strong>short history of jaundice</strong>, which <strong>appeared</strong>\u00a0only <strong>during a</strong> <strong>period of stress</strong> (viral fever). The lab reports show <strong>increased unconjugated bilirubin</strong> (normal 0.2-0.8 mg/dL) and normal AST and ALT levels. All this points toward a diagnosis of <strong>Gilbert syndrome</strong>. The dysfunctional enzyme ie <strong>UDP-glucuronyltransferase</strong> is present within the <strong>smooth endoplasmic reticulum</strong>.</p>\n<p><strong>Gilbert syndrome</strong> is a <strong>benign</strong>, familial disorder characterized by<strong>\u00a0mild intermittent jaundice\u00a0</strong>usually seen <strong>during stress, fatigue, or alcohol use</strong>. The condition is recognized to arise from a mutation in the promoter region of the <em>UGT1A1</em>\u00a0gene, which results in <strong>mildly decreased UDP-glucuronyltransferase production</strong>. This causes a reduction in the liver's ability to conjugate bilirubin, thus causing <strong>unconjugated hyperbilirubinemia</strong>. The <strong>total bilirubin</strong> value is <strong>usually &lt; 3 mg/dL</strong>.\u00a0</p>\n<p>Other options:</p>\n<p>Option A: <strong>Rough endoplasmic reticulum </strong>helps in <strong>protein synthesis </strong>which encompasses various processes, such as post-translational modifications, folding, and sorting. The process of translation occurs in the rough endoplasmic reticulum (RER), where ribosomes that are connected to the membrane are responsible for synthesizing polypeptides. This synthesis involves the translation of mature mRNA transcripts into amino acids, which are subsequently joined to form polypeptide chains.</p>\n<p>Option B:<strong> Golgi bodies</strong> (or Golgi apparatus) appear as stacks of flattened membranous cisternae surrounded by clusters of vesicles. It is responsible for the additional <strong>processing</strong> and <strong>sorting</strong> of proteins obtained from the endoplasmic reticulum (ER) in order to facilitate their transportation to their respective destinations, which include lysosomes, the plasma membrane, or secretion. Furthermore, it should be emphasized that the synthesis of <strong>glycolipids</strong> and <strong>sphingomyelin</strong> takes place within the Golgi apparatus.</p>\n<p>Option D: <strong>Lysosomes</strong> are organelles contained by a membrane, housing a diverse range of enzymes with the ability to degrade many biological polymers, including proteins, nucleic acids, carbohydrates, and lipids. Lysosomes serve as the cellular digestive system, responsible for the degradation of extracellular material and the digestion of obsolete intracellular components with the help of <strong>hydrolases. </strong>Mutations in the genes encoding these enzymes lead to<strong> lysosomal storage diseases.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old model has presented to you with complaints of abdominal pain, vomiting, and yellowing palms and soles. She also says she wants to compete in Miss Universe on a spinach-carrot diet. Which finding helps distinguish this patient from jaundice?",
    "choices": [
      {
        "id": 1,
        "text": "Pruritus"
      },
      {
        "id": 2,
        "text": "Abdominal tenderness"
      },
      {
        "id": 3,
        "text": "Yellowing of skin creases"
      },
      {
        "id": 4,
        "text": "Absence of scleral yellowing"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient who has been consuming an excess amount of carotene is suffering from <strong>Carotenemia</strong>. The <strong>absence</strong> of <strong>yellowing</strong> of the <strong>sclera</strong> helps distinguish this condition <strong>from a patient with jaundice</strong>. Other symptoms are <strong>common</strong> among those <strong>patients with jaundice as well as carotenemia</strong>.</p>\n<p><strong>Hypercarotenemia</strong> is a condition that is linked to elevated consumption of foods that are rich in carotene, such as pumpkin, carrots, spinach, lettuce, tomatoes, and mangoes. \u00a0Additionally, hypercarotenemia has been observed to exhibit <strong>associations</strong> with several medical disorders, including <strong>hypopituitarism</strong>, <strong>hypothyroidism</strong>, <strong>inborn errors of metabolism</strong>, as well as liver and kidney illness. The incidence of hypercarotenemia is generally unaffected by demographic factors such as age and gender, however it is more commonly observed in the pediatric population, particularly among newborns and young children.The presence of <strong>hypercalcemia</strong> in newborns and children is typically accompanied by the observation of a yellowish colouring on the palms and soles, which arises from the accumulation of carotenoids within adipose tissue. It is imperative to <strong>differentiate</strong> <strong>hypercarotenemia</strong> from <strong>jaundice</strong> due to the <strong>absence of scleral involvement </strong>in the <strong>former condition</strong>.</p>\n<p>Typically, a thorough history and comprehensive physical examination are deemed adequate in the process of narrowing down distinctions, rendering laboratory tests largely unnecessary for diagnosing carotenemia associated with dietary factors.<strong> higher levels of serum carotene</strong> are typically observed through laboratory testing, with values ranging from 250 to 500 micrograms per deciliter. Concurrently, <strong>liver enzymes tend to exhibit normal or slightly higher levels</strong>. The quantification of carotenoid antioxidants in human skin in vivo can be achieved by the utilization of <strong>resonant Raman spectroscopy</strong> and <strong>reflectance spectroscopy</strong>, both of which are<strong> non-invasive optical techniques</strong>. These methods enable the measurement of skin carotene levels.</p>\n<p>The fundamental approach to <strong>treatment</strong> involves the <strong>reduction of carotene intake</strong> in the diet. The reduction of carotene consumption is expected to result in the eventual resolution of skin pigmentation and other symptoms.</p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Jaundice Mini Test - -Tmt';
        const quizFilename = 'jaundice-mini-test-tmt-16ede991.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>