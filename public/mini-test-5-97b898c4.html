<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 5 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2022-23
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "You are examining the nails of a patient with psoriasis. Which among the following nail findings is pathognomonic of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "1"
      },
      {
        "id": 4,
        "text": "3"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Image 3 shows the <strong>oil drop sign/ salmon patches, </strong>which is a specific\u00a0<strong>pathognomonic</strong> sign seen in psoriasis.</p>\n<div class=\"page\" title=\"Page 1130\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Psoriasis is a chronic inflammatory condition of the skin, characterized by red, scaly, sharply demarcated, indurated plaques usually seen on the extensor surfaces and scalp. It can affect any part of the nail unit, including the nail bed, nail matrix, and hyponychium. Nail changes in psoriasis are seen commonly. Various nail dystrophies that are seen in psoriasis-</p>\n</div>\n</div>\n</div>\n</div>\n<ul>\n<li>Nail matrix disease presents as\u00a0<strong>pits (most common)</strong>, ridges, and grooves of the nail plate.\u00a0</li>\n<li>Nail bed disease presents as\u00a0<strong>subungual oil drops</strong>, subungual hyperkeratosis, splinter haemorrhages, and <strong>distal onycholysis.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7e4bb93864e444f7bff86d2fe3fabbe7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f6128714b35341faa105a008a959f27cx1280x2068.JPEG"
    ]
  },
  {
    "text": "A 6-year-old child presented with fever, pain, and refusal to use his right lower limb. He has a history of a recent ear infection. His WBC count was 22,000/ cumm with neutrophil predominance. ESR and CRP were elevated. The MRI demonstrated inflammatory changes in the bone marrow of the proximal tibia. What is the next best step in management?",
    "choices": [
      {
        "id": 1,
        "text": "Vacuum assisted closure"
      },
      {
        "id": 2,
        "text": "Surgical drainage"
      },
      {
        "id": 3,
        "text": "Empirical antibiotics"
      },
      {
        "id": 4,
        "text": "Biopsy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario is suggestive of <strong>acute hematogenous osteomyelitis </strong>and the next best step of management would be to <strong>start empirical antibiotic therapy</strong>.</p>\n<p>Acute osteomyelitis is an infection of the bone that usually occurs in <strong>children</strong>. The most common organism responsible is<em>&nbsp;Staphylococcus aureus.&nbsp;</em></p>\n<p>Children with acute osteomyelitis present with <strong>pain</strong>, malaise,&nbsp;<strong>fever,</strong>&nbsp;and<strong>&nbsp;</strong><strong>refusal to use the affected limb</strong>. There may often be a <strong>history of recent</strong> <strong>infection</strong>. On examination, the child is ill, with tachycardia, with fever. There is tenderness near the affected joint, with redness, swelling, warmth, and edema.</p>\n<p>Clinical diagnosis is confirmed by aspirating pus or fluid from the abscess, soft tissues, or the adjacent joint.&nbsp;Investigations reveal <strong>elevated WBC count</strong>, <strong>ESR</strong>, and <strong>CRP</strong>. <strong>Blood cultures</strong> should be done if a fever &gt;38 &deg;C is detected.</p>\n<p>MRI is helpful when the diagnosis is doubtful or when there is a suspected infection of the axial skeleton. It is sensitive even in the <strong>early phases</strong> of bone infections and detects <strong>bone marrow inflammation.</strong></p>\n<div class=\"page\" title=\"Page 62\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>If osteomyelitis is suspected clinically, blood and fluid samples should be taken for laboratory investigations and treatment should be started <strong>immediately</strong>. There is no need to wait for confirmation of the diagnosis to start treatment. The main aspects of treatment include:</p>\n<ul>\n<li><strong>Antibiotics- initially empirical</strong>, then specific</li>\n<li>Surgical drainage</li>\n<li>Limb splinting and rest</li>\n<li>Management of pain and dehydration</li>\n</ul>\n<p>Children between 6 months and 6 years should be started on iv <strong>flucloxacillin </strong>and<strong> cefotaxime</strong> or cefuroxime. If antibiotics are started within the first 48 hours, drainage is not always needed.&nbsp;<strong>Surgical drainage</strong> is indicated when:</p>\n</div>\n</div>\n</div>\n</div>\n<ul>\n<li>The patient does not respond to antibiotics</li>\n<li>Signs such as swelling, edema, and fluctuation are present</li>\n<li>Pus is aspirated</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 48-year-old man presented with complaints of diarrhea for the past 3 days. On examination, he is tachypneic. His laboratory investigations are given below. What is the acid-base disorder in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Metabolic acidosis with normal anion gap"
      },
      {
        "id": 2,
        "text": "Metabolic acidosis with increased anion gap"
      },
      {
        "id": 3,
        "text": "Respiratory acidosis"
      },
      {
        "id": 4,
        "text": "Lactic acidosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The acid-base disorder in this patient is&nbsp;<strong>metabolic acidosis</strong> with a <strong>normal anion gap.</strong></p>\n<p>Diagnosis can be arrived at by the following steps:</p>\n<p><strong>Step 1</strong>: A pH of 7.20 indicates <strong>acidosis</strong>. The normal pH is<strong> 7.35-7.45</strong>.&nbsp;</p>\n<p><strong>Step 2</strong>: Bicarbonate level of 7 mEq/L (normal = 22-28) together with low pH indicates that acidosis is due to loss of bicarbonate (i.e. base). Hence this is <strong>metabolic acidosis</strong>.</p>\n<p><strong>Step 3</strong>: PCO<sub>2</sub> levels of 20 mmHg indicate respiratory alkalosis. The decrease in PCO<sub>2</sub> with a decrease in pH indicates that it is a compensatory mechanism. Hence the patient has metabolic acidosis with <strong>respiratory compensation.</strong></p>\n<p>Assessing the<strong> anion gap</strong>:</p>\n<p>AG=( Na<sup>+</sup>)- {(Cl<sup>-</sup>)+(HCO<sub>3</sub>-)}</p>\n<p>=135-(120+7)</p>\n<p>=<strong>8 mEq/L</strong></p>\n<p>The normal anion gap is <strong>6-12 mEq/L</strong>. Hence the <strong>anion gap</strong> is within the <strong>normal range</strong>.</p>\n<p>Diarrhea causes metabolic acidosis due to intestinal loss of bicarbonate-rich fluid.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Metabolic acidosis</strong> with an <strong>increased anion gap</strong> is seen if the <strong>anion gap</strong> is <strong>&gt;12 mEq/L</strong>. It occurs in conditions such as methanol poisoning, uremia, diabetic ketoacidosis, paracetamol poisoning, lactic acidosis, salicylate poisoning, etc.&nbsp;</p>\n<p>Option C:<strong> Respiratory acidosis</strong> occurs in conditions in which <strong>decreased ventilation</strong> (hypoventilation) increases the concentration of carbon dioxide in the blood and decreases the blood's pH.&nbsp;</p>\n<p>Option D: <strong>Lactic acidosis</strong> causes a <strong>high anion gap metabolic acidosis</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young woman reported palpitations, dizziness, and sweating while getting ready for an office seminar. She recalls having experienced similar episodes in the past. She also reports having feelings of impending doom during these episodes. There is no history of medical illness or substance abuse. Which of the following is not useful in the treatment of her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Paroxetine"
      },
      {
        "id": 2,
        "text": "Flumazenil"
      },
      {
        "id": 3,
        "text": "Alprazolam"
      },
      {
        "id": 4,
        "text": "Cognitive behaviour therapy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario is suggestive of a <strong>panic disorder</strong>. <strong>Flumazenil</strong> is not useful in the treatment of this condition and may even act as a panic-inducing substance (<strong>panicogen</strong>).</p>\n<div class=\"page\" title=\"Page 410\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Panic disorder refers to an <strong>acute intense attack</strong> of <strong>anxiety</strong> accompanied by feelings of <strong>impending doom. </strong>Such attacks may not only occur in response to a fearful situation, or phobic objects, or in response to obsession or separation as in other anxiety disorders.</p>\n<p>There is a dysfunction in major neurotransmitter systems like norepinephrine, <strong>serotonin,</strong> and GABA. Panic-inducing substances or&nbsp;<strong>panicogens&nbsp;</strong>may induce such attacks and include substances like&nbsp;5-35% carbon dioxide, sodium lactate, bicarbonate, yohimbine (&alpha; blocker), <strong>flumazenil</strong> (GABA antagonist), cholecystokinin and caffeine.</p>\n</div>\n</div>\n</div>\n<p>This disorder is characterised by the presence of<strong>&nbsp;</strong>an<strong>&nbsp;</strong>abrupt surge of&nbsp;<strong>intense fear</strong>&nbsp;or <strong>intense discomfort</strong> that reaches a peak within minutes. During the episode, the person may experience symptoms like&nbsp;<strong>palpitations, sweating,</strong> trembling or shaking, shortness of breath, nausea,<strong> dizziness,</strong> chest pain or discomfort or fear of dying. The patient also might feel like losing control, having a heart attack, or<strong> going crazy.&nbsp;</strong></p>\n<p>It is <strong>not attributable</strong> to any <strong>drug abuse</strong>, medication, <strong>medical condition</strong> or mental disorder.</p>\n<p>Treatment of this condition can be done by <strong>cognitive behavioural therapy</strong> and drugs like benzodiazepines (<strong>a</strong><strong>lprazolam</strong>, lorazepam), selective serotonin reuptake inhibitors (<strong>paroxetine</strong>), tricyclic antidepressants and monoamine oxidase inhibitors.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A biochemistry resident plots a graph while studying the effect of an inhibitor on an enzymatic reaction. Which of the following statements is false, with respect to the following graph that he has plotted?",
    "choices": [
      {
        "id": 1,
        "text": "Reaction is with a non-competitive inhibitor"
      },
      {
        "id": 2,
        "text": "Inhibitor binds to the enzyme in location other than the active site"
      },
      {
        "id": 3,
        "text": "The degree of inhibition is based solely upon the concentration of inhibitor"
      },
      {
        "id": 4,
        "text": "Can be overcome by increasing the substrate concentration"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given&nbsp;graph represents a reaction with a <strong>non-competitive inhibitor&nbsp;</strong>and it <strong>cannot </strong>be<strong> overcome </strong>by<strong> increasing </strong>the<strong> concentration </strong>of the<strong> substrate.</strong></p>\n<p>The above graph is called the '<strong>Lineweaver-Burk plot' </strong>or<strong> 'double reciprocal' plot.&nbsp;</strong>1/v<sub>0</sub> is plotted versus 1/[S] and a straight line is obtained. This plot can be used to calculate K<sub>m</sub> and V<sub>max</sub> as well as to determine the mechanism of action of enzyme inhibitors.</p>\n<p>In non-competitive inhibition, <strong>V<sub>max</sub> decreases</strong> (or 1/V<sub>max</sub> increases) but <strong>K<sub>m</sub> </strong>is<strong> unchanged.&nbsp;</strong>Hence&nbsp;the graphs of inhibited and uninhibited reactions have the <strong>same x-intercepts</strong> (converge at -1/K<sub>m</sub>) but <strong>different y-intercepts.</strong></p>\n<p>In contrast to competitive inhibitors, noncompetitive inhibitors <strong>bind </strong>to<strong> enzymes</strong> in locations <strong>away from</strong> the<strong> active site</strong>.&nbsp;For this reason,&nbsp;the <strong>degree</strong> of <strong>inhibition</strong> is based solely upon the<strong> concentration of the inhibitor</strong>, and <strong>increasing </strong>the<strong> substrate concentrations</strong> does<strong> not</strong> compete with or <strong>change </strong>the<strong> inhibition</strong>. Therefore, unlike the increase in Km seen with competitive inhibition, in noncompetitive inhibition, Vmax decreases while Km usually remains the same. While <strong>competitive inhibitors</strong> can be <strong>overcome</strong> at a sufficiently<strong> high substrate concentration</strong>, <strong>non-competitive inhibition</strong> is <strong>irreversible</strong> and&nbsp;<strong>cannot </strong>be<strong> overcome</strong> by increasing the concentration of the substrate.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/69cd62d9e8bf43ef9200cf2d3bf9aec7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/68c62c7e31bc4e378bfde9d6effe5ecdx1280x1287.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/77321cdf68934ee38405cd6080bcbdd3x1280x2317.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/61e22ac671cd4d56bc7474bb882799f1x1280x2235.JPEG"
    ]
  },
  {
    "text": "A 56-year-old woman coming from a hilly area presents a hard swelling in the neck which moves up with deglutition. The biopsy on the frozen section is given below. Which of the following mutations is commonly associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "RAS"
      },
      {
        "id": 2,
        "text": "GNAS"
      },
      {
        "id": 3,
        "text": "RET"
      },
      {
        "id": 4,
        "text": "BRAF"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario of a patient from a&nbsp;<strong>hilly&nbsp;</strong>(iodine deficient) area and the biopsy specimen showing <strong>capsular invasion</strong> by tumor follicles confirms the diagnosis of <strong>follicular carcinoma</strong>. It is associated with <strong>RAS</strong> mutation.</p>\n<p>Follicular carcinomas are associated with acquired mutations that activate <strong>RAS</strong> or the PI&shy;3K/AKT arm of the receptor tyrosine kinase signaling pathway (<strong>PIK3CA gene</strong>).</p>\n<p><strong>PAX8-PPARG fusion gene</strong> has been described in one-third to one-half of follicular carcinomas.</p>\n<p><strong>Note</strong>: TSHR and GNAS mutations are rare in follicular carcinomas; thus, toxic adenomas and toxic multinodular goiter do not seem to be forerunners of malignancy.</p>\n<p>RET and GNAS mutations are associated with medullary carcinoma of the thyroid. Below is its histopathology image showing the presence of <strong>amyloid-rich stroma</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d8e402381e9044a494e96e2f9f060bd3.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/066c943c33284e7f89ab44b936525741x720x480.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/41c8815611cf4776b85b49316e58cc08x720x542.JPEG"
    ]
  },
  {
    "text": "An intern commits a negligent act in the hospital. You as his senior doctor will be held responsible for the negligent act as the intern is working under you. This is explained by _____.",
    "choices": [
      {
        "id": 1,
        "text": "Borrowed servant doctrine"
      },
      {
        "id": 2,
        "text": "Res ipsa loquitur"
      },
      {
        "id": 3,
        "text": "Contributory negligence"
      },
      {
        "id": 4,
        "text": "Vicarious liability"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The senior doctor is responsible for the negligent act of a junior doctor, resident, intern, or assistant working under him by <strong>vicarious liability.</strong></p>\n<p>Vicarious liability is by which the employer is responsible for his employees&rsquo; negligence if such an act occurs in the course of the employment and within its scope. It is by the principle of '<strong>respondeat superior'</strong> (let the superior answer).</p>\n<p>When two doctors practice as partners, they are both responsible for each other's negligent acts. When 2 or more doctors independently attend a patient, each may be held liable for the negligence of others that he observes or in the ordinary course should have observed and allows it to continue without objection.</p>\n<p>When an employee is being borrowed, the lending employer temporarily loses his control over this worker and the borrowing employer temporarily assumes control. This is known as <strong>borrowed servant doctrine</strong>.</p>\n<p><strong>Contributory negligence</strong> is any unreasonable conduct or absence of ordinary care from the patient's part or from the attendant. This act, along with the negligent act of the doctor has contributed to the injury. If there was no contributory negligence, the injury would not have occurred. The doctor's negligence is not the direct cause of the injury. Eg. refusal to take required treatment, getting discharged against the doctor's advice, etc.</p>\n<p><strong>Res ipsa loquitur</strong>&nbsp;in Latin means \"the thing speaks for itself\". If an untoward result happened that is thought to be due to deviation from the normal standards of care, or negligence, then the doctor should admit the problem. The doctor should take the responsibility to explain the issue to the patient and their family, and solve the problem by either initiating treatment or transferring care. There should be no charge for additional care or for further procedures.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 38-year-old female patient underwent breast conservation surgery due to a 4x4 cm lump in her right breast. The histopathology report showed high nuclear grade DCIS with necrosis and 5 mm margin clearance. Immunohistochemistry showed ER-negativity. What is the next best step in management?",
    "choices": [
      {
        "id": 1,
        "text": "Total mastectomy"
      },
      {
        "id": 2,
        "text": "Adjuvant chemotherapy"
      },
      {
        "id": 3,
        "text": "Adjuvant radiotherapy"
      },
      {
        "id": 4,
        "text": "Adjuvant tamoxifen therapy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The next best step in the management would be <strong>total mastectomy&nbsp;</strong>according to the <strong>Van Nuys prognostic index </strong>(VNPI).</p>\n<p>Van Nuys prognostic score for this patient is:</p>\n<ul>\n<li>The size of the tumor is given as 4x4 cm (score 2)</li>\n<li>5 mm margin clearance (score 2)</li>\n<li>High nuclear grade with necrosis (score 3)&nbsp;</li>\n<li>The age of the patient is 38 years (score 3)</li>\n</ul>\n<p>The total score is <strong>10</strong> and hence<strong> total mastectomy</strong> is indicated after breast conservation surgery.</p>\n<p><strong>Ductal carcinoma in situ (DCIS)&nbsp;</strong>is <strong>more common</strong> than lobular carcinoma in-situ. Histologically, DCIS is due to the proliferation of epithelium that lines the minor ducts resulting in papillary growth within the duct lumina. There are 4 morphological types of DCIS namely <strong>papillary, cribriform, solid,&nbsp;</strong>and<strong> comedo.&nbsp;</strong></p>\n<p><strong>Van Nuys system</strong> classifies ductal carcinoma in situ (DCIS) based on the following parameters:</p>\n<ul>\n<li>Patient's age</li>\n<li>Tumor size</li>\n<li>Margin width</li>\n<li>Nuclear grade&nbsp;</li>\n<li>Presence of <strong>microcalcification</strong></li>\n</ul>\n<p>In 2002, the Van Nuys Prognostic index was modified as the&nbsp;<strong>University of Southern California/VNPI (USC/VNPI).</strong></p>\n<p><strong>Scoring system for&nbsp;USC/VNPI:</strong></p>\n<table style=\"height: 246px; width: 383.104px;\">\n<tbody>\n<tr>\n<td style=\"width: 105px;\"><strong>Parameters</strong></td>\n<td style=\"width: 80px;\"><strong>Score 1</strong></td>\n<td style=\"width: 82px;\"><strong>Score 2</strong></td>\n<td style=\"width: 78.1042px;\"><strong>Score 3</strong></td>\n</tr>\n<tr>\n<td style=\"width: 105px;\"><strong>Size(mm)</strong></td>\n<td style=\"width: 80px;\">&le;15</td>\n<td style=\"width: 82px;\">16-40</td>\n<td style=\"width: 78.1042px;\">&ge;41</td>\n</tr>\n<tr>\n<td style=\"width: 105px;\"><strong>Margin(mm)</strong></td>\n<td style=\"width: 80px;\">&ge;10</td>\n<td style=\"width: 82px;\">1 - 9</td>\n<td style=\"width: 78.1042px;\">&lt;1</td>\n</tr>\n<tr>\n<td style=\"width: 105px;\"><strong>Class</strong></td>\n<td style=\"width: 80px;\">low or intermediate nuclear grade without necrosis</td>\n<td style=\"width: 82px;\">low or intermediate nuclear grade with necrosis</td>\n<td style=\"width: 78.1042px;\">\n<div id=\"__sec2\" class=\"sec\">\n<p id=\"__p17\" class=\"p p-last\">high nuclear grade with or without necrosis.</p>\n</div>\n</td>\n</tr>\n<tr>\n<td style=\"width: 105px;\"><strong>Age(years</strong></td>\n<td style=\"width: 80px;\">&gt;60</td>\n<td style=\"width: 82px;\">40-60</td>\n<td style=\"width: 78.1042px;\">&lt;40</td>\n</tr>\n</tbody>\n</table>\n<p>The current recommendations for the management of DCIS according to this index are:</p>\n<ul>\n<li><strong>Excision alone</strong> for scores <strong>4, 5, and 6</strong></li>\n<li><strong>Excision plus radiotherapy</strong> for scores <strong>7, 8, and 9</strong></li>\n<li><strong>Mastectomy</strong> for scores <strong>10, 11, and 12</strong></li>\n</ul>\n<p>Note: The type of&nbsp;<strong>microcalcification</strong>&nbsp;seen on imaging determines the&nbsp;<strong>nuclear grade</strong>&nbsp;of DCIS.<strong>&nbsp;</strong>While<strong>&nbsp;</strong>the<strong>&nbsp;linear</strong>&nbsp;<strong>branching</strong>&nbsp;type of microcalcification is associated with&nbsp;<strong>high&nbsp;</strong>nuclear grade, the&nbsp;<strong>fine granular</strong>&nbsp;type is associated with&nbsp;<strong>low&nbsp;</strong>nuclear grade.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Adjuvant chemotherapy</strong> is <strong>not</strong> indicated in the treatment of DCIS</p>\n<p>Option C: <strong>Adjuvant radiotherapy</strong> is indicated in DCIS patients with Van Nuys prognostic scores <strong>7, 8, and 9.</strong></p>\n<p>Option D: <strong>Adjuvant tamoxifen therapy</strong> is indicated in DCIS patients with <strong>estrogen receptor-positive.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a branch of the marked vessel?",
    "choices": [
      {
        "id": 1,
        "text": "Anterior Inferior cerebellar artery"
      },
      {
        "id": 2,
        "text": "Posterior cerebral artery"
      },
      {
        "id": 3,
        "text": "Posterior inferior cerebellar artery"
      },
      {
        "id": 4,
        "text": "Superior cerebellar artery"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The marked vessel is the <strong>basilar artery.</strong>&nbsp;The <strong>posterior inferior cerebellar artery</strong> is not a branch of the basilar artery. It is a <strong>branch </strong>of the<strong> vertebral artery.</strong></p>\n<p><strong>Branches </strong>of the <strong>basilar artery </strong>are:</p>\n<ul>\n<li>Numerous pontine branches</li>\n<li>Labyrinthine artery</li>\n<li>Anterior inferior cerebellar artery</li>\n<li>Superior cerebellar artery</li>\n<li>Posterior cerebral artery</li>\n</ul>\n<p>Note: <strong>Labyrinthine artery </strong>is usually a branch of the <strong>anterior inferior cerebellar artery,</strong> but <strong>variations </strong>in its origin include <strong>basilar artery, superior cerebellar artery</strong> and occasionally <strong>posterior inferior cerebellar artery</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/94d4a0d2c766470ead1749ac5d6dae76.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1496140202aa445dbef1101b5707c99ex1175x881.JPEG"
    ]
  },
  {
    "text": "You are at a health camp screening children in a community for malnutrition. According to the new WHO growth standards, the cut-off value of mid-upper arm circumference to define severe acute malnutrition is _______.",
    "choices": [
      {
        "id": 1,
        "text": "11 cm"
      },
      {
        "id": 2,
        "text": "11.5 cm"
      },
      {
        "id": 3,
        "text": "12 cm"
      },
      {
        "id": 4,
        "text": "12.5 cm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The cut-off value of mid-upper arm circumference to define severe acute malnutrition is <strong>11.5 cm</strong> according to the new WHO growth standards.</p>\n<p>Mid-upper arm circumference:</p>\n<ul>\n<li>Used in children between 6 to 60 months.</li>\n<li>Measured between the acromion and olecranon process.</li>\n<li>It is an age-independent parameter (between 6-60 months).</li>\n</ul>\n<p>MUAC tape cut-offs:</p>\n<table>\n<tbody>\n<tr>\n<td>Color</td>\n<td>Measurements</td>\n<td>Indication</td>\n</tr>\n<tr>\n<td>Red</td>\n<td>&lt;11.5 cm</td>\n<td>Severe acute malnutrition</td>\n</tr>\n<tr>\n<td>Yellow</td>\n<td>11.5 to 12.5 cm</td>\n<td>Under-nourished</td>\n</tr>\n<tr>\n<td>Green</td>\n<td>&gt;12.5 cm</td>\n<td>Normal</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old man presents with complaints of fever, fatigue, and weight loss for the past 3 months. On examination, he has pallor and bruising on his lower limbs and abdomen. Bone marrow aspirate is shown below. Which of the following statements is false regarding this disease?",
    "choices": [
      {
        "id": 1,
        "text": "DIC is a dreaded complication of this disease"
      },
      {
        "id": 2,
        "text": "All-trans retinoic acid is used in treatment"
      },
      {
        "id": 3,
        "text": "Associated genetic aberration t(15;17)"
      },
      {
        "id": 4,
        "text": "Blast count of 10% is required to establish a diagnosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The bone marrow aspirate findings in this patient show myeloblasts containing\u00a0<strong>Auer rods</strong> (eosinophilic cytoplasmic inclusions) are suggestive of\u00a0<strong>acute promyelocytic leukemia (APML/ APL)\u00a0</strong>variant of\u00a0<strong>acute myeloid leukemia (AML)</strong>. A\u00a0<strong>blast count</strong> of<strong>\u00a0\u2265 20%</strong> is required to make a diagnosis.</p>\n<p>The below image shows\u00a0<strong>Auer rods.</strong>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/73caa7adaf0946cf8eddb51485e49f82.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9cb06d28780d415dbfb4c308cb297685x352x512.JPEG"
    ]
  },
  {
    "text": "A young woman was diagnosed with a structural uterine abnormality by hysterosalpingography. Which two anomalies cannot be easily differentiated from each other by this investigation?",
    "choices": [
      {
        "id": 1,
        "text": "Septate and didelphys uterus"
      },
      {
        "id": 2,
        "text": "Didelphys and bicornuate uterus"
      },
      {
        "id": 3,
        "text": "Septate and bicornuate uterus"
      },
      {
        "id": 4,
        "text": "Arcuate and didelphys uterus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Septate </strong>and<strong> bicornuate uterus\u00a0</strong>are the two anomalies that cannot be easily differentiated from each other by <strong>hysterosalpingography </strong>(HSG).\u00a0HSG provides excellent information about the <strong>interior contour</strong> of the uterine cavity, but not the external uterine contour.\u00a0</p>\n<div class=\"page\" title=\"Page 448\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>A <strong>bicornuate uterus</strong> is characterized by <strong>two separate endometrial cavities</strong>, that may communicate with each other and a single uterine cervix. It is caused by the\u00a0<strong>incomplete fusion</strong> of the <strong>m\u00fcllerian ducts</strong>.\u00a0Failure of fusion may extend to the cervix, resulting in a complete bicornuate uterus, or may be partial, causing a milder abnormality.\u00a0</p>\n<div class=\"page\" title=\"Page 449\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>On HSG, the bicornuate uterus is seen as widely <strong>diverging horns</strong> with an <strong>intercornual angle &gt;105 degrees</strong>.\u00a0However, <strong>MR imaging</strong> is necessary to define the <strong>external</strong> or <strong>fundal contour</strong>.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5a9044b912c94d0585fb650def038aefx1245x771.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8035f232257648d6a69b6c0ab9a99916x1208x778.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/01c96d3ecb4241efbd9a47c55a0de83fx608x362.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a9d414be624a4bf9a3bd80e53f4d0d65x576x366.PNG"
    ]
  },
  {
    "text": "The endoscopy and biopsy of a patient with progressive dysphagia and weight loss suggested a diagnosis of esophageal carcinoma. This patient's barium swallow is most likely to show _____.",
    "choices": [
      {
        "id": 1,
        "text": "Irregular stricture with shouldered margins"
      },
      {
        "id": 2,
        "text": "Corkscrew appearance of esophagus"
      },
      {
        "id": 3,
        "text": "Smooth stricture without shouldering"
      },
      {
        "id": 4,
        "text": "Submucosal web encircling the lumen"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The barium swallow of a patient with <strong>esophageal carcinoma</strong> is likely to show <strong>irregular strictures </strong>with<strong> shouldered margins</strong>.</p>\n<p>Esophageal carcinoma is a disease of mid-late adulthood and typically presents with dysphagia. Squamous cell carcinoma usually affects the upper 2/3<sup>rd</sup> of the esophagus and adenocarcinoma affects the lower 1/3<sup>rd</sup>. Tobacco and alcohol are the main etiological factors.</p>\n<p><strong>Endoscopy</strong> is the <strong>first-line</strong> investigation, and a <strong>biopsy</strong> is required for <strong>diagnosis</strong>. Other investigations are usually done to define the extent of local or distant spread. On<strong> barium swallow</strong>, <strong>strictures with an ulcerated, irregular mucosa and shouldered margins </strong>are seen, as shown in the image below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ebc96fa095bd47a5b4f3b2de8af3546bx720x777.PNG"
    ]
  },
  {
    "text": "A 40-year-old obese male patient was started on prazosin for the treatment of hypertension. Which of the following statements is incorrect about this drug?",
    "choices": [
      {
        "id": 1,
        "text": "It is highly bound to plasma proteins"
      },
      {
        "id": 2,
        "text": "It has selective \u03b12 receptor blocking property"
      },
      {
        "id": 3,
        "text": "It  increases HDL cholesterol concentration"
      },
      {
        "id": 4,
        "text": "First dose has the risk of producing syncopal attack"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p style=\"text-align: left;\">The incorrect statement about the drug prazosin is that it&nbsp;has a selective&nbsp;&alpha;2 receptor blocking property<strong>.&nbsp;</strong>It is a typical&nbsp;<strong>&alpha;1 receptor antagonist&nbsp;</strong>and has little or no effect on the &alpha;2 receptor.</p>\n<p style=\"text-align: left;\"><strong>Prazosin</strong> acts by blocking the alpha-1 receptors in the arterioles and veins, thereby decreasing peripheral vascular resistance. It reduces the<strong> cardiac preload</strong>. Thus the norepinephrine release from sympathetic nerve endings in the heart is avoided. This accounts for the <strong>relative absence</strong> of <strong>reflex</strong> <strong>tachycardia</strong>.</p>\n<p style=\"text-align: left;\">It is <strong>highly bound</strong> to <strong>plasma proteins</strong> and metabolized in the liver and <strong>excreted</strong> primarily in<strong> bile</strong>. Its duration of action lasts about 6-7 hours in the treatment of hypertension.</p>\n<p style=\"text-align: left;\">It is used in the treatment of <strong>Raynaud's disease</strong><strong>,&nbsp;</strong><strong>hypertension,</strong> and congestive heart failure. It also has an off-label use in the treatment of benign prostatic hyperplasia. It has a beneficial effect on the lipid profile of this patient as it&nbsp;<strong>decreases LDL&nbsp;</strong>and<strong>&nbsp;triglyceride</strong>&nbsp;levels as well as&nbsp;<strong>increases HDL levels</strong>.</p>\n<div class=\"page\" title=\"Page 228\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p style=\"text-align: left;\">The <strong>first dose</strong> is usually given at <strong>bedtime</strong> so that the patient will remain recumbent for at least several hours to reduce the <strong>risk </strong>of <strong>syncopal reactions&nbsp;</strong>and orthostatic hypotension. This is called the <strong>first dose phenomenon</strong>.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following functions is regulated by the lateral superior hypothalamus?",
    "choices": [
      {
        "id": 1,
        "text": "Body rhythm"
      },
      {
        "id": 2,
        "text": "Sexual behavior"
      },
      {
        "id": 3,
        "text": "Thirst"
      },
      {
        "id": 4,
        "text": "Temperature regulation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>lateral superior hypothalamus</strong>&nbsp;regulates&nbsp;<strong>thirst</strong>.&nbsp;It is also an integrating area for <strong>hunger</strong>.&nbsp;</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Body rhythm</strong> control is integrated by <strong>suprachiasmatic nuclei</strong> of the hypothalamus.</p>\n<p>Option B:&nbsp;<strong>Sexual behavior</strong>&nbsp;is integrated by the <strong>anterior ventral hypothalamus</strong>.</p>\n<p>Option D:&nbsp;<strong>Temperature regulation</strong> is integrated by the&nbsp;<strong>anterior </strong>and<strong> posterior hypothalamus</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old boy presents with complaints of epistaxis while playing cricket. There is no history of trauma or fall. He also gives a history of recurrent spontaneous nasal bleeding and earache. Contrast-enhanced CT scan of the head is taken which is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Nasopharyngeal carcinoma"
      },
      {
        "id": 2,
        "text": "Nasopharyngeal angiofibroma"
      },
      {
        "id": 3,
        "text": "Inverted papilloma"
      },
      {
        "id": 4,
        "text": "Blow-out fracture"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely diagnosis in this patient is <strong>nasopharyngeal angiofibroma</strong>.</p>\n<p>The above clinical scenario of an adolescent boy of age 12 years presenting with recurrent <strong>spontaneous epistaxis</strong>, earache, and contrast-enhanced CT scan showing <strong>anterior bowing of the posterior wall</strong> of the <strong>maxillary</strong> sinus (<strong>Antral sign/ Holman Miller sign</strong>) is suggestive of <strong>nasopharyngeal angiofibroma.</strong></p>\n<p><strong>Nasopharyngeal angiofibroma</strong> is a benign but locally invasive tumor predominant in adolescent males in the age group of <strong>10-20 years</strong>. It arises from the posterior part of the nasal cavity that is close to the superior margin of the <strong>sphenopalatine foramen</strong>. These patients have a hamartomatous nidus of vascular tissue in the nasopharynx that forms angiofibroma when testosterone appears. Therefore, it is thought to be <strong>testosterone-dependent.</strong></p>\n<p>Angiofibroma can extend into the nasal cavity causing obstruction, epistaxis, paranasal sinuses, pterygomaxillary fossa, infratemporal fossa, cheek, orbits causing proptosis, frog-face deformity, and cranial cavity. The clinical features include:</p>\n<ul>\n<li>Profuse, recurrent, spontaneous <strong>epistaxis</strong>- <strong>most common</strong></li>\n<li>Progressive nasal obstruction and denasal speech- due to mass in the postnasal space</li>\n<li>Conductive hearing loss and otitis media with effusion- due to obstruction of the Eustachian tube</li>\n<li>Sessile, lobulated, or smooth mass in the nasopharynx</li>\n<li>Other clinical features include the broadening of the nasal bridge, proptosis, cheek swelling, involvement of II, III, IV, and VI cranial nerves</li>\n</ul>\n<p>Diagnosis: It is mostly clinical. <strong>Contrast-enhanced CT</strong> scan of the head is the<strong> investigation of choice</strong> that reveals <strong>anterior bowing</strong> of the posterior wall of the maxillary sinus (<strong>Antral sign/Holman Miller sign</strong>) which is pathognomonic of angiofibroma as shown below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8a4a33e16bd7431bbd34ba0c079285c0.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/60b3695f168e4db489b2f585fd52d74ex1280x1304.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1d4431a1d8ff42c9bf853021da317100x1280x958.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/73b7fabd58214f4e87c5a6cbd78ecdf6x720x590.JPEG"
    ]
  },
  {
    "text": "In a 48-year-old patient with type-2 diabetes mellitus, fundus examination revealed the presence of hard exudates. In which of the below-marked layers of the retina would you appreciate this finding?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Hard exudates</strong> mostly occur in the&nbsp;<strong>outer plexiform layer</strong>&nbsp;- <strong>layer 3</strong>. It can be identified as it lies between two nuclear layers.&nbsp;</p>\n<p>In the given image:</p>\n<ol>\n<li>Inner plexiform layer</li>\n<li>Inner nuclear layer</li>\n<li>Outer plexiform layer</li>\n<li>Outer nuclear layer</li>\n</ol>\n<p><strong>Hard exudates </strong>are the&nbsp;extravasation of fluid rich in fibrin and protein around the area of leaking micro-aneurysms. They mostly occur in the <strong>outer plexiform layer. </strong>They appear as well-defined<strong>&nbsp;</strong>small,<strong>&nbsp;bright yellow deposits&nbsp;</strong>with<strong> crenated margins.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/603dfc65b8e34c5f8c5e3a254c07a0ab.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/788ea46ce6294b16b13931849e2a42f0x720x441.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b84164ba4caf4e958cb4b2aa58e99e09x1280x1359.JPEG"
    ]
  },
  {
    "text": "On noticing the capnography of a patient showing the tracing below, which of the following would you suspect?",
    "choices": [
      {
        "id": 1,
        "text": "Esophageal intubation"
      },
      {
        "id": 2,
        "text": "Bronchospasm"
      },
      {
        "id": 3,
        "text": "Rebreathing"
      },
      {
        "id": 4,
        "text": "Malignant hyperthermia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above capnographic waveform shows an&nbsp;<strong>elevated inspiratory baseline,</strong> which depicts <strong>rebreathing.&nbsp;</strong>Rebreathing of CO<sub>2</sub> may occur&nbsp;due to <strong>exhausted CO<sub>2</sub> absorbent </strong>or<strong>&nbsp;incompetent expiratory valve</strong>&nbsp;in closed-circuit breathing systems.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a027d15afa9e41a3b836d2507202e96e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/abca700e77eb44c5a1cdef95860c0a9ax1280x942.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5d0e7285c1ee4957867ca2ec0f303ce4x1280x1075.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a291b853628e45a6a98971c6ed859715x1280x839.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4db7843f20974d969aac50abfa4a1dccx1280x908.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/75b151f3d200431c8cac2f10e315d901x1280x752.JPEG"
    ]
  },
  {
    "text": "The object shown in the image below should be discarded in which color bin?",
    "choices": [
      {
        "id": 1,
        "text": "Red"
      },
      {
        "id": 2,
        "text": "Yellow"
      },
      {
        "id": 3,
        "text": "Black"
      },
      {
        "id": 4,
        "text": "Blue"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>urine bag</strong> should be disposed into the red color bin.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d31e76f44e34411495c3c014f3330a04.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A diabetic patient is admitted with symptoms of ear pain and ear discharge, which was not responsive to topical measures. He also complained of pain while chewing. A swab was taken and cultured; the isolate was a strict aerobe, and the catalase test was positive. What is the likely etiology of his infection?",
    "choices": [
      {
        "id": 1,
        "text": "Enterococcus"
      },
      {
        "id": 2,
        "text": "Lactobacillus"
      },
      {
        "id": 3,
        "text": "Pseudomonas"
      },
      {
        "id": 4,
        "text": "Streptococcus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical features and the laboratory findings are suggestive of <strong>malignant otitis externa</strong> caused by <em><strong>Pseudomonas aeruginosa</strong></em>. <em>Pseudomonas aeruginosa</em> is\u00a0a\u00a0strict aerobe and shows a\u00a0positive\u00a0<strong>catalase</strong> reaction.\u00a0<em>Enterococcus,\u00a0Lactobacillus</em>, and <em>Streptococcus</em> are catalase negative.</p>\n<p><strong>Catalase</strong> <strong>test</strong>: When a microbial colony is placed in hydrogen peroxide (H<sub>2</sub>O<sub>2</sub>), the catalase enzyme <strong>degrades H<sub>2</sub>O<sub>2</sub>\u00a0into H<sub>2</sub>O and O<sub>2</sub></strong>. The liberated O<sub>2\u00a0</sub>is seen as gas bubbles. People with\u00a0<strong>chronic granulomatous disease\u00a0</strong>have recurrent attacks of infection with\u00a0<strong>catalase-positive\u00a0</strong>organisms.</p>\n<p>Catalase positive organisms:</p>\n<ul>\n<li>Staphylococcus</li>\n<li><strong>Pseudomonas</strong></li>\n<li>Vibrio\u00a0 \u00a0\u00a0</li>\n<li>Nocardia</li>\n<li>Helicobacter</li>\n<li>Campylobacter</li>\n<li>Pasteurella</li>\n<li>Legionella\u00a0 \u00a0</li>\n<li>Enterobacteriaceae\u00a0 \u00a0</li>\n<li>Listeria</li>\n<li>Neisseria meningitidis\u00a0 \u00a0</li>\n<li>Corynebacterium diphtheria</li>\n<li>Yersinia</li>\n<li>Brucella</li>\n</ul>\n<p>Catalase negative organisms:</p>\n<ul>\n<li>Streptococci</li>\n<li>Enterococci</li>\n<li>Lactobacillus</li>\n</ul>\n<p><strong><em>Pseudomonas aeruginosa</em>\u00a0</strong>is a gram-negative, catalase-positive, oxidase-positive, non-lactose fermenting bacteria that shows <strong>swarming motility</strong>. They produce a characteristic blue-green pigment called\u00a0<strong>pyocyanin</strong>\u00a0and a greenish-yellow pigment called<strong>\u00a0fluorescein/ pyoverdin.</strong> Other pigments these organisms produce include<strong> pyorubin</strong> (red) and\u00a0<strong>pyomelanin</strong>\u00a0(brown).</p>\n<p>Diseases caused by <em>Pseudomonas aeruginosa</em> include-</p>\n<ul>\n<li><strong>Malignant otitis externa</strong> in diabetics</li>\n<li>Pneumonia and sepsis in cystic fibrosis</li>\n<li>Wound infection and sepsis in burns</li>\n<li>Hot tub folliculitis/ <em>Pseudomonas aeruginosa</em> folliculitis/\u00a0Jacuzzi syndrome is a type of folliculitis, occurring after hot tub exposure</li>\n<li>Shanghai fever is a febrile illness that manifests as severe enteric, sepsis, and invasive disease</li>\n<li>Ecthyma gangrenosum</li>\n</ul>\n<p>Pseudomonas is an <strong>obligate aerobe</strong> that exerts its pathogenicity by producing diphtheria-like <strong>exotoxin A </strong>and a <strong>slime layer.</strong> Breach in primary body defenses, such as <strong>burns</strong>, predisposes to Pseudomonas infection.</p>\n<p>Pseudomonas is characterized by <strong>blue-green pus</strong>. It is notorious for being resistant to antimicrobials and antiseptics and is a frequent contaminant in hospital samples. Repeated isolation and associated clinical features should prompt the diagnosis of Pseudomonas. Biochemical tests, such as<strong> arginine</strong> <strong>hydrolysis</strong> and <strong>oxidase reaction</strong>, make species identification possible.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/57ac67615bf14f2bbaab95185d63d1c6x800x531.JPEG"
    ]
  }
];
        let quizName = 'Mini Test 5';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2022-23"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>