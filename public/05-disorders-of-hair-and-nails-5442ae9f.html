<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>05 Disorders Of Hair And Nails - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Dermatology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following structures demarcates the upper and lower hair follicles?",
    "choices": [
      {
        "id": 1,
        "text": "Sebaceous gland"
      },
      {
        "id": 2,
        "text": "Sweat gland"
      },
      {
        "id": 3,
        "text": "Arrector pili"
      },
      {
        "id": 4,
        "text": "Adamson's fringe"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option A: Sebaceous gland divides the upper segment into infundibulum and isthmus</p>\n<p>Option B: Apocrine sweat glands open into the hair follicle above the opening of the sebaceous gland.</p>\n<p>Option D:&nbsp;Adamson's fringe is an inverted V-shaped area in the upper keratogenous zone of the hair follicle and divides the lower segment into stem and bulb.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ac451a0892ac4791b47a16b4efac5100x738x331.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/34daf52935c141a8aa942961530cc929x1280x1649.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0e42541f7f1649698e0ab9df778cd13ex397x540.JPEG"
    ]
  },
  {
    "text": "Which of the following is not true about hair cycle?",
    "choices": [
      {
        "id": 1,
        "text": "Anagen is responsible for final hair length"
      },
      {
        "id": 2,
        "text": "50% of hair is in anagen at any point in time"
      },
      {
        "id": 3,
        "text": "Lower part of the follicle involutes during catagen"
      },
      {
        "id": 4,
        "text": "Kenogen is a state of latency"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Telogen:</p>\n<p>It is the <strong>resting phase</strong> between catagen and the next anagen. <strong>Clubbing</strong> becomes more <strong>prominent.</strong> It lasts for about <strong>3 months</strong>. Club hair is eventually shed through an active process called <strong>exogen</strong>.</p>\n<p>In the human scalp, hair follicles may remain in a state of <strong>latency</strong>, also known as <strong>kenogen</strong>, for a pro&shy;longed period after the club hair is shed.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2bc0e4da76314d049a833c66bbbbda85x1280x1428.JPEG"
    ]
  },
  {
    "text": "Identify the incorrect statement regarding the types of hair.",
    "choices": [
      {
        "id": 1,
        "text": "Melanin is absent in vellus hair"
      },
      {
        "id": 2,
        "text": "Vellus hair depth extends to the subcutis"
      },
      {
        "id": 3,
        "text": "The medulla is thicker in terminal hairs"
      },
      {
        "id": 4,
        "text": "Lanugo hair is unmedullated"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Vellus</strong> hair extends to the <strong>dermis</strong> and not the subcutis.</p>\n<p><strong>Lanugo</strong> refers to the fine, soft, unmedullated and usually unpigmented hair of the <strong>prenatal</strong> period. It is normally shed in utero in the eighth to ninth months of gestation.</p>\n<p><strong>Postnatal</strong> hair is of two kinds: vellus and terminal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1d95d89ff79e4a4fb03848b0c21cf25cx1280x1726.JPEG"
    ]
  },
  {
    "text": "A young man comes to you with hair loss as shown in the image given below. You prescribe finasteride to prevent his condition from worsening. Which isoform (s) of 5-alpha reductase does this drug inhibit?",
    "choices": [
      {
        "id": 1,
        "text": "Type 3"
      },
      {
        "id": 2,
        "text": "Type 2"
      },
      {
        "id": 3,
        "text": "Types 1 and 2"
      },
      {
        "id": 4,
        "text": "Types 2 and 3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This man has male-pattern hair loss. <strong>Finasteride</strong> selectively inhibits <strong>type 2 5&alpha;\u2010reductase</strong> within the hair follicle. Hence, it is used in the treatment of <strong>male-pattern hair loss</strong>.</p>\n<p>The <strong>5&alpha;\u2010reductase</strong> enzyme converts <strong>testosterone</strong> to the more potent form of <strong>dihydrotestosterone</strong> (DHT). 5&alpha;\u2010Reductase exists in <strong>3 isoforms</strong>. Type 1 and 3 are widely distributed in the skin and not involved in hair growth.</p>\n<p>Type 2 is present in androgen-responsive tissues such as the dermal papillae of the hair follicle, prostate, epididymides, and seminal vesicles. Type 2 5&alpha;\u2010reductase also plays a key role in regulating androgen-dependent hair growth.</p>\n<p>Hair growth in the following areas is androgen dependent:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Beard, chest, and extremity hair in males</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Scalp, pubic, and axillary hair in both sexes&nbsp;</li>\n</ul>\n<p>Male-pattern hair loss:&nbsp;</p>\n<p>Male-pattern hair loss causes thinning of the&nbsp;<strong>vertex</strong> and an <strong>M-shaped receding</strong> <strong>hairline</strong>, as shown below. High levels of circulating androgens stimulate <strong>hair loss</strong> in certain sites by a process called <strong>miniaturization</strong>. Finasteride reverses this process.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/742f49f852c447749cf2b6356d5e2614.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cfb7d7e50e7c4666a49a6c612cc878cdx450x600.JPEG"
    ]
  },
  {
    "text": "Which is the primary site of action of androgen in hair follicle?",
    "choices": [
      {
        "id": 1,
        "text": "Hair follicle epithelium"
      },
      {
        "id": 2,
        "text": "Dermal papilla"
      },
      {
        "id": 3,
        "text": "Bulb"
      },
      {
        "id": 4,
        "text": "Infundibulum"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>dermal papilla</strong> is the primary target of the action of androgen in the hair. This is because the dermal papillae have two important features, namely</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Androgen receptors</strong> which are present only in dermal papillae</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Expression of<strong> 5&alpha;\u2010reductase type 2</strong>&nbsp;which regulates androgen-dependent hair growth.</li>\n</ul>\n<p>Androgens have the following effects on hair growth.</p>\n<ul>\n<li>It increases the number of cells in the dermal papilla which causes hair follicle growth and results in <strong>pubertal hair growth</strong>.&nbsp;</li>\n<li>It causes <strong>miniaturization</strong> of the follicle in other susceptible sites which leads to <strong>male pattern hair loss.</strong></li>\n</ul>\n<p>Finasteride inhibits conversion of testosterone to dihydrotestosterone in the dermal papillae. This prevents miniaturization and further development of alopecia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/307e3abf266a4cb883cf2c9511da89b4x1280x1649.JPEG"
    ]
  },
  {
    "text": "A 32 year old female patient with PCOS is worried that her hairline has shifted upwards exposing more of her forehead as shown below. Which of the following is incorrect about this type of hair loss and its treatment?",
    "choices": [
      {
        "id": 1,
        "text": "DHT(dihydrotestosterone) is responsible for follicular regression"
      },
      {
        "id": 2,
        "text": "Arao-Perkins bodies are seen within the follicular stelae"
      },
      {
        "id": 3,
        "text": "Minoxidil has vasodilatory action"
      },
      {
        "id": 4,
        "text": "Finasteride is the first line treatment"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This clinical scenario is suggestive of male pattern\u00a0<strong>androgenetic </strong>alopecia<strong>. Finasteride</strong> is <strong>not the first line treatment </strong>in <strong>women.</strong>\u00a0</p>\n<p>Finasteride use in <strong>pregnancy</strong> can lead to <strong>teratogenic</strong> effects on male fetuses.</p>\n<p><strong>Androgenetic </strong>alopecia is a disorder characterized by a reduction of hair fiber production by follicles and miniaturization. It is of two types , male pattern and female pattern hair loss. Male pattern hair loss may occur in female &amp; vice versa is also true. Male pattern hair loss causes <strong>frontal hairline recession</strong> and thinning of the <strong>vertex</strong>.</p>\n<p><strong>Miniaturization</strong> refers to a reduction in the size of follicles until it leaves behind a remnant called <strong>stelae</strong> or streamers. Elastic staining of the stelae shows <strong>Arao-Perkin's</strong> bodies.</p>\n<p><strong>DHT</strong> is a more potent form of testosterone. It is responsible for <strong>follicular regression</strong> and thus causes androgenic alopecia. <strong>Finasteride</strong> inhibits the enzyme that converts testosterone to DHT and hence is used for treatment.</p>\n<div class=\"p-rich_text_section\"><strong>Minoxidil</strong> is a potent <strong>vasodilator.</strong> It is used orally to treat severe hypertension. When used as a hair lotion, it <strong>prolongs</strong> the <strong>anagen</strong> phase and slows down or prevents hair loss. Drugs used to treat male pattern baldness:</div>\n<ul class=\"p-rich_text_list p-rich_text_list__bullet\" data-stringify-type=\"unordered-list\" data-indent=\"0\" data-border=\"false\">\n<li data-stringify-indent=\"0\" data-stringify-border=\"0\">Minoxidil lotion</li>\n<li data-stringify-indent=\"0\" data-stringify-border=\"0\">5-alpha reductase antagonist - Finasteride</li>\n</ul>\n<div class=\"p-rich_text_section\">Drugs used to treat female pattern baldness:</div>\n<ul class=\"p-rich_text_list p-rich_text_list__bullet\" data-stringify-type=\"unordered-list\" data-indent=\"0\" data-border=\"false\">\n<li data-stringify-indent=\"0\" data-stringify-border=\"0\">Minoxidil lotion</li>\n<li data-stringify-indent=\"0\" data-stringify-border=\"0\">Anti-androgens - spironolactone, flutamide, and cyproterone acetate\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b0bba2df0a8f42c2ade5042d674ea319.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "You see a male patient with diffuse hair loss over the crown and frontal scalp with maintenance of the hairline. What is this pattern of hair loss?",
    "choices": [
      {
        "id": 1,
        "text": "Female pattern hair loss"
      },
      {
        "id": 2,
        "text": "Male pattern hair loss"
      },
      {
        "id": 3,
        "text": "Alopecia areata"
      },
      {
        "id": 4,
        "text": "Mixed pattern hair loss"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Currently, the <strong>Hamilton-Norwood</strong> classification system for <strong>MPHL</strong>&nbsp;and the <strong>Ludwig system</strong> for <strong>FPHL</strong> are most commonly used to describe patterns of hair loss.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/30409c95f44a411ebc0357bd17f263a2x1280x1561.JPEG"
    ]
  },
  {
    "text": "A patient comes to you with hair loss as shown below. How will you classify its severity?",
    "choices": [
      {
        "id": 1,
        "text": "Tanner staging"
      },
      {
        "id": 2,
        "text": "Hamilton-Norwood staging"
      },
      {
        "id": 3,
        "text": "Batts-Ludwig staging"
      },
      {
        "id": 4,
        "text": "Ludwig staging"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Option B: <strong>Hamilton Norwood</strong> staging is used for male pattern hair loss (<strong>MPHL</strong>).&nbsp;</p>\n<p>Option C: <strong>Tanner</strong> staging is used to assess <strong>sexual maturity</strong>.&nbsp;</p>\n<p>Option D: <strong>Batts-Ludwig</strong> staging is used for staging <strong>chronic hepatitis</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2d6796b18a2c4d6e8b7862dc1ff68f82.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9febc5bd4f5041d6b3d5679d437e6eecx1280x1561.JPEG"
    ]
  },
  {
    "text": "A 50-year-old lady who underwent chemotherapy for breast carcinoma 3 weeks ago now presents with diffuse hair loss as shown below. On examination, she has a depressed affect. Name the condition causing her hair loss.",
    "choices": [
      {
        "id": 1,
        "text": "Alopecia areata"
      },
      {
        "id": 2,
        "text": "Telogen effluvium"
      },
      {
        "id": 3,
        "text": "Anagen effluvium"
      },
      {
        "id": 4,
        "text": "Trichotillomania"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option B: <strong>Telogen effluvium</strong> is an acute-onset <strong>diffuse</strong> hair loss that occurs <strong>2&ndash;3 months</strong> after a <strong>triggering event</strong> such as high fever, surgical trauma, sudden starvation or haemorrhage.</p>\n<p>Option D: <strong>Trichotillomania</strong> is a behavioural disorder characterised by <strong>compulsive hair pulling</strong> which causes <strong>patchy</strong> hair loss. It shares some features with obsessive-compulsive disorder and may be associated with other <strong>psychiatric</strong> conditions.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6fb25c0029d245bba7e0d3305df07b9e.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/65146eb8fa8f42519adfcb8d527d35dfx1280x1453.JPEG"
    ]
  },
  {
    "text": "A 25-year-old woman in the first trimester of pregnancy presents to your clinic with hair loss. She gives a history of typhoid fever 3 months ago. What is the pattern of hair loss seen in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Anagen effluvium"
      },
      {
        "id": 2,
        "text": "Androgenetic alopecia"
      },
      {
        "id": 3,
        "text": "Telogen effluvium"
      },
      {
        "id": 4,
        "text": "Telogen gravidarum"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The pattern of hair loss in this clinical scenario is <strong>telogen effluvium.&nbsp;</strong>It&nbsp;is an acute-onset scalp hair loss that occurs <strong>2&ndash;3 months</strong> after a triggering event such as high fever, surgical trauma, sudden starvation, or hemorrhage.</p>\n<p>It refers to an increase in the shedding of telogen club hairs due to premature termination of the anagen (proliferative) phase of the hair cycle following a <strong>period of stress</strong>.</p>\n<p><strong>Chronic diffuse</strong> telogen hair loss refers to telogen hair shedding <strong>persisting &gt; 6 months</strong>. Causes of chronic diffuse telogen hair loss are:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Thyroid disorders (Both hyper- and hypo&shy;thyroidism)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Severe iron deficiency anemia, acroder&shy;matitis enteropathica, and malnutrition.</li>\n</ul>\n<p><strong>Telogen gravidarum</strong> refers to telogen hair loss seen 2&ndash;3 months after childbirth. The circulating placental <strong>estrogen</strong> during pregnancy <strong>prolongs</strong> <strong>anagen</strong> phase. After delivery, the <strong>estrogen withdrawal</strong> pushes all the hair simultaneously into catagen and then telogen phase.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While examining a patient with hair loss, you notice several thin, broken hairs that are thinner towards the scalp and easily pulled out. What is the diagnosis in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Alopecia areata"
      },
      {
        "id": 2,
        "text": "Telogen effluvium"
      },
      {
        "id": 3,
        "text": "Netherton syndrome"
      },
      {
        "id": 4,
        "text": "Cicatricial alopecia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient has <strong>alopecia areata</strong>. The characteristic finding described in this vignette is called <strong>exclamation mark hair</strong>.&nbsp;</p>\n<p>Alopecia areata is a chronic inflammatory disease that causes <strong>non-scarring</strong> patches of hair loss. It is a <strong>T-cell mediated</strong> inflammatory disease that occurs in <strong>genetically</strong> <strong>predisposed</strong> patients.&nbsp;</p>\n<p>The lesions of alopecia areata are characterized by a <strong>smooth circumscribed patch</strong> of alopecia. Exclamation mark hair refers to short extractable <strong>broken hairs</strong> which are <strong>thinner</strong> towards the <strong>base</strong>, as shown in the image below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0e228debbfce427888f6ce363b09fc50x1280x1453.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/05f85157dcc74d539b1e8d3f92fbd235x1280x1458.JPEG"
    ]
  },
  {
    "text": "Which of the following statements about alopecia areata is true?",
    "choices": [
      {
        "id": 1,
        "text": "Spontaneous remission is seen in 20% of patients"
      },
      {
        "id": 2,
        "text": "Alopecia universalis denotes loss of all scalp hair"
      },
      {
        "id": 3,
        "text": "Ophiasis means loss of hair along the back of scalp"
      },
      {
        "id": 4,
        "text": "Alopecia totalis denotes loss of all body hair"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Hair loss over the back of the head is called <strong>ophiasis</strong> because it creeps like a <strong>snake</strong> towards both ears.</p>\n<p>Alopecia areata causes <strong>non-scarring</strong> hair loss in well-circumscribed patches. It peaks between 20-40 years but can occur at any age.</p>\n<p>In case of <strong>limited</strong> patchy hair loss present for &lt; 1 year, <strong>spontaneous remission</strong> is seen in <strong>80%</strong> of patients. Sometimes the patches can <strong>coalesce</strong> to cause complete loss of hair.</p>\n<p>Alopecia <strong>totalis</strong> means loss of all <strong>scalp</strong> hair and alopecia <strong>universalis</strong> means loss of all <strong>body</strong> hair.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 10-year old boy presents with the following type of hair loss. Which of the following is the most likely expected nail finding?",
    "choices": [
      {
        "id": 1,
        "text": "Fine stippled pitting of nail"
      },
      {
        "id": 2,
        "text": "Thinning of nail with pterygium"
      },
      {
        "id": 3,
        "text": "V-shaped nicks on the distal edge"
      },
      {
        "id": 4,
        "text": "Greenish discoloration with onychonychia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option B: Thinning of the nail with <strong>dorsal pterygium</strong> is seen in <strong>lichen planus</strong>.</p>\n<p>Option C: <strong>V-shaped nicks</strong> on the distal edge of the nail are a feature of <strong>Darier</strong> disease.</p>\n<p>Option D: <strong>Green</strong> nails are associated with <strong>Pseudomonas</strong> infection.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fbd9a3937fcd4f68a00d8a0440f860a5.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cf7d606ce903471ab0463aaaa661b840x750x396.JPEG"
    ]
  },
  {
    "text": "You are treating a college student for acne. While examining him, you observe the following finding. What initial treatment will you recommend for this finding?",
    "choices": [
      {
        "id": 1,
        "text": "Intralesional steroids"
      },
      {
        "id": 2,
        "text": "Contact immunotherapy"
      },
      {
        "id": 3,
        "text": "Oral steroids"
      },
      {
        "id": 4,
        "text": "Cyclosporine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient has <strong>limited alopecia areata</strong> as seen by the <strong>well-circumscribed patch</strong> of hair loss. <strong>Intra-lesional steroids</strong> are the first-line treatment.</p>\n<p>The following treatment options are used in alopecia areata.</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">First line: Intra-lesional corticosteroids - <strong>Depot steroid</strong> (hydrocortisone acetate 25 mg/mL or triamcinolone acetonide 5&ndash;10 mg/mL)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Second line:<strong> Oral</strong> <strong>corticosteroids</strong> are used if initial treatment fails.</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Third line: <strong>Contact immunotherapy</strong>. It works by inducing mild contact dermatitis on the scalp by applying an allergen.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/358fa60775254521a16be1adff800f7c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A woman brings her 46-year-old sister to the dermatology OPD.  Over the last 4 weeks, following the death of her husband, her head has become full of thin white hair which was previously black. She has also lost about 7kgs. What is the cause of this finding?",
    "choices": [
      {
        "id": 1,
        "text": "Hyperthyroidism"
      },
      {
        "id": 2,
        "text": "Alopecia areata"
      },
      {
        "id": 3,
        "text": "Telogen effluvium"
      },
      {
        "id": 4,
        "text": "Psychological stress"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option A: <strong>Hyperthyroidism</strong> can cause <strong>weight loss</strong> and <strong>diffuse hair thinning</strong> but a change in hair color is not a feature.</p>\n<p>Options C and D: <strong>Telogen effluvium</strong> and <strong>psychological stress</strong>&nbsp;(which also causes telogen effluvium) lead to&nbsp;<strong>diffuse</strong> hair loss that affects&nbsp;<strong>all hair equally</strong>, not just pigmented hairs. So, overall hair color will not be affected.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/23130647c1614eca9fce11585841a796x551x750.JPEG"
    ]
  },
  {
    "text": "Which of the following conditions cause non-cicatricial alopecia?",
    "choices": [
      {
        "id": 1,
        "text": "1, 3, 4"
      },
      {
        "id": 2,
        "text": "2, 4, 5"
      },
      {
        "id": 3,
        "text": "3, 5"
      },
      {
        "id": 4,
        "text": "3"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Alopecia areata</strong> and <strong>secondary syphilis</strong> cause&nbsp;<strong>non-scarring </strong>(non-cicatricial)&nbsp;alopecia<strong>.</strong></p>\n<p>Common conditions causing scarring (cicatricial) alopecia include:</p>\n<ul>\n<li><strong>Discoid lupus erythematosus </strong>(DLE)</li>\n<li><strong>Pseudopelade of Brocq</strong></li>\n<li><strong>Scleroderma</strong></li>\n<li>Favus</li>\n<li>Kerion</li>\n<li>Lichen planopilaris</li>\n<li>Folliculitis decalvans.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient presented with hair loss and itching of the scalp along with mild discharge. Which of the following is useful for diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Tzanck smear"
      },
      {
        "id": 2,
        "text": "Gram stain"
      },
      {
        "id": 3,
        "text": "Slit skin smear"
      },
      {
        "id": 4,
        "text": "KOH mount"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Treatment:</p>\n<ul>\n<li><strong>Terbinafine</strong>: &lt;10 Kg- 62.5 mg; 10-20 kg - 125 mg; &gt;20 kg- 250 mg, all given daily for 4 weeks.</li>\n<li><strong>Itraconazole</strong>: 2-4 mg/kg/day for 4-6 weeks.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ab1a2d8faad64f6a8a830f3f3b571638.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/6ff2168014fc49df80019d204f97402cx421x285.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d3203eae1fbc4318ac00e37eb3c7056ax720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/78a9d6a3b4cc4cc7b1185bd5067b1e88x512x358.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cf6e746b6c7d4b62b564f07b2a7e6ed8x720x462.JPEG"
    ]
  },
  {
    "text": "A dermatologist is consulted regarding a 20-year old patient who underwent surgery for intestinal obstruction last week. Which of the following is the cause of hair loss in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Alopecia areata"
      },
      {
        "id": 2,
        "text": "Pseudopelade of Brocq"
      },
      {
        "id": 3,
        "text": "Telogen effluvium"
      },
      {
        "id": 4,
        "text": "Trichotillomania"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Option B: <strong>Pseudopelade of Brocq</strong> is a <strong>scarring</strong> alopecia that produces small round or oval patches of smooth alopecia, described as <strong>footprints in the snow</strong>.</p>\n<p>Option C: <strong>Telogen effluvium</strong> can occur 2-3 months after systemic stress such as surgery or illness, but it causes <strong>diffuse</strong> hair loss, not patchy as in this patient.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8ddd247069f64b9b90c2bc8406270749.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/244556091414432387f7920221a01aeax557x750.JPEG"
    ]
  },
  {
    "text": "Which of the following conditions causes bamboo hair as seen in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Trichorrhexis nodosa"
      },
      {
        "id": 2,
        "text": "Netherton syndrome"
      },
      {
        "id": 3,
        "text": "Kinky hair syndrome"
      },
      {
        "id": 4,
        "text": "Uncombable hair syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Option D: <strong>Uncombable hair syndrome</strong> produces a characteristic <strong>triangular cross-section</strong> of hair and <strong>longitudinal groove</strong> along one side which contributes to its hair stiffness.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/87ff8b04cdb84136b9cf9352e89bfdd8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0610858131b541dbbf67cb6727e6a75fx483x585.PNG",
      "https://cdn1.dailyrounds.org/uploads/aa4ddc46fbd44ad7ade374c874d3b784x444x483.JPEG",
      "https://cdn1.dailyrounds.org/uploads/e333e5b359f24e5694d90e82698802adx469x352.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/883165e3ecb24248958cff0d47ed7149x603x600.JPEG",
      "https://cdn1.dailyrounds.org/uploads/e2f2a5c2aa06471d8c81201ad50727f9x697x447.JPEG"
    ]
  },
  {
    "text": "Identify the structure marked in the following image.",
    "choices": [
      {
        "id": 1,
        "text": "Cuticle"
      },
      {
        "id": 2,
        "text": "Lunula"
      },
      {
        "id": 3,
        "text": "Hyponychium"
      },
      {
        "id": 4,
        "text": "Nail matrix"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The marked structure is the<strong> lunula, </strong>which is the whitish <strong>half-moon-shaped</strong>&nbsp;structure between the free margin of proximal nail fold and nail bed.</p>\n<p>The various parts of the nail include:</p>\n<ul>\n<li><strong>Nail plate</strong>: Durable, chemically resistant, partially translucent keratinized structure which grows throughout life.</li>\n<li><strong>Proximal nail fold</strong>: Cutaneous folded structure providing a visible proximal border of nail fold, continuous with the cuticle.</li>\n<li><strong>Lateral nail fold</strong>: Cutaneous folded structures providing the lateral borders to the nail.</li>\n<li><strong>Lunula</strong>: Convex margin of intermediate nail matrix seen through the nail.</li>\n<li><strong>Eponychium</strong>: Small band of epithelium extending from the proximal nail fold and adhering to the dorsal aspect of the nail plate.</li>\n<li><strong>Cuticle</strong>: Thin layer of dead tissue which forms a seal between the nail plate and eponychium to prevent pathogens from infecting the matrix area.</li>\n<li><strong>Nail Bed</strong>: The vascular bed upon which nail rests extending from the lunula to the hyponychium.</li>\n<li><strong>Hyponychium</strong>: Cutaneous margin underlying free nail, bordered distally by the distal groove.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/81f6df42ac184ec8925e41d919c2ed8d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6980c9f9a65f4327b8aec7f356d893a3x1280x1392.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3cc9b98928b145b99590bf8b88d9e103x1280x1391.JPEG"
    ]
  },
  {
    "text": "In a patient with the given nail finding, you would suspect all of the following diagnoses except __",
    "choices": [
      {
        "id": 1,
        "text": "Iron deficiency anaemia"
      },
      {
        "id": 2,
        "text": "Hemochromatosis"
      },
      {
        "id": 3,
        "text": "Raynaud's disease"
      },
      {
        "id": 4,
        "text": "Megaloblastic anaemia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Koilonychia</strong> is <strong>not seen</strong> in <strong>megaloblastic anemia</strong>.&nbsp;It refers to a <strong>flattening</strong> or <strong>concavity</strong> of the dorsal part of the nail producing a<strong> spoon shape</strong>. It can occur in the following conditions</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Iron-deficiency anemia</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Hemochromatosis</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Raynaud&rsquo;s disease.</li>\n</ul>\n<p>Psoriasis and dermatophytes also can mimic koilonychia</p>\n<p>The following image also shows koilonychia or spoon-shaped nails:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fd08fb0a9ed745d089bcda47b076956d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b8d0842947ab4800beab0d7d3564d5c3x1280x799.JPEG"
    ]
  },
  {
    "text": "On examining a patient with a history of a long-standing rash, you notice that one of her nails has the following appearance. What condition does this patient suffer from?",
    "choices": [
      {
        "id": 1,
        "text": "Lichen planus"
      },
      {
        "id": 2,
        "text": "Scleroderma"
      },
      {
        "id": 3,
        "text": "Psoriaisis"
      },
      {
        "id": 4,
        "text": "Systemic Lupus Erythematosus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows <strong>dorsal pterygium</strong>, which is a characteristic nail finding in <strong>lichen planus</strong>.</p>\n<p>It is a <strong>wing-shaped deformity</strong> of the dorsal nail due to a <strong>central fibrotic band</strong> that divides the nail into two parts in the proximal area.</p>\n<p><strong>Ventral pterygium</strong> or <strong>pterygium inversum unguis</strong> refers to the <strong>adherence</strong> of the distal portion of the <strong>nail bed</strong> to the ventral surface of the <strong>nail plate</strong>. It can be idiopathic or due to trauma, systemic sclerosis, Raynaud phenomenon. It makes the trimming of nails very painful.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b777befca41f410f8435d730cb972f88.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A medical student is visiting her grandmother, who is recovering from heart surgery. She decides to cheer her up by painting her nails. She notices that her nails look odd as seen below. What is this finding called?",
    "choices": [
      {
        "id": 1,
        "text": "Beau\u2019s lines"
      },
      {
        "id": 2,
        "text": "Mees lines"
      },
      {
        "id": 3,
        "text": "Lindsay nail"
      },
      {
        "id": 4,
        "text": "Trachyonychia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Option D: <strong>Trachyonychia</strong> is <strong>roughening</strong> of nails observed in <strong>alopecia areata</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f3c48a1dc2854be18c805ca63300f9a7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a316786f0ae746cca8d96451aefaf032x720x616.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/60974e4895c54004b68b97215279c69ex1280x1486.JPEG"
    ]
  },
  {
    "text": "A 45-year old woman presents to the OPD with complaints of tiredness. On general examination, she is found to have facial puffiness, pedal edema and her nails appear as follows. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Congestive heart failure"
      },
      {
        "id": 2,
        "text": "Renal failure"
      },
      {
        "id": 3,
        "text": "Hypoalbuminemia"
      },
      {
        "id": 4,
        "text": "Iron-deficiency anemia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows&nbsp;<strong>paired white bands</strong> parallel to the lunula called <strong>Muehrcke&rsquo;s lines</strong>, which are a specific finding of <strong>hypoalbuminemia</strong>. They are <strong>reversible</strong> with albumin infusion.&nbsp;</p>\n<p>Option A: In congestive heart failure, leukonychia or Terry&rsquo;s nails are seen.</p>\n<p>Option B: In renal failure, half and half nails are seen.</p>\n<p>Option D: In iron-deficiency anemia, koilonychia is seen.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f5498fb79be440b5987788f2fadefa6a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man with a history of chronic rhinosinusitis is referred to the dermatology OPD for abnormal-looking nails as shown in the image. Which of the following is not a feature of this patient\u2019s condition?",
    "choices": [
      {
        "id": 1,
        "text": "Pleural effusion"
      },
      {
        "id": 2,
        "text": "Malignant neoplasms"
      },
      {
        "id": 3,
        "text": "Bronchiectasis"
      },
      {
        "id": 4,
        "text": "Pitting edema"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The condition shown in the above image is <strong><span style=\"background-color: #ffff00;\">yellow</span> nail syndrome</strong>. It is associated with <strong>lymphedema</strong>, which is non-pitting.</p>\n<p>It is a rare disease characterized by the classical triad of:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong><span style=\"background-color: #ffff00;\">Yellow</span> dystrophic nails</strong>, due to thickening of nails</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Primary <strong>lymphedema</strong> (due to underdevelopment of the lymphatic vessels)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\"><strong>Pleural effusion</strong></li>\n</ul>\n<p>Other common manifestations include chronic <strong>rhinosinusitis</strong>, chronic <strong>bronchitis</strong>, <strong>bronchiectasis</strong>, increased risk of <strong>malignancy</strong>.</p>\n<p>It is also associated with <strong>D-penicillamine</strong> therapy and <strong>nephrotic</strong> syndrome. Hypothyroidism and AIDS may show yellow nails, but it is unclear whether this is due to yellow nail syndrome or simply due to retarded growth.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f0b0fbdba6cd40bc8d1ec6a654aad6d1.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A woman presents with severe pulsating pain in her right index finger, which increases on exposure to cold. The following examination findings are seen before and after the removal of the nail plate. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Subungual hematoma"
      },
      {
        "id": 2,
        "text": "Herpetic whitlow"
      },
      {
        "id": 3,
        "text": "Subungual exostosis"
      },
      {
        "id": 4,
        "text": "Glomus tumor"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Option C: <strong>Subungual</strong> <strong>exostosis</strong> is a benign tumor that causes <strong>reddish</strong> onycholysis of the nail with variable <strong>pain, </strong>as seen below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/920709705b9642429ddbfa36f8d01ed1.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b0286993849e4ef8aa474236994bfaccx512x343.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9bc91c9e131f44df970f3fe9df9ab6e8x484x480.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e4c0e3c48f984c0396ea22bdfdeadfc9x264x263.PNG"
    ]
  },
  {
    "text": "Which of the following statements is false about nail-patella syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "It is an autosomal recessive condition."
      },
      {
        "id": 2,
        "text": "Nail dysplasia occurs with triangular lunula."
      },
      {
        "id": 3,
        "text": "Patella is small, irregular, or absent."
      },
      {
        "id": 4,
        "text": "Iliac horns are present."
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The following AP radiograph of the right iliac crest shows a bony exostosis or posterior iliac horn (white arrow), which is pathognomonic of NPS.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/00effc24fb2d44f3a9811d87c1200d85x416x409.JPEG",
      "https://cdn1.dailyrounds.org/uploads/70aadeefb07f40fb8fd37c94e0983413x512x512.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b50716ac0265460aa7964e0a960ea162x509x505.JPEG"
    ]
  },
  {
    "text": "An unkempt and restless woman is brought to the ER after a road accident. She claims that \u2018aliens are trying to kill her\u2019. She has a fractured wrist and the following findings are noted in her nails. What condition is this patient suffering from?",
    "choices": [
      {
        "id": 1,
        "text": "Darier's disease"
      },
      {
        "id": 2,
        "text": "Hailey Hailey disease"
      },
      {
        "id": 3,
        "text": "Lichen Planus"
      },
      {
        "id": 4,
        "text": "Psoriasis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The shown nail findings are characteristic of <strong>Darier's</strong> <strong>disease</strong>. They include:&nbsp;</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Longitudinal erythronychia</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Longitudinal leukonychia</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Distal V\u2010shaped nicks.</li>\n</ul>\n<p>Darier's disease or keratosis follicularis or dyskeratosis follicularis, is an <strong>autosomal dominant</strong> condition arising from mutations in the <strong>ATP2A2</strong> gene which affects the <strong>SERCA2</strong> calcium pump. It presents with greasy <strong>hyperkeratotic papules and plaques</strong> in seborrheic regions. <strong>Neuropsychiatric</strong> features such as depression, psychosis and mental retardation may also occur.</p>\n<p>Option B: <strong>Hailey-Hailey</strong> disease presents with longitudinal <strong>leukonychia</strong>.</p>\n<p>Option C: <strong>Lichen planus</strong> presents with <strong>dorsal pterygium</strong>.</p>\n<p>Option D: <strong>Psoriasis</strong> causes the pathognomonic <strong>oil drop sign</strong>. It is a yellow-red discoloration in the nail bed resembling a drop of oil.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e48848709213480b9acdcd003c186a12.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A nursing student goes to the OPD for review of acne. An oral antibiotic had been added to her regimen 3 weeks back. She asks the dermatologist about the strange appearance of her nails as shown below, though she has no pain. What is the cause?",
    "choices": [
      {
        "id": 1,
        "text": "Klebsiella infection"
      },
      {
        "id": 2,
        "text": "Minocycline intake"
      },
      {
        "id": 3,
        "text": "Onychomycosis"
      },
      {
        "id": 4,
        "text": "Pseudomonas  infection"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient has <strong>green nails</strong> or <strong>chloronychia</strong>, a painless condition caused by infection with <strong>Pseudomonas aeruginosa</strong>.&nbsp;</p>\n<p>Pseudomonas may colonize the nail following onycholysis (painless separation of the nail from bed) which occurs due to frequent <strong>wetting</strong> or wearing of <strong>gloves</strong> causing <strong>maceration</strong> and minor <strong>trauma</strong> due to long nails or manicures. The green color is due to <strong>pyoverdin</strong> and <strong>pyocyanin</strong>, produced by P. aeruginosa.&nbsp;</p>\n<p>Though it is <strong>harmless</strong> for the patients, it <strong>may spread</strong> to other <strong>immunosuppressed</strong> individuals. Hence, these patients should not work in hospitals, kitchens and other places where they are likely to spread the infection to others.</p>\n<p>Treatment is with fingertip bath in white vinegar, bleach, or topical gentamicin.</p>\n<p>Option A:&nbsp;<strong>Klebsiella</strong> colonization can cause <strong>greyish</strong> discoloration of nails.</p>\n<p>Option B: <strong>Minocycline</strong> is one of the most common antibiotics used by dermatologists due to its anti-inflammatory properties. It causes a <strong>bluish-grey</strong> discoloration of nails.</p>\n<p>Option C: <strong>Onychomycosis</strong> causes <strong>whitish-yellow</strong> discoloration and is painful in later stages.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8046bf92ceba4c17823713f419d3e835.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the probable diagnosis of this condition affecting hair?",
    "choices": [
      {
        "id": 1,
        "text": "Trichorhexis nodosa"
      },
      {
        "id": 2,
        "text": "Trichorexis invaginata"
      },
      {
        "id": 3,
        "text": "Trichothiodystrophy"
      },
      {
        "id": 4,
        "text": "Monilethrix"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option D: <strong>Monilethrix</strong>, seen in the image below, is characterized by <strong>beaded hair</strong> and is fragile at the constricted sites. It occurs as an isolated condition or can occur in <strong>Menkes</strong> disease.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/271c79dc72ec432c808ea2db9f703182.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b4122fff0680487bb4b1e5fa66c4f6a5x444x483.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b1c54dda60c54955a4012691ef7398e6x483x585.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/95bf059c2e064499bafc8b948dbb3c4dx603x600.JPEG"
    ]
  }
];
        let quizName = '05 Disorders Of Hair And Nails';
        let hierarchy = ["Marrow", "qBank", "Dermatology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>