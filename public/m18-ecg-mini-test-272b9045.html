<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M18 - Ecg Mini Test - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2017-18
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The following ECG depicts:",
    "choices": [
      {
        "id": 1,
        "text": "1st degree heart block"
      },
      {
        "id": 2,
        "text": "Pericarditis"
      },
      {
        "id": 3,
        "text": "Left ventricular hypertrophy"
      },
      {
        "id": 4,
        "text": "Anterior wall MI"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The ECG shows <strong>left ventricular hypertrophy</strong>.</p>\n<p><strong>ECG findings suggestive of LVH</strong></p>\n<ul>\n<li>S-V1 + R-V5/V6 &gt;=35</li>\n<li>R-aVL &gt; 12</li>\n<li>T wave inversion in all LV leads (Lead I, aVL, V5 and V6)</li>\n</ul>\n<p><strong>Causes of LVH</strong></p>\n<ul>\n<li>Hypertension (most common cause)</li>\n<li>Aortic stenosis</li>\n<li>Aortic regurgitation</li>\n<li>Mitral regurgitation</li>\n<li>Coarctation of the aorta</li>\n<li>Hypertrophic cardiomyopathy</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/57f46c1c63b94f1880b4b87aa6532317.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The given ECG is characteristic of:",
    "choices": [
      {
        "id": 1,
        "text": "Ischemic cardiomyopathy"
      },
      {
        "id": 2,
        "text": "Non-ischemic cardiomyopathy"
      },
      {
        "id": 3,
        "text": "Arrhythmogenic right ventricular cardiomyopathy"
      },
      {
        "id": 4,
        "text": "Hypertrophic cardiomyopathy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The ECG is characteristic of <strong>arrhythmogenic right ventricular cardiomyopathy.</strong></p>\n<p><strong>Arrhythmogenic right ventricular cardiomyopathy</strong></p>\n<ul>\n<li>The <strong>Epsilon wave</strong> (a small positive deflection buried in the end of the QRS complex) is the characteristic finding in ARVC.</li>\n<li><strong>T wave inversions</strong>&nbsp;in V1-3 is seen 85% of patients of ARVC.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cdac16478b4643bebd13238b1be70367.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 45year old male presents to the OPD with a h/o one episode of syncope. An ECG is taken to determine any cardiac cause for the syncope. What is the abnormality in the ECG:",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary embolism"
      },
      {
        "id": 2,
        "text": "Atrial fibrillation"
      },
      {
        "id": 3,
        "text": "Brugada syndrome"
      },
      {
        "id": 4,
        "text": "Right bundle branch block"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The ECG shows a <strong>right bundle branch block.</strong></p>\n<p><strong>ECG findings suggestive of RBBB</strong></p>\n<ul>\n<li><strong>RSR</strong>&rsquo; pattern in <strong>V1-3 (&lsquo;M-shaped&rsquo; QRS complex)</strong></li>\n<li><strong>Wide, slurred S wave</strong> in the lateral leads (I, aVL, V5-6)</li>\n<li>T wave inversion in the RV leads</li>\n<li>Broad QRS &gt; 120 ms</li>\n</ul>\n<p>Pneumonic for RBBB: <strong>M</strong>ARRO<strong>W</strong></p>\n<ul>\n<li><strong>M in V1</strong> and <strong>W in V6</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b13e10a5b1164b11bd1a0927edd47570.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5d60ecfa24994fa1aad787afb65ddc5dx233x198.PNG"
    ]
  },
  {
    "text": "Treatment of choice for the condition depicted in the ECG is:",
    "choices": [
      {
        "id": 1,
        "text": "Adenosine"
      },
      {
        "id": 2,
        "text": "Digoxin"
      },
      {
        "id": 3,
        "text": "Cardiac pacemaker"
      },
      {
        "id": 4,
        "text": "Radiofrequency ablation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The ECG shows <strong>Wolff-Parkinson-White syndrome</strong> and the treatment of choice for WPW is <strong>radiofrequency ablation</strong>.</p>\n<p><strong>ECG findings in WPW</strong></p>\n<ul>\n<li><strong>Delta wave</strong></li>\n<li>PR interval &lt; 0.10s</li>\n<li>QRS&gt; 0.12s</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9b51e8def1884fffbd1e2d6bb3a95ccf.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a55a9b68f7864a948d0d129ef0882e77x248x188.JPEG"
    ]
  },
  {
    "text": "Cardiac device of choice for the given condition is:",
    "choices": [
      {
        "id": 1,
        "text": "Implantable cardioverter defibrillator"
      },
      {
        "id": 2,
        "text": "Implantable cardiac loop recorder"
      },
      {
        "id": 3,
        "text": "Biventricular pacemaker"
      },
      {
        "id": 4,
        "text": "Left ventricular assist device"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The ECG shows <strong>Brugada syndrome</strong> and the device of choice is an <strong>implantable cardioverter defibrillator.</strong></p>\n<p><strong>Brugada Syndrome</strong></p>\n<ul>\n<li><strong>Sodium channelopathy</strong></li>\n<li>High risk of arrhythmias</li>\n<li>Sudden cardiac death</li>\n<li><strong>ICD is the device of choice</strong></li>\n</ul>\n<p><strong>ECG in Brugada Syndrome:</strong></p>\n<ul>\n<li><strong>Coved ST segment elevation</strong> of <strong>V1-V3</strong> followed by a negative T wave is the only ECG abnormality that is&nbsp;potentially&nbsp;diagnostic. This has been referred to as&nbsp;<strong>Brugada sign</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fac29cc429d64bbe824494013a31f397.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/31f668a5529648b4abd98d71ba4c93a4x800x973.PNG"
    ]
  },
  {
    "text": "Helen is a 78-year-old woman who is a smoker for the past 30 years and has a history of angina. She presents to your accident and emergency (A&E) department with chest pain worse on inspiration and shortness of breath. Her ECG shows signs of:",
    "choices": [
      {
        "id": 1,
        "text": "Premature atrial contractions"
      },
      {
        "id": 2,
        "text": "Pulmonary embolism"
      },
      {
        "id": 3,
        "text": "AV nodal re-entrant tachycardia"
      },
      {
        "id": 4,
        "text": "Atrial flutter"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>The ECG changes are classic of <strong>pulmonary embolism</strong> showing <strong>S1Q3T3.</strong></li>\n</ul>\n<p><strong>ECG findings in pulmonary embolism</strong></p>\n<ul>\n<li>Sinus tachycardia</li>\n<li>Complete or incomplete RBBB (seen in the given ECG also)</li>\n<li><strong>S1Q3T3: deep S wave in lead I, Q wave in III, inverted T wave in III</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/03361c938c3b406693a6640cf9c58811.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/b9bee1a209c34343b68cd2bbf5664b43x357x171.PNG"
    ]
  },
  {
    "text": "Calculate the rate of atrial contraction from the given ECG strip:",
    "choices": [
      {
        "id": 1,
        "text": "265/min"
      },
      {
        "id": 2,
        "text": "375/min"
      },
      {
        "id": 3,
        "text": "495/min"
      },
      {
        "id": 4,
        "text": "545/min"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The rate of <strong>atrial contraction</strong> is <strong>375/min</strong>.</p>\n<p><strong>Atril Flutter</strong></p>\n<p>The ECG depicts <strong>atrial flutter with a 4:1 block</strong>.</p>\n<p><strong>Calculation</strong>:</p>\n<ul>\n<li>No. of large boxes between two R waves = 3</li>\n<li>Hence, <strong>ventricular rate = 300/3 = 100/min</strong></li>\n<li>As it is a 4:1 block, for every 4 atrial contractions there is 1 ventricular contraction</li>\n<li>Hence, <strong>atrial rate = 100 x 4 = 400/min</strong></li>\n<li><strong>Hence, nearest correct answer is 375/min</strong></li>\n</ul>\n<p><strong>Alternative calculation:</strong></p>\n<ul>\n<li>No. of small boxes between two R waves = 16</li>\n<li>Hence, <strong>ventricular rate = 1500/16 = 94</strong></li>\n<li>As it is a 4:1 block, for every 4 atrial contractions there is 1 ventricular contraction.</li>\n<li>Hence, <strong>atrial rate = 94 x 4 = 376/min</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/65ad7b0034404fd4aa9ffdac077d2c31.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs can precipitate this condition:",
    "choices": [
      {
        "id": 1,
        "text": "Propranolol"
      },
      {
        "id": 2,
        "text": "Digoxin"
      },
      {
        "id": 3,
        "text": "Amiodarone"
      },
      {
        "id": 4,
        "text": "Adenosine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The ECG depicts <strong>torsades de pointes</strong> which can be precipitated by <strong>amiodarone</strong>.</p>\n<p><strong>Torsades de Pointes</strong></p>\n<ul>\n<li>Torsades de pointes is a specific form of polymorphic ventricular tachycardia occurring in the context of QT prolongation.</li>\n<li>It has a characteristic morphology in which the QRS complexes <strong>&ldquo;twist&rdquo; around the isoelectric line.</strong></li>\n</ul>\n<p><strong>DRUGS THAT PROLONG Q-T INTERVAL/can precipitate TORSADES DE POINTES</strong></p>\n<p>&nbsp;</p>\n<table>\n<tbody>\n<tr>\n<td><strong>ANTI- ARRYTHMICS</strong></td>\n<td>\n<ul>\n<li>Quinidine</li>\n<li>Procainamide</li>\n<li>Disopyramide</li>\n<li>Propafenone</li>\n<li><strong>Amiodarone</strong></li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>ANTI-MALARIALS</strong></td>\n<td>\n<ul>\n<li>Quinine</li>\n<li>Mefloquine</li>\n<li>Artemisinin</li>\n<li>Halofantrine</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>ANTI-BACTERIALS</strong></td>\n<td>\n<ul>\n<li>Sparfloxacin</li>\n<li>Moxifloxacin</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>ANTI-HISTAMINICS</strong></td>\n<td>\n<ul>\n<li>Terfenadine</li>\n<li>Astemizole</li>\n<li>Ebastine</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>ANTI-DEPRESSANTS</strong></td>\n<td>\n<ul>\n<li>Amitriptyline&amp; other tricyclics</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>ANTI-PSYCHOTICS</strong></td>\n<td>\n<ul>\n<li>Thioridazine</li>\n<li>Pimozide</li>\n<li>Aripiprazole</li>\n<li>Ziprasidone</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>PROKINETIC</strong></td>\n<td>\n<ul>\n<li><strong>Cisapride</strong></li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/76b669d9f15b432abb50fadd31d2eea1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The abnormality shown in the given ECG is:",
    "choices": [
      {
        "id": 1,
        "text": "Delta wave"
      },
      {
        "id": 2,
        "text": "Osborn wave"
      },
      {
        "id": 3,
        "text": "Tenting of T waves"
      },
      {
        "id": 4,
        "text": "Epsilon wave"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The ECG depicts an <strong>Osborn wave</strong>.</p>\n<p>Marked systemic <strong>hypothermia</strong> is associated with a distinctive <strong>convex &lsquo;hump&rsquo; at the J point (Osborn wave)</strong> due to altered ventricular action potential characteristics.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/53550733611e44098326e7298c3898b0.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "From the given ECG, comment on the serum potassium levels:",
    "choices": [
      {
        "id": 1,
        "text": "Normal"
      },
      {
        "id": 2,
        "text": "Mildly elevated"
      },
      {
        "id": 3,
        "text": "Moderately elevated"
      },
      {
        "id": 4,
        "text": "Severely elevated"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>A <strong>sine-wave pattern indicates severe hyperkalemia</strong>.</li>\n<li>The earliest ECG change with hyperkalemia is usually <strong>peaking (&ldquo;tenting&rdquo;) of the T waves</strong>.</li>\n<li>With further increases in the serum potassium concentration, the <strong>QRS complexes widen</strong>, <strong>the P waves decrease in amplitude</strong> and may disappear, and finally a <strong>sine-wave pattern</strong> leads to asystole unless emergency therapy is given</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/189bb28aae2d429fb6bf81ec881a3600.PNG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/d7d5dc9e7d2c4853bd380b561609d7f3x542x256.PNG"
    ]
  },
  {
    "text": "The given ECG is the initial ECG of a 48 year old male presenting to the A&E department with chest pain. The doctor on call decides to administer alteplase to the patient and takes a repeat ECG. The classic triad of findings in the repeat ECG will include all except:",
    "choices": [
      {
        "id": 1,
        "text": "Low QRS voltages"
      },
      {
        "id": 2,
        "text": "Sinus tachycardia"
      },
      {
        "id": 3,
        "text": "Prolonged QT interval"
      },
      {
        "id": 4,
        "text": "Electrical alternans"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li>The ECG given (initial ECG) is that of <strong>acute pericarditis</strong> as evident by <strong>diffuse ST elevations without reciprocal change</strong>.</li>\n<li>Inadvertent administration of <strong>thrombolytics (alteplase) in acute pericarditis</strong> (due to misdiagnosis as MI) may produce <strong>cardiac tamponade</strong>.</li>\n<li>The <strong>classic triad of findings for pericardial effusion with cardiac tamponade </strong>are:\n<ol>\n<li><strong>Sinus tachycardia</strong></li>\n<li><strong>Low QRS voltages</strong></li>\n<li><strong>Electrical alternans</strong></li>\n</ol>\n</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bf9e47bf3fe64a30872808b2ac57cb9c.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/59774b492e924818a60755bb9b697f75x1275x729.PNG"
    ]
  },
  {
    "text": "Diagnose the condition:",
    "choices": [
      {
        "id": 1,
        "text": "Accelerated idioventricular rhythm"
      },
      {
        "id": 2,
        "text": "Atrial flutter"
      },
      {
        "id": 3,
        "text": "Left bundle branch block"
      },
      {
        "id": 4,
        "text": "Ventricular fibrillation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The ECG shows a <strong>left bundle branch block</strong></p>\n<p><strong>ECG findings suggestive of LBBB</strong></p>\n<ul>\n<li>QRS duration of&nbsp;&gt; 120 ms</li>\n<li>Dominant S wave in V1</li>\n<li>Broad monophasic R wave in lateral leads (I, aVL, V5-V6)</li>\n</ul>\n<p>Mneumonic: <strong>V</strong>ILLIA<strong>M/ W</strong>ILLIA<strong>M</strong></p>\n<ul>\n<li><strong>V/W IN V1 and M in V6</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f4f55d21898248a7b10b4d348852eaaf.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f2527f39afc34535911e7e61f7ee754bx352x567.JPEG"
    ]
  },
  {
    "text": "Which of the following drugs will you administer to a patient having the following ECG:",
    "choices": [
      {
        "id": 1,
        "text": "Digoxin"
      },
      {
        "id": 2,
        "text": "KCl"
      },
      {
        "id": 3,
        "text": "Adenosine"
      },
      {
        "id": 4,
        "text": "Insulin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The ECG depicts <strong>severe hypokalemia </strong>with <strong>prominent U waves in Leads II, III, and V4&ndash;V6</strong> and ventricular repolarization prolongation. The treatment <strong>of hypokalemia</strong> is to replenish potassium by administering <strong>oral/IV KCl</strong>.</p>\n<p>Insulin is used to treated hyperkalemia.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4300ee6ea7884c148b9a39d8385eb9de.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The striking T wave inversions in the mid precordial leads of the given ECG suggest:",
    "choices": [
      {
        "id": 1,
        "text": "Yamaguchi syndrome"
      },
      {
        "id": 2,
        "text": "Kounis syndrome"
      },
      {
        "id": 3,
        "text": "Takotsubo syndrome"
      },
      {
        "id": 4,
        "text": "Anderson-Tawil syndrome"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This ECG shows <strong>LVH with striking T-wave inversions in the mid-precordial leads</strong> typical of <strong>apical HCM</strong> also known as <strong>Yamaguchi syndrome.</strong></p>\n<p><strong>Apical HCM</strong></p>\n<ul>\n<li>This relatively uncommon form of HCM is seen most frequently in Japanese patients (13-25% of all HCM cases in Japan).</li>\n<li>The classic ECG finding in apical HCM is&nbsp;<strong>giant T-wave inversion</strong><strong>&nbsp;in the precordial leads.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/301978b9fd0a486298d606266cbc43cf.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the diagnosis based on the given ECG?",
    "choices": [
      {
        "id": 1,
        "text": "Atrial fibrillation"
      },
      {
        "id": 2,
        "text": "Second degree AV block"
      },
      {
        "id": 3,
        "text": "First degree AV block"
      },
      {
        "id": 4,
        "text": "Complete heart block"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given strip of ECG shows a <strong>Wenckebach/Mobitz type I block, </strong>a type of<strong>&nbsp;second-degree&nbsp;AV block.</strong></p>\n<p>In this type of heart block, there is a <strong>progressive lengthening</strong> of the <strong>PR interval</strong> with each beat, and then there is a loss of conduction which manifests as a <strong>dropped beat</strong>. This is characterized by a P wave <strong>without a QRS complex.</strong> Then the same pattern <strong>repeats</strong>.&nbsp;The <strong>PR interval immediately after</strong> a dropped wave is&nbsp;<strong>shorter</strong> than the PR interval immediately before it.</p>\n<p><strong>Types of Heart Block</strong></p>\n<p><strong>1. First-degree Heart Block: </strong>Prolonged <strong>PR interval, &gt; 0.2 s</strong>, RR interval equal and constant</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c607552e39b5470eb3aacb0ee7ee30a1.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7d186409a1464c6d9d2db90d48ac7485x800x179.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/545c7590b3204dd9b810e973aba569a7x765x510.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/552b2cd8b6444313a5744f4e4d9ffe58x765x510.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bf8311f945ff43bbb2242fe6b5177799x800x180.PNG"
    ]
  },
  {
    "text": "Which of the following drugs produces an inverted tick sign in the ECG:",
    "choices": [
      {
        "id": 1,
        "text": "Adenosine"
      },
      {
        "id": 2,
        "text": "Propranolol"
      },
      {
        "id": 3,
        "text": "Digoxin"
      },
      {
        "id": 4,
        "text": "Verapamil"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The typical <strong>inverted tick sign</strong>&nbsp;is seen due to <strong>effect of digoxin</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ae08f7d2466c4303b5c602bead8ae35bx670x321.JPEG"
    ]
  },
  {
    "text": "Which of the following conditions is associated with the abnormality depicted in the given ECG?",
    "choices": [
      {
        "id": 1,
        "text": "Cardiac tamponade"
      },
      {
        "id": 2,
        "text": "Chronic obstructive pulmonary disease"
      },
      {
        "id": 3,
        "text": "Type-1 atrioventricular block"
      },
      {
        "id": 4,
        "text": "Dextrocardia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given ECG shows inverted P waves, negative QRS in lead I, and reversal of normal r wave progression. The condition associated with these findings is <strong>dextrocardia</strong>.\u00a0</p>\n<p>Dextrocardia is the<strong> </strong>abnormal position of the heart on the right side of the chest or in the midline. It may be seen as an isolated condition\u00a0or as a part of\u00a0<strong>situs inversus</strong>, where the other organs are also inverted in position. Situs inversus is associated with <strong>Kartagener's syndrome </strong>(a triad of situs inversus, chronic sinusitis, and bronchiectasis).\u00a0</p>\n<p>Findings suggestive of dextrocardia:</p>\n<ul>\n<li><strong>Inverted P waves</strong> in Lead I and aVL</li>\n<li><strong>Negative QRS complex</strong> and T wave in Lead I</li>\n<li>Lead I: inversion of all complexes, aka \u2018global negativity\u2019 i.e. inverted P wave, negative QRS, inverted T wave</li>\n<li><strong>Reversal of normal r-wave progression</strong> across the precordium</li>\n</ul>\n<p>Most patients are <strong>asymptomatic</strong>. Some may present with varying symptoms due to other coexisting congenital diseases.\u00a0</p>\n<p>Other options:</p>\n<p>Option A -\u00a0Cardiac tamponade would present with <strong>reduced amplitude </strong>of the<strong> QRS</strong> complexes and <strong>electrical alternans</strong> on the ECG.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/aaafc8e65b7b4c888043ed6bf25503ee.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0b302fa75a094caa993fab04263ec02dx1280x615.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c1a5170536d74c6eaf5467bbbb124efcx765x417.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b64a2f12a3e9488199dc6a12761aa4e1x1280x609.JPEG"
    ]
  },
  {
    "text": "Occlusion of which of the following arteries produces the following ECG changes:",
    "choices": [
      {
        "id": 1,
        "text": "Right coronary artery"
      },
      {
        "id": 2,
        "text": "Left circumflex coronary artery"
      },
      {
        "id": 3,
        "text": "Left coronary artery"
      },
      {
        "id": 4,
        "text": "Left anterior descending artery"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The ECG shows an <strong>inferior wall MI involving the right coronary artery</strong>.</p>\n<p><strong>Findings Suggestive of IWMI</strong></p>\n<ul>\n<li>ST elevation in leads II, III and aVF</li>\n<li>Reciprocal ST depression in aVL and lead I</li>\n</ul>\n<p><strong>Inferior wall MI may be due to occlusion of RCA or Left circumflex coronary artery</strong></p>\n<p><strong>RCA occlusion</strong>&nbsp;is suggested by:</p>\n<ul>\n<li><strong>ST elevation in lead III &gt; lead II</strong></li>\n<li>Presence of reciprocal ST depression in lead I</li>\n<li>Signs of&nbsp;right ventricular infarction:&nbsp;STE in V1 and V4R</li>\n</ul>\n<p><strong>Left circumflex coronary artery occlusion</strong>&nbsp;is suggested by:</p>\n<ul>\n<li>ST elevation in lead II = lead III</li>\n<li>Absence of reciprocal ST depression in lead I</li>\n<li>Signs of lateral infarction: ST elevation in the lateral leads I and aVL or V5-6</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/744e95f5ba334a6eab94ac47993e6d99.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 45 year old male patient with COPD presents to the emergency department with an acute exacerbation. An ECG was taken to check for any cardiac abnormality. All the following measures are useful in treating his present condition except:",
    "choices": [
      {
        "id": 1,
        "text": "Prednisolone"
      },
      {
        "id": 2,
        "text": "Verapamil"
      },
      {
        "id": 3,
        "text": "Amiodarone"
      },
      {
        "id": 4,
        "text": "Electrical cardioversion"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The ECG depicts <strong>multifocal atrial tachycardia</strong> and <strong>electrical cardioversion is not useful in this condition.</strong></p>\n<p><strong>Multifocal Atrial Tachycardia</strong></p>\n<ul>\n<li>Multifocal AT (MAT) is characterized by at least <strong>3 distinct P-wave morphologies</strong> (as denoted by the arrows in the image) with rates typically between 100 and 150 beats/min.</li>\n<li>Unlike atrial fibrillation, there are clear isoelectric intervals between P waves.</li>\n<li>It is usually encountered in patients with <strong>chronic pulmonary disease and acute illness.</strong></li>\n</ul>\n<p><strong>Treatment of Mat </strong></p>\n<ul>\n<li>Therapy for MAT is directed at treating the underlying disease and correcting any metabolic abnormalities. In this case the underlying disease is COPD which can be treated with <strong>steroids.</strong></li>\n<li><strong>Electrical cardioversion has no effect</strong>.</li>\n<li>The calcium channel blockers <strong>verapamil or diltiazem may slow the atrial and ventricular rate</strong>.&nbsp;</li>\n<li><strong>MAT may respond to amiodarone</strong>, but long-term therapy with this agent is usually avoided due to its toxicities, particularly pulmonary fibrosis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bfeb232179334a50b5df6b7224930a97.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Regarding the given ECG changes, all the following statements are true except:",
    "choices": [
      {
        "id": 1,
        "text": "Associated with high grade stenosis of left circumflex coronary artery"
      },
      {
        "id": 2,
        "text": "Also known as Wellen\u2019s syndrome"
      },
      {
        "id": 3,
        "text": "Patients are at a high risk for extensive anterior wall MI"
      },
      {
        "id": 4,
        "text": "Treatment is usually invasive therapy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li><strong>Wellens&rsquo; syndrome</strong> is a pattern of&nbsp;<strong>&nbsp;biphasic T waves in V2-3</strong> <strong>(may extend to V1-6) or deeply inverted T waves</strong>, which&nbsp;is highly specific for a&nbsp;<strong>critical stenosis of the left anterior descending artery</strong>&nbsp;(LAD).</li>\n<li>Patients may be pain free by the time the ECG is taken and have normally or minimally elevated cardiac enzymes; however, they are at&nbsp;extremely&nbsp;<strong>high risk for extensive anterior wall MI</strong>&nbsp;within the next few days to weeks.</li>\n<li>Due to the critical LAD stenosis, <strong>these patients usually require invasive therapy</strong>, do poorly with medical management and may suffer MI or cardiac arrest if inappropriately stress tested.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2a805ab3d89242838751f13f176e0aad.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old female patient is brought to the emergency department in a state of unconsciousness. Her BP is 70/50 mm of Hg. Her ECG is shown below. What is the next best step in the management of her condition?",
    "choices": [
      {
        "id": 1,
        "text": "IV verapamil"
      },
      {
        "id": 2,
        "text": "IV adenosine"
      },
      {
        "id": 3,
        "text": "Carotid massage"
      },
      {
        "id": 4,
        "text": "DC cardioversion"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario describes an <strong>unconscious patient</strong>, who is <strong>hemodynamically unstable</strong> (systolic BP &lt;90 mmHg or mean arterial pressure &lt;65 mmHg). The ECG shows a <strong>narrow QRS complex tachycardia</strong> (heart rate of 188 BPM) with <strong>regular RR interval</strong> and&nbsp;<strong>absent</strong><strong>&nbsp;P waves</strong>, characteristic of <strong>paroxysmal supraventricular tachycardia</strong> (PSVT). The next step in management is <strong>QRS-synchronized DC cardioversion.</strong></p>\n<p>Shown below is the algorithm for the management of supraventricular tachycardia:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6edcf84b58e7436c8d29d57b32d7c111.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bc8abf258fe54dd0a7ab09a274501279x1280x1845.JPEG"
    ]
  },
  {
    "text": "A 70-year-old male patient who presented with chest pain was diagnosed as a c/o acute STEMI and given thrombolytics. Post-thrombolysis an ECG is taken. What rhythm does the ECG show?",
    "choices": [
      {
        "id": 1,
        "text": "Accelerated junctional rhythm"
      },
      {
        "id": 2,
        "text": "Accelerated idioventricular rhythm"
      },
      {
        "id": 3,
        "text": "Idioventricular rhythm"
      },
      {
        "id": 4,
        "text": "Junctional escape rhythm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The ECG shows <strong>accelerated idioventricular rhythm (AIVR)</strong> with <strong>rate 60 bpm</strong>, <strong>QRS complex &gt; 120ms</strong>, <strong>fusion and capture beats present.&nbsp;</strong>AIVR is classically seen in the <strong>reperfusion phase of an acute STEMI, e.g.&nbsp;post thrombolysis</strong></p>\n<p>ECG Features of<strong> Accelerated Idioventricular Rhythm</strong></p>\n<ul>\n<li>Regular rhythm</li>\n<li><strong>Rate 40-100 bpm</strong></li>\n<li>Three or more ventricular complexes</li>\n<li><strong>QRS complexes &gt;120ms</strong></li>\n<li><strong>Fusion and capture beats</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0f5bf95eb20a4fecbda95e2e4dbda26f.PNG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/7b49cc2459614a3fb765e0771cfd1ea6x337x183.PNG"
    ]
  },
  {
    "text": "Identify the arrhythmia depicted by the given ECG strip:",
    "choices": [
      {
        "id": 1,
        "text": "Ventricular tachycardia"
      },
      {
        "id": 2,
        "text": "Ventricular fibrillation"
      },
      {
        "id": 3,
        "text": "Atrial fibrillation"
      },
      {
        "id": 4,
        "text": "Atrial flutter"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The ECG depicts<strong> ventricular fibrillation.\u00a0</strong>It has the following characteristics:</p>\n<ul>\n<li>Chaotic irregular deflections of varying amplitude</li>\n<li>No identifiable QRS complexes, ST segments, or T waves are visible</li>\n</ul>\n<p>Other options:</p>\n<p>Option 1- Ventricular tachycardia:\u00a0The ECG features include:</p>\n<ul style=\"list-style-type: disc;\">\n<li>Wide QRS complex with abnormal morphology</li>\n<li>Absence\u00a0of the P waves</li>\n<li>Rate &gt;100/min</li>\n</ul>\n<p>Option 3- Atrial fibrillation: The ECG features include:</p>\n<ul>\n<li>Narrow QRS complexes</li>\n<li>RR intervals are irregular</li>\n<li>No distinct p waves seen</li>\n</ul>\n<p>Option 4- Atrial flutter: The ECG features include:</p>\n<ul>\n<li>Narrow QRS complexes</li>\n<li>RR intervals are regular\u00a0</li>\n<li>Normal P waves are replaced by <strong>sawtooth-shaped</strong> <strong>waves</strong>\u00a0known as flutter waves.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://daily-rounds-staging.s3.amazonaws.com/uploads/04c31ccbac544890acc7a85e7f1b6447.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "This phenomenon seen in atrial fibrillation is known as:",
    "choices": [
      {
        "id": 1,
        "text": "Ashman phenomenon"
      },
      {
        "id": 2,
        "text": "Premature ventricular complex"
      },
      {
        "id": 3,
        "text": "De Winter\u2019s sign"
      },
      {
        "id": 4,
        "text": "McConnell\u2019s phenomenon"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The ECG depicts <strong>Ashman phenomenon</strong>.</p>\n<ul>\n<li><strong>Ashman phenomenon</strong> occurs when you get two beats with a <strong>long RR interval</strong> followed by a <strong>beat with a short RR interval</strong>.&nbsp;In this situation, the beat with the short RR interval is <strong>aberrantly conducted</strong> - typically with a RBBB morphology.</li>\n<li>The Ashman phenomenon is <strong>typically</strong> seen in the setting of <strong>atrial fibrillation</strong>, where the RR interval varies from beat to beat.</li>\n<li>The significance of the Ashman phenomenon is that the broad QRS complexes&nbsp;are <strong>commonly mistaken for ventricular ectopic/PVCs</strong>. However, they're not ectopic beats. Instead, these broad QRS complexes represent the aberrant conduction of a supraventricular beat.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ff2d250c6f2546dfaeae6d40a3a6b9f7.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the arrhythmia depicted by the ECG strip:",
    "choices": [
      {
        "id": 1,
        "text": "Atrial flutter"
      },
      {
        "id": 2,
        "text": "Atrial fibrillation"
      },
      {
        "id": 3,
        "text": "Ventricular flutter"
      },
      {
        "id": 4,
        "text": "Ventricular fibrillation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows a <strong>Ventricular Flutter</strong></p>\n<p>Identification points</p>\n<ul>\n<li><strong>Continuous Sine Wave</strong></li>\n<li>No identifiable P waves, QRS complexes, or T waves</li>\n<li>Rate usually &gt; 200 beats / min</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/bc425da475764cbbb7d5f697aa359789.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the abnormality in the given ECG:",
    "choices": [
      {
        "id": 1,
        "text": "PSVT"
      },
      {
        "id": 2,
        "text": "Atrial fibrillation"
      },
      {
        "id": 3,
        "text": "Atrial flutter"
      },
      {
        "id": 4,
        "text": "Ventricular flutter"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The ECG shows <strong>atrial flutter</strong>.</p>\n<p><strong>Atrial Flutter</strong></p>\n<ul>\n<li>Narrow complex tachycardia</li>\n<li>Regular atrial activity ranges from 150 to 300 bpm</li>\n<li><strong>Flutter waves (&ldquo;saw-tooth&rdquo; pattern)</strong> best seen in leads II, III, aVF</li>\n<li>Loss of the&nbsp;isoelectric baseline</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dc4237c78b634e529c1211ccb9cf3c9b.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The following morphology of P wave is normally seen in which of the following leads",
    "choices": [
      {
        "id": 1,
        "text": "Lead 1"
      },
      {
        "id": 2,
        "text": "Lead 2"
      },
      {
        "id": 3,
        "text": "Lead V1"
      },
      {
        "id": 4,
        "text": "Lead aVR"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>P wave is normally biphasic in Lead V1.</p>\n<p>The morphology of P wave in the leads is</p>\n<ul>\n<li>Lead 1 &ndash; Positive</li>\n<li>Lead 2 &ndash; Positive</li>\n<li>Lead 3 &ndash; Positive</li>\n<li>Lead aVR &ndash; Negative</li>\n<li>Lead aVF &ndash; Positive</li>\n<li><strong>Lead V1 - Biphasic</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/59073d677bc34a5cbbf0d1311f6f773c.PNG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/1b2443359c864ebeaf1920916c3e1395x337x269.PNG"
    ]
  },
  {
    "text": "Identify the rhythm abnormality in the ECG strip:",
    "choices": [
      {
        "id": 1,
        "text": "Torsades de Pointes"
      },
      {
        "id": 2,
        "text": "Monomorphic VT"
      },
      {
        "id": 3,
        "text": "Ventricular fibrillation"
      },
      {
        "id": 4,
        "text": "Premature ventricular complex"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The ECG depicts <strong>monomorphic VT</strong>.</p>\n<p><strong>Monomorphic VT</strong> has the <strong>same QRS complex from beat to beat</strong>, indicating that the activation sequence is the same from beat to beat and that each beat likely originates from the same source. Other features include:</p>\n<ul>\n<li>Rapid heart rate (&gt; 100 bpm)</li>\n<li>Broad QRS complexes (&gt; 120 ms)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/474be9b5c3f4418d87b4d865260b24f4.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2b09e2105f644fd3bf217bde2a9c3612x1280x1424.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d3ff2eb902cb471687a410ff616ea5b5x1279x654.JPEG"
    ]
  },
  {
    "text": "The following ECG depicts which of the following conditions:",
    "choices": [
      {
        "id": 1,
        "text": "PSVT"
      },
      {
        "id": 2,
        "text": "Ventricular bigeminy"
      },
      {
        "id": 3,
        "text": "P pulmonale"
      },
      {
        "id": 4,
        "text": "Re-entrant AF"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The ECG depicts <strong>ventricular bigeminy</strong></p>\n<p><strong>Premature Ventricular Complex</strong></p>\n<p>PVCs have the following features:</p>\n<ul>\n<li>Broad QRS complex&nbsp;(&ge;&nbsp;120 ms) with abnormal morphology</li>\n<li>Premature&nbsp;&mdash; i.e. occurs earlier than would be expected for the next sinus impulse</li>\n<li>Discordant&nbsp;ST segment and T wave changes</li>\n<li>Usually followed by a full&nbsp;compensatory pause</li>\n</ul>\n<p>PVCs often occur in repeating patterns:</p>\n<ul>\n<li><strong>Bigeminy: every other beat is a PVC</strong></li>\n<li>Trigeminy: every 3<sup>rd</sup> beat is a PVC</li>\n<li>Quadrigeminy: every 4<sup>th</sup> beat is a PVC</li>\n<li>Couplet: 2 consecutive PVCs</li>\n<li>Triplet: 3 consecutive PVCs</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/93d5ebf3f9394e1f9bb981763a436d4a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0dcadfe018d44451a2dc482e13aedb93x1106x623.JPEG"
    ]
  },
  {
    "text": "The true statement regarding the given ECG strip is:",
    "choices": [
      {
        "id": 1,
        "text": "Depicts polymorphic VT"
      },
      {
        "id": 2,
        "text": "Josephson\u2019s sign is positive"
      },
      {
        "id": 3,
        "text": "Brugada\u2019s sign is positive"
      },
      {
        "id": 4,
        "text": "Both b and c"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>The ECG depicts <strong>monomorphic VT</strong> as the QRS complex is same from beat to beat.</li>\n<li><strong>Josephson&rsquo;s and Brugada&rsquo;s sign both are positive</strong></li>\n</ul>\n<p><strong>Features suggestive of VT</strong></p>\n<ul>\n<li><strong>Brugada&rsquo;s sign: </strong>The distance from the onset of the QRS complex to the nadir of the S-wave is &gt; 100ms</li>\n<li><strong>Josephson&rsquo;s sign</strong>: Notching near the nadir of the S-wave</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e4786c361217445492b6d502ee949262.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/ae8a0489200f41b0b7a30cda20527266x347x197.PNG"
    ]
  },
  {
    "text": "To calculate the corrected QT interval, QT interval is divided by \u221aX, where X is:",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "3"
      },
      {
        "id": 4,
        "text": "4"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>A rate-related/<strong>corrected QT interval, QTc</strong>, can be calculated as <strong>QT/&radic;RR</strong> and normally is &lt;=0.44 s.</li>\n</ul>\n<p style=\"padding-left: 30px;\"><strong>1: RR interval</strong></p>\n<p style=\"padding-left: 30px;\">2: PR interval</p>\n<p style=\"padding-left: 30px;\">3: QRS interval</p>\n<p style=\"padding-left: 30px;\">4: QT interval</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b382146c87974de2a6e87b7e8d9aec71.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What does the following ECG depict:",
    "choices": [
      {
        "id": 1,
        "text": "Hyperkalemia"
      },
      {
        "id": 2,
        "text": "De Winter\u2019s T waves"
      },
      {
        "id": 3,
        "text": "Digoxin toxicity"
      },
      {
        "id": 4,
        "text": "Ventricular ectopic"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>The following ECG depicts <strong>De Winter&rsquo;s T waves</strong>. There is no ST elevation in V2, but there is a hyperacute T-wave. &nbsp;This is a de Winter's T-wave and diagnostic of near occlusion of the LAD. &nbsp;V3 also has ST depression with a hyperacute T-wave very suggestive of de Winter's T-waves.</li>\n<li>The de Winter ECG pattern is an&nbsp;<strong>anterior STEMI equivalent</strong>&nbsp;that presents&nbsp;<strong>without&nbsp;</strong>obvious ST segment elevation.</li>\n</ul>\n<p><strong>Diagnostic Criteria</strong></p>\n<ul>\n<li>Tall, prominent, symmetric T waves in the precordial leads</li>\n<li>Upsloping ST segment depression &gt;1mm at the J-point in the precordial leads</li>\n<li>Absence of ST elevation in the precordial leads</li>\n<li>ST segment elevation (0.5mm-1mm) in aVR</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/701a957fce53414ab18b691eeb943acd.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The marked segment of the ECG corresponds to which phase of cardiac action potential:",
    "choices": [
      {
        "id": 1,
        "text": "Phase 0"
      },
      {
        "id": 2,
        "text": "Phase 1"
      },
      {
        "id": 3,
        "text": "Phase 2"
      },
      {
        "id": 4,
        "text": "Phase 3"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The marked part is the <strong>ST segment</strong> which corresponds to <strong>phase 2 </strong>of the cardiac action potential.</p>\n<p><strong>Cardiac Action Potential and The ECG</strong></p>\n<ul>\n<li>The rapid upstroke (phase 0) of the action potential is representative of the onset of QRS.\u00a0</li>\n<li>The plateau (phase 2) corresponds to the isoelectric ST segment.</li>\n<li>Active repolarization (phase 3) corresponds to the T wave.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b3851a1c9e0748ac8086e50eb683729d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eb3a558f149a48a6ae1eaa9cff2daaeax1280x1244.JPEG"
    ]
  },
  {
    "text": "Identify the abnormality in the given ECG:",
    "choices": [
      {
        "id": 1,
        "text": "Ventricular trigeminy"
      },
      {
        "id": 2,
        "text": "Atrial premature complex"
      },
      {
        "id": 3,
        "text": "Mobitz type 2 block"
      },
      {
        "id": 4,
        "text": "Electrical alternans"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given strip of ECG shows a <strong>Mobitz type 2 block (2<sup>nd</sup> degree heart block)</strong></p>\n<p><strong>Mobitz type 2: fixed PR interval, missed QRS</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c024c7f81f2a42c781c173ab25a64844.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7241017192ad472bad2774347a74fa72x800x145.JPEG"
    ]
  },
  {
    "text": "Identify the abnormality in the given ECG:",
    "choices": [
      {
        "id": 1,
        "text": "ST elevation"
      },
      {
        "id": 2,
        "text": "P pulmonale"
      },
      {
        "id": 3,
        "text": "Prolonged PR interval"
      },
      {
        "id": 4,
        "text": "None"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>The ECG shows <strong>no abnormality</strong>.</li>\n<li>Sinus rhythm is present with a heart rate of 75 beats per minute.</li>\n<li>PR interval: 0.16 s</li>\n<li>QRS interval (duration): 0.08</li>\n<li>QT interval: 0.36 s</li>\n<li>QTc: 0.40 s</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f847eca536964e45934547b5d79d768c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 26-year-old athlete comes for a routine examination. He has no symptoms. The ECG is as shown below. Which of the following should be done?",
    "choices": [
      {
        "id": 1,
        "text": "Permanent pacemaker should be placed"
      },
      {
        "id": 2,
        "text": "Atropine should be given"
      },
      {
        "id": 3,
        "text": "Electrical defibrillation should be done"
      },
      {
        "id": 4,
        "text": "No further therapy indicated"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given ECG shows sinus bradycardia with a heart rate of&nbsp;<strong>45</strong><strong> bpm</strong>. The patient is an athlete and heart rates are <strong>usually lower in</strong> <strong>athletes</strong>.</p>\n<p>As the patient is <strong>asymptomatic no further therapy</strong> should be given to increase the heart rate.</p>\n<p><strong>Sinus bradycardia:</strong></p>\n<ul>\n<li>Sinus bradycardia is defined as SA nodal rhythm with a rate &lt;60 beats/min. However, in young healthy adults and athletes, a resting heart rate of <strong>&lt;60 beats/min is common.</strong></li>\n<li>Also, a sinus pause of upto 3 seconds on ECG is commonly seen in athletes and elderly individuals.</li>\n<li>If the rate is <strong>&lt;40 beats/min</strong>, in an awake individual in the<strong> absence of physical training</strong>, then it is considered <strong>abnormal</strong>.</li>\n</ul>\n<p><strong>Diagnosis of SA node dysfunction:</strong></p>\n<ul>\n<li>The presence of abnormal sinus bradycardia or sinus pause on ECG is insufficient to diagnose SA node dysfunction.<strong> Longer-term electrocardiographic recording</strong> and <strong>clinical correlation</strong> are required to establish the diagnosis.</li>\n<li>On the contrary, the presence of symptoms without any sinus bradycardia or sinus pause on ECG is sufficient to rule out SA node dysfunction.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9b25d300f58a4d33b40896f7364d526c.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 60 year old male presents with acute severe chest pain associated with sweating 30 min earlier. The ECG of the person is shown below. Which of the following drugs should be given to this person?",
    "choices": [
      {
        "id": 1,
        "text": "Atropine"
      },
      {
        "id": 2,
        "text": "Streptokinase"
      },
      {
        "id": 3,
        "text": "Amiodarone"
      },
      {
        "id": 4,
        "text": "Adenosine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>The given ECG <strong>shows ST elevation</strong> in <strong>lead I, aVL, V3, V4</strong> and <strong>reciprocal depression in lead III</strong> suggestive of evolving <strong>Anterior Myocardial infarction</strong>.</li>\n<li>In MI, the drug of choice is <strong>thrombolytics like Streptokinase.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4aaf55a2f5d644bebe4f06ca63985ca4.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The following image shows a graph representing atrial and ventricular pressures during a cardiac cycle. The opening of mitral valve coincides with which of the following in an ECG?",
    "choices": [
      {
        "id": 1,
        "text": "End of T wave"
      },
      {
        "id": 2,
        "text": "Beginning of T wave"
      },
      {
        "id": 3,
        "text": "J point"
      },
      {
        "id": 4,
        "text": "Starting of P wave"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>The <strong>opening of mitral valve</strong> corresponds to the <strong>end of isovolumetric relaxation</strong> phase in a cardiac cycle.</li>\n<li>The <strong>isovolumetric relaxation phase</strong> is represented by <strong>the T wave in an ECG</strong>.</li>\n<li>Thus, <strong>opening of mitral valve</strong> corresponds <strong>to end of T wave</strong> in an ECG.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://daily-rounds-staging.s3.amazonaws.com/uploads/cd2097a3089048b1bf4d0be005a2a878.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0ec178c1250b458a866e3c15558c760fx1280x1064.JPEG"
    ]
  },
  {
    "text": "If the stroke volume is 70 ml/beat, the cardiac output of the given patient is:",
    "choices": [
      {
        "id": 1,
        "text": "5.2 L/min"
      },
      {
        "id": 2,
        "text": "5 L/min"
      },
      {
        "id": 3,
        "text": "4.8 L/min"
      },
      {
        "id": 4,
        "text": "5.5 L/min"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The heart rate according to the given ECG is <strong>300 / No. of large squares = 300/4 = 75 beats/min</strong></p>\n<p>Cardiac output is calculated by:</p>\n<p><strong>Cardiac output = Stroke volume x Heart rate</strong></p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 70 x 75 ml / min</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 5250 ml/min</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= <strong>5.2 L/min</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d938de9ab3d3428cbc1918e97dd5a1c1.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 50 year old male presents to the OPD with chest pain, palpitations and shortness of breath. An ECG is taken to determine the cause of his symptoms. What does the ECG show?",
    "choices": [
      {
        "id": 1,
        "text": "Right bundle branch block"
      },
      {
        "id": 2,
        "text": "Paroxysmal supraventricular tachycardia"
      },
      {
        "id": 3,
        "text": "Right ventricular hypertrophy"
      },
      {
        "id": 4,
        "text": "Ventricular bigeminy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The ECG shows <strong>right ventricular hypertrophy</strong>.</p>\n<p><strong>ECG findings suggestive of RVH</strong></p>\n<ul>\n<li>R-V1 &gt;= 7</li>\n<li>R-V1 + S-V5/V6 &gt; 11</li>\n<li>Right axis deviation&nbsp;of +110&deg; or more</li>\n<li>T wave inversion in RV leads (Lead III, V1 &amp; V2)</li>\n</ul>\n<p><strong>Causes of RVH</strong></p>\n<ul>\n<li>Pulmonary hypertension</li>\n<li>Mitral stenosis</li>\n<li>Pulmonary embolism</li>\n<li>Chronic lung disease (Cor pulmonale)</li>\n<li>Congenital heart disease (e.g. Tetralogy of Fallot, pulmonary stenosis)</li>\n<li>Arrhythmogenic right ventricular cardiomyopathy</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/386cb7866ac5423da7575bba8916f186.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which lead does the given ECG tracing represent in a normal ECG?",
    "choices": [
      {
        "id": 1,
        "text": "aVL"
      },
      {
        "id": 2,
        "text": "aVR"
      },
      {
        "id": 3,
        "text": "V1"
      },
      {
        "id": 4,
        "text": "V6"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>As all the waves (<strong>P, QRS, T</strong>) are <strong>negative</strong>&nbsp;in the given ECG, it should be lead <strong>aVR</strong>. All the depolarisations waves (P, QRS, T) move away from lead aVR in the normal sinus.</p>\n<p>Depolarisation wave moving towards the positive pole of the lead (or active electrode) produces a positive deflection in the ECG and depolarization moving away from the positive pole of the lead produces a negative deflection in the ECG.</p>\n<p>The lead aVR provides&nbsp;information from the right upper side of the heart.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c1dc4ed5617f4786bbf2b98e827ef737.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f77d513ca2a4b888208329cdfb90fc8x1280x1382.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b180f095ef484a1b862f718dcd8cb82ax1280x713.JPEG"
    ]
  },
  {
    "text": "A 45-year-old male patient with a long-standing history of rheumatic heart disease comes to the clinic with complaints of dyspnea. Interpret the ECG finding.",
    "choices": [
      {
        "id": 1,
        "text": "Rabbit ear pattern"
      },
      {
        "id": 2,
        "text": "P mitrale"
      },
      {
        "id": 3,
        "text": "P pulmonale"
      },
      {
        "id": 4,
        "text": "Sawtooth pattern"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The P waves in the given ECG are broad and notched. This is the\u00a0<strong data-stringify-type=\"bold\">P mitrale</strong>\u00a0pattern which is seen in\u00a0<strong data-stringify-type=\"bold\">left atrial enlargement.</strong></p>\n<p>This patient has likely developed mitral stenosis (heard as a mid-diastolic murmur) secondary to his rheumatic heart disease. Mitral valve stenosis and atrial inflammation in rheumatic carditis lead to left atrial dilation.\u00a0</p>\n<p>The features of P mitrale are:</p>\n<ul>\n<li>lead II:\u00a0broad (&gt;2.5mm) notched P waves</li>\n<li>Lead V1: Biphasic wave with a prominent\u00a0negative terminal component (representing delayed depolarization of the LA)</li>\n</ul>\n<p>P pulmonale is seen in right atrial enlargement.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c7214fa40eb646af8b9f159df1b7682f.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1ba642933ad7476788755bf715738bf3x1280x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fa1307fb668745669ce788c0b1c52357x1280x933.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5f40a3dbbd734b679fab4cac748ddff0x1280x894.JPEG"
    ]
  },
  {
    "text": "A 67-year-old man with a history of COPD presented with worsening dyspnea for 2 weeks. On examination, pedal edema was present. An ECG was done and lead II showed the following pattern. Which of the following is responsible for this ECG finding?",
    "choices": [
      {
        "id": 1,
        "text": "Right atrial overload"
      },
      {
        "id": 2,
        "text": "Left atrial overload"
      },
      {
        "id": 3,
        "text": "Right ventricular hypertrophy"
      },
      {
        "id": 4,
        "text": "Left ventricular hypertrophy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given ECG, a <strong>peaked P wave </strong>can be seen. This is called&nbsp;<strong>P pulmonale </strong>and it is seen in cases of<strong> right atrial enlargement</strong>.<strong>&nbsp;</strong>The patient is showing features of heart failure possibly as a consequence of dysfunction caused by the overload.&nbsp;</p>\n<p>Signs of heart failure in this patient:</p>\n<ul>\n<li>Bilateral pitting edema in lower extremities (systemic congestion)</li>\n<li>Worsening dyspnea due to increased PCWP causing pulmonary hypertension and pulmonary edema (pulmonary congestion)</li>\n</ul>\n<p>The features of P pulmonale include:</p>\n<ul>\n<li>The amplitude of the P wave is &gt;2.5mm&nbsp;on Lead II</li>\n<li>Prominent positive wave in the biphasic P wave of lead V1</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b341164248ca4b0e9e9ff6c0dcc183ae.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/43a27358d833450f897b84e29124f815x1280x960.JPEG"
    ]
  },
  {
    "text": "A 50-year-old patient comes to the emergency room with a history of severe retrosternal pain radiating to the jaw. The patient initially felt some uneasiness while eating lunch after which he experienced pain. His ECG is as shown. Interpret his ECG.",
    "choices": [
      {
        "id": 1,
        "text": "Atrial flutter"
      },
      {
        "id": 2,
        "text": "WPW syndrome"
      },
      {
        "id": 3,
        "text": "Myocardial infarction"
      },
      {
        "id": 4,
        "text": "Ventricular tachycardia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given ECG shows ST-segment elevation in the anterior chest leads suggestive of <strong>myocardial infarction</strong>.</p>\n<p>Features of MI on ECG:</p>\n<ul>\n<li>\n<div><strong>ST-segment elevation</strong>: Zone of injury</div>\n</li>\n<li>\n<div><strong>T wave inversions</strong></div>\n</li>\n<li>\n<div>Deep Q waves: late sign to develop</div>\n</li>\n<li>\n<div>New left bundle branch block (LBBB)</div>\n</li>\n</ul>\n<p>Option A: Atrial flutter shows a sawtooth wave pattern.\u00a0</p>\n<p>Option B: WPW syndrome shows delta waves.</p>\n<p>Option D:\u00a0Ventricular tachycardia has wide QRS complex and increased heart rate.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/63b772cc7c9a4a5eb0016b61f56d63fb.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 72-year-old man comes to the emergency room complaining his heart is pounding and that he is going to die. The emergency physician orders an ECG. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Inferior wall MI"
      },
      {
        "id": 2,
        "text": "Extensive anterior wall MI"
      },
      {
        "id": 3,
        "text": "Anterolateral wall MI"
      },
      {
        "id": 4,
        "text": "Anteroseptal MI"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given ECG shows&nbsp;<strong>ST elevation </strong>in leads<strong> V1-V4</strong>&nbsp;which is suggestive of <strong>acute anteroseptal myocardial infarction</strong> (MI)<strong>. </strong>ST depression in the leads III and aVF signifies an old inferior wall infarction.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/edfec934c9dd4e948efdec9aa4fdee9e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 52-year-old diabetic man presents with retrosternal chest pain and profuse sweating and lightheadedness. Based on the ECG findings, what is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Extensive anterior wall MI"
      },
      {
        "id": 2,
        "text": "Anterolateral wall MI"
      },
      {
        "id": 3,
        "text": "Anteroseptal MI"
      },
      {
        "id": 4,
        "text": "Atrial flutter"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The ECG shows&nbsp;<strong>ST elevations </strong>in leads<strong> I, aVL, </strong>and<strong> V1-V6.&nbsp;</strong>This is suggestive of extensive <strong>anterior wall MI.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2bacc8a01e8148ec9c31c2b01b458dd1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the diagnosis based on the given ECG?",
    "choices": [
      {
        "id": 1,
        "text": "Anterior wall MI"
      },
      {
        "id": 2,
        "text": "Lateral wall MI"
      },
      {
        "id": 3,
        "text": "Inferior wall MI"
      },
      {
        "id": 4,
        "text": "Anteroseptal MI"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The ECG is suggestive of&nbsp;<strong>lateral wall MI</strong>&nbsp;and possible posterior wall MI.</p>\n<p><strong>ST-elevation</strong> is present in the high lateral leads (<strong>I and aVL</strong>) and in <strong>V5 and V6</strong>.</p>\n<p><strong>Reciprocal ST depression</strong> is seen in the inferior leads (<strong>III and aVF</strong>) with associated<strong> ST depression </strong>in<strong> V1, V2, and V3</strong> (which could represent <strong>posterior wall MI).</strong></p>\n<p>This pattern is consistent with an acute infarction localized to the superior portion of the lateral wall of the left ventricle (high lateral STEMI).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/041742a394fc4e7dbe050ab420f9e296.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 60-year-old patient presents with chest pain on the left side radiating to the arm and jaw on the same side. Cardiac troponins are found to be raised. What is the diagnosis based on this ECG?",
    "choices": [
      {
        "id": 1,
        "text": "Anterior wall MI"
      },
      {
        "id": 2,
        "text": "Lateral wall MI"
      },
      {
        "id": 3,
        "text": "Inferior wall MI"
      },
      {
        "id": 4,
        "text": "Posterior wall MI"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given ECG is of <strong>posterior wall MI.</strong></p>\n<p>The ECG findings in posterior wall MI include,</p>\n<ul>\n<li>Reciprocal ST depressions in leads V1 to V3.&nbsp;Posterior wall ischemia is indirectly recognized in this way</li>\n<li>Tall and broad R waves (&gt;30ms)&nbsp;in V2 and V3</li>\n<li>Dominant R waves (R/S ratio &gt; 1) in V2</li>\n<li>Upright terminal portions of the T waves in V2 and V3\n<div class=\"layoutArea\">&nbsp;</div>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/10157854c5054d5e9f440cbf1a5147da.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 65-year-old hypertensive patient presents with chest pain and dyspnea following an alcohol binge. His ECG is shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ventricular tachycardia"
      },
      {
        "id": 2,
        "text": "Focal atrial tachycardia"
      },
      {
        "id": 3,
        "text": "Ventricular fibrillation"
      },
      {
        "id": 4,
        "text": "Atrial fibrillation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The ECG shows narrow QRS complexes with <strong>irregular RR intervals</strong> and <strong>no distinct P waves.&nbsp;</strong>This is&nbsp;suggestive of <strong>atrial fibrillation</strong>.</p>\n<p><strong>Atrial fibrillation (AF)&nbsp;</strong>is a supraventricular tachycardia caused by ectopic foci or small reentry circuits within the atria. It has an atrial rate of 400-600/min and a ventricular rate of 100-160/min.&nbsp;</p>\n<p>Risk factors for developing AF include:</p>\n<ul>\n<li>Age- usually above 60 years of age</li>\n<li>Underlying heart disease</li>\n<li>Hypertension</li>\n<li>Diabetes mellitus</li>\n<li>Obesity</li>\n<li>Sleep apnea</li>\n<li>Post-cardiac surgery</li>\n<li>Inflammatory pericarditis</li>\n</ul>\n<p>Acute precipitating factors for AF include:</p>\n<ul>\n<li>Hyperthyroidism</li>\n<li>Acute alcohol intoxication</li>\n<li>Acute illness like myocardial infarction&nbsp;and pulmonary embolism</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8aeacc19ffb44b44b9229247c55aede3.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d30f6e7195844df6a52b0fa6e84d940ax1280x1903.JPEG"
    ]
  },
  {
    "text": "All of the following are effective in the management of patients with ventricular tachycardia except:",
    "choices": [
      {
        "id": 1,
        "text": "Procainamide"
      },
      {
        "id": 2,
        "text": "Amiodarone"
      },
      {
        "id": 3,
        "text": "DC cardioversion"
      },
      {
        "id": 4,
        "text": "Carotid sinus massage"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Carotid sinus massage</strong> will be effective <strong>only in supraventricular tachycardias</strong> but not in ventricular tachycardias. This is because it acts by <strong>increasing the AV node block</strong> which does not play any role in the pathogenesis of ventricular tachycardia.</p>\n<p>Hence, AV node blocking maneuvers (carotid sinus massage, valsalva) and drugs (adenosine) are not used in the management of VT.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'M18 - Ecg Mini Test';
        const quizFilename = 'm18-ecg-mini-test-272b9045.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2017-18"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>