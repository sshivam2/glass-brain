<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>34 Previous Year Questions - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        PrepLadder / qBank / Pediatrics
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">13</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "<p>A 2-week-old infant presents with a history of epistaxis and recurrent rectal bleeding. The parents also reported a history of bleeding from the umbilicus since birth. Laboratory investigations revealed normal prothrombin time (PT), normal thrombin time, normal activated partial thromboplastin time (aPTT), normal platelet count, and normal function. Urea clot solubility test was positive. What is the most likely deficient factor in this patient?</p>\n\n<p>\u00a0</p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "Factor XIII"
      },
      {
        "id": 2,
        "text": "Factor XI"
      },
      {
        "id": 3,
        "text": "Factor X"
      },
      {
        "id": 4,
        "text": "Factor XII"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Answer: A) Factor XIII</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The given clinical feature is characteristic of <strong>Factor XIII (FXIII) <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> / </strong><strong>Laki lorand factor deficiency. </strong>It<strong> </strong>is a rare <span class=\"customMeta\" data-dictid=\"41e858bf2816927771836d46c619b9\">bleeding</span> disorder that presents with symptoms spanning from delayed <span class=\"customMeta\" data-dictid=\"9cc3973459169277720194a0847477\">umbilical</span> cord separation to <span class=\"customMeta\" data-dictid=\"cd42e0ddad1692777190d18c595ec5\">intracranial</span> hemorrhage.</p>\n\n<ul>\n\t<li>FXIII plays a pivotal role in stabilizing clots and facilitating the <span class=\"customMeta\" data-dictid=\"2cf4952c63169277718543a0883583\">cross-linking</span> of the <span class=\"customMeta\" data-dictid=\"18c2380be716927772020c9b2863de\">fibrin</span> polymer, thereby ensuring effective hemostasis</li>\n\t<li>The <span class=\"customMeta\" data-dictid=\"0f0b2969921692777180de24f0b0c0\">acquired</span> FXIII <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> typically arises from factors such as hyperconsumption, hemodilution, and decreased <span class=\"customMeta\" data-dictid=\"3fda45538a1692777199ec2a5478a5\">synthesis</span> and is more prevalent than the <span class=\"customMeta\" data-dictid=\"488a4efe7d16927771840c9e29f164\">congenital</span> form.</li>\n\t<li>In rare instances, individuals with <span class=\"customMeta\" data-dictid=\"0f0b2969921692777180de24f0b0c0\">acquired</span> FXIII <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> may generate autoantibodies <span class=\"customMeta\" data-dictid=\"e4865847fa169277720044d7b530b0\">targeting</span> FXIII subunits.</li>\n</ul>\n\n<p><br />\n<strong>Factor XI <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> </strong><strong>(Option B) </strong><strong>and <span class=\"customMeta\" data-dictid=\"b76c8023cf1692777202b9566653a8\">Factor XII</span> <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> </strong><strong>(Option D) </strong>causes prolonged Activated partial <span class=\"customMeta\" data-dictid=\"94b02f097916927771962072dbeeac\">prothrombin</span> time (aPTT) but <span class=\"customMeta\" data-dictid=\"94b02f097916927771962072dbeeac\">Prothrombin</span> time (PT) will be normal.</p>\n\n<p><br />\n<strong>Factor X <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> </strong><strong>(Option C) </strong>causes both prolonged <span class=\"customMeta\" data-dictid=\"94b02f097916927771962072dbeeac\">Prothrombin</span> time (PT) and</p>\n\n<p>Activated <span class=\"customMeta\" data-dictid=\"40141499f716927771945a13f86369\">partial <span class=\"customMeta\" data-dictid=\"9b51982d06169277720063c9420fbb\">thromboplastin</span> time</span> (aPTT).</p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A child presented with anemia, mental retardation, bone pains, and hepatosplenomegaly. Bone marrow biopsy showed a \"crumpled tissue paper\" appearance. What is the enzyme deficiency producing this condition?</p>\n\n<p><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"382\" src=\"https://image.prepladder.com/content/lQzpjaNb7G842C75wgZh1724824090.png\" width=\"381\" /></p>",
    "choices": [
      {
        "id": 1,
        "text": "Hexosaminidase-A"
      },
      {
        "id": 2,
        "text": "Iduronate 2-sulphatase"
      },
      {
        "id": 3,
        "text": "Glucose-6-phosphate dehydrogenase"
      },
      {
        "id": 4,
        "text": "Glucocerebrosidase"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Option D \u2013 Glucocerebrosidase:</strong></p>\n\n<ul>\n\t<li>A child presented with anemia, mental r*etardation, bone pains, and hepatosplenomegaly. <span class=\"customMeta\" data-dictid=\"5b9831f3aa169277718395d7361df6\">Bone marrow</span> <span class=\"customMeta\" data-dictid=\"754ab07a2e1692777183ed178c883d\">biopsy</span> showed a \"crumpled tissue paper\" appearance. The <span class=\"customMeta\" data-dictid=\"0f160e4e42169277718771b715516a\">enzyme</span> <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> producing this condition is <strong>Glucocerebrosidase</strong>, which is associated with Gaucher disease.</li>\n</ul>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option A -</strong> <strong>Hexosaminidase-A</strong>:</p>\n\n<ul>\n\t<li>This <span class=\"customMeta\" data-dictid=\"0f160e4e42169277718771b715516a\">enzyme</span> <span class=\"customMeta\" data-dictid=\"209b85faf71692777185767d43e3bd\">deficiency</span> is associated with Tay-Sachs disease, which is characterized by progressive neurological degeneration, but it does not typically present with the \"crumpled tissue paper\" appearance in <span class=\"customMeta\" data-dictid=\"5b9831f3aa169277718395d7361df6\">bone marrow</span> or the specific combination of symptoms described (anemia, mental retardation, bone pains, hepatosplenomegaly).</li>\n</ul>\n\n<p><strong>Option B -</strong> <strong>Iduronate 2-sulphatase</strong>:</p>\n\n<ul>\n\t<li>Deficiency of this <span class=\"customMeta\" data-dictid=\"0f160e4e42169277718771b715516a\">enzyme</span> is associated with Hunter syndrome, a type of <span class=\"customMeta\" data-dictid=\"49f930904116927771931db773742a\">mucopolysaccharidosis</span> (MPS II). This condition can cause developmental delay, skeletal abnormalities, and <span class=\"customMeta\" data-dictid=\"2f1f6627791692777188591ac9de0e\">hepatosplenomegaly</span> but does not typically present with the \"crumpled tissue paper\" appearance in bone marrow.</li>\n</ul>\n\n<p><strong>Option C -</strong> <strong>Glucose-6-phosphate dehydrogenase</strong>:</p>\n\n<ul>\n\t<li>Deficiency in this <span class=\"customMeta\" data-dictid=\"0f160e4e42169277718771b715516a\">enzyme</span> leads to <span class=\"customMeta\" data-dictid=\"96985248371692777188cfb38ca861\">G6PD</span> deficiency, which can cause <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">hemolytic</span> <span class=\"customMeta\" data-dictid=\"53bee2a41216927771814d7ec3a67f\">anemia</span> but does not typically cause the \"crumpled tissue paper\" appearance in <span class=\"customMeta\" data-dictid=\"5b9831f3aa169277718395d7361df6\">bone marrow</span> or the combination of symptoms described.</li>\n</ul>",
    "question_images": [
      "https://image.prepladder.com/content/lQzpjaNb7G842C75wgZh1724824090.png"
    ],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>An 18-month-old child presents with hepatosplenomegaly, a hemoglobin level of 7 g/dL, a white blood cell count of 50,000 cells/cu.mm, and petechiae and purpura. What is the recommended drug treatment for this condition?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Vincristine + Prednisolone"
      },
      {
        "id": 2,
        "text": "IVIG"
      },
      {
        "id": 3,
        "text": "L-Asparinigase +Prednisolone"
      },
      {
        "id": 4,
        "text": "Daunorubicin + Prednisolone"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Option A - Vincristine + Prednisolone:</strong></p>\n\n<ul>\n\t<li>This combination is commonly used as part of the treatment <span class=\"customMeta\" data-dictid=\"988bd8e7c71692777197b9f1d5d5ca\">regimen</span> for <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> lymphoblastic <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> (ALL). Vincristine is a <span class=\"customMeta\" data-dictid=\"8602c4b260169277718439bb122cb0\">chemotherapy</span> agent that inhibits cell division, and <span class=\"customMeta\" data-dictid=\"2d5e8899351692777196bdf7ced01d\">Prednisolone</span> is a <span class=\"customMeta\" data-dictid=\"a3e96d80e9169277718551158bbcd4\">corticosteroid</span> that helps reduce <span class=\"customMeta\" data-dictid=\"e747a47db616927771908bff4b8931\">inflammation</span> and has antitumor effects. This option is appropriate if the child's symptoms are indicative of ALL, as the high <span class=\"customMeta\" data-dictid=\"09be7d1f11169277720210bf5b0280\">WBC</span> count and symptoms like <span class=\"customMeta\" data-dictid=\"2f1f6627791692777188591ac9de0e\">hepatosplenomegaly</span> and <span class=\"customMeta\" data-dictid=\"0acd34c758169277719644923511e5\">purpura</span> are consistent with leukemia.</li>\n</ul>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option B \u2013</strong> <strong>IVIG:</strong></p>\n\n<ul>\n\t<li>Intravenous <span class=\"customMeta\" data-dictid=\"f8fab286571692777189bdfd087071\">immunoglobulin</span> (IVIG) is used for treating <span class=\"customMeta\" data-dictid=\"820847dbe3169277718912e7961028\">immune thrombocytopenic purpura</span> (ITP) and other conditions involving immune-mediated <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> destruction. While IVIG can be beneficial in conditions with <span class=\"customMeta\" data-dictid=\"41e858bf2816927771836d46c619b9\">bleeding</span> tendencies, it is not typically used as the primary treatment for leukemia.</li>\n</ul>\n\n<p><strong>Option C -</strong> <strong>L-Asparaginase + Prednisolone:</strong></p>\n\n<ul>\n\t<li>L-Asparaginase is an <span class=\"customMeta\" data-dictid=\"0f160e4e42169277718771b715516a\">enzyme</span> used in the treatment of <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> lymphoblastic <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> (ALL) as part of a <span class=\"customMeta\" data-dictid=\"8602c4b260169277718439bb122cb0\">chemotherapy</span> regimen. It works by depleting asparagine, an <span class=\"customMeta\" data-dictid=\"543f207eb51692777181723491a358\">amino</span> acid necessary for <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> cell survival. <span class=\"customMeta\" data-dictid=\"2d5e8899351692777196bdf7ced01d\">Prednisolone</span> is a <span class=\"customMeta\" data-dictid=\"a3e96d80e9169277718551158bbcd4\">corticosteroid</span> used to enhance the effects of <span class=\"customMeta\" data-dictid=\"8602c4b260169277718439bb122cb0\">chemotherapy</span> and reduce inflammation. This combination is appropriate for treating ALL, but without additional context, it\u2019s less specific than Vincristine + <span class=\"customMeta\" data-dictid=\"2d5e8899351692777196bdf7ced01d\">Prednisolone</span> in a classic ALL regimen.</li>\n</ul>\n\n<p><strong>Option D -</strong> <strong>Daunorubicin + Prednisolone:</strong></p>\n\n<ul>\n\t<li>Daunorubicin is a <span class=\"customMeta\" data-dictid=\"8602c4b260169277718439bb122cb0\">chemotherapy</span> drug used primarily in the treatment of <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> <span class=\"customMeta\" data-dictid=\"da88d7f2211692777193037caba514\">myeloid</span> <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> (AML) and sometimes in <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> lymphoblastic <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> (ALL). <span class=\"customMeta\" data-dictid=\"2d5e8899351692777196bdf7ced01d\">Prednisolone</span> is a <span class=\"customMeta\" data-dictid=\"a3e96d80e9169277718551158bbcd4\">corticosteroid</span> used to support <span class=\"customMeta\" data-dictid=\"8602c4b260169277718439bb122cb0\">chemotherapy</span> treatment. This combination is generally used for <span class=\"customMeta\" data-dictid=\"9ab5f0308116927771814e1fcc72d6\">AML</span> rather than ALL.</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which of the following is least likely regarding Rh incompatibility in a newborn?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Increased unconjugated bilirubin"
      },
      {
        "id": 2,
        "text": "Increased fecal urobilinogen"
      },
      {
        "id": 3,
        "text": "Increased urine bilirubin"
      },
      {
        "id": 4,
        "text": "Increased stercobilinogen"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Answer: C) Increased <span class=\"customMeta\" data-dictid=\"0096f2a7631692777201eb9f21d5a7\">urine</span> bilirubin</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>In Rh incompatibility, <span class=\"customMeta\" data-dictid=\"a191a950d7169277719148e72a75e2\">maternal</span> antibodies destroy <span class=\"customMeta\" data-dictid=\"f375a3584316927772020efa386e3e\">fetal</span> <strong>Rh-positive RBCs</strong>, leading to <strong>hemolysis</strong> and excessive <strong>unconjugated <span class=\"customMeta\" data-dictid=\"2d60c5a677169277718325a811dcf1\">bilirubin</span> (Option A).</strong></p>\n\n<ul>\n\t<li><strong>Unconjugated <span class=\"customMeta\" data-dictid=\"2d60c5a677169277718325a811dcf1\">bilirubin</span> is water-insoluble</strong> and <span class=\"customMeta\" data-dictid=\"d82fcb9d1f16927771836a9f6ccf14\">bound</span> to albumin, preventing <span class=\"customMeta\" data-dictid=\"0b72f5e96b16927772018dec8a87e2\">urinary</span> excretion. Instead, intestinal bacteria convert it to <strong>urobilinogen and stercobilinogen, </strong>which are<strong> eliminated in stool. (Options B & D) </strong></li>\n\t<li><strong>Urine <span class=\"customMeta\" data-dictid=\"2d60c5a677169277718325a811dcf1\">bilirubin</span> consists of conjugated bilirubin,</strong> which requires <span class=\"customMeta\" data-dictid=\"3268e86ce01692777188f249c64d6e\">hepatic</span> processing. However, in Rh incompatibility, the liver is overwhelmed, leading to predominantly unconjugated <span class=\"customMeta\" data-dictid=\"cab274fa4f1692777189f9b6dad514\">hyperbilirubinemia</span> and <strong>no significant increase in <span class=\"customMeta\" data-dictid=\"0096f2a7631692777201eb9f21d5a7\">urine</span> bilirubin</strong>.</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 14-month-old child with Hb 6.3 was undergoing repeated blood transfusions. The last transfusion was given in the 9<sup>th</sup> month. Which of the following investigations is used for a definitive diagnosis?</p>\n\n<p style=\"text-align:center\"><img alt=\"\" data-author=\"\" data-hash=\"\" data-license=\"\" data-source=\"\" data-tags=\"\" height=\"226\" src=\"https://image.prepladder.com/content/61CD657ozqT3J5Q6lG3G1745493440.png\" width=\"300\" /></p>\n\n<p>\u00a0</p>",
    "choices": [
      {
        "id": 1,
        "text": "High-performance liquid chromatography"
      },
      {
        "id": 2,
        "text": "Ferritin levels estimation"
      },
      {
        "id": 3,
        "text": "Bone marrow aspiration"
      },
      {
        "id": 4,
        "text": "Globin gene sequencing"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) <span class=\"customMeta\" data-dictid=\"debd75cb191692777188288f956f22\">Globin</span> gene sequencing</strong></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>In this case, the presence of <strong>target cells</strong> and a history of repeated blood transfusions suggests a possible hemoglobinopathy, such as<strong> <span class=\"customMeta\" data-dictid=\"baed0c93841692777200be26c8b9d2\">thalassemia</span> or sickle cell disease</strong>.</p>\n\n<ul>\n\t<li>\n\t<p><strong>Globin gene sequencing</strong> is a molecular <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> test that can identify specific mutations or genetic alterations in the <span class=\"customMeta\" data-dictid=\"debd75cb191692777188288f956f22\">globin</span> genes.</p>\n\t</li>\n\t<li>\n\t<p>By sequencing the <span class=\"customMeta\" data-dictid=\"debd75cb191692777188288f956f22\">globin</span> genes, such as the <span class=\"customMeta\" data-dictid=\"a9268f2e1d16927771814cfef69cf4\">alpha</span> and <span class=\"customMeta\" data-dictid=\"806eb8418c16927771822855b56695\">beta</span> <span class=\"customMeta\" data-dictid=\"debd75cb191692777188288f956f22\">globin</span> genes, it is possible to identify the specific genetic <span class=\"customMeta\" data-dictid=\"e7ed1a964716927771801ab913204a\">abnormality</span> responsible for the hemoglobinopathy.</p>\n\t</li>\n</ul>\n\n<p><strong>High-performance liquid <span class=\"customMeta\" data-dictid=\"fdf5ab514d1692777184d9fe915cba\">chromatography</span> (HPLC)</strong> <strong>(Option A) </strong>is a commonly used method to measure the different types of <span class=\"customMeta\" data-dictid=\"ad2073fe6716927771885f3c1ec652\">hemoglobin</span> and their variants in the blood. While <span class=\"customMeta\" data-dictid=\"588146bbf016927771899e42a57f75\">HPLC</span> can help in identifying <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> <span class=\"customMeta\" data-dictid=\"ad2073fe6716927771885f3c1ec652\">hemoglobin</span> variants, it may not provide a <span class=\"customMeta\" data-dictid=\"32b854324a1692777185c6c79fdc99\">definitive</span> diagnosis of the underlying genetic <span class=\"customMeta\" data-dictid=\"e7ed1a964716927771801ab913204a\">abnormality</span> causing the hemoglobinopathy.</p>\n\n<p><strong>Estimating <span class=\"customMeta\" data-dictid=\"91d0e4c6fa16927772025f96b44b27\">ferritin</span> levels</strong> <strong>(Option B) </strong>can provide information about the iron stores in the body but may not directly help in diagnosing the underlying cause of the <span class=\"customMeta\" data-dictid=\"53bee2a41216927771814d7ec3a67f\">anemia</span> or the specific genetic <span class=\"customMeta\" data-dictid=\"e7ed1a964716927771801ab913204a\">abnormality</span> causing the hemoglobinopathy.</p>\n\n<p><strong>While <span class=\"customMeta\" data-dictid=\"5b9831f3aa169277718395d7361df6\">bone marrow</span> examination (Option C) </strong>can provide valuable information about the cells in the bone marrow, it may not always be necessary for the <span class=\"customMeta\" data-dictid=\"32b854324a1692777185c6c79fdc99\">definitive</span> diagnosis of hemoglobinopathy</p>",
    "question_images": [
      "https://image.prepladder.com/content/61CD657ozqT3J5Q6lG3G1745493440.png"
    ],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A patient has bruising, petechiae, and occasional minor epistaxis, which has very little interference with his daily activities. Based on further workup, a diagnosis of a mild case of ITP is made. How will you manage the patient?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Short course corticosteroid therapy"
      },
      {
        "id": 2,
        "text": "Intravenous anti-D administration"
      },
      {
        "id": 3,
        "text": "A single dose of intravenous immunoglobulin"
      },
      {
        "id": 4,
        "text": "Education, counseling, and watchful expectancy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Correct Answer: D) Education, counseling, and watchful expectancy</strong></p>\n\n<p>\u00a0</p>\n\n<p><strong>Explanation: </strong></p>\n\n<p>In a patient with mild ITP who has bruising, petechiae, and occasional minor <span class=\"customMeta\" data-dictid=\"26bb4e3cc81692777187ce44e530e5\">epistaxis</span> but <strong>minimal <span class=\"customMeta\" data-dictid=\"f087a3103216927771903f59008962\">interference</span> with daily activities</strong>, the preferred approach is<strong> watchful expectancy.</strong></p>\n\n<ul>\n\t<li>Most cases of mild ITP in children <strong>resolve spontaneously without treatment.</strong></li>\n\t<li>Regular follow-up visits can help assess the <span class=\"customMeta\" data-dictid=\"3c305b384216927771969ca4166493\">progression</span> of the disease and determine the need for intervention if symptoms worsen or if there is an increase in <span class=\"customMeta\" data-dictid=\"41e858bf2816927771836d46c619b9\">bleeding</span> risk.</li>\n\t<li>The observation period involves providing education and counseling to the patient and closely <strong>monitoring <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> counts and symptoms over time.</strong><br />\n\t\u00a0</li>\n</ul>\n\n<table align=\"center\" cellspacing=\"0\" style=\"border-collapse:collapse; width:637px\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\" style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:1px solid black; vertical-align:top\">\n\t\t\t<p><strong>Management of Immune thrombocytopenic <span class=\"customMeta\" data-dictid=\"0acd34c758169277719644923511e5\">purpura</span> in children</strong></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Based on <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> count: </strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Platelet Count >30,000 cells/\u03bcL + No severe bleeding- Monitor closely</li>\n\t\t\t\t<li>Platelet Count < 30,000 cells/\u03bcL + No severe <span class=\"customMeta\" data-dictid=\"41e858bf2816927771836d46c619b9\">bleeding</span> + <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">Platelet</span> Count \u2265 5,000 cells/\u03bcL: Glucocorticoids (e.g.,<strong> Prednisone</strong>, Dexamethasone)</li>\n\t\t\t\t<li>Platelet Count < 5,000 cells/\u03bcL or Severe Bleeding: i.v.i.g.+ Glucocorticoids</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Other modalities:</strong></p>\n\n\t\t\t<p>\u00a0</p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Immediate Need to Raise <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">Platelet</span> Count like surgery or trauma- <strong>Platelet Transfusion </strong></li>\n\t\t\t\t<li>Persistent or Severe Cases- Monitor with <span class=\"customMeta\" data-dictid=\"8502a8f15e16927771909160b28bf2\">intermittent</span> i.v.i.g.</li>\n\t\t\t\t<li>If necessary, consider <strong>Splenectomy </strong></li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:1px solid black; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<p><strong>Alternative Medications:</strong></p>\n\t\t\t</td>\n\t\t\t<td style=\"border-bottom:1px solid black; border-left:none; border-right:1px solid black; border-top:none; vertical-align:top\">\n\t\t\t<ul>\n\t\t\t\t<li>Anti-CD20 Antibody: Rituximab</li>\n\t\t\t\t<li>TPO Receptor Agonists: Romiplostim, Eltrombopag</li>\n\t\t\t</ul>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>\u00a0</p>\n\n<p><strong>Short course <span class=\"customMeta\" data-dictid=\"a3e96d80e9169277718551158bbcd4\">corticosteroid</span> therapy (Option A) </strong>is not indicated as the first-line treatment for mild ITP with minimal symptoms. While corticosteroids like <span class=\"customMeta\" data-dictid=\"5dff8e3fac1692777196f8c0c960f3\">prednisone</span> are effective, their side effects outweigh the benefits in mild cases. Corticosteroids are typically reserved for cases with more severe <span class=\"customMeta\" data-dictid=\"fc28c74bb716927772003aee4aa43c\">thrombocytopenia</span> or significant <span class=\"customMeta\" data-dictid=\"41e858bf2816927771836d46c619b9\">bleeding</span> risk.</p>\n\n<p><strong>Intravenous anti-D administration (Option B) </strong>is an intervention reserved for Rh-positive patients with more severe ITP requiring rapid <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> count elevation. In mild cases with minimal symptoms, this aggressive approach is unnecessary and carries potential risks.</p>\n\n<p><strong>A single dose of <span class=\"customMeta\" data-dictid=\"27b78a96071692777190f4dfb93430\">intravenous</span> <span class=\"customMeta\" data-dictid=\"f8fab286571692777189bdfd087071\">immunoglobulin</span> (Option C)</strong> represents an aggressive and costly intervention that is not warranted in mild ITP cases. IVIG is typically reserved for severe cases with significant <span class=\"customMeta\" data-dictid=\"41e858bf2816927771836d46c619b9\">bleeding</span> risk or very low <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> counts (<5,000/\u03bcL).</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>MC malignancy in children is:</p>",
    "choices": [
      {
        "id": 1,
        "text": "Retinoblastoma"
      },
      {
        "id": 2,
        "text": "Leukemia"
      },
      {
        "id": 3,
        "text": "Wilms tumor"
      },
      {
        "id": 4,
        "text": "Neuroblastoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Option. B</strong></p>\n\n<ul>\n\t<li>Leukemia: <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">Leukemia</span> is a type of cancer that affects the <span class=\"customMeta\" data-dictid=\"5b9831f3aa169277718395d7361df6\">bone marrow</span> and blood. It involves the <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> production of white blood cells, which can interfere with the normal <span class=\"customMeta\" data-dictid=\"bf1b7e7049169277720354c306d716\">functioning</span> of red blood cells and platelets. The two main types of <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> in children are <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> lymphoblastic <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> (ALL) and <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> <span class=\"customMeta\" data-dictid=\"da88d7f2211692777193037caba514\">myeloid</span> <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> (AML). Symptoms can include fatigue, pale skin, frequent infections, easy bruising or bleeding, bone pain, swollen <span class=\"customMeta\" data-dictid=\"4df97a6cbf169277719172fd1af767\">lymph</span> nodes, and weight loss. Treatment for <span class=\"customMeta\" data-dictid=\"4521dbf4b91692777191a73002bf98\">leukemia</span> typically involves chemotherapy, sometimes combined with radiation therapy and stem cell transplantation.</li>\n</ul>\n\n<p><strong>Incorrect options\u00a0</strong></p>\n\n<p><strong>Option A) </strong>Retinoblastoma: <span class=\"customMeta\" data-dictid=\"fc941081ef16927771970c709f1103\">Retinoblastoma</span> is a rare <span class=\"customMeta\" data-dictid=\"a1b06f401f1692777203a53393ba98\">form</span> of eye cancer that primarily affects young children. It develops in the retina, the light-sensitive tissue at the back of the eye. <span class=\"customMeta\" data-dictid=\"fc941081ef16927771970c709f1103\">Retinoblastoma</span> may be <span class=\"customMeta\" data-dictid=\"ee5175c06116927771880846d1cbe0\">hereditary</span> or <span class=\"customMeta\" data-dictid=\"a325d0c14e16927771992fe8a96758\">sporadic</span> (non-hereditary). The most common sign is the presence of a white <span class=\"customMeta\" data-dictid=\"e419fd4e241692777196d038d1b71a\">pupil</span> or a noticeable difference in the color of the <span class=\"customMeta\" data-dictid=\"e419fd4e241692777196d038d1b71a\">pupil</span> between the two eyes. Other symptoms may include <span class=\"customMeta\" data-dictid=\"8f3503d98d1692777199964f9bb384\">strabismus</span> (crossed or misaligned eyes), poor vision, and eye pain. Treatment options include chemotherapy, radiation therapy, <span class=\"customMeta\" data-dictid=\"7a2baeba7416927771858fcddc798f\">cryotherapy</span> (freezing the tumor), and <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> removal of the affected eye.</p>\n\n<p><strong>Option C) </strong>Wilms tumor: Wilms tumor, also known as nephroblastoma, is a type of <span class=\"customMeta\" data-dictid=\"4aa6035df41692777190b41d4a1583\">kidney</span> cancer that primarily affects children. It usually occurs in children aged 3 to 4 years. The most common sign is the presence of a painless <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> mass or swelling. Other symptoms may include <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> pain, fever, and blood in the urine. Treatment involves <span class=\"customMeta\" data-dictid=\"81d12f9cb01692777199e44ff3f3c1\">surgical</span> removal of the tumor, followed by <span class=\"customMeta\" data-dictid=\"8602c4b260169277718439bb122cb0\">chemotherapy</span> and sometimes radiation therapy. The <span class=\"customMeta\" data-dictid=\"e580b4033e169277719609af594c16\">prognosis</span> for <span class=\"customMeta\" data-dictid=\"8b8f271ea516927772024ef17cdb69\">Wilms tumor</span> is generally favorable, with high survival rates.</p>\n\n<p><strong>Option D</strong>) Neuroblastoma: <span class=\"customMeta\" data-dictid=\"d6a30cc0d11692777193e25a043a08\">Neuroblastoma</span> is a cancer that develops from <span class=\"customMeta\" data-dictid=\"c219021c491692777189d289f1fc03\">immature</span> nerve cells, primarily affecting children aged 5 years or younger. It usually arises in the <span class=\"customMeta\" data-dictid=\"f955f012f716927771801d01e7d163\">adrenal</span> glands (located on top of the kidneys) or in nerve tissue along the spine, chest, abdomen, or pelvis. <span class=\"customMeta\" data-dictid=\"d6a30cc0d11692777193e25a043a08\">Neuroblastoma</span> may cause various symptoms depending on the location and extent of the tumor, such as <span class=\"customMeta\" data-dictid=\"1665a40f1016927771801899eaed5d\">abdominal</span> pain, a <span class=\"customMeta\" data-dictid=\"bd478e4ff816927771949528846af9\">palpable</span> mass, bone pain, fever, weight loss, and changes in <span class=\"customMeta\" data-dictid=\"37863e7aec169277718310f33c6a11\">bowel</span> or <span class=\"customMeta\" data-dictid=\"e6cfda323816927771839cc83e376d\">bladder</span> function. Treatment options include surgery, chemotherapy, radiation therapy, and immunotherapy. The <span class=\"customMeta\" data-dictid=\"e580b4033e169277719609af594c16\">prognosis</span> for <span class=\"customMeta\" data-dictid=\"d6a30cc0d11692777193e25a043a08\">neuroblastoma</span> can vary widely depending on factors such as the age at diagnosis, stage of the disease, and genetic characteristics.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A child presents with petechiae, purpura, and a platelet count of 10,000/\u00b5L. Bone marrow examination reveals increased megakaryocytes.Which of the following is the drug of choice (DOC) for this condition?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Bone marrow transplant"
      },
      {
        "id": 2,
        "text": "Methotrexate"
      },
      {
        "id": 3,
        "text": "Intravenous immunoglobulin (IVIG)"
      },
      {
        "id": 4,
        "text": "Aspirin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct answer- Option c) Intravenous <span class=\"customMeta\" data-dictid=\"f8fab286571692777189bdfd087071\">immunoglobulin</span> (IVIG)</strong></p>\n\n<p><strong>Explanation</strong></p>\n\n<p>This clinical presentation (petechiae, purpura, <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> count of 10,000/\u00b5L, and increased megakaryocytes in bone marrow) is characteristic of<strong> Immune Thrombocytopenia (ITP)</strong>, also previously known as Idiopathic Thrombocytopenic Purpura. In ITP, the immune system mistakenly attacks and destroys platelets, leading to a low <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> count. The bone marrow, in an attempt to compensate for the rapid destruction, produces more megakaryocytes (the <span class=\"customMeta\" data-dictid=\"ae13cdc5c3169277719683e9f6bda5\">precursor</span> cells to platelets), which is why their number is increased on <span class=\"customMeta\" data-dictid=\"5b9831f3aa169277718395d7361df6\">bone marrow</span> examination.</p>\n\n<ul>\n\t<li>Bone <span class=\"customMeta\" data-dictid=\"c8a8c935a41692777191610f6aacb4\">marrow</span> transplant <strong>(Option A ruled out)</strong>: This is a very aggressive and high-risk procedure. It is not a first-line treatment for ITP. It might be considered in very rare, <span class=\"customMeta\" data-dictid=\"3790c638ab16927771970a0a41d3ab\">refractory</span> cases of severe, chronic ITP that haven't responded to multiple other treatments, but it's far from the drug of choice.</li>\n\t<li>Methotrexate <strong>(Option B ruled out)</strong>: This is an <span class=\"customMeta\" data-dictid=\"de563cef6b16927771894e23084692\">immunosuppressant</span> and <span class=\"customMeta\" data-dictid=\"8602c4b260169277718439bb122cb0\">chemotherapy</span> agent. While some immunosuppressants might be used in <span class=\"customMeta\" data-dictid=\"3790c638ab16927771970a0a41d3ab\">refractory</span> chronic ITP (e.g., rituximab, cyclosporine, azathioprine), <span class=\"customMeta\" data-dictid=\"a98f8182f116927771927e607ba8c8\">methotrexate</span> is not a standard first-line drug of choice for <span class=\"customMeta\" data-dictid=\"4cdc8161f71692777180df58cafa93\">acute</span> severe ITP in children.</li>\n\t<li>Intravenous <span class=\"customMeta\" data-dictid=\"f8fab286571692777189bdfd087071\">immunoglobulin</span> (IVIG)<strong>(Option C)</strong>: This is a primary drug of choice for acute, severe ITP, especially when a rapid increase in <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> count is desired due to significant <span class=\"customMeta\" data-dictid=\"41e858bf2816927771836d46c619b9\">bleeding</span> or very low counts. It's often used alongside or as an alternative to corticosteroids.</li>\n\t<li>Aspirin <strong>(Option D ruled out)</strong> <span class=\"customMeta\" data-dictid=\"deba671f4716927771828c95a320e5\">Aspirin</span> is an <span class=\"customMeta\" data-dictid=\"257da9409416927771815e64ee5df1\">antiplatelet</span> agent that inhibits <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> function. Giving <span class=\"customMeta\" data-dictid=\"deba671f4716927771828c95a320e5\">aspirin</span> to a patient with a critically low <span class=\"customMeta\" data-dictid=\"e7032bae7f1692777195d693722e54\">platelet</span> count and <span class=\"customMeta\" data-dictid=\"41e858bf2816927771836d46c619b9\">bleeding</span> (petechiae, purpura) would be highly contraindicated as it would worsen bleeding.</li>\n</ul>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which of the following is inherited in an autosomal recessive manner?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Hereditary spherocytosis"
      },
      {
        "id": 2,
        "text": "Sickle cell anemia"
      },
      {
        "id": 3,
        "text": "Osteogenesis imperfecta"
      },
      {
        "id": 4,
        "text": "Von Willebrand disease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Correct Option B - Sickle cell anemia: Sickle cell is inherited in an autosomal <span class=\"customMeta\" data-dictid=\"d54db2110416927771971e7c011a9f\">recessive</span> pattern. </strong></p>\n\n<p><strong>Incorrect Options - A, C, and D are inherited in an autosomal dominant pattern.</strong></p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which of the following follows an autosomal dominant inheritance pattern?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Von Willebrand disease"
      },
      {
        "id": 2,
        "text": "Wilson disease"
      },
      {
        "id": 3,
        "text": "Cystic fibrosis"
      },
      {
        "id": 4,
        "text": "Friedrichs ataxia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Option A - Von Willebrand disease: </strong>Von Willebrand disease is inherited in an autosomal dominant pattern.</p>\n\n<p><strong>Incorrect Options </strong>- B, C, and D are inherited in an autosomal <span class=\"customMeta\" data-dictid=\"d54db2110416927771971e7c011a9f\">recessive</span> pattern.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>A 2-year-old child is experiencing symptoms that indicate anemia, but they are not specific. The examination of a sample of blood under a microscope reveals the presence of target cells. The child also has a low level of hemoglobin (6 gm%) and exhibits a picture of microcytic hypochromic. Additionally, there is a positive family history of this condition. The next step in the diagnostic process is to conduct which investigation?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Newborn screening for sickle cell disease"
      },
      {
        "id": 2,
        "text": "HbA1c estimation"
      },
      {
        "id": 3,
        "text": "Hb electrophoresis"
      },
      {
        "id": 4,
        "text": "Osmotic fragility test"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Option C - Hb Electrophoresis:</strong></p>\n\n<ul>\n\t<li>Hb <span class=\"customMeta\" data-dictid=\"0284ae84d21692777187eb03c87a57\">electrophoresis</span> is a laboratory test used to identify and quantify the different types of <span class=\"customMeta\" data-dictid=\"ad2073fe6716927771885f3c1ec652\">hemoglobin</span> in the blood.</li>\n\t<li>It is particularly useful in diagnosing various types of hemoglobinopathies, including thalassemias and sickle cell disease.</li>\n\t<li>In the case of a 2-year-old child presenting with <span class=\"customMeta\" data-dictid=\"d09dc1da551692777192706b7f882e\">microcytic</span> <span class=\"customMeta\" data-dictid=\"07ccd8f461169277718970a6f1a131\">hypochromic</span> anemia, a positive family history, and target cells on the <span class=\"customMeta\" data-dictid=\"255674f3271692777195c172d86daf\">peripheral</span> smear, Hb <span class=\"customMeta\" data-dictid=\"0284ae84d21692777187eb03c87a57\">electrophoresis</span> is a crucial investigation to assess for the presence of any <span class=\"customMeta\" data-dictid=\"458e050fdc16927771809854c9fd53\">abnormal</span> <span class=\"customMeta\" data-dictid=\"ad2073fe6716927771885f3c1ec652\">hemoglobin</span> variants or thalassemias.</li>\n</ul>\n\n<p><strong>Incorrect Options:\u00a0</strong></p>\n\n<p><strong>Option A - </strong>Newborn screening for sickle cell disease:</p>\n\n<ul>\n\t<li>It is a test used to screen newborns for sickle cell disease.</li>\n\t<li>It is not typically used as a <span class=\"customMeta\" data-dictid=\"552e9ef8811692777186997018b858\">diagnostic</span> test for <span class=\"customMeta\" data-dictid=\"53bee2a41216927771814d7ec3a67f\">anemia</span> in a 2-year-old child presenting with <span class=\"customMeta\" data-dictid=\"70d4f989c31692777193372189cfbb\">nonspecific</span> symptoms.</li>\n</ul>\n\n<p><strong>Option B -</strong> HbA1c estimation: HbA1c is a blood test used primarily for the diagnosis and management of diabetes.</p>\n\n<p><strong>Option D -</strong> Osmotic <span class=\"customMeta\" data-dictid=\"0f4e78e9121692777203594ba840cc\">fragility</span> test:</p>\n\n<ul>\n\t<li>The osmotic <span class=\"customMeta\" data-dictid=\"0f4e78e9121692777203594ba840cc\">fragility</span> test is a laboratory test that measures the <span class=\"customMeta\" data-dictid=\"6ced8252211692777199ab0cc3f2bb\">susceptibility</span> of red blood cells to burst when exposed to changes in osmotic pressure.</li>\n\t<li>It is primarily used to diagnose and monitor certain types of <span class=\"customMeta\" data-dictid=\"ee5175c06116927771880846d1cbe0\">hereditary</span> <span class=\"customMeta\" data-dictid=\"248111ded81692777197946454db52\">red blood cell</span> disorders, such as <span class=\"customMeta\" data-dictid=\"ee5175c06116927771880846d1cbe0\">hereditary</span> spherocytosis.</li>\n\t<li>While it can be useful in specific cases of <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">hemolytic</span> anemias, it is not the most appropriate next investigation in this case, as the clinical presentation and <span class=\"customMeta\" data-dictid=\"255674f3271692777195c172d86daf\">peripheral</span> <span class=\"customMeta\" data-dictid=\"6777533153169277719804fcbbf2d1\">smear</span> findings suggest a <span class=\"customMeta\" data-dictid=\"d09dc1da551692777192706b7f882e\">microcytic</span> <span class=\"customMeta\" data-dictid=\"07ccd8f461169277718970a6f1a131\">hypochromic</span> anemia.</li>\n</ul>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>Which of the following parameters in Acute Lymphoblastic Leukemia (ALL) indicates an unfavorable prognosis?</p>",
    "choices": [
      {
        "id": 1,
        "text": "Age > 10 years"
      },
      {
        "id": 2,
        "text": "Leukocyte count < 50,000/mm3"
      },
      {
        "id": 3,
        "text": "Hyperdiploidy"
      },
      {
        "id": 4,
        "text": "Trisomy of chromosomes 4, 10, and 17"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Correct Option A - Age > 10 years:</strong></p>\n\n<ul>\n\t<li>Children older than 10 years of age have a higher risk of <span class=\"customMeta\" data-dictid=\"b4b361c37616927771979541177070\">relapse</span> and poorer outcomes.</li>\n</ul>\n\n<p><strong>Incorrect Options:</strong></p>\n\n<p><strong>Option B: <span class=\"customMeta\" data-dictid=\"00346a7f211692777191e91c2af9fc\">Leukocyte</span> count < 50,000/mm3:</strong></p>\n\n<ul>\n\t<li>A lower <span class=\"customMeta\" data-dictid=\"00346a7f211692777191e91c2af9fc\">leukocyte</span> count is associated with a more favorable <span class=\"customMeta\" data-dictid=\"e580b4033e169277719609af594c16\">prognosis</span> in ALL.</li>\n\t<li>High <span class=\"customMeta\" data-dictid=\"00346a7f211692777191e91c2af9fc\">leukocyte</span> counts at diagnosis indicate a higher tumor burden and are considered a poor <span class=\"customMeta\" data-dictid=\"cfb6c738351692777196f69788a66e\">prognostic</span> factor.</li>\n</ul>\n\n<p><strong>Option C: Hyperdiploidy:</strong> Hyperdiploidy, which refers to the presence of more than the normal number of chromosomes in leukemic cells, is associated with a favorable <span class=\"customMeta\" data-dictid=\"e580b4033e169277719609af594c16\">prognosis</span> in <span class=\"customMeta\" data-dictid=\"318e52e4751692777195acbcdf4551\">pediatric</span> ALL.</p>\n\n<p><strong>Option D: <span class=\"customMeta\" data-dictid=\"5e54fdc4d3169277720003f231621d\">Trisomy</span> of chromosomes 4, 10, and 17:</strong> Trisomies involving chromosomes 4, 10, and 17 are often observed in <span class=\"customMeta\" data-dictid=\"318e52e4751692777195acbcdf4551\">pediatric</span> ALL and are associated with a more favorable prognosis.</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  },
  {
    "text": "<p>What is the viral infection that can lead to temporary aplastic anemia?</p>",
    "choices": [
      {
        "id": 1,
        "text": "HIV"
      },
      {
        "id": 2,
        "text": "Polio"
      },
      {
        "id": 3,
        "text": "Parvovirus B-19"
      },
      {
        "id": 4,
        "text": "HHV-8"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Correct Option C - <span class=\"customMeta\" data-dictid=\"4c37b9980316927771941adbff3e43\">Parvovirus</span> B-19</strong></p>\n\n<ul>\n\t<li>Parvovirus B-19 is known to cause a <span class=\"customMeta\" data-dictid=\"a6cf2c3dc51692777200ef7fb22f69\">transient</span> <span class=\"customMeta\" data-dictid=\"1ea06afcbd1692777181199bfa3300\">aplastic</span> crisis, which is a temporary <span class=\"customMeta\" data-dictid=\"7b7c55fbdd16927771990b50bda606\">suppression</span> of <span class=\"customMeta\" data-dictid=\"248111ded81692777197946454db52\">red blood cell</span> production in individuals with underlying <span class=\"customMeta\" data-dictid=\"d30ae941d516927771889351160b00\">hemolytic</span> disorders, such as sickle cell disease or <span class=\"customMeta\" data-dictid=\"ee5175c06116927771880846d1cbe0\">hereditary</span> spherocytosis.</li>\n\t<li>Parvovirus B-19 infects <span class=\"customMeta\" data-dictid=\"892718f3e916927771871389d2e1a3\">erythroid</span> <span class=\"customMeta\" data-dictid=\"ae13cdc5c3169277719683e9f6bda5\">precursor</span> cells in the bone marrow, leading to their destruction and subsequent reduction in <span class=\"customMeta\" data-dictid=\"248111ded81692777197946454db52\">red blood cell</span> production.</li>\n</ul>\n\n<p><strong>Incorrect Options - A, B, and D do not cause temporary <span class=\"customMeta\" data-dictid=\"1ea06afcbd1692777181199bfa3300\">aplastic</span> anemia.</strong></p>\n\n<p>\u00a0</p>",
    "question_images": [],
    "explanation_video": null,
    "explanation_images": [],
    "explanation_audio_eng": null,
    "explanation_audio_hin": null
  }
];
        let quizName = '34 Previous Year Questions';
        let hierarchy = ["PrepLadder", "qBank", "Pediatrics"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>