<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinical Signs In Dermatology Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2024-25
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Match the various forms of dermographism with their correct descriptions.",
    "choices": [
      {
        "id": 1,
        "text": "1-c, 2-a, 3-b, 4-d"
      },
      {
        "id": 2,
        "text": "1-b, 2-d, 3-a, 4-c"
      },
      {
        "id": 3,
        "text": "1-c, 2-d, 3-a, 4-b"
      },
      {
        "id": 4,
        "text": "1-b, 2-a, 3-d, 4-c"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct answer is <strong>1-c, 2-d, 3-a, 4-b.</strong></p>\n<p><strong>Dermographism</strong> refers to an exaggerated\u00a0flare and\u00a0<span class=\"term tooltipstered\" data-term-id=\"302\">weal</span>\u00a0response that occurs when skin is stroked or scratched.\u00a0Dermographism is the most common form of chronic inducible urticaria or physical urticaria.</p>\n<p>Various forms of dermographism include:</p>\n<table style=\"border-collapse: collapse; width: 78.4178%; height: 253px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 21.1808%; text-align: center;\">Black</td>\n<td style=\"width: 78.82%;\">discoloration of the skin after pressure from a <strong>metallic object</strong></td>\n</tr>\n<tr>\n<td style=\"width: 21.1808%; text-align: center;\">White</td>\n<td style=\"width: 78.82%;\"><strong>capillary vasoconstriction</strong> follows light stroking or pressure on the skin and occurs normally but is particularly pronounced in atopic eczema</td>\n</tr>\n<tr>\n<td style=\"width: 21.1808%; text-align: center;\">Simple</td>\n<td style=\"width: 78.82%;\"><strong>triple response</strong> of local erythema due to capillary vasodilatation, followed by edema and a surrounding flare due to axon reflex\u2010induced dilatation of arterioles after stroking the skin.</td>\n</tr>\n<tr>\n<td style=\"width: 21.1808%; text-align: center;\">Cholinergic</td>\n<td style=\"width: 78.82%;\">demographic response consists of an <strong>erythematous line</strong> studded with <strong>punctate weals</strong>, seen in some patients with <strong>cholinergic urticaria</strong></td>\n</tr>\n</tbody>\n</table>\n<p>The image below shows cholinergic urticaria.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/af9c900dc4d4436a95bb64ecf1d4ddc3x1280x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e75400f2cca144e2b279004337f88f0dx1072x1438.PNG"
    ]
  },
  {
    "text": "A 42-year-old man presents with a painful skin lesion as shown below. There was no history of any recent trauma. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cellulitis"
      },
      {
        "id": 2,
        "text": "Erysipelas"
      },
      {
        "id": 3,
        "text": "Perichondritis"
      },
      {
        "id": 4,
        "text": "Parotid abscess"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The patient in the given scenario has a painful, <strong>well-demarcated </strong>raised<strong> </strong>erythematous<strong> </strong>lesion involving the <strong>skin over the ear. </strong>The most probable<strong> </strong>diagnosis<strong> </strong>is <strong>erysipelas.</strong></p>\n<p>Erysipelas is a skin infection\u00a0<span style=\"box-sizing: border-box; margin: 0px; padding: 0px;\">caused by <strong>group A beta-hemolytic streptococcus</strong>, <em>Streptococcus pyogenes</em> that involves the <strong>upper dermis</strong> and <strong>superficial</strong> <strong>lymphatics</strong></span>. It presents as <strong>erythematous</strong>, <strong>painful</strong>, indurated, and inflamed skin lesions.</p>\n<p>Facial erythema spreading to the pinna is known as <strong>Milian's</strong> <strong>ear sign</strong>. This sign<strong> </strong>is used to distinguish between erysipelas and cellulitis of the facial region. In erysipelas, this sign is positive since there will be<strong> involvement of the ear</strong> while it is not seen in cellulitis. The pinna region is usually <strong>spared in cellulitis</strong>, as there is <strong>no deeper dermal tissue and subcutaneous fat</strong> in the pinna. Thus the pinna involvement supports the diagnosis of erysipelas rather than cellulitis. It can also be distinguished from cellulitis by its <strong>well-demarcated borders.</strong> (Option A)</p>\n<p>Other options:</p>\n<p>Option C: Perichondritis is an infection of the <strong>skin</strong> and <strong>tissues</strong> <strong>around</strong> the <strong>cartilage</strong> of the <strong>pinna</strong>. Common causes include <strong>trauma</strong> due to either iatrogenic (surgical incision) or non-iatrogenic (laceration, hematoma) origin. It can also be due to the extension of infection from diffuse otitis externa or furuncle of the meatus. <strong>Pseudomonas aeruginosa</strong> is an organism commonly implicated. Initially, the pinna is<strong> red, hot, painful, and stiff</strong>. In the later stages, an abscess may form between the cartilage and perichondrium with necrosis of cartilage as the cartilage survives only on the blood supply from its perichondrium. Since there was no history of trauma, perichondritis is not the most probable cause for this given scenario.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/275522d1fc104e9db09bbd75c53ec048.jpg"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3b90b07449ed4a6c88b092abf4ab4838x720x902.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/aeb525387b3e4386a57cf5b6f58ac752x720x672.PNG"
    ]
  },
  {
    "text": "A 35-year-old patient presents to you with gait abnormalities and tremors. An eye examination reveals Kayser\u2013Fleischer ring. His serum ceruloplasmin levels are low, and his urinary copper levels are high. Which of the following signs is likely to be associated with this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Trachyonychia"
      },
      {
        "id": 2,
        "text": "Dorsal nail pterygium"
      },
      {
        "id": 3,
        "text": "Red lunulae"
      },
      {
        "id": 4,
        "text": "Blue lunulae"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical findings of gait abnormality and tremor with the <strong>Kayser\u2013Fleischer (KF)</strong> ring and <strong>low serum ceruloplasmin</strong> with <strong>high urinary copper</strong> levels are suggestive of <strong>Wilson\u2019s disease. B</strong><strong>lue</strong> <strong>lunulae</strong> are associated with this condition.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/07aaaf3252df46f6babb636d8fd5a14bx430x400.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/228c8eb5b0624b4098c682ef8e648393x720x632.PNG"
    ]
  },
  {
    "text": "Which of the following conditions does not reveal apple jelly sign on performing the following test?",
    "choices": [
      {
        "id": 1,
        "text": "Lupus vulgaris"
      },
      {
        "id": 2,
        "text": "Nevus anemicus"
      },
      {
        "id": 3,
        "text": "Sarcoidosis"
      },
      {
        "id": 4,
        "text": "Granuloma annulare"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shown above demonstrates a<strong> diascopy</strong>.<strong>\u00a0</strong>All the options mentioned above reveal <strong>apple jelly sign</strong> on diascopy<strong> </strong>except nevus anemicus.</p>\n<p>Diascopy is a\u00a0<strong>bedside maneuver</strong>\u00a0performed to assess\u00a0<strong>superficial erythema</strong>\u00a0in dermatological conditions.</p>\n<p>It\u00a0involves\u00a0<strong>pressing a glass slide</strong>\u00a0or a stiff, clear, colorless piece of plastic onto the skin\u00a0<strong>to compress blood out of small vessels</strong>, to <strong>allow evaluation of other colors</strong>. Vessels can be seen to blanch and fill, by varying the amount of pressure on the skin, which is different for different conditions.</p>\n<p>The\u00a0<strong>purpose</strong>\u00a0of this procedure is to\u00a0<strong>empty blood</strong>\u00a0from the\u00a0<strong>superficial vessels</strong>\u00a0to determine if skin redness is due to blood present within the vessels or extravasated onto the skin.</p>\n<p>Diascopy is of particular value in the following conditions:</p>\n<ul>\n<li>Granulomatous conditions: A translucent brownish color is seen on the diascopy, known as <strong>apple jelly nodules (apple jelly sign)</strong>.\u00a0They are seen in <strong>sarcoidosis</strong>,<strong> granuloma annulare</strong>, and <strong>lupus vulgaris</strong>.</li>\n<li>To distinguish<strong> nevus anemicus</strong> from<strong> nevus depigmentosus</strong>:\u00a0On diascopy, nevus anemicus\u00a0(congenital white patch of vasoconstriction) becomes indistinguishable with the merging of the lesion into the surrounding skin. However, the border of nevus depigmentosus remains unaltered after diascopy.</li>\n<li><strong>Spider nevi -\u00a0</strong>The application of medium pressure to a spider nevus can compress radiating arterioles and allow\u00a0<strong>visualization of pulsatile flow in the feeding vessel</strong>.</li>\n<li>Differentiation of <strong>erythema</strong> (vasodilation) - disappears and <strong>purpura</strong> (extravasated blood) - remains unaltered on diascopy.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3a729d6a5578468e9874e7739bb3e45a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "While examining a patient with pemphigus vulgaris, you notice that applying pressure from the side of the bulla causes it to extend to the adjacent unblistered skin. What is this sign known as?",
    "choices": [
      {
        "id": 1,
        "text": "Lutz sign"
      },
      {
        "id": 2,
        "text": "Nikolsky's sign"
      },
      {
        "id": 3,
        "text": "Dimple sign"
      },
      {
        "id": 4,
        "text": "Asboe-Hansen sign"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>extension</strong> of a<strong> blister </strong>to adjacent unblistered skin when <strong>pressure</strong> is applied from the <strong>side</strong> of the bulla is known as the <strong>Lutz sign </strong>or<strong> </strong>traditional<strong> bulla spread sign.</strong></p>\n<p>Other options:</p>\n<p>Option B: <strong>Nikolsky's</strong>\u00a0sign refers to the\u00a0<strong>easy peeling</strong> of the skin by applying <strong>tangential pressure</strong> over a bony prominence. It is classically seen in pemphigus vulgaris, pemphigus foliaceus, and staphylococcal scalded skin syndrome.</p>\n<p>Option C: <strong>Dimple sign</strong>\u00a0refers to the dimpled appearance of a <strong>dermatofibroma</strong> on squeezing the adjacent skin.</p>\n<p>Option D: The <strong>Asboe-Hansen sign, </strong>a variation of the bulla spread sign<strong>, </strong>involves applying<strong>\u00a0pressure</strong> to the bulla over the top, which causes the spread of the bulla to adjacent unblistered skin.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child is brought to the dermatology outpatient department with the following skin findings. On complete physical examination, no other abnormalities were found. Hearing was normal. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Piebaldism"
      },
      {
        "id": 2,
        "text": "Waardenburg syndrome"
      },
      {
        "id": 3,
        "text": "Oculocutaneous albinism"
      },
      {
        "id": 4,
        "text": "Chediak-Higashi syndrome"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above image showing a <strong>V-shaped congenital hypomelanotic patch</strong> in the absence of any other pathological clinical signs suggests a diagnosis of <strong>piebaldism</strong>.</p>\n<p class=\"yiv2051130034ydp77a8add9MsoNormal\"><span lang=\"EN-IN\"><strong>Piebaldism</strong> is a <strong>congenital</strong> disorder caused by a dominant <strong>mutation in the KIT gene,</strong> leading to <strong>impaired migration of melanocytes</strong>. Clinically, it presents an isolated hypopigmented patch at birth. The biopsy specimen from the lesion shows absent melanocytes or large atypical melanocytes.</span></p>\n<p class=\"yiv2051130034ydp77a8add9MsoNormal\"><span lang=\"EN-IN\">It affects the population and affects both sexes equally. The most common clinical presentation is the presence of a <strong>V-shaped hypomelanotic patch on the forehead at birth.</strong></span></p>\n<p class=\"yiv2051130034ydp77a8add9MsoNormal\"><span lang=\"EN-IN\">Diagnosis is mainly clinical. Treatment is conservative and includes <strong>sun protection at the site of the hypomelanotic patch</strong>. Epidermal or skin grafting can be tried for aesthetic purposes of treatment.</span></p>\n<div class=\"page\" title=\"Page 1855\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Piebaldism can be distinguished from vitiligo because of the neonatal presence of white patches.</p>\n</div>\n</div>\n</div>\n</div>\n<p>Option B: Skin findings suggestive of <strong>piebaldism</strong>,<strong>\u00a0</strong>along with the presence of <strong>sensorineural deafness,</strong> point toward\u00a0<strong>Waardenburg syndrome.</strong></p>\n<p>Option C:\u00a0<strong>Oculocutaneous albinism (OCA)</strong> is a rare <strong>autosomal recessive disorder. </strong>It is\u00a0characterized by <strong>generalized depigmentation of the skin, hair, and eye</strong> due to a\u00a0<strong>deficiency in melanin biosynthesis.</strong></p>\n<p>Option D:\u00a0<strong>Ch\u00e9diak\u2013Higashi syndrome</strong> is a rare <strong>autosomal recessive disorder. </strong>It\u00a0is characterized by hypopigmentation of the skin and eye\u00a0<strong>(fair skin, translucent iris), i</strong>mmunodeficiency, and possibly neurological symptoms. It is suspected in patients with <strong>features of oculocutaneous albinism</strong> combined <strong>with severe pyogenic infections.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/779f86f6a7f94c2aac8b2e3f5fdafc37.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "You are examining the nails of a patient with psoriasis. Which among the following nail findings is pathognomonic of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "4"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "1"
      },
      {
        "id": 4,
        "text": "3"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Image 3 shows the <strong>oil drop sign/ salmon patches, </strong>which is a specific\u00a0<strong>pathognomonic</strong> sign seen in psoriasis.</p>\n<div class=\"page\" title=\"Page 1130\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Psoriasis is a chronic inflammatory condition of the skin, characterized by red, scaly, sharply demarcated, indurated plaques usually seen on the extensor surfaces and scalp. It can affect any part of the nail unit, including the nail bed, nail matrix, and hyponychium. Nail changes in psoriasis are seen commonly. Various nail dystrophies that are seen in psoriasis-</p>\n</div>\n</div>\n</div>\n</div>\n<ul>\n<li>Nail matrix disease presents as\u00a0<strong>pits (most common)</strong>, ridges, and grooves of the nail plate.\u00a0</li>\n<li>Nail bed disease presents as\u00a0<strong>subungual oil drops</strong>, subungual hyperkeratosis, splinter haemorrhages, and <strong>distal onycholysis.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7e4bb93864e444f7bff86d2fe3fabbe7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f6128714b35341faa105a008a959f27cx1280x2068.JPEG"
    ]
  },
  {
    "text": "Groove sign of Greenblatt is seen in which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Lymphogranuloma venerum"
      },
      {
        "id": 2,
        "text": "Syphilis"
      },
      {
        "id": 3,
        "text": "Gonorrhoea"
      },
      {
        "id": 4,
        "text": "Herpes genitalis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> groove</strong>\u00a0<strong>sign of Greenblatt</strong> is seen in cases of <strong>lymphogranuloma venerum (LGV)</strong>.\u00a0</p>\n<p>It is a\u00a0<strong>pathognomonic</strong> sign of LGV in which a <strong>groove-like</strong>\u00a0depression is seen between <strong>femoral</strong> and <strong>inguinal</strong> <strong>lymph</strong> <strong>nodes</strong> above and below the inguinal ligament.</p>\n<p>LGV is a sexually transmitted disease caused by <strong>serovars L1-L3</strong> of\u00a0<strong><em>Chlamydia trachomatis</em></strong></p>\n<div class=\"page\" title=\"Page 870\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Patients present with genital ulcers, inguinal swelling or rectal discharge, and bleeding. The disease occurs in 3 stages. The <strong>primary stage </strong>is characterized by\u00a0the appearance of a <strong>single</strong>, <strong>non\u2010indurated, shallow genital ulcer</strong>. This heals rapidly and leaves no scar. In the <strong>secondary stage</strong> of LGV, along with the <strong>groove sign</strong>, unilateral lymphadenopathy and painful enlargement of glands in the form of <strong>buboes</strong>\u00a0are seen. The tertiary stage occurs in chronic untreated lesions and consists of genital edema, polypoid growths, fistulae, ulceration and scarring.</p>\n<div class=\"page\" title=\"Page 872\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The detection of serovar L of <em>Chlamydia trachomatis</em> from the site of infection confirms the diagnosis. This is done by\u00a0<strong>nucleic acid amplification tests</strong> (NAATs) and confirmed by<strong> real\u2010time</strong> polymerase chain reaction <strong>(PCR)</strong> assays for LGV\u2010specific DNA. In earlier times, the <strong>Frei test</strong>, which showed a <strong>positive cutaneous hypersensitivity reaction</strong> to purified chlamydial antigen was done but is now obsolete.</p>\n<p>Treatment:</p>\n<p>First-line treatment employs the administration of <strong>oral doxycycline 100 mg</strong> given <strong>twice daily</strong> for <strong>21 days and </strong>the patient should be thoroughly investigated to exclude other STIs.</p>\n<p><strong>Fluctuant buboes</strong> may require <strong>aspiration</strong> but the surgical incision is usually contraindicated. Recent sexual partners of the patient should also be notified.</p>\n<p>The image below shows the groove sign.</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3fa3ede0bd1a4341b945b9cc5fb0fafcx720x1016.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b0d04af2e2014fd59b2fe05b91d6b7b6x480x358.JPEG"
    ]
  },
  {
    "text": "A 10-year-old male patient presented with macular lesions on the trunk, as shown in the image, which are associated with flushing, and pruritus. On stroking the macular lesion with a blunt object, there is erythema around the reddish-brown macules. What is this known as?",
    "choices": [
      {
        "id": 1,
        "text": "Darier's sign"
      },
      {
        "id": 2,
        "text": "Pseudo-Darier's sign"
      },
      {
        "id": 3,
        "text": "Headlight sign"
      },
      {
        "id": 4,
        "text": "Hertoghe's sign"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Macular lesions as shown in the image associated with <strong>flushing, pruritus</strong>, and <strong>erythema</strong> around the reddish-brown macules on stoking the lesion are known as <strong>Darier\u2019s sign </strong>and are seen in <strong>cutaneous mastocytosis.</strong></p>\n<p>Cutaneous mastocytosis is an acquired condition where there is a massive increase in the number of mast cells in the skin and other tissues. <strong>Urticaria pigmentosa</strong> is the most common among these conditions\u00a0and is characterized by numerous <strong>reddish\u2010brown</strong> or <strong>pale monomorphic </strong>maculopapules, plaques, or nodules. It is associated with <strong>flushing, pruritus, redness, and swelling</strong> caused by the release of <strong>histamine</strong>, <strong>leukotrienes</strong>, and <strong>prostaglandins</strong> from <strong>skin mast cells</strong>. They are in <strong>symmetrical</strong> distribution and can occur anywhere on the body <strong>except the palms and soles</strong> and are seen maximum on the trunk and thighs. The lesions are <strong>positive</strong> for <strong>Darier's sign</strong>.</p>\n<p><strong>Darier's sign</strong> is the development of <strong>urticarial halo</strong> and <strong>erythema</strong> around the reddish-brown macules after mild trauma, including <strong>scratching or rubbing of the lesion</strong>. It is caused by the release of <strong>histamine</strong> due to <strong>degranulation</strong> of the mast cells. However, <strong>Darier's sign</strong> is not highly specific to mastocytosis as it is also rarely seen in <strong>juvenile xanthogranuloma</strong> and acute lymphoblastic leukemia of neonates.</p>\n<p>The image shows Darier's sign on the left shoulder.</p>\n<div class=\"page\" title=\"Page 1338\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\u00a0</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1cbc9359b0c7427b8c0dc9ed740e02fe.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17fbe8f5c8c443fda74e494333f6c6d9x1280x854.PNG"
    ]
  },
  {
    "text": "A 16-year-old boy presented with complaints of multiple skin lesions over his back. On examination, various erythematous, scaly lesions parallel to the ribs are noted, as shown in the image given below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Psoriasis"
      },
      {
        "id": 2,
        "text": "Pityriasis rosea"
      },
      {
        "id": 3,
        "text": "Lichen planus"
      },
      {
        "id": 4,
        "text": "Pityriasis rubra pilaris"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical scenario, with the image showing the <strong>Christmas tree sign</strong>, is suggestive of <strong>pityriasis rosea</strong>.</p>\n<p><strong>Pityriasis rosea</strong>/pityriasis circinata et maculata of Vidal is an <strong>acute self-limiting papulosquamous</strong> disorder. It is commonly seen in <strong>children</strong> and <strong>young adults</strong>.</p>\n<p>Even though the <strong>exact cause</strong> is <strong>unknown</strong>, T-cell-mediated immunity and infectious etiology are thought to be responsible for this condition. An association with infectious agents like human herpesvirus-6 (<strong>HHV-6</strong>) and human herpesvirus-7 (<strong>HHV-7</strong>) has been found recently.</p>\n<p>Clinical features include:</p>\n<ul>\n<li><strong>Prodrome</strong> of a sore throat, gastrointestinal disturbance, fever, or arthralgia.</li>\n<li><strong>Herald patch</strong>\u00a0- Large and conspicuous eruptions on the thigh, upper arm, trunk, or neck covered by\u00a0<strong>fine scales</strong></li>\n</ul>\n<p>The image given below shows a herald patch.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/67f6ea278b1d4181a827450a14cb31b8.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1494909b32744f9eb579fda6f7b277c4x720x809.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/91fe0fc36cc742449d7f33ae6c629d80x1280x916.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/32cdddbdc697485596ab8b0f4110eb61x720x1278.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/87c62800dcae4aeea173852eb9abcec0x720x872.JPEG"
    ]
  },
  {
    "text": "A 36-year-old male presented to the OPD with purplish, itchy, flat-topped bumps on his shins along with a fine reticular lacy pattern on the oral mucosa as shown in the below image. Which of the following nail changes is most specific in this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Dorsal Nail Pterygium"
      },
      {
        "id": 2,
        "text": "Subungal oil patch sign"
      },
      {
        "id": 3,
        "text": "Pup tent sign"
      },
      {
        "id": 4,
        "text": "Thinning of nail plate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span data-preserver-spaces=\"true\">The clinical features of <strong>purplish, itchy, flat-topped </strong>lesions on shins and white streaks forming a lacework in the buccal mucosa, <strong>Wickham's striae,</strong> shown in the image are diagnostic of </span><strong><span data-preserver-spaces=\"true\">Lichen planus</span></strong><span data-preserver-spaces=\"true\">. Among all the nail changes seen in\u00a0Lichen planus,\u00a0</span><strong><span data-preserver-spaces=\"true\">Dorsal nail pterygium </span></strong>is<span data-preserver-spaces=\"true\">\u00a0the <strong>most specific nail finding</strong>.</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f2aa45a112a64ed786eb2bcb71a6870e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3cabc34d353f4d1bb1e7af9051f7c596x760x488.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a4119491df504e4f832d4a6dd3b46714x1280x2068.JPEG"
    ]
  },
  {
    "text": "What is the name of the finding in the image of a patient with dermatomyositis?",
    "choices": [
      {
        "id": 1,
        "text": "Heliotrope rash"
      },
      {
        "id": 2,
        "text": "Shawl sign"
      },
      {
        "id": 3,
        "text": "V sign"
      },
      {
        "id": 4,
        "text": "Gottron's sign"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The name of the finding in the image of a patient with dermatomyositis is the <strong>V sign</strong><strong>.\u00a0</strong></p>\n<p><strong>Dermatomyositis</strong> is characterized by <strong>symmetrical involvement</strong> of the muscles, commonly affecting the <strong>proximal muscles</strong> more than the distal muscles. Multiple dermatological manifestations also accompany it:</p>\n<ul>\n<li><strong>Shawl sign </strong>(Option B)<strong>-\u00a0</strong>rashes in a sun-exposed area.<strong>\u00a0</strong>This is present on the\u00a0<strong>back</strong> of the <strong>neck</strong> and <strong>shoulders</strong><strong>.\u00a0</strong></li>\n<li><strong>V sign</strong>\u00a0- rashes that occur in sun-exposed areas. They are present on the <strong>anterior neck</strong> and <strong>chest</strong>\u00a0</li>\n<li><strong>Heliotrope rash</strong> (Option D) is erythema and discolouration of the <strong>eyelids</strong> with periorbital oedema.</li>\n<li><strong>Gottron's sign</strong> (Option A) is an erythematous rash on the <strong>elbows, knees, ankles,</strong> and<strong> knuckles </strong>on the<strong> extensor surfaces. </strong></li>\n<li><strong>Gottron's papules</strong> are raised with erythematous rashes over the <strong>knuckles.</strong>\u00a0</li>\n<li>Edema of face and limbs</li>\n<li>Flagellate erythema</li>\n<li>Vasculopathic ulcers</li>\n<li>Mechanic's hands in antisynthetase syndrome</li>\n<li>Poikiloderma</li>\n<li>Cutaneous calcinosis</li>\n</ul>\n<p>Other manifestations of dermatomyositis include dysphagia, interstitial lung disease, bronchopneumonia, alveolitis, and myocarditis.\u00a0</p>\n<p>Laboratory evaluation of patients with dermatomyositis will reveal <strong>elevated serum creatinine kinase</strong> and <strong>antinuclear antibodies</strong>. Electromyography will reveal features of myopathy. Histology will show <strong>perifascicular atrophy,</strong> and immunohistochemical staining will reveal <strong>myxovirus resistance protein A</strong>, a sensitive and specific marker.\u00a0</p>\n<p>Treatment of dermatomyositis is immunotherapy with <strong>high-dose glucocorticoids</strong> as the first line. <strong>Methotrexate</strong> can be started as the <strong>second line</strong> if the patient presents with severe weakness, other organ system involvement, or those with a risk of steroid complications like patients with diabetes, osteoporosis, or postmenopausal women. Otherwise, second-line agents are only started in patients who do not show improvement after 2-4 months of treatment with prednisone or those who cannot be maintained on a low dose. <strong>Triple therapy</strong> with <strong>intravenous immunoglobulin </strong>or<strong> rituximab</strong> may be required.\u00a0</p>\n<p>The image given below is a <strong>heliotrope rash:</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0932818779c248f3b6e192b7ee0cec0c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1571819fb26343389d5ac9138085705ex720x1009.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4d6659c5bedf42c4b48ae18a795e7c95x720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/97762b06e13b488ab3f7d6ed3520ac2ex720x403.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a151d0912b874d0cb11c3a98263ba267x768x648.JPEG"
    ]
  },
  {
    "text": "For a patient with a suspected inherited connective tissue disorder, identify the sign demonstrated below.",
    "choices": [
      {
        "id": 1,
        "text": "Hertoghe's sign"
      },
      {
        "id": 2,
        "text": "Higoumenaki's sign"
      },
      {
        "id": 3,
        "text": "Gorlin\u2019s sign"
      },
      {
        "id": 4,
        "text": "Gottron's sign"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The picture depicts <strong>Gorlin\u2019s sign</strong>, which is the ability of patients with <strong>Ehlers-Danlos syndrome (EDS)</strong> to touch the tip of the nose with the tip of their tongue.</p>\n<p>EDS is a connective tissue disorder occurring due to genetic defects involved in <strong>collagen synthesis</strong> and action. It is characterized by <strong>hyperextensibility</strong> of skin, <strong>hypermobile</strong> joints, easy bruising, and poor wound healing.</p>\n<p>Other options:</p>\n<p>Option A:<strong> Hertoghe\u2019s sign</strong> is defined as the loss of lateral one-third of the eye-brows (superciliary madarosis) seen in <strong>leprosy,</strong> myxedema, atopic dermatitis, trichotillomania, ectodermal dysplasia, discoid lupus erythematosus, alopecia areata, syphilis, systemic sclerosis, HIV infection, and hypothyroidism.<br /><br />Option B: <strong>Higoumenaki's sign</strong> refers to enlargement of the sternal end of the clavicle, frequently observed in patients with <strong>late congenital syphilis.</strong></p>\n<p>Option D: <strong>Gottron's sign</strong> refers to erythematous macules and patches overlying the elbows and/or knees seen in <strong>dermatomyositis.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/04152580ae234929a8dc239bcfc8b8f0.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old man presents with silvery-white scaly lesions on the extensor aspect of the elbows and knee. The clinical diagnosis is assisted by ______.",
    "choices": [
      {
        "id": 1,
        "text": "Auspitz sign"
      },
      {
        "id": 2,
        "text": "KOH smear"
      },
      {
        "id": 3,
        "text": "Tzanck smear"
      },
      {
        "id": 4,
        "text": "Diascopy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The presence of <strong>silvery-white scaly lesions</strong> on the <strong>extensor</strong> aspect of the elbows and knee is a characteristic feature seen in <strong>psoriasis</strong>. The condition can be diagnosed clinically by demonstrating the <strong>Auspitz sign</strong>.</p>\n<p>Auspitz sign is due to the <strong>elongated vessels</strong> in the <strong>dermal papilla </strong>which are under the\u00a0<strong>thin</strong><strong>\u00a0supra papillary epidermis. </strong></p>\n<p><strong>Demonstration of Auspitz Sign:<br /></strong> <br />If superficial silvery scales are removed by scratching (<strong>grattage</strong>), then the scales come off attached together, as if one has scratched on a wax candle (<strong>wax candle scales</strong>).</p>\n<p>Subsequently, a thin membrane, known as <strong>Bulkeley membrane</strong>\u00a0is seen. Removal of Bulkeley membrane reveals classical <strong>pinpoint bleeding</strong> known as the\u00a0<strong>Auspitz sign</strong>. <br /><br />Silvery-white scales on the extensor aspect of the elbow seen in psoriasis are portrayed in the picture below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d0f9df0a86c6401ebcfac1d9d79f0073x800x273.JPEG"
    ]
  },
  {
    "text": "An adolescent male presented with persistent, greasy, scaly and crusted papules over his neck, trunk, face, and scalp. His nail examination findings are given below. Based on these clinical features, identify the diagnosis.",
    "choices": [
      {
        "id": 1,
        "text": "Phrynoderma"
      },
      {
        "id": 2,
        "text": "Darier\u2019s disease"
      },
      {
        "id": 3,
        "text": "Seborrhoeic dermatitis"
      },
      {
        "id": 4,
        "text": "Follicular eczema"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of an adolescent male presenting with persistent, greasy, scaly and crusted <strong>papules</strong> over his <strong>seborrhoeic</strong> <strong>areas</strong> with a <strong>V-shaped nick</strong> at the nail's free edge is very suggestive of <strong>Darier's</strong> <strong>disease</strong>.<br /><br />Darier's disease is an <strong>autosomal dominant</strong> condition that occurs due to dysfunction of the\u00a0<strong>SERCA2 </strong>calcium channel<strong>\u00a0</strong>due to\u00a0<strong>ATP2A2</strong> gene mutation,\u00a0which is essential for desmosomal function. It results in <strong>acantholysis</strong> and <strong>dyskeratosis</strong>.\u00a0</p>\n<p>They usually present as discrete or confluent <strong>rough</strong>, <strong>greasy</strong>, skin-colored, or yellowish-brown <strong>hyperkeratotic</strong> <strong>papules</strong> on the seborrhoeic areas of the trunk, face, scalp, ears, neck, and flexures. They are extensive, <strong>malodorous</strong>, and <strong>painful</strong>. Aggravating factors include friction, heat, sweating, and <strong>sunlight</strong> or UVB.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/020540110e3d45b993eea5f22701f50f.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/302fc27ee12f492082b85ded10d7111bx1279x1300.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/94061d2d8f37416298ed6ac7f2bfaef6x1279x984.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cef3762fe3e64652a7c7076eeb9ff4f0x1279x1533.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1da1e960aaf64307baef1925274bec3fx720x434.PNG"
    ]
  },
  {
    "text": "A patient presented with a history of fever, myalgia, and severe arthralgia. She also developed pigmentation on the nose after a few days of the onset of these symptoms as shown below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Melasma"
      },
      {
        "id": 2,
        "text": "Melanocytic papillomatous naevi"
      },
      {
        "id": 3,
        "text": "Actinic keratosis"
      },
      {
        "id": 4,
        "text": "Chikungunya"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given history of fever, myalgia, severe arthralgia, and nose hyperpigmentation (<strong>chik sign</strong>) points towards a diagnosis of <strong>chikungunya.\u00a0</strong></p>\n<p>Chik sign refers to a central facial pigmentation predominantly on the nose which develops during\u00a0the acute phase of the disease. It helps in the retrospective diagnosis of Chikungunya infection<strong>.\u00a0</strong>It\u00a0most commonly affects the <strong>nose</strong> and <strong>cheeks.</strong> It\u00a0appears as the fever subsides.</p>\n<p>Chikungunya fever is due to infection with Chikungunya virus, spread by mosquitos and direct contact between humans. The <strong>Aedes aegypti</strong> and <strong>Aedes albopictus</strong> mosquitoes are the most common vectors.</p>\n<p>It presents as an acute onset of fever, arthralgia, and myalgia with other flu symptoms such as headache, loss of appetite, and nausea. A maculopapular rash develops, which is <strong>more pronounced on the trunk.\u00a0</strong>The rash may occasionally progress to petechiae and purpura.\u00a0</p>\n<div class=\"page\" title=\"Page 642\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Diagnosis is mainly clinical, however, a definitive diagnosis can be made by the detection of IgM antibodies in the serum with ELISA or RTPCR.</p>\n</div>\n</div>\n</div>\n</div>\n<p>Treatment is supportive with acetaminophen and NSAIDs. The rash can be managed with saline compresses and emollients. Persistent non-healing ulcers can be managed by topical or systemic antibiotics. Most of the skin lesions resolve within 2 weeks.</p>\n<p>Other options:</p>\n<p>Option A-\u00a0Hyperpigmentation\u00a0of the centrofacial face (nose and cheeks) mimics <strong>melasma</strong> and may be misdiagnosed if proper history is not taken. Melasma is hyperpigmented macules of the face that increase after sun exposure.\u00a0</p>\n<p>The following image shows the hyperpigmentation of the face seen in melasma.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c13ce66d7e6b46eb9562898e9d6b8b45.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/28af6e2015984d1cb20cddf2af16c161x720x543.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/733881afd10043ddbf56d43ee94af92cx1280x960.JPEG"
    ]
  },
  {
    "text": "In which of the following conditions is Nikolsky's sign positive?",
    "choices": [
      {
        "id": 1,
        "text": "Epidermolysis bullosa acquisita"
      },
      {
        "id": 2,
        "text": "Bullous pemphigoid"
      },
      {
        "id": 3,
        "text": "Erythema multiforme"
      },
      {
        "id": 4,
        "text": "Staphylococcal scalded skin syndrome"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Nikolsky's </strong>sign is <strong>positive</strong> in the following conditions:</p>\n<ul>\n<li>Pemphigus vulgaris</li>\n<li>Pemphigus foliaceus</li>\n<li><strong>Staphylococcal scalded skin syndrome</strong></li>\n</ul>\n<p>Nikolsky's sign refers to\u00a0the\u00a0<strong>separation</strong> of\u00a0the normal\u2010looking <strong>epidermis</strong> from the dermis by applying firm <strong>tangential</strong> sliding pressure, thereby producing erosion. It is seen in conditions that produce <strong>intraepidermal</strong> blisters. Hence it is negative in subepidermal bullous conditions like bullous pemphigoid and epidermolysis bullosa acquisita.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fab4cc3bf4a24a18b069f3817792b1f5x1279x1103.JPEG"
    ]
  },
  {
    "text": "Which among the following is the most common triggering factor for the skin lesion shown in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Contact with irritants like poison ivy"
      },
      {
        "id": 2,
        "text": "Malignancies like leukemia"
      },
      {
        "id": 3,
        "text": "Drug reactions due to Penicillin"
      },
      {
        "id": 4,
        "text": "Herpes simplex virus infection"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given image shows characteristic <strong>target lesions</strong>\u00a0of <strong>Erythema multiforme</strong>. It is most commonly associated with a preceding <strong>herpes simplex infection</strong> (facial or genital).<br /><br />Target lesions, also known as<strong> bull's-eye</strong> lesions are a type of rash with a central clearing. They can appear on any part of the body, including the face, upper chest, back, arms, legs, hands, feet, and mucous membranes. They\u00a0are a <strong>typical</strong> <strong>feature</strong> of erythema multiforme, a condition that often resolves in three to six weeks. Erythema multiforme lesions are annular, with a violaceous centre, pink halo, and pale ring. They are usually not painful but may cause a burning sensation. Target lesions are also a typical feature of<strong> Lyme disease</strong>, where they are known as <strong>erythema migrans</strong>.</p>\n<p>Target lesions have\u00a0<strong>three</strong> zones:</p>\n<ul>\n<li>The central area of <strong>dusky erythema</strong> or purpura</li>\n<li>Middle paler zone of <strong>edema,\u00a0</strong>and</li>\n<li>The outer ring of <strong>erythema</strong> with a well\u2010defined edge.</li>\n</ul>\n<p>Atypical target lesions have only two of the three zones.<br /><br /><strong>Erythema multiforme</strong> is a self\u2010limiting cytotoxic dermatitis that results from a <strong>cell\u2010mediated</strong> <strong>hypersensitivity</strong> <strong>reaction</strong>. It presents as a spectrum of macular, papular, or urticarial lesions, as well as the classic form -acral iris or <strong>target</strong> <strong>lesions</strong>. These lesions may involve the palms or trunk. The oral and genital mucosa can also be involved, and are associated with erosions.</p>\n<p>The common triggers are</p>\n<ul>\n<li><strong>Herpes simplex infection (most common)</strong></li>\n<li>Mycoplasma infection</li>\n<li>Bacterial infections</li>\n<li>Fungal infections</li>\n<li>Vaccinations</li>\n<li>Malignancy: carcinoma, lymphoma, <strong>leukemia</strong> (Option B)</li>\n<li>Drug reactions: sulfonamides, rifampicin, <strong>penicillins</strong>, hydantoin derivatives (Option C)</li>\n<li style=\"text-align: left;\">Miscellaneous: Lupus erythematosus (Rowell Syndrome), Sarcoidosis, Polyarteritis Nodosa</li>\n</ul>\n<p>Topical agents like <strong>poison ivy</strong> can also trigger Erythema multiforme-like reactions but it is not the most common cause (Option A).</p>\n<p>The image below shows typical target lesions:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/940e648fa3ac4497a6f2a2c0dcc64f71.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0b62ab58dc3f497ca46fe764d9987337x1200x1173.JPEG"
    ]
  },
  {
    "text": "Button-hole sign can be seen in which of the following disorders?",
    "choices": [
      {
        "id": 1,
        "text": "Discoid lupus erythematosus"
      },
      {
        "id": 2,
        "text": "Von Recklinghausen's disease"
      },
      {
        "id": 3,
        "text": "Tuberous sclerosis"
      },
      {
        "id": 4,
        "text": "Xeroderma pigmentosum"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Buttonhole sign</strong> is seen in type 1 neurofibromatosis (<strong>Von Recklinghausen's\u00a0disease</strong>).</p>\n<p>Neurofibromas can be <strong>invaginated</strong> into the <strong>subcutis\u00a0</strong>with the tip of the index finger back and they\u00a0<strong>reappear after</strong> the<strong>\u00a0pressure</strong> is<strong> released. </strong>This is the buttonhole sign.</p>\n<p>This sign is also <strong>positive</strong> in<strong>\u00a0anetoderma</strong> and<strong> dermatofibroma.</strong></p>\n<p>The image below shows a dermatofibroma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/81f0a4ede06c4f85ad9038ad71cdf85cx1280x1100.3667136812412.JPEG"
    ]
  },
  {
    "text": "In a young boy who presented with molluscum contagiosum, it was noted that new lesions appeared at the site of scratching. What is this phenomenon called?",
    "choices": [
      {
        "id": 1,
        "text": "Koebner response"
      },
      {
        "id": 2,
        "text": "Pseudo-Koebner response"
      },
      {
        "id": 3,
        "text": "Reverse Koebner response"
      },
      {
        "id": 4,
        "text": "Isotopic response"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The phenomenon where new lesions appeared at the site of scratching in a young boy presenting with molluscum contagiosum is <strong>pseudo-Koebner response.</strong></p>\n<p><strong>Koebner/isomorphic response </strong>(Option B)\u00a0refers to the appearance of\u00a0<strong>new</strong>\u00a0<strong>skin lesions</strong> in <strong>previously</strong> <strong>normal\u00a0skin</strong>\u00a0subjected to <strong>trauma</strong>. They are\u00a0typically<strong> linear</strong>, as they follow the <strong>route</strong> of the <strong>injury</strong>.\u00a0 It is more likely to occur when the disease is <strong>active</strong>.</p>\n<p><strong>Pseudo-Koebnerization </strong>refers to the appearance of similar <strong>skin lesions</strong> at the site of injury, resulting from the spread of<strong>\u00a0</strong>an <strong>infective agent.</strong>\u00a0It is seen in\u00a0<strong>plane warts</strong>\u00a0and\u00a0<strong>molluscum contagiosum</strong>,\u00a0</p>\n<p><strong>Koebner phenomenon</strong>\u00a0is seen in conditions like</p>\n<ul>\n<li><strong>Psoriasis</strong></li>\n<li><strong>Vitiligo</strong></li>\n<li>Erythema multiforme</li>\n<li><strong>Lichen planus</strong></li>\n<li>Necrobiosis lipodica</li>\n<li>Lupus erythematosus</li>\n<li>Hailey-Hailey disease</li>\n<li>Darier disease</li>\n<li>Vasculitis</li>\n<li>Pityriasis rubra pilaris</li>\n</ul>\n<p>Other options:\u00a0</p>\n<p>Option-C: <strong>Reverse Koebner phenomenon </strong>refers to\u00a0the <strong>disappearance</strong>\u00a0of <strong>skin lesions</strong> after trauma to the area, which is seen in <strong>psoriasis</strong>.</p>\n<p>Option-D: <strong>Isotopic response</strong>\u00a0is the emergence of a\u00a0<strong>new lesion\u00a0</strong>at the\u00a0<strong>site</strong>\u00a0of a\u00a0<strong>previous unrelated</strong>\u00a0dermatosis such as\u00a0<strong>granuloma annulare</strong>\u00a0developing at the site of\u00a0<strong>herpes zoster</strong>\u00a0and\u00a0<strong>psoriasis</strong>\u00a0developing at the site of\u00a0<strong>contact dermatitis</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Clinical Signs In Dermatology Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2024-25"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>