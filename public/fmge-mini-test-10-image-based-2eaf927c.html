<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 10 (Image Based) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2024
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following arteries is being palpated in the image shown below?",
    "choices": [
      {
        "id": 1,
        "text": "Anterior tibial artery"
      },
      {
        "id": 2,
        "text": "Posterior tibial artery"
      },
      {
        "id": 3,
        "text": "Dorsalis pedis artery"
      },
      {
        "id": 4,
        "text": "Popliteal artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The posterior tibial artery is palpated <strong>between the medial malleolus and the calcaneal tendon,&nbsp;</strong>as shown in the image.</p>\n<p>The posterior tibial artery can be felt by keeping the foot relaxed between plantar and dorsiflexion and palpating <strong>against the distal tibia behind and below the medial malleolus</strong>,approximately one-third of a <strong>line connecting the posterior border of the medial malleolus to the calcaneal tendon</strong>(Achilles tendon)</p>\n<p>Other options:</p>\n<p><strong>Dorsalis pedis </strong>artery:&nbsp;</p>\n<ul>\n<li>palpated against the underlying tarsals</li>\n<li><strong> lateral to the tendon of extensor hallucis longus</strong> from the <strong>midpoint between the malleoli to the proximal end of the first intermetatarsal space</strong>.&nbsp;</li>\n</ul>\n<p><strong>Popliteal</strong> artery:&nbsp;</p>\n<ul>\n<li>most difficult of the peripheral pulses to feel because the artery lies deep in the popliteal fossa.</li>\n<li>examined with the subject lying supine or prone, with the <strong>knee flexed</strong> in order to relax the tense popliteal fascia that roofs the popliteal fossa.</li>\n<li>felt over the <strong>midline of the fossa by deep pressure</strong> against the popliteal surface of the femur.&nbsp;</li>\n</ul>\n<p>Arteries of the lower limb are:&nbsp; &nbsp;&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/aca9cc9d810c468f9d12abb5d4e9ab99.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7a897b2d01514ffa998b1a7efb1837c1x1016x899.JPEG"
    ]
  },
  {
    "text": "An oxygen hemoglobin dissociation curve of a 30-year-old athlete was recorded. If curve 3 represents the dissociation curve during rest, how would the graph shift if he was exercising?",
    "choices": [
      {
        "id": 1,
        "text": "Curve 1"
      },
      {
        "id": 2,
        "text": "Curve 2"
      },
      {
        "id": 3,
        "text": "Curve 3"
      },
      {
        "id": 4,
        "text": "Curve 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>From the given scenario, during <strong>exercise</strong>, the oxygen hemoglobin curve shifts considerably towards the right and is denoted by the <strong>curve 4.</strong></p>\n<p><strong>Curve 3</strong>\u00a0represents the <strong>normal</strong> oxygen hemoglobin curve during rest.\u00a0</p>\n<p>Conditions that cause a <strong>right shift (curve 3 to curve 4)</strong> in the oxygen hemoglobin curve are: (Conditions with the increased requirement of O2 - metabolically active tissues)</p>\n<ul>\n<li>Hypoxia and Hypercarbia - Metabolically active tissues utilize O2 and tissues produce CO2</li>\n<li>\u2193 pH - Secondary to increased CO2 production</li>\n<li>\u2191 in temperature, heat</li>\n<li>\u2191 in 2,3-DPG - increased anaerobic glycolysis</li>\n</ul>\n<p>Conditions that cause a <strong>left shift (curve 3 to curve 2)</strong>\u00a0 in the oxygen hemoglobin dissociation curve are:</p>\n<ul>\n<li>Decreased carbon dioxide</li>\n<li>\u2191 pH of the blood</li>\n<li>\u2193 in the temperature of the body</li>\n</ul>\n<p><strong>Curve 1</strong>\u00a0represents the Myoglobin-O2 binding curve. It is a rectangular hyperbola (unlike a sigmoid curve of the oxygen-hemoglobin curve). This is because it only has a single oxygen binding site. It is present in muscles in large amounts and can provide oxygen to muscles even at low blood oxygen levels.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b9f63c92f3b948e7995634a0b57b28bf.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fc35180960c142238cea26e0e603e24ax1280x1379.JPEG"
    ]
  },
  {
    "text": "The following image shows the normal electrophoresis of serum proteins. Which of the following bands is much prominent in nephrotic syndrome ?",
    "choices": [
      {
        "id": 1,
        "text": "A"
      },
      {
        "id": 2,
        "text": "B"
      },
      {
        "id": 3,
        "text": "C"
      },
      {
        "id": 4,
        "text": "D"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The band that is marked as C in the given image corresponds to <strong>&alpha;2 globulin.</strong> This band becomes much<strong> prominent in nephrotic syndrome.</strong></p>\n<p><strong>&alpha;2&nbsp; macroglobulin</strong>, being a relatively bigger protein compared to others is <strong>not lost through urine</strong> in nephrotic syndrome. Hence the &alpha;2 band which includes &alpha;2 macroglobulin is very prominent in serum protein electrophoresis of a nephrotic syndrome patient.</p>\n<p>The following image shows the bands with their corresponding proteins in normal serum electrophoresis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4ead8771621c42b493ca7379cc614ca8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fbd0983139604b11ad59a24ebd1bfdefx1280x606.JPEG"
    ]
  },
  {
    "text": "A patient with a history of peptic ulcer underwent upper GI endoscopic biopsy of the stomach. The biopsy is stained with a special stain and shown in the image. What is the special stain used?",
    "choices": [
      {
        "id": 1,
        "text": "Gomori's methanamine silver stain"
      },
      {
        "id": 2,
        "text": "Warthin starry silver stain"
      },
      {
        "id": 3,
        "text": "Masson Fontana stain"
      },
      {
        "id": 4,
        "text": "Periodic Acid Schiff stain"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The given slide shows the GI mucosa, which has been stained with\u00a0<strong>Warthin-Starry silver stain</strong>, demonstrating the bacilli (<em><strong>Helicobacter pylori).</strong></em></p>\n<p class=\"p1\"><span class=\"s1\">On antral biopsy, H. pylori organisms are seen abundantly within the surface mucus layer, but they are difficult to visualize with routine hematoxylin (H&amp;E) stains.\u00a0</span>Organisms are most easily demonstrated with <strong>special stains</strong> like <strong>Warthin starry silver stain</strong> or <strong>Giemsa stain.</strong></p>\n<div class=\"page\" title=\"Page 770\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><span class=\"s1\"><strong>Image:\u00a0Warthin-Starry silver stain </strong>showing Helicobacter pylori\u00a0colonized on the surface of the regenerative epithelium.</span></p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/55671f88781d4778b76761c41870015c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2b3e67860a1f42f9a6ee89d6c6b4a92ax600x400.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7c816716cf7645eb9f76358bbb85f4f5x800x533.JPEG"
    ]
  },
  {
    "text": "A patient presents with fever, soar throat, and dyspnea. The examination finding of the oral cavity is shown below. What will be the media used to diagnose this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Lowenstein-Jensen medium"
      },
      {
        "id": 2,
        "text": "Loeffler's serum slope"
      },
      {
        "id": 3,
        "text": "Middle\u00a0Brook\u2019s medium"
      },
      {
        "id": 4,
        "text": "Thayer Martin medium"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario along with <strong>pseudomembrane</strong> over tonsil is suggestive of<strong>&nbsp;diphtheria </strong>caused by&nbsp;<strong><em>Corynebacterium diphtheria</em></strong>.&nbsp;<strong>Loeffler's serum slope&nbsp;</strong>is the<strong>&nbsp;medium</strong>&nbsp;for diagnosis of&nbsp;<em>Corynebacterium diphtheriae</em>.&nbsp;</p>\n<p><strong>Loeffler's serum slope </strong>(shown in the image below)<strong>&nbsp;</strong>is an&nbsp;<strong>enriched</strong>&nbsp;<strong>medium</strong>&nbsp;for the growth of&nbsp;<em><strong>Corynebacterium diphtheriae</strong>.&nbsp;</em>It is not a selective medium as other organisms can also grow on this medium. Rapid growth occurs within 6-8 hours. Colonies appear at first as small, opaque discs. They increase in size on continued incubation and may acquire a yellow tint.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7e58e7b15a514c0facee2d972dbd4b53.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c17558fd8b5c41baaa779af24ea9837cx1280x1511.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0bb5879e79414dbaa35a716695923756x720x832.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5b2c962f55214443a47baaf3191b55cfx1280x2285.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/04cf547166c14acaa2437ab72938cf8fx720x720.PNG"
    ]
  },
  {
    "text": "Which of the following statements is true regarding the Dose response curve shown in the image below:",
    "choices": [
      {
        "id": 1,
        "text": "Drug C is competitive antagonist"
      },
      {
        "id": 2,
        "text": "Drug A is more potent than Drug B"
      },
      {
        "id": 3,
        "text": "Drug C is more potent than Drug A"
      },
      {
        "id": 4,
        "text": "Drug B is non-competitive antagonist"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the above image,&nbsp;<strong>Drug A </strong>is the most potent drug</p>\n<p><strong>Potency</strong></p>\n<ul>\n<li>It is defined as the&nbsp;<strong>amount of drug&nbsp;</strong>needed<strong>&nbsp;to produce a given response.</strong></li>\n<li>A&nbsp;<strong>highly potent drug</strong>&nbsp;evokes a given&nbsp;<strong>response at low concentrations</strong>&nbsp;and vice-versa.</li>\n<li>The&nbsp;<strong>more the curve is on the left&nbsp;</strong>in a dose-response curve (DRC)<strong>, the greater is its potency.</strong></li>\n<li>Thus, in the above image, the potency is&nbsp;Drug A &gt; Drug C &gt; Drug B.</li>\n</ul>\n<p><strong>Drug B</strong> is a <strong>competitive</strong> antagonist (Option D)</p>\n<p>In <strong>competitive antagonism,</strong> the DRC is <strong>shifted to the right</strong> whereas in <strong>non-competitive antagonism </strong>the <strong>DRC</strong> is flattened.</p>\n<p>Thus in the above image <strong>Drug B</strong> is the <strong>Competitive</strong> antagonist while <strong>Drug C</strong> is the <strong>non-competitive</strong> antagonist.</p>\n<p><strong>Efficacy</strong></p>\n<ul>\n<li>It is defined as the<strong>&nbsp;maximum effect produced</strong>&nbsp;by the drug.</li>\n<li>It expresses the effect produced by the receptors when bound by a certain drug.</li>\n<li>In the log dose-response curve, the&nbsp;<strong>perpendicular height</strong>&nbsp;represents the drug efficacy.</li>\n<li>Thus, in the above image, the efficacy is Drug A = Drug B &gt; Drug C.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/94bd5c8408764c99adafb76bd37d1ba2.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the correct statement regarding the wound indicated by the red arrow in the given image of the skull?",
    "choices": [
      {
        "id": 1,
        "text": "It is an Exit wound because the outer table appears bevelled"
      },
      {
        "id": 2,
        "text": "It is an entry wound because the outer table appears bevelled"
      },
      {
        "id": 3,
        "text": "It is an Exit wound because the inner table appears bevelled"
      },
      {
        "id": 4,
        "text": "It is an entry wound because the inner table appears bevelled"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given image, <strong>bevelling</strong> is seen on the <strong>outer table</strong> and a <strong>punched out hole</strong> is seen on the <strong>inner table.</strong> So, it is an <strong>exit wound.</strong></p>\n<p><strong>Entry wound:</strong> The initial contact of the missile punches a clean hole through the outer table of the skull. Where the bullet emerges internally, the inner table is then unsupported and a cone-shaped plug is detached, forming a crater that is appreciably larger than the external hole.</p>\n<ul>\n<li>Bevelling: inner table</li>\n<li>Punched out hole: outer table</li>\n</ul>\n<p><strong>Exit wound: </strong>If the bullet traverses the cranium and penetrates the opposite side, the same pattern occurs, this time with the small hole on the inner table and the crater on the outside.</p>\n<ul>\n<li>Bevelling: outer table</li>\n<li>Punched out hole: inner table</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3d2bcb35a3f84351b024ed76a11467b3.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c4169b94f4814033bcf865765e105f47x1279x878.PNG"
    ]
  },
  {
    "text": "A 9-year-old boy comes with complaints of right ear pain, difficulty in opening the mouth, painful swallowing, and fever. The oral cavity examination reveals the following. The external facial examination is unremarkable. Which of the following is likely?",
    "choices": [
      {
        "id": 1,
        "text": "Pharyngitis"
      },
      {
        "id": 2,
        "text": "Parotid abscess"
      },
      {
        "id": 3,
        "text": "Bezold\u2019s Abscess"
      },
      {
        "id": 4,
        "text": "Quinsy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image shows&nbsp;<strong>quinsy</strong>&nbsp;also known as a<strong>&nbsp;peritonsillar&nbsp;abscess.</strong></p>\n<p><strong>Peritonsillar abscess&nbsp;</strong>or quinsy&nbsp;is a collection of pus in the peritonsillar space which lies between the capsule of the tonsil and the superior constrictor muscle.&nbsp;It usually follows an episode of acute tonsillitis when the crypta magna gets infected and gets sealed off. An intratonsillar abscess then forms which then bursts through the capsule to reach the peritonsillar space.</p>\n<p>Usually, it is unilateral though occasionally bilateral abscesses are recorded.</p>\n<p>It presents with marked&nbsp;<strong>odynophagia</strong>&nbsp;such that the patient cannot even swallow his&nbsp;<strong>saliva</strong>&nbsp;which&nbsp;<strong>dribbles</strong>&nbsp;from the angle of his mouth. The patient is usually&nbsp;<strong>dehydrated.&nbsp;</strong>Other features include a muffled and thick speech, often called a&nbsp;<strong>hot potato voice,&nbsp;</strong>sore throat,&nbsp;ipsilateral otalgia, torticollis, and fever.</p>\n<p>On examination, the tonsil, pillars, and soft palate are congested and enlarged. The uvula is congested and&nbsp;<strong>oedematous&nbsp;</strong>and&nbsp;pushed&nbsp;to<strong>&nbsp;the&nbsp;opposite&nbsp;</strong>side. Mucopus covering the tonsil is seen.<strong>&nbsp;Jugulodigastric lymph nodes&nbsp;</strong>are enlarged and tender.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>CECT,&nbsp;submandibular ultrasonography,&nbsp;and&nbsp;MRI&nbsp;are better suited for&nbsp;visualizing the abscess and its<strong>&nbsp;extent</strong>.&nbsp;<strong>Submandibular ultrasonography</strong>&nbsp;is also helpful for<strong>&nbsp;incision and drainage</strong>.</p>\n<p class=\"ng-binding\">&nbsp;<strong>Management of peritonsillar abscess:</strong></p>\n<ul>\n<li aria-level=\"1\"><strong>Hospitalization</strong></li>\n<li aria-level=\"1\"><strong>Intravenous fluids</strong>&nbsp;to address dehydration</li>\n<li aria-level=\"1\">High-dose<strong>&nbsp;intravenous antibiotics</strong>&nbsp;to cover aerobes and anaerobes</li>\n<li aria-level=\"1\">Analgesics for pain relief</li>\n<li aria-level=\"1\">Drainage by needle aspiration or incision and drainage</li>\n<li aria-level=\"1\">Tonsillectomy when there is airway obstruction or recurrence.</li>\n</ul>\n<p><strong>Incision and drainage</strong>&nbsp;of the abscess at the point of the maximum bulge above the upper pole of the tonsil or just lateral to the point of junction of the anterior pillar with a line drawn through the base of the uvula.</p>\n<p>&nbsp;Complications of peritonsillar abscess are:</p>\n</div>\n<div class=\"ng-scope\">\n<ul>\n<li>Retropharyngeal abscess</li>\n<li>Laryngeal edema</li>\n<li>Parapharyngeal abscess</li>\n<li>Septicemia</li>\n<li>Pneumonitis/ lung abscess</li>\n<li>Jugular vein thrombosis</li>\n<li>Spontaneous hemorrhage from carotid artery/ jugular vein.</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7aa87f7f47904a8ca8db87286d6e070c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A tumor in the anterior pituitary pressing on the optic chiasma will present as a case of ____.",
    "choices": [
      {
        "id": 1,
        "text": "Homonymous hemianopia"
      },
      {
        "id": 2,
        "text": "Inferior quadrantic hemianopia"
      },
      {
        "id": 3,
        "text": "Bitemporal hemianopia"
      },
      {
        "id": 4,
        "text": "Superior quadrantic hemianopia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A lesion in the&nbsp;<strong>optic chiasma</strong>&nbsp;will present as bitemporal hemianopia, due to the decussation of nasal fibres which are affected.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2a283e52c3dc465e963b2b93aa0c7a2ax720x419.JPEG"
    ]
  },
  {
    "text": "A newly pregnant woman from a rural area registered in the scheme shown below. Which of the following benefits would she receive under this scheme?",
    "choices": [
      {
        "id": 1,
        "text": "A cash incentive of 5000 rupees"
      },
      {
        "id": 2,
        "text": "At least 4 antenatal checkups and 6 homebased newborn care visits"
      },
      {
        "id": 3,
        "text": "Free checkup on 9th of every month"
      },
      {
        "id": 4,
        "text": "A cash incentive of 1400 rupees"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above image shows the logo of\u00a0<strong>Pradhan Mantri Surakshit Matritva Abhiyan</strong> (PMSMA). Under this scheme, all pregnant women will receive a <strong>free checkup</strong> on the <strong>9th </strong>of<strong> every month</strong>.</p>\n<p><strong>Pradhan Mantri Surakshit Matritva Abhiyan (PMSMA):</strong></p>\n<p><strong>Benefit: </strong>Free checkup on the 9th of every month.</p>\n<p><strong>Objective:</strong> Improve the quality and coverage of antenatal care, diagnostics, and counseling services.</p>\n<p><strong>Implementation: </strong>Pregnant women receive at least one check-up in their second or third trimester by a doctor in the PMSMA clinic, specifically on the 9th of every month.</p>\n<p>After routine examination, pregnant women are categorized according to the risk factors, and different <strong>coloured</strong> <strong>stickers</strong> are pasted on mother and child protection cards.</p>\n<ul>\n<li><strong>Green</strong> sticker: For women with <strong>no</strong> detected <strong>risk factor</strong></li>\n<li><strong>Red </strong>sticker<strong>: </strong>For women with<strong> detected risk factor</strong></li>\n</ul>\n<p><strong>Other options:</strong></p>\n<p><strong>Option A:\u00a0Pradhan Mantri Matru Vandana Yojana (PMMVY):</strong></p>\n<ul>\n<li>Benefit: Cash incentive of 5000 rupees.</li>\n<li>Eligibility: Provided to all pregnant women and lactating mothers for the first living child of the</li>\n<li>family, subject to specific conditions.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4e0ddbb3c8a5440c875c3872565c32c8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fb4ae2bda8f546c8a2ffd9e15602f705x102x100.PNG"
    ]
  },
  {
    "text": "Which of the following diseases are included in the scheme, which has the logo as given below?",
    "choices": [
      {
        "id": 1,
        "text": "CVD, Diabetes, Bronchial asthma"
      },
      {
        "id": 2,
        "text": "Diabetes, Hypertension, Bronchial asthma"
      },
      {
        "id": 3,
        "text": "CVD, Cancer, Diabetes, Stroke"
      },
      {
        "id": 4,
        "text": "Bronchial asthma, Hypertension, CVD"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The logo shows the NPCDCS scheme that has separate components for <strong>cancer</strong> and other non-communicable diseases like <strong>diabetes, cardiovascular disease </strong>and<strong> stroke</strong>.</p>\n<p>The National Programme for Prevention and Control of Cancer, Diabetes, Cardiovascular Diseases and Stroke (NPCDCS) has specialized facilities in district hospitals.</p>\n<p>It has been implemented in over 100 districts in 21 states.</p>\n<p>At the subcentre level under NPCDCS, screening and referral is done.</p>\n<p>NOTE: Non-alcoholic fattly liver disease (NAFLD) has been integrated with NPCDCS in 2021.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/23ab778d21ff4767a09ef88105d6f0c2.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5d4be3e3741a471fa6e0778ec759c9ebx225x225.JPEG"
    ]
  },
  {
    "text": "Identify the type of study from the following design.",
    "choices": [
      {
        "id": 1,
        "text": "Case\u2013control study"
      },
      {
        "id": 2,
        "text": "Nested case control study"
      },
      {
        "id": 3,
        "text": "Prospective cohort study"
      },
      {
        "id": 4,
        "text": "Retrospective cohort study"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The study design given is a <strong>prospective cohort study</strong>. The study proceeds from <strong>c</strong><strong>ause\u00a0to effect.</strong></p>\n<p><strong>Framingham Heart Study</strong> is one of the most famous long-term cardiovascular cohort studies.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e92b4c7702654a71b31181bbe3df1218.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "An HIV-positive patient presents with the following skin lesions. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Malignant melanoma"
      },
      {
        "id": 2,
        "text": "Mycosis fungoides"
      },
      {
        "id": 3,
        "text": "Adult T-cell leukemia"
      },
      {
        "id": 4,
        "text": "Kaposi's sarcoma"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above image showing red-purple macules and plaques in an HIV-positive patient is suggestive of <strong>Kaposi</strong> <strong>sarcoma, </strong>caused by <strong>human herpesvirus 8</strong>.&nbsp;It also causes <strong>primary effusion lymphoma.</strong>&nbsp;</p>\n<p>HHV-8 or <strong>Kaposi&rsquo;s sarcoma-associated herpesvirus (KSHV)&nbsp;</strong>is known to cause Kaposi&rsquo;s sarcoma, especially in immunocompromised persons.&nbsp;Cancer patients receiving chemotherapy, AIDS patients, and organ transplant recipients are all at a high risk of showing signs of infection.</p>\n<p>It is one of the currently known human cancer viruses or <strong>oncoviruses</strong>.</p>\n<p><strong>KSHV</strong> is a known causative agent of <strong>four diseases</strong>:</p>\n<ol>\n<li>Kaposi's sarcoma</li>\n<li>KSHV-associated multicentric Castleman's disease (MCD)</li>\n<li>Primary effusion lymphoma</li>\n</ol>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/13ec68db4538468aa9770266636435a4.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 46-year-old chronic alcoholic male presents to the OPD with fever, headache, shortness of breath, chest pain,  and productive cough for the last two days. On examination, there was bronchial breathing on the right side. A chest x-ray was done. Which is the most likely causative agent?",
    "choices": [
      {
        "id": 1,
        "text": "Streptococcus pneumoniae"
      },
      {
        "id": 2,
        "text": "Klebsiella pneumoniae"
      },
      {
        "id": 3,
        "text": "Pseudomonas aeruginosa"
      },
      {
        "id": 4,
        "text": "Haemophilus influenza"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario, history of <strong>alcoholism</strong> and the CXR findings are highly suggestive of lobar pneumonia caused by&nbsp;<strong>Klebsiella pneumoniae.&nbsp;</strong>The above chest x-ray shows<strong>&nbsp;a bulging fissure sign.</strong></p>\n<p>Klebsiella pneumonia is associated mostly with alcoholics and shows upper lobe involvement, cavitation, and pneumatocele (also seen in S.aureus). The patient presents with&nbsp;<strong>red currant-jelly sputum.</strong></p>\n<p><strong>Bulging fissure sign</strong> is classically seen in Klebsiella pneumonia. It represents expansive lobar consolidation causing fissural bulging or displacement by copious amounts of inflammatory exudate within the affected parenchyma. Other diseases that manifest a bulging fissure include any space-occupying process in the lung, such as pulmonary hemorrhage, lung abscess, and tumor.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9d3b42e13b5342afaa3af555844a59af.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "ECG of a patient who was brought to the casualty due to severe chest pain followed by syncope is given below. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Atrial fibrillation"
      },
      {
        "id": 2,
        "text": "Atrial flutter"
      },
      {
        "id": 3,
        "text": "Ventricular tachycardia"
      },
      {
        "id": 4,
        "text": "Ventricular fibrillation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given ECG is suggestive of <strong>atrial flutter</strong>.</p>\n<p>The given ECG shows narrow QRS complexes, hence it is supraventricular tachycardia. The RR intervals are regular and the normal P waves are replaced by <strong>sawtooth-shaped</strong> <strong>waves</strong>, known as flutter waves.</p>\n<p>In atrial flutter, the ventricular rate is determined by the AV conduction ratio. The commonest AV ratio is 2:1. In the above ECG, the rhythm is atrial flutter 4:1 block with an atrial rate of about 270 and a ventricular rate of 68/min.</p>\n<p>The image below shows sawtooth shaped waves in atrial flutter.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0a2e1778e59244978511e68ebe44d3d5.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/83ccc936da244a8ca580c56a88af1c6ax182x137.PNG"
    ]
  },
  {
    "text": "Identify the type of ataxia given below -",
    "choices": [
      {
        "id": 1,
        "text": "Sensory ataxia"
      },
      {
        "id": 2,
        "text": "Cerebellar ataxia"
      },
      {
        "id": 3,
        "text": "Frontal gait"
      },
      {
        "id": 4,
        "text": "Spastic gait"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The gait shown in the above video is a <strong>cerebellar ataxic gait</strong>.</p>\n<p>Cerebellar gait ataxia is characterized by a <strong>wide base</strong> of support, <strong>lateral instability of the trunk,</strong> and <strong>erratic foot placement</strong>. There is a <strong>loss of balance</strong> when attempting to walk on a narrow base. Difficulty maintaining balance when turning is often an early feature. They show considerable variation in their tendency to fall in daily life.</p>\n<p>Here, the patient is seen attempting <strong>tandem walking</strong> and displays <strong>improper heel-toe coordination</strong>, erratic foot placement, and <strong>truncal swaying</strong>.</p>\n<p>Causes of cerebellar ataxia include stroke, trauma, tumor, hereditary cerebellar degeneration, Wilson's disease, neurodegenerative disorders like multiple-system atrophy (MSA). Alcohol causes both acute and chronic cerebellar ataxia.</p>\n<p>Other options:</p>\n<p>Option A: Patients with sensory ataxia walk unsteadily with multiple falls, on a <strong>narrow base</strong>, and tend to <strong>look down while walking</strong>. They lose balance on walking with their eyes closed or in the dark. Joint sense and vibration sense are diminished.&nbsp;<strong>Dorsal column lesions</strong> of the spinal cord result in <strong>sensory ataxia.&nbsp;</strong></p>\n<p>Option C:<strong> Frontal ataxia </strong>or<strong>&nbsp;</strong>shuffling, freezing gait includes a wide base of support, a short stride, shuffling along the floor, and difficulty with starts and turns. Many patients exhibit difficulty with gait initiation which is descriptively characterized as the &ldquo;slipping clutch&rdquo; syndrome or gait ignition failure.&nbsp;It is commonly seen in the elderly.</p>\n<p>Option D:&nbsp;<strong>Spastic gait&nbsp;</strong>is characterized by stiffness in the legs, and a tendency to circumduct and scuff the feet. It is associated with an imbalance in muscle tone.&nbsp;Lesions in the <strong>corticospinal tract</strong> result in <strong>spastic gait.&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d985aae8875b44d38e625f9a5cc54661.GIF"
    ],
    "explanation_images": []
  },
  {
    "text": "A male patient with a history of burns in his left lower limb presented to the OPD with the following. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Arterial ulcer"
      },
      {
        "id": 2,
        "text": "Venous ulcer"
      },
      {
        "id": 3,
        "text": "Marjolin\u2019s ulcer"
      },
      {
        "id": 4,
        "text": "Infected burn wound"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient's history of burns and the image is suggestive of a<strong> Marjolin's ulcer. </strong>It\u00a0is a rare and aggressive form of\u00a0squamous cell carcinoma\u00a0that grows from <strong>burns</strong>, scars, or poorly healing wounds. It presents as an indurated, non-tender ulcer with raised and everted edges with scarring in the surrounding area with <strong>marked fibrosis</strong></p>\n<p>The ulcer can spread to the lymph nodes when it reaches the normal skin. A\u00a0<strong>wedge biopsy\u00a0</strong>and MRI of the region involved confirm the diagnosis.</p>\n<p>Management is by\u00a0<strong>wide</strong>\u00a0<strong>excision</strong>, for larger ulcers, amputation is done.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/43f3e892e8b84a4d8f2e5ab7718aadf7.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient with a history of chronic liver disease presents with abdominal distension, jaundice, and pruritis. Ascitic fluid analysis revealed neutrophil count > 650 per cubic mm. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Spontaneous bacterial peritonitis"
      },
      {
        "id": 2,
        "text": "Malignant ascites"
      },
      {
        "id": 3,
        "text": "Tubercular ascites"
      },
      {
        "id": 4,
        "text": "Intestinal obstruction"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given scenario and image of a patient with abdominal distension, jaundice, pruritus, and neutrophil count &gt;650 per mm<sup>3</sup>, the likely diagnosis is <strong>spontaneous bacterial peritonitis.\u00a0\u00a0</strong></p>\n<p><strong>Spontaneous bacterial peritonitis</strong> (SBP) is an acute bacterial infection of the <strong>ascitic fluid.</strong> It is commonly seen in adults in association with liver cirrhosis. The pathogens involved are<em>\u00a0<strong>Escherichia coli</strong>,\u00a0</em>streptococci, enterococci, and pneumococci.\u00a0</p>\n<p>In a patient with ascites, SBP presents with fever, and acute abdominal pain. On examination, tachycardia, tachypnea, and signs of peritonitis are seen. <strong>Hepatic encephalopathy</strong> and<strong> gastrointestinal bleeding </strong>may also occur.\u00a0</p>\n<p>Diagnosis is by <strong>paracentesis, </strong>and an ascitic fluid <strong>neutrophil count of &gt;250/mm<sup>3</sup> </strong>is suggestive of spontaneous bacterial peritonitis. Ascitic fluid culture may reveal pathogenic organisms.</p>\n<p>Management is mainly by <strong>third-generation cephalosporins</strong> such as cefotaxime. Albumin infusion can be given as it decreases the risk of renal failure and improves patient survival. Early diagnosis and treatment improve the prognosis.</p>\n<p>Other options:</p>\n<p>Option B: <strong>Malignant ascites</strong> occurs as a complication of intra-abdominal and extra-abdominal malignancies.\u00a0Patients can present with increasing abdominal girth, generalized abdominal pain, and shortness of breath. Weight loss may be more common. Ascitic fluid analysis reveals a <strong>milky </strong>or<strong> bloody</strong> appearance with <strong>elevated</strong> levels of<strong> tumor markers</strong> and<strong> VEGF</strong> (vascular endothelial growth factor). Treatment is by <strong>paracentesis</strong> and <strong>peritoneovenous shunt.</strong></p>\n<p>Option C: <strong>Ascites </strong>is\u00a0often seen in patients with <strong>tubercular peritonitis</strong>. Multiple tubercles are seen on the peritoneum. Ascitic fluid analysis reveals a <strong>straw-colored fluid</strong> with a <strong>white blood cell count &gt;500 mm<sup>3</sup></strong>. Laparoscopy and peritoneal biopsy may be helpful in diagnosis. Management is by supportive and anti-tubercular therapy. \u00a0</p>\n<p>Option D:<strong> Intestinal obstruction</strong>\u00a0can present as pain, abdominal distension, <strong>vomiting</strong>, and <strong>absolute constipation</strong>. Abdominal radiographs taken in a supine position are useful in diagnosis. Abdominal <strong>radiograph</strong> in erect posture shows <strong>fluid levels</strong>. Management is mainly by insertion of a nasogastric tube, replacement of fluid and electrolytes, and surgery.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/842f4578c83b459bab53066e7d7f51df.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the stage of the breast cancer shown in the image?",
    "choices": [
      {
        "id": 1,
        "text": "T2c"
      },
      {
        "id": 2,
        "text": "T4a"
      },
      {
        "id": 3,
        "text": "T2a"
      },
      {
        "id": 4,
        "text": "T4b"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image shows&nbsp;Peau d'orange appearance of breast which is <strong>T4b&nbsp;</strong>according to the&nbsp;TNM staging.</p>\n<p>Tumour of&nbsp;<strong>any size</strong>&nbsp;with overlying&nbsp;<strong>skin</strong>&nbsp;involvement(Peau d'orange appearance) is <strong>T4b</strong>.</p>\n<p>The peau d'orange appearance of the breast occurs due to&nbsp;<strong>blockade of sub-dermal lymphatics.</strong>The&nbsp;<strong>lymphatic blockade</strong>&nbsp;gives rise to edema in the breast and tries to swell up. Since the infiltrated skin is tethered to the ligaments of Cooper, the swelling is restricted.&nbsp;The resultant edema deepens the mouth of the sweat glands and hair follicles giving rise to the typical orange peel appearance.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/a572991212044f9f89099f6f4f1d0c29.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "You have posted a 43-year-old woman with abnormal uterine bleeding for dilatation and curettage in the minor OT.  Identify the following instrument used in this procedure.",
    "choices": [
      {
        "id": 1,
        "text": "Blake's uterine curette"
      },
      {
        "id": 2,
        "text": "Sim's curette"
      },
      {
        "id": 3,
        "text": "Simpson's uterine sound"
      },
      {
        "id": 4,
        "text": "Sim's anterior vaginal wall retractor"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The instrument shown in the image is <strong>Sim's curette.</strong>&nbsp;It is a <strong>single-ended</strong> uterine curette used for <strong>dilatation and curettage</strong>.</p>\n<p>It is designed&nbsp;to remove tough tissue from the lining of the uterus for biopsy or excision. The curette features a <strong>sharp loop tip</strong> to aid in the removal of the uterine tissue.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/17ffb6b6457b4b9eacd12563441c3f9a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/735004f4d6b9440b898e4b5b209ba8c1x1200x1164.JPEG"
    ]
  },
  {
    "text": "A patient with a history of obstructed labor and cesarean section presents with continuous dribbling of urine through vagina on day 7. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Vesicouterine fistula"
      },
      {
        "id": 2,
        "text": "Urethrovaginal fistula"
      },
      {
        "id": 3,
        "text": "Ureterovaginal fistula"
      },
      {
        "id": 4,
        "text": "Vesicovaginal fistula"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical scenario is suggestive of<strong> vesicovaginal fistula.</strong></p>\n<p><strong>Vesicovaginal fistula</strong>\u00a0(VVF) is a type of\u00a0<strong>genital fistula,</strong>\u00a0which is an\u00a0<strong>abnormal communication</strong>\u00a0between the genital tract and the urinary tract.</p>\n<p>Vesicovaginal fistulae occur mostly due to\u00a0<strong>obstetric injuries</strong>\u00a0such as prolonged labor, and instrumental or manipulative deliveries. Patients present with\u00a0<strong>true incontinence</strong>\u00a0characterized by\u00a0<strong>constant dribbling of urine.</strong>\u00a0The presence of urine in the undergarments is uncomfortable and leads to\u00a0<strong>pruritus</strong>\u00a0and\u00a0<strong>excoriation</strong>\u00a0of the genital area</p>\n<p>In obstructed labour, <strong>ischemia necrosis</strong> occurs as a result of prolonged compression effect on the bladder base between the head and symphysis pubis leading to <strong>infection</strong> \u2192 <strong>sloughing</strong> \u2192 <strong>fistula.</strong> Thus, it takes around <strong>3\u20135 days</strong> following delivery to <strong>produce a fistula.</strong></p>\n<p>Clinical assessment by the introduction of a speculum helps to determine the size, number, and location of the fistulae. A\u00a0<strong>methylene blue test</strong>\u00a0helps confirm the diagnosis and determine the type of repair operation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2761de01ce7d460f8064ffbc7c6d55e2x1280x1082.JPEG"
    ]
  },
  {
    "text": "Which of the following statements is false regarding the image given below?",
    "choices": [
      {
        "id": 1,
        "text": "Skin condition is characterized by thickened, gray-brown velvety plaques seen in flexure areas such as the back of the neck, axillae, inframammary creases, waist, and groin"
      },
      {
        "id": 2,
        "text": "Presents only in patients with PCOD"
      },
      {
        "id": 3,
        "text": "It develops more frequently in obese women with PCOS than in those with PCOS and normal weight"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The condition in the given image is acanthosis nigricans; being a cutaneous marker of insulin resistance, <strong>acanthosis nigricans may be found in individuals with or without PCOS</strong>.</p>\n<ul>\n<li>Skin condition is characterized by <strong>thickened, gray-brown velvety plaques seen in flexure areas</strong> such as the back of the neck, axillae, inframammary creases, waist, and groin.</li>\n<li>Acanthosis nigricans develops more frequently in <strong>obese women with PCOS</strong> (50 percent incidence) than in those with PCOS and normal weight (5&ndash;10 percent).</li>\n</ul>\n<p>Acanthosis nigricans can also be seen in the following:</p>\n<ul>\n<li>Obesity&nbsp;</li>\n<li>Metabolic syndromes (Type 2 diabetes with insulin resistance)</li>\n<li>Drugs such as Nicotinic acid used to treat hyperlipidemia&nbsp;</li>\n<li>Sudden onset of multiple seborrhoeic keratosis&nbsp;</li>\n<li>Gastrointestinal malignancies such as adenocarcinoma of the stomach or pancreas</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f249034277bf42e4aa680355bba6a100.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "With respect to the condition shown below, choose the false statement.",
    "choices": [
      {
        "id": 1,
        "text": "Loss of abduction of the arm"
      },
      {
        "id": 2,
        "text": "Loss of lateral rotation of the arm"
      },
      {
        "id": 3,
        "text": "Loss of sensation in the lateral 2 fingers"
      },
      {
        "id": 4,
        "text": "Loss of flexion of the elbow"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shows&nbsp;<strong>Erb's palsy</strong> (waiter's tip deformity) in which there is a <strong>loss of sensation</strong> over a small area of the <strong>lower part of the deltoid</strong>.</p>\n<p>It is caused by injury to C5, C6 and rarely C7. It is seen most commonly in babies with shoulder dystocia at delivery.</p>\n<p>The following are seen in Erb's palsy:</p>\n<ul>\n<li>Loss of abduction and lateral rotation of the arm</li>\n<li>Loss of flexion of the elbow</li>\n<li>Loss of supination of the forearm</li>\n<li>Loss of biceps, supinator and inverse supinator jerks</li>\n<li>Loss of sensation over a small area of the lower part of the deltoid</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8bd0bde61eb3402096d99977376e67e1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/513c89cb4e404ffb88ce5f20bd226e18x1280x1622.JPEG"
    ]
  },
  {
    "text": "The device shown in the image is used as a primary feeding method during routine feeding in neonates with a gestational age of _______",
    "choices": [
      {
        "id": 1,
        "text": "28-31 weeks"
      },
      {
        "id": 2,
        "text": "32-34 weeks"
      },
      {
        "id": 3,
        "text": ">34 weeks"
      },
      {
        "id": 4,
        "text": "Any gestational age"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows <strong>paladai</strong>. It can be used as a primary feeding method during routine feeding in neonates born at <strong>gestational age 32-34 weeks</strong>.</p>\n<p>Feeding of neonates depends on their gestational age as it depends on the level of maturity of the neonate.</p>\n<p>Choice of initial feeding methods in low-birth-weight (LBW) infants</p>\n<table style=\"width: 434px; height: 564px;\">\n<tbody>\n<tr>\n<td style=\"width: 95px;\"><strong>Gestational Age</strong></td>\n<td style=\"width: 187px;\"><strong>Feeding Skill Matured</strong></td>\n<td style=\"width: 130px;\"><strong>Method of Feeding</strong></td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">&lt;28 weeks</td>\n<td style=\"width: 187px;\">No proper sucking effort. No propulsive motility of the gut</td>\n<td style=\"width: 130px;\">IV Fluids</td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">28-32 weeks</td>\n<td style=\"width: 187px;\">\n<p>Sucking bursts develop</p>\n<p>No coordination between suck/swallow and breathing</p>\n</td>\n<td style=\"width: 130px;\">Oro-gastric/ Nasogastric tube feeding with occasional spoon/&nbsp;paaladai feeding</td>\n</tr>\n<tr>\n<td style=\"width: 95px;\"><strong>32-34 weeks</strong></td>\n<td style=\"width: 187px;\">Slightly mature sucking pattern. <strong>Coordination between breathing and swallowing begins</strong></td>\n<td style=\"width: 130px;\">Feeding by spoon/paladai/cup</td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">&gt;34 weeks</td>\n<td style=\"width: 187px;\">Mature sucking pattern. More coordination between breathing and swallowing</td>\n<td style=\"width: 130px;\">Breastfeeding</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5fea94624ff146618e5c1433e438a2e6.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is false about the condition, that is relieved by the technique shown in the picture?",
    "choices": [
      {
        "id": 1,
        "text": "Associated with carpopedal spasms"
      },
      {
        "id": 2,
        "text": "Leads to paraesthesias and numbness"
      },
      {
        "id": 3,
        "text": "Symptoms are due to hypercapnia"
      },
      {
        "id": 4,
        "text": "Presence of a frequent sighing during history taking"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The technique shown in the above image is of <strong>breathing in a bag technique</strong>. It relieves <strong>hypocapnia</strong> in hyperventilation syndrome.</p>\n<p>Hyperventilation syndrome is a&nbsp;habit of <strong>hyperventilation</strong> due to stress or any emotional upheaval.</p>\n<p>Symptoms occur due to&nbsp;<strong>hypocapnia</strong>&nbsp;due to carbon dioxide washout.</p>\n<ul>\n<li>Fatigue, chest pain, dizziness, headache, palpitations, sweating.</li>\n<li>If severe - carpopedal spasms, paraesthesias and loss of consciousness may occur.</li>\n</ul>\n<p>Diagnosis:</p>\n<ul>\n<li>Typical history of stress followed by symptoms.&nbsp;</li>\n<li>The patient&nbsp;<strong>frequently 'sighs'</strong> during the interview</li>\n</ul>\n<p>Treatment:&nbsp;<strong>Breathing in a bag</strong>- The patient is told to breathe in and out of a bag, so that they rebreathe the expired air and thus increase the levels of arterial CO2. This quickly reverts the symptoms.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/dffa0cce328445a488f5a7d8c76e2867.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The following catheter is used for?",
    "choices": [
      {
        "id": 1,
        "text": "Gastro-Esophageal varices"
      },
      {
        "id": 2,
        "text": "Embolectomy"
      },
      {
        "id": 3,
        "text": "Pulmonary artery catheterization"
      },
      {
        "id": 4,
        "text": "Urinary catheterization"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image shown above is the<strong> Swan-ganz catheter</strong> used for<strong> pulmonary artery catheterization</strong>. It is also called the pulmonary artery catheter. The standard pulmonary artery catheter is 110 cm long with a 7.0 \u2013 9.0 Fr circumference.\u00a0</p>\n<p><strong>Uses:</strong></p>\n<ul>\n<li>Measurement of pressures in right atrium, right ventricle and pulmonary artery</li>\n<li>Indirect measurement of left atrial pressure through pulmonary capillary wedge pressure</li>\n<li>Cardiac output</li>\n<li>Oxygen saturation- pulmonary samples to rule out left-right shunt</li>\n<li>Monitoring left ventricle filling pressure</li>\n<li>Differentiate cardiogenic from non cardiogenic pulmonary edema</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0866408f236145898d41c2cab4bfb072.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Based on the given immunofluorescence image, identify the vesiculobullous disorder.",
    "choices": [
      {
        "id": 1,
        "text": "Pemphigus vegatans"
      },
      {
        "id": 2,
        "text": "Pemphigus vulgaris"
      },
      {
        "id": 3,
        "text": "Epidermolysis bullosa aquisita"
      },
      {
        "id": 4,
        "text": "Pemphigoid"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This microscopic image of <strong>Direct immunofluorescence</strong> shows a characteristic <strong>&ldquo;Fish-Net&rdquo; appearance</strong>, seen in <strong>pemphigus Vulgaris</strong>&nbsp;due to <strong>IgG and C3 deposits</strong> in the epidermis.</p>\n<p>Direct immunofluorescence uses <strong>anti IgG antibodies</strong> which detects the <strong>Anti-desmoglein IgG antibodies</strong> deposited on the <strong>Desmosomes </strong>which are present intercellularly.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e9228c76eae348308603d675c3a2e085.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/156f2788f7c74184963cd732e44fb9dfx512x290.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/57c508942f094ac592fb7bc968ba2925x250x193.PNG"
    ]
  },
  {
    "text": "The Money bag heart is seen in:",
    "choices": [
      {
        "id": 1,
        "text": "Pericardial effusion"
      },
      {
        "id": 2,
        "text": "TGA"
      },
      {
        "id": 3,
        "text": "TOF"
      },
      {
        "id": 4,
        "text": "Pulmonary hypertension"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The Money bag heart is seen in <strong>pericardial</strong> <strong>effusion.</strong></p>\n<p>Plain PA chest X-ray shows an enlarged cardiac silhouette. There is <strong>effacement of the normal cardiac borders</strong>, development of a <strong>&lsquo;flask&rsquo;</strong> or &lsquo;<strong>water bottle&rsquo;</strong> cardiac configuration and bilateral hilar overlay which are features of pericardial effusion. It is also known as <strong>Money bag</strong> or <strong>leather bottle</strong>-shaped heart.</p>\n<p>Investigation of choice: <strong>Echocardiography</strong>.</p>\n<p>Signs on plain radiograph include:</p>\n<ul>\n<li>Globular enlargement of the cardiac shadow giving a&nbsp;<strong>water bottle</strong> configuration.</li>\n<li>Lateral CXR may show a vertical opaque line (pericardial fluid)&nbsp;separating a vertical lucent line directly behind the sternum (paracardial fat) anteriorly from a similar lucent vertical lucent line (epicardial fat) posteriorly; this is known as the&nbsp;<strong>Oreo cookie sign.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e6f2a2cf936b432b9bd736651e98ef7e.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c68fa0f4530d4a3cbf4a9615efd01e98x1024x1024.PNG"
    ]
  },
  {
    "text": "Identify the following instrument?",
    "choices": [
      {
        "id": 1,
        "text": "Unipolar cautery"
      },
      {
        "id": 2,
        "text": "Bipolar cautery"
      },
      {
        "id": 3,
        "text": "Harmonic scalpel"
      },
      {
        "id": 4,
        "text": "Ligasure"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given instrument is a <strong>Unipolar Cautery.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8474bdad7c1843699c125ce9122cdde1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following investigation is shown in the radiograph?",
    "choices": [
      {
        "id": 1,
        "text": "Barium swallow"
      },
      {
        "id": 2,
        "text": "Barium meal"
      },
      {
        "id": 3,
        "text": "Barium meal follow through"
      },
      {
        "id": 4,
        "text": "Barium enema"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The contrast radiograph given above shows the <strong>stomach</strong> and the <strong>duodenum</strong>. This is a double contrast radiograph of<strong> barium meal.</strong></p>\n<p>Barium meal examines the l<strong>ower half of esophagus, stomach, </strong>and entire <strong>duodenum.</strong></p>\n<p>Preparations and uses of barium sulfate as a contrast in GI imaging:</p>\n<ul>\n<li><strong>Barium swallow</strong> uses barium paste (for esothe phagus).</li>\n<li><strong>Barium mea</strong>l- 95% BaSO4 (for stomach and duodenum).</li>\n<li><strong>Barium meal follow through</strong> - 50% BaSO4 (for small bowel).</li>\n<li><strong>Barium enema</strong> -25% BaSO4 (for large bowel).</li>\n<li>For Single contrast films, barium alone is used. Double contrast films require air and barium which is better for small mucosal lesions.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4c029928acd2496bb979197d01c7abcf.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/4090e0e1ce054423a94b8f2a696cd78ax355x420.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f6e2f41aa2e4522bb3b8ed6ba5d3053x387x450.JPEG"
    ]
  }
];
        let quizName = 'Fmge Mini Test - 10 (Image Based)';
        const quizFilename = 'fmge-mini-test-10-image-based-2eaf927c.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2024"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>