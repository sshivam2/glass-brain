<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13 Screening - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Community Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">32</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following are true for a screening test?",
    "choices": [
      {
        "id": 1,
        "text": "1 and 5"
      },
      {
        "id": 2,
        "text": "1, 3, 4"
      },
      {
        "id": 3,
        "text": "2, 4, 5"
      },
      {
        "id": 4,
        "text": "1, 4, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Screening tests are done on <strong>apparently healthy individuals</strong>, the results of the test are <strong>relatively inaccurate</strong>, the tests are <strong>based on one criterion.</strong></p>\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The difference between screening and diagnostic tests is given below:</p>\n<table style=\"width: 507.83px; height: 437px;\">\n<tbody>\n<tr style=\"height: 34.8924px;\">\n<td style=\"width: 230px; text-align: center; height: 34.8924px;\"><strong>Screening test</strong></td>\n<td style=\"width: 263.83px; text-align: center; height: 34.8924px;\"><strong>Diagnostic test</strong></td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 230px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Done on apparently healthy</p>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 263.83px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Done on patients with signs and symptoms</p>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 19px;\">\n<td style=\"width: 230px; height: 19px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Applied to groups</p>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 263.83px; height: 19px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Applied to single patients</p>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 230px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Based on one criterion or cut-off point</p>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 263.83px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Based on evaluation of a number of symptoms, signs, and laboratory findings</p>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 230px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Less accurate</p>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 263.83px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>More accurate</p>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 230px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Less expensive</p>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 263.83px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>More expensive</p>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 230px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Not a basis for treatment</p>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 263.83px; height: 18px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Used as a basis for treatment</p>\n</div>\n</div>\n</div>\n</td>\n</tr>\n<tr style=\"height: 28px;\">\n<td style=\"width: 230px; height: 28px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The initiative comes from the investigator or agency providing care</p>\n</div>\n</div>\n</div>\n</td>\n<td style=\"width: 263.83px; height: 28px;\">\n<div class=\"page\" title=\"Page 156\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The initiative comes from a patient with a complaint</p>\n</div>\n</div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Screening tests are recommended in the following conditions:</p>\n<ul>\n<li>Early diagnosis&nbsp;changes the disease course</li>\n<li>In a disease with an asymptomatic stage</li>\n<li>In a disease with a test for diagnosis and treatment</li>\n<li>The natural history of the disease is well known</li>\n</ul>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Below is a diagram depicting the natural history of the disease. Which point marks the onset of symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Point A"
      },
      {
        "id": 2,
        "text": "Point B"
      },
      {
        "id": 3,
        "text": "Point C"
      },
      {
        "id": 4,
        "text": "Point D"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Point C represents a point where signs and symptoms appear.</p>\n<p>Various points marked in the image represent the following:</p>\n<p>Point A: Entry of <strong>infectious agent</strong> into the host.</p>\n<p>Point B: <strong>Pathological</strong> and physiological changes occur in the stage of the<strong> s</strong><strong>ubclinical phase. </strong>These changes are&nbsp;induced by the causative agent but are not sufficient enough to cause clinical signs and symptoms.</p>\n<p>Point C: Marks <strong>onset</strong> of clinical <strong>signs</strong> and <strong>symptoms.</strong></p>\n<p>Point D: Usual <strong>time of diagnosis </strong>at which&nbsp;clinical&nbsp;signs&nbsp;and&nbsp;symptoms&nbsp;are well&nbsp;evident.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8894745c29f847bab294a061643dd79d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/286471cc5d894f4eb0c2b760ad0b91a0x1280x908.JPEG"
    ]
  },
  {
    "text": "In the following natural history of disease flowchart, point A to C is called as?",
    "choices": [
      {
        "id": 1,
        "text": "Screening time"
      },
      {
        "id": 2,
        "text": "Lead time"
      },
      {
        "id": 3,
        "text": "Lag time"
      },
      {
        "id": 4,
        "text": "Generation time"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Lead time</strong>\u00a0is the period between the <strong>first possible time</strong> of detection (point A) and the <strong>usual time </strong>of diagnosis (point C).</p>\n<p><strong>Screening time</strong>\u00a0is the time difference between the\u00a0<strong>first point</strong>\u00a0of diagnosis and the\u00a0<strong>critical point</strong>\u00a0of diagnosis.</p>\n<p>Diagnosis of a disease before the <strong>critical point </strong>has a good outcome and reduces the severity by reversing the disease process. Diagnosis beyond the critical point treatment would be unsuccessful and/or permanent damage would have occurred.</p>\n<p>Screening must be done in conditions where there is a considerable time lag between the onset of disease and the usual time of diagnosis. That is conditions with a long lead time.</p>\n<p><strong>Generation time</strong>\u00a0is defined as the interval of time between the\u00a0<strong>onset</strong>\u00a0of infection by a host and the\u00a0<strong>maximal infectivity</strong>\u00a0of that host.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/35a5327f7cf447ab95eb8cd1a22a7fb9.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "In which of the following diseases, screening procedure increases the overall survival to the maximum?",
    "choices": [
      {
        "id": 1,
        "text": "Lung cancer"
      },
      {
        "id": 2,
        "text": "Prostate cancer"
      },
      {
        "id": 3,
        "text": "Colon cancer"
      },
      {
        "id": 4,
        "text": "Ovarian cancer"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Screening</strong> of <strong>colon cancer</strong>\u00a0increases the <strong>overall survival</strong> to the <strong>maximum.</strong></p>\n<p>Colon cancer has a <strong>long lead time</strong> and can be detected early before pathological changes occur. It can be curable if treated early, otherwise fatal in half the cases.\u00a0</p>\n<p>Early diagnosis and treatment before the critical point have a good outcome and reduce the severity by reversing the disease process. Diagnosis beyond the critical point treatment would be unsuccessful and/or permanent damage would have occurred.</p>\n<p>Other diseases that can be screened are:</p>\n<ul>\n<li>Cervical cancer</li>\n<li>Breast cancer</li>\n<li>Prostate cancer</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an example of prospective screening?",
    "choices": [
      {
        "id": 1,
        "text": "Cervical Pap smear in a 40 year old patient"
      },
      {
        "id": 2,
        "text": "Neonatal screening of a new-born baby for hypothyroidism"
      },
      {
        "id": 3,
        "text": "Screening of immigrants to a country"
      },
      {
        "id": 4,
        "text": "Urine for sugar screening in a 40 year old man"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Screening of<strong> immigrants </strong>to a country is an example of <strong>prospective </strong>screening.</p>\n<p><strong>Screening </strong>of disease&nbsp;is done to detect unrecognized disease or defect, in apparently healthy individuals, by means of rapidly applied tests, examinations, or other procedures.</p>\n<p>The difference between prospective and prescriptive screening is given below:</p>\n<table style=\"height: 188px; width: 590px;\">\n<tbody>\n<tr style=\"height: 30.2396px;\">\n<td style=\"width: 151px; height: 30.2396px;\">&nbsp;</td>\n<td style=\"width: 213.188px; text-align: center; height: 30.2396px;\"><strong>Prospective screening</strong></td>\n<td style=\"width: 201.812px; text-align: center; height: 30.2396px;\"><strong>Prescriptive screening</strong></td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 151px; height: 36px;\">Definition</td>\n<td style=\"width: 213.188px; height: 36px;\">People screened for others benefit</td>\n<td style=\"width: 201.812px; height: 36px;\">People screened solely for their own benefit</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 151px; height: 18px;\">Essential purpose</td>\n<td style=\"width: 213.188px; height: 18px;\">Disease control</td>\n<td style=\"width: 201.812px; height: 18px;\">Case detection</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 151px; height: 36px;\">Request for screening</td>\n<td style=\"width: 213.188px; height: 36px;\">Specific request from the authority</td>\n<td style=\"width: 201.812px; height: 36px;\">Request from physician</td>\n</tr>\n<tr style=\"height: 209px;\">\n<td style=\"width: 151px; height: 209px;\">Example</td>\n<td style=\"width: 213.188px; height: 209px;\">\n<ul>\n<li><strong>Immigrants</strong> for infectious diseases like tuberculosis syphilis, yellow fever, etc;</li>\n<li><strong>HIV screening</strong> during antenatal visits, sex workers.</li>\n<li>Screening of <strong>blood donors</strong>.</li>\n</ul>\n</td>\n<td style=\"width: 201.812px; height: 209px;\">\n<ul>\n<li><strong>Neonatal</strong> screening for hypothyroidism.</li>\n<li>Pap smear for detection of cervical <strong>cancer.</strong></li>\n<li>Testing of urine sugar for diabetes mellitus.</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Note:<strong>&nbsp;</strong>Most common&nbsp;neonatal disease to be screened for is neonatal hypothyroidism.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an example of prescriptive screening?",
    "choices": [
      {
        "id": 1,
        "text": "Screening of immigrants for yellow fever"
      },
      {
        "id": 2,
        "text": "Screening of blood donors"
      },
      {
        "id": 3,
        "text": "Screening of infants for phenylketonuria"
      },
      {
        "id": 4,
        "text": "HIV screening during antenatal visits"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Screening of infants for <strong>phenylketonuria</strong> is an example of&nbsp;<strong>prescriptive</strong> screening.</p>\n<p><strong>Screening </strong>of disease&nbsp;is done to detect unrecognized disease or defect, in apparently healthy individuals, by means of rapidly applied tests, examinations, or other procedures.</p>\n<p>The difference between prospective and prescriptive screening is given below:</p>\n<table style=\"height: 188px; width: 590px;\">\n<tbody>\n<tr style=\"height: 28.2604px;\">\n<td style=\"width: 155px; height: 28.2604px;\">&nbsp;</td>\n<td style=\"width: 205.142px; text-align: center; height: 28.2604px;\"><strong>Prospective screening</strong></td>\n<td style=\"width: 205.858px; text-align: center; height: 28.2604px;\"><strong>Prescriptive screening</strong></td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 155px; height: 36px;\">Definition</td>\n<td style=\"width: 205.142px; height: 36px;\">People screened for others benefit</td>\n<td style=\"width: 205.858px; height: 36px;\">People screened for their own benefit</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 155px; height: 18px;\">Essential purpose</td>\n<td style=\"width: 205.142px; height: 18px;\">Disease control</td>\n<td style=\"width: 205.858px; height: 18px;\">Case detection</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 155px; height: 36px;\">Request for screening</td>\n<td style=\"width: 205.142px; height: 36px;\">Specific request from the authority</td>\n<td style=\"width: 205.858px; height: 36px;\">Request from physician</td>\n</tr>\n<tr style=\"height: 209px;\">\n<td style=\"width: 155px; height: 209px;\">Example</td>\n<td style=\"width: 205.142px; height: 209px;\">\n<ul>\n<li><strong>Immigrants</strong> for infectious diseases like tuberculosis syphilis, yellow fever, etc;</li>\n<li><strong>HIV screening</strong> during antenatal visits, sex workers.</li>\n<li>Screening of <strong>blood donors</strong>.</li>\n</ul>\n</td>\n<td style=\"width: 205.858px; height: 209px;\">\n<ul>\n<li><strong>Neonatal</strong> screening for hypothyroidism.</li>\n<li>Pap smear for detection of cervical <strong>cancer.</strong></li>\n<li>Testing of urine sugar for diabetes mellitus.</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Note:<strong>&nbsp;</strong>Most common&nbsp;neonatal disease to be screened for is neonatal hypothyroidism.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an example of multiphasic screening?",
    "choices": [
      {
        "id": 1,
        "text": "Chest X-ray for TB in large populations"
      },
      {
        "id": 2,
        "text": "Annual health checkups"
      },
      {
        "id": 3,
        "text": "Pap smear in women above 40 years"
      },
      {
        "id": 4,
        "text": "Random blood sugar during antenatal visits"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Annual health checkups</strong> are an example of multiphasic screening.</p>\n<p>Types of screening:</p>\n<ol>\n<li><strong>Multiphasic screening</strong> is the application of <strong>two or more screening tests</strong> in combination with a large number of people <strong>at one time.</strong> Example- Annual health checkups.</li>\n<li><strong>High-risk</strong> or <strong>selective</strong> screening is done on high-risk groups. Example-<strong>&nbsp;</strong>MRI screening of breast done annually in 25-year old women with BRCA 1, BRCA 2 mutations in a first-degree relative.</li>\n<li><strong>Mass screening</strong> is a screening of a whole or <strong>large population</strong> like using a chest X-ray for TB screening in large populations. It is done for diseases with <strong>high prevalence.</strong></li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A large number of tests were done in series. Which of the following will be true?",
    "choices": [
      {
        "id": 1,
        "text": "Sensitivity and specificity will increase"
      },
      {
        "id": 2,
        "text": "Sensitivity will decrease, specificity will increase"
      },
      {
        "id": 3,
        "text": "Sensitivity and specificity will decrease"
      },
      {
        "id": 4,
        "text": "Sensitivity will increase, specificity will decrease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>When a large number of tests are done in <strong>series</strong>, net&nbsp;<strong>sensitivity </strong>is<strong> decreased </strong>and net<strong> specificity </strong>is<strong> increased.</strong></p>\n<p>Screening tests are done in&nbsp;<strong>series&nbsp;</strong>when the result of the <strong>first test determines</strong> whether to run the <strong>second</strong> <strong>test</strong> or not. e.g., HIV screening is done using consecutive ELISA.</p>\n<p>Screening tests are done in <strong>parallel&nbsp;</strong>when the second test is <strong>independently performed</strong> regardless of what the first test result is. Both the tests are done at the same time. For e.g., In LFT, multiple tests are done together like SGOT, SGPT, total bilirubin, alkaline phosphatase, etc.</p>\n<p>Following are the trends that are observed while evaluating screening tests:</p>\n<table style=\"width: 404.766px;\">\n<tbody>\n<tr style=\"height: 29.5972px;\">\n<td style=\"width: 113px; height: 29.5972px;\">&nbsp;</td>\n<td style=\"width: 141px; text-align: left; height: 29.5972px;\"><strong>Tests in Series</strong></td>\n<td style=\"width: 133.766px; text-align: left; height: 29.5972px;\"><strong>Tests in parallel</strong></td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 113px; height: 36px;\">Combined sensitivity</td>\n<td style=\"width: 141px; height: 36px;\">Decreases</td>\n<td style=\"width: 133.766px; height: 36px;\">Increases</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 113px; height: 36px;\">Combined specificity</td>\n<td style=\"width: 141px; height: 36px;\">Increases</td>\n<td style=\"width: 133.766px; height: 36px;\">Decreases</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 113px; height: 18px;\">Combined PPV</td>\n<td style=\"width: 141px; height: 18px;\">Increases</td>\n<td style=\"width: 133.766px; height: 18px;\">Decreases</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 113px; height: 18px;\">Combined NPV</td>\n<td style=\"width: 141px; height: 18px;\">Decreases</td>\n<td style=\"width: 133.766px; height: 18px;\">Increases&nbsp;</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Colon cancer screening is being done by a hemoccult stool test in a healthcare center. Patients who test positive, undergo a repeat stool hemoccult test. If the second test comes out positive, the individual is referred for more extensive evaluation. How is this method of screening affecting sensitivity and specificity?",
    "choices": [
      {
        "id": 1,
        "text": "Net sensitivity and net specificity are both increasing"
      },
      {
        "id": 2,
        "text": "Net sensitivity is decreasing and net specificity is increasing"
      },
      {
        "id": 3,
        "text": "Net sensitivity is increasing and net specificity  is decreasing"
      },
      {
        "id": 4,
        "text": "Net sensitivity  is decreasing and net specificity remains the same"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In the given scenario, tests are being performed in <strong>series</strong>. Here, the net<strong> sensitivity </strong>is&nbsp;<strong>decreasing</strong>&nbsp;and net <strong>specificity</strong> is <strong>increasing</strong>.</p>\n<p>Screening tests are done in&nbsp;<strong>series,&nbsp;</strong>where the result of the <strong>first test determines</strong> whether to run the <strong>second test</strong> or not. e.g. HIV screening is done using consecutive ELISA.</p>\n<p>Screening tests are done in <strong>parallel,&nbsp;</strong>where the second test is <strong>independently performed</strong> regardless of what the first test result is. Both the tests are done at the same time. For e.g. In LFT, multiple tests are done together like SGOT, SGPT, total bilirubin, alkaline phosphatase, etc.</p>\n<p>Following are the trends that are observed while evaluating screening tests:</p>\n<table style=\"width: 404.766px;\">\n<tbody>\n<tr style=\"height: 29.5972px;\">\n<td style=\"width: 113px; height: 29.5972px;\">&nbsp;</td>\n<td style=\"width: 141px; text-align: left; height: 29.5972px;\"><strong>Tests in Series</strong></td>\n<td style=\"width: 133.766px; text-align: left; height: 29.5972px;\"><strong>Tests in parallel</strong></td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 113px; height: 36px;\">Combined sensitivity</td>\n<td style=\"width: 141px; height: 36px;\">Decreases</td>\n<td style=\"width: 133.766px; height: 36px;\">Increases</td>\n</tr>\n<tr style=\"height: 36px;\">\n<td style=\"width: 113px; height: 36px;\">Combined specificity</td>\n<td style=\"width: 141px; height: 36px;\">Increases</td>\n<td style=\"width: 133.766px; height: 36px;\">Decreases</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 113px; height: 18px;\">Combined PPV</td>\n<td style=\"width: 141px; height: 18px;\">Increases</td>\n<td style=\"width: 133.766px; height: 18px;\">Decreases</td>\n</tr>\n<tr style=\"height: 18px;\">\n<td style=\"width: 113px; height: 18px;\">Combined NPV</td>\n<td style=\"width: 141px; height: 18px;\">Decreases</td>\n<td style=\"width: 133.766px; height: 18px;\">Increases&nbsp;</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Blood pressure is measured in an individual 5 times a day under the same conditions by a new screening test. All 5 readings obtained are the almost same. What is the attribute of a new screening test being described?",
    "choices": [
      {
        "id": 1,
        "text": "Validity"
      },
      {
        "id": 2,
        "text": "Reliability"
      },
      {
        "id": 3,
        "text": "Sensitivity"
      },
      {
        "id": 4,
        "text": "Predictive accuracy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The attribute of a new screening test to yield the <strong>same reading</strong> when <strong>repeated</strong> under the same conditions is called <strong>reliability</strong>.</p>\n<div class=\"page\" title=\"Page 159\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Reliability is also called precision or reproducibility.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Ten successive readings of hemoglobin level of a single sample measured by a new method are given below. The hemoglobin level measured by the previous standard test was 10.2. What is true regarding the new method?",
    "choices": [
      {
        "id": 1,
        "text": "High validity, low reliability"
      },
      {
        "id": 2,
        "text": "Low validity, low reliability"
      },
      {
        "id": 3,
        "text": "Low validity, high reliability"
      },
      {
        "id": 4,
        "text": "High validity, high reliability"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The new method for measuring hemoglobin has <strong>high validity </strong>and<strong> low reliability.</strong></p>\n<p>The new test doesn\u2019t give the same values on repeat testing, thus it has <strong>low reliability.\u00a0</strong>The mean value of all the readings is <strong>10</strong>. The mean is close to the value of 10.2, which is obtained from the standard test, making the <strong>validity high</strong>.</p>\n<p>The <strong>validity</strong> of a test implies that the test must give correct and <strong>accurate</strong> results. It represents the <strong>closeness</strong> to a true/ actual value.</p>\n<p>The <strong>reliability</strong> of a test implies that the test must give <strong>consistent</strong> results when repeated on the same individual or material, under the same conditions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Out of 100 people having lung cancer, 60 tested positive by a new screening test. Out of 900 people who don't have lung cancer, 300 tested positive. What will be the numerator while calculating sensitivity and its value?",
    "choices": [
      {
        "id": 1,
        "text": "True positive, 60"
      },
      {
        "id": 2,
        "text": "False positive, 300"
      },
      {
        "id": 3,
        "text": "True negative, 600"
      },
      {
        "id": 4,
        "text": "False negative, 40"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>numerator</strong> of <strong>sensitivity</strong> in a screening test is <strong>true positive\u00a0</strong>and its value is <strong>60.</strong></p>\n<p>True positives are those people who tested positive and actually have the disease. Out of 100 people with lung cancer, 60 are tested positive i.e. true positive.</p>\n<p>The given data is represented below:</p>\n<table>\n<tbody>\n<tr>\n<td width=\"127\">\n<p>\u00a0</p>\n</td>\n<td width=\"136\">\n<p><strong>Disease +</strong></p>\n</td>\n<td width=\"119\">\n<p><strong>Disease -</strong></p>\n</td>\n<td width=\"136\">\n<p><strong>Total</strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"127\">\n<p><strong>Test +</strong></p>\n</td>\n<td width=\"136\">\n<p>60(TP)</p>\n</td>\n<td width=\"119\">\n<p>300(FP)</p>\n</td>\n<td width=\"136\">\n<p>360</p>\n</td>\n</tr>\n<tr>\n<td width=\"127\">\n<p><strong>Test -</strong></p>\n</td>\n<td width=\"136\">\n<p>40(FN)</p>\n</td>\n<td width=\"119\">\n<p>600(TN)</p>\n</td>\n<td width=\"136\">\n<p>640</p>\n</td>\n</tr>\n<tr>\n<td width=\"127\">\n<p><strong>Total</strong></p>\n</td>\n<td width=\"136\">\n<p>100</p>\n</td>\n<td width=\"119\">\n<p>900</p>\n</td>\n<td width=\"136\">\n<p>1000</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>TP- true positive, FP- false positive, FN- false negative, TN- true negative</p>\n<p>Sensitivity is the ability of a screening test to detect true positive(TP) out of the total number of people who have the disease (TP+FN).</p>\n<p><strong>Sensitivity= TP/ TP+FN =\u00a0</strong>60/60+40 = 60%</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A screening test was carried out among 114 people out of which 15 have a disease. The test showed 22 people tested positive for the disease among which 14 actually had the disease. What is the sensitivity of the test?",
    "choices": [
      {
        "id": 1,
        "text": "37%"
      },
      {
        "id": 2,
        "text": "63%"
      },
      {
        "id": 3,
        "text": "93%"
      },
      {
        "id": 4,
        "text": "97%"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>sensitivity</strong> of the above screening test is <strong>93%.</strong></p>\n<p>The given data is represented below</p>\n<table>\n<tbody>\n<tr>\n<td width=\"127\">\n<p>&nbsp;</p>\n</td>\n<td width=\"136\">\n<p><strong>Disease +</strong></p>\n</td>\n<td width=\"119\">\n<p><strong>Disease -</strong></p>\n</td>\n<td width=\"136\">\n<p><strong>Total</strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"127\">\n<p><strong>Test +</strong></p>\n</td>\n<td width=\"136\">\n<p>14(TP)</p>\n</td>\n<td width=\"119\">\n<p>8(FP)</p>\n</td>\n<td width=\"136\">\n<p>22</p>\n</td>\n</tr>\n<tr>\n<td width=\"127\">\n<p><strong>Test -</strong></p>\n</td>\n<td width=\"136\">\n<p>1(FN)</p>\n</td>\n<td width=\"119\">\n<p>91(TN)</p>\n</td>\n<td width=\"136\">\n<p>92</p>\n</td>\n</tr>\n<tr>\n<td width=\"127\">\n<p><strong>Total</strong></p>\n</td>\n<td width=\"136\">\n<p>15(TP+FN)</p>\n</td>\n<td width=\"119\">\n<p>99(FP+TN)</p>\n</td>\n<td width=\"136\">\n<p>114</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>TP- true positive, FP- false positive, FN- false negative, TN- true negative</p>\n<p>Sensitivity is given as <strong>TP/(TP + FN) x 100 </strong>= 14/15 = <strong>93%.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A researcher finds out a sensitive test to be positive for a person. For diagnosis, which of the following will hold true?",
    "choices": [
      {
        "id": 1,
        "text": "It confirms that the person does not have the disease"
      },
      {
        "id": 2,
        "text": "It suggests that if the disease is rare, the person surely has the disease"
      },
      {
        "id": 3,
        "text": "It confirms that the person has the disease if the disease is common"
      },
      {
        "id": 4,
        "text": "It is an expected finding in case the disease is prevalent"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A sensitive test, if it is <strong>positive</strong> it&nbsp;<strong>confirms</strong> that the person has the <strong>disease</strong> if the <strong>disease is common.</strong></p>\n<p>The <strong>sensitivity&nbsp;</strong>of a screening test is the ability of the test to identify correctly those who have the disease. In other words, Sensitivity is the ability of a test to <strong>detect true positives</strong> (TP) out of total disease (TP+FN).</p>\n<p>Sensitivity = TP/ TP+FN</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "1000 patients from a healthcare setup were screened for disease 'X' with a new test (biopsy). The test showed positive results in 90 patients out of the 100 who actually had the disease. What is the sensitivity of the new test?",
    "choices": [
      {
        "id": 1,
        "text": "90/100"
      },
      {
        "id": 2,
        "text": "100/110"
      },
      {
        "id": 3,
        "text": "(90-10)/1000"
      },
      {
        "id": 4,
        "text": "90/1000"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> sensitivity</strong> of new test is<strong> 90/100.\u00a0</strong></p>\n<p>Biopsy gives the definitive number of cases for Disease X. Hence, the given data is represented below:</p>\n<table style=\"height: 102px;\" width=\"521\">\n<tbody>\n<tr>\n<td style=\"width: 166.328px;\">\u00a0</td>\n<td style=\"width: 166.328px;\"><strong>Disease +</strong></td>\n<td style=\"width: 166.344px;\"><strong>Disease -</strong></td>\n</tr>\n<tr>\n<td style=\"width: 166.328px;\"><strong>Test +</strong></td>\n<td style=\"width: 166.328px;\">90(TP)</td>\n<td style=\"width: 166.344px;\">unknown</td>\n</tr>\n<tr>\n<td style=\"width: 166.328px;\"><strong>Test -</strong></td>\n<td style=\"width: 166.328px;\">10(FN)</td>\n<td style=\"width: 166.344px;\">unknown</td>\n</tr>\n<tr>\n<td style=\"width: 166.328px;\"><strong>Total</strong></td>\n<td style=\"width: 166.328px;\">100</td>\n<td style=\"width: 166.344px;\">\u00a0</td>\n</tr>\n</tbody>\n</table>\n<p>Sensitivity = <strong>TP/(TP+FN)</strong>\u00a0= 90/(90+10) = 90/100 = 90%</p>\n<p>True positive is defined as a positive test result in a person who has the disease.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Specificity of a screening test is the ability of a test to detect:",
    "choices": [
      {
        "id": 1,
        "text": "True positives"
      },
      {
        "id": 2,
        "text": "False positives"
      },
      {
        "id": 3,
        "text": "True negatives"
      },
      {
        "id": 4,
        "text": "False negatives"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Specificity </strong>of a screening test is the ability of the test to identify correctly those who do not have the disease, i.e.&nbsp;<strong>true negative.</strong></p>\n<p><strong>Sensitivity&nbsp;</strong>of a screening test is the ability of the test to identify correctly those who have the disease,&nbsp;i.e.&nbsp;<strong>true positive.</strong></p>\n<p><strong>False-positive</strong> are those who don't have the disease but tested positive.</p>\n<p><strong>False-negative</strong> are those who have the disease but tested negative.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "5000 persons underwent screening for a disease. Out of 500 diseased, 350 tested positive, and out of healthy people, 3000 tested negative. Which of the following is true?",
    "choices": [
      {
        "id": 1,
        "text": "Sensitivity is 70% and Specificity is 80%"
      },
      {
        "id": 2,
        "text": "Specificity is 70% and Sensitivity is 80%"
      },
      {
        "id": 3,
        "text": "Specificity is 66.6% and Sensitivity is 70%"
      },
      {
        "id": 4,
        "text": "Sensitivity is 87.5% and Specificity is 66.6%"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The<strong> sensitivity</strong> of the above screening test is&nbsp;<strong>70%</strong> and<strong>&nbsp;Specificity</strong> is<strong> 66.6%.</strong></p>\n<p>The given data is represented below:</p>\n<table style=\"width: 343px;\">\n<tbody>\n<tr>\n<td style=\"width: 67px;\">\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 96px;\">\n<p><strong>Disease +</strong></p>\n</td>\n<td style=\"width: 78px;\">\n<p><strong>Disease -</strong></p>\n</td>\n<td style=\"width: 74px;\">\n<p>Total</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 67px;\">\n<p><strong>Test +</strong></p>\n</td>\n<td style=\"width: 96px;\">\n<p>350(TP)</p>\n</td>\n<td style=\"width: 78px;\">\n<p>1500(FP)</p>\n</td>\n<td style=\"width: 74px;\">\n<p>1850</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 67px;\">\n<p><strong>Test -</strong></p>\n</td>\n<td style=\"width: 96px;\">\n<p>150(FN)</p>\n</td>\n<td style=\"width: 78px;\">\n<p>3000(TN)</p>\n</td>\n<td style=\"width: 74px;\">\n<p>3150</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 67px;\">\n<p>Total</p>\n</td>\n<td style=\"width: 96px;\">\n<p>500(TP+FN)</p>\n</td>\n<td style=\"width: 78px;\">\n<p>4500(TN+FP)</p>\n</td>\n<td style=\"width: 74px;\">\n<p>5000</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Sensitivity</strong>&nbsp;= TP/(TP + FN) x 100 = 350/500 = 0.7 = <strong>70%.</strong></p>\n<p><strong>Specificity&nbsp;</strong>= TN/(FP + TN) x 100 = 3000/4500 = 0.6666 = <strong>66.6%.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "If a patient tests positive for a disease, which of the following represents the probability of her actually having the disease?",
    "choices": [
      {
        "id": 1,
        "text": "Sensitivity"
      },
      {
        "id": 2,
        "text": "Specificity"
      },
      {
        "id": 3,
        "text": "Positive predictive value"
      },
      {
        "id": 4,
        "text": "Negative predictive value"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Positive predictive value\u00a0</strong>implies the probability of a person with a<strong>\u00a0positive test</strong>, actually <strong>having</strong> the <strong>disease.</strong></p>\n<p>It is the ability of a test to detect true positive(TP) out of total positive(TP+FP) and it is directly <strong>proportional</strong> to the<strong> prevalence</strong> of a disease.</p>\n<p><strong>PPV= TP/TP+FP</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "To calculate the positive predictive value of a new screening test for breast carcinoma, what will you use for the denominator?",
    "choices": [
      {
        "id": 1,
        "text": "True positives + false negatives"
      },
      {
        "id": 2,
        "text": "True positives + true negatives"
      },
      {
        "id": 3,
        "text": "True positives + false positives"
      },
      {
        "id": 4,
        "text": "True negatives + false positives"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>denominator</strong> for the calculation of the <strong>positive predictive value</strong> of a screening test is&nbsp;<strong>true positives + false positives.</strong></p>\n<p>Positive predictive value <strong>(PPV)</strong> of a test is <strong>TP/(TP + FP) x 100.</strong></p>\n<p>It indicates the probability that a person with a positive test actually has the disease. It is <strong>directly proportional</strong> to the <strong>prevalence </strong>of a disease.</p>\n<p>Predictive value is affected by sensitivity, specificity, and prevalence. However, it is affected the most by prevalence.<strong><br /></strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following maximally affect the positive predictive value of a test?",
    "choices": [
      {
        "id": 1,
        "text": "Sensitivity"
      },
      {
        "id": 2,
        "text": "Prevalence"
      },
      {
        "id": 3,
        "text": "Specificity"
      },
      {
        "id": 4,
        "text": "Negative predictive value"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Positive predictive value <strong>(PPV)</strong> is <strong>maximally affected</strong> by the <strong>prevalence</strong> of the disease.</p>\n<p>If&nbsp;the <strong>prevalence</strong> of a disease in a population is<strong> high,</strong> the <strong>high</strong> will be the <strong>positive predictive value</strong> of a screening test, and the <strong>more accurate</strong> will be the test. If the prevalence declines, the PPV will be low.</p>\n<p>PPV is directly <strong>proportional</strong> to the&nbsp;<strong>prevalence</strong>&nbsp;of a disease. It is affected the most by prevalence. However, both sensitivity and specificity can change the predictive value.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following reflects the diagnostic power of a screening test?",
    "choices": [
      {
        "id": 1,
        "text": "Predictive accuracy"
      },
      {
        "id": 2,
        "text": "Sensitivity"
      },
      {
        "id": 3,
        "text": "Reliability"
      },
      {
        "id": 4,
        "text": "Specificity"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>predictive accuracy </strong>of a screening test reflects its <strong>performance</strong> and<strong> diagnostic power.</strong></p>\n<p>Predictive accuracy is given by:</p>\n<ul>\n<li>Positive predictive value (<strong>PPV</strong>): the probability of a person with a positive test, <strong>actually having the disease.</strong></li>\n<li>Negative predictive value (<strong>NPV</strong>): the probability of a person with a negative test, definitely <strong>not having the disease.</strong></li>\n</ul>\n<p><strong>Sensitivity</strong> is the ability of a screening test to detect <strong>true positive</strong> out of total disease.</p>\n<p><strong>Specificity&nbsp;</strong>is the ability of a screening test to detect <strong>true negative</strong> out of total nondiseased.</p>\n<p>The&nbsp;<strong>reliability</strong>&nbsp;of a test implies that the test must give&nbsp;<strong>consistent</strong>&nbsp;results when repeated on the same individual or material, under the same conditions.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Screening of 100 immigrants for COVID-19 with a new test showed 48 positive and 52 people negative. Those who tested negative underwent RTPCR out of which 25 came positive. Which of the following is lowest for the new test compared to RTPCR?",
    "choices": [
      {
        "id": 1,
        "text": "Specificity"
      },
      {
        "id": 2,
        "text": "Sensitivity"
      },
      {
        "id": 3,
        "text": "Positive predictive value"
      },
      {
        "id": 4,
        "text": "Negative predictive value"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>sensitivity</strong> of the new screening test is<strong> low</strong> compared to RTPCR.</p>\n<p>The new screening test showed 52 people negative, out of which 25 are detected positive by RTPCR. i.e. 25 are false negative.</p>\n<div class=\"page\" title=\"Page 161\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The<strong> false-negative rate</strong>\u00a0is the number of false-negative out of total people having the disease.\u00a0</p>\n<p><strong>False-negative rate = 1 - Sensitivity</strong></p>\n</div>\n</div>\n</div>\n<p>The false-negative rate increases as sensitivity decreases.</p>\n<p>In this scenario, because the new test has more false negatives, it would have low sensitivity as compared to RTPCR.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "While screening a disease with a new screening test, the test is positive in many patients who actually don't have the disease. Which of the following is true?",
    "choices": [
      {
        "id": 1,
        "text": "Prevalence is high"
      },
      {
        "id": 2,
        "text": "Positive predictive value is high"
      },
      {
        "id": 3,
        "text": "Specificity is low"
      },
      {
        "id": 4,
        "text": "Sensitivity is low"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given new screening test has <strong>low</strong>\u00a0<strong>specificity.</strong></p>\n<p>The test is positive in many patients who actually don't have the disease, i.e. <strong>high false positives.</strong></p>\n<p>The false-positive rate is the number of false positives out of total non-diseased.</p>\n<p><strong>False-positive rate = 1-Specificity</strong></p>\n<p>The<strong> false-positive rate</strong> is <strong>inversely</strong> proportional to <strong>specificity.\u00a0</strong>Hence, the given test with high false positives will have low specificity.</p>\n<p>Positive predictive value\u00a0<strong>(PPV)= TP/TP+FP.\u00a0</strong>It shows the positive predictive value(<strong>PPV</strong>) of the test <strong>decreases</strong> with an increase in false positives.\u00a0</p>\n<p>An increase in the false-positive <strong>does not affect </strong>the <strong>prevalence</strong> of the disease. The prevalence of a disease depends on the incidence(I) and duration(D) of the disease.</p>\n<p><strong>Prevalance= I x D</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "ECG findings detecting the myocardial infarction obtained from the department of cardiology are given in the table below. Which of the following is true with regard to the below table?",
    "choices": [
      {
        "id": 1,
        "text": "Sensitivity is less than specificity"
      },
      {
        "id": 2,
        "text": "Sensitivity is the same as specificity"
      },
      {
        "id": 3,
        "text": "PPV is more than NPV"
      },
      {
        "id": 4,
        "text": "PPV is the same as NPV"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In the above scenario,\u00a0<strong>PPV is</strong>\u00a0the\u00a0<strong>same as</strong><strong>\u00a0NPV.</strong></p>\n<table style=\"height: 76px; width: 387px;\">\n<tbody>\n<tr>\n<td style=\"width: 100px;\">\u00a0</td>\n<td style=\"width: 124px; text-align: center;\">MI Present</td>\n<td style=\"width: 141px; text-align: center;\">MI Absent</td>\n</tr>\n<tr>\n<td style=\"width: 100px; text-align: center;\">Positive ECG</td>\n<td style=\"width: 124px; text-align: center;\">300(TP)</td>\n<td style=\"width: 141px; text-align: center;\">100(FP)</td>\n</tr>\n<tr>\n<td style=\"width: 100px; text-align: center;\">Negative ECG</td>\n<td style=\"width: 124px; text-align: center;\">25(FN)</td>\n<td style=\"width: 141px; text-align: center;\">75(TN)</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Predictive value of a positive test (PPV)</strong>\u00a0</p>\n<p>= TP/(TP + FP) x 100\u00a0= 300/(300+100) x 100= <strong>75 %</strong></p>\n<p><strong>Predictive value of a negative test (NPV)</strong></p>\n<p>= TN/(FN + TN) x 100 = 75/(25+75) x 100 = <strong>75 %</strong></p>\n<p>Hence <strong>PPV = NPV</strong></p>\n<p>In this scenario, sensitivity is 92% and the specificity is 43% as per the following calculation,</p>\n<p><strong>Sensitivity</strong>\u00a0= TP/(TP + FN) x 100 = 300/(300+25)\u00a0x100 = <strong>92%</strong></p>\n<p><strong>Specificity</strong>\u00a0= TN/(FP + TN) x 100 = 75/(100+75)\u00a0x100 = <strong>43%</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6aa1bfa90ed94cd0a275d6f1b394160a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A new test for hepatitis C is performed on 200 patients with the biopsy-proven disease and 200 patients who are free of the disease. The test shows positive results on 180 of the patients with the disease and negative results on 150 of the patients without the disease. Which of the following is true?",
    "choices": [
      {
        "id": 1,
        "text": "Positive predictive value is 90%"
      },
      {
        "id": 2,
        "text": "Negative predictive value is 75%"
      },
      {
        "id": 3,
        "text": "Specificity is 75%"
      },
      {
        "id": 4,
        "text": "Sensitivity is 78%"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The<strong> specificity</strong> of the above screening test is <strong>75%.</strong></p>\n<p>The given data is represented below:</p>\n<table style=\"width: 407px;\">\n<tbody>\n<tr>\n<td style=\"width: 60px;\">\n<p>&nbsp;</p>\n</td>\n<td style=\"width: 123px;\">\n<p><strong>Hep C +</strong></p>\n</td>\n<td style=\"width: 115px;\">\n<p><strong>Hep C -</strong></p>\n</td>\n<td style=\"width: 81px;\">\n<p><strong>Total</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 60px;\">\n<p><strong>Test +</strong></p>\n</td>\n<td style=\"width: 123px;\">\n<p>180(TP)</p>\n</td>\n<td style=\"width: 115px;\">\n<p>50(FP)</p>\n</td>\n<td style=\"width: 81px;\">\n<p>230</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 60px;\">\n<p><strong>Test -</strong></p>\n</td>\n<td style=\"width: 123px;\">\n<p>20(FN)</p>\n</td>\n<td style=\"width: 115px;\">\n<p>150(TN)</p>\n</td>\n<td style=\"width: 81px;\">\n<p>170</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 60px;\">\n<p><strong>Total</strong></p>\n</td>\n<td style=\"width: 123px;\">\n<p>200(TP+FN)</p>\n</td>\n<td style=\"width: 115px;\">\n<p>200(FP+TN)</p>\n</td>\n<td style=\"width: 81px;\">\n<p>400</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>TP- true positive, FP- false positive, FN- false negative, TN- true negative</p>\n<p><strong>Specificity&nbsp;</strong>= TN/(FP + TN) x 100 = 150/200 = 75%</p>\n<p><strong>Sensitivity</strong>&nbsp;= TP/(TP + FN) x 100 = 180/200 = 90%</p>\n<p><strong>PPV</strong>=&nbsp;TP/(TP + FP) x 100 = 180/230 = 78%</p>\n<p><strong>NPV</strong>=TN/(FN + TN) x 100 = 150/170 = 88%</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Due to an effective prevention program, the prevalence of a disease in a community has been reduced by 90%. However, the physicians continue to use the same screening test for that disease. Which of the following changes is expected to be seen?",
    "choices": [
      {
        "id": 1,
        "text": "Increase in negative predictive value"
      },
      {
        "id": 2,
        "text": "Increase in positive predictive value"
      },
      {
        "id": 3,
        "text": "Increase in specificity"
      },
      {
        "id": 4,
        "text": "Increase in sensitivity"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>If the prevalence of the disease falls, the <strong>negative predictive value</strong>(NPV)&nbsp;<strong>increases.</strong></p>\n<p>The<strong>&nbsp;NPV&nbsp;</strong>of the test is <strong>inversely </strong>proportional to the <strong>prevalence</strong> of a disease.</p>\n<p>The <strong>PPV</strong> of the test is<strong> directly</strong> proportional to the <strong>prevalence</strong> of a disease.</p>\n<p><strong>Sensitivity</strong> and <strong>specificity</strong> are <strong>independent of</strong> the <strong>prevalence</strong> of the disease in the area. They do not change with the change in prevalence.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a population of 10000, the prevalence of a disease is 20%. The sensitivity of a screening test is 95% and specificity is 80%. What is the positive predictive value of the test?",
    "choices": [
      {
        "id": 1,
        "text": "54.3%"
      },
      {
        "id": 2,
        "text": "45.7%"
      },
      {
        "id": 3,
        "text": "15.3%"
      },
      {
        "id": 4,
        "text": "98.5%"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The positive predictive value (<strong>PPV)</strong> of the test is\u00a0<strong>54.3%.</strong></p>\n<p>The prevalence of the disease is 20% in 10000, i.e., <strong>2000 </strong>people have the\u00a0<strong>disease</strong>(TP + FN) and <strong>8000 </strong>are <strong>disease-free</strong> (FP + TN).</p>\n<p>The sensitivity of the test is 95%, i.e. TP/(TP + FN) = 95%.</p>\n<p>Thus, the <strong>true positives (TP)</strong>=\u00a095/100 x (TP + FN) = 95/100 x 2000 = <strong>1900.</strong></p>\n<p>The specificity of the test is 80%, i.e. TN/(FP + TN) = 80%.</p>\n<p>Thus, the <strong>true negatives (TN)</strong>= 80/100 x (FP + TN) =\u00a080/100 x 8000 = <strong>6400.</strong></p>\n<p>The given data is represented below:</p>\n<table>\n<tbody>\n<tr>\n<td width=\"160\">\n<p>\u00a0</p>\n</td>\n<td width=\"160\">\n<p><strong>Disease +</strong></p>\n</td>\n<td width=\"160\">\n<p><strong>Disease -</strong></p>\n</td>\n<td width=\"160\">\n<p>Total</p>\n</td>\n</tr>\n<tr>\n<td width=\"160\">\n<p><strong>Test +</strong></p>\n</td>\n<td width=\"160\">\n<p>1900(TP)</p>\n</td>\n<td width=\"160\">\n<p>1600(FP)</p>\n</td>\n<td width=\"160\">\n<p>3500(TP+FP)</p>\n</td>\n</tr>\n<tr>\n<td width=\"160\">\n<p><strong>Test -</strong></p>\n</td>\n<td width=\"160\">\n<p>100(FN)</p>\n</td>\n<td width=\"160\">\n<p>6400(TN)</p>\n</td>\n<td width=\"160\">\n<p>6500(FN+TN)</p>\n</td>\n</tr>\n<tr>\n<td width=\"160\">\n<p>Total</p>\n</td>\n<td width=\"160\">\n<p>2000(TP+FN)</p>\n</td>\n<td width=\"160\">\n<p>8000(FP+TN)</p>\n</td>\n<td width=\"160\">\n<p>10000</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>TP- true positive, FP- false positive, FN- false negative, TN- true negative</p>\n<p>From the above table, <strong>PPV </strong>is calculated as TP/(TP + FP) x 100 = 1900/3500 =<strong>\u00a054.3%.</strong></p>\n<p>An<strong> alternate formula</strong>(<strong>Bayes</strong> theorem)\u00a0that can be used is\u00a0<strong>PPV</strong> = (Sn x P) / (Sn x P)+[(1-Sp)(1-P)]</p>\n<p>Sn- Sensitivity,\u00a0P- Prevalence,\u00a0Sp- Specificity</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The prevalence of the disease 'X' in a population is 30%. The diagnostic test for this disease has a specificity of 0.80 and a sensitivity of 0.90. What is the negative predictive value of the test?",
    "choices": [
      {
        "id": 1,
        "text": "45%"
      },
      {
        "id": 2,
        "text": "62%"
      },
      {
        "id": 3,
        "text": "70%"
      },
      {
        "id": 4,
        "text": "95%"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The negative predictive value of the above test is&nbsp;<strong>95%.</strong></p>\n<p>For convenience, let us assume that the total population in this scenario is <strong>100</strong>.</p>\n<p>The prevalence of the disease is 30%. So the total number of people with the <strong>disease </strong>is <strong>30</strong>(TP+FN) and <strong>disease-free</strong>(FP+TN)&nbsp;is&nbsp;<strong>70.</strong></p>\n<p>Since sensitivity is 0.90, i.e. TP/(TP + FN) = 90%.</p>\n<p>The total <strong>true positives (TP) =</strong>&nbsp;90/100 x (TP+FN) = 90/100 x 30 = <strong>27</strong></p>\n<p>False-negative(FN) = 30-27 =&nbsp;<strong>3</strong></p>\n<p>Since specificity is 0.80, i.e. TN/(FP+TN) = 80%.</p>\n<p>Total <strong>true negatives (TN)</strong>&nbsp;=(FP+TN) x 80/100 = 70 x 80/100 =<strong> 56</strong></p>\n<p>False-positive(FP) = 70-56 = <strong>14</strong></p>\n<p>The given data is represented below:</p>\n<table style=\"width: 300px;\">\n<tbody>\n<tr>\n<td style=\"width: 61px;\">\n<p><strong>&nbsp;</strong></p>\n</td>\n<td style=\"width: 78px;\">\n<p><strong>Disease +</strong></p>\n</td>\n<td style=\"width: 88px;\">\n<p><strong>Disease -</strong></p>\n</td>\n<td style=\"width: 45px;\">\n<p>Total</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 61px;\">\n<p><strong>Test +</strong></p>\n</td>\n<td style=\"width: 78px;\">\n<p>27 (TP)</p>\n</td>\n<td style=\"width: 88px;\">\n<p>14 (FP)</p>\n</td>\n<td style=\"width: 45px;\">\n<p>41</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 61px;\">\n<p><strong>Test -</strong></p>\n</td>\n<td style=\"width: 78px;\">\n<p>3 (FN)</p>\n</td>\n<td style=\"width: 88px;\">\n<p>56 (TN)</p>\n</td>\n<td style=\"width: 45px;\">\n<p>59</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 61px;\">\n<p>Total</p>\n</td>\n<td style=\"width: 78px;\">\n<p>30(TP+FN)</p>\n</td>\n<td style=\"width: 88px;\">\n<p>70(FP+TN)&nbsp;</p>\n</td>\n<td style=\"width: 45px;\">\n<p>100</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Negative predictive value<strong> (NPV) </strong>= TN/(FN + TN) x 100 = 56/59 = 0.949 = <strong>95%</strong>.</p>\n<p>An<strong> alternate formula</strong>(<strong>Bayes</strong> theorem)&nbsp;that can be used is <strong>NP</strong><strong>V</strong> = (1-P) x Sp /[P x (1-Sn)] +[(1-P) x Sp]</p>\n<p>Sn- Sensitivity,&nbsp;P- Prevalence,&nbsp;Sp- Specificity</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is best for determining the threshold for diagnosis of a positive test?",
    "choices": [
      {
        "id": 1,
        "text": "Pre test probability"
      },
      {
        "id": 2,
        "text": "Receiver operator characteristic curve"
      },
      {
        "id": 3,
        "text": "Pearson coefficient"
      },
      {
        "id": 4,
        "text": "Analysis of Variance"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>receiver operator characteristic curve</strong>&nbsp;is the best for determining the <strong>threshold</strong> for the diagnosis of a positive test. It is also used for the&nbsp;<strong>comparison</strong> of two or more screening/ diagnostic tests of disease with each other.</p>\n<p>The following is an example of a ROC curve for a screening test.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1da13b363b4e4fa1968e2ccda28db5bcx630x450.PNG"
    ]
  },
  {
    "text": "Which curve from the given image reflects a better test?",
    "choices": [
      {
        "id": 1,
        "text": "Test A"
      },
      {
        "id": 2,
        "text": "Test B"
      },
      {
        "id": 3,
        "text": "Test C"
      },
      {
        "id": 4,
        "text": "Test D"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Test A </strong>is the<strong> best </strong>test<strong>&nbsp;</strong>among the four given, as it has the highest sensitivity and the lowest false positive rate (100-specificity).</p>\n<p>A receiver&nbsp;operating characteristic curve<strong>(ROC)</strong> is obtained by plotting a test's true positive rate (<strong>sensitivity</strong>) against its false-positive rate ( <strong>100- specificity</strong>) for different diagnostic cut-off&nbsp;points.&nbsp;</p>\n<p>The shape of the curve reflects the quality of the test. The <strong>better</strong>&nbsp;the <strong>test</strong>, the more it <strong>moves to the upper left</strong>&nbsp;(more the area under the curve).<strong>&nbsp;</strong>For a good test, <strong>sensitivity</strong> comes close to <strong>100%</strong> on the y-axis, and the <strong>false positive rate</strong> comes close to <strong>0%</strong>&nbsp;on the x-axis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7ce2cf0861534857a124a94978d0b2f4.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The fasting blood glucose levels of a  population from two overlapping distributions are shown in the below graph. A test was done with the cutoff of 120mg/ dl for diagnosing diabetes. What does the shaded area represent?",
    "choices": [
      {
        "id": 1,
        "text": "True positives"
      },
      {
        "id": 2,
        "text": "True negatives"
      },
      {
        "id": 3,
        "text": "False positives"
      },
      {
        "id": 4,
        "text": "False negatives"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The shaded area<strong>&nbsp;</strong>represents the <strong>false positives</strong>&nbsp;(Non-diabetics incorrectly classified as diabetics).&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5ef2d1d44a2345539c184fa076393fcf.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Observe the following curves, which of the following is a true statement about sensitivity and specificity when the curve changes from green to pink?",
    "choices": [
      {
        "id": 1,
        "text": "Both sensitivity and specificity increase"
      },
      {
        "id": 2,
        "text": "Both sensitivity and specificity decrease"
      },
      {
        "id": 3,
        "text": "Sensitivity increases while specificity decreases"
      },
      {
        "id": 4,
        "text": "Sensitivity decreases while specificity increases"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Both <strong>sensitivity</strong> and <strong>specificity are higher </strong>in the test represented in pink (Test B) compared to the test represented in green (Test A).</p>\n<p>Sensitivity is the proportion of all people with the disease who test positive. It is the probability of the test being positive when the disease is present.</p>\n<p>Sensitivity = TP / (TP + FN) or<strong> Sensitivity = 1 \u2013 false-negative rate.</strong></p>\n<p>Specificity is the proportion of all people without the disease who test negative. It is the probability of the test being negative when the disease is absent.</p>\n<p>Specificity= TN / (TN + FP) or<strong> specificity= 1 \u2013 false-positive rate.</strong></p>\n<p>Test B has an increased number of true positives and true negatives and decreased number of false positives and negatives, compared to Test A.\u00a0</p>\n<p>Hence leading to<strong> increased sensitivity and specificity.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0756e6e153a94f78ac1f2e7feb59a809.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = '13 Screening';
        let hierarchy = ["Marrow", "qBank", "Community Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>