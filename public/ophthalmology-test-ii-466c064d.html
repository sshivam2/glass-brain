<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ophthalmology Test Ii - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2018 - 19
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "During the dark phase of the visual cycle, which form of vitamin A combines with opsin to form rhodopsin?",
    "choices": [
      {
        "id": 1,
        "text": "All trans-retinal"
      },
      {
        "id": 2,
        "text": "All trans-retinol"
      },
      {
        "id": 3,
        "text": "11- cis-retinal"
      },
      {
        "id": 4,
        "text": "11- cis-retinol"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Opsin</strong> combines with <strong>11-cis-retinal </strong>to produce <strong>rhodopsin.</strong></p>\n<p>Only the <strong>retinal</strong> form of <strong>vitamin A</strong> is involved in the formation of the photopigment.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/47eb9da3d68645e59f7c6254e57a9d71x1280x1623.JPEG"
    ]
  },
  {
    "text": "The most common cause of cataract is ______.",
    "choices": [
      {
        "id": 1,
        "text": "Hereditary"
      },
      {
        "id": 2,
        "text": "Diabetes mellitus"
      },
      {
        "id": 3,
        "text": "Trauma"
      },
      {
        "id": 4,
        "text": "Aging"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The most common cause of cataract is aging, i.e.,&nbsp;<strong>senile (age-related) cataract</strong>.</p>\n<p><strong>Senile Cataract</strong>:</p>\n<ul>\n<li>Cuneiform (70%): Most common</li>\n<li>Nuclear (25%)</li>\n<li>Cupuliform/posterior subcapsular (5%):&nbsp;most visually handicapping</li>\n</ul>\n<p>Important causes of cataract:</p>\n<ul>\n<li><strong>Congenital cataract</strong>: <strong>Crystallin gene</strong> - <em>CRYAA</em>, <em>CRYAB</em>, <em>CRYGC</em>, <em>CRYGS</em></li>\n<li>Aging (Most common)</li>\n<li>Diabetes mellitus</li>\n<li><strong>Syndermatotic</strong>: Atopic dermatitis is the most common skin condition associated with cataract</li>\n<li><strong>Galactosemia</strong>:&nbsp;reversible cataract</li>\n<li><strong>Radiation</strong>:&nbsp;UV rays, X-rays, gamma rays, infrared</li>\n<li>Toxic agents:&nbsp;<strong>Corticosteroids</strong>, <strong>miotics </strong>(long-acting anticholinesterases, e.g., echothiophate)</li>\n<li>Obesity</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Hollenhorst plaques are seen in _______.",
    "choices": [
      {
        "id": 1,
        "text": "Central retinal arterial occlusion ( CRAO)"
      },
      {
        "id": 2,
        "text": "Central retinal venous occlusion ( CRVO)"
      },
      {
        "id": 3,
        "text": "Cystoid macular edema"
      },
      {
        "id": 4,
        "text": "Central serous retinopathy"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Hollenhorst plaques</strong> are<strong> </strong>seen in <strong>central retinal arterial occlusion</strong> (CRAO).\u00a0</p>\n<p>They are <strong>cholesterol emboli</strong> seen in retinal arterioles. They originate from atherosclerotis plaques in larger arteries. The image below shows\u00a0Hollenhorst plaques (arrow).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f9406b7c3c704395877a1c566a3308a8x275x435.PNG"
    ]
  },
  {
    "text": "Which of the following best defines saccades?",
    "choices": [
      {
        "id": 1,
        "text": "Sudden jerky conjugate eye movements"
      },
      {
        "id": 2,
        "text": "Smooth slow eye movements"
      },
      {
        "id": 3,
        "text": "Flicks"
      },
      {
        "id": 4,
        "text": "Drifts"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Saccades</strong> are <strong>sudden, jerky eye</strong> movements that occur as the gaze shifts from one object to another.</p>\n<p>They are performed to bring the&nbsp;<strong>image of an object</strong> quickly <strong>on the fovea</strong>.</p>\n<p>The image below shows saccadic movement of the eyeball</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5ffe4c4710a241ceb134fed3a0ec3aaax720x480.GIF"
    ]
  },
  {
    "text": "Which of the following is not a feature of papilledema?",
    "choices": [
      {
        "id": 1,
        "text": "Extracellular edema"
      },
      {
        "id": 2,
        "text": "Axonal swelling"
      },
      {
        "id": 3,
        "text": "Stasis of axoplasmic flow"
      },
      {
        "id": 4,
        "text": "Disruption of neurofilament"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Disruption</strong> <strong>of neurofilaments is not a feature</strong> <strong>of papilledema.</strong></p>\n<p>Papilledema is the\u00a0<strong>swelling of the optic nerve head</strong> secondary to <strong>raised intracranial pressure (ICP). </strong></p>\n<p>\"Disc swelling\" and \"disc edema\" are non-specific terms that include papilledema but also indicate a disc swollen from other causes.</p>\n<p>All patients with papilledema should be <strong>suspected</strong> of harboring an<strong> intracranial mass.</strong></p>\n<p><strong>Features of papilledema:</strong></p>\n<ul>\n<li>Raised ICP</li>\n<li><strong>Edema </strong>of the\u00a0optic nerve head\n<ul>\n<li>Blockage of axoplasmic flow</li>\n<li>Axonal swelling</li>\n<li>Collection of extracellular fluid</li>\n</ul>\n</li>\n<li><strong>Painless progressive</strong> loss of vision</li>\n<li><strong>Enlargement </strong>of<strong>\u00a0</strong>the <strong>blind\u00a0spot</strong></li>\n<li>Color vision, visual acuity, and pupillary reaction are\u00a0<strong>n</strong><strong>ormal</strong>, until optic atrophy sets in.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young woman comes with sudden onset ocular pain, tearing, and photophobia in the left eye. You suspect a bacterial corneal ulcer. What concentration of cephazolin drops would you prescribe for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "2%"
      },
      {
        "id": 2,
        "text": "3%"
      },
      {
        "id": 3,
        "text": "4%"
      },
      {
        "id": 4,
        "text": "5%"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The concentration of fortified cephazolin used to treat uncomplicated bacterial keratitis is <strong>5% ( 50 mg/mL)</strong></p>\n<p><strong>Treatment of uncomplicated bacterial keratitis:</strong></p>\n<ul>\n<li><strong>Antibiotic</strong> eyedrops (broad-spectrum)</li>\n<li>If not responding, fortified antibiotic eye drops are used\n<ul>\n<li>Fortified cephazolin (5%)</li>\n<li>Fortified tobramycin (1.3%)</li>\n<li>Fortified vancomycin (5%)</li>\n</ul>\n</li>\n<li><strong>Cycloplegic drugs-</strong>\u00a0Preferably 1% atropine eye ointment or drops to prevent pain due to ciliary spasm. Also, it\u00a0prevents the development of posterior synechiae.</li>\n<li><strong>Oral vitamin A and vitamin C</strong> help in the\u00a0healing of the epithelium</li>\n<li><strong>Systemic analgesics</strong> and anti-inflammatory drugs</li>\n</ul>\n<p><strong>Management of non-healing ulcers:</strong></p>\n<ul>\n<li><strong>Debridement</strong></li>\n<li>Chemical <strong>cauterization-</strong>\u00a010\u201320% <strong>trichloroacetic acid, </strong>carbolic acid</li>\n<li>Conjunctival <strong>flapping</strong></li>\n</ul>\n<p><strong>Management of impending perforation:</strong></p>\n<ul>\n<li>Decrease intraocular pressure (IOP) by antiglaucoma drugs</li>\n<li>Tissue adhesive glue such as cyanoacrylate</li>\n<li>Bandage contact lens</li>\n<li>No strain</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ab66e42381bb46c1a4d6ac138f04a073.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A young patient with visual disturbances was found to have a brain tumour. He was referred to ophthalmology for a complete visual field assessment before planning his resection. Humprey analyzer revealed the following plot. What is the most likely site of the lesion?",
    "choices": [
      {
        "id": 1,
        "text": "Optic tract"
      },
      {
        "id": 2,
        "text": "Lateral geniculate body"
      },
      {
        "id": 3,
        "text": "Parietal lobe"
      },
      {
        "id": 4,
        "text": "Temporal lobe"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The visual field defect shown is the typical&nbsp;<strong>\"pie in the sky\"</strong> defect or <strong>superior&nbsp;quadrantic hemianopia.&nbsp;</strong>They are produced when the <strong>inferior fibers</strong> of the optic radiations in the <strong>temporal </strong>lobe (<strong>Meyer's loop)</strong> are involved.</p>\n<p><strong>\"Pie in the floor\"</strong> defects refer to <strong>inferior</strong> <strong>quadrantic hemianopia.</strong> It is seen in the involvement of the <strong>superior fibers</strong> of optic radiations in the&nbsp;<strong>parietal</strong> lobe (<strong>Baum's</strong>&nbsp;<strong>loop</strong>).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/73e45e019afa44639fa7ddb229ee3587.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The PARK procedure is used in the correction of which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Myopia"
      },
      {
        "id": 2,
        "text": "Hypermetropia"
      },
      {
        "id": 3,
        "text": "Astigmatism"
      },
      {
        "id": 4,
        "text": "Presbyopia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"text-align: left;\"><strong>PARK</strong> is a technique used for correcting <strong>a</strong><strong>stigmatism.</strong></p>\n<p style=\"text-align: left;\"><strong>Photo-astigmatic refractive keratotomy </strong>(PARK) is performed using excimer laser for the correction of astigmatism. The other<strong> surgical</strong> procedures used for correction of astigmatism are <strong>astigmatic keratotomy</strong>,<strong> LASIK</strong> and<strong> SMILE</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following disorders is not associated with retinitis pigmentosa?",
    "choices": [
      {
        "id": 1,
        "text": "Refsum's disease"
      },
      {
        "id": 2,
        "text": "Kearn-Sayre syndrome"
      },
      {
        "id": 3,
        "text": "Neuropathy, ataxia, and retinitis pigmentosa (NARP)"
      },
      {
        "id": 4,
        "text": "Abetaglobulinemia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Retinitis pigmentosa (RP) is associated with <strong>abetalipoprotenemia </strong>(Bassen&ndash;Kornzweig syndrome)<strong> and not with abetaglobulinemia.</strong></p>\n<p>&nbsp;</p>\n<table style=\"height: 117px;\" width=\"494\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 238.75px; text-align: center; height: 18px;\" colspan=\"2\"><strong>Syndromes associated with RP (Atypical RP)</strong></td>\n</tr>\n<tr style=\"height: 53px;\">\n<td style=\"width: 238.75px; height: 53px;\">Usher syndrome&nbsp;</td>\n<td style=\"width: 239.659px; height: 53px;\">Sensory neural<strong>&nbsp;</strong>deafness<strong>&nbsp;</strong>+ RP&nbsp;</td>\n</tr>\n<tr style=\"height: 96px;\">\n<td style=\"width: 238.75px; height: 96px;\">\n<p>Bardet&ndash;Biedl syndrome&nbsp;</p>\n<p>(Previously called Lawrence&ndash;Moon&ndash;Biedl&ndash;Bartum Syndrome)</p>\n</td>\n<td style=\"width: 239.659px; height: 96px;\">Polydactyly, obesity, mental handicap, and kidney disease + RP</td>\n</tr>\n<tr style=\"height: 57px;\">\n<td style=\"width: 238.75px; height: 57px;\">Kearn&ndash;Sayre syndrome</td>\n<td style=\"width: 239.659px; height: 57px;\">Ocular myopathy and heart disease + RP</td>\n</tr>\n<tr style=\"height: 64px;\">\n<td style=\"width: 238.75px; height: 64px;\">Refsum Syndrome&nbsp;</td>\n<td style=\"width: 239.659px; height: 64px;\">&nbsp;\n<p class=\"p1\">Varied skin as well as neurological and visceral features + RP</p>\n</td>\n</tr>\n<tr style=\"height: 66.679px;\">\n<td style=\"width: 238.75px; height: 66.679px;\">&nbsp;\n<p class=\"p1\">Bassen&ndash;Kornzweig syndrome</p>\n</td>\n<td style=\"width: 239.659px; height: 66.679px;\">Abetalipoprotenemia&nbsp;and acanthocytosis + RP</td>\n</tr>\n<tr style=\"height: 66.679px;\">\n<td style=\"width: 238.75px; height: 66.679px;\">Neuropathy, ataxia, and retinitis pigmentosa (NARP)</td>\n<td style=\"width: 239.659px; height: 66.679px;\">Neuropathy and Ataxia + RP&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The final center for the horizontal movement of the eye is ______.",
    "choices": [
      {
        "id": 1,
        "text": "Abducent nucleus"
      },
      {
        "id": 2,
        "text": "Trochlear nucleus"
      },
      {
        "id": 3,
        "text": "Vestibular nucleus"
      },
      {
        "id": 4,
        "text": "Oculomotor nucleus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The final center for the\u00a0<strong>horizontal</strong> movement of the\u00a0eye is the\u00a0<strong>abducent nucleus.</strong></p>\n<ul>\n<li>Paramedian pontine reticular formation (<strong>PPRF</strong>) is responsible for the\u00a0<strong>horizontal</strong> gaze, which projects to the ipsilateral <strong>abducens nucleus.</strong></li>\n<li>The brainstem center for the\u00a0<strong>vertical gaze</strong> is in rostral interstitial nucleus of Cajal in <strong>midbrain</strong>, above <strong>oculomotor</strong> nuclei.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following conditions is a cause of pseudoptosis?",
    "choices": [
      {
        "id": 1,
        "text": "Lambert\u2013Eaton syndrome"
      },
      {
        "id": 2,
        "text": "Big chalazion"
      },
      {
        "id": 3,
        "text": "Blepharophimosis syndrome"
      },
      {
        "id": 4,
        "text": "Brow ptosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Brow ptosis</strong> is a type of <strong>pseudoptosis,\u00a0</strong>not ptosis.</p>\n<p><strong>Ptosis</strong>\u00a0is abnormal drooping of the upper eyelid to a level that covers <strong>more</strong> <strong>than 2mm</strong> of the superior cornea.\u00a0</p>\n<p>Types of ptosis:</p>\n<ul>\n<li><strong>Mechanical</strong> ptosis <strong>- </strong>Can be due to<strong> </strong>lid <strong>tumors, </strong>multiple/big <strong>chalazions,</strong> and conjunctival <strong>scarring</strong></li>\n<li><strong>Aponeurotic</strong> ptosis <strong>- </strong>Due to <strong>dehiscence</strong> of the aponeurosis and in <strong>postoperative </strong>patients</li>\n<li><strong>Involutional </strong>ptosis seen in<strong> </strong>old age</li>\n<li><strong>Neurogenic </strong>ptosis due to a<strong> </strong>3<sup>rd</sup> nerve palsy, Horner syndrome and synkinetic ptosis/<strong>Marcus\u2013Gunn jaw-winking</strong> ptosis</li>\n<li><strong>Myogenic ptosis </strong>\n<ul>\n<li><strong>Congenital:</strong>\u00a0<strong>most common myogenic ptosis</strong>\n<ul>\n<li>Simple</li>\n<li><strong>Blepharophimosis</strong> syndrome</li>\n<li>Congenital synkinetic ptosis</li>\n</ul>\n</li>\n<li><strong>Acquired </strong>\n<ul>\n<li>Myasthenia gravis</li>\n<li>Lambert\u2013Eaton syndrome</li>\n<li>Ocular myopathy</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Causes of <strong>pseudoptosis\u00a0</strong>(apparent ptosis):</p>\n<ul>\n<li>Lack of support\u00a0of the lids by the globe e.g.\u00a0artificial eye, microphthalmos, phthisis bulbi, or enophthalmos.</li>\n<li>Contralateral lid retraction</li>\n<li>Ipsilateral hypotropia</li>\n<li><strong>Brow ptosis</strong>\u00a0occurs due to\u00a0<strong>excessive skin</strong>\u00a0on the brow, or seventh nerve palsy, which is diagnosed by manually elevating the<br />eyebrow\u00a0</li>\n<li>Dermatochalasis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the distance between point A and B shown below?",
    "choices": [
      {
        "id": 1,
        "text": "2 DD"
      },
      {
        "id": 2,
        "text": "3 DD"
      },
      {
        "id": 3,
        "text": "1.5 DD"
      },
      {
        "id": 4,
        "text": "1 DD"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the image, point A is the <strong>optic disc</strong> and point B is the <strong>fovea.</strong>\u00a0The\u00a0fovea is situated about <strong>2 disc diameters</strong> (3\u20134 mm) away from the temporal margin of the optic disc.</p>\n<p>The optic disc is an area of about 1.5 mm. There is a blind spot / physiological scotoma, corresponding to the\u00a0optic disc.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/165819ed7c934beeb4f0ec3bf87d3345.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b1b33eea2dd343969e040c6409c4862dx1280x1237.JPEG"
    ]
  },
  {
    "text": "The longest part of the optic nerve measures _____.",
    "choices": [
      {
        "id": 1,
        "text": "30 mm"
      },
      {
        "id": 2,
        "text": "40 mm"
      },
      {
        "id": 3,
        "text": "50 mm"
      },
      {
        "id": 4,
        "text": "20 mm"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Intraorbital part</strong> is the longest part of the optic nerve.</p>\n<p>It measures from <strong>25 mm to 30 mm.</strong></p>\n<p>Length of the optic nerve ranges from 3.5 cm to 5.5 cm.</p>\n<p>80% of the fibers originate from the macular region.</p>\n<p><strong>Parts of optic nerve:</strong></p>\n<table border=\"1\">\n<tbody>\n<tr>\n<td>\n<p><strong>Parts</strong></p>\n</td>\n<td>\n<p><strong>Length</strong></p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Intraocular part</p>\n</td>\n<td>\n<p><strong>1 mm</strong></p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Intraorbital part</p>\n</td>\n<td>\n<p><strong>25&ndash;30 mm</strong></p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Intracanalicular part</p>\n</td>\n<td>\n<p>5<strong>&ndash;</strong>9mm</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Intracranial part</p>\n</td>\n<td>\n<p>10<strong>&ndash;</strong>16 mm</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A woman with pathological myopia visits the ophthalmology OPD for an annual eye check-up. What is the least likely finding to be seen on her ophthalmologic examination?",
    "choices": [
      {
        "id": 1,
        "text": "Temporal myopic crescent"
      },
      {
        "id": 2,
        "text": "Posterior staphyloma"
      },
      {
        "id": 3,
        "text": "Foster Fuchs spots"
      },
      {
        "id": 4,
        "text": "Shallow anterior chamber"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>shallow anterior chamber</strong>\u00a0is <strong>not</strong> a feature of <strong>pathological myopia.</strong></p>\n<p><strong>Signs</strong> of pathological myopia include the following:</p>\n<ul>\n<li>Prominent eyeballs</li>\n<li>Large cornea</li>\n<li><strong>Deep</strong>\u00a0anterior chamber (AC)</li>\n<li>Fundus picture\n<ul>\n<li><strong>Large</strong>, <strong>pale optic disc</strong> with the\u00a0<strong>temporal myopic crescent</strong></li>\n<li>Degenerative changes in retina and choroid</li>\n<li><strong>Foster Fuchs spots</strong> (blackish spots due to retinal pigment epithelial hyperplasia)</li>\n</ul>\n</li>\n<li><strong>Lattice</strong> degeneration</li>\n<li><strong>Cystoid degeneration</strong></li>\n<li>Total retinal atrophy</li>\n<li><strong>Posterior staphyloma</strong></li>\n<li>Degenerative changes in the vitreous\u2014<strong>posterior vitreous detachment</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/36b297f217f54349a91af1e18b55fd3fx1280x1301.JPEG"
    ]
  },
  {
    "text": "What is the drug of choice under the SAFE strategy for trachoma management?",
    "choices": [
      {
        "id": 1,
        "text": "Azithromycin"
      },
      {
        "id": 2,
        "text": "Tetracycline"
      },
      {
        "id": 3,
        "text": "Doxycycline"
      },
      {
        "id": 4,
        "text": "Penicillin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Oral azithromycin</strong>\u00a0is the drug of choice in the <strong>SAFE strategy</strong> of trachoma management. The adult dose is <strong>1 g</strong>\u00a0while\u00a0<strong>20 mg/kg</strong> body weight is given for children.</p>\n<p>Oral azithromycin is slowly replacing tetracycline eye ointment as the first line drug used in trachoma treatment. The experience of Morocco, the first country that used azithromycin in a large-scale, nationwide elimination programme, has paved the way for the <strong>worldwide application of azithromycin as part of the SAFE strategy</strong>.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Soft contact lenses are made of _____.",
    "choices": [
      {
        "id": 1,
        "text": "Polymethylmethacrylate"
      },
      {
        "id": 2,
        "text": "Hydroxyethyl methyl acrylate"
      },
      {
        "id": 3,
        "text": "Cellulose acetate butyrate"
      },
      {
        "id": 4,
        "text": "Silicone"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Soft lenses</strong> are made up of<strong> hydroxyethyl methyl acrylate</strong>\u00a0(HEMA).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the test shown below.",
    "choices": [
      {
        "id": 1,
        "text": "Schirmer test"
      },
      {
        "id": 2,
        "text": "Ishihara test"
      },
      {
        "id": 3,
        "text": "Jones test"
      },
      {
        "id": 4,
        "text": "Goldmann's tonometry"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image shows a\u00a0<strong>tear strip</strong>\u00a0placed in the lower lid of the eye. This is the\u00a0<strong>Schirmer test\u00a0</strong>which is used to check for dry eye.</p>\n<p><strong>Dry</strong> <strong>eye\u00a0</strong>is a multifactorial disease of the eye characterised by loss of homeostasis of the tear film. Patients present with irritation, foreign body sensation and dryness.\u00a0Treatment of dry eye includes medical treatment (lubricating eyedrops, most commonly\u00a0<strong>methylcellulose</strong> derivatives) or surgical treatment (lacrimal punctum occlusion using <strong>silicone</strong> plugs).</p>\n<p>Other tests for dry eye include:\u00a0</p>\n<ol>\n<li><strong>Tear film break-up test</strong> is used to determine the interval between a complete blink and appearance of first randomly distributed dry spot on the cornea. A drop of fluorescein is instilled in the eye, following by examination in the cobalt-blue light of a slit-lamp.</li>\n<li><strong>Rose Bengal </strong>staining is used for the detection of dry, dead epithelium in dry eye.</li>\n<li><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Tear osmolarity test</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> is performed with an osmometer.\u00a0</span></li>\n</ol>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Other options:</span></p>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Option B:<strong> Ishihara</strong> plates are used to test colour vision. They help detect red-green colour blindness.\u00a0</span></p>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Option C: <strong>Jones</strong> test is used in watering eye. It uses fluorescein dye.\u00a0</span></p>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Option D: <strong>Goldmann's tonometry</strong> is used to measure intra-ocular pressure. It consists of a double prism mounted on a slit-lamp.\u00a0\u00a0</span></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/370bd2a124664a4b8cb0bcf1e73cbde1.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Pseudopapillitis is seen in which of the following conditions?",
    "choices": [
      {
        "id": 1,
        "text": "Myopia"
      },
      {
        "id": 2,
        "text": "Hypermetropia"
      },
      {
        "id": 3,
        "text": "Aphakia"
      },
      {
        "id": 4,
        "text": "Presbyopia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Pseudopapillitis </strong>is seen in&nbsp;<strong>hypermetropia</strong>.</p>\n<p>In hypermetropia, <strong>fundus examination</strong> shows an optic disc that is small, has ill-defined margins, appears highly vascular, and simulates papillitis. However, as the optic disc is not swollen, as seen in papillitis, it is also called <strong>pseudopapillitis</strong>. A shiny retina<span data-preserver-spaces=\"true\">&nbsp;is seen&nbsp;</span><span data-preserver-spaces=\"true\">due to the greater brilliance of light reflections known as <strong>shot silk appearance.</strong></span></p>\n<p>A fundus image showing the same is given below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2251bdbf906d4feda4ad232c0f285522x1280x1386.5162200282086.JPEG"
    ]
  },
  {
    "text": "What is the angle formed between the optic axis and visual axis at the nodal point?",
    "choices": [
      {
        "id": 1,
        "text": "\u03b1"
      },
      {
        "id": 2,
        "text": "\u03bb"
      },
      {
        "id": 3,
        "text": "\u03ba"
      },
      {
        "id": 4,
        "text": "\u03b3"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Angle alpha (\u03b1)</strong> is the angle between the\u00a0<strong>optical axis </strong>and <strong>visual axis </strong>at the\u00a0nodal point.\u00a0</p>\n<p><span lang=\"el\" title=\"Greek-language text\">Angle<strong> lambda (\u03bb) </strong></span><span lang=\"el\" title=\"Greek-language text\">is the angle between the <strong>pupillary</strong> axis and the <strong>line of sight.\u00a0\u00a0</strong>It is the global tilt offset of the eye when it fixates on a specific target and is a response to the eccentric displaced position of the fovea from the geometrical center of the retina. (Option B)</span></p>\n<p><span lang=\"el\" title=\"Greek-language text\">A</span>ngle<strong> kappa (\u03ba)\u00a0</strong>is the angle between the\u00a0<strong>visual axis </strong>and the\u00a0<strong>pupillary line </strong>at the\u00a0cornea. It is the only angle that\u00a0can be <strong>measured </strong>and is of clinical significance. (Option C)</p>\n<ul>\n<li><strong>Positive \u03ba </strong>is seen in\u00a0pseudo<strong>exotropia</strong></li>\n<li><strong>Negative \u03ba </strong>is seen in\u00a0pseudo<strong>esotropia</strong></li>\n</ul>\n<p><span lang=\"el\" title=\"Greek-language text\">A</span>ngle<strong> gamma (\u03b3)</strong>\u00a0is the angle between the\u00a0<strong>optical axis </strong>and the\u00a0<strong>fixation axis </strong>at the center of eyeball rotation. (Option D)</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A preterm baby treated for respiratory distress syndrome is found to have white pupillary reflex on opthalmologic examination. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Posterior persistent primary hyperplastic vitreous"
      },
      {
        "id": 2,
        "text": "Coat's retinopathy"
      },
      {
        "id": 3,
        "text": "Retrolental fibroplasia"
      },
      {
        "id": 4,
        "text": "Congenital cataract"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A preterm baby, treated for respiratory distress syndrome, with<strong> leucocoria </strong>(white pupillary reflex) most likely has <strong>retrolental</strong> <strong>fibroplasia.</strong></p>\n<p>Retrolental fibroplasia, also known as <strong>retinopathy </strong>of<strong> prematurity</strong>, is a proliferative retinopathy. Risk factors include\u00a0<strong>prematurity</strong>,<strong> </strong>very low birth weight and supplemental oxygen therapy (given for respiratory distress syndrome).\u00a0ROP can be mild and may resolve spontaneously, but may lead to blindness in serious cases.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17c7b700f1994c95bc233f1c355272edx510x2089.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5b296f457a3147068d95d5e99df7e3a4x1280x1392.JPEG"
    ]
  },
  {
    "text": "Which of the following is used to differentiate pseudophakia from aphakia?",
    "choices": [
      {
        "id": 1,
        "text": "Deep AC chamber"
      },
      {
        "id": 2,
        "text": "Purkinje image test"
      },
      {
        "id": 3,
        "text": "Iridodonesis"
      },
      {
        "id": 4,
        "text": "Limbal scar"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Pseudophakia </strong>shows\u00a0<strong>4\u00a0images</strong> in the Purkinje image test, whereas <strong>aphakia </strong>shows only<strong> 2 </strong>images.<strong> </strong>Other features can be seen in both.</p>\n<p>When aphakia is corrected with an <strong>intraocular lens implant </strong>(IOL), the condition is referred to as <strong>pseudophakia. </strong><strong>Signs </strong>of pseudophakia with posterior chamber IOL include:</p>\n<ul>\n<li><strong>Surgical scar</strong>\u00a0</li>\n<li>Anterior chamber\u00a0<strong>slightly deeper</strong> than normal</li>\n<li><strong>Mild iridodonesis</strong> (tremulousness) of the iris</li>\n<li>Purkinje image test <strong>shows 4 images</strong></li>\n<li>Pupil\u00a0<strong>blackish </strong>in color but when the light is thrown in the pupillary area, <strong>shining reflex</strong> is observed</li>\n</ul>\n<p><strong>Purkinje images </strong>are reflections of objects from the structure of the eye. They are also known as Purkinje reflexes or Purkinje\u2013Sanson images. Normally, 4 images are formed from four different reflecting surfaces i.e.</p>\n<table style=\"height: 156px; width: 466px;\">\n<tbody>\n<tr>\n<td style=\"width: 109px; text-align: center;\"><strong>Image\u00a0</strong></td>\n<td style=\"width: 234.828px; text-align: center;\"><strong>Location</strong></td>\n<td style=\"width: 97.1719px; text-align: center;\"><strong>Direction</strong></td>\n</tr>\n<tr>\n<td style=\"width: 109px; text-align: center;\">Image 1</td>\n<td style=\"width: 234.828px;\">Anterior surface of the cornea</td>\n<td style=\"width: 97.1719px;\">Erect</td>\n</tr>\n<tr>\n<td style=\"width: 109px; text-align: center;\">Image 2</td>\n<td style=\"width: 234.828px;\">Posterior surface of the cornea</td>\n<td style=\"width: 97.1719px;\">Erect</td>\n</tr>\n<tr>\n<td style=\"width: 109px; text-align: center;\">Image 3</td>\n<td style=\"width: 234.828px;\">Anterior surface of the\u00a0lens</td>\n<td style=\"width: 97.1719px;\">Erect</td>\n</tr>\n<tr>\n<td style=\"width: 109px; text-align: center;\">Image 4</td>\n<td style=\"width: 234.828px;\">Posterior surface of the\u00a0lens</td>\n<td style=\"width: 97.1719px;\">Inverted</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/aaffb43e6d9c4cbeba94171df63ad262x1280x1338.JPEG"
    ]
  },
  {
    "text": "Identify the stage of senile cataract depicted in the given image.",
    "choices": [
      {
        "id": 1,
        "text": "Intumescent cataract"
      },
      {
        "id": 2,
        "text": "Mature senile cataract"
      },
      {
        "id": 3,
        "text": "Morgagnian cataract"
      },
      {
        "id": 4,
        "text": "Sclerotic type of hypermature cataract"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image shows the characteristic appearance of\u00a0<strong>Morgagnian hypermature cataract</strong>.</p>\n<p><strong>Morgagnian hypermature cataract\u00a0</strong>is characterized by the\u00a0<strong>liquefaction</strong>\u00a0of the entire\u00a0<strong>cortex.</strong>\u00a0The\u00a0lens is converted into a\u00a0<strong>bag of milky fluid</strong>. The\u00a0<strong>small, brownish nucleus</strong>\u00a0settles at the\u00a0<strong>bottom</strong>, its\u00a0<strong>position altering\u00a0</strong>with a\u00a0change in the position of the head.</p>\n<p><strong>Senile Cataract </strong></p>\n<p><strong>Types: </strong></p>\n<ul>\n<li><strong>Cortical</strong> (<strong>soft</strong> cataract): 75%\u00a0\u00a0\u00a0</li>\n<li><strong>Nuclear</strong> (<strong>hard</strong> cataract): 25%</li>\n</ul>\n<p><strong>Cortical cataract </strong>is<strong>\u00a0</strong>further divided into the cuneiform and cupuliform types.</p>\n<table style=\"height: 178px; width: 468px;\">\n<tbody>\n<tr>\n<td style=\"width: 199.805px; text-align: center;\"><strong>Cuneiform </strong>(70%)</td>\n<td style=\"width: 239.602px; text-align: center;\"><strong>Posterior subcapsular/Cupuliform</strong> (5%)</td>\n</tr>\n<tr>\n<td style=\"width: 199.805px;\">\n<p><strong>Radial spoke-like</strong>\u00a0opacity starting in the periphery and extending centrally</p>\n</td>\n<td style=\"width: 239.602px;\">\n<p><strong>Central saucer-shaped</strong> opacity in the posterior cortex just below the capsule</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 199.805px;\">\n<p>Late visual loss</p>\n</td>\n<td style=\"width: 239.602px;\">\n<p>Early loss of visual acuity</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 199.805px;\">\u00a0</td>\n<td style=\"width: 239.602px;\">\n<p>Most visually handicapping senile cataract\u00a0</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/480b1f0f98b94bc182183a4faac59d8d.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a0c1593bf00e49c4ab371eb7c9b3c866x619x419.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6ed460ba1cda4c90ae7626e16d8f8667x620x451.PNG"
    ]
  },
  {
    "text": "A resident notes the following fundus picture in a patient referred to the ophthalmology OPD with visual complaints. What does it suggest?",
    "choices": [
      {
        "id": 1,
        "text": "Retinal detachment"
      },
      {
        "id": 2,
        "text": "Papilledema"
      },
      {
        "id": 3,
        "text": "Primary optic atrophy"
      },
      {
        "id": 4,
        "text": "Secondary optic atrophy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The fundoscopic image shows <strong>dilated veins</strong> with a&nbsp;<strong>blurred disc margin</strong>&nbsp;which is suggestive of <strong>papilledema</strong>.</p>\n<p><strong>Ophthalmoscopic features of papilledema</strong>:</p>\n<ul>\n<li><strong>Early-stage:</strong>\n<ul>\n<li><strong>Obscuration</strong> of the disc margins <strong>(</strong><strong>nasal margins first) </strong></li>\n<li><strong>Absence</strong> of <strong>spontaneous venous pulsation</strong> at the disc</li>\n<li><strong>Mild hyperemia</strong> of the disc</li>\n<li>The blurring of the&nbsp;peripapillary nerve fiber layer</li>\n</ul>\n</li>\n<li><strong>Established papilledema:</strong>\n<ul>\n<li>The disc appears to be enlarged and elevated (<strong>mushroom</strong> or <strong>dome-shaped)</strong></li>\n<li><strong>Macular fan </strong>appears</li>\n<li><strong>Paton&rsquo;s lines-</strong>&nbsp;circumferential <strong>greyish white folds</strong> may develop due to the&nbsp;separation of nerve fibers</li>\n<li>Visual fields show <strong>enlargement of the blind spot</strong></li>\n<li>Veins become <strong>tortuous</strong> and engorged</li>\n<li>Multiple <strong>cotton-wool spots</strong> and superficial hemorrhages</li>\n</ul>\n</li>\n<li><strong>Chronic or long-standing (vintage) papilledema:</strong>\n<ul>\n<li>The optic disc gives the&nbsp;appearance of the <strong>dome of a champagne cork</strong></li>\n<li>Small drusen-like crystalline deposits (<strong>corpora amylacea</strong>) may appear on the disc surface</li>\n</ul>\n</li>\n<li><strong>Atrophic stage:</strong>\n<ul>\n<li><strong>Secondary</strong> optic atrophy</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/56401db6a71c4b93909f7439a51f7d5b.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Purely depolarizing cells in the optic pathway are ________.",
    "choices": [
      {
        "id": 1,
        "text": "Amacrine cells"
      },
      {
        "id": 2,
        "text": "Rods and cones"
      },
      {
        "id": 3,
        "text": "Bipolar cells"
      },
      {
        "id": 4,
        "text": "Horizontal cells"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Amacrine cells</strong> are the cells that produce purely <strong>depolarizing potential</strong> and <strong>spikes</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The normal extent of the visual field superiorly is ________.",
    "choices": [
      {
        "id": 1,
        "text": "60\u00b0"
      },
      {
        "id": 2,
        "text": "50\u00b0"
      },
      {
        "id": 3,
        "text": "70\u00b0"
      },
      {
        "id": 4,
        "text": "90\u00b0"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The extent of visual field superiorly is <strong>50&deg;</strong></p>\n<p>Normal extent of the visual field:&nbsp;</p>\n<ul>\n<li>Temporal: 90&deg;/100&deg;</li>\n<li>Inferiorly: 70&deg;</li>\n<li>Nasal: 60&deg;</li>\n<li>Superiorly: 50&deg;</li>\n</ul>\n<p><strong>Note:</strong>&nbsp;According to Parson's 22<sup>nd</sup> Ed., Page no. 101, the visual field extends 60<sup>o&nbsp;</sup>superiorly. However, most journals and other standard textbooks consider the answer to be 50<sup>o</sup>. Hence, we choose&nbsp;50<sup>o </sup>as the most appropriate answer.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which disease is this particular pathology seen?",
    "choices": [
      {
        "id": 1,
        "text": "Diabetes mellitus"
      },
      {
        "id": 2,
        "text": "Galactosemia"
      },
      {
        "id": 3,
        "text": "Myotonic dystrophy"
      },
      {
        "id": 4,
        "text": "Alport's syndrome"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given picture depicts <strong>lenticonus. </strong></p>\n<p>In <strong>Alport&rsquo;s</strong>&nbsp;syndrome, both <strong>anterior and posterior lenticonus are seen, but anterior lenticonus is more common.</strong></p>\n<p><strong>Lowe&rsquo;s syndrome</strong> is&nbsp;<strong>oculo-cerebro-renal syndrome</strong> characterized by</p>\n<ul>\n<li>Congenital cataract</li>\n<li>Glaucoma</li>\n<li><strong>Posterior lenticonus</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0a6d6dcc829e4f62a1878b5cedd16fa8.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The second sight of old age is seen in ______.",
    "choices": [
      {
        "id": 1,
        "text": "Nuclear cataract"
      },
      {
        "id": 2,
        "text": "Cortical cataract"
      },
      {
        "id": 3,
        "text": "Zonular cataract"
      },
      {
        "id": 4,
        "text": "Metabolic cataract"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Second sight</strong> of <strong>old age</strong> is seen in <strong>nuclear cataract.</strong></p>\n<ul>\n<li>Due to <strong>nuclear sclerosis,</strong> there is an&nbsp;<strong>increase in refractive index</strong>.</li>\n<li>This leads to <strong>progressive myopia</strong>.</li>\n<li>A<strong> patient with&nbsp;</strong><strong>presbyopia</strong>&nbsp;may be able to read again, without the aid of spectacles.</li>\n<li>This <strong>improvement in vison</strong> is termed as second sight<strong>.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is a rigid intraocular lens made of?",
    "choices": [
      {
        "id": 1,
        "text": "Polymethyl methacrylate (PMMA)"
      },
      {
        "id": 2,
        "text": "Silicone"
      },
      {
        "id": 3,
        "text": "Hydrogel"
      },
      {
        "id": 4,
        "text": "Collamer"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Rigid IOLs</strong> are made of polymethyl methacrylate (<strong>PMMA</strong>).</p>\n<p>Depending on the type of <strong>material</strong> of manufacturing, 3 types of posterior chamber intraocular lens (PCIOLs) are available:</p>\n<ul>\n<li><strong>Rigid IOLs</strong>\u00a0are made entirely from polymethyl methacrylate (<strong>PMMA</strong>).</li>\n<li><strong>Foldable IOLs\u00a0</strong>are made of silicone, hydrogel, acrylic, and Collamer. These are\u00a0implanted through a small incision.\u00a0</li>\n<li><strong>Rollable IOLs </strong>are ultra-thin IOLs made of acyrlic or hydrogel. These are implanted through a 1-mm incision after micro-incision cataract surgery technique.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The most common type of congenital cataract with diminished vision is ______.",
    "choices": [
      {
        "id": 1,
        "text": "Blue-dot cataract"
      },
      {
        "id": 2,
        "text": "Lamellar cataract"
      },
      {
        "id": 3,
        "text": "Posterior polar cataract"
      },
      {
        "id": 4,
        "text": "Total congenital cataract"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Lamellar</strong> or <strong>zonular cataract</strong> is the most common type of congenital cataract <strong>presenting with visual impairment</strong>.</p>\n<p><strong>Etiology:</strong>&nbsp;It may be either genetic or environmental in origin.</p>\n<ul>\n<li><strong>Genetic pattern</strong> is usually of <strong>familial autosomal-dominant variety</strong></li>\n<li>Environmental form is associated with:\n<ul>\n<li><strong>Vitamin D deficiency </strong></li>\n<li>Hypocalcemia</li>\n<li>Sometimes,&nbsp;<strong>maternal</strong> <strong>rubella </strong>infection contracted between the 7<sup>th</sup> and 8<sup>th</sup> week of gestation may also cause lamellar cataract.</li>\n</ul>\n</li>\n<li>The <strong>main mass of the lens</strong> internal and external to the zone of cataract is clear.</li>\n<li><strong>Small linear opacities </strong>like<strong> spokes of a wheel</strong> (<strong>riders</strong>) may be seen towards the equator.</li>\n</ul>\n<p>&nbsp;</p>\n<p>Image: Lamellar cataract</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/be2d7702f16c4190966f08a4881d1897x451x604.PNG"
    ]
  },
  {
    "text": "What signals are carried by the parvocellular pathway from the lateral geniculate body to the visual cortex?",
    "choices": [
      {
        "id": 1,
        "text": "Movement, depth, and flicker"
      },
      {
        "id": 2,
        "text": "Colour vision, shape, and fine details"
      },
      {
        "id": 3,
        "text": "Temporal frequency"
      },
      {
        "id": 4,
        "text": "Luminance contrast"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The<strong> parvocellular pathway\u00a0</strong>gives signals for <strong>color vision, texture, shape,</strong>\u00a0and <strong>fine details.\u00a0</strong></p>\n<table style=\"height: 175px; width: 670px;\">\n<tbody>\n<tr>\n<td style=\"width: 106px; text-align: center;\"><strong>Feature</strong></td>\n<td style=\"width: 242.132px; text-align: center;\"><strong>Parvocellular Pathway</strong></td>\n<td style=\"width: 297.868px; text-align: center;\"><strong>Magnocellular Pathway</strong></td>\n</tr>\n<tr>\n<td style=\"width: 106px; text-align: center;\"><strong>Arises\u00a0</strong></td>\n<td style=\"width: 242.132px;\">layers\u00a03, 4, 5, and 6 of LGB\u00a0</td>\n<td style=\"width: 297.868px;\">Layers 1 and 2 of LGB</td>\n</tr>\n<tr>\n<td style=\"width: 106px; text-align: center;\"><strong>Terminates</strong></td>\n<td style=\"width: 242.132px;\">Layer 4 of visual cortex</td>\n<td style=\"width: 297.868px;\">Layer 4 of visual cortex</td>\n</tr>\n<tr>\n<td style=\"width: 106px; text-align: center;\"><strong>Use\u00a0</strong></td>\n<td style=\"width: 242.132px;\">Color vision, texture, shape,\u00a0and fine details</td>\n<td style=\"width: 297.868px;\">Movement, depth, flicker,\u00a0and\u00a0spatial organization</td>\n</tr>\n</tbody>\n</table>\n<p>LGB: lateral geniculate body</p>\n<p>The<strong>\u00a0interlaminar pathway </strong>gives signals for <strong>color</strong> vision to layers <strong>2</strong> and <strong>3</strong> of the visual cortex having <strong>clusters</strong> of <strong>cells</strong> called <strong>blobs</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/36b8f6752ff3449ba1a63042e7602c86x1280x2373.JPEG"
    ]
  },
  {
    "text": "An anxious primigravida with sickle cell trait comes to you for her first antenatal checkup. Which of the following is she at a higher risk of developing during the course of this pregnancy?",
    "choices": [
      {
        "id": 1,
        "text": "4 & 5"
      },
      {
        "id": 2,
        "text": "1, 3, & 5"
      },
      {
        "id": 3,
        "text": "Only 3"
      },
      {
        "id": 4,
        "text": "2 & 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Among the given options, patients with<strong> sickle cell trait</strong>\u00a0are at a higher risk of developing\u00a0<strong>urinary tract infections.</strong></p>\n<p><strong>Sickle cell disease,</strong>\u00a0on the other hand, is associated with increased risk of :</p>\n<ul>\n<li><strong>Miscarriages</strong></li>\n<li>Fetal growth restriction</li>\n<li><strong>Preterm labor</strong></li>\n<li>Venous thromboembolism</li>\n<li><strong>Pre-eclampsia</strong></li>\n<li><strong>Placental abruption\u00a0</strong></li>\n<li>Fetal distress in labor</li>\n</ul>\n<p>Note:\u00a0Sickle cell trait is a benign condition in which the affected person has only one abnormal hemoglobin beta gene allele whereas, in sickle cell disease, the affected person has two abnormal hemoglobin beta gene alleles and is hence severely symptomatic. Unlike individuals with sickle cell disease, those with sickle cell trait do not have symptoms related to sickling and mostly lead a normal life.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following image represents the result after a patient underwent a Worth\u2019s four-dot test. The most likely inference is ______.",
    "choices": [
      {
        "id": 1,
        "text": "Abnormal retinal correspondence"
      },
      {
        "id": 2,
        "text": "Left suppression"
      },
      {
        "id": 3,
        "text": "Right suppression"
      },
      {
        "id": 4,
        "text": "Diplopia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given images likely suggest that the patient is suffering from <strong>right suppression.</strong></p>\n<p><strong>Worth's four-dot test</strong></p>\n<ul>\n<li><strong>Sensory</strong> function test</li>\n<li>Patient wears goggles with\n<ul>\n<li>Red lens: Right eye</li>\n<li>Green\u00a0lens: Left eye</li>\n</ul>\n</li>\n<li>A box is viewed having 4 lights: one red, two green, and one white</li>\n<li><strong>Inference:</strong>\n<ul>\n<li>A:\u00a0<strong>Normal</strong>\u2014All 4 lights seen</li>\n<li>B:\u00a0<strong>Abnormal retinal correspondence</strong>\u2014All 4 lights seen in the presence of manifest squint</li>\n<li>C:\u00a0<strong>Left</strong><strong>\u00a0Suppression</strong>\u20142 red lights seen</li>\n<li>D:\u00a0<strong>Right suppression</strong>\u20143 green lights seen</li>\n<li>E:\u00a0<strong>Diplopia</strong>\u20145 lights seen (2 red, 3 green)</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d2e1dc26f1394530a8abb2da5a32f49c.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/f79aa8422b8b4341be465e90a5f3b588x386x460.JPEG"
    ]
  },
  {
    "text": "A patient with a known case of MI on aspirin comes with shortness of breath. She has an active history of asthma and uses inhalational bronchodilators, her last attack was 7 months ago. She was recently prescribed medications for increased intraocular pressure. What is the likely cause of her current symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Aspirin"
      },
      {
        "id": 2,
        "text": "Betaxolol"
      },
      {
        "id": 3,
        "text": "Latanoprost"
      },
      {
        "id": 4,
        "text": "Timolol"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\">This patient with a history of <strong>asthma</strong> now presenting with <strong>shortness</strong> of <strong>breath</strong> after starting medications for increased intraocular pressure was most likely diagnosed with <strong>glaucoma.</strong> The drug she was likely prescribed was <strong>timolol,</strong> a non-selective beta blocker.</p>\n<p class=\"ng-binding\">Timolol\u00a0is a<strong>\u00a0</strong>non-selective beta-blocker\u00a0that is used in glaucoma<strong>.\u00a0</strong>Non-selective beta-blockers can cause <strong>precipitation</strong> of <strong>bronchial</strong> asthma in susceptible individuals (beta-2 block on bronchi). They cause <strong>bronchospasms</strong> and are therefore\u00a0<strong>contraindicated</strong> in patients with\u00a0<strong>asthma\u00a0</strong>(e.g. timolol, levobunolol). Ocular beta-blockers\u00a0reduce intraocular pressure by\u00a0<strong>decreasing aqueous formation\u00a0</strong>by\u00a0<strong>blockade</strong> of <strong>\u03b2<sub>2</sub> receptors. </strong>Timolol is specifically associated with <strong>allergic blepharoconjunctivitis</strong> and punctal <strong>stenosis</strong></p>\n<p>Side effects: Systemic: Bronchospasm, bradycardia, decreased cardiac output, hypotension, depression, impotence, and altered lipid profile.</p>\n<p>Contraindications: Asthma, chronic obstructive pulmonary disease, congestive heart failure, sinus bradycardia, and atrioventricular blocks</p>\n<p>Other options:</p>\n<p>Option A: The patient has been stable on aspirin for the past three years which is unlikely to be the cause of her current symptoms.\u00a0</p>\n<p>Option B: Betaxolol is a beta 1 selective blocker that is used in glaucoma and has a lower propensity to precipitate bronchial asthma.\u00a0</p>\n<p>Option C: Latanoprost is a prostaglandin (PGF2 alpha) analog and does not precipitate bronchial asthma.\u00a0</p>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following conditions is not associated with optic atrophy?",
    "choices": [
      {
        "id": 1,
        "text": "Retinitis pigmentosa"
      },
      {
        "id": 2,
        "text": "Leprosy"
      },
      {
        "id": 3,
        "text": "Pituitary tumor"
      },
      {
        "id": 4,
        "text": "Methanol intake"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Leprosy</strong> is <strong>not </strong>associated with&nbsp;optic atrophy.</p>\n<p>All the other given conditions can cause optic atrophy.</p>\n<p><strong>Causes of optic atrophy:</strong></p>\n<ul>\n<li><strong>Primary</strong> optic atrophy\n<ul>\n<li>Optic neuritis</li>\n<li>Compression by tumors and aneurysms</li>\n<li>Hereditary optic neuropathies</li>\n<li>Toxic and nutritional optic neuropathies</li>\n<li>Trauma</li>\n</ul>\n</li>\n<li><strong>Secondary</strong> optic atrophy\n<ul>\n<li>Chronic papilledema</li>\n<li>Anterior ischemic optic neuropathy</li>\n<li>Papillitis</li>\n</ul>\n</li>\n<li><strong>Consecutive</strong> optic atrophy\n<ul>\n<li>Extensive retinal photocoagulation</li>\n<li>Retinitis pigmentosa</li>\n<li>Prior central retinal artery occlusion</li>\n</ul>\n</li>\n<li><strong>Glaucomatous</strong> optic atrophy</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a wrong statement regarding diplopia?",
    "choices": [
      {
        "id": 1,
        "text": "Anisometropia is a cause for binocular diplopia."
      },
      {
        "id": 2,
        "text": "Crossed diplopia occurs in convergent squint."
      },
      {
        "id": 3,
        "text": "Incipient cataract is a cause for uniocular diplopia."
      },
      {
        "id": 4,
        "text": "Harmonious diplopia refers to uncrossed binocular diplopia."
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Crossed diplopia</strong> is seen in a&nbsp;<strong>divergent squint,</strong> as in medial rectus paralysis.</p>\n<p><strong>Binocular diplopia:&nbsp;</strong>Simultaneous perception of <strong>two images</strong> of a <strong>single object</strong> when seen by <strong>both eyes.</strong></p>\n<p>Causes:</p>\n<ul>\n<li>Anisometropia</li>\n<li>Paralysis of extraocular muscles;&nbsp;<strong>commonest</strong></li>\n<li>Mechanical restriction of movements</li>\n</ul>\n<p>Types:</p>\n<p><strong>&nbsp;Uncrossed</strong>&mdash;Harmonious</p>\n<ul>\n<li>False image on the same side of the&nbsp;deviation</li>\n<li>Seen in <strong>convergent</strong> squint</li>\n</ul>\n<p><strong>Crossed</strong>&mdash;Unharmonious</p>\n<ul>\n<li>False image on the opposite side of the&nbsp;deviation</li>\n<li>Seen in <strong>divergent</strong> squint</li>\n</ul>\n<p><strong>Uniocular diplopia:&nbsp;</strong>Simultaneous perception of <strong>two images</strong> of a <strong>single object</strong> when seen by <strong>a single eye.</strong></p>\n<p>Causes:</p>\n<ul>\n<li>Subluxated clear lens</li>\n<li>Subluxated intraocular lens (IOL)</li>\n<li>Double pupil</li>\n<li>Incipient cataract</li>\n<li>Keratoconus</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2e1a2addb6c34722a708d0ca4d57a26ax1280x2723.JPEG"
    ]
  },
  {
    "text": "Which of the following defects is implicated in Leber\u2019s hereditary optic neuropathy?",
    "choices": [
      {
        "id": 1,
        "text": "Post-translational defect"
      },
      {
        "id": 2,
        "text": "Sporadic point mutation"
      },
      {
        "id": 3,
        "text": "Mitochondrial DNA defect"
      },
      {
        "id": 4,
        "text": "Chromosomal translocation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In <strong>Leber&rsquo;s hereditary optic neuropathy</strong> (LHON), the&nbsp;defect is a&nbsp;mutation of<strong> maternal mitochondrial DNA. </strong>Therefore&nbsp;the condition has a<strong> maternal inheritance.&nbsp;</strong></p>\n<p>LHON causes bilateral, <strong>subacute painless loss</strong> of vision. The characteristic visual field defect is a centrocaecal scotoma. Pupillary light reflex is relatively preserved until the late stage of the disease.&nbsp;<strong>Optic neuritis</strong>&nbsp;and <strong>o</strong><strong>ptic atrophy</strong> start in one eye and goes on to involve the other eye subsequently.&nbsp;It typically affects <strong>males</strong> between the ages of <strong>15 and 35 years.&nbsp;</strong>The diagnosis of LHON should be considered in any patient with <strong>bilateral optic neuropathy</strong>, irrespective of age.</p>\n<p><strong>Prognosis is poor</strong>, although some visual recovery may occur in a minority of cases even years later.&nbsp;</p>\n<p>Note: <strong>LHON plus</strong> refers to rare variants with additional manifestations such as<strong> neuromuscular dysfunction</strong>.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 61-year-old university professor presents with a loss of vision in his left eye. He describes the sensation that a curtain was coming up over his affected eye. In addition, 7 days ago the patient noticed what he described as flashing lights and floaters. He gives a history of having cataract surgery in the same eye 3 weeks ago. A B-scan image of his left eye is shown below. Which of the following statements best describes the pathology?",
    "choices": [
      {
        "id": 1,
        "text": "Fluid accumulation below retina"
      },
      {
        "id": 2,
        "text": "Fibrovascular membranes in the vitreous causing traction"
      },
      {
        "id": 3,
        "text": "Fluid accumulation between NSR and RPE due to retinal tear"
      },
      {
        "id": 4,
        "text": "Fluid accumulation between NSR and RPE due to choroidal exudation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The prodromal symptoms of flashing lights, floaters followed by loss of monocular vision (curtain over the eye) and the B-scan suggest a diagnosis of<strong> rhegmatogenous retinal detachment</strong>. Rhegmatogenous retinal detachment is the result of the accumulation of <strong>fluid </strong>between <strong>NSR </strong>and<strong> RPE</strong> due to a<strong> retinal tear</strong>.</p>\n<p><strong>Retinal detachment</strong> is the separation of the neurosensory retina from the retinal pigment epithelium. Rhegmatogenous retinal detachment is the most common type of retinal detachment. It occurs due to fluid accumulation after a retinal break (tear). High myopia, trauma, <strong>pseudophakia</strong>, aphakia are predisposing factors. Patients present with photopsia (flashes of light due to vitreoretinal traction at the site of the break), floaters and visual field defect (black curtain/veil in front of the eye).\u00a0</p>\n<p>Signs include<strong> hypotony</strong>, as the liquefied vitreous in the subretinal space is absorbed through the RPE and <strong>Shafers sign </strong>or<strong> tobacco dusting </strong>(pigments in the anterior vitreous). The detached retina is convex in configuration. The surface is corrugated with undulations. The most dangerous type of retinal break is <strong>horseshoe tear </strong>and the most dangerous location of retinal break is the <strong>supero-temporal retina.\u00a0</strong></p>\n<p>Treatment is by prophylactic laser barrage, scleral buckling, pneumatic retinopexy and pars plana vitrectomy.\u00a0</p>\n<p>Other types of retinal detachment are<strong> tractional </strong>and <strong>exudative</strong> type:</p>\n<p><strong>Tractional retinal detachment </strong>occurs when<strong> f</strong><strong>ibro-vascular membranes</strong> in the <strong>vitreous</strong> due to long-standing <strong>retinal neovascularization</strong> exert traction on the retina. It is seen in proliferative diabetic retinopathy, central retinal venous occlusion, Eales disease and ROP. The detached retina is<strong> concave</strong> in configuration. No breaks are seen.\u00a0Treatment is with pars plana vitrectomy with endo photocoagulation.\u00a0</p>\n<p><strong>Exudative retinal detachment</strong> is seen when<strong> e</strong><strong>xudative fluid</strong> from the <strong>choroid</strong>\u00a0collects in the <strong>subretinal space.</strong> Patients present with visual field defects, <strong>floaters</strong> due to vitritis but <strong>no photopsia. </strong>The detached retina is<strong> convex</strong> in configuration. The surface is smooth. No break is seen. Shifting fluid is seen.\u00a0</p>\n<p>The image below shows a fundus which reveals retinal detachment inferiorly from 3-9 o'clock with tear at 3:30.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/13e723a817f842328035cb0a90a9e747.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b5e38fa735d648b3941a1af2a4b48484x1280x1326.9724770642201.JPEG"
    ]
  },
  {
    "text": "Weiss operation is done in which of the following condition?",
    "choices": [
      {
        "id": 1,
        "text": "Entropion"
      },
      {
        "id": 2,
        "text": "Ectropion"
      },
      {
        "id": 3,
        "text": "Trichiasis"
      },
      {
        "id": 4,
        "text": "Ptosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Weiss operation </strong>is done in <strong>senile entropion.\u00a0</strong>In this operation, the transverse lid split, and everything sutures are placed.</p>\n<p><strong>Entropion</strong> refers to the\u00a0<strong>inward rolling</strong> and <strong>rotation</strong> of the <strong>lid margin</strong> towards the globe. It is more common in the lower lid.</p>\n<p>Causes include:</p>\n<ul>\n<li>Horizontal lid laxity</li>\n<li>Vertical lid instability</li>\n<li>Over-riding of the pretarsal by the preseptal orbicularis during lid closure</li>\n<li>Orbital septum laxity</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7b9cd63307f2459ba5df1b479b8940cex642x312.PNG"
    ]
  },
  {
    "text": "Which of the following is characteristic of Eale\u2019s disease?",
    "choices": [
      {
        "id": 1,
        "text": "Retinal hemorrhage"
      },
      {
        "id": 2,
        "text": "Vitreous hemorrhage"
      },
      {
        "id": 3,
        "text": "Conjunctival hemorrhage"
      },
      {
        "id": 4,
        "text": "Choroidal hemorrhage"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Eale\u2019s disease is an idiopathic inflammatory venous occlusion (phlebitis) that primarily affects the peripheral retina that is <strong>periphlebitis</strong> and is characterized by <strong>recurrent bilateral vitreous hemorrhage.</strong></p>\n<p>Superficial retinal hemorrhages and cotton-wool spots can be sometimes seen, but they are not characteristic of Eales disease.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the causative agent for blepharitis acarica?",
    "choices": [
      {
        "id": 1,
        "text": "Moraxella"
      },
      {
        "id": 2,
        "text": "Staphylococcus"
      },
      {
        "id": 3,
        "text": "Propionibacterium"
      },
      {
        "id": 4,
        "text": "Demodex folliculorum"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Blepharitis acarica is caused by <em><strong>Demodex folliculorum</strong></em>.</p>\n<p>Blepharitis\u00a0is a <strong>chronic inflammation</strong> of the <strong>margins</strong> of the lids.</p>\n<p>The two types are</p>\n<ul>\n<li><strong>Anterior</strong>\n<ul>\n<li>Seborrheic and ulcerative types</li>\n<li>Caused by<strong> staphylococci,\u00a0</strong>mainly</li>\n</ul>\n</li>\n<li><strong>Posterior </strong>\u2013 <strong>Mebomianitis</strong></li>\n</ul>\n<p>Occasionally caused by</p>\n<ul>\n<li><em>Demodex folliculorum </em>\u2013 <strong>Blepharitis acarica</strong></li>\n<li>Crab louse \u2013 <strong>Phthiriasis palpebrarum</strong></li>\n</ul>\n<p>The following image shows swollen and inflamed eyelid suggestive of blepharitis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/62dbd670f7b94148a8135e678c9f81cdx220x165.JPEG"
    ]
  },
  {
    "text": "Which of the following components of the eye has the highest refractive index?",
    "choices": [
      {
        "id": 1,
        "text": "Cornea"
      },
      {
        "id": 2,
        "text": "Lens cortex"
      },
      {
        "id": 3,
        "text": "Aqueous humor"
      },
      {
        "id": 4,
        "text": "Lens core"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>The core of the lens</strong> has a refractive index of <strong>1.406</strong> and that of the <strong>cortex</strong> is <strong>1.386</strong>.</p>\n<table border=\"1\">\n<tbody>\n<tr>\n<td><strong>Refracting Medium</strong></td>\n<td><strong>Refractive Index</strong></td>\n</tr>\n<tr>\n<td>Air</td>\n<td>1.00</td>\n</tr>\n<tr>\n<td>Cornea</td>\n<td>1.376</td>\n</tr>\n<tr>\n<td>Aqueous humor</td>\n<td>1.336</td>\n</tr>\n<tr>\n<td>Lens cortex</td>\n<td>1.386</td>\n</tr>\n<tr>\n<td>Lens core</td>\n<td>1.406</td>\n</tr>\n<tr>\n<td>Vitreous humor</td>\n<td>1.336</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A neonate with leukocoria and strabismus is diagnosed to have persistent hyperplastic primary vitreous (PHPV). Which of the following congenital disorders is it associated with?",
    "choices": [
      {
        "id": 1,
        "text": "Down syndrome"
      },
      {
        "id": 2,
        "text": "Tuberous sclerosis"
      },
      {
        "id": 3,
        "text": "Patau syndrome"
      },
      {
        "id": 4,
        "text": "Sturge Weber syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Persistent hyperplastic primary vitreous (PHPV) is associated with <strong>Patau</strong> syndrome (Trisomy 13).</p>\n<p>PHPV is a developmental disorder of the vitreous humor. In this condition, there is persistence of the embryonic hyaloid vessel.\u00a0</p>\n<ul>\n<li><strong>Anterior</strong> PHPV - Here, the remnant vessel is attached to the back of the lens but does not reach the optic nerve.\u00a0</li>\n<li><strong>Posterior</strong> PHPV- In this form of the disease, the vessel arises from the optic nerve.\u00a0</li>\n</ul>\n<p>Clinically, PHPV presents with <strong>leucocoria</strong> and <strong>microphthalmia,</strong> and there can be complications such as <strong>tractional retinal detachments.</strong>\u00a0</p>\n<p>This condition has a poor prognosis regardless of the time of intervention.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most important factor for the development of diabetic retinopathy?",
    "choices": [
      {
        "id": 1,
        "text": "Duration of diabetes"
      },
      {
        "id": 2,
        "text": "Glycemic control"
      },
      {
        "id": 3,
        "text": "Association with hypertension"
      },
      {
        "id": 4,
        "text": "Age of the patient"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>most important factor</strong> for the development of diabetic retinopathy is the <strong>duration</strong> of <strong>diabetes</strong>.</p>\n<p><strong>Diabetic retinopathy</strong> constitutes the retinal changes seen in patients with type 2 diabetes mellitus. The most important factor for its development is duration of diabetes after the onset of puberty, followed by\u00a0<strong>glycemic control</strong>. It is <strong>more common</strong> in <strong>type</strong> <strong>1 diabetes mellitus</strong>. The presence of hypertension increases the risk of diabetic retinopathy.</p>\n<p>First fundus examination for<strong> type 1 diabetes </strong>is done after <strong>5 years\u00a0</strong>after diagnosis and for <strong>type 2</strong> is done<strong>\u00a0at </strong>the time of<strong> diagnosis</strong>. The frequency of follow-up for types 1 and 2 diabetes mellitus is every year. Diabetes in pregnancy is followed up every 3 months.</p>\n<p>The <strong>earliest feature</strong> of diabetic retinopathy is <strong>microaneurysms</strong>, which are present in the inner nuclear layer of the retina.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A mother noticed that her child has had malaligned eyes since birth but she couldn't afford treatment due to financial constraints.  She now presents at 2-months of age and the child has the following finding on examination. An ophthalmoscopic examination under full cycloplegia reveals no abnormalities in refraction and media. Cranial nerves are intact. Which of the following statements is true regarding this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Angle of deviation is large and constant."
      },
      {
        "id": 2,
        "text": "Amblyopia develops in 90 % of the cases."
      },
      {
        "id": 3,
        "text": "It is associated with latent vertical nystagmus."
      },
      {
        "id": 4,
        "text": "Correction by spectacles is the treatment of choice."
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The age at presentation, esotropia, no refractory error, no media opacities, and no cranial nerve palsies suggest a diagnosis of<strong> essential infantile esotropia</strong>. The<strong>&nbsp;angle of deviation</strong> in infantile esotropia is fairly <strong>large (&gt; 30&deg;) and constant.</strong></p>\n<p>Infantile esotropia, also known as non-accommodative esotropia is the <strong>most common type of congenital esotropia</strong>.</p>\n<p>Clinical features:</p>\n<ul>\n<li>Comitant convergent squint</li>\n<li>Age of onset-&nbsp;<strong>1 to 2</strong> months</li>\n<li>Angle of <strong>deviation</strong>-<strong>&nbsp;large</strong> and constant</li>\n<li><strong>Amblyopia-</strong>&nbsp;develops in<strong> 25&ndash;40% </strong>of cases</li>\n<li><strong>Associations include:</strong>\n<ul>\n<li>Inferior oblique <strong>overaction</strong></li>\n<li><strong>Dissociated vertical deviation</strong> (70%)</li>\n<li><strong>Latent horizontal nystagmus</strong></li>\n</ul>\n</li>\n</ul>\n<p>Treatment:</p>\n<ul>\n<li><strong>Surgery-</strong>&nbsp;treatment of choice</li>\n<li>Amblyopia correction measures: Patching of normal eye</li>\n<li><strong>Recession </strong>of both <strong>medial recti</strong></li>\n<li>Timing: Preferably <strong>before 1 year</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b7a64f752ead4f37943f43d2659af0f5.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A mother noticed the following finding in her 3-month-old child. There is a history of watering  and discharge from his right eye since birth. Which of the following is the best next step in the treatment?",
    "choices": [
      {
        "id": 1,
        "text": "Syringing"
      },
      {
        "id": 2,
        "text": "Probing with syringing"
      },
      {
        "id": 3,
        "text": "Sac massage with topical antibiotics"
      },
      {
        "id": 4,
        "text": "Dacryocystorhinostomy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image showing\u00a0 right-sided swelling in the lacrimal sac area along with watering of the eye is suggestive of <strong>congenital dacryocystitis.\u00a0</strong>Treatment for a 3-month-old child includes\u00a0<strong>sac massage </strong>with <strong>topical antibiotics</strong>.</p>\n<p>Congenital dacryocystitis is chronic inflammation of the lacrimal sac in newborn infants. It occurs due to congenital blockage of the nasolacrimal duct. More than <strong>90%</strong> of patients with undergo <strong>spontaneous resolution</strong> by <strong>1 year </strong>of age.</p>\n<p>Treatment of congenital dacryocystitis depends on the <strong>age</strong> of the child:</p>\n<ul>\n<li>Less than 9 months: Massaging<strong> </strong>(<strong>Crigler\u2019s</strong> massage which increases the hydrostatic pressure within the sac) and antibiotic eye drops</li>\n<li>9 months to 4 years: <strong>Probing</strong></li>\n<li>Older children (&gt; 4 years):<strong> Dacryocystorhinostomy</strong> (DCR) gives the best result. In DCR,\u00a0an\u00a0opening is made into the\u00a0<strong>nasal cavity</strong> from the\u00a0<strong>lacrimal sac</strong>.<strong>\u00a0</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/51c494f122c74c4395e25737b89a09e5.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A young man presented with watering, redness and photophobia. He had similar complaints in the past which improved with self-medicated topical drops. His best-corrected visual acuity is 6/36 improving to 6/24. Slit-lamp examination revealed a 3 mm \u00d7 2 mm epithelial defect in the paracentral part of the cornea that stained positive with fluorescein dyes. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Spring catarrh"
      },
      {
        "id": 2,
        "text": "Exposure keratopathy"
      },
      {
        "id": 3,
        "text": "Neuroparalytic keratopathy"
      },
      {
        "id": 4,
        "text": "Trachoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario is suggestive of\u00a0<strong>spring catarrh</strong>.\u00a0Slit-lamp examination finding of\u00a0<strong>shield ulcer </strong>is\u00a0typical of\u00a0<strong>vernal keratoconjunctivitis</strong>\u00a0(VKC) or\u00a0<strong>warm weather conjunctivitis</strong> (another name of VKC).</p>\n<p>Shield ulcers are transverse ulcers seen in the upper cornea due to epithelial macroerosions in\u00a0VKC. It is a rare <strong>complication of VKC</strong> and should always be kept in mind for patients suffering from vernal conjunctivitis.</p>\n<p>Corneal signs in VKC:</p>\n<ul>\n<li><strong>Shield ulcers</strong></li>\n<li>Vernal plaques</li>\n<li>Subepithelial scarring</li>\n<li><strong>Pseudo-gerontoxon-</strong>\u00a0resembles arcus senilus; has a <strong>cupid's bow</strong> outline</li>\n</ul>\n<p>Treatment of VKC is mainly with allergy avoidance and lid hygiene. Cool compresses, topical antihistamines, topical NSAIDs and topical steroids can be used to reduce the intensity of symptoms.\u00a0</p>\n<p>The image given below shows a shield ulcer in a patient with VKC.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/41320d71d3ef4d258273ab56593a2967x320x215.JPEG"
    ]
  },
  {
    "text": "In which of the following cataract surgeries is a self-sealing sclerocorneal tunnel incision used?",
    "choices": [
      {
        "id": 1,
        "text": "Intracapsular cataract extraction (ICCE)"
      },
      {
        "id": 2,
        "text": "Conventional extracapsular cataract extraction (ECCE)"
      },
      {
        "id": 3,
        "text": "Small incision cataract surgery (SICS)"
      },
      {
        "id": 4,
        "text": "Anterior capsulotomy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The self-sealing sclerocorneal tunnel incision is made in small-incision cataract surgery (<strong>SICS</strong>)<strong>.</strong></p>\n<p>SICS is a type of <strong>extracapsular cataract extraction techniques </strong>(ECCE).<strong>\u00a0</strong>In these techniques, the\u00a0major portion of the anterior capsule with the epithelium, nucleus, and cortex are removed, leaving behind the <strong>intact posterior capsule.</strong></p>\n<p><strong>Note:</strong> Newer cataract surgeries include femtosecond laser-assisted cataract surgery (FLACS), micro-incision cataract surgery (MICS) and Phaconit. <strong>FLACS</strong> is a microincision cataract surgery or a micro-phacoemulsification where a femtosecond laser is used to make the corneal incisions, perform capsulorhexis and fragment the lens. <strong>MICS </strong>refers to the phacoemulsification techniques that can be performed through a microincision (&lt;2 mm). <strong>Phaconit</strong> is the term for the bimanual micro-phacoemulsification done with the needle incision technique through an incision of &lt;1mm.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "During a visit to the ophthalmology department, you see the following test being performed for visual field charting of a patient. Identify the instrument used from the options given below.",
    "choices": [
      {
        "id": 1,
        "text": "Octopus"
      },
      {
        "id": 2,
        "text": "Field Master"
      },
      {
        "id": 3,
        "text": "Humphrey Field Analyzer"
      },
      {
        "id": 4,
        "text": "Lister\u2019s perimeter"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image given above shows a <strong>Lister's perimeter</strong>. It is used in <strong>manual</strong>&nbsp;<strong>p</strong><strong>erimetry</strong> for visual field charting</p>\n<p>Classification:</p>\n<ul>\n<li><strong>Manual:</strong>&nbsp;Confrontation, Listers, Campimetry, Goldmann&nbsp;perimeter</li>\n<li><strong>Automated:</strong>&nbsp;Octopus, Field Master, Humphrey Field Analyzer</li>\n<li><strong>Static:&nbsp;</strong>Friedman, Automated</li>\n<li><strong>Kinetic:</strong>&nbsp;Confrontation, Listers, Scotometry, Goldmann</li>\n</ul>\n<p>The <strong>best type</strong> is <strong>automated</strong> perimetry.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/51b939a9d1c34d3a929053da802fffe9.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is the visible range of the electromagnetic spectrum of the human eye?",
    "choices": [
      {
        "id": 1,
        "text": "200-370 nm"
      },
      {
        "id": 2,
        "text": "370-740 nm"
      },
      {
        "id": 3,
        "text": "740-1140 nm"
      },
      {
        "id": 4,
        "text": "800-900 nm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The<strong> visible range</strong> of the electromagnetic spectrum for the human eye is <strong>400\u2013700 nm</strong>.</p>\n<p><strong>Theories of color vision:\u00a0</strong></p>\n<ul>\n<li><strong>Trichromatic theory\u00a0</strong>(<strong>Young\u2013Helmholtz theory</strong>) assumes that there are three types of color receptors. Each receptor is assumed to respond to all wavelengths, however, each has different spectral sensitivities.</li>\n<li><strong>Opponent process theory,</strong>\u00a0also known as the Hering theory,\u00a0assumes three sets of receptor systems\u2014red-green, blue-yellow, and black-white.\u00a0Each one of these functions as an antagonistic pair (e.g., red light stimulates the red receptors and, at the same time, inhibits the green).</li>\n<li><strong>Edwin Land's theory\u00a0</strong>has\u00a0three separate color systems (retinexes).\u00a0Each is an analog to a black-and-white picture.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3e5f6ed5dd2e44eeb33f9993cd59eddex1280x1047.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/82028d1c75ba40e2b6f20c5ba5c5e1d1x1279x1348.JPEG"
    ]
  },
  {
    "text": "A slit-lamp examination reveals the following finding. It is also noted that these yellow-white vitreous opacities do not settle down when the eye is immobile. All of the following statements about this condition are true except:",
    "choices": [
      {
        "id": 1,
        "text": "Mostly unilateral"
      },
      {
        "id": 2,
        "text": "Rarely causes symptoms"
      },
      {
        "id": 3,
        "text": "Associated with diabetes"
      },
      {
        "id": 4,
        "text": "Common in myopes"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The examination findings are suggestive of<strong> asteroid bodies/hyalosis.</strong>\u00a0It is <strong>not\u00a0common</strong> in <strong>myopes.</strong></p>\n<p>Asteroid hyalosis is a common <strong>degenerative process</strong> in which <strong>calcium pyrophosphate</strong> particles collect within the<strong> vitreous gel</strong>. It is seen clinically as numerous tiny round yellow-white opacities of varying size and density. These <strong>move</strong> with the <strong>vitreous</strong> during eye movements but do <strong>not sediment inferiorly</strong> when the eye is immobile.</p>\n<p>Only one eye is affected in 75% of patients; it rarely causes visual problems and the majority of patients are <strong>asymptomatic.</strong> The cause of asteroid hyalosis is unknown, but it has been associated with diabetes mellitus, hypertension, and hypercholesterolemia. The prevalence of asteroid\u00a0hyalosis increases with age and affects 3% of those aged <strong>75\u201386 years.</strong> It is more common in <strong>men</strong> than in women. While treatment of asteroid hyalosis is usually unnecessary, vitrectomy may occasionally be indicated.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ae9fb3da6bbd4cb9bf1352e8d852e287.PNG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Ophthalmology Test Ii';
        const quizFilename = 'ophthalmology-test-ii-466c064d.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2018 - 19"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>