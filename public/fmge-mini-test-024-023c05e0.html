<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 024 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The nerve of the second branchial arch is _________________",
    "choices": [
      {
        "id": 1,
        "text": "Glossopharyngeal nerve"
      },
      {
        "id": 2,
        "text": "Trigeminal nerve"
      },
      {
        "id": 3,
        "text": "Facial nerve"
      },
      {
        "id": 4,
        "text": "Vagal nerve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">The <strong>facial nerve</strong> is the nerve of the <strong>2nd pharyngeal arch</strong>.&nbsp;</p>\n<p class=\"p1\">&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Conscious proprioception is carried by_____.",
    "choices": [
      {
        "id": 1,
        "text": "Dorsal column fibers"
      },
      {
        "id": 2,
        "text": "Anterior spinothalamic tract"
      },
      {
        "id": 3,
        "text": "Lateral spinothalamic tract"
      },
      {
        "id": 4,
        "text": "Vestibular tract"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Conscious</strong> proprioception is carried by <strong>dorsal column</strong>.&nbsp;<strong>Unconscious</strong> proprioception is carried by <strong>spinocerebellar tract</strong>.</p>\n<p>Option B and C: Anterolateral system carries pain, temperature, crude touch.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1dedb03c3b754cba879929cc03557b4dx1280x1310.JPEG"
    ]
  },
  {
    "text": "Which of the following vitamin is the most potent and naturally occurring antioxidant?",
    "choices": [
      {
        "id": 1,
        "text": "Beta carotene"
      },
      {
        "id": 2,
        "text": "Vitamin E"
      },
      {
        "id": 3,
        "text": "Vitamin C"
      },
      {
        "id": 4,
        "text": "Vitamin B1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Vitamin E is&nbsp;the most potent </strong>and <strong>naturally occurring antioxidant.</strong></p>\n<p>Protective antioxidant nutrients:</p>\n<ul>\n<li>Selenium</li>\n<li>Vitamin C</li>\n<li>Vitamin E</li>\n<li>&beta;-carotene (vitamin A)and other carotenoids</li>\n<li>Polyphenolic compounds derived from plant foods</li>\n</ul>\n<p>Therapeutic uses of<strong> high dose of Vitamin E:</strong></p>\n<p>1)Retrolental fibroplasia</p>\n<p>2)Bronchopulmonary dysplasia</p>\n<p>3)Intraventricular hemorrhage</p>\n<p>4)Used for treatment of intermittent claudication.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All are true about Hashimoto\u2019s thyroiditis except______.",
    "choices": [
      {
        "id": 1,
        "text": "Follicular destruction"
      },
      {
        "id": 2,
        "text": "Lymphocytic infiltration"
      },
      {
        "id": 3,
        "text": "Oncocytic metaplasia"
      },
      {
        "id": 4,
        "text": "Orphan Annie eye nuclei"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>All the above features are seen in Hashimoto thyroiditis except <strong>orphan annie eye nuclei</strong>. Orphan Annie eye nuclei are seen in papillary carcinoma of the thyroid.</p>\n<p><strong>Hashimoto thyroiditis </strong></p>\n<ul>\n<li><strong>An autoimmune disease </strong>that results in the destruction of the thyroid gland and gradual and progressive thyroid failure.</li>\n<li>Presence of circulating autoantibodies against thyroglobulin and thyroid peroxidase</li>\n<li><strong>Most common cause of hypothyroidism </strong>in areas of the world where iodine levels are sufficient</li>\n<li><strong>Female predominance</strong></li>\n<li>Thyroid&nbsp;often <strong>diffusely enlarged, painless,&nbsp;</strong>with some degree of<strong> hypothyroidism</strong></li>\n<li><strong>May be preceded by transient thyrotoxicosis</strong> <strong>(&ldquo;hashitoxicosis&rdquo;).</strong></li>\n<li>Extensive infiltration of the parenchyma by <strong>small lymphocytes, plasma cells, and well-developed</strong> <strong>germinal centers </strong></li>\n<li>The thyroid follicles are atrophic and are lined in many areas by <strong>H&uuml;rthle cells</strong>.</li>\n<li>Increased risk of developing other autoimmune diseases.</li>\n<li>Increased risk for the development of <strong>extranodal marginal zone B-cell lymphomas and papillary carcinoma </strong>within the thyroid gland.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8ef809a62c5042e1b062b6db5583f5e7x800x533.JPEG"
    ]
  },
  {
    "text": "A 2 year old child is brought to the OPD with oral and perioral lesions as seen in the image below. Similar lesions were also found on his palms and soles. What is the probable causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "Coxsackie virus"
      },
      {
        "id": 2,
        "text": "Molluscum contagiosum"
      },
      {
        "id": 3,
        "text": "Parvovirus B19"
      },
      {
        "id": 4,
        "text": "Streptococcus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario and the image are suggestive of<strong> hand, foot, and mouth disease</strong> that is caused by <strong>coxsackie A virus</strong>.</p>\n<p><strong>Hand, foot, and mouth disease </strong>initially begins with fever and sore throat following which blisters develop over the oral cavity, hands and feet.</p>\n<p>It usually occurs in children but may also occur in adults. It is a self limiting disease and subsides in 1-2 weeks.</p>\n<p>The following images show lesions affecting hands and feet:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/46f8d758d5734e71be82126c8dac8dbb.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/21b9868b8519401c8f7bc78bdf97c16dx186x179.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/98a06a09e79840a2b3d3b7556a80c6f5x202x270.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ec51305e7b54855b34a3f459969cc2fx381x150.JPEG"
    ]
  },
  {
    "text": "Hemorrhagic cystitis is a characteristic side effect of _______.",
    "choices": [
      {
        "id": 1,
        "text": "Melphalan"
      },
      {
        "id": 2,
        "text": "Busalfan"
      },
      {
        "id": 3,
        "text": "Cyclophosphamide"
      },
      {
        "id": 4,
        "text": "Procarbazine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Hemorrhagic cystitis is a characteristic side effect of <strong>cyclophosphamide</strong>.&nbsp;The metabolite responsible for hemorrhagic cystitis is acrolein. This can be <strong>decreased by</strong> <strong>vigorous hydration</strong> and by the use of <strong>mercapto ethane sulfonic acid (mesna).</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "McNaughten's rule falls under which Section?",
    "choices": [
      {
        "id": 1,
        "text": "Section 84 of CrPC"
      },
      {
        "id": 2,
        "text": "Section 84 of  IPC"
      },
      {
        "id": 3,
        "text": "Section 184 of IPC"
      },
      {
        "id": 4,
        "text": "Section 184 of CrPC"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">McNaughten's rule falls under section <strong>84</strong> of the Indian Penal Code (<strong>IPC</strong>).&nbsp;Mc Naughten's rule (The right or wrong test / The legal test) states that \"A person of unsound mind is <strong>not liable</strong> for an act.\"</p>\n<p class=\"p1\">Defect : In Mc Naughthen&rsquo;s rule , only intellectual factors are considered but emotions, delusion and control of impulses are ignored.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Ohngren\u2019s classification is related to:",
    "choices": [
      {
        "id": 1,
        "text": "Maxillary sinusitis"
      },
      {
        "id": 2,
        "text": "Maxillary osteoma"
      },
      {
        "id": 3,
        "text": "Maxillary carcinoma"
      },
      {
        "id": 4,
        "text": "Frontal sinusitis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Ohngren&rsquo;s classification is used for maxillary carcinoma. </strong></p>\n<p>An imaginary plane is drawn, extending between <strong>medial canthus of eye and the angle of mandible</strong>.</p>\n<p>Ohngren's line(below image):</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7f12b53112ab4a68b318dd6e9e1e8869x720x798.JPEG"
    ]
  },
  {
    "text": "The given sago-grain appearance of conjunctiva is seen in ________",
    "choices": [
      {
        "id": 1,
        "text": "Trachoma"
      },
      {
        "id": 2,
        "text": "Vernal keratoconjunctivitis"
      },
      {
        "id": 3,
        "text": "Phlyctenular conjunctivitis"
      },
      {
        "id": 4,
        "text": "Xerophthalmia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given<strong> sago-grain appearance</strong> of conjunctiva is seen in <strong>trachoma</strong>.</p>\n<p>Conjunctival appearance:</p>\n<p><strong>1. In trachoma</strong></p>\n<ul>\n<li><strong>Sago-grain appearance</strong></li>\n<li>A <strong>follicular</strong> reaction</li>\n</ul>\n<p><strong style=\"font-size: 14px;\">2. In vernal keratoconjunctivitis</strong></p>\n<ul>\n<li><strong>Cobblestone appearance</strong></li>\n<li>A <strong>papillary</strong> reaction</li>\n<li>Seen in palpebral conjunctiva</li>\n</ul>\n<p><strong>3. Phlyctenular conjunctivitis</strong></p>\n<ul>\n<li>White-pinkish <strong>nodule</strong> in <strong>bulbar</strong> conjunctiva</li>\n</ul>\n<p><strong>4. Xerophthalmia</strong></p>\n<ul>\n<li>Epithelial xerosis</li>\n<li><strong>Bitots spot</strong> in <strong>bulbar</strong> conjunctiva</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/96e3dea95aa443e590115792cff0101d.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following diseases are included in the scheme ,which has the logo as given below?",
    "choices": [
      {
        "id": 1,
        "text": "CVD, Diabetes, Bronchial asthma"
      },
      {
        "id": 2,
        "text": "Diabetes, Hypertension, Bronchial asthma"
      },
      {
        "id": 3,
        "text": "CVD, Cancer, Diabetes, Stroke"
      },
      {
        "id": 4,
        "text": "Bronchial asthma, Hypertension, CVD"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The logo shows the NPCDCS scheme that has separate components for <strong>cancer</strong> and other non-communicable diseases like <strong>diabetes, cardiovascular disease </strong>and<strong> stroke</strong>.</p>\n<p>The National Programme for Prevention and Control of Cancer, Diabetes, Cardiovascular Diseases and Stroke (NPCDCS) has specialized facilities in district hospitals.</p>\n<p>It has been implemented in over 100 districts in 21 states.</p>\n<p>At the subcentre level under NPCDCS, screening and referral is done.</p>\n<p>NOTE: Non-alcoholic fattly liver disease (NAFLD) has been integrated with NPCDCS in 2021.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1d65ebab34d14fbbaaa6d8c91674b8d5.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5d4be3e3741a471fa6e0778ec759c9ebx225x225.JPEG"
    ]
  },
  {
    "text": "When information related to health is used to spread a particular systemized doctrine or a political viewpoint to instill it in the minds of the people, what is it called?",
    "choices": [
      {
        "id": 1,
        "text": "Health doctrine"
      },
      {
        "id": 2,
        "text": "Health propaganda"
      },
      {
        "id": 3,
        "text": "Health education"
      },
      {
        "id": 4,
        "text": "Health information"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>When information is used to spread a particular systemized doctrine it is called Health propaganda.</p>\n<p>The difference between health education and health propaganda is given below:</p>\n<div class=\"panel-body ng-scope\">\n<table style=\"width: 421px; height: 428px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 94px;\">&nbsp;</td>\n<td style=\"width: 148px;\"><strong>Health education&nbsp;</strong></td>\n<td style=\"width: 157px;\"><strong>Health propaganda</strong></td>\n</tr>\n<tr>\n<td style=\"width: 94px;\">Knowledge</td>\n<td style=\"width: 148px;\">Actively acquired</td>\n<td style=\"width: 157px;\">Instilled in the mind</td>\n</tr>\n<tr>\n<td style=\"width: 94px;\">Skills</td>\n<td style=\"width: 148px;\">Actively acquired</td>\n<td style=\"width: 157px;\">Instilled</td>\n</tr>\n<tr>\n<td style=\"width: 94px;\">Primitive desires</td>\n<td style=\"width: 148px;\">Disciplined</td>\n<td style=\"width: 157px;\">Aroused</td>\n</tr>\n<tr>\n<td style=\"width: 94px;\">Action</td>\n<td style=\"width: 148px;\">Reflective behaviour; trained to use judgement before acting</td>\n<td style=\"width: 157px;\">Reflexive behaviour; Aims at impulsive action&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 94px;\">Emotion&nbsp;</td>\n<td style=\"width: 148px;\">Does not appeal to emotion but appeals to reason</td>\n<td style=\"width: 157px;\">Appeals to emotion</td>\n</tr>\n<tr>\n<td style=\"width: 94px;\">Behaviour</td>\n<td style=\"width: 148px;\">The process is behaviour centred</td>\n<td style=\"width: 157px;\">&nbsp;The process is information centred</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>Four approaches to health education:</p>\n<ul>\n<li>Regulatory approach: Governmental intervention, direct or indirect, designed to alter human behaviour. It may range from prohibition to imprisonment.</li>\n<li>Service approach: Providing all health services needed by people at their doorstep on the assumption that people would use them to improve their own health.</li>\n<li>Health education approach: People must be educated through planned learning experiences on what to do, and be informed, educated and encouraged to make their own choice for a healthy life.</li>\n<li>Primary health care approach: Full participation and active involvement in planning and delivery of health services based on principles of primary health care viz community involvement and intersectoral coordination.</li>\n</ul>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the best study design to prove causation?",
    "choices": [
      {
        "id": 1,
        "text": "Case control studies"
      },
      {
        "id": 2,
        "text": "Randomized controlled trials"
      },
      {
        "id": 3,
        "text": "Natural experiments"
      },
      {
        "id": 4,
        "text": "Ecological studies"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Randomized controlled trial (RCT) is the <strong>strongest and best</strong> study design to prove causation.</p>\n<p>Case&ndash;control and cohort studies have <strong>moderate</strong> ability to provide evidence for causality.</p>\n<p>Ecological studies or <strong>correlational studies </strong>are<strong>&nbsp;</strong>considered as the weakest study design in this aspect.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is not a feature of Myasthenia Gravis among the following?",
    "choices": [
      {
        "id": 1,
        "text": "Muscle fatigue"
      },
      {
        "id": 2,
        "text": "Absent deep tendon reflexes"
      },
      {
        "id": 3,
        "text": "Normal pupillary reflex"
      },
      {
        "id": 4,
        "text": "Ptosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Absent deep tendon reflex</strong> is <strong>not a feature</strong> of myasthenia gravis.</p>\n<p>Myasthenia gravis is an autoimmune neuromuscular disorder characterized by weakness and fatigability of skeletal muscles. <strong>Reflexes are normal</strong> in Myasthenia gravis.<br />The underlying defect is a decrease in the number of available acetylcholine receptors (AChRs) at neuromuscular junction due to an antibody-mediated autoimmune attack.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the tachycardia depicted in the given ECG.",
    "choices": [
      {
        "id": 1,
        "text": "Atrial fibrillation"
      },
      {
        "id": 2,
        "text": "Atrial flutter"
      },
      {
        "id": 3,
        "text": "Ventricular tachycardia"
      },
      {
        "id": 4,
        "text": "Ventricular fibrillation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given ECG is suggestive of <strong>atrial flutter</strong>.</p>\n<p>The given ECG shows narrow QRS complexes, hence it is supraventricular tachycardia. The RR intervals are regular and the normal P waves are replaced by <strong>sawtooth-shaped</strong> <strong>waves&nbsp;</strong>(red arrows), known as flutter waves. Hence, it is most likely to be atrial flutter.</p>\n<p>In atrial flutter, the ventricular rate is determined by the AV conduction ratio. The commonest AV ratio is 2:1. As the atrial rate is around 300 bpm, AV conduction ratio of 2:1 results in a ventricular rate of ~150 bpm.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f89986976cc44521b9f9a8e1f7f65d53.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/83ccc936da244a8ca580c56a88af1c6ax182x137.PNG"
    ]
  },
  {
    "text": "An HIV-positive individual presents with the following. What is the diagnosis &  WHO clinical stage of HIV?",
    "choices": [
      {
        "id": 1,
        "text": "Oral candidiasis  &  WHO Stage 2"
      },
      {
        "id": 2,
        "text": "Oral hairy leukoplakia &  WHO Stage 3"
      },
      {
        "id": 3,
        "text": "Oral candidiasis & WHO Stage 3"
      },
      {
        "id": 4,
        "text": "Oral hairy leukoplakia & WHO Stage 2"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Oral candidiasis (Thrush) is characterized in WHO Clinical Stage 3.</p>\n<p>Oral Candidiasis (Thrush)<em>,</em> and oral hairy leukoplakia, are oral lesions characterized in WHO clinical Stage 3. They generally occur in patients with <strong>CD4+ T cell counts of &lt;300/&mu;L.</strong></p>\n<p>Differentiating oral candidiasis and oral hairy leukoplakia:</p>\n<ul>\n<li>Oral Candidiasis (Thrush) appears as a white, cheesy exudate, on an erythematous mucosa in the posterior oropharynx. The diagnosis is made by direct examination of pseudohyphal elements.</li>\n<li>Oral hairy leukoplakia presents as white, frondlike lesions, generally along the lateral borders of the tongue and sometimes on the adjacent buccal mucosa(image below). Despite its name, oral hairy leukoplakia is not considered premalignant. Lesions are associated with Ebstein barr virus (EBV).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7e9b9ea108a34dc1b28a6c9e0ef28a9c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5b06d82b3c58482f954c73818461a3afx720x405.JPEG"
    ]
  },
  {
    "text": "A diagnosis of gouty arthritis is made after aspiration of the synovial fluid and polarised light microscopy shows negatively birefringent needle-shaped crystals.  These crystals are",
    "choices": [
      {
        "id": 1,
        "text": "Calcium apatite"
      },
      {
        "id": 2,
        "text": "Monosodium urate crystals"
      },
      {
        "id": 3,
        "text": "Calcium pyrophosphate crystals"
      },
      {
        "id": 4,
        "text": "Calcium Oxalate crystals"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Negatively birefringent, needle-shaped </strong>crystals seen&nbsp;on polarised light microscopy in gouty&nbsp;arthritis is due to the deposition of&nbsp;<strong>monosodium urate crystals</strong>.</p>\n<p>Other options:</p>\n<p>Option A- Calcium apatite crystals can accumulate in areas of tissue damage, hypercalcemic, or hyperparathyroid states.</p>\n<p>Option C- Calcium pyrophosphate crystals are rhomboid-shaped and are seen in pseudogout.</p>\n<p>Option D-&nbsp;Calcium Oxalate crystals are seen in chronic renal failure.</p>\n<p>Monosodium urate crystals in gout-</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d480d92a9e6c4347b76c70f9c0028f92x889x657.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dd2a43a5248c4bda81c80500270c5d26x850x571.PNG"
    ]
  },
  {
    "text": "Parathyroid gland post surgery  is commonly transferred to:",
    "choices": [
      {
        "id": 1,
        "text": "Triceps"
      },
      {
        "id": 2,
        "text": "Biceps"
      },
      {
        "id": 3,
        "text": "Sartorius"
      },
      {
        "id": 4,
        "text": "Brachioradialis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Parathyroid is commonly transferred to <strong>brachioradialis</strong> muscle post surgery.</p>\n<p>When multiple parathyroids are resected, parathyroid tissue is transplanted to the non-dominant forearm. Pockets are made in the belly of the brachioradialis muscle, and one to two pieces of parathyroid tissue measuring 1 mm each are placed into each pocket. A total of 12 to 14 pieces are transplanted.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old woman presents with a history of swelling in the right groin for the past 6 months. On examination, an irreducible hernia is present in the right groin. Which of the following structures would be helpful in identifying if the hernia is inguinal or femoral in origin?",
    "choices": [
      {
        "id": 1,
        "text": "Pubic symphysis"
      },
      {
        "id": 2,
        "text": "Pubic tubercle"
      },
      {
        "id": 3,
        "text": "Femoral artery"
      },
      {
        "id": 4,
        "text": "Inferior epigastric artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Pubic tubercle</strong> is used to differentiate between inguinal and femoral hernias.</p>\n<p><strong>Inguinal hernia</strong> is <strong>above </strong>and <strong>medial</strong>&nbsp;to the pubic tubercle.</p>\n<p><strong>Femoral hernia</strong> is <strong>below </strong>and <strong>lateral</strong> to the pubic tubercle.</p>\n<p>Another structure that is useful in differentiating between inguinal and femoral hernia is inguinal ligament. An <strong>inguinal </strong>hernia leaves the abdominal cavity just <strong>above</strong> the inguinal ligament and a <strong>femora</strong>l hernia leaves just <strong>below</strong> the inguinal ligament.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-year-old is brought with superficial and deep second degree burns on his chest. What is the most accurate method to assess the total body surface area involved ?",
    "choices": [
      {
        "id": 1,
        "text": "Parkland's formula"
      },
      {
        "id": 2,
        "text": "Lund and Browder chart"
      },
      {
        "id": 3,
        "text": "Using the child's  palm as reference"
      },
      {
        "id": 4,
        "text": "Wallace's rule"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Lund and Browder</strong> chart gives a more accurate accounting of the true burn size in <strong>children</strong>.</p>\n<p>Unlike the Wallace rule of nines, the Lund and Browder chart takes into consideration the&nbsp;<strong>age of the person</strong>, by decreasing percentage BSA (Body Surface Area) for the head and increasing percentage BSA for the legs as the child ages, making it more useful in pediatric burns.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/631e8108dee7400a9c5f0dcdc94d9345.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/23c8f9f5a6a3479b96051b82388ad219x1280x2317.JPEG"
    ]
  },
  {
    "text": "Which is the most common organism causing acute bacterial prostatitis?",
    "choices": [
      {
        "id": 1,
        "text": "Enterococcus"
      },
      {
        "id": 2,
        "text": "Proteus"
      },
      {
        "id": 3,
        "text": "Streptococcus Agalacticia"
      },
      {
        "id": 4,
        "text": "E.coli"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The most common organism causing <strong>acute bacterial prostatitis</strong> is <strong>Escherichia coli.</strong></p>\n<p><strong>Acute bacterial prostatitis</strong></p>\n<ul>\n<li>Acute inflammation of the prostate associated with urinary tract infection&nbsp;(UTI).</li>\n<li>Other than <em>E. coli</em>, Staphylococcus aureus,&nbsp;Staphylococcus&nbsp;albus,&nbsp;Streptococcus faecalis,&nbsp;Neisseria gonorrhoeae, or&nbsp;<em>Chlamydia</em> species may also be responsible.</li>\n<li>Caused by ascending urethral infection or reflux of infected urine into prostatic ducts.</li>\n<li>Treatment: Trimethoprim-sulphamethoxazole and ciprofloxacin for 4&ndash;6 weeks.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an absolute contraindication to OCP use?",
    "choices": [
      {
        "id": 1,
        "text": "Chronic renal disease"
      },
      {
        "id": 2,
        "text": "Thromboembolism"
      },
      {
        "id": 3,
        "text": "History of amenorrhea"
      },
      {
        "id": 4,
        "text": "Diabetes mellitus"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"page\" title=\"Page 1\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<div class=\"page\" title=\"Page 1\">\n<p><strong>Thromboembolism</strong> is an absolute contraindication to OCP use.</p>\n<p><strong>Contraindications</strong> of OCPs:</p>\n<ul>\n<li><strong>Absolute </strong>contraindications&nbsp;-\n<ul>\n<li>Breast and genital cancers</li>\n<li>Liver disease</li>\n<li><strong>History of thromboembolism- DVT, stroke</strong></li>\n<li>Congenital hyperlipidemia</li>\n<li>Undiagnosed AUB.</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li><strong>Relative </strong>contraindications<strong> -</strong>&nbsp;\n<div class=\"page\" title=\"Page 146\">&nbsp;</div>\n<ul>\n<li>Pregnancy</li>\n<li>Uncontrolled hypertension</li>\n<li>Chronic renal disease</li>\n<li>If she is a smoker aged &gt;35 years</li>\n<li>Migraine with aura</li>\n<li>First 6 months of nursing</li>\n<li>Diabetes with vascular involvement</li>\n<li>Gallbladder disease</li>\n<li>History of infrequent bleeding or amenorrhea</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A multigravida woman at 33 weeks of gestation presents with epigastric pain, headache, visual symptoms, blood pressure 170/100mm Hg, and proteinuria - 3+. She was given a loading dose of 14g MgSO4, followed by 5g intramuscularly every 4 hours in the alternate buttocks. Which regimen is being followed here?",
    "choices": [
      {
        "id": 1,
        "text": "Sibai regimen"
      },
      {
        "id": 2,
        "text": "Intravenous regimen"
      },
      {
        "id": 3,
        "text": "Zuspan regimen"
      },
      {
        "id": 4,
        "text": "Pritchard regimen"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A 33 Weeks multigravida woman presents with epigastric pain, headache, visual symptoms, blood pressure of 170/100mm Hg, and proteinuria -3+ which indicates <strong>severe preeclampsia</strong>. The administration of&nbsp;MgSO4 is being given here is by the <strong>Pritchard regimen</strong>.</p>\n<p>MgSO4 regimens for management of eclampsia and severe preeclampsia:</p>\n<table style=\"width: 405px;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 105px;\">Regimen</td>\n<td style=\"width: 154px;\">Loading Dose</td>\n<td style=\"width: 144px;\">Maintenance Dose</td>\n</tr>\n<tr>\n<td style=\"width: 105px;\">Intramuscular (<strong>Pritchard</strong>)</td>\n<td style=\"width: 154px;\">4g (20% solution) IV over 3-5 minute<br />followed by 10g (5O%), deep IM<br />(5 gm in each buttock)</td>\n<td style=\"width: 144px;\">5g (5O%) IM 4 hourly in the alternate buttocks</td>\n</tr>\n<tr>\n<td style=\"width: 105px;\">Intravenous (<strong>Zuspan or Sibai</strong>)</td>\n<td style=\"width: 154px;\">4g IV slow over 15-20 minute</td>\n<td style=\"width: 144px;\">1-2g/h IV infusion</td>\n</tr>\n</tbody>\n</table>\n<p>Repeat injections of MgSO4 are given only if:</p>\n<ul>\n<li>Knee jerks are present</li>\n<li>Urine output &gt; 30 mL/h</li>\n<li>Respiratory rate &gt; 12/minute</li>\n</ul>\n<div class=\"page\" title=\"Page 296\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>It is continued for 24 hours after the last seizure or delivery whichever is later.</p>\n</div>\n</div>\n</div>\n</div>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/20a6c3215a3540eaad8d2a7485603fa9x557x600.JPEG"
    ]
  },
  {
    "text": "Which of the following is a part of AMTSL?",
    "choices": [
      {
        "id": 1,
        "text": "Uterotonics after delivery of  placenta"
      },
      {
        "id": 2,
        "text": "Controlled cord traction"
      },
      {
        "id": 3,
        "text": "Uterine massage"
      },
      {
        "id": 4,
        "text": "Early cord  clamping"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p class=\"ng-binding\"><strong>Controlled cord traction during placental delivery</strong>&nbsp;is a component of AMTSL (Active management of third stage of labour).</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p><strong>AMTSL</strong>&nbsp;recommended by&nbsp;<strong>WHO</strong>&nbsp;:</p>\n<ul>\n<li><strong>Immediate (within 1 minute)</strong>&nbsp;administration of prophylactic uterotonic (Oxytocin). Oxytocin 10 IU is given IM or IV. Generally, it should be given after delivery of the fetus and <strong>before the delivery of the placenta.</strong>&nbsp;</li>\n<li><strong>Controlled cord traction</strong> during placental delivery (in vaginal birth where skilled birth attendants are present)</li>\n<li><strong>Delayed cord clamping</strong></li>\n<li><strong>Postpartum abdominal uterine tone assessment</strong> for early identification of uterine atony is recommended for all women<span style=\"font-size: 14px;\">(done&nbsp;</span><span style=\"font-size: 14px;\">every 15 minutes for 2 hours)</span></li>\n</ul>\n<p><strong>Uterine massage </strong>is<strong> not a part of AMTSL.&nbsp;</strong><span style=\"font-size: 14px;\">During the uterine tone assessment </span><span style=\"font-size: 14px;\">to ensure a contracted uterus, if there is uterine atony, a fundal massage is performed.&nbsp;</span></p>\n<p>The <strong>goal of this is to prevent postpartum haemorrhage (PPH)</strong>. Hence, uterotonics are the<strong> most important</strong> factor to decrease PPH.&nbsp;</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The most common anomaly in a child presenting with recurrent urinary tract infections is _______.",
    "choices": [
      {
        "id": 1,
        "text": "Posterior urethral valves"
      },
      {
        "id": 2,
        "text": "Vesicoureteric reflux"
      },
      {
        "id": 3,
        "text": "Urinary bladder stone"
      },
      {
        "id": 4,
        "text": "Pelvi ureteric junction"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most common cause of <strong>recurrent urinary tract infection</strong> in children is <strong>vesicoureteric reflux.</strong></p>\n<div class=\"page\" title=\"Page 3902\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>VUR occurs when the submucosal tunnel between the mucosa and detrusor muscle is short or absent. VUR usually is congenital and often familial</p>\n</div>\n</div>\n</div>\n<p>Vesicoureteric reflux is more common in females.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/13a0b2172bf74ce9b99ac0d886096e00x1280x2420.JPEG"
    ]
  },
  {
    "text": "A patient was admitted to ICU 48 hours after the fracture of the femur. The saturation of oxygen in the rebreathing unit was 100% but his Spo2 remained 60%. The patient is in a state of confusion. Chest radiograph showed lung fields to be clear. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pulmonary embolism"
      },
      {
        "id": 2,
        "text": "Fat embolism"
      },
      {
        "id": 3,
        "text": "ARDS"
      },
      {
        "id": 4,
        "text": "Occult pneumothorax"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely diagnosis of the above clinical scenario is a fat embolism. Presence of <strong>respiratory insufficiency</strong> and <strong>altered mental status</strong> following a <strong>long bone fracture (fracture of the femur)</strong> favours the diagnosis.</p>\n<p>Fat embolism syndrome results from the presence of numerous fat emboli within the microcirculation. It most commonly occurs after the fracture of the long bone or pelvis. They&nbsp;present with non-specific symptoms like <strong>tachypnea, tachycardia </strong>and <strong>fever </strong>that&nbsp;manifest within <strong>24- 48 hours</strong> after the injury. Damage to the microvasculature of various organs leads to :</p>\n<ul>\n<li>Mild hypoxia to rapidly progressing respiratory failure.</li>\n<li>Depression of the central nervous system.</li>\n<li>Petechial rashes</li>\n<li>Hemorrhagic lesions of the retina.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "To diagnose post traumatic stress disorder, the symptoms should persist for more than ______.",
    "choices": [
      {
        "id": 1,
        "text": "2 days"
      },
      {
        "id": 2,
        "text": "1 month"
      },
      {
        "id": 3,
        "text": "3 months"
      },
      {
        "id": 4,
        "text": "6 months"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In post traumatic stress disorder, the symptoms persist for <strong>more than one month</strong>.&nbsp;</p>\n<table style=\"width: 310px;\">\n<tbody>\n<tr style=\"height: 18px;\">\n<td style=\"width: 159.506px; text-align: center; height: 18px;\"><strong>Duration</strong></td>\n<td style=\"width: 174.494px; text-align: center; height: 18px;\"><strong>Condition</strong></td>\n</tr>\n<tr style=\"height: 42px;\">\n<td style=\"width: 159.506px; height: 42px; text-align: center;\">2 days to 1 month</td>\n<td style=\"width: 174.494px; height: 42px; text-align: center;\">Acute stress reaction</td>\n</tr>\n<tr style=\"height: 42.6761px;\">\n<td style=\"width: 159.506px; height: 42.6761px; text-align: center;\">More than 1 month</td>\n<td style=\"width: 174.494px; height: 42.6761px; text-align: center;\">Post-traumatic stress disorder</td>\n</tr>\n<tr style=\"height: 54px;\">\n<td style=\"width: 159.506px; height: 54px; text-align: center;\">Symptoms occur after 6 months</td>\n<td style=\"width: 174.494px; height: 54px; text-align: center;\">Delayed Post-traumatic stress disorder</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a true statement regarding Allen's test?",
    "choices": [
      {
        "id": 1,
        "text": "Used to confirm Ryle's tube position"
      },
      {
        "id": 2,
        "text": "Used to confirm tracheal intubation"
      },
      {
        "id": 3,
        "text": "Used to diagnose wrist dislocation"
      },
      {
        "id": 4,
        "text": "Used to assess adequacy of collateral blood flow"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Allen's Test</strong>&nbsp;is used to test the adequacy of <strong>collateral blood flow</strong> to the hand. It mandatory before radial artery cannulation and sometimes, before drawing blood for arterial blood gas (ABG) analysis.</p>\n<p>Method<strong>:</strong></p>\n<p>It is performed by occluding the radial and ulnar arteries and asking the patient to make a tight fist so as to exsanguinate the palm.</p>\n<p>Then, the patient is asked to open the hand and the occlusion over the ulnar artery is released. If the palm remains pale for more than 6-10 seconds, it indicates reduced ulnar collateral flow.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 30-year-old female presents with painful genital ulcers on vulva accompanied by bilateral lymphadenopathy. She has a history of multiple partners over the years. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Chancroid"
      },
      {
        "id": 2,
        "text": "Granuloma inguinale"
      },
      {
        "id": 3,
        "text": "Lymphogranuloma venerum"
      },
      {
        "id": 4,
        "text": "Gonorrhoea"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Multiple painful genital ulcers</strong> with <strong>bilateral lymphadenopathy</strong> are indicative of<strong> chancroid or soft chancre.</strong></p>\n<p>Chancroid is a type of sexually transmitted infection (STI) that is caused by the bacteria <strong>Haemophilus ducreyi,</strong> a <strong>gram-negative coccobacillus.</strong> It presents with <strong>painful genital ulceration</strong> along with <strong>painful inguinal lymphadenopathy </strong>that may develop into <strong>buboes. Auto-inoculation</strong> by the organism can result in new ulcers merging with the older ones. Hence, they are called <strong>\"kissing ulcers\".</strong></p>\n<p>The diagnosis is made clinically and can be supported by the gram stain findings,<strong> \"school of fish\"/\"railroad track\" appearance.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b5187886fe02464ba59aea8aa27b7d62x1279x1319.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/22309b319b834a99b034cc0952ea5cf7x576x384.PNG"
    ]
  },
  {
    "text": "A child with features of bowing of legs and delayed walking presented to the OPD.  Radiograph of the hand was taken and given below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Scurvy"
      },
      {
        "id": 2,
        "text": "Rickets"
      },
      {
        "id": 3,
        "text": "Achondroplasia"
      },
      {
        "id": 4,
        "text": "Juvenile rheumatoid arthritis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>X-ray findings suggestive of active rickets are <strong>fraying</strong>,&nbsp;<strong>cupping of the metaphysis</strong> and <strong>widening of joint spaces.</strong></p>\n<p>Earliest radiological finding of rickets is <strong>loss of provisional zone of calcification</strong></p>\n<p>It is not surprising that these features are most prominent at the growth plates where growth is greatest:</p>\n<ul>\n<li>Knee:&nbsp;distal femur, proximal tibia</li>\n<li>Wrist:&nbsp;especially the ulna</li>\n<li>Anterior rib ends:&nbsp;<strong>Rachitic rosary</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/fef96c62dd504648886ca89dd47d8eaa.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Radiotherapy is most useful in:",
    "choices": [
      {
        "id": 1,
        "text": "Seminoma"
      },
      {
        "id": 2,
        "text": "Melanoma"
      },
      {
        "id": 3,
        "text": "Osteosarcoma"
      },
      {
        "id": 4,
        "text": "Pancreatic carcinoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Seminoma is a highly radiosensitive tumor and hence radiotherapy is commonly used for treatment.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Fmge Mini Test - 024';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>