<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proteinuria Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "An 18-year-old waiter comes for a follow-up of proteinuria. He also complains of swelling in his feet after standing all day. Urinalysis showed 500 mg of protein. However, a repeat sample taken on the next morning had no protein. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Minimal change disease"
      },
      {
        "id": 2,
        "text": "Orthostatic proteinuria"
      },
      {
        "id": 3,
        "text": "Sustained proteinuria"
      },
      {
        "id": 4,
        "text": "Transient proteinuria"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient presenting with <strong>proteinuria</strong> in a urine sample with a <strong>clean sample</strong> in the <strong>morning</strong> most likely has <strong>orthostatic proteinuria,</strong> which occurs due to his <strong>upright posture</strong> all day.\u00a0</p>\n<p>Orthostatic proteinuria is the <strong>most common</strong> cause of <strong>isolated proteinuria</strong> in <strong>teenagers</strong> and <strong>children.</strong> It is believed to occur due to either a <strong>left renal vein entrapment</strong> or an <strong>exaggerated vascular response</strong> leading to <strong>increased filtration pressure</strong> in the kidneys. Family history should be obtained to rule out any familial conditions associated with proteinuria.\u00a0</p>\n<p><strong>Diagnosis</strong> and <strong>Management:</strong> Diagnosis is confirmed by obtaining a <strong>Urine protein</strong> to <strong>creatinine ratio</strong> in the <strong>standing</strong> and <strong>recumbent position</strong> and noting a difference between the two.\u00a0</p>\n<p>Usually, asymptomatic patients need no further management. <strong>Annual followups</strong> are required to monitor for further worsening of the proteinuria.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Minimal change disease</strong> is associated with <strong>&gt;3g</strong> of <strong>protein excretion</strong> per day with <strong>edema</strong> and <strong>hypercholesterolemia.</strong> This patient does not meet the criteria for a diagnosis of MCD.</p>\n<p>Option C: <strong>Sustained</strong> proteinuria is a term used to describe <strong>&gt;1-2g/day</strong> of <strong>proteinuria</strong> and is associated with <strong>glomerular</strong> disease.</p>\n<p>Option D: <strong>Transient</strong> proteinuria is seen in conditions like <strong>fever, exercise</strong> and emotional <strong>stress</strong> and has a benign prognosis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following conditions cause overflow proteinuria except:",
    "choices": [
      {
        "id": 1,
        "text": "Multiple myeloma"
      },
      {
        "id": 2,
        "text": "Rhabdomyolysis"
      },
      {
        "id": 3,
        "text": "Intravascular hemolysis"
      },
      {
        "id": 4,
        "text": "Nephrolithiasis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Nephrolithiasis</strong> is an example of <strong>postrenal proteinuria</strong> which occurs due to an <strong>insult</strong> beyond the <strong>renal tubules.</strong> All the other given conditions cause proteinuria due to an increase in the <strong>production</strong> of a <strong>particular</strong> type of <strong>protein; light chains</strong> in <strong>multiple myeloma, myoglobin</strong> in <strong>rhabdomyolysis,</strong> and <strong>hemoglobin</strong> in <strong>intravascular hemolysis.</strong></p>\n<p>In the given scenario, the patient has multiple myeloma. Thus the type of proteinuria this patient is likely to have is overflow proteinuria.</p>\n<p>Various types of proteinuria:</p>\n<ul>\n<li><strong>Glomerular</strong> - Increased filtration of proteins due to the disruption of the basement membrane</li>\n<li><strong>Tubular</strong> - Impaired protein reabsorption in the proximal convoluted tubule (PCT) due to damage to the tubules\u00a0</li>\n<li><strong>Overflow</strong> - Excess production of low-molecular-weight proteins, such as light chains, in multiple myeloma</li>\n<li><strong>Postrenal</strong> - Secretion of IgA and IgG by the urinary tract due to infections or stones</li>\n</ul>\n<p>Normally, the following mechanisms prevent proteinuria:</p>\n<p>The <strong>glomerular basement membrane</strong> acts as a barrier to prevent the loss of negatively charged and large proteins.<br />Reabsorption of small proteins in the PCT</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child presents with a distended abdomen after a history of frothy urine for the last 1 month. Fluid analysis shows a growth of Streptococcus pneumonia. Other investigations are normal except for an increase in serum cholesterol. What is the likely etiology of this infection?",
    "choices": [
      {
        "id": 1,
        "text": "Hepatic fibrosis"
      },
      {
        "id": 2,
        "text": "Chronic low protein diet"
      },
      {
        "id": 3,
        "text": "Urinary loss of protein"
      },
      {
        "id": 4,
        "text": "Bone marrow dysfunction"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This child with a history of <strong>frothy urine</strong> for 3 weeks now presenting with <strong>ascites</strong> has a culture positive for <strong>Streptococcus pneumonia.</strong> This indicates <strong>peritonitis.</strong> The presence of <strong>hypercholesterolemia</strong> in combination with <strong>frothy urine</strong> raises suspicion of <strong>nephrotic syndrome.</strong>This leads to a loss of <strong>immunoglobulins</strong> in the <strong>urine</strong> which renders the <strong>child</strong> unable to mount an <strong>immune response</strong> making him <strong>susceptible</strong> to <strong>infections.</strong>\u00a0</p>\n<p><strong>Nephrotic syndrome</strong> in children is primarily <strong>idiopathic,</strong> with <strong>minimal change disease</strong> being the most common <strong>glomerular lesion.</strong> Podocyte injury or genetic mutations in podocyte proteins can lead to <strong>nephrotic-range</strong> proteinuria.</p>\n<p><strong>Edema</strong> is the most common presenting symptom. They have elevated levels of <strong>cholesterol, triglycerides, low-density lipoproteins</strong> (LDL), and <strong>very low-density</strong> lipoproteins (VLDL). It is caused by both increased <strong>lipid synthesis</strong> and <strong>decreased lipid catabolism.</strong>\u00a0</p>\n<p>They are prone to infections especially by <strong>encapsulated bacteria</strong> due to factors such as <strong>urinary losses</strong> of <strong>immunoglobulin</strong> G (IgG) and complement factors (C3, C5, factors B and D). <strong>Nephrotic</strong> syndrome is a <strong>hypercoagulable</strong> state due to <strong>vascular</strong> stasis, <strong>increased</strong> platelet, increased <strong>hepatic production</strong> of fibrinogen, and <strong>urinary losses</strong> of <strong>antithrombotic</strong> factors such as antithrombin III and protein S.\u00a0</p>\n<p>The <strong>diagnosis</strong> is confirmed by performing a urinalysis and <strong>urine protein: creatinine</strong> ratio. The recommended initial treatment for nephrotic syndrome is a daily dose of <strong>2mg/kg</strong> (max 60mg) of <strong>prednisolone</strong> for 6 weeks followed by an <strong>alternate</strong> dose of <strong>1.5mg/kg (max 40mg)</strong> for the next <strong>6-8</strong> weeks.\u00a0</p>\n<p>Definitions regarding the course of nephrotic syndrome:\u00a0</p>\n<p><strong>Remission</strong> is characterized by a urine protein: creatinine ratio of &lt;0.2 or &lt;1+ protein on urine dipstick testing for 3 consecutive days<br /><strong>Response</strong> in nephrotic syndrome is defined as achieving remission within the initial 4 weeks of corticosteroid therapy<br /><strong>Relapse</strong> is indicated by an increase in urine protein: creatinine ratio &gt;0.2 or a reading of 2+ and higher for 3 consecutive days.<br /><strong>Frequently</strong> relapsing: \u22652 relapses in 6 months or 4 relapses in 12 months.<br /><strong>Steroid-dependent</strong> nephrotic syndrome: Relapse during steroid tapering or within 2 weeks of discontinuation.<br /><strong>Steroid resistance:</strong> Failure to achieve remission despite therapy with daily prednisolone for 4 weeks and alternate days for the next 4 weeks.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 12-year-old boy comes with complaints of fatigue and tiredness for 2 weeks. He consumes a balanced diet. He also has been having frothy urine for a few months. Further evaluation shows 7.2 mg/dl hemoglobin, normal serum eosinophil count, and 3.5 g of protein in the urine. Which of the following explains his anemia?",
    "choices": [
      {
        "id": 1,
        "text": "Insufficient dietary intake"
      },
      {
        "id": 2,
        "text": "Urinary protein losses"
      },
      {
        "id": 3,
        "text": "Worm infestation"
      },
      {
        "id": 4,
        "text": "Hemolysis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient presenting with <strong>nephrotic range proteinuria</strong> with complaints of fatigue most likely has developed <strong>anemia</strong> secondary to <strong>urinary protein losses.</strong> There is an increase in excretion of transferrin, (a protein responsible for carrying iron), <strong>iron,</strong> and other ions which lead to these patients being susceptible to <strong>iron deficiency</strong> anemia.\u00a0</p>\n<p><strong>Nephrotic syndrome</strong> in children is primarily idiopathic, with <strong>minimal change</strong> disease being the most <strong>common glomerular</strong> lesion. Podobcyte <strong>injury</strong> or genetic mutations in podocyte proteins can lead to nephrotic-range proteinuria.</p>\n<p><strong>Edema</strong> is the most common presenting symptom. They have elevated levels of <strong>cholesterol, triglycerides, low-density</strong> lipoproteins (LDL), and <strong>very low-density</strong> lipoproteins (VLDL). It is caused by both increased <strong>lipid synthesis</strong> and decreased <strong>lipid catabolism.</strong>\u00a0</p>\n<p>They are <strong>prone</strong> to <strong>infections</strong> especially by <strong>encapsulated bacteria</strong> due to factors such as <strong>urinary losses</strong> of <strong>immunoglobulin</strong> G (IgG) and complement factors (C3, C5, factors B and D). Nephrotic syndrome is a <strong>hypercoagulable</strong> state due to <strong>vascular stasis,</strong> increased platelet, increased <strong>hepatic</strong> production of <strong>fibrinogen,</strong> and urinary losses of antithrombotic factors such as antithrombin III and protein S. <strong>Iron deficiency</strong> anemia is a <strong>rare</strong> sequelae and is associated with the <strong>steroid-resistant</strong> variant of nephrotic syndrome. Still, it can be present in children who have gone untreated for a long time.\u00a0</p>\n<p>The diagnosis is confirmed by performing a <strong>urinalysis</strong> and <strong>urine protein: creatinine</strong> ratio. The recommended initial treatment for nephrotic syndrome is a daily dose of 2mg/kg (max 60mg) of prednisolone for 6 weeks followed by an alternate dose of 1.5mg/kg (max 40mg) for the next 6-8 weeks.\u00a0</p>\n<p>Definitions regarding the course of nephrotic syndrome:\u00a0</p>\n<p><strong>Remission</strong> is characterized by a urine protein: creatinine ratio of &lt;0.2 or &lt;1+ protein on urine dipstick testing for 3 consecutive days<br /><strong>Response</strong> in nephrotic syndrome is defined as achieving remission within the initial 4 weeks of corticosteroid therapy<br /><strong>Relapse</strong> is indicated by an increase in urine protein: creatinine ratio &gt;0.2 or a reading of 2+ and higher for 3 consecutive days.<br /><strong>Frequently</strong> relapsing: \u22652 relapses in 6 months or 4 relapses in 12 months.<br /><strong>Steroid-dependent</strong> nephrotic syndrome: Relapse during steroid tapering or within 2 weeks of discontinuation.<br /><strong>Steroid resistance:</strong> Failure to achieve remission despite therapy with daily prednisolone for 4 weeks and alternate days for the next 4 weeks.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following tests are done to evaluate protein in urine?",
    "choices": [
      {
        "id": 1,
        "text": "Moore's test"
      },
      {
        "id": 2,
        "text": "Seliwanoff's test"
      },
      {
        "id": 3,
        "text": "Muric acid test"
      },
      {
        "id": 4,
        "text": "Sulfosalicylic acid test"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Sulfosalicylic acid</strong> test is done to evaluate for protein in the urine.\u00a0</p>\n<p>The <strong>sulfosalicylic acid (SSA)</strong> test is done by mixing <strong>one part</strong> of <strong>urine</strong> with <strong>three parts</strong> of <strong>SSA</strong> and then comparing the <strong>turbidity</strong> that develops according to the following:</p>\n<ul>\n<li>0: no turbidity (0 mg/dL)</li>\n<li>Trace: slight turbidity (1 to 10 mg/dL)</li>\n<li>1+: turbidity through which print can be read (15 to 30 mg/dL)</li>\n<li>2+: white cloud without precipitate (40 to 100 mg/dL)</li>\n<li>3+: white cloud with fine precipitate (150 to 350 mg/dL)</li>\n<li>4+: flocculent precipitate (&gt;500 mg/dL)</li>\n</ul>\n<p>Other options:\u00a0</p>\n<p>Options A and B: Moore's test and Seliwanoff's test are done to test to distinguish between monosaccharides and disaccharides.\u00a0</p>\n<p>Option C: Muric acid test is done to test for galactose.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are managing a patient with microalbuminuria.  He has a past history of diabetes and hypertension. Which of the following drugs can be used as a part of his drug regimen ?",
    "choices": [
      {
        "id": 1,
        "text": "2,3,5"
      },
      {
        "id": 2,
        "text": "2,3,4,5"
      },
      {
        "id": 3,
        "text": "1,2,5"
      },
      {
        "id": 4,
        "text": "2,3,4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient with <strong>microalbuminuria</strong> with a past history of <strong>diabetes</strong> and <strong>hypertension</strong> will need a drug that can manage his <strong>comorbidities</strong> and <strong>prevent</strong> the <strong>worsening</strong> of his kidney function. Out of the options, <strong>empagliflozin, losartan,</strong> and <strong>lisinopril</strong> are the only drugs that have a proven benefit in patients with microalbuminuria.\u00a0</p>\n<p><strong>Empagliflozin</strong> is an <strong>SGLT2</strong> receptor antagonist and prevents the deterioration of kidney function by reducing the <strong>activation</strong> of the <strong>macula densa. </strong>This is because blockade of the SGLT 2 receptor allows more Na+ and glucose to reach the JG apparatus thus reducing production of renin and subsequently the RAAS pathway. This <strong>reduces perfusion</strong> pressure in the <strong>glomerulus</strong> and reduces <strong>hyperfiltration</strong> injury. <strong>Losartan</strong> and <strong>Lisinopril</strong> are both drugs that modulate the <strong>RAAS pathway</strong> thus reducing the hyperfiltration injury. Thus these drugs can be added in the <strong>management</strong> of a patient with <strong>microalbuminuria</strong> based on their comorbidities to preserve kidney function.\u00a0</p>\n<p><strong>Amlodipine</strong> and <strong>Chlorthalidone</strong> offer <strong>no renoprotective</strong> effect so they will not be the <strong>first line</strong> in this <strong>patient.</strong>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is being evaluated for proteinuria with the gold standard test. What test was he likely advised?",
    "choices": [
      {
        "id": 1,
        "text": "Urine protein to creatinine ratio"
      },
      {
        "id": 2,
        "text": "Urine albumin to creatinine ratio"
      },
      {
        "id": 3,
        "text": "24 hour urine collection"
      },
      {
        "id": 4,
        "text": "Sulfosalicylic acid test"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>24-hour urine</strong> collection is the <strong>gold standard</strong> for <strong>quantification</strong> of <strong>protein</strong> excreted in the <strong>urine.</strong></p>\n<p>In this test, after the first voided morning sample is discarded, subsequent urine samples are collected in a container. Usually, a <strong>preservative</strong> is added to allow for later testing. This <strong>24 hour</strong> sample is then evaluated to calculate the amount of protein excreted. Although <strong>spot urine protein</strong> to <strong>creatinine</strong> ratios are done in clinical practice, they have the disadvantage of being <strong>dependent</strong> on <strong>creatinine excretion</strong> which can vary. Hence, 24-hour urine protein studies are done in doubtful cases to quantify urine protein.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 43-year-old male patient comes with complaints of frothy urine and facial swelling since 3 weeks . He has had an on-and-off history of back and flank pain over the past year. Vitals are pulse 70bpm, BP 160/96 mmHg. An abdominal ultrasound is ordered. What is likely to be seen on USG?",
    "choices": [
      {
        "id": 1,
        "text": "Fluid in the peritoneal cavity"
      },
      {
        "id": 2,
        "text": "Radiopaque mass in the kidney"
      },
      {
        "id": 3,
        "text": "Cystic lesions in the kidney"
      },
      {
        "id": 4,
        "text": "Shrinkage of one kidney"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient complains of <strong>swelling</strong> in his <strong>face</strong> accompanied by <strong>frothy urine</strong> which likely indicates <strong>proteinuria.</strong> This combined with findings of <strong>on</strong> and <strong>off back</strong> and <strong>flank pain</strong> with <strong>high blood pressure</strong> raises suspicions of <strong>Autosomal dominant polycystic kidney disease.</strong> That would manifest as <strong>cystic lesions</strong> in the <strong>kidneys</strong> on <strong>USG</strong> of the abdomen and pelvis.</p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>ADPKD is inherited as an<strong>\u00a0autosomal dominant</strong>\u00a0trait with mutations in the\u00a0<strong>PKD1</strong>(chromosome 16) and\u00a0<strong>PKD2</strong>\u00a0genes (chromosome 4).\u00a0</p>\n<p>The disease does not usually manifest<strong>\u00a0before</strong>\u00a0<strong>30 years\u00a0</strong>of age, and in some patients, it is never diagnosed.\u00a0The progression of the disease is faster in males.\u00a0</p>\n<p><strong>Hypertension\u00a0</strong>is the most common presentation.\u00a0<strong>Renal\u00a0</strong>manifestations\u00a0of ADPKD\u00a0include:</p>\n<ul>\n<li>Flank/loin pain -\u00a0\u00a0either due to haemorrhage inside cysts or due to renal stones (most commonly\u00a0<strong>uric acid stones</strong>)</li>\n<li>Irregular upper quadrant renal mass</li>\n<li>Proteinuria</li>\n<li>Hematuria</li>\n<li>Uremia</li>\n<li><strong>Renal failure\u00a0</strong>(seen in 10-15% of the patients who receive hemodialysis)</li>\n</ul>\n<p>Proteinuria is seen in patients with <strong>progressive disease</strong> and it is usually <strong>nephrotic</strong> range. Biopsies have shown the etiology to be <strong>focal segmental glomerulosclerosis</strong> and <strong>membranous nephropathy.</strong></p>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>The most common extrarenal manifestation is\u00a0<strong>hepatic cysts</strong>\u00a0which are\u00a0<strong>derived from the biliary epithelium</strong>.<strong>\u00a0</strong>Other extra-renal manifestations of ADPKD:</p>\n<ul>\n<li>Pancreatic cysts</li>\n<li>Berry aneurysms (Rupture of cerebral aneurysms is an important cause of morbidity and The prevalence of intracranial aneurysms in patients with PKD is 40%.)</li>\n<li>Colonic diverticula</li>\n<li>Abdominal hernias</li>\n<li>Mitral valve prolapse\u00a0</li>\n</ul>\n<p>\u00a0Screening cerebral angiography is strongly considered in all patients with PKD and a family history of cerebral aneurysm or subarachnoid haemorrhage.</p>\n</div>\n</div>\n<p><strong>Intravenous pyelography</strong>\u00a0shows characteristic\u00a0<strong>spider leg sign</strong>, as a result of stretched calyces due to multiple cysts. Nephrogram shows a\u00a0<strong>swiss cheese</strong>\u00a0appearance. On\u00a0<strong>prenatal USG</strong>, the presence of either\u00a0<strong>&gt; 3 cysts\u00a0</strong>in\u00a0<strong>unilateral kidneys</strong>\u00a0or<strong>\u00a0&gt; 2 cysts</strong>\u00a0in\u00a0<strong>each kidney</strong>\u00a0is suggestive of PKD.\u00a0</p>\n<p>Treatment\u00a0includes</p>\n<ul>\n<li><strong>Surgical decompression</strong>\u00a0is\u00a0<strong>not</strong>\u00a0a\u00a0<strong>routine</strong>\u00a0procedure performed in these patients. It may be required only in cases of very large cysts causing persistent pain and infected cysts.</li>\n<li>Analgesics</li>\n<li><strong>Increased</strong>\u00a0<strong>fluid</strong>\u00a0intake\u00a0\n<ul>\n<li>Prevents renal stone formation</li>\n<li>Reduces growth of cysts by suppressing ADH release</li>\n</ul>\n</li>\n<li><strong>ACE inhibitors\u00a0</strong>and ARBs\n<ul>\n<li>Blood pressure control\u00a0</li>\n<li>Slowing of cyst growth</li>\n</ul>\n</li>\n<li><strong>Tolvaptan\u00a0</strong>(V2 receptor antagonist)\n<ul>\n<li>Reduce pain and\u00a0<strong>slow\u00a0</strong>the<strong>\u00a0decline\u00a0</strong>in<strong>\u00a0renal function</strong></li>\n</ul>\n</li>\n<li>Long-term dialysis</li>\n<li><strong>Renal transplant</strong>\n<ul>\n<li>Definitive management</li>\n<li>Pre-transplant nephrectomy may be required in patients with very large polycystic kidneys</li>\n</ul>\n</li>\n</ul>\n<div class=\"ng-scope\">\n<div class=\"ng-scope\">\n<p>Other options:\u00a0</p>\n<p>Option A: <strong>Fluid</strong> in the <strong>peritoneal cavity</strong> can occur in case of <strong>ascites.</strong> However, ascites is a late manifestation of prolonged <strong>proteinuria.</strong> This patient's <strong>flank pain</strong> with <strong>hypertension</strong> should raise <strong>suspicions</strong> of <strong>ADPKD</strong><strong>.</strong></p>\n<p>Option B: <strong>Radiopaque masses</strong> in <strong>kidneys</strong> can be seen in <strong>nephrolithiasis.</strong> This presents with <strong>flank</strong> <strong>pain</strong> but it is colicky in nature and usually does not cause <strong>proteinuria enough</strong> to cause <strong>facial swelling. Hypertension</strong> is also not associated with nephrolithiasis.</p>\n<p>Option D: <strong>Shrinkage</strong> of a <strong>kidney</strong> can occur in case of a <strong>unilateral renal artery</strong> stenosis which leads to reduced perfusion and reduction in the size. However, this isn't associated with proteinuria and flank pain.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient diagnosed with renal cell carcinoma was started on a tyrosine kinase inhibitor that acts by inhibiting VEGF. He is now being evaluated for increasing protein excretion in his urine. Which of the following drugs was prescribed to the patient?",
    "choices": [
      {
        "id": 1,
        "text": "Ramucirumab"
      },
      {
        "id": 2,
        "text": "Sunitinib"
      },
      {
        "id": 3,
        "text": "Aflibercept"
      },
      {
        "id": 4,
        "text": "Pembrolizumab"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Sunitinib</strong> is a small molecule, <strong>multi-targeted kinase antagonist/inhibitor</strong> and has been shown to have <strong>anti-tumor activity </strong>in <strong>renal cell carcinoma (RCC)</strong>, <strong>gastrointestinal stromal tumor</strong> (GIST) and <strong>pancreatic neuroendocrine tumors</strong> (pNETs). <strong>Proteinuria</strong> is a common adverse effect of the drug.\u00a0</p>\n<p><strong>Pharmacology</strong> of sunitinib:</p>\n<ul>\n<li>Molecular targets of sunitinib are <strong>c-Kit, VEGFR-2, PDGFR-\u03b2</strong> and <strong>Flt-3.</strong></li>\n<li>Sunitinib targets mutations in the RET gene.</li>\n<li>The <strong>mechanisms</strong> of <strong>sunitinib\u2019s action</strong> are:Inhibition of activated c-Kit and PDGFR in GIST</li>\n<li>Inhibition of VEGFR in advanced RCC</li>\n</ul>\n<p><strong>Adverse effects:</strong></p>\n<ul>\n<li><strong>Its</strong> specific adverse effects include <strong>neutropenia, diarrhea</strong> and <strong>fatigue.</strong></li>\n<li>Generally, the other common side effects of agents having anti-VEGFR activity are <strong>hypertension</strong> and <strong>proteinuria.</strong></li>\n<li>Rarely, they cause <strong>bleeding</strong> and <strong>clotting disorders,</strong> and <strong>perforation</strong> of <strong>scarred gastrointestinal lesions.</strong></li>\n<li>Hand-foot syndrome has also been noted in the use of these agents, with erythema and desquamation of distal extremities.</li>\n</ul>\n<p><strong>Administration:</strong> In advanced RCC and in adjuvant therapy, sunitinib is given <strong>orally,</strong> at a dose of <strong>50mg per day,</strong> once daily, with or without food, for <strong>4 weeks</strong> out of 6 (nine 6-week cycles in adjuvant therapy).</p>\n<p>Uses:</p>\n<ul>\n<li>In <strong>metastatic GIST,</strong> the main chemotherapeutic agent used is imatinib, which is a selective inhibitor of the c-kit tyrosine kinase. Patients whose tumors have become refractory to imatinib benefit from agents like sunitinib, which also inhibits c-kit tyrosine kinase.</li>\n<li>It is now undergoing studies for efficacy in hepatocellular carcinoma.</li>\n</ul>\n<p>Update:</p>\n<ul>\n<li>The drug was previously approved for use by various regulatory bodies in 2006, for conditions like GIST and advanced RCC.</li>\n<li>In 2017, <strong>sunitinib maleate</strong> was approved by the FDA for use as <strong>adjuvant therapy</strong> for patients at risk for <strong>recurrence</strong> of <strong>RCC</strong> after a kidney has been removed <strong>(nephrectomy).</strong></li>\n<li>This was based on a multi-center, international, double-blinded, placebo-controlled trial among 615 patients with high risk of recurrent RCC following nephrectomy.</li>\n</ul>\n<p>Other options:\u00a0</p>\n<p>Option A: <strong>Ramucirumab</strong> is a human IgG1 monoclonal antibody that targets <strong>VEGFR2,</strong> preventing <strong>VEGFR</strong> ligand binding and thereby reducing ligand-induced activity in endothelial cells. It is used in combination with docetaxel to treat patients with metastatic non-small cell lung cancer (NSCLC). Adverse effects include <strong>hypertension</strong> and <strong>diarrhea.</strong></p>\n<p>Option C: <strong>Aflibercept</strong> is a recombinant fusion protein that functions as a VEGF trap by sequestering VEGF using the VEGFR1-binding domain. It is used in treating metastatic colorectal cancer</p>\n<p>Option D: <strong>Pembrolizumab</strong> is a humanized monoclonal IgG4\u03ba isotype antibody that prevents the interaction between programmed cell death protein 1 (PD-1) and its ligands. It is used in the treatment of non-small cell lung cancer, either before or after chemotherapy with platinum. It is also used in the treatment of melanoma, urothelial cancer, Merkel cell carcinoma and Hodgkin lymphoma. Serious adverse events include <strong>pneumonitis, colitis</strong> and <strong>hepatitis.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old with a past history of colon cancer with new onset massive proteinuria comes with abdominal pain. USG abdomen shows a thrombus in the left renal vein. What is likely to be present in this patient with regard to his underlying condition?",
    "choices": [
      {
        "id": 1,
        "text": "Anti PLA2R antibodies"
      },
      {
        "id": 2,
        "text": "Elevated complement levels"
      },
      {
        "id": 3,
        "text": "Splitting of the glomerular basement membranes"
      },
      {
        "id": 4,
        "text": "Immune complexes comprised of IgA"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">This patient with a history of <strong>massive proteinuria</strong> now presenting with a thrombus in his <strong>renal vein</strong> has developed <strong>renal vein thrombosis.</strong> The history of massive proteinuria suggests a nephrotic syndrome. Membranous nephropathy is the most commonly associated nephrotic syndrome associated with RVT. <strong>AntiPLA2R antibodies</strong> are associated with membranous nephropathy.</span></p>\n<p><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Membranous nephropathy</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> is one of the most common causes of nephrotic syndrome in older adults, with a peak incidence in 30\u201350 years and a male: female ratio of 2:1. It is a form of chronic </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">immune-complex-mediated</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> disease. It can be </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">primary</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> (75% of cases) or </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">secondary. Factors</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> that can lead to</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> secondary membranous nephropathy</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> include:</span></p>\n<ul>\n<li><strong>Solid malignancies\u00a0</strong>- <strong>colon</strong>, breast, lung.</li>\n<li>Infection - <strong>Hepatitis B</strong>, Syphilis, Malaria, Schistosomiasis</li>\n<li>Rheumatological disorders - Lupus, IgG4-related disease.</li>\n</ul>\n<p>Light microscopy shows <strong>diffuse thickening of</strong> the <strong>glomerular capillary wall, </strong>due to deposition of immune complexes between the basement membrane and the overlying epithelial cells. <strong>Irregular spikes</strong> of basement membrane between these deposits are best <strong>seen with silver stains</strong>. <strong>Immunofluorescence microscopy</strong> shows <strong>diffuse</strong> <strong>granular</strong> <strong>deposits</strong> containing <strong>IgG</strong> and <strong>C3. </strong><strong>Electron microscopy </strong>shows electron-dense <strong>subepithelial deposits</strong> (<strong>epimembranous spikes</strong>) and effacement of foot processes of podocytes.</p>\n<p>This patient's clinical features are suggestive of a diagnosis of <strong>nephrotic syndrome</strong> complicated with renal vein thrombosis. <strong>Thrombo-embolic complications</strong> in nephrotic syndrome are due to the <strong>loss of endogenous anticoagulants </strong>such as <strong>antithrombin III</strong>\u00a0in the urine.</p>\n<p>Other options:<br />Option B: Elevated complement levels are not associated with any nephrotic syndrome reduced C3 levels are seen in post streptococcal glomerulonephritis.</p>\n<p>Option C: Splitting of the glomerular basement membrane is seen in Alport syndrome.</p>\n<p>Option D: Immune complexes comprised of vitamin D is seen in IgA nephropathy. However, all these conditions are not commonly associated with RVT.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are analyzing urine samples for the presence of proteins. Which of the following conditions is associated with a high false negative rate on the urinary dipstick for the presence of protein?",
    "choices": [
      {
        "id": 1,
        "text": "Alport syndrome"
      },
      {
        "id": 2,
        "text": "Multiple myeloma"
      },
      {
        "id": 3,
        "text": "Lupus nephritis"
      },
      {
        "id": 4,
        "text": "Diabetic nephropathy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>A <strong>urine dipstick</strong> is associated with a <strong>high rate</strong> of <strong>false negativity </strong>(up to 50% of cases) in <strong>multiple myeloma.</strong> This is due to the <strong>excreted proteinuria</strong> comprising of <strong>light chains</strong> which is <strong>not picked</strong> up by a <strong>urinary dipstick</strong> which is useful in cases of <strong>albuminuria.</strong>\u00a0</p>\n<p><strong>Urine dipstick</strong> examinations primarily detect <strong>albumin.</strong> A <strong>24-hour</strong> urine protein <strong>quantitation</strong> and <strong>urine electrophoresis</strong> provide an estimate of total protein excretion, as well as the proportion of urine protein that is albumin versus monoclonal free light chains (M-protein).</p>\n<p><strong>Multiple myeloma</strong> is a malignant <strong>plasma cell dyscrasia</strong> with the <strong>proliferation</strong> of <strong>plasma cells</strong> derived from a single clone. <strong>Bone pain</strong> is the most common symptom of multiple myeloma. Tumor cells release <strong>osteoclast activating factors</strong> (OAFs), which <strong>increase osteoclast activity</strong> and <strong>accelerate bone destruction.</strong> Furthermore, there is suppression of osteoblast activity to form new bone. Lysis of the bone leads to hypercalcemia. Patients with multiple myeloma also have an increased susceptibility to infections because of diffuse hypogammaglobulinemia (decreased production and increased destruction) of normal antibodies.\u00a0</p>\n<p>Other important features of multiple myeloma include:\u00a0</p>\n<ul>\n<li><strong>Renal failure</strong></li>\n<li>Normocytic and normochromic anemia</li>\n<li><strong>Hyperviscosity</strong> syndromes</li>\n<li>Elevated <strong>ESR</strong></li>\n<li><strong>Normal alkaline phosphatase</strong> due to suppression of osteoblast activity.</li>\n<li><strong>Serum protein electrophoresis</strong> shows the presence of <strong>monoclonal</strong> protein</li>\n<li>Urinalysis shows free kappa and lambda light chains (Bence-Jones proteins)</li>\n</ul>\n<p>Diagnostic Criteria for Multiple Myeloma include:</p>\n<p><strong>Clonal bone marrow</strong> plasma cells <strong>\u226510%</strong> (or) <strong>biopsy-proven</strong> bony or <strong>extramedullary plasmacytoma</strong></p>\n<p>plus</p>\n<p>Any one or more of the following myeloma-defining events:</p>\n<ul>\n<li>Evidence of <strong>end-organ damage</strong> attributable to the underlying plasma cell proliferative disorder, specifically: (CRAB <strong>features)Hypercalcemia:</strong>\n<ul>\n<li>Serum <strong>calcium</strong> level <strong>&gt;1</strong> mg/dL higher than the upper limit of normal or &gt;11 mg/dL</li>\n<li>Renal insufficiency: Serum <strong>creatinine &gt;2</strong> mg/dL</li>\n<li>Anemia: <strong>Hemoglobin level</strong> of <strong>&gt;2</strong> g/dL below the lowest limit of normal, or Hb &lt;10 g/dL</li>\n<li>Bone lesions: One or more osteolytic lesions on radiography, computed tomography (CT), or positron emission tomography (PET).</li>\n<li>Any one or more of the following biomarkers of malignancy:<br />\n<ul>\n<li>Clonal bone marrow plasma cells \u2265 60%</li>\n<li>Serum involved / uninvolved free light-chain ratio of 100 or greater.</li>\n<li>&gt;1 focal lesion on magnetic resonance imaging (MRI).</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>All the other options are conditions which cause <strong>albumin</strong> to be excreted, hence they will lead to a <strong>positive urine</strong> dipstick.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with acyclovir resistant CMV retinitis on treatment with an IV drug is being evaluated for a positive diptick protein test. There are also crystals seen in his urine on microscopy. What is the likely drug he was started on?",
    "choices": [
      {
        "id": 1,
        "text": "Tenofovir"
      },
      {
        "id": 2,
        "text": "Foscarnet"
      },
      {
        "id": 3,
        "text": "Amphotericin B"
      },
      {
        "id": 4,
        "text": "Cidofovir"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient with <strong>acyclovir-resistant CMV retinitis</strong> now presenting with <strong>crystals</strong> in his <strong>urine</strong> with <strong>proteinuria</strong> has been likely started on <strong>Foscarnet. </strong>80% of the foscarnet is usually excreted unchanged in the urine and is what leads to the nephrotoxic effect. This can be <strong>prevented</strong> by giving <strong>plenty</strong> of <strong>hydration.</strong></p>\n<p><strong>Foscarnet</strong> is an antiviral agent that is active against all <strong>herpes viruses</strong> and <strong>HIV. Foscarnet</strong> is an inorganic <strong>pyrophosphate</strong> analog. It <strong>does not</strong> require activation by <strong>viral thymidine kinase</strong> for <strong>antiviral activity.</strong> It <strong>inhibits viral nucleic</strong> acid synthesis by directly <strong>inhibiting HSV DNA polymerase</strong> and <strong>HIV reverse transcriptase.</strong></p>\n<p><strong>Foscarnet</strong> is used to treat <strong>acyclovir-resistant herpes</strong> simplex virus (genital herpes) and <strong>varicella-zoster</strong> virus infections and <strong>ganciclovir-resistant cytomegalovirus</strong> (CMV) infections. It is also used as an alternative agent in <strong>CMV retinitis</strong> in <strong>AIDS,</strong> and <strong>CMV viremia</strong> in bone marrow transplant recipients.</p>\n<p>Common side effects of foscarnet include <strong>nephrotoxicity</strong> and <strong>hypocalcemia.</strong></p>\n<p>Foscarnet is mainly <strong>excreted</strong> by the <strong>kidneys.</strong> Therefore, <strong>dose reduction</strong> is necessary for <strong>renal impairment</strong> to avoid the accumulation of the drug and associated toxicity.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Tenofovir</strong> is a reverse transcriptase inhibitor that <strong>prevents</strong> the <strong>conversion</strong> of <strong>viral RNA</strong> into proviral <strong>DNA.</strong> It helps to prevent infection of susceptible cells but does not eradicate the virus from cells that are integrated with proviral DNA. It is active against HIV 1, 2, and HBV.</p>\n<p>Option C: <strong>Amphotericin</strong> <strong>B</strong> is a <strong>broad-spectrum antifungal.</strong> It binds to <strong>ergosterol</strong> in the fungal membrane and forms pores or channels in the fungal cell membrane. This allows the <strong>leakage</strong> of <strong>cytosolic molecules</strong> and ions, leading to a <strong>loss</strong> of <strong>membrane integrity.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 45-year-old female patient presents to the casualty due to reduced urination. A Foley catheter is placed. The urine analysis reveals proteinuria. Her BP was found to be 200/100 mmHg. She has a history of scleroderma. Which of the following drugs will be the mainstay in her management?",
    "choices": [
      {
        "id": 1,
        "text": "Labetalol"
      },
      {
        "id": 2,
        "text": "Captopril"
      },
      {
        "id": 3,
        "text": "Clonidine"
      },
      {
        "id": 4,
        "text": "Sodium nitroprusside"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical features of <strong>proteinuria, accelerated hypertension,</strong> and<strong> oliguria</strong> along with a past history of scleroderma is suggestive of a <strong>scleroderma renal crisis. ACE inhibitors\u00a0</strong>like\u00a0<strong>captopril\u00a0</strong>are the first line drugs in the management of a scleroderma renal crisis.</p>\n<p>Scleroderma renal crisis is a <strong>medical emergency</strong> characterized by acute onset malignant hypertension and kidney failure, usually in the absence of previous evidence of significant kidney disease. The use of <strong>steroids</strong> is associated with an <strong>increased</strong> <strong>risk</strong> of scleroderma renal crisis.</p>\n<p class=\"p1\">Clinical features of scleroderma renal crisis are:</p>\n<ul>\n<li class=\"p1\"><strong>Accelerated hypertension\u00a0</strong>-\u00a0headache, vomiting, blurring of vision, hypertensive retinopathy, and hypertensive encephalopathy.</li>\n<li class=\"p1\"><strong>Acute kidney injury</strong> - oliguria, mild proteinuria, microscopic hematuria, renal failure.</li>\n<li class=\"p1\">Pulmonary edema, congestive heart failure.</li>\n<li class=\"p1\">Microangiopathic hemolytic anemia (<strong>schistocytes</strong>), thrombocytopenia.</li>\n</ul>\n<p>Risk factors for scleroderma renal crisis include\u00a0<strong>African-American race, male sex,</strong> and <strong>diffuse or progressive skin involvement</strong>. Up to 50% of patients with scleroderma renal crisis have\u00a0<strong>anti-RNA polymerase III antibodies</strong>, whereas patients with <strong>anti-centromere antibodies</strong> appear to be<strong> protected</strong> from this complication.</p>\n<p>The antibodies tested in systemic sclerosis include:</p>\n<ul>\n<li><strong>Antinuclear antibody (ANA) </strong>(Option 1) - positive in most cases of systemic sclerosis. The absence of this antibody suggests considering an alternate diagnosis.\u00a0</li>\n<li><strong>Anticentromere antibody (ACA)</strong>\u00a0- usually positive in<strong> limited</strong> cutaneous systemic sclerosis</li>\n<li><strong>Antitopoisomerase I (anti-Scl-70) antibody</strong> (Option 2)- usually positive with <strong>diffuse</strong> cutaneous systemic sclerosis (Option 2)</li>\n<li><strong>Anti-RNA polymerase III antibody</strong> (Option 4)- usually positive with <strong>diffuse</strong> cutaneous systemic sclerosis.</li>\n</ul>\n<p>Scleroderma renal crisis is a medical emergency and should be treated with <strong>angiotensin</strong> <strong>II</strong> <strong>receptor blockers, calcium channel blockers,</strong> and <strong>direct renin inhibitors.</strong> Glucocorticoids should be used at a low dose only when necessary.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with proteinuria is being evaluated. A CT scan shows a thrombus in the inferior vena cava. What is the likely mechanism of proteinuria?",
    "choices": [
      {
        "id": 1,
        "text": "Increased capillary osmotic pressure"
      },
      {
        "id": 2,
        "text": "Increased capillary hydrostatic pressure"
      },
      {
        "id": 3,
        "text": "Increased  colloid osmotic pressure"
      },
      {
        "id": 4,
        "text": "Increased interstitial osmotic pressure"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient with a finding of <strong>proteinuria</strong> is found to have a <strong>thrombus</strong> in the <strong>inferior vena cava.</strong> This leads to an <strong>increased capillary hydrostatic pressure downstream</strong> from the <strong>renal vein</strong> which leads to <strong>hyperfiltration</strong> and thus <strong>proteinuria.</strong>\u00a0</p>\n<p><strong>Starling's</strong> forces are what determine the rate of filtration along a capillary. These forces are represented as:</p>\n<p><strong>Fluid movement = k [(Pc\u2212 Pi) \u2212 (\u03c0c\u2212 \u03c0i)]</strong></p>\n<p>where, k = capillary filtration coefficient</p>\n<p>Pc = capillary hydrostatic pressure</p>\n<p>Pi = interstitial hydrostatic pressure</p>\n<p>\u03c0c = capillary colloid osmotic pressure</p>\n<p>\u03c0i = interstitial colloid osmotic pressure</p>\n<p>In this scenario, this patient with a <strong>thrombus</strong> in the <strong>IVC</strong> has increased <strong>Pc</strong> which leads to <strong>increased fluid movements</strong> into the <strong>kidney tubules.</strong> This hyperfiltration can lead to proteinuria if the force is large enough to cause injury to the tubular cells. Similar findings are seen in a <strong>patient</strong> with <strong>hypertension</strong> who will also have <strong>hyperfiltration injury</strong> leading to <strong>proteinuria.</strong>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient post hepatic transplant requires immunosuppression. He has proteinuria on the urine dipstick. Which of the following drugs is safe to use in his case?",
    "choices": [
      {
        "id": 1,
        "text": "Mycophenolate mofetil"
      },
      {
        "id": 2,
        "text": "Sirolimus"
      },
      {
        "id": 3,
        "text": "Cyclosporin"
      },
      {
        "id": 4,
        "text": "Tacrolimus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient with a history of <strong>hepatic transplantation</strong> requires <strong>immunosuppression.</strong> Since he is a known case of <strong>renal disease</strong> with <strong>proteinuria,</strong> he requires a <strong>drug</strong> that has a <strong>low incidence</strong> of <strong>nephrotoxicity. Mycophenolate mofetil</strong> is the drug of choice for him.</p>\n<p><strong>Mycophenolate mofetil</strong> is a prodrug that is rapidly converted to <strong>mycophenolic</strong> acid.</p>\n<p>It is a <strong>selective, non-competitive, reversible</strong> inhibitor of <strong>inosine monophosphate dehydrogenase</strong> (IMPDH), an important enzyme in the de novo pathway of guanine nucleotide synthesis.</p>\n<p>It is a useful immunosuppressive in cases where <strong>cyclosporine</strong> or <strong>tacrolimus</strong> are not tolerated. It is used for the <strong>prevention</strong> of <strong>organ transplant</strong> rejection.</p>\n<p>Other options:</p>\n<p><strong>Sirolimus</strong> can cause worsening proteinuria in existing kidney disease and is hence contraindicated in this patient.\u00a0</p>\n<p><strong>Cyclosporin</strong> and <strong>tacrolimus</strong> are both <strong>nephrotoxic</strong> and are not indicated for a known case of kidney dysfuntion.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with rheumatic heart disease comes with complaints of reduced urination. Urine analysis reveals proteinuria and hematuria. A renal biopsy shows crescent formation, with a few embolic and septic abscesses. Which of the following primary conditions could have led to his renal findings?",
    "choices": [
      {
        "id": 1,
        "text": "Henoch-Schonlein purpura"
      },
      {
        "id": 2,
        "text": "Bacterial endocarditis"
      },
      {
        "id": 3,
        "text": "Microangiopathic hemolytic anemia"
      },
      {
        "id": 4,
        "text": "Sickle cell disease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient with <strong>rheumatic heart disease</strong> (indicating a damaged heart valve) now presents with <strong>oliguria,</strong>\u00a0<strong>proteinuria,</strong> and <strong>hematuria</strong>. The biopsy findings of crescents and <strong>abscesses</strong> make <strong>septic emboli</strong> the likely cause. <strong>Subacute bacterial endocarditis</strong> is most likely associated with <strong>endocarditis-associated glomerulonephritis.</strong>\u00a0</p>\n<p><strong>Endocarditis-associated glomerulonephritis</strong> is mostly associated with <strong>subacute bacterial endocarditis</strong> that has gone <strong>untreated</strong> for a long time as it allows for the formation of <strong>antigen-antibody complexes. Acute bacterial endocarditis</strong> on the other hand is picked up clinically and is usually <strong>treated aggressively</strong> thus <strong>not allowing</strong> for the <strong>kidney disease</strong> to <strong>progress.</strong>\u00a0</p>\n<p>Patients commonly present with oliguria, acute kidney injury or rapidly progressive glomerulonephritis. Grossly, the kidney will show a <strong>flea-bitten appearance</strong> with <strong>multiple abscesses.</strong> Biopsy shows crescents. Immunofluorescence shows IgM, IgG, and C3.</p>\n<p>Treatment is treating the underlying endocarditis, and monitoring the patient for improvement in kidney function.\u00a0</p>\n<p>Other Options:<br /><br />Option A: <strong>Henoch-schonlein purpura</strong> usually has an accompanying palpable purpura with glomerulonephritis. It is also not associated with rapidly progressive glomerulonephritis.</p>\n<p>Option C: <strong>Microangiopathic hemolytic anemia</strong> can occur in cases of valve replacements where the valve malfunctions leading to shearing and rupture of RBCs. This can present with findings of proteinuria and hematuria but the presence of crescents on biopsy and a lack of history of valve replacement makes endocrditis likely.</p>\n<p>Option D:\u00a0 <strong>Sickle cell disease</strong> causes renal papillary necrosis which presents with frank hematuria and progressively declining renal function. The additional finding of septic emboli makes an infective cause more likely.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following cases with proteinuria is renal biopsy not indicated?",
    "choices": [
      {
        "id": 1,
        "text": "A patient with urine protein of 300 mg/day"
      },
      {
        "id": 2,
        "text": "A patient with hematuria and proteinuria"
      },
      {
        "id": 3,
        "text": "A pregnant woman"
      },
      {
        "id": 4,
        "text": "A patient with unexplained acute kidney injury"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Isolated <strong>proteinuria</strong> of <strong>less than 500 mg/day</strong> is a <strong>contraindication</strong> to renal biopsy since the <strong>risks outweigh</strong> the <strong>benefits.\u00a0</strong>This range of proteinuria is usually a mild disease or can be a consequence of normal aging.\u00a0</p>\n<p>Indications of kidney biopsy:</p>\n<ol>\n<li>Nephrotic syndrome with no apparent cause</li>\n<li>Nephritic syndrome to identify the cause to guide further management</li>\n<li>Unexplained acute kidney injury</li>\n</ol>\n<p>Contraindications of kidney biopsy:</p>\n<ol>\n<li><strong>Non-nephrotic</strong> range proteinuria(&lt;500mg/day) with no hematuria as their prognosis is good and usually have no specialised treatment</li>\n<li><strong>Single kidney</strong> is a a relative contraindication</li>\n<li><strong>Bleeding diathesis</strong></li>\n<li>Hydronephrosis</li>\n<li>Solitary native kidney</li>\n</ol>\n<p>Pregnancy as such is not a contraindication for renal biopsy and is decided on a case to case basis.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A marathon runner is brought in because of reduced urination 8 hours after a 30 km marathon on a sunny day. Urine analysis shows a dark yellow color, creatinine 0.8 mg/dl, urine protein ++, and blood negative. His BP is 100/60 mmHg. What is the cause of his urinary protein findings?",
    "choices": [
      {
        "id": 1,
        "text": "Strenuous exercise"
      },
      {
        "id": 2,
        "text": "Acute kidney injury"
      },
      {
        "id": 3,
        "text": "Rhabdomyolysis"
      },
      {
        "id": 4,
        "text": "Dehydration"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This patient presenting 8 hours after a marathon with <strong>only proteinuria</strong> with other renal parameters within normal limits is likely a case of <strong>isolated proteinuria</strong> due to <strong>strenuous exercise</strong> which leads to a <strong>transient increase</strong> in the <strong>glomerular permeability.</strong> This condition is <strong>self-resolving</strong> and requires no further management except for <strong>adequate hydration.</strong>\u00a0</p>\n<p>Other options:</p>\n<p>Option B: <strong>Acute kidney injury</strong> presents with an <strong>increase</strong> in <strong>creatinine</strong> as a symptom which is not present in this patient.</p>\n<p>Option C: <strong>Rhabdomyolysis</strong> presents with <strong>myoglobin</strong> in the urine which can cause a <strong>positive</strong> test in the <strong>urine dipstick</strong> for blood. Here it is negative making <strong>rhabdomyolysis</strong> unlikely.\u00a0</p>\n<p>Option D: Dehydration can cause <strong>concentration</strong> of the blood components but it will not cause proteinuria.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young primigravida at 34 weeks of gestation was admitted since her BP was 150/90 mmHg and urine dipstick was 2+ on antenatal checkup. All the following will be included in the diagnostic criteria of pre-eclampsia, except ________.",
    "choices": [
      {
        "id": 1,
        "text": "Urine protein creatinine ratio of \u2265 0.3"
      },
      {
        "id": 2,
        "text": "24-hour urinary protein excretion of \u2265 0.3 g"
      },
      {
        "id": 3,
        "text": "Serum creatinine level of 1.8 mg/dL"
      },
      {
        "id": 4,
        "text": "Platelet count of 1.5 lakh/cu.mm"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A platelet count of 1.5 lakh/cu.mm is not a criterion to diagnose pre-eclampsia.</p>\n<p>Pre-eclampsia&nbsp;occurs&nbsp;due to the<strong> failure </strong>of the <strong>invasion</strong> of<strong>&nbsp;extravillous trophoblasts</strong>&nbsp;into the<strong>&nbsp;spiral artery.&nbsp;</strong>It is characterized by blood pressure of <strong>&gt;140/90 mmHg</strong> on two occasions 4 hours apart with proteinuria or signs of end-organ damage.</p>\n<p>Criteria to diagnose pre-eclampsia:</p>\n<ul>\n<li><strong>Proteinuria of &ge; 300 mg (0.3 g)&nbsp;</strong>in 24 hours or<strong> urine protein:creatinine ratio of &ge;0.3</strong></li>\n<li><strong>Platelet count of &lt;1 lakh/cu.mm</strong></li>\n<li><strong>Serum creatinine level of &gt;1.1 mg/dL</strong></li>\n<li>Serum transaminase levels twice the normal concentration</li>\n<li>Headache, visual disturbances, or epigastric pain</li>\n<li>Pulmonary edema</li>\n</ul>\n<p>Clinical types of pre-eclampsia:</p>\n<ul>\n<li><strong>Nonsevere pre-eclampsia</strong>: Blood pressure &gt;140/90&nbsp;mmHg but &lt;160/110&nbsp;mmHg without significant proteinuria</li>\n<li><strong>Severe pre-eclampsia</strong>: Persistent increase of systolic blood pressure <strong>above 160 mmHg or diastolic above 110 mmHg</strong> with any of the following, proteinuria, oliguria (&lt;400 mL in 24 hours), platelet count &lt;1 lakh/cu.mm, serum creatinine level of &gt;1.1 mg/dL, persistent severe epigastric pain, marked elevation of liver enzyme levels, cerebral (convulsions) or visual disturbances, intrauterine growth restriction of the fetus, and pulmonary edema.</li>\n</ul>\n<p><strong>Complications of pre-eclampsia:</strong></p>\n<ul>\n<li>Eclampsia</li>\n<li>HELLP syndrome</li>\n<li>Acute respiratory distress syndrome</li>\n<li>Cerebral hemorrhage</li>\n<li>Preterm labor</li>\n<li>Postpartum hemorrhage</li>\n<li>Shock</li>\n<li>Sepsis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-year-old child presented with edema, oliguria, and frothy urine. He has no history of similar complaints. His urine was positive for 3+ proteinuria, no RBCs/WBCs, and no casts. His serum albumin was 2.4 gm/dL and serum creatinine was 0.5 mg/dL. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "IgA nephropathy"
      },
      {
        "id": 2,
        "text": "Minimal change disease"
      },
      {
        "id": 3,
        "text": "Membranous nephropathy"
      },
      {
        "id": 4,
        "text": "Interstitial nephritis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical vignette is suggestive of <strong>minimal change disease.</strong></p>\n<p>It most frequently manifests between the ages of 2 and 6 years. Edema is typically seen in children and is first noticed in the lower extremities and around the eyes. The <strong>absence of hypertension</strong> and <strong>extensive hematuria</strong> are key indicators of minimal change disease.</p>\n<p>A urinalysis reveals<strong> 3+ or 4+ proteinuria</strong>. A protein: creatinine ratio of &gt; 2.0 is required in spot urine. The level of serum creatinine is typically normal, but it may be unusually elevated if the intravascular volume contracts and reduces renal perfusion. The serum albumin concentration is <strong>less than 2.5</strong> g/dL, and the levels of triglycerides and cholesterol are high. The levels of s<strong>erum complement are normal</strong>. If the patient meets the typical clinical profile of MCNS, a kidney biopsy is not generally carried out.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Proteinuria Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>