<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Medicine St 3 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2017 - 18
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "For which of the following is a vaccine given as a nasal spray?",
    "choices": [
      {
        "id": 1,
        "text": "Japanese encephalitis"
      },
      {
        "id": 2,
        "text": "Human influenza virus"
      },
      {
        "id": 3,
        "text": "Rotavirus"
      },
      {
        "id": 4,
        "text": "Measles"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li><strong>Live attenuated vaccine</strong> for influenza is administered as a single dose intranasal spray.</li>\n<li>It can be given to all between 2 and 49 years.</li>\n<li>It is not given to people with an immuno-compromised state.</li>\n<li><strong>Rotavirus vaccine</strong> is given orally.</li>\n<li>Vaccines for measles and Japanese encephalitis are given subcutaneously.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An interview which is used to note the gradual influence of some social or psychological process is_____",
    "choices": [
      {
        "id": 1,
        "text": "Structured interview"
      },
      {
        "id": 2,
        "text": "Non-directive interview"
      },
      {
        "id": 3,
        "text": "Focused interview"
      },
      {
        "id": 4,
        "text": "Repetitive interview"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A <strong>repetitive interview</strong> is used to note the gradual influence of some social or psychological process. A record is maintained to understand the changes.</p>\n<p>A <strong>direct</strong> or <strong>structured interview</strong> consists of predetermined questions and sequence.</p>\n<p>A <strong>non-directive</strong> or <strong>unstructured interview</strong> doesn&rsquo;t have any sequence of questions set beforehand. The interviewer listens and allows the speaker to narrate his/her own experiences or opinions.</p>\n<p>A <strong>focused interview</strong> is usually used to study effects of mass communications like radio broadcasts or film. In this, the interviewer/researcher focuses on a particular aspect on the problem and draws responses from people.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following can be used for the secondary prevention of mental illness in patients except:",
    "choices": [
      {
        "id": 1,
        "text": "Improving social environment"
      },
      {
        "id": 2,
        "text": "Early diagnosis"
      },
      {
        "id": 3,
        "text": "Family counseling"
      },
      {
        "id": 4,
        "text": "Case work"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Improving</strong> the <strong>social environment</strong> is a method of <strong>primary prevention</strong> of mental illness, not secondary prevention.&nbsp;</p>\n<p>The levels of prevention of mental illness and measures are given below:</p>\n<ul>\n<li>Primary prevention - improving the social environment and the promotion of mental health awareness</li>\n<li><strong>Secondary </strong>prevention - <strong>early diagnosis</strong> and family-based health services like <strong>casework</strong> and <strong>family counseling</strong></li>\n<li><strong>Tertiary </strong>prevention - measures to <strong>reduce</strong> the <strong>duration</strong> of mental illness as well <strong>family</strong> and <strong>community stresses</strong> to prevent further breakdown and disruption</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Most sensitive tool for evaluating iron status of the body:",
    "choices": [
      {
        "id": 1,
        "text": "Hemoglobin level"
      },
      {
        "id": 2,
        "text": "Serum iron"
      },
      {
        "id": 3,
        "text": "Serum transferring saturation"
      },
      {
        "id": 4,
        "text": "Serum ferritin"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li><strong>Serum ferritin</strong> measurement is the most sensitive tool for evaluating iron status especially in areas with low prevalence of anemia.</li>\n<li>Other measures include <strong>hemoglobin concentration, serum iron concentration and serum transferring saturation</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Ujjawala Scheme includes all the following except:",
    "choices": [
      {
        "id": 1,
        "text": "Rescue"
      },
      {
        "id": 2,
        "text": "Remuneration"
      },
      {
        "id": 3,
        "text": "Rehabilitation"
      },
      {
        "id": 4,
        "text": "Reintegration"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>Ujjawala Scheme doesn&rsquo;t include remuneration.</li>\n<li><strong>Ujjawala Scheme</strong> was begun to comprehensively fight<strong> child trafficking</strong>.</li>\n<li>It was launched by the<strong> Ministry of Women and Child Development in 2007</strong>.</li>\n<li>It involves:\n<ul>\n<li>Formation of vigilance groups and awareness groups.</li>\n<li><strong>Rescue</strong> of children being exploited.</li>\n<li><strong>Rehabilitation</strong> of children with provision of shelter, amenities, medical and legal care.</li>\n<li><strong>Re-integration</strong> of these children into the society.</li>\n<li><strong>Repatriation</strong> of the cross-border children to their country of origin.</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The prevalence of the disease 'X' in a population is 30%. The diagnostic test for this disease has a specificity of 0.80 and a sensitivity of 0.90. What is the negative predictive value of the test?",
    "choices": [
      {
        "id": 1,
        "text": "45%"
      },
      {
        "id": 2,
        "text": "62%"
      },
      {
        "id": 3,
        "text": "70%"
      },
      {
        "id": 4,
        "text": "95%"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The negative predictive value of the above test is&nbsp;<strong>95%.</strong></p>\n<p>For convenience, let us assume that the total population in this scenario is <strong>100</strong>.</p>\n<p>The prevalence of the disease is 30%. So the total number of people with the <strong>disease </strong>is <strong>30</strong>(TP+FN) and <strong>disease-free</strong>(FP+TN)&nbsp;is&nbsp;<strong>70.</strong></p>\n<p>Since sensitivity is 0.90, i.e. TP/(TP + FN) = 90%.</p>\n<p>The total <strong>true positives (TP) =</strong>&nbsp;90/100 x (TP+FN) = 90/100 x 30 = <strong>27</strong></p>\n<p>False-negative(FN) = 30-27 =&nbsp;<strong>3</strong></p>\n<p>Since specificity is 0.80, i.e. TN/(FP+TN) = 80%.</p>\n<p>Total <strong>true negatives (TN)</strong>&nbsp;=(FP+TN) x 80/100 = 70 x 80/100 =<strong> 56</strong></p>\n<p>False-positive(FP) = 70-56 = <strong>14</strong></p>\n<p>The given data is represented below:</p>\n<table style=\"width: 300px;\">\n<tbody>\n<tr>\n<td style=\"width: 61px;\">\n<p><strong>&nbsp;</strong></p>\n</td>\n<td style=\"width: 78px;\">\n<p><strong>Disease +</strong></p>\n</td>\n<td style=\"width: 88px;\">\n<p><strong>Disease -</strong></p>\n</td>\n<td style=\"width: 45px;\">\n<p>Total</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 61px;\">\n<p><strong>Test +</strong></p>\n</td>\n<td style=\"width: 78px;\">\n<p>27 (TP)</p>\n</td>\n<td style=\"width: 88px;\">\n<p>14 (FP)</p>\n</td>\n<td style=\"width: 45px;\">\n<p>41</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 61px;\">\n<p><strong>Test -</strong></p>\n</td>\n<td style=\"width: 78px;\">\n<p>3 (FN)</p>\n</td>\n<td style=\"width: 88px;\">\n<p>56 (TN)</p>\n</td>\n<td style=\"width: 45px;\">\n<p>59</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 61px;\">\n<p>Total</p>\n</td>\n<td style=\"width: 78px;\">\n<p>30(TP+FN)</p>\n</td>\n<td style=\"width: 88px;\">\n<p>70(FP+TN)&nbsp;</p>\n</td>\n<td style=\"width: 45px;\">\n<p>100</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Negative predictive value<strong> (NPV) </strong>= TN/(FN + TN) x 100 = 56/59 = 0.949 = <strong>95%</strong>.</p>\n<p>An<strong> alternate formula</strong>(<strong>Bayes</strong> theorem)&nbsp;that can be used is <strong>NP</strong><strong>V</strong> = (1-P) x Sp /[P x (1-Sn)] +[(1-P) x Sp]</p>\n<p>Sn- Sensitivity,&nbsp;P- Prevalence,&nbsp;Sp- Specificity</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following are required during a cholera outbreak except:",
    "choices": [
      {
        "id": 1,
        "text": "Rehydration therapy"
      },
      {
        "id": 2,
        "text": "Mass chemoprophylaxis"
      },
      {
        "id": 3,
        "text": "Supply of safe water"
      },
      {
        "id": 4,
        "text": "Health education"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>Mass chemoprophylaxis is not advised during a cholera outbreak.</li>\n<li>Chemoprophylaxis can be given to <strong>household contacts of a cholera case</strong>.</li>\n<li>Other important measures are supply of safe water, rehydration therapy and health education.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a method to reduce confounding?",
    "choices": [
      {
        "id": 1,
        "text": "Matching"
      },
      {
        "id": 2,
        "text": "Randomization"
      },
      {
        "id": 3,
        "text": "Deletion"
      },
      {
        "id": 4,
        "text": "Regression analysis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Deletion</strong> is<strong> not a method</strong> to reduce confounding.</p>\n<p>Methods to reduce confounding:</p>\n<ul>\n<li>At the time of designing the study:<br />\n<ul>\n<li><strong>Randomization</strong></li>\n<li><strong>Matching</strong></li>\n<li><strong>Restriction</strong></li>\n</ul>\n</li>\n<li>At the time of analysis:<br />\n<ul>\n<li><strong>Stratification</strong></li>\n<li>Statistical modelling like<strong> regression analysis, multivariate analysis and the Cochran-Mantel-Haenszel method</strong>.</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Cereals are pulses are considered as supplementary foods as:",
    "choices": [
      {
        "id": 1,
        "text": "Cereals are deficient in methionine"
      },
      {
        "id": 2,
        "text": "Cereals are deficient in lysine and pulses are deficient in methionine"
      },
      {
        "id": 3,
        "text": "Cereals are deficient in methionine and pulses are deficient in lysine"
      },
      {
        "id": 4,
        "text": "Both cereals and pulses contain threonine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li><strong>Cereal proteins</strong> are deficient in <strong>lysine and threonine</strong>.</li>\n<li><strong>Pulse proteins</strong> are deficient in <strong>methionine</strong>.</li>\n<li>These are known as<strong> limiting amino acids</strong> as they are most deficient in the food items.</li>\n<li>Thus, a combination of two or more food items would form a proper vegetarian diet in absence of meat proteins.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The STEPS by WHO is aimed at:",
    "choices": [
      {
        "id": 1,
        "text": "Surveillance of risk factors for non-communicable diseases"
      },
      {
        "id": 2,
        "text": "Surveillance of risk factors for communicable diseases"
      },
      {
        "id": 3,
        "text": "Surveillance of mortality due to nosocomial infections"
      },
      {
        "id": 4,
        "text": "Surveillance of morbidity in the visually impaired"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>WHO STEPwise approach to Surveillance (STEPS)</strong> is used for surveillance of adult risk factors for non-communicable diseases and for stroke surveillance.</p>\n<p>WHO STEPS approach is a survey methodology developed to assess risk factors of non-communicable diseases (NCD). It helps the countries to establish an <strong>NCD&nbsp;surveillance system.&nbsp;</strong>The steps include the following:</p>\n<ul>\n<li>Questionnaires contain questions about <strong>behavioral</strong> risk factors like tobacco use, alcohol use, diet, and physical activity.&nbsp;</li>\n<li><strong>Physical measurements</strong>&nbsp;contain blood pressure, height, weight, and waist size</li>\n<li>Biochemical measurements contain blood glucose, blood lipids, urinary sodium, and creatinine.&nbsp;&nbsp;</li>\n</ul>\n<p><strong>Surveillance</strong> is defined as systematic and continuous data analysis and taking appropriate preventive actions according to the results obtained. Identification of cases that are missed and not notified is known as&nbsp;<strong>sentinel surveillance</strong>. It is used in communicable diseases such as HIV, malaria, etc. The<strong> study population</strong>&nbsp;for <strong>HIV sentinel surveillance</strong> are sex workers, IV drug abusers, transgender people, migrant workers, truck drivers, etc.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following are true regarding a Category A bioterrorism agents except:",
    "choices": [
      {
        "id": 1,
        "text": "Capacity to cause panic and chaos"
      },
      {
        "id": 2,
        "text": "High mortality rates"
      },
      {
        "id": 3,
        "text": "Moderately difficult to disseminate"
      },
      {
        "id": 4,
        "text": "Requires specialized public health responses"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li>Category A bioterrorism agents are easy to disseminate.</li>\n<li>Anthrax comes under Category A.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Blood pressure is measured in an individual 5 times a day under the same conditions by a new screening test. All 5 readings obtained are the almost same. What is the attribute of a new screening test being described?",
    "choices": [
      {
        "id": 1,
        "text": "Validity"
      },
      {
        "id": 2,
        "text": "Reliability"
      },
      {
        "id": 3,
        "text": "Sensitivity"
      },
      {
        "id": 4,
        "text": "Predictive accuracy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The attribute of a new screening test to yield the <strong>same reading</strong> when <strong>repeated</strong> under the same conditions is called <strong>reliability</strong>.</p>\n<div class=\"page\" title=\"Page 159\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Reliability is also called precision or reproducibility.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Following table lists the number of deaths due to a variety of reasons in a city during a particular year.  Which of the following statistical representation is appropriate for this data?",
    "choices": [
      {
        "id": 1,
        "text": "Bar chart"
      },
      {
        "id": 2,
        "text": "Pie chart"
      },
      {
        "id": 3,
        "text": "Histogram"
      },
      {
        "id": 4,
        "text": "Line diagram"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In <strong>pie charts</strong>, segmented areas of a circle are used to represent statistical data.</p>\n<p>Choosing the right graphic form:</p>\n<table style=\"height: 171px; width: 301px;\">\n<tbody>\n<tr>\n<td style=\"width: 80px;\">Variable</td>\n<td style=\"width: 86px;\">Summary</td>\n<td style=\"width: 121px;\">Appropraite graphical display</td>\n</tr>\n<tr>\n<td style=\"width: 80px;\">Nominal</td>\n<td style=\"width: 86px;\">Propotions</td>\n<td style=\"width: 121px;\">\n<p>Bar chart</p>\n<p>Pie chart&nbsp;</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 80px;\">Ordinal</td>\n<td style=\"width: 86px;\">Propotions</td>\n<td style=\"width: 121px;\">\n<p>Bar chart</p>\n<p>Line chart</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 80px;\">Numerical</td>\n<td style=\"width: 86px;\">Mean standard deviations</td>\n<td style=\"width: 121px;\">\n<p>Histogram</p>\n<p>Frequency</p>\n<p>polygon</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 80px;\">&nbsp;</td>\n<td style=\"width: 86px;\">Medians and Quartiles</td>\n<td style=\"width: 121px;\">\n<p>Steam and leaves dsplay</p>\n<p>Box plot&nbsp;</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 80px;\">&nbsp;</td>\n<td style=\"width: 86px;\">Mode and range</td>\n<td style=\"width: 121px;\">\n<p>Histogram</p>\n<p>Line chart</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/35c2f02bef4f4d8fa19fca85eaf52112.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Maximum recommended number of students in a school class room is:",
    "choices": [
      {
        "id": 1,
        "text": "30"
      },
      {
        "id": 2,
        "text": "35"
      },
      {
        "id": 3,
        "text": "40"
      },
      {
        "id": 4,
        "text": "45"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li><strong>Location</strong>: Away from noisy surroundings; kept fenced.</li>\n<li><strong>Site</strong>: 5 acres for primary schools; 10 acres for higher elementary schools.</li>\n<li><strong>Structure</strong>: Exterior walls 10 inch thick and heat resistant.</li>\n<li><strong>Class room</strong>: 1 class room per <strong>40 students maximum</strong> and per capita space must be &gt;10 sq. feet.</li>\n<li><strong>Furniture</strong>: Single desks of &lsquo;minus&rsquo; type.</li>\n<li><strong>Doors and window</strong>s area must be &gt; 25% of floor area.</li>\n<li><strong>Color of walls</strong> inside should be white.</li>\n<li><strong>Lighting</strong>: Natural light from left side.</li>\n<li><strong>Water supply</strong>: Safe and potable and continuous supply through taps.</li>\n<li><strong>Lavatory</strong>: 1 urinal per 60 students and 1 latrine per 100 students.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Under the National Urban Health Mission (NUHM), in metropolitan cities, an Urban Community Health Centre (U-CHC) would have how many beds?",
    "choices": [
      {
        "id": 1,
        "text": "75"
      },
      {
        "id": 2,
        "text": "100"
      },
      {
        "id": 3,
        "text": "150"
      },
      {
        "id": 4,
        "text": "200"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>In metropolitan cities, a U-CHC would have <strong>100 beds</strong> and cater to a population of <strong>5 lakhs</strong>.</li>\n<li>In other places, a U-CHC would cater to a population of<strong> 2.5 lakhs</strong> with <strong>30 to 50 beds</strong>.</li>\n</ul>\n<p>Each U-CHC would act as a referral unit for<strong> 4-5</strong> Urban Primary Health Centres (U-PHC).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "International Committee of the Red Cross is based in:",
    "choices": [
      {
        "id": 1,
        "text": "New York"
      },
      {
        "id": 2,
        "text": "Prague"
      },
      {
        "id": 3,
        "text": "Budapest"
      },
      {
        "id": 4,
        "text": "Geneva"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>The International Committee of the Red Cross is based out of <strong>Geneva, Switzerland</strong>.</li>\n<li>The Red Cross is devoted to the service of mankind in peace and war.</li>\n<li>It was founded by <strong>Henry Dunant</strong> from Switzerland.</li>\n<li>It first started with humanitarian service to victims of war and then it branched out to natural disasters. Now it works with a variety of health related issues.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7fbec45fbefb428d893451bf128f03f7x900x600.PNG"
    ]
  },
  {
    "text": "Which is not an advantage of mass media communication?",
    "choices": [
      {
        "id": 1,
        "text": "Increased influence only in below average educated population"
      },
      {
        "id": 2,
        "text": "Gives greater support for concentrated programmes"
      },
      {
        "id": 3,
        "text": "Gets public attention"
      },
      {
        "id": 4,
        "text": "Reaches the widest population"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Mass media includes <strong>TV, newspaper, radio, etc</strong>.</p>\n<p>Advantages:</p>\n<ul>\n<li>It reaches people even in the most <strong>remote areas</strong>.</li>\n<li>It gets the <strong>public&rsquo;s attention</strong>.</li>\n<li>It has increased influence across all educational levels, especially in <strong>above average educational level</strong>.</li>\n<li>It gives greater support for <strong>concentrated programmes</strong>.</li>\n</ul>\n<p>Disadvantages:</p>\n<ul>\n<li>One way communication</li>\n<li>Impersonal method and no face to face contact</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Intention-to-treat analysis is done in Randomized Control Trials when there is:",
    "choices": [
      {
        "id": 1,
        "text": "Drop-out of participants"
      },
      {
        "id": 2,
        "text": "Large sample size population"
      },
      {
        "id": 3,
        "text": "New drugs"
      },
      {
        "id": 4,
        "text": "Unknown aetiology"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Intention-to-treat (ITT) analysis includes the <strong>dropouts</strong> of the trial.</li>\n<li>It <strong>ignores</strong> non-compliance, protocol change, withdrawal, cross-over and anything that happens <strong>after randomization</strong> during analysis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A village has a total population of 100,000 with an under-16 population at 3%. The prevalence of goitre in the under-16 population is (0.3/100). What is the total number of under-16 population affected by goitre?",
    "choices": [
      {
        "id": 1,
        "text": "90"
      },
      {
        "id": 2,
        "text": "9"
      },
      {
        "id": 3,
        "text": "10"
      },
      {
        "id": 4,
        "text": "100"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The total number of persons in the under-16 with goitre is 9.</p>\n<p>Number of total under-16 population = 3% of 100,000 = 3000.</p>\n<p>Thus, total number of goitre patients who are under-16 with the prevalence at the given value = 3000*0.3/100= 9</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Sand fly doesn\u2019t transmit:",
    "choices": [
      {
        "id": 1,
        "text": "Oroya fever"
      },
      {
        "id": 2,
        "text": "Oriental sore"
      },
      {
        "id": 3,
        "text": "Trench fever"
      },
      {
        "id": 4,
        "text": "Kala azar"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Sandflies</strong> transmit kala azar, Oroya fever, sandfly fever and oriental sores.</p>\n<p><strong>Trench fever</strong> is transmitted by <strong>lice</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not true about screw-feed technology in biomedical waste management?",
    "choices": [
      {
        "id": 1,
        "text": "80% volume reduction in waste"
      },
      {
        "id": 2,
        "text": "Pathological waste is processed"
      },
      {
        "id": 3,
        "text": "Sharps wastes are processed"
      },
      {
        "id": 4,
        "text": "20-30% reduction in weight of waste"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Pathological wastes, cytotoxic wastes, and radioactive wastes are not processed using screw-feed technology.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Who makes the final selection of the village health guides?",
    "choices": [
      {
        "id": 1,
        "text": "ASHA"
      },
      {
        "id": 2,
        "text": "Medical officer-in-charge"
      },
      {
        "id": 3,
        "text": "Female health assistant"
      },
      {
        "id": 4,
        "text": "Election by people in community"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>2 to 3 candidates, based on the guidelines, would be suggested by the community.</li>\n<li>The<strong> medical officer in charge</strong> would then choose one of them to be the VHG in consultation with the block development officer and field staff.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All are functions of a primary health care centre in India except:",
    "choices": [
      {
        "id": 1,
        "text": "Medical care"
      },
      {
        "id": 2,
        "text": "Safe water supply"
      },
      {
        "id": 3,
        "text": "Formal education of under-6 children"
      },
      {
        "id": 4,
        "text": "Collection and record of vital events"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>&nbsp;A primary health centre acts as a<strong> referral unit for 6 sub-centres</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which would be the best method to teach a slum population about ORS and its usage?",
    "choices": [
      {
        "id": 1,
        "text": "Lecture"
      },
      {
        "id": 2,
        "text": "Role play"
      },
      {
        "id": 3,
        "text": "Flash cards"
      },
      {
        "id": 4,
        "text": "Demonstration"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>Demonstration is a carefully prepared presentation on how to perform a certain task or skill or procedure.</li>\n<li>It shows the step by step process of a task.</li>\n<li>Demonstration <strong>arouses interest</strong>, incites <strong>&lsquo;learning by doing&rsquo;</strong> and <strong>&lsquo;seeing is believing&rsquo;</strong> philosophies.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Soil is a reservoir for all the following except:",
    "choices": [
      {
        "id": 1,
        "text": "Coccidiomycosis"
      },
      {
        "id": 2,
        "text": "Anthrax"
      },
      {
        "id": 3,
        "text": "Tetanus"
      },
      {
        "id": 4,
        "text": "Brucellosis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>Main reservoir of the coccobacilli of the genus Brucella that cause<strong> brucellosis</strong> are animals like sheep, cattle, horses, goats, whales and dogs.</li>\n<li>The natural reservoir for tetanus causing <strong><em>Clostridium tetani</em></strong> is s<strong>oil and dust</strong>. They also are present in intestines of many herbivorous animals.</li>\n<li>Bacillus anthracis is a <strong>soil</strong> commensal and is also found on the hides and dried skins of infected aminals.</li>\n<li>Coccidiomycosis is also called <strong>Valley fever</strong> and the causative fungi belong to the<strong> Coccidiodes</strong> species. The main reservoir of this organism is soil.</li>\n<li>A <strong>reservoir</strong> is the environment (eg. Soil, humans, animals, water) where the infectious agent lives and multiples and from where it can be transmitted to a susceptible host.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Identify the type of epidemic from the following epidemic curve:",
    "choices": [
      {
        "id": 1,
        "text": "Point source epidemic"
      },
      {
        "id": 2,
        "text": "Continuous epidemic"
      },
      {
        "id": 3,
        "text": "Slow epidemic"
      },
      {
        "id": 4,
        "text": "Propagated epidemic"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>In the epidemic curve for a point source epidemic, there is a<strong> sharp rise and fall of the curve</strong> with no <strong>secondary waves</strong>.</li>\n<li>It tends to be<strong> explosive</strong> as all the cases are <strong>clustered</strong> in a narrow period of time and they occur within one <strong>incubation period</strong> of the disease.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5dfca368fdc844c6ac1ce65e98e1294b.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "To calculate the positive predictive value of a new screening test for breast carcinoma, what will you use for the denominator?",
    "choices": [
      {
        "id": 1,
        "text": "True positives + false negatives"
      },
      {
        "id": 2,
        "text": "True positives + true negatives"
      },
      {
        "id": 3,
        "text": "True positives + false positives"
      },
      {
        "id": 4,
        "text": "True negatives + false positives"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>denominator</strong> for the calculation of the <strong>positive predictive value</strong> of a screening test is&nbsp;<strong>true positives + false positives.</strong></p>\n<p>Positive predictive value <strong>(PPV)</strong> of a test is <strong>TP/(TP + FP) x 100.</strong></p>\n<p>It indicates the probability that a person with a positive test actually has the disease. It is <strong>directly proportional</strong> to the <strong>prevalence </strong>of a disease.</p>\n<p>Predictive value is affected by sensitivity, specificity, and prevalence. However, it is affected the most by prevalence.<strong><br /></strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Pearl Index is defined as:",
    "choices": [
      {
        "id": 1,
        "text": "Accidental pregnancies per 1000 women-years of exposure"
      },
      {
        "id": 2,
        "text": "Accidental pregnancies per 100 women-years of exposure"
      },
      {
        "id": 3,
        "text": "Accidental pregnancies per 10 women-years of exposure"
      },
      {
        "id": 4,
        "text": "Total accidental pregnancies caused in one year by number of contraceptives used"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>Pearl Index is <strong>accidental pregnancies per 100 women-years of exposure (HWY).</strong></li>\n<li>It is a measure of contraceptive failure.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "How would you define socialized medicine?",
    "choices": [
      {
        "id": 1,
        "text": "Subsidized medical care at government's expense"
      },
      {
        "id": 2,
        "text": "Free medical care provided and regulated by government alone"
      },
      {
        "id": 3,
        "text": "Free medical care at government expense, regulated by professional groups"
      },
      {
        "id": 4,
        "text": "Integration of social medicine with health care"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Socialized medicine</strong>&nbsp;is the provision of medical service at the <strong>government's expense</strong> but is operated and <strong>regulated</strong> by <strong>professional groups</strong>, and not the government.&nbsp;Russia was the first country to completely socialize medicine.</p>\n<p><strong>Free medical care</strong> by a government alone is called <strong>state medicine</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the risk ratio when the incidence of the disease in exposed is 30 and that in non-exposed is 5?",
    "choices": [
      {
        "id": 1,
        "text": "6"
      },
      {
        "id": 2,
        "text": "5"
      },
      {
        "id": 3,
        "text": "0.6"
      },
      {
        "id": 4,
        "text": "0.5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The risk ratio or relative risk here is 6 per 1000.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which is not an element of evaluation?",
    "choices": [
      {
        "id": 1,
        "text": "Accessibility"
      },
      {
        "id": 2,
        "text": "Repeatability"
      },
      {
        "id": 3,
        "text": "Efficiency"
      },
      {
        "id": 4,
        "text": "Relevance"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Components of evaluation are: </p>\n<p><strong>Relevance, adequacy, accessibility, acceptability, effectiveness, efficiency</strong> and effect or impact.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The Rashtriya Bal Swasthya Karyakram (RBSK) is related to:",
    "choices": [
      {
        "id": 1,
        "text": "Child health screening"
      },
      {
        "id": 2,
        "text": "Adolescent health"
      },
      {
        "id": 3,
        "text": "Menstrual hygiene"
      },
      {
        "id": 4,
        "text": "Sanitation and safe drinking water supply"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>The <strong>Rashtriya Bal Swasthya Karyakram</strong> (RSBK) has provisions for <strong>Child Health Screening and Early Intervention Services</strong>.</li>\n<li>It is done through early detection and management in terms of <strong>defects</strong> at birth, <strong>diseases</strong> in children, <strong>deficiency conditions</strong> and <strong>developmental delays</strong> including disabilities &ndash; called the 4 Ds.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Who was the architect of the Public Health Act of 1848?",
    "choices": [
      {
        "id": 1,
        "text": "Joseph Lister"
      },
      {
        "id": 2,
        "text": "James Lind"
      },
      {
        "id": 3,
        "text": "William Farr"
      },
      {
        "id": 4,
        "text": "Edwin Chadwick"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Edwin</strong> <strong>Chadwick</strong> was the architect of the <strong>Public Health Act of 1848</strong>.</p>\n<p>He was an <strong>English</strong> <strong>lawyer</strong> during the 1832 cholera epidemic. He compiled a report on the Sanitary Condition of the Labouring Population in Great Britain that eventually led to the passing of this act.<strong>&nbsp;</strong>It&nbsp;is considered a <strong>landmark act</strong> in the history of public health.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the maximum timeline of maternal death that is included in the calculation of maternal mortality ratio?",
    "choices": [
      {
        "id": 1,
        "text": "2 months"
      },
      {
        "id": 2,
        "text": "42 days"
      },
      {
        "id": 3,
        "text": "32 days"
      },
      {
        "id": 4,
        "text": "50 days"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Maternal mortality ratio (MMR)</strong> is the death of a woman while pregnant within or within 42 days of termination of pregnancy, from any cause related to the pregnancy or its management but not by accidental causes.</p>\n<p><strong>MMR</strong> is given by (Total deaths during pregnancy or 42 days after termination due to pregnancy related causes, in an area in a year x 100,000)/ (Total live births in that area in that year).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an indicator for operational efficiency for National Vector-Borne Diseases Control Programme?",
    "choices": [
      {
        "id": 1,
        "text": "Annual parasite incidence"
      },
      {
        "id": 2,
        "text": "Annual falciparum incidence"
      },
      {
        "id": 3,
        "text": "Annual blood examination rate"
      },
      {
        "id": 4,
        "text": "Slide positivity rate"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li><strong>Annual blood examination rate (ABER)</strong> is an index of operational efficiency. It is given by (Number of slides examined x 100)/Total population.</li>\n<li><strong>Annual parasite incidence (API)</strong> is used to classify areas as high risk or low risk. It is given by (Confirmed cases during one year x 100)/ Population under surveillance. If API is greater than or equal to 2 per 1000 population, then that area is high risk.</li>\n<li>Other indicators used are slide positivity rate and annual falciparum rate.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The first bacterium discovered as a cause of the disease was:",
    "choices": [
      {
        "id": 1,
        "text": "TB bacillus"
      },
      {
        "id": 2,
        "text": "Anthrax bacillus"
      },
      {
        "id": 3,
        "text": "Leprosy bacillus"
      },
      {
        "id": 4,
        "text": "Plague bacillus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The first bacterium discovered as a cause of the disease is <strong>leprosy bacillus.</strong></p>\n<p>In<strong> 1873</strong>, Armauer <strong>Hansen</strong> demonstrated Mycobacterium <strong>leprae</strong> (rod-like bodies) from a leprosy nodule. This is the first time that chronic infectious disease in humans was shown&nbsp;to be related to a bacillus.</p>\n<p>In<strong> 1876</strong>, <strong>Robert Koch&nbsp;</strong>validated the germ theory of disease after discovering the&nbsp;<strong>anthrax bacillus</strong> as the cause of anthrax.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is an example of multiphasic screening?",
    "choices": [
      {
        "id": 1,
        "text": "Chest X-ray for TB in large populations"
      },
      {
        "id": 2,
        "text": "Annual health checkups"
      },
      {
        "id": 3,
        "text": "Pap smear in women above 40 years"
      },
      {
        "id": 4,
        "text": "Random blood sugar during antenatal visits"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Annual health checkups</strong> are an example of multiphasic screening.</p>\n<p>Types of screening:</p>\n<ol>\n<li><strong>Multiphasic screening</strong> is the application of <strong>two or more screening tests</strong> in combination with a large number of people <strong>at one time.</strong> Example- Annual health checkups.</li>\n<li><strong>High-risk</strong> or <strong>selective</strong> screening is done on high-risk groups. Example-<strong>&nbsp;</strong>MRI screening of breast done annually in 25-year old women with BRCA 1, BRCA 2 mutations in a first-degree relative.</li>\n<li><strong>Mass screening</strong> is a screening of a whole or <strong>large population</strong> like using a chest X-ray for TB screening in large populations. It is done for diseases with <strong>high prevalence.</strong></li>\n</ol>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which country was the last case of naturally occurring smallpox in the world recorded?",
    "choices": [
      {
        "id": 1,
        "text": "India"
      },
      {
        "id": 2,
        "text": "Chile"
      },
      {
        "id": 3,
        "text": "Somalia"
      },
      {
        "id": 4,
        "text": "New Zealand"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>last</strong> case of <strong>naturally occurring</strong> smallpox was in <strong>Somalia</strong> in<strong> 1977</strong>.</p>\n<p>The last case of smallpox occurred in 1978 when a medical photographer was&nbsp;accidentally exposed to the smallpox virus in a research laboratory in Birmingham.</p>\n<p><strong>India </strong>was&nbsp;declared smallpox-free on <strong>24th May 1975</strong>.&nbsp;WHO declared smallpox as eradicated <strong>globally</strong> on <strong>8<sup>th</sup> May 1980</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Chadah committee did not recommend which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "PHC at block level"
      },
      {
        "id": 2,
        "text": "Concept of multipurpose workers"
      },
      {
        "id": 3,
        "text": "One basic health worker per 10,000 population"
      },
      {
        "id": 4,
        "text": "Responsibility of PHCs in malaria eradication"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>Key person in Chadah committee was<strong> Dr. M. S. Chadah</strong>.</li>\n<li>Concept of multipurpose health worker was given by <strong>Kartar Singh Committee.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The Harpenden calipers are used in public health to_____",
    "choices": [
      {
        "id": 1,
        "text": "Measure mid-arm circumference"
      },
      {
        "id": 2,
        "text": "Measure head circumference"
      },
      {
        "id": 3,
        "text": "Measure skin fold thickness"
      },
      {
        "id": 4,
        "text": "Measure turgidity of skin in dehydration"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Harpenden calipers are used to measure <strong>skin fold thickness</strong>.</p>\n<p>Skin fold thickness is a measure used in estimating body fat percentage for anthropometry in understanding nutritional status.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following are true about Q fever except:",
    "choices": [
      {
        "id": 1,
        "text": "Causative agent is Coxiella burnetti and ticks are reservoirs"
      },
      {
        "id": 2,
        "text": "Ticks are the main vector in transmission to man"
      },
      {
        "id": 3,
        "text": "No skin lesion is seen"
      },
      {
        "id": 4,
        "text": "Doxycycline is a drug that is used for treatment"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>There is <strong>no vector</strong> involved in the transmission of the disease Q fever to man.</li>\n<li>Ticks are <strong>reservoirs</strong> for the causative bacteria, <strong>Coxiella burnetti</strong>.</li>\n<li>It is a zoonotic disease that is transmitted to man by inhalation of contaminated dust by infected animals.</li>\n<li>Incubation period usually lasts for 2 to 3 weeks.</li>\n<li>Clinical manifestations can range from fever and chills to pneumonia and hepatitis.</li>\n<li>There is <strong>no skin lesion</strong>.</li>\n<li>Doxycycline is a commonly used antibiotic for this disease.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is incorrect about the National Health Policy of 2017?",
    "choices": [
      {
        "id": 1,
        "text": "Increase public health expenditure to 5% of GDP by 2025"
      },
      {
        "id": 2,
        "text": "Reduce infant mortality to 28 by 2019"
      },
      {
        "id": 3,
        "text": "Access to safe water and sanitation to all by 2020"
      },
      {
        "id": 4,
        "text": "Achieve elimination of lymphatic filariasis by 2017"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The public health expenditure is to be increased to<strong> 2.5% of the GDP</strong> by 2025.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Recommended Dietary Allowance (RDA) for calcium for non-pregnant women per day is:",
    "choices": [
      {
        "id": 1,
        "text": "500 mg"
      },
      {
        "id": 2,
        "text": "1200 mg"
      },
      {
        "id": 3,
        "text": "800 mg"
      },
      {
        "id": 4,
        "text": "600 mg"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>RDA for calcium for non-pregnant women is 600 mg/day.</p>\n<p><strong>Recommended intake of calcium (mg/d)</strong>:</p>\n<table style=\"height: 217px;\" width=\"223\">\n<tbody>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Group</td>\n<td style=\"width: 104px; height: 13px;\">Calcium</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Adult men</td>\n<td style=\"width: 104px; height: 13px;\">600</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Adult women</td>\n<td style=\"width: 104px; height: 13px;\">600</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Pregnancy</td>\n<td style=\"width: 104px; height: 13px;\">1200</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Lactation</td>\n<td style=\"width: 104px; height: 13px;\">1200</td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 103px; height: 26px;\">Post menopausal women</td>\n<td style=\"width: 104px; height: 26px;\">800</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Infants</td>\n<td style=\"width: 104px; height: 13px;\">500</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Children 1-3 years</td>\n<td style=\"width: 104px; height: 13px;\">600</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Children 4-6 years</td>\n<td style=\"width: 104px; height: 13px;\">600</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Children 7-9 years</td>\n<td style=\"width: 104px; height: 13px;\">600</td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 103px; height: 26px;\">Children 10-12 year</td>\n<td style=\"width: 104px; height: 26px;\">800 (Both boys and girls)</td>\n</tr>\n<tr style=\"height: 26px;\">\n<td style=\"width: 103px; height: 26px;\">Children 13-15 years</td>\n<td style=\"width: 104px; height: 26px;\">800 (Both boys and girls)</td>\n</tr>\n<tr style=\"height: 13px;\">\n<td style=\"width: 103px; height: 13px;\">Children 16-18 years</td>\n<td style=\"width: 104px; height: 13px;\">800 (Both boys and girls)</td>\n</tr>\n</tbody>\n</table>\n<p>To achieve thi level of intake, a minimum of 200 ml of milk/d would be essential on cereale- legume diet</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "If the systolic BP in a population has a mean of 130 mmHg and a median of 140 mmHg, the distribution is said to be:",
    "choices": [
      {
        "id": 1,
        "text": "Negatively skewed"
      },
      {
        "id": 2,
        "text": "Positively skewed"
      },
      {
        "id": 3,
        "text": "Symmetrical"
      },
      {
        "id": 4,
        "text": "Either negatively or positively skewed depending upon the standard deviation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This is a negatively skewed distribution.</p>\n<p>In any skewed distribution (i.e., positive or negative), the median will always fall in between the mean and the mode.</p>\n<p>For a<strong> positively skewed distribution</strong>, the <strong>mean</strong> will always be the <strong>highest</strong> estimate of central tendency, and the <strong>mode</strong> will always be the<strong> lowest</strong> estimate of central tendency (assuming that the distribution has only one mode).</p>\n<p>For <strong>negatively skewed distributions</strong>, the <strong>mean</strong> will always be the <strong>lowest</strong> estimate of central tendency, and the<strong> mode</strong> will be the <strong>highest</strong> estimate of central tendency.</p>\n<p>In this scenario, the median is greater than the mean. As the median lies at a point in between the mean and the mode, this indicates a negatively skewed distribution.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Ingestion of which of the following can lead to ergotism?",
    "choices": [
      {
        "id": 1,
        "text": "Bajra"
      },
      {
        "id": 2,
        "text": "Maize"
      },
      {
        "id": 3,
        "text": "Mustard oil"
      },
      {
        "id": 4,
        "text": "Groundnut"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Food items like <strong>bajra, rye, sorghum and wheat</strong> have a tendency to house the ergot fungus called <strong><em>Claviceps purpurea</em></strong>.</li>\n<li>They can be removed from grains by floating them in 20% salt water.</li>\n<li>They can be also removed by <strong>hand-picking</strong> and <strong>air floatation</strong>.</li>\n<li>Safe limit for ergot alkaloids in grains is <strong>0.05 mg per 100 grams</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not true about the Rashtriya Swasthya Bima Yojana?",
    "choices": [
      {
        "id": 1,
        "text": "It is a wide-reaching employment scheme"
      },
      {
        "id": 2,
        "text": "Entitlement of 30,000 rupees"
      },
      {
        "id": 3,
        "text": "Initially aimed at the population below poverty line"
      },
      {
        "id": 4,
        "text": "Information technology is used on a large scale"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Rashtriya Swasthya Bima Yojana (<strong>RSBY)</strong> is a <strong>health insurance scheme</strong> aimed at the population <strong>below poverty line</strong>, initially but now it now covers other unrecognized working sectors.</p>\n<p>Some salient features of the RSBY are:</p>\n<ul>\n<li>Beneficiaries are entitled to hospitalization worth 30,000 rupees with other costs like transportation also covered to a maximum of 1000 rupees per year.</li>\n<li>This scheme is information technology intensive.</li>\n<li>Cashless transactions at hospitals through a smart card.</li>\n<li>Enrollment with RSBY to be linked with opening of bank account and issuance of Aadhaar card.</li>\n<li>Scheme currently covers 3 crore workers. It will be expanded to include construction sector also.</li>\n<li>Single central smart card to be issued to include other welfare schemes like Aam Aadmi Bima Yojana and National Old Age Pension Scheme.</li>\n<li></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An endemic disease in which the children in an area show high level of pathogenic responses while the majority of the adults remain to be asymptomatic carriers is referred to as_______",
    "choices": [
      {
        "id": 1,
        "text": "Hyperendemic"
      },
      {
        "id": 2,
        "text": "Synendemic"
      },
      {
        "id": 3,
        "text": "Quasi-endemic"
      },
      {
        "id": 4,
        "text": "Holoendemic"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>A <strong>holoendemic</strong> disease is a disease in which the children in an area show higher prevalence and pathogenic responses to the disease compared to the adults, who tend to either be asymptomatic carriers or show reduced damage by the disease, eg. Malaria.</p>\n<p>A <strong>hyperendemic</strong> disease is one which is constantly present at high incidence and prevalence among all groups in a population.</p>\n<p>An <strong>endemic</strong> disease refers to a disease that is present constantly in a population or in a given area without importation from outside.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Cooling power of air is measured by_______",
    "choices": [
      {
        "id": 1,
        "text": "Kata thermometer"
      },
      {
        "id": 2,
        "text": "Hygrometer"
      },
      {
        "id": 3,
        "text": "Anemometer"
      },
      {
        "id": 4,
        "text": "Sling\u2019s psychrometer"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Kata thermometer</strong> is an alcohol thermometer that measures the cooling power of air.</p>\n<p><strong>Hygrometer and psychrometers</strong> are useful in measurement of<strong> humidity</strong>.</p>\n<p><strong>Anemometers</strong> are used for measuring <strong>air speed</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Hidden hunger refers to:",
    "choices": [
      {
        "id": 1,
        "text": "Food shortage cause of by famines"
      },
      {
        "id": 2,
        "text": "Micronutrient deficiencies"
      },
      {
        "id": 3,
        "text": "Undernourishment of pregnant mother"
      },
      {
        "id": 4,
        "text": "Anorexia nervosa"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li><strong>Hidden hunger</strong> refers to <strong>micronutrient deficiency</strong> and it occurs when there is deficiency in intake or absorption of micronutrients like vitamins, iron, zinc, etc.</li>\n<li>The health and development of a community are affected by less obvious or invisible effects of these deficiencies. Thus they are referred to as hidden hunger.</li>\n<li>Consequences of hidden hunger are seen in all ages.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Income generated only within the country is represented by:",
    "choices": [
      {
        "id": 1,
        "text": "Gross Domestic Product"
      },
      {
        "id": 2,
        "text": "Net National Product"
      },
      {
        "id": 3,
        "text": "Gross National Income"
      },
      {
        "id": 4,
        "text": "Net Domestic Product"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Gross Domestic Product (GDP)</strong> is the gross income generated in the country and doesn&rsquo;t include the income received from abroad.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Community Medicine St 3';
        const quizFilename = 'community-medicine-st-3-2be8692e.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2017 - 18"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>