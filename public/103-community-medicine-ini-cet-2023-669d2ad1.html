<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>103 Community Medicine Ini-Cet 2023 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / PYQs / Community Medicine
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">22</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "All of the following statements are true for descriptors of central tendency except:",
    "choices": [
      {
        "id": 1,
        "text": "Mode is affected by extreme values"
      },
      {
        "id": 2,
        "text": "Mean is affected by extreme values"
      },
      {
        "id": 3,
        "text": "Median is calculated by overall observation"
      },
      {
        "id": 4,
        "text": "Mode can be used as a qualitative data descriptor"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Mode</strong> is <strong>not affected</strong> <strong>by</strong> <strong>extreme values</strong> in a given set of data.</p>\n<p>The mean of a given set of data is responsive to each and every value in the distribution. Thus, the <strong>mean</strong> is the measure of central tendency which is <strong>maximally affected by extreme values</strong> (option B). It is usually an <strong>inappropriate</strong> measure <strong>for describing skewed distributions</strong>. However, <strong>repeated</strong> <strong>samples</strong> from the <strong>same population</strong> will always tend to have <strong>similar</strong> <strong>means</strong>. Mean is able to <strong>resist fluctuations</strong> between different samples drawn from the same population better than mode or median.</p>\n<p>To obtain the median of a given set of data, the<strong> values are first arranged in ascending or descending order</strong> of magnitude, and then the value of the <strong>middle observation</strong> is noted. Since the data has to be first arranged in order before the median can be determined, an <strong>overall observation</strong> is necessary for its calculation (option C).</p>\n<p><strong>Mode</strong> is the <strong>observed value</strong> in the frequency distribution that occurs with the<strong> greatest frequency</strong>. It is completely <strong>uninfluenced by extreme values</strong> in the distribution. The mode can be used to describe <strong>qualitative data</strong> (option D).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The formula given below corresponds to:",
    "choices": [
      {
        "id": 1,
        "text": "Standard deviation"
      },
      {
        "id": 2,
        "text": "Variance"
      },
      {
        "id": 3,
        "text": "Mean"
      },
      {
        "id": 4,
        "text": "Median"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The formula given above is used to calculate the <strong>standard deviation</strong>.</p>\n<p><strong>Standard deviation</strong>&nbsp;(or &sigma;) is a measure of <strong>how dispersed the data is</strong> in relation to the mean. Data clustered around the mean have a low standard deviation, while data that are more spread out have a high standard deviation. A standard deviation close to zero indicates that data points are close to the mean, whereas a high or low standard deviation indicates data points are respectively above or below the mean.</p>\n<p><strong>Variance</strong>&nbsp;(option B) is the&nbsp;<strong>mean&nbsp;</strong>of the<strong>&nbsp;squares&nbsp;</strong>of all the<strong>&nbsp;deviation scores</strong>&nbsp;of the distribution. It is numerically equal to the<strong> square of the standard deviation</strong>.</p>\n<p><strong>Mean</strong> (option C) is obtained by <strong>adding</strong> together the individual observations and then <strong>dividing</strong> by the total number of observations.&nbsp;</p>\n<p><strong>Median</strong>&nbsp;(option D) divides the<strong>&nbsp;frequency distribution</strong>&nbsp;in<strong>&nbsp;half</strong>&nbsp;when all the scores are&nbsp;<strong>listed</strong>&nbsp;in&nbsp;<strong>order</strong>. When a distribution has an odd number of elements, the median is the middle value. When the distribution has an even number of elements, the median is&nbsp;the average of the two middle scores.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5dba7a68e1d84b68bdb0cd6ee3f7a3f5.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "All of the following may be used to find the normalcy of data except:",
    "choices": [
      {
        "id": 1,
        "text": "Plot histogram"
      },
      {
        "id": 2,
        "text": "Mantel-Haenszel test"
      },
      {
        "id": 3,
        "text": "Box whisker"
      },
      {
        "id": 4,
        "text": "Shapiro Wilk test"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Mantel-Haenszel method</strong> is used to calculate <strong>adjusted odds ratio</strong> during <strong>stratified analysis</strong>. It is <strong>not</strong> a test <strong>to detect normalcy of data</strong>.</p>\n<p>A <strong>plot histogram</strong> and a <strong>box whisker plot</strong> are <strong>visual methods</strong> to assess if a given set of data is <strong>distributed normally</strong>. A <strong>normal distribution curve</strong> is an example of a <strong>plot histogram</strong>.</p>\n<p>Sometimes just the visual representation of the data might not be enough to tell whether the data is normally distributed. This is where <strong>Shapiro-Wilk test</strong> comes in. It examines <strong>how closely a given set of data fits a normal distribution</strong>. The sample data is first ordered and standardized. An assessment is then made how the sample quantiles fit the standard normal quantiles. Shapiro-Wilk test is commonly used on <strong>small samples</strong>.</p>\n<p><strong>Stratified analysis</strong> of the data is done to <strong>reduce confounding</strong>. In such a scenario, multiple odds ratios are obtained\u00a0\u2014 one for each stratum of the data. These have to be combined to give an <strong>adjusted odds ratio</strong>. This represents the effect of the exposure adjusted for the confounding factor. Mantel-Haenszel method is used for this purpose.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In Kaplan Meier survival curve, the bands used for the confidence interval is?",
    "choices": [
      {
        "id": 1,
        "text": "Unequal precision band"
      },
      {
        "id": 2,
        "text": "Hirshberg band"
      },
      {
        "id": 3,
        "text": "Holmes band"
      },
      {
        "id": 4,
        "text": "Hall-Wellner Band"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The bands used for confidence interval in the Kaplan-Meier survival curve are&nbsp;<strong>Hall-Wellner bands</strong>.</p>\n<p>When using standard statistical software, at each point in time, the upper and lower limits of the confidence interval are also obtained. <strong>Hall-Wellner</strong>&nbsp;bands, <strong>Gill</strong> bands, and&nbsp;<strong>Nair's Equal Precision</strong> confidence bands are used for this purpose.</p>\n<p>Kaplan-Meier plot is a <strong>graphical representation</strong> of the number of <strong>people surviving</strong> during a given length of time. Often there are <strong>two or more groups</strong> represented in the plot, such as those treated versus those not treated. The graph often has a <strong>number of steps</strong> as the number of people surviving is a discrete variable. The image given below shows a Kaplan-Meier plot. The dotted lines represent the upper and lower limits of the 95% confidence interval.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/97e3ffccc1d24e97b92580ecaf936461x1280x1029.JPEG"
    ]
  },
  {
    "text": "30,000 women were followed up for 10 years for the development of breast cancer. 1200 women developed cancer and were given a questionnaire to assess possible risk factors. Additionally, 2000 women from the same study were used as controls and were also given the questionnaire. What is this type of study called?",
    "choices": [
      {
        "id": 1,
        "text": "Case cohort"
      },
      {
        "id": 2,
        "text": "Retrospective cohort"
      },
      {
        "id": 3,
        "text": "Nested case control"
      },
      {
        "id": 4,
        "text": "Cross control cohort"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The type of study described in the question is a <strong>nested case-control study</strong>.&nbsp;</p>\n<p>A nested case-control study is essentially a <strong>case-control study that is present inside a cohort study</strong>. The <strong>cases</strong> are all the cohort members who <strong>developed the disease</strong>&nbsp;being studied at a given point in time during the follow-up period. However, each case is <strong>matched to</strong> one or more <strong>controls</strong>&nbsp;&mdash; individuals who <strong>did not develop the disease</strong> but are otherwise comparable to cases in terms of age and gender. Cases and controls are then compared in terms of their respective exposures to the risk factor. <strong>Nested case-control studies</strong> thus represent an <strong>interim analysis</strong> of the exposure and outcome data of a cohort study.</p>\n<p>A <strong>case-cohort study</strong> (option A) involves <strong>selecting a subset of the entire cohort</strong> at the beginning of the study. This <strong>sub-cohort acts as the control</strong> <strong>group</strong> for making comparisons with <strong>multiple case groups</strong>. For example, if a cohort study is being done to assess smoking as a risk factor for ischemic heart disease and lung cancer, the same sub-cohort can be used as the control group for both outcomes. If it was a <strong>nested case-control study</strong>, it would require two <strong>separate control groups</strong>. <strong>Case-cohort studies</strong> are <strong>more efficient</strong> than nested case-control studies when multiple outcomes are being studied.</p>\n<p>In a <strong>retrospective cohort study</strong> (option B), the <strong>outcomes have already occurred</strong> before the study begins. The investigator has to analyze the history of prior exposures and the duration of such exposures. Even though the exposure and the outcome have already occurred, the investigator goes from the <strong>exposure &rarr; outcome</strong> in a <strong>retrospective cohort study</strong>. This is in contrast to <strong>case-control studies</strong>, where the investigator goes from <strong>outcome &rarr; exposure</strong>.</p>\n<p>Cross control cohort (option D) is not a type of study design.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A person had a dog bite. Vaccination is up to date for both the dog and the man. The person's history is significant for having undergone splenectomy five years ago. What is the best management in this case?",
    "choices": [
      {
        "id": 1,
        "text": "Observation"
      },
      {
        "id": 2,
        "text": "Amoxiclav"
      },
      {
        "id": 3,
        "text": "Metronidazole"
      },
      {
        "id": 4,
        "text": "Ciprofloxacin"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Amoxicillin</strong>-<strong>clavulanate</strong> (Amoxiclav) is the <strong>drug of choice</strong> in this patient.</p>\n<p>Antibiotic prophylaxis is indicated in:</p>\n<ul>\n<li><strong>High-risk animal bites</strong>: <strong>cat bites</strong> in any location and <strong>hand bites</strong> by any animals, including humans. <strong>Cat</strong> and <strong>human bites</strong> have a <strong>higher risk of infection</strong> versus dog bites. Moreover, <strong>hand bites</strong> have a risk of developing an <strong>infection</strong> <strong>in the closed spaces</strong> of the hand.</li>\n<li><strong>High-risk patients</strong>: <strong>comorbidities</strong> such as <strong>diabetes</strong>, <strong>liver disease</strong>, and <strong>absence of functional spleen</strong>. Patients without a functional spleen are at an increased risk for overwhelming <strong>sepsis</strong> primarily due to <em>Capnocytophaga</em> species.\u00a0</li>\n</ul>\n<p><em>Pasteurella</em> species is the <strong>most common</strong> isolate from<strong> cat and dog bites</strong>. <em>Streptococci</em>, <em>S. aureus</em> and <em>Eikenella corrodens</em> are found in <strong>human bites</strong>. <strong>Amoxicillin-clavulanate</strong> is the <strong>first-line drug</strong> of choice for prophylaxis. In patients with penicillin allergy, clindamycin plus doxycycline/co-trimoxazole/fluoroquinolone can be used.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child came for DPT vaccination at 10 weeks. He has a history of fever of more than 40\u00b0C and an inconsolable cry at 6 weeks of age following vaccination. What should be done next?",
    "choices": [
      {
        "id": 1,
        "text": "Avoid DPT vaccination"
      },
      {
        "id": 2,
        "text": "Give DT vaccine"
      },
      {
        "id": 3,
        "text": "Give DPT vaccine"
      },
      {
        "id": 4,
        "text": "Defer by 4 weeks"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The next step for this patient should be to administer <strong>DPT vaccine</strong>.</p>\n<p>Events such as <strong>persistent inconsolable crying</strong> (more than <strong>3 hours</strong> in duration), <strong>hyperpyrexia</strong> (fever &gt; 40\u00b0C), <strong>hypotonic-hyporesponsive episodes</strong> within 48 hours of DTwP administration, and seizures, with or without fever, within 72 hours DTwP administration are considered precautions but <strong>not contraindications to future doses of DTwP</strong>. These events <strong>don't recur</strong> with the next dose and have been shown to have <strong>no permanent sequelae</strong>.\u00a0</p>\n<p><strong>Absolute contraindications</strong> to any pertussis vaccination are a <strong>history of anaphylaxis</strong> or <strong>development of encephalopathy</strong> within 7 days following previous DTwP vaccination. In case of <strong>anaphylaxis</strong>, further immunization with <strong>diphtheria, tetanus, and pertussis vaccines are contraindicated</strong> as it cannot be said with certainty which component caused anaphylaxis. For patients with a history of <strong>encephalopathy</strong> following vaccination, any <strong>pertussis vaccine is contraindicated</strong>, and only<strong> diphtheria and tetanus vaccines</strong> may be <strong>used</strong>.</p>\n<p><strong>Note</strong>: This answer might be controversial. The above answer is as per the\u00a0IAP Guidebook on Immunization.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "High fat intake according to FDA is?",
    "choices": [
      {
        "id": 1,
        "text": "Diet should contain 400 kcal from carbohydrates"
      },
      {
        "id": 2,
        "text": "Diet should contain total 1000 kcal"
      },
      {
        "id": 3,
        "text": "Diet should contain 800 kcal from fat"
      },
      {
        "id": 4,
        "text": "Diet should contain 80% fats"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>High fat intake according to FDA is a <strong>diet that should contain a total of 1000 kcal</strong>.\u00a0</p>\n<p>High fat diets have <strong>low carbohydrates</strong>, <strong>&lt;50 grams/day</strong>. This equates to <strong>&lt;250 kcal/day</strong> in the form of carbohydrates, not 400 kcal (option A). The percentage of <strong>calories from fat</strong>\u00a0is <strong>&gt;50%</strong> (option D), which would equate to about<strong> 500-</strong><strong>600 kcal</strong> from fats (option C). The diet should contain a total of <strong>800 - 1000 kcal</strong>.</p>\n<p>Ketogenic diets mainly incorporate low carbohydrates (&lt;50 grams/day), low protein, and high fats. Gluconeogenesis from the glucogenic amino acids in the diet and fat oxidation are utilized to meet the metabolic demands of the body. Ketogenic diets are especially useful for the treatment of intractable epilepsy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The slogan coined by WHO 'Do it Right' in the first aid of a snake bite includes all of the following except?",
    "choices": [
      {
        "id": 1,
        "text": "Reassurance"
      },
      {
        "id": 2,
        "text": "Tell sequence of events in detail after the bite"
      },
      {
        "id": 3,
        "text": "Go to hospital"
      },
      {
        "id": 4,
        "text": "Incisions"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Incisions</strong> are <strong>not a part</strong> of the management of a snake bite.</p>\n<p>The first aid following a snake bite consists of the mnemonic: <strong>carry no right</strong>.&nbsp;</p>\n<p><strong>Carry</strong>: The victim is <strong>not allowed to walk</strong>, even for a short distance. Walking generates muscle-pumping activity which disperses the venom into the systemic circulation.</p>\n<p><strong>No</strong>: <strong>No</strong> <strong>tourniquet</strong>, no electrotherapy, <strong>no</strong> <strong>cutting</strong>, no pressure immobilization, <strong>no suction</strong> to the bite site</p>\n<p><strong>R</strong>: <strong>Reassure</strong> the patient since 70% of the bites are from non-venomous species.</p>\n<p><strong>I</strong>: <strong>Immobilize</strong> in the same way as a fractured limb. A splint can be applied to the bitten extremity to limit the movement and assist with positioning. The extremity should be maintained in a neutral position at approximately heart level.</p>\n<p><strong>GH</strong>: <strong>Get to a hospital</strong> immediately. The most important step is to rapidly transport the patient to a medical facility equipped to provide supportive management.</p>\n<p><strong>T</strong>: Tell the doctor of any systemic symptoms which may have appeared on the way to the hospital.</p>\n<p>Note that <strong>elapid envenomations</strong> that are primarily <strong>neurotoxic</strong> and have no significant effects on local tissue may be managed by <strong>pressure immobilization</strong>. In this technique, the entire limb is immediately wrapped with a bandage and then immobilized. This technique restricts lymphatic drainage and has been shown to delay the absorption of venom into the systemic circulation. However, the <strong>offending snake</strong> should have been reliably identified as <strong>neurotoxic</strong> and the <strong>rescuer</strong> should be <strong>trained</strong> in applying this pressure bandage.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Calculate the kappa statistics for the following data set comparing IGRA and Mantoux test.",
    "choices": [
      {
        "id": 1,
        "text": "0.4"
      },
      {
        "id": 2,
        "text": "0.6"
      },
      {
        "id": 3,
        "text": "0.8"
      },
      {
        "id": 4,
        "text": "0.5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>&nbsp;</p>\n<p>Strength of agreement varies with kappa coefficient as follows:</p>\n<ul>\n<li>0.81 to 1: perfect agreement between the two tests/methods</li>\n<li>0.61 to 0.80: substantial agreement</li>\n<li>0.41 to 0.60: moderate agreement</li>\n<li>0.21 to 0.40: fair agreement</li>\n<li>0.10 to 0.20: slight agreement</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/113ed9d65c554f3393e6c3e929a1cbb5x232x108.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8d6a359f949148818e1217859e88d8d2x618x91.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/aabaa5e9980a4e1c852a5cff0fa15e55x672x767.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/04858fd57fc3414b955959eabf389a29x514x122.JPEG"
    ]
  },
  {
    "text": "Which of the following is not correctly matched?",
    "choices": [
      {
        "id": 1,
        "text": "Observational study \u2014 MOOSE"
      },
      {
        "id": 2,
        "text": "Systematic review \u2014 PRISMA"
      },
      {
        "id": 3,
        "text": "Diagnostic Study - CONSORT"
      },
      {
        "id": 4,
        "text": "Case report \u2014 CARE"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The guidelines used for reporting the results of <strong>RCT</strong> are <strong>CONSORT</strong> (consolidated standards of reporting trials).&nbsp;</p>\n<p>To improve the quality of reporting of health research, certain standards have been developed. These standards vary according to the type of study in question. Many journals now require the authors to complete the relevant checklist according to these standards prior to submitting their paper for publication. These standards include:</p>\n<table>\n<tbody>\n<tr>\n<td><strong>Guideline</strong></td>\n<td><strong>Expansion</strong></td>\n<td><strong>Area</strong></td>\n</tr>\n<tr>\n<td>CONSORT</td>\n<td>Consolidated standards of reporting trials</td>\n<td>Randomized controlled trials</td>\n</tr>\n<tr>\n<td>TREND</td>\n<td>Transparent reporting of non-randomized designs</td>\n<td>Behavioural and public health interventions with non-randomized designs</td>\n</tr>\n<tr>\n<td>STROBE&nbsp;</td>\n<td>Strengthening the reporting of observational studies in epidemiology</td>\n<td>Cohort, case-control, and cross-sectional studies</td>\n</tr>\n<tr>\n<td>STRAEGA</td>\n<td>Strengthening the reporting of genetic association studies</td>\n<td>Modification of STROBE for genetic studies</td>\n</tr>\n<tr>\n<td>STARD</td>\n<td>Standards for the reporting of diagnostic accuracy studies</td>\n<td>Diagnostic tests</td>\n</tr>\n<tr>\n<td>CARE</td>\n<td>Case reporting</td>\n<td>Clinical case reports and reports of patient encounters</td>\n</tr>\n<tr>\n<td>SAMPL</td>\n<td>&nbsp;Statistical analyses and methods in published literature</td>\n<td>Basic statistical reporting for articles published in biomedical journals</td>\n</tr>\n<tr>\n<td>PRISMA</td>\n<td>Preferred reporting items for systematic reviews and meta-analyses</td>\n<td>Meta-analyses of randomized controlled trials</td>\n</tr>\n<tr>\n<td>MOOSE</td>\n<td>Meta-analysis of observational studies in epidemiology</td>\n<td>Meta-analyses of observational studies</td>\n</tr>\n</tbody>\n</table>\n<p>Many of these guidelines are available via the EQUATOR network.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following best represents the definition of culture?",
    "choices": [
      {
        "id": 1,
        "text": "It is static and not related to health and disease"
      },
      {
        "id": 2,
        "text": "A set of beliefs which are static"
      },
      {
        "id": 3,
        "text": "Socially acquired learned behaviour"
      },
      {
        "id": 4,
        "text": "Rules set according to religion which are dynamic"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Culture</strong> is the<strong> socially acquired learned behaviour</strong>. It is passed onto generations through formal and informal learning. It is the representation of customs, beliefs, laws, arts, and moral values of a society. Cultural factors have a large part to play in health.</p>\n<p>Other closely related terms include:</p>\n<p><strong>Customs</strong> are the <strong>traditionally</strong> <strong>accepted</strong> ways of behaving that are <strong>specific</strong> <strong>to</strong> <strong>a</strong> <strong>society</strong>. They can be folkways, which are referred to as the right ways of doing things in less vital areas of human conduct. Mores are stringent customs followed by a society.</p>\n<p><strong>Socialization</strong> is the process by which a person in a society <strong>imbibes</strong> <strong>its</strong> <strong>beliefs</strong>, <strong>customs</strong>, etc. through daily interaction with its members.</p>\n<p>A <strong>community</strong> is a social group determined by <strong>geographical boundaries</strong> and/or common values and interests.</p>\n<p><strong>Acculturation</strong> is the process by which there is the <strong>diffusion</strong> <strong>of</strong> <strong>cultures</strong> between two culturally different groups of people. Acculturation does not take place by folklore.</p>\n<p><strong>Folklore</strong> is the <strong>passage</strong> <strong>of</strong> <strong>customs</strong> <strong>and</strong> <strong>beliefs</strong> of a community <strong>through</strong> <strong>generations</strong>, merely by word of mouth.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "According to National Programme for Control of Blindness and Visual Impairment which of the following is incorrect about the reach in approach?",
    "choices": [
      {
        "id": 1,
        "text": "People with cataract are treated in a makeshift operation centre"
      },
      {
        "id": 2,
        "text": "IOL placement by small incision cataract surgery is preferred"
      },
      {
        "id": 3,
        "text": "Reach in approach has lesser post operative complications"
      },
      {
        "id": 4,
        "text": "People with cataract are identified and sent to higher centre"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Patients with cataract are <strong>not</strong> <strong>operated</strong> in <strong>makeshift</strong> <strong>operation</strong> <strong>centres</strong> but are rather <strong>shifted</strong> to base hospitals (<strong>reach</strong>-<strong>in</strong> <strong>approach</strong>) as the visual acuity results indicate that the Base Hospital had significantly <strong>higher</strong> <strong>final</strong> <strong>corrected</strong> <strong>visual</strong> <strong>acuity</strong>\u00a0<strong>compared</strong> <strong>to</strong> the <strong>Peripheral</strong> <strong>Eye</strong> <strong>Camps.</strong></p>\n<p>The <strong>Base</strong> <strong>Hospital</strong> approach, also known as the <strong>reach-in</strong> <strong>approach</strong>, and the <strong>Peripheral</strong> <strong>Eye</strong> Camp approach, also known as the reach-out approach, are two community-oriented strategies implemented within the framework of the National Programme for the Control of Blindness. These techniques aim to address the existing backlog of cataract-related blindness. Both methods have demonstrated efficacy and possess distinct advantages and disadvantages. Both community participation and intersectoral coordination, together with the utilization of suitable technology at an affordable price, are essential components for both endeavours.</p>\n<p>Based on recent developments, there is a shift in emphasis <strong>from</strong> the '<strong>Reach</strong>-<strong>out</strong>' approach <strong>to</strong> the '<strong>Reach</strong>-<strong>in</strong>' approach. The <strong>Reach</strong>-<strong>in</strong> <strong>Approach</strong> involves the organization of <strong>screening</strong> <strong>camps</strong> in <strong>rural</strong> <strong>and</strong> <strong>remote</strong> <strong>locations</strong> that lack access to eye-care institutions. Comprehensive eye care treatments, including refraction, are offered to patients. Subsequently, <strong>those</strong> <strong>requiring</strong> <strong>cataract surgery</strong> are <strong>conveyed</strong> to the <strong>nearest</strong> <strong>hospitals</strong> that <strong>possess</strong> <strong>adequate</strong> <strong>resources</strong> and facilities, following the <strong>base</strong> <strong>hospital</strong> <strong>strategy</strong>. To conduct ocular surgery, it is imperative to comply with the guidelines established by the Government of India.</p>\n<ul>\n<li>It is imperative to have at least <strong>one</strong> <strong>anesthesiologist</strong> who is well prepared to address typical crises to ensure patient safety and optimal care.</li>\n<li>It is recommended that a minimum of <strong>one</strong>, <strong>ideally</strong> <strong>two</strong>, operating <strong>surgeons</strong> be present, with each surgeon limiting their daily caseload to <strong>no more than 30 procedures.</strong></li>\n<li>Currently, the preferred approach for cataract extraction is extracapsular surgery, with a <strong>preference</strong> <strong>for</strong> manual small incision cataract surgery (<strong>SICS</strong>) or phacoemulsification, together with the implantation of a posterior chamber intraocular lens.</li>\n<li>It is ideal to limit the number of surgical procedures conducted in a day to no more than 50.</li>\n<li><strong>Simultaneous</strong> surgery on <strong>both</strong> <strong>eyes</strong> should be avoided.</li>\n<li>Patients who have a high surgical risk due to conditions such as severe diabetes, severe hypertension, and cardiac issues should not undergo surgery in camp settings. Cases related to such issues should be appropriately referred to the base hospitals.</li>\n</ul>\n<p>National Programme for the Control of Blindness and Visual Impairment (<strong>NPCBVI</strong>). The levels of eye care, according to NPCBVI are:</p>\n<p><strong>Primary level:</strong> Sub-district level hospitals, community health centres, mobile ophthalmic units, upgraded PHCs, link workers, and Panchayats.<br /><strong>Secondary</strong> <strong>level</strong>: District hospitals, NGO eye hospitals<br /><strong>Tertiary levels:</strong> Regional institutes of Ophthalmology, medical colleges.<br />The goal is to reduce the prevalence of blindness to 0.3% by 2020.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3132e6be286b4c1b8a35016a9eec2fffx378x378.PNG"
    ]
  },
  {
    "text": "A 68-year-old lady was brought to the hospital by her daughter, with episodes of falls, confusion, chronic diarrhea, and cough. The intern decided to conduct a geriatric assessment. Which of the following factors indicated such an examination?",
    "choices": [
      {
        "id": 1,
        "text": "Age, sex, falls"
      },
      {
        "id": 2,
        "text": "Age, cough, chronic diarrhoea"
      },
      {
        "id": 3,
        "text": "Age, fall, confusion"
      },
      {
        "id": 4,
        "text": "Age, sex, cough, chronic diarrhea"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient's <strong>age</strong>, history of <strong>falls</strong> and episodes of <strong>confusion</strong> necessitate a comprehensive geriatric assessment.</p>\n<p>Various comprehensive geriatric assessment programs use the following before performing a full-fledged assessment:</p>\n<ul>\n<li><strong>Age</strong></li>\n<li>The presence of concurrent medical conditions, such as heart failure or cancer.</li>\n<li>The presence of psychosocial illnesses like depression or isolation.</li>\n<li>Diseases unique to the elderly, include cognitive decline, mobility issues, and <strong>falls</strong></li>\n<li>Prior or anticipated high health-care utilization</li>\n<li>Changes in living situation (for example, from independent living to assisted living, nursing facility, or in-home caretakers)</li>\n</ul>\n<p>The inclusion of geriatric evaluation is imperative within the broader framework of the patient's health trajectory, taking into account their future care objectives and personal preferences. Functional status refers to the comprehensive assessment of an individual's health effect within the framework of their surroundings and social support network. It encompasses the individual's capacity to do the physical and social tasks required for their typical activities and duties. The constituents of functional status encompass <strong>activities</strong> of <strong>daily</strong> <strong>living</strong> (ADLs), <strong>instrumental</strong> <strong>activities</strong> of <strong>daily</strong> <strong>living</strong> (IADLs), and <strong>advanced</strong> <strong>activities</strong> of <strong>daily</strong> <strong>living</strong> (AADLs). Two often employed measures in the field are the <strong>Katz</strong> <strong>index</strong>, which assesses activities of daily living (<strong>ADLs</strong>), and the <strong>Lawton</strong> scale, which evaluates <strong>instrumental</strong> activities of <strong>daily</strong> <strong>living</strong> (IADLs). The most effective approach for ascertaining AADLS involves the utilization of <strong>open</strong>-<strong>ended</strong> inquiries, such as \"In what manner do you allocate your time throughout the day?\" or \"What activities do you find enjoyable?\"</p>\n<p>There is a growing trend in geriatric assessment to integrate perspectives from non-clinical office workers, patients, and their relatives or loved ones. This collaborative approach may encompass the use of standing orders, forms, and questionnaires. An advisable strategy involves doing an annual evaluation of functional status, <strong>commencing</strong> at the age of <strong>65</strong> <strong>years</strong>, using the <strong>Medicare</strong> <strong>Annual</strong> <strong>Wellness</strong> <strong>Visit</strong>. For individuals below the age of 75 years with multiple comorbidities or those aged 75 years and above, it is recommended to augment this assessment with supplementary components. Furthermore, it is recommended that some components of geriatric assessment, such as evaluating activities of daily living (ADLs) and instrumental activities of daily living (IADLs), measuring gait, balance, and the risk of falls, evaluating mood and affect, as well as assessing cognition, be conducted following significant illnesses, particularly those necessitating hospitalization.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following best helps assess the quality of healthcare provided?",
    "choices": [
      {
        "id": 1,
        "text": "Multiple logistic regression model"
      },
      {
        "id": 2,
        "text": "Bar graph"
      },
      {
        "id": 3,
        "text": "Scattergram"
      },
      {
        "id": 4,
        "text": "Ishikawa diagram/ Fish bone diagram"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Other options:</p>\n<p>Option A: <strong>Logistic</strong> <strong>regression</strong> may be used in some situations where we are <strong>not interested</strong> in a <strong>numerical</strong> <strong>outcome</strong> (like risk, etc) but we want a <strong>nominal</strong> or <strong>categorical</strong> one (like death/survival, developing a disease/not developing a disease). Here, the relationship between the variables will not be a linear one as the outcome from survival to death in relationship with the risk factor can change suddenly. Thus these outcomes are represented by 0 and 1.</p>\n<p>Option B:\u00a0A<strong> bar graph i</strong>s a pictorial way of presenting a set of <strong>numbers</strong>, the magnitudes of which are proportional to the length of the bars in the graph. It can be simple, multiple, or component bar graphs and enable values to be compared visually. They are used to <strong>compare</strong> <strong>a</strong> <strong>single</strong> <strong>variable</strong> <strong>value</strong> between several groups.</p>\n<p>Option C:\u00a0A <strong>scatter</strong> <strong>plot</strong> is a statistical map used to study the <strong>correlation</strong> <strong>between</strong> <strong>two</strong> <strong>given</strong> <strong>variables</strong>. In scatter plots or scatter diagrams, the pattern made by plotted points along the two axes indicates the possible relationship. If the dots cluster along a straight line, then the relationship is linear. If there is <strong>no cluster</strong>, then there might be <strong>no relationship</strong>. Below is an example of a scatter diagram without a linear relation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d9849f51c2dd4db6afdb2eb6bb03f414x1280x941.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b829b4fa4c1a4adb81560358f598acd2x720x470.PNG"
    ]
  },
  {
    "text": "A mother brought her 6 month old infant baby to an Anganwadi worker Lata for advice regarding the vaccination of her child. The last vaccines he had received were OPV3, PENTA 3, IPV2, and ROTA3 at 14 weeks of age. BCG and Hep B were given at birth. When is the next vaccination due?",
    "choices": [
      {
        "id": 1,
        "text": "MR vaccine at left arm intramuscularly and Vitamin A drops at the end of 9 months"
      },
      {
        "id": 2,
        "text": "MR vaccine at right arm subcutaneously and Vitamin A drops at the end of 8 months"
      },
      {
        "id": 3,
        "text": "MR vaccine at left arm intramuscularly and Vitamin A drops at the end of 8 months"
      },
      {
        "id": 4,
        "text": "MR vaccine at right arm subcutaneously and Vitamin A drops at the end of 9 months"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>According to the <strong>National</strong> <strong>Immunization</strong> <strong>Schedule</strong>, the <strong>Measles</strong>/<strong>MR</strong> <strong>vaccine</strong> is given at <strong>9 completed months</strong> (1st dose), and a <strong>second</strong> dose is given at <strong>16</strong>-<strong>24</strong> <strong>months.</strong> Measles vaccine can be given till 5 years of age. A dose of <strong>0.5</strong> <strong>mL</strong> is administered subcutaneously in the <strong>right</strong> <strong>upper</strong> <strong>arm</strong>.</p>\n<p><strong>Vitamin A schedule</strong> in the National Immunisation Schedule(NIS)\u00a0</p>\n<ul>\n<li><strong>1 lakh IU </strong>at <strong>9</strong> <strong>completed</strong> <strong>months</strong> along with the <strong>Measles-Rubella vaccine</strong></li>\n<li><strong>2 lakh IU </strong>is administered bi-annually for children between <strong>1-5 years of age</strong></li>\n</ul>\n<p>Total number of doses administered- <strong>9</strong> <strong>doses</strong>,<strong>17</strong> <strong>lakhs</strong> <strong>IU</strong>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is true about palliative care?",
    "choices": [
      {
        "id": 1,
        "text": "A,B,C,D"
      },
      {
        "id": 2,
        "text": "C,E,F"
      },
      {
        "id": 3,
        "text": "B,D"
      },
      {
        "id": 4,
        "text": "A,B,E,F"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>True </strong>statements<strong> </strong>are<strong>:\u00a0</strong></p>\n<ul>\n<li>The patient is sovereign</li>\n<li>The aim is to improve the quality of life</li>\n</ul>\n<p><strong>Palliative</strong> <strong>care</strong> helps patients and their families cope with physical, psychological, social, and spiritual obstacles of life-threatening disease. It is interesting to note that even the <strong>quality of life</strong> of the <strong>caregiver</strong> also improves. Palliative care is needed by 56.8 million individuals annually, including 25.7 million in their final year according to WHO, while only 14% of palliative care patients worldwide receive it.</p>\n<p>Palliative care <strong>improves</strong> the<strong> quality of life of life</strong>-<strong>threatening</strong> <strong>illness</strong> patients <strong>and</strong> their <strong>families</strong>. Early detection, assessment, and treatment of physical, psychosocial, and spiritual suffering and additional concerns diminish discomfort. <strong>Addressing</strong> <strong>suffering</strong> goes beyond physical symptoms. Palliative care supports <strong>patients</strong> <strong>and</strong> <strong>caregivers</strong> collaboratively. This includes practical assistance and bereavement counselling. It supports patients to live as fully as possible till death.</p>\n<p>The human right to health includes palliative care. <strong>Patient-centred</strong> and integrated health services should focus on individual needs and preferences.\u00a0</p>\n<p>Many diseases require palliative care. Most palliative care patients have <strong>chronic</strong> <strong>conditions</strong> like cardiovascular disease (38.5%), cancer (34%), respiratory disease (10.3%), AIDS (5.7%), and diabetes (4.6%). Kidney failure, chronic liver illness, multiple sclerosis, Parkinson's, rheumatoid arthritis, neurological disease, dementia, congenital defects, and drug-resistant TB may require palliative care.</p>\n<p>Most common and serious symptoms that patients undergoing palliative care experience are pain and respiratory difficulties. Almost 80% of AIDS, cancer, and 67% of cardiovascular and COPD patients would experience moderate to severe agony at death.</p>\n<p>Opioids also <strong>relieve</strong> <strong>dyspnea</strong> and <strong>diminish</strong> the increased <strong>pain</strong> experienced by patients. <strong>Early symptom</strong> control is ethical to reduce suffering and respect the dignity of the patient.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the highest level of community participation?",
    "choices": [
      {
        "id": 1,
        "text": "Considering their ideas"
      },
      {
        "id": 2,
        "text": "Felt needs of community considered"
      },
      {
        "id": 3,
        "text": "Contribution of resources"
      },
      {
        "id": 4,
        "text": "Involving in planning of health related campaigns"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>highest</strong> <strong>level</strong> of community participation is for the community to be <strong>involved</strong> <strong>in</strong> the <strong>planning</strong> of health-related campaigns.</p>\n<p><strong>Engaging</strong> in the strategic <strong>planning</strong> of health-related campaigns signifies a substantial degree of community involvement, surpassing the mere contemplation of ideas or the provision of resources. The process of planning campaigns necessitates proactive <strong>participation</strong> and <strong>cooperation</strong>, signifying a heightened level of engagement in decision-making procedures that have a direct influence on the welfare of the community. This level of participation <strong>also</strong> <strong>includes</strong> <strong>engaging</strong> with the community's <strong>perceived</strong> <strong>needs</strong> through actively contributing to the strategic design and implementation of initiatives that aim to enhance health outcomes.</p>\n<p>Earlier <strong>socialisation</strong> was envisaged as an idea for the utilisation of services but recently WHO and UNICEF deemed <strong>community</strong> <strong>participation</strong> would be of even greater help. They have defined it as ''<em>the process by which individuals and families assume responsibility for their health and welfare for those of the community and develop the capacity to contribute to their and the community's development</em>.'' It also signifies the involvement of the community in the process of planning, organizing, and managing their healthcare services. This concept is commonly referred to as \"<strong>Health by the People</strong>.\"\u00a0</p>\n<p>There are <strong>three ways</strong> in which a <strong>community</strong> would be able to <strong>participate</strong>:</p>\n<p>1)\u00a0The community can <strong>offer</strong> various <strong>resources</strong> such as facilities, human resources, logistical assistance, and maybe financial help.</p>\n<p>2) Active community engagement is crucial in the processes of planning, management, and assessment.</p>\n<p>3) Another significant contribution that individuals may make is by actively participating in and utilizing healthcare services.</p>\n<p>Other options:</p>\n<p>Options A, B and C are also methods by which a community will be able to participate but planning of health-related campaigns is considered the highest form of community participation.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient hailing from an area infested with mosquitoes presents with fever, chills, and myalgias. WBC count was 4000 cells/cu.mm, RBC was normal, and platelets were 90000 cells/cu.mm. He also had a maculopapular rash. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Dengue"
      },
      {
        "id": 2,
        "text": "Typhoid"
      },
      {
        "id": 3,
        "text": "Ebola haemorrhagic fever"
      },
      {
        "id": 4,
        "text": "Rift valley fever"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given clinical scenario with a patient hailing from a <strong>mosquito-infested</strong> area with fever and <strong>decreased platelet</strong> counts is diagnostic of<strong>\u00a0dengue</strong>.\u00a0</p>\n<p>Symptoms of severe dengue are headache, myalgias, retroorbital pain<strong>,</strong> end-organ\u00a0damage, pleural &amp; ascitic effusions and <strong>thrombocytopenia</strong> (&lt;100,000/ uL). Complications include mild hepatic injury, seizures, arrythmias and acute kidney injury.</p>\n<p>Diagnosis is made by <strong>NS1 antigen detection</strong> and <strong>IgM antibody assays</strong>. Treatment includes <strong>crystalloid infusion</strong> in mild cases and colloid infusion in severe cases, oxygen administration and close monitoring.</p>\n<p>Dengue is classified into <strong>dengue with or without warning signs</strong> and <strong>severe dengue</strong>. Dengue is to be suspected when a <strong>high fever</strong> (40\u00b0C/104\u00b0F) is accompanied by <strong>any two</strong> of the following symptoms during the febrile phase (2-7 days) which include severe headache, retro-orbital pain, arthralgia or myalgia, nausea, vomiting and maculopapular rash.</p>\n<p>Warning signs in dengue are:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">severe abdominal pain</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">persistent vomiting</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">tachypnea</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">bleeding gums or nose\u00a0</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">fatigue</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">restlessness</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">hepatomegaly</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">malena or hematemesis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements are correctly matched?",
    "choices": [
      {
        "id": 1,
        "text": "Statement 1,2"
      },
      {
        "id": 2,
        "text": "Statement 3,4"
      },
      {
        "id": 3,
        "text": "Statement 2,3"
      },
      {
        "id": 4,
        "text": "Statement 1,2,3"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>True statements </strong>are<strong>:</strong></p>\n<ul>\n<li><strong>Contemplation</strong> phase - A smoker is considering giving up his habit of smoking. (<strong>Recognizes</strong> <strong>his</strong> <strong>problem</strong> and <strong>thinks</strong> about to <strong>bring</strong> <strong>about</strong> a <strong>change</strong>)</li>\n<li><strong>Maintenance</strong> phase - A person who quit smoking one year back and has abstained from smoking ever since. (He has <strong>sustained</strong> <strong>his</strong> <strong>abstinence</strong> <strong>from</strong> <strong>smoking</strong>)</li>\n</ul>\n<p><strong>Motivation</strong> <strong>enhancement</strong> <strong>therapy</strong> (MET) is a systematic intervention approach for bringing about change in the addictive behaviour seen in people with substance use disorders. It is based on the principle of <strong>motivational</strong> <strong>psychology</strong> and aims to enable the patient to deal with his addiction by producing internally motivated change.</p>\n<p>Addictive behaviors do not change abruptly, and go through gradual stages. The stages of motivation enhancement therapy (MET) include:</p>\n<p><strong>Precontemplation</strong> - individuals in this stage are often <strong>unaware</strong> that their behaviour (eg. alcohol abuse) is problematic or is producing negative consequences.\u00a0</p>\n<p><strong>Contemplation</strong> - individuals in this stage <strong>recognize</strong> their problems and begin to think about changing their behaviour. They weigh the pros and cons of change. They may still feel ambivalent about changing their behaviour.\u00a0</p>\n<p><strong>Preparation</strong> or <strong>determination</strong> - individuals in this stage make decisions to change their habits and are ready to take action. They start to take small steps toward behaviour change.</p>\n<p><strong>Action</strong> - individuals in this stage change their behaviour and intend to keep moving forward with this change in behaviour</p>\n<p><strong>Maintenance</strong> - individuals in this stage <strong>sustain</strong> <strong>their</strong> <strong>change</strong> <strong>in</strong> <strong>behaviour</strong> for a while and intend to maintain this change going forward. People work to prevent relapse to earlier stages.</p>\n<p>Other statements:</p>\n<p>Statement <strong>1:</strong> This statement is <strong>false</strong> as people in the <strong>pre</strong>-<strong>contemplation</strong> <strong>stage\u00a0</strong>are <strong>unaware\u00a0</strong>that their behaviour is problematic.</p>\n<p>Statement <strong>4</strong>: This statement is also <strong>false</strong> as people in the action stage <strong>make strides to change their behaviour.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Two doctors examined 100 chest X - Rays of patients. The kappa statistic was found to be 0.71. What does it mean?",
    "choices": [
      {
        "id": 1,
        "text": "Good agreement"
      },
      {
        "id": 2,
        "text": "Perfect agreement"
      },
      {
        "id": 3,
        "text": "Poor agreement"
      },
      {
        "id": 4,
        "text": "No agreement"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>where <strong>p<sub>O</sub></strong> is <strong>observed</strong> agreement and <strong>p</strong><sub><strong>E</strong> </sub>is <strong>expected</strong> agreement.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/365f4d81c2724109bdd9f1f68f25e664x232x108.JPEG"
    ]
  },
  {
    "text": "Which of the following is an example of a longitudinal observational and analytical study?",
    "choices": [
      {
        "id": 1,
        "text": "Case control Study"
      },
      {
        "id": 2,
        "text": "Cohort Study"
      },
      {
        "id": 3,
        "text": "Randomized Controlled Trial"
      },
      {
        "id": 4,
        "text": "Ecological Study"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Cohort</strong> <strong>study</strong> is an example of a <strong>longitudinal</strong> <strong>observational</strong> and <strong>analytical</strong> study.</p>\n<p>A <strong>cohort study</strong> is a type of <strong>analytical</strong> study, which progresses from cause to effect, as exposure has occurred but not disease. It is also known as a forward-looking study, incidence study, <strong>prospective</strong> study, and <strong>longitudinal study. </strong>A well-designed cohort study is considered the <strong>most</strong> <strong>reliable</strong> means of showing an <strong>association</strong> between a <strong>cause</strong> or suspected <strong>risk</strong> <strong>factor</strong> <strong>and</strong> subsequent <strong>disease</strong> (or effect).</p>\n<p>Types of epidemiological studies:</p>\n<ul>\n<li><strong>Observational</strong> <strong>studies</strong> - allow nature to take its course, the investigator measures but does not intervene.</li>\n</ul>\n<ol>\n<li><strong>Descriptive</strong> <strong>studies</strong> - limited to the description of the occurrence of a disease in a population- (<strong>hypothesis</strong> <strong>formulation</strong>).</li>\n<li><strong>Analytical</strong> <strong>studies</strong> - go further by analyzing the relationship between health status and other variables- (<strong>hypothesis testing).</strong></li>\n</ol>\n<ul style=\"list-style-type: circle;\">\n<li>Ecological studies</li>\n<li>Cross-sectional studies</li>\n<li>Case-control studies</li>\n<li><strong>Cohort studies</strong></li>\n</ul>\n<ul>\n<li><strong>Experimental</strong> <strong>studies</strong> or intervention studies involve an active attempt to change a disease determinant or the progress of a disease and are similar in design to experiments in other sciences- (hypothesis confirmation).</li>\n</ul>\n<ol>\n<li><strong>Randomized</strong> <strong>controlled</strong> <strong>trials</strong></li>\n<li>Field trials</li>\n<li>Community trials \u00a0 \u00a0 \u00a0</li>\n</ol>\n<p>Other options:</p>\n<p>Option A: Although <strong>case</strong>-<strong>control studies</strong> are inherently analytical, they are <strong>not</strong> <strong>longitudinal</strong>. <strong>Longitudinal</strong> <strong>studies</strong> involve the collection of variables about a subject over an extended duration.</p>\n<p>Option C: A <strong>randomized</strong> <strong>control</strong> <strong>trial</strong> is an <strong>experimental study</strong> in which an intervention is given to a group of patients participating in the study and compared to another group of patients with similar characteristics who are not given that intervention to be studied. It uses <strong>patients</strong> as the <strong>unit</strong> of study.</p>\n<p>Option D: An <strong>ecological</strong> <strong>study</strong> is a type of <strong>analytical</strong> <strong>study</strong> that analyzes the health status and its relation with other variables. It is also called a <strong>correlational</strong> <strong>study</strong>, and it uses the <strong>population</strong> as a <strong>unit</strong> <strong>of</strong> <strong>study</strong>. <strong>Longitudinal</strong> <strong>studies</strong> involve the collection of variables about a subject over an extended duration.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '103 Community Medicine Ini-Cet 2023';
        let hierarchy = ["Marrow", "PYQs", "Community Medicine"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>