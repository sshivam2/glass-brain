<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15 Metabolic Disorders Of Urea Cycle, Complex Molecules, And Carbohydrates - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Pediatrics
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">23</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A 3-day-old child is suspected to have an inborn error of metabolism. Further evaluation reveals elevated blood ammonia in the presence of normal blood pH and bicarbonate levels. There are no ketone bodies in the urine. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Organic aciduria"
      },
      {
        "id": 2,
        "text": "Disorders of amino acid metabolism"
      },
      {
        "id": 3,
        "text": "Urea cycle defect"
      },
      {
        "id": 4,
        "text": "Galactosemia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In this case, <strong>hyperammonemia is&nbsp;+ve; acidosis is -ve; and ketosis is -ve:</strong>&nbsp;This is consistent with the&nbsp;<strong>u</strong><strong>rea cycle defect</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dd152bb0a72e4cd2810eeaa55a5443a1x1280x2560.0.JPEG"
    ]
  },
  {
    "text": "A young infant started seizing in his cradle. He was immediately rushed to the casualty. On investigation, blood ammonia was markedly elevated. Which of the following is used to lower the ammonia levels?",
    "choices": [
      {
        "id": 1,
        "text": "Sodium benzoate"
      },
      {
        "id": 2,
        "text": "Sodium phenylacetate"
      },
      {
        "id": 3,
        "text": "Arginine hydrochloride"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>All of the above agents are used in the treatment of acute hyperammonemia in an infant.</p>\n<p>Treatment of&nbsp;acute hyperammonemia in an infant:</p>\n<ul>\n<li>Provide <strong>adequate calories, fluid, and electrolytes</strong> intravenously.</li>\n<li><strong>Minimal amounts of protein</strong> as a mixture of <strong>essential amino acids</strong> during the first&nbsp;24 hours of therapy.</li>\n<li>Give <strong>priming doses</strong> of the following compounds:&nbsp;<strong>Sodium benzoate,&nbsp;Sodium phenylacetate,&nbsp;Arginine hydrochloride</strong>.</li>\n<li>Initiate <strong>peritoneal dialysis or hemodialysis</strong> if the <strong>above treatment fails</strong> to produce an appreciable decrease in plasma ammonia levels.</li>\n</ul>\n<p><strong>Benzoate</strong> forms <strong>hippurate</strong> with endogenous glycine in the liver. Each mole of benzoate removes 1 mole of ammonia as glycine.</p>\n<p><strong> Phenylacetate</strong> conjugates with glutamine to form <strong>phenylacetylglutamine</strong>, which is readily excreted in the urine. One mole of phenylacetate removes 2 moles of ammonia as glutamine from the body.</p>\n<p><strong>Arginine</strong> administration supplies the urea cycle with <strong>ornithine.</strong> It is effective in all patients, except those with arginase deficiency.</p>\n<p><strong>Note: </strong></p>\n<p><strong>Phenylbutyrate</strong> which is metabolized to phenylacetate in our body can also be used as it <strong>scavenges nitrogen.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An infant's mother is distressed that her baby refuses her feeds and starts vomiting immediately when fed and becomes lethargic. After thorough investigations, the baby is diagnosed with HHH syndrome. Which of the following is least likely to be found?",
    "choices": [
      {
        "id": 1,
        "text": "Hyperuricemia"
      },
      {
        "id": 2,
        "text": "Hyperammonemia"
      },
      {
        "id": 3,
        "text": "Hyperornithinemia"
      },
      {
        "id": 4,
        "text": "Homocitrullinemia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Hyperuricemia</strong>&nbsp;is<strong> not</strong> a component of HHH syndrome</p>\n<p><strong>HHH syndrome&nbsp;</strong>is a rare<strong> autosomal-recessive disorder</strong> caused by a defect in the transport system of ornithine from the cytosol into the mitochondria (<strong>deficiency of ornithine permease/translocase),</strong>&nbsp;resulting in the accumulation of ornithine in the cytosol leading to hyperornithinemia and a deficiency of this amino acid in mitochondria&nbsp;results in the disruption of the urea cycle and hyperammonemia. Homocitrulline is formed from the reaction of mitochondrial carbamyl phosphate with lysine, which can become a substrate for the OTC reaction when ornithine is deficient.</p>\n<p>Components of HHH syndrome:</p>\n<ul style=\"list-style-type: circle;\">\n<li>Hyperammonemia</li>\n<li>Hyperornithinemia</li>\n<li>Homocitrullinemia</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "As a geneticist studying the familial inheritance of porphyrias, which of the following is likely to show the inheritance pattern given below?",
    "choices": [
      {
        "id": 1,
        "text": "Congenital erythropoietic porphyria"
      },
      {
        "id": 2,
        "text": "Variegate porphyria"
      },
      {
        "id": 3,
        "text": "\u03b4-Aminolevulinic acid dehydratase porphyria"
      },
      {
        "id": 4,
        "text": "X-linked protoporphyria"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>All porphyrias are autosomal dominant except the following :</p>\n<ul>\n<li>Congenital erythropoietic porphyria (CEP) (<strong>autosomal recessive</strong>)</li>\n<li>&delta;-Aminolevulinic acid dehydratase porphyria (ADP) (<strong>autosomal recessive</strong>)</li>\n<li>Protoporphyria - X-linked protoporphyria (<strong>X-linked dominant</strong>)&nbsp;</li>\n<li>Erythropoietic protoporphyria (EPP)&nbsp;(<strong>autosomal recessive</strong>)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/73550cf2ed6549049b75a4c640016a05.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The most common porphyria which manifests in childhood is ______",
    "choices": [
      {
        "id": 1,
        "text": "Porphyria cutanea tarda"
      },
      {
        "id": 2,
        "text": "Congenital erythropoietic porphyria"
      },
      {
        "id": 3,
        "text": "Erythropoietic protoporphyria"
      },
      {
        "id": 4,
        "text": "Hereditary coproporphyria"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Erythropoietic protoporphyria</strong> (autosomal recessive) is the <strong>most common porphyria</strong> to manifest in childhood.</p>\n<p>Porphyria cutanea tarda (option A) manifests in adults.</p>\n<p>Congenital erythropoietic porphyria (option B) also known as G&uuml;nther disease presents itself in utero or in infancy. It is a rare autosomal-recessive disease.</p>\n<p>Hereditary coproporphyria (option D) presents itself in the post-pubertal age.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is also known as plumboporphyria due to its clinical similarity to lead poisoning?",
    "choices": [
      {
        "id": 1,
        "text": "Acute intermittent porphyria (AIP)"
      },
      {
        "id": 2,
        "text": "\u03b4-Aminolevulinic acid dehydratase porphyria (ALAD)"
      },
      {
        "id": 3,
        "text": "Porphyria cutanea tarda (PCT)"
      },
      {
        "id": 4,
        "text": "Erythropoietic protoporphyria (EPP)"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>&delta;-Aminolevulinic acid dehydratase porphyria (ALAD)&nbsp;is also called <strong>plumboporphyria</strong>/Doss porphyria due to its clinical similarity to lead poisoning, although it is not related to lead exposure.</p>\n<p>ALAD catalyzes the condensation of 2 molecules of ALA to form the pyrrole porphobilinogen (PBG). The enzyme is subject to inhibition by lead because ALAD is the principal lead-binding protein in erythrocytes, and lead can displace the zinc atoms of the enzyme, thus inhibiting it. Therefore, both lead poisoning and ALAD porphyria produce similar signs and symptoms.&nbsp;Symptoms resemble those of other acute porphyrias, including acute attacks of abdominal pain and neuropathy.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 16-year-old girl was admitted for severe abdominal pain, nausea, vomiting, and diarrhea. She developed generalized seizures in the hospital for which she was given phenytoin. Her symptoms worsened, she developed muscle weakness which progressed to quadriparesis. Urinary porphobilinogen was found to be high. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Congenital erthyropoietic porphyria"
      },
      {
        "id": 2,
        "text": "Porphyria cutanea tarda"
      },
      {
        "id": 3,
        "text": "Acute intermittent porphyria"
      },
      {
        "id": 4,
        "text": "X-linked protoporphyria"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most likely diagnosis is<strong>&nbsp;acute intermittent porphyria</strong>&nbsp;which presents as a <strong>neurovisceral syndrome</strong> with <strong>no cutaneous manifestations and no phototoxicity.</strong></p>\n<p><strong>Acute Intermittent Porphyria:</strong></p>\n<ul>\n<li>Autosomal dominant</li>\n<li>Deficiency of the enzyme porphobilinogen deaminase</li>\n<li>Presents at post-pubertal age</li>\n<li>Present with hepatic and neurologic manifestations</li>\n<li>Exacerbated by P450 inducing drugs like phenytoin, progesterone and dietary restriction</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are reading an article titled, ' Dark age vampires or our patients', which describes an 18-year-old man who has had an intolerance to sunshine since the age of 6. When playing cricket he suffered intense burning, redness, swelling, and crusting of knees unprotected by shorts, with similar changes on cheeks and bridge of the nose. His labs showed elevated concentrations of total erythrocyte protoporphyrin. Which of the following enzyme deficiencies can explain this boy's condition?",
    "choices": [
      {
        "id": 1,
        "text": "\u03b4-Aminolevulinate synthase 2 (ALAS2)"
      },
      {
        "id": 2,
        "text": "\u03b4-Aminolevulinic acid dehydratase (ALAD)"
      },
      {
        "id": 3,
        "text": "Porphobilinogen deaminase (PBGD)"
      },
      {
        "id": 4,
        "text": "Ferrochelatase (FECH)"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Symptoms of<strong> cutaneous photosensitivity</strong> beginning in childhood and&nbsp;a substantially<strong> elevated concentration of total erythrocyte protoporphyrin</strong> supports a diagnosis of&nbsp;<strong>erythropoietic protoporphyria</strong>. The enzyme deficient in erythropoietic protoporphyria is <strong>ferrochelatase (FECH).</strong></p>\n<p>Symptoms consist of acute pain and itching often occurring within minutes of sunlight exposure and followed by redness and swelling with continued exposure. Swelling may resemble angioneurotic edema and <strong>solar urticaria.</strong> Symptoms are usually worse in&nbsp;the spring and summer. Chronic changes may include lichenification, leathery pseudovesicles, labial grooving, and nail changes, but changes in pigmentation and pronounced scarring are unusual.</p>\n<p>Life-threatening<strong> protoporphyric hepatopathy</strong> is characterized by greater increases in erythrocyte and plasma protoporphyrin levels, increased photosensitivity, and either chronically abnormal liver function tests or rapidly progressive hepatic failure.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 6-month-old baby boy has coarse facial features, cloudy corneas, and gingival hypertrophy. He has no neck control and is unable to roll over. Laboratory investigations reveal markedly reduced activity of N-acetylglucosaminyl-1-phosphotransferase activity in WBCs. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "I-cell disease"
      },
      {
        "id": 2,
        "text": "Galactosemia"
      },
      {
        "id": 3,
        "text": "Adrenoleukodystrophy"
      },
      {
        "id": 4,
        "text": "Hurler's syndrome"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This clinical vignette is strongly suggestive of&nbsp;<strong>I-cell disease</strong>&nbsp;or <strong>inclusion cell disease</strong>.&nbsp; It is also known as type&nbsp;II Mucolipidosis.</p>\n<p>It is an<strong> autosomal recessive</strong> inherited as a&nbsp;<strong>lysosomal storage disorder.</strong>&nbsp;It is&nbsp;caused due to a defect in <strong>N-acetylglucosaminyl-1-phosphotransferase</strong> required for the Golgi to phosphorylate mannose residues on glycoproteins. This leads to defective<strong>&nbsp;mannose-6-phosphate,&nbsp;</strong>an&nbsp;important cell signaling molecule&nbsp;required for<strong> trafficking of the lysosomal enzyme</strong> from the site of its production in the endoplasmic reticulum to the lysosome. Due to this defect, the lysosomal enzymes are secreted out of the cell and there is an increased serum concentration of the same. Intracellularly, there are abnormal inclusion bodies and vacuolizations, thus earning the disease its name.</p>\n<p>Clinically, these patients present with symptoms either at birth or early in life with growth retardation, failure to thrive, <strong>delay of developmental milestones, coarse facial features with a cloudy cornea and gingival hypertrophy,</strong> and other non-specific findings such as&nbsp;hip dislocations, inguinal hernias, hepatomegaly, joint limitation, and skin changes.&nbsp;</p>\n<p>Investigations to establish a diagnosis may include measuring&nbsp;N-acetylglucosaminyl-1-phosphotransferase activity in WBCs or in cultured fibroblasts and estimating <strong>serum levels of lysosomal enzymes.</strong></p>\n<p>Option B: <strong>Galactosemia</strong> is caused due to the&nbsp;<span data-preserver-spaces=\"true\">complete <strong>absence of g</strong></span><span data-preserver-spaces=\"true\"><strong>alactose-1-phosphate uridyl transferase</strong>.&nbsp;The deficiency of this enzyme leads to an inability to convert galactose-1-phosphate (galactose-1-P) to uridine diphosphate galactose. It is characterized by t</span><span data-preserver-spaces=\"true\">ypical clinical features such as jaundice, vomiting, hepatomegaly, failure to thrive, poor feeding, lethargy, diarrhea, E.Coli sepsis. Infants may also have edema,&nbsp;ascites, full fontanelle, encephalopathy, and excessive bruising and bleeding. They tend to develop cataracts due to the accumulation of&nbsp;galactitol.</span></p>\n<p>Option C:<strong>&nbsp;Adrenoleukodystrophy</strong>&nbsp;is an <strong>X-linked recessive disorder of &beta;-oxidation of fatty acids</strong>. There is a very large chain fatty acids buildup in the adrenal glands, the white matter of the brain, and testes. It is a progressive disease that can lead to <strong>adrenal gland crisis, coma, and death.</strong></p>\n<p>Option D:&nbsp;<strong>Hurler syndrome</strong> is an important diagnosis in a patient presenting with clinical features given in this clinical vignette. But it is&nbsp;a&nbsp;mucopolysaccharidosis type 1-H&nbsp;caused&nbsp;due by the defect in the&nbsp;&alpha;-L Iduronidase&nbsp;leading to the <strong>accumulation of&nbsp;heparin sulfate and dermatan sulfate.</strong>&nbsp;It is characterized by skeletal abnormalities, hepatosplenomegaly, and severe intellectual disability. Infants develop characteristic coarse facial features, a wide nasal bridge, and a flattened midface. Features such as hepatosplenomegaly,&nbsp;umbilical or inguinal hernias, and typical skeletal abnormalities, known as&nbsp;dysostosis multiplex laos&nbsp;are also seen. They also have developmental delays and recurrent sinopulmonary diseases. Failure to thrive and growth restriction are also seen.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An 8-year-old boy is brought with complaints of severe pain in his right thigh which has progressively worsened over the last few months. He is unable to walk because of the same. His mother also says he has had repeated nose bleeds in the last few months and the child has stopped playing with his friends as he gets easily tired for a month. Physical examination reveals hepatosplenomegaly. Lab reports show thrombocytopenia and anemia. An assay of peripheral blood leucocytes shows low levels of beta-glucosidase. What is the inheritance pattern of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "X-linked recessive"
      },
      {
        "id": 2,
        "text": "X-linked dominant"
      },
      {
        "id": 3,
        "text": "Autosomal recessive"
      },
      {
        "id": 4,
        "text": "Autosomal dominant"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario of bone pain, epistaxis, hepatosplenomegaly, and low levels of&nbsp;&beta;-glucosidase suggests a diagnosis of <strong>Gaucher's disease</strong> that is inherited in an <strong>autosomal recessive</strong> pattern.</p>\n<p>Gaucher's disease:</p>\n<ul>\n<li>It is an inborn error of metabolism&nbsp;due to the <strong>deficiency</strong> of the enzyme&nbsp;<strong>glucocerebrosidase (&beta;-glucosidase)</strong>&nbsp;that leads to the accumulation of glucocerebroside in the lysosomes of cells.</li>\n<li>It is the&nbsp;<strong>most common lysosomal storage disorder.&nbsp;</strong></li>\n<li>The clinical features result from the accumulation of lipid-laden macrophages in the spleen, liver, bone marrow, bone, and other tissues.</li>\n<li>There are 3 clinical subtypes, delineated by the absence or presence and progression of neurologic manifestations:&nbsp;<strong>type 1, or the adult, nonneuronopathic</strong>&nbsp;form;<strong>&nbsp;type 2, the infantile or acute neuronopathic form</strong>; and type 3, the juvenile or subacute neuronopathic form</li>\n<li>Typical clinical features include&nbsp;<strong>delayed puberty</strong>, painless hepatomegaly and&nbsp;<strong>splenomegaly</strong>, liver cirrhosis, hypersplenism and pancytopenia,<strong> bleeding tendencies, bone pain</strong> due to&nbsp;<strong>avascular necrosis</strong>, osteoporosis, pathological fractures.</li>\n<li>Neurological symptoms such as developmental delay, hypertonia, strabismus, supranuclear gaze palsy (seen in type 3).</li>\n<li>Bone marrow examination usually reveals the presence of&nbsp;<strong>Gaucher cells</strong>&nbsp;(have a characteristic&nbsp;<strong>wrinkled-paper appearance</strong>)</li>\n<li>Enzyme replacement therapy for Gaucher's disease:<strong>&nbsp;<em>imiglucerase</em>,&nbsp;<em>velaglucerase alfa,&nbsp;</em><em>taliglucerase alfa,</em><em>eliglusta</em>t&nbsp;</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 6-month-old infant with progressive failure to thrive and milestone regression is being evaluated for an inborn error of metabolism. On examination, hypotonia, apathy, deafness, hepatosplenomegaly, and generalized lymphadenopathy are present. Fundus examination is shown below. A liver biopsy shows foamy hepatocytes loaded with sphingomyelin. Electron microscopy reveals zebra bodies. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Niemann-Pick disease type A"
      },
      {
        "id": 2,
        "text": "Tay-Sach disease"
      },
      {
        "id": 3,
        "text": "Niemann-Pick disease type B"
      },
      {
        "id": 4,
        "text": "Sandhoff's disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical vignette along with the <strong>cherry-red spot</strong> on fundus examination suggests a diagnosis of<strong> Niemann-Pick disease type A- </strong>Lysosomal storage disorder due to an inherited <strong>deficiency of sphingomyelinase</strong></p>\n<p><strong>Type A</strong> is a severe<strong> infantile</strong> form with <strong>extensive neurologic involvement&nbsp;</strong>(hypotonia, milestone regression, apathy),<strong> marked visceral accumulations of sphingomyelin</strong> (hepatosplenomegaly, foamy hepatocytes, <strong>zebra bodies</strong> on EM), and<strong> progressive wasting and early death</strong> within the first 3 years of life.</p>\n<p>In contrast, patients with<strong> Niemann-Pick disease&nbsp;type B</strong> have organomegaly but generally <strong>no CNS involvement.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/58da6f5d165841efaef15a5c18363278.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A male child with coarse facies, macroglossia, thick lips with hepatosplenomegaly presents with copious mucous discharge from the nose. The most probable underlying diagnosis is ________",
    "choices": [
      {
        "id": 1,
        "text": "Hurler disease"
      },
      {
        "id": 2,
        "text": "Beckwith-Wiedemann syndrome"
      },
      {
        "id": 3,
        "text": "Proteus Syndrome"
      },
      {
        "id": 4,
        "text": "Hypothyroidism"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Other options:</p>\n<p>Option B: <strong>Beckwith-Wiedemann</strong> syndrome is an overgrowth syndrome characterized by <strong>macrosomia</strong>, <strong>macroglossia</strong>,<strong> hemihypertrophy</strong>, <strong>omphalocele</strong>, and renal anomalies. It is associated with an increased risk of <strong>Wilms tumor</strong>, hepatoblastoma, rhabdomyosarcoma, neuroblastoma, and adrenal cortical carcinoma.</p>\n<p>Option C: <strong>Proteus syndrome</strong> is a disturbance of cellular growth involving ectodermal and mesodermal tissues, caused by mutation in the AKT1 gene. They present with <strong>hemimegalencephaly</strong>, asymmetric <strong>overgrowth of the extremities</strong>, verrucous cutaneous lesions, thickening of the bone, and excessive growth of muscles.</p>\n<p>Option D: A child with untreated <strong>congenital hypothyroidism</strong> may have stunted growth, short extremities, narrow palpebral fissures, swollen eyelids, depressed nasal bridge, thick broad protruded tongue, and short and thick neck, dry and scaly skin.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/bc2784866d7a414fad4a7a7c99f36f1dx720x1757.JPEG"
    ]
  },
  {
    "text": "A case series reviews children with lysosomal storage disorders who usually present with dysmorphic facies, organomegaly, milestones regression, and failure to thrive. Which of the following disorders does not have enzyme replacement therapy as a therapeutic option?",
    "choices": [
      {
        "id": 1,
        "text": "Gaucher's disease"
      },
      {
        "id": 2,
        "text": "Pompe disease"
      },
      {
        "id": 3,
        "text": "Sanfilippo syndrome"
      },
      {
        "id": 4,
        "text": "Fabry's disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Enzyme replacement therapy is not available for&nbsp;Sanfilippo syndrome (MPS type III).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-month-old female child was brought to the clinic with a history of failure to thrive. On examination,  generalized hypotonia and hepatomegaly were present. A chest X-ray image shows massive cardiomegaly. A muscle biopsy is performed and the findings are attached in the image below. Which of the following is the most likely enzyme that is involved in the suspected condition?",
    "choices": [
      {
        "id": 1,
        "text": "Glucose-6-phosphatase"
      },
      {
        "id": 2,
        "text": "Lysosomal acid alpha-glucosidase"
      },
      {
        "id": 3,
        "text": "Muscle glycogen phosphorylase"
      },
      {
        "id": 4,
        "text": "Glycogen debranching enzyme"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The muscle biopsy shows the presence of <strong>large vacuoles</strong>. This along with the clinical vignette is strongly suggestive of <strong>Pompe's disease</strong> or type II glycogen storage disease.&nbsp;It&nbsp;is caused due to the deficiency of the enzyme<strong>&nbsp;lysosomal acid alpha-glucosidase.</strong></p>\n<p>Clinically, the child presents with <strong>hypotonia,</strong><strong>&nbsp;hepatomegaly, hypertrophic cardiomyopathy.</strong>&nbsp;The affected child usually dies around the age of 2 years due to heart failure.</p>\n<p>Investigations include&nbsp;chest X-ray imaging which shows<strong> cardiomegaly.&nbsp;</strong>The muscle biopsy showing vacuoles further aids the diagnosis.&nbsp;</p>\n<p>Treatment includes&nbsp;enzyme replacement therapy with recombinant enzyme <strong>a-glucosidase alfa</strong> (Myozyme).</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/37985bd17c3148b5892954d3940663fe.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 6-month-old is brought by his parents with a history of decreased weight gain. On examination, you find that the baby has hepatosplenomegaly, muscle weakness and atrophy, hypotonia, and decreased deep tendon reflexes. Blood tests reveal normal glucose levels. Biopsy of the liver reveals initial stages of cirrhosis due to the accumulation of abnormal glycogen with few branch points, whose structure resembles amylopectin. The clinical and laboratory results are indicative of which glycogen storage disease?",
    "choices": [
      {
        "id": 1,
        "text": "Von Gierke disease"
      },
      {
        "id": 2,
        "text": "Andersen disease"
      },
      {
        "id": 3,
        "text": "McArdle disease"
      },
      {
        "id": 4,
        "text": "Tarui disease"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical and laboratory features indicate <strong>Andersen's disease</strong> in the baby. Inability to gain weight, hepatosplenomegaly, muscle weakness, and accumulation of abnormal glycogen resembling amylopectin point towards the diagnosis.</p>\n<p><strong>Andersen's disease</strong> is type IV glycogen storage disease. It is transmitted in an <strong>autosomal recessive</strong> pattern and occurs due to a deficiency of&nbsp;<strong>glycogen branching enzyme </strong>because of pathologic variants in the GBE1 gene. This leads to accumulation of of an abnormal structure of glycogen known as <strong>polyglucosan</strong>.&nbsp; It is characterized by</p>\n<ul>\n<li>Growth delay</li>\n<li>Hepatomegaly due to the accumulation of polysaccharides with few branch points</li>\n<li>Myopathy</li>\n<li>There might be fasting intolerance and ketosis in the initial stages. Hypoglycemia usually appears late in the disease when it is associated with cirrhosis, esophageal varices, and ascites.<span class=\"Apple-converted-space\">&nbsp;</span></li>\n<li><strong>Biopsy of the liver</strong> will show the presence of abnormal glycogen which resembles <strong>amylopectin</strong>. Amylopectin is found in plants and has very few branches. Since there is a defect in the branching of the glycogen, the abnormal glycogen appears like amylopectin.</li>\n</ul>\n<p class=\"p2\">The diagnosis is confirmed by absent branching enzyme activity in skin fibroblasts, muscle, or liver and analysis of the DNA mutation.</p>\n<p><strong>Von Gierke's disease&nbsp;</strong>(Option A)&nbsp;has features of lactic acidosis, hypoglycemia, hyperuricemia, impaired growth, and bone thinning. It occurs due to a defect in the glucose 6-phosphatase.</p>\n<p><strong>McArdle disease</strong> (Option C) usually manifests as&nbsp;exercise intolerance, muscle cramping with exercise. It is usually a benign chronic condition. It occurs due to a defect in the muscle glycogen phosphorylase.</p>\n<p><strong>Tarui disease</strong> (Option D)&nbsp;also presents similar to the McArdle disease. Patients may have developmental delay, and hemolytic anemia in addition to exercise-induced muscle cramps.&nbsp;It occurs due to a defect in the <strong>muscle phosphofructokinase</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 6-year-old boy develops hypoglycemia and muscle weakness with moderate activity. On examination, he had hepatomegaly and growth restriction. Investigations revealed the accumulation of limit dextrins and increased glycogen deposits in the liver. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cori's disease"
      },
      {
        "id": 2,
        "text": "von Gierke's disease"
      },
      {
        "id": 3,
        "text": "Anderson's disease"
      },
      {
        "id": 4,
        "text": "Pompe's disease"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The most likely diagnosis is<strong> Cori disease.</strong></p>\n<p>Glycogen debrancher deficiency (Glycogen Storage Disease III) is also known as <strong>Cori disease</strong>, Forbes disease, and<strong> limit dextrinosis.</strong></p>\n<p>Cori&rsquo;s disease may be clinically indistinguishable from von Gierke&rsquo;s disease in infancy and childhood as hypoglycemia, hepatomegaly, hyperlipidemia, and growth retardation is common. Accumulation of limit dextrins is unique to Cori's disease. <strong>Definitive diagnosis</strong> is through <strong>enzyme assays</strong> in the liver, muscle, or both.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 5-day-old neonate is brought to the emergency room with vomiting and poor feeding. Breastfeeding was initiated soon after birth. On examination, the child is lethargic and has hepatomegaly. Labs reveal increased plasma galactose and increased urine galactitol levels. Examination of the mother shows the presence of skin lesions on the breast with the histopathological appearance showing characteristic 'Cowdry Type A' inclusions as shown below. Choose the correct statements from those below:",
    "choices": [
      {
        "id": 1,
        "text": "2 and 4 are correct"
      },
      {
        "id": 2,
        "text": "1, 3, and 5 are correct"
      },
      {
        "id": 3,
        "text": "2 and 5 are correct"
      },
      {
        "id": 4,
        "text": "1,3, and 4 are correct"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical complex describes a case of <strong>classic galactosemia in the infant</strong> (increased plasma galactose and urine galactitol levels) and <strong>herpes simplex of the breast in the mother</strong> (histopathology shown in the image has large multinucleate virus-infected cells with typical&nbsp;eosinophilic Cowdry Type A inclusions).</p>\n<p><strong>Galactosemia</strong> is an<strong> absolute contraindication</strong> to breastfeeding and the child is at risk for E.coli sepsis. <strong>Herpes lesions on the breast</strong> are a<strong> relative contraindication</strong> to <strong>breastfeeding</strong> and she is at risk for recurrence.&nbsp;</p>\n<p><strong>&nbsp;Deficiency</strong> of <strong>galactose-1-uridyltransferase</strong> leads to the accumulation of galactose-1-phosphate and galactitol causes <strong>classic galactosemia.</strong></p>\n<p>Infants show vomiting, diarrhea, and poor weight gain <strong>within 3-4 days of breastfeeding.</strong><strong>Jaundice</strong> and liver dysfunction appear in the first or second week of life.&nbsp;Untreated children may show nuclear cataracts (<strong>oil-droplet cataract</strong>), vitreous hemorrhage, hepatic failure, cirrhosis, ascites, splenomegaly, or intellectual disability.&nbsp;<strong>The proximal renal tubular disease</strong> may also manifest as metabolic acidosis, galactosuria, glucosuria, and aminoaciduria. The most common cause of death is <strong>E.coli sepsis.</strong>Acute galactose toxicity is manifested by neurological symptoms</p>\n<p>Diagnosis is made by genetic or mutational analysis. There will the presence of reducing substances in the urine.&nbsp;<strong>Elimination of galactose</strong> from the diet along with adequate calcium supplementation <strong>reverses growth failure and renal and hepatic dysfunction.</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0937ef61b0a44a9a9a9c6dd3bdcdcd28.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A father has noticed that whenever his daughter drinks fruit juice she has multiple episodes of vomiting. He reports to you that his daughter is allergic to fruit juice. Which of the following enzyme deficiency is likely?",
    "choices": [
      {
        "id": 1,
        "text": "Aldolase B"
      },
      {
        "id": 2,
        "text": "Fructokinase"
      },
      {
        "id": 3,
        "text": "Glucose 6-phosphatase"
      },
      {
        "id": 4,
        "text": "Hexokinase"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Aldolase B</strong> deficiency is likely in this child.</p>\n<p>In the given case scenario, the child becomes symptomatic after ingesting fruit juice that contains fructose; this indicates that she has <strong>hereditary fructose intolerance, which is caused by the deficiency of aldolase B.</strong></p>\n<p><strong>Deficiency of fructose-1,6- bisphosphate aldolase (Aldolase B hereditary fructose intolerance):&nbsp;</strong><strong>Fructose aldolase B </strong>is&nbsp;present in the liver, kidney, and intestine. It catalyzes the hydrolysis of fructose-1,6-bisphosphate into triose phosphate and glyceraldehyde phosphate.</p>\n<p>Clinical features: Patients are asymptomatic until fructose or sucrose&nbsp;is ingested (usually from fruit, fruit juice, sweetened cereal, or table sugar). Clinical features include&nbsp;jaundice, hepatomegaly, vomiting, lethargy, irritability,&nbsp;and convulsions. It resembles galactosemia. Acute ingestion causes symptomatic hypoglycemia. Chronic intake results in failure to thrive and hepatic disease. The persistence of fructose intake can lead to liver failure, kidney failure,&nbsp;and death.</p>\n<p>Diagnosis:<strong> Reducing substance</strong> is seen in the <strong>urine</strong> during an episode (<strong>Benedict's test +</strong>). An assay&nbsp;of <strong>fructaldolase B activity in the liver</strong> gives a <strong>definitive diagnosis.</strong></p>\n<p>Treatment: Complete elimination of all sources of sucrose, fructose, and sorbitol from the diet. With age, symptoms become milder even after fructose ingestion. The long-term prognosis is good.</p>\n<p><strong>Note:</strong></p>\n<p><strong>The deficiency of fructokinase</strong> is not associated with any clinical manifestations. Fructosuria is an<strong> accidental finding</strong> usually made because the<strong> asymptomatic</strong> patient's urine contains a reducing substance. No treatment is necessary, and the<strong> prognosis is excellent.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "\"Tomcat urine\"  is characteristically seen in ________",
    "choices": [
      {
        "id": 1,
        "text": "Tyrosinemia"
      },
      {
        "id": 2,
        "text": "Multiple carboxylase deficiency"
      },
      {
        "id": 3,
        "text": "Phenylketonuria"
      },
      {
        "id": 4,
        "text": "Trimethylaminuria"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Tomcat urine</strong> is characteristically seen in<strong> multiple carboxylase deficiency</strong>.</p>\n<p>It is named so because of its <strong>peculiar odour.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The enzyme deficient in hereditary coproporphyria is ________",
    "choices": [
      {
        "id": 1,
        "text": "Coproporphyrinogen oxidase (CPOX)"
      },
      {
        "id": 2,
        "text": "Protoporphyrinogen oxidase (PPOX)"
      },
      {
        "id": 3,
        "text": "Porphobilinogen deaminase (PBGD)"
      },
      {
        "id": 4,
        "text": "Ferrochelatase (FECH)"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The enzyme deficient in hereditary coproporphyria is coproporphyrinogen oxidase (CPOX).</p>\n<p><strong>Hereditary coproporphyria (HCP):</strong></p>\n<ul>\n<li>Autosomal-dominant hepatic porphyria is caused by the<strong>&nbsp;deficiency of CPOX. </strong></li>\n<li>Acute attacks of HCP are treated as in acute intermittent porphyria (AIP), which includes intravenous hemin and identifying and avoiding precipitating factors. Cholestyramine may be of some value for photosensitivity occurring with liver dysfunction.</li>\n<li>Gonadotropin-releasing hormone analogs can be effective for the prevention of cyclic attacks.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Deficiency of the enzyme porphobilinogen deaminase causes _____________",
    "choices": [
      {
        "id": 1,
        "text": "Porphyria cutanea tarda"
      },
      {
        "id": 2,
        "text": "Acute intermittent porphyria"
      },
      {
        "id": 3,
        "text": "Variegate porphyria"
      },
      {
        "id": 4,
        "text": "X-Linked protoporphyria"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Deficiency of the enzyme <strong>porphobilinogen deaminase</strong> causes <strong>acute intermittent porphyria</strong>.</p>\n<p>Other options:</p>\n<ul>\n<li>Porphyria cutanea tarda: Deficiency of Uroporphyrinogen decarboxylase (UROD)</li>\n<li>Variegate porphyria: Deficiency of Protoporphyrinogen oxidase (PPOX)</li>\n<li>&nbsp;X-Linked protoporphyria: Gain of function mutation of &delta;-aminolevulinate synthase 2 (ALAS2)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A mother who is a hairstylist has noted that her baby's hair looks dull, breaks off easily, and is tufted. She brings the child to you and informs you about the past history of seizures. Investigations reveal elevated plasma ammonia levels and argininosuccinate levels. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Argininemia"
      },
      {
        "id": 2,
        "text": "Argininosuccinic aciduria"
      },
      {
        "id": 3,
        "text": "Hyperammonemia type 1"
      },
      {
        "id": 4,
        "text": "Hyperammonemia type 2"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The most likely diagnosis is <strong>argininosuccinic aciduria</strong> due to <strong>argininosuccinate lyase</strong> deficiency.</p>\n<p>It is accompanied by high levels of argininosuccinate levels in blood, CSF, and urine. It is also associated with friable, tufted hair known as <strong>trichorrhexis nodosa.</strong></p>\n<p>Image showing Trichorrhexis nodosa:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dc7d409a3d8b4a09bbd932eed8f68b73x444x483.JPEG"
    ]
  },
  {
    "text": "Accumulation of ______ takes place in Farber\u2019s disease.",
    "choices": [
      {
        "id": 1,
        "text": "Lecithin"
      },
      {
        "id": 2,
        "text": "Ceramide"
      },
      {
        "id": 3,
        "text": "Sphingomyelin"
      },
      {
        "id": 4,
        "text": "Sulfatides"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Accumulation of Ceramide</strong> is seen in <strong>Farber&rsquo;s disease </strong>due to<strong>&nbsp;ceramidase deficiency.</strong></p>\n<p><strong>&nbsp;</strong>Clinical features of Farber&rsquo;s disease :</p>\n<ul>\n<li>Painful joint swelling, nodules, progressive joint deformity</li>\n<li>Hoarse cry</li>\n<li>Breathing difficulty</li>\n<li>Failure to thrive</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '15 Metabolic Disorders Of Urea Cycle, Complex Molecules, And Carbohydrates';
        let hierarchy = ["Marrow", "qBank", "Pediatrics"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>