<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Cycles Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "What is the preferred drug for the treatment of an infection caused by the organism whose life cycle is given below?",
    "choices": [
      {
        "id": 1,
        "text": "Ivermectin"
      },
      {
        "id": 2,
        "text": "Praziquantel"
      },
      {
        "id": 3,
        "text": "Albendazole"
      },
      {
        "id": 4,
        "text": "Diethylcarbamazine"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given life cycle of a rhabditiform larva being infective to man via penetration of skin along with the autoinfection cycle is suggestive of <strong><em>Strongyloides stercoralis</em></strong>. The <strong>preferred drug</strong> for the treatment of an infection by Strongyloides stercoralis is <strong>Ivermectin</strong>.</p>\n<p><strong>Ivermectin</strong> given <strong>orally </strong>for 2 days is considered the <strong>treatment of choice</strong> for human strongyloidiasis. <strong>Extended treatment</strong> for at least <strong>14 days</strong> or at least a week after parasites have been eradicated is required<strong> in</strong> case of <strong>disseminated</strong> <strong>strongyloidiasis</strong>.</p>\n<p><strong><em>Strongyloides stercoralis</em></strong> has a <strong>parasitic cycle</strong> <strong>and</strong> a <strong>free-living cycle </strong>in soil. <strong>Humans</strong> are the <strong>natural host</strong> but morphologically indistinguishable strains may be seen in dogs and cats. <strong>Filariform larvae</strong> are the <strong>infective form</strong> and there are <strong>two modes</strong> of <strong>infection</strong>: <strong>penetration of </strong>the <strong>skin</strong> by 3<sup>rd\u00a0</sup>stage filariform larva, and <strong>autoinfection</strong> (external and internal).</p>\n<p>The <strong>female worms</strong> present in the intestine <strong>lay eggs in</strong> the <strong>mucosa</strong> which <strong>hatches immediately</strong>, releasing the <strong>rhabditiform larva</strong>. The <strong>larva</strong> migrates into the lumen of the intestine and passes down to be <strong>released in</strong> the <strong>feces</strong>. The rhabditiform larva <strong>may change into</strong> a <strong>filariform larva</strong> while passing through the bowel.</p>\n<p>The <strong>filariform larvae</strong> in the bowel do not leave the host and <strong>become</strong> a <strong>source of autoinfection</strong> as they <strong>penetrate</strong> the <strong>colonic mucosa</strong> or <strong>perianal skin</strong>. The <strong>rhabditiform larvae passed in</strong> the <strong>feces</strong> may undergo two types of development in the soil:</p>\n<ol>\n<li><strong>Direct development</strong>: The rhabditiform larva molts twice on reaching the soil to become the infective filariform larva. The filariform larva can penetrate the skin and enter the circulation.</li>\n<li><strong>Indirect development</strong>: The rhabditiform larvae develop into free-living males and females in the soil.</li>\n</ol>\n<p>Other options:</p>\n<p>Option B: <strong>Praziquantel</strong> is the <strong>drug of choice</strong> for the treatment of infections caused by <strong>trematodes</strong> like Schistosoma, Clonorchis, Opisthorchis, Fasciolopis, Paragonimus, and <strong>cestodes</strong> like Hymenolepis, Diphyllobothrium, and Taenia.</p>\n<p>Option C: A 3-day course of <strong>Albendazole</strong> (400 mg daily) <strong>can be used for</strong> the treatment of <strong>strongyloidiasis</strong> <strong>but</strong> is <strong>less efficacious</strong> than Ivermectin. Albendazole is the <strong>drug of choice for</strong> infections caused by <strong>nematodes</strong> like Ascaris and Trichura, and in cases of <strong>neurocysticercosis</strong> caused by larval forms of Taenia solium, a cestode.</p>\n<p>Option D: <strong>Diethylcarbamazine</strong> is used in the treatment of <strong>lymphatic filariasis</strong> and <strong>loasis</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8df497cfa199463eaa2e14905c69b216.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The life cycle of a parasite is given below. Which of the following is true regarding the eggs produced by this parasite?",
    "choices": [
      {
        "id": 1,
        "text": "Non-bile stained, does not float in saturated salt solution"
      },
      {
        "id": 2,
        "text": "Bile stained, floats in saturated salt solution"
      },
      {
        "id": 3,
        "text": "Non-bile stained, floats in saturated salt solution"
      },
      {
        "id": 4,
        "text": "Bile stained, does not float in saturated salt solution"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given image depicts the life cycle of <em>Hymenolepis nana</em>. The eggs of <em>H.nana</em> are non-bile stained and float in the saturated salt solution.</p>\n<p>The eggs of <em>Hymenolepis nana</em> are about 30-40 \u03bcm in size and roughly <strong>spherical or ovoid</strong> in shape. It is covered by a thin colorless outer membrane with the <strong>hexacanth oncosphere</strong> enclosed inside the inner embryophore. <strong>Yolk granules</strong> and 4-8 thread-like <strong>polar filaments</strong>, arising from two knobs on the embryophore, are present in the space between the two membranes.</p>\n<p>The eggs are <strong>non-bile stained</strong> and <strong>float</strong> in the <strong>saturated salt solution</strong>. The eggs cannot survive for more than 10 days in the external environment and are <strong>immediately infective</strong> after release. <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">The image given below shows the egg of\u00a0</span><em style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Hymenolepis nana.</em></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e7eed94ee8264d259c666b75bbb0c128.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/68045b29110f4eefbbb5f9cb050f2259x600x587.JPEG"
    ]
  },
  {
    "text": "What is the most common cancer associated with the organism whose life cycle is given below?",
    "choices": [
      {
        "id": 1,
        "text": "Gastric carcinoma"
      },
      {
        "id": 2,
        "text": "Bladder carcinoma"
      },
      {
        "id": 3,
        "text": "Cholangiocarcinoma"
      },
      {
        "id": 4,
        "text": "Hepatocellular carcinoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given life cycle with free-swimming cercariae in water and metacercariae in the flesh of freshwater fish is suggestive of liver flukes- either Clonorchis or Opisthorchis. <strong>Both</strong> <em><strong>Clonorchis sinensis</strong></em> and <strong><em>Opisthorchis viverrini</em></strong> are associated with an increased risk for <strong>cholangiocarcinoma, </strong>in China and Thailand respectively.</p>\n<p>Clonorchis, also known as Chinese or Oriental liver fluke, is known to cause disease in Japan, Korea, Taiwan, China, and Vietnam. Similarly, infection with Opisthorchis viverrini is commonly seen in Thailand.&nbsp;</p>\n<p>Both Clonorchis and Opisthorchis have the same life cycle. Humans are infected by eating<strong> raw or undercooked fish </strong>containing <strong>encysted larvae </strong>(metacercariae). The immature flukes after excystation in the duodenum enter the <strong>biliary ducts</strong> and differentiate into adults.</p>\n<p>The hermaphroditic adults produce eggs that are excreted in the feces. Upon reaching freshwater the eggs are ingested by <strong>snails,</strong> which are the <strong>first intermediate hosts.</strong> The eggs hatch within the gut and differentiate first into larvae (sporocyst and redia stages) and then into many free-swimming cercariae. Cercariae encyst to form metacercariae under the scales of certain <strong>freshwater fish (second intermediate host)</strong> which are then ingested by humans.</p>\n<p>In humans, the metacercariae excyst in the duodenum and the adolescaria travel to the <strong>common bile duct</strong> and then to the <strong>distal bile capillaries</strong> where they transform into adult worms.&nbsp;The adult worms can cause obstruction of the common bile duct and lead to cholangitis. Most people are <strong>asymptomatic</strong>. Others may show fever, epigastric pain, jaundice, and progressive liver enlargement.&nbsp;</p>\n<p>Stool microscopy demonstrates <strong>eggs</strong> that <strong>do not float </strong>in<strong> </strong>saturated saline. <strong>Praziquantel</strong> is the <strong>drug of choice</strong> for the treatment of this condition.</p>\n<p>Other options:</p>\n<p>Option A. <strong>Gastric</strong>&nbsp;carcinoma -&nbsp;<em><strong>Helicobacter pylori</strong></em>&nbsp;infection is a major risk factor for the development of gastric carcinoma.</p>\n<p>Option B. <strong>Bladder</strong>&nbsp;carcinoma - The vesical blood fluke&nbsp;<em><strong>Schistosoma haematobium</strong></em>&nbsp;primarily infects the urinary bladder and increases the risk of squamous cell carcinoma of the bladder.</p>\n<p>Option D. <strong>Hepatocellular carcinoma</strong>&nbsp;is associated with&nbsp;<strong>hepatitis B/C</strong> infection.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/099aae56736e4378bfccbde3db7e6213.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 23-year-old female presents with painless haematuria. She has a travel history to Egypt a few weeks back. Urine microscopy revealed the following structure. Which of the following stage is not seen in the life cycle of the causative organism?",
    "choices": [
      {
        "id": 1,
        "text": "2 only"
      },
      {
        "id": 2,
        "text": "4 only"
      },
      {
        "id": 3,
        "text": "2 and 4"
      },
      {
        "id": 4,
        "text": "2 and 3"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Eggs with a<strong>&nbsp;terminal spine</strong> and a history of <strong>painless hematuria</strong> are suggestive of infection with&nbsp;<strong>Schistosoma haematobium.&nbsp;</strong>Metacercaria and redia stages are <strong>not seen</strong> in schistosomes.&nbsp; Metacercaria and redia are seen in trematodes&nbsp;such as&nbsp;Fasciola hepatica, Fasciola buski, Clonorchis sinensis.</p>\n<p>Schistosoma haematobium is characterized by <strong>ovoid non-operculated</strong> eggs with a brownish-yellow transparent shell and a characteristic <strong>terminal spine</strong> at one of the poles.</p>\n<p>Schistosoma haematobium primarily causes<strong> genito-urinary schistosomiasis.&nbsp;</strong>The adult worms live in the<strong>&nbsp;veins of the urinary bladder.</strong></p>\n<p><strong> Cercaria larva</strong> are the infective form of schistosomes.&nbsp;<span class=\"s5\">Cercaria infects man by penetrating the skin which can lead to&nbsp;intense irritation and skin rash at the site of cercarial penetration (known as <strong>swimmer's itch</strong>).</span></p>\n<p><span class=\"s1\">After penetrating the skin, the cercariae lose their tails and become schistosomulae which travel through peripheral venules to the systemic circulation, to the inferior mesenteric veins, finally reaching the <strong>vesical </strong>and<strong> pelvic venous plexuses</strong>, where they <strong>mature</strong> and&nbsp;lay eggs. T</span><span class=\"s2\">h</span>e <span class=\"s3\">eg</span><span class=\"s1\">g</span><span class=\"s3\">s </span><span class=\"s4\">that </span>are <span class=\"s4\">pa</span>ssed <span class=\"s4\">in u</span>r<span class=\"s4\">in</span>e a<span class=\"s4\">r</span>e em<span class=\"s4\">br</span>yonated and&nbsp;<span class=\"s5\">h</span><span class=\"s4\">at</span><span class=\"s6\">c</span><span class=\"s4\">h in </span>water under <span class=\"s6\">su</span><span class=\"s4\">i</span><span class=\"s6\">table </span><span class=\"s3\">co</span>nd<span class=\"s2\">iti</span>on<span class=\"s3\">s </span>to <span class=\"s2\">r</span><span class=\"s6\">e</span><span class=\"s4\">l</span><span class=\"s6\">ease </span><span class=\"s4\">th</span><span class=\"s3\">e&nbsp;</span><span class=\"s4\">fr</span>ee-<span class=\"s7\">l</span><span class=\"s4\">i</span>vi<span class=\"s4\">n</span>g <span class=\"s3\">cil</span><span class=\"s1\">iated </span>mirac<span class=\"s4\">i</span>dia.</p>\n<p><strong>Miracidia</strong> penetrates into the tissues of the <strong>snail</strong> and reaches its liver. Inside the snail, first and second-generation <strong>sporocyst </strong>stages are seen. La<span class=\"s1\">r</span>ge <span class=\"s2\">numb</span><span class=\"s3\">ers </span>of <strong><span class=\"s3\">cercar</span><span class=\"s2\">ia</span><span class=\"s3\">e </span></strong>a<span class=\"s1\">r</span><span class=\"s3\">e </span><span class=\"s2\">produ</span><span class=\"s3\">ce</span><span class=\"s2\">d </span>by asexual repro<span class=\"s4\">du</span><span class=\"s3\">c</span><span class=\"s1\">ti</span><span class=\"s5\">on within the second-generation sporocysts and are released into the water. </span>Metacercaria and redia stages are <strong>not seen</strong> in schistosomes.</p>\n<p><strong>Praziquantel</strong>&nbsp;is the drug of choice for schistosomiasis.</p>\n<p>The following are the unique features distinguishing schistosomes from other trematodes:</p>\n<ul>\n<li><strong>Only one intermediate host</strong></li>\n<li>They produce <strong>non- operculated eggs.</strong></li>\n<li>They have <strong>no redia stage</strong> in larval development</li>\n<li>Mode of infection is by&nbsp;<strong>penetration of intact skin</strong> with the help of forked tails of cercariae</li>\n</ul>\n<p><strong>NOTE:&nbsp;</strong></p>\n<p>Infective forms of most trematodes (Eg. Fasciola hepatica, Fasciola buski, Clonorchis sinensis) to humans&nbsp;are metacercaria larva.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/90ca29fa77d041c287a26e3a6aafd17f.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9733dc5592e44d02901fae1aee3ae537x624x528.JPEG"
    ]
  },
  {
    "text": "The image given below depicts the life cycle of _______.",
    "choices": [
      {
        "id": 1,
        "text": "Ascaris lumbricoides"
      },
      {
        "id": 2,
        "text": "Paragonimus westermani"
      },
      {
        "id": 3,
        "text": "Fasciola hepatica"
      },
      {
        "id": 4,
        "text": "Brugia malayi"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image given above depicts the life cycle of <strong><em>Ascaris lumbricoides</em>.</strong></p>\n<p>It is an<strong> intestinal nematode </strong>that causes&nbsp;<strong>ascariasis.&nbsp;</strong>Infection&nbsp;occurs through food or water contaminated with nightsoil or human faeces having eggs of <em>Ascaris</em> that contain the <strong>infective&nbsp;rhabditiform larva</strong>. <strong>Man </strong>is the<strong> only&nbsp;natural host. </strong>There is <strong>no intermediate host.</strong></p>\n<p>The life cycle is as follows:</p>\n<ul>\n<li>Adult worms live in the lumen of the small intestine. A female produces eggs which are passed with the faeces.&nbsp;</li>\n<li>Unfertilized eggs may be ingested but are not infective.</li>\n<li><strong>Larvae</strong> develop <strong>infectivity</strong> within fertile eggs in 10-40 days. It depends on the environmental conditions (optimum: moist, warm, shaded soil).</li>\n<li>After infective eggs are swallowed, the larvae hatch.</li>\n<li>The larvae invade the intestinal mucosa and are carried through the portal system, then systemic circulation to the lungs.</li>\n<li>The larvae <strong>mature</strong> further in the <strong>lungs</strong> (10 to 14 days), penetrate the alveolar walls, ascend the bronchial tree to the throat, and are swallowed.</li>\n<li>Upon reaching the small intestine, they develop into adult worms. Between 2 and 3 months are required from ingestion of the infective eggs to oviposition by the adult female. Adult worms can live for 1 to 2 years.</li>\n</ul>\n<p><strong>Adult worms</strong> can be occasionally detected in the&nbsp;stool or sputum of the patient. A <strong>definitive diagnosis</strong> is made by <strong>demonstration of eggs in faeces</strong>. Fertilized eggs are <strong>always bile stained</strong>.&nbsp;</p>\n<p>Effective and safe drugs for the treatment of ascariasis are Pyrantel pamoate 11 mg/kg once, Albendazole 400 mg once, Mebendazole 100 mg twice daily for 3 days, Ivermectin 150-200 mcg/kg once.</p>\n<p>The image below shows the life cycle of <strong><em>Ascaris lumbricoides</em>:&nbsp;</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5bb1843928a7429c869d9964ee2ebe50.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c4d64784691e4c5089b91e19d5158347x965x886.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f6a840f7261f4b29b43c096320075246x519x435.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fff369912ec649c296a3296acdb7cc54x568x435.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a1eb8354b0d74fedaa354fcf5626f9f1x496x416.GIF"
    ]
  },
  {
    "text": "A patient presents with fatigue,  breathlessness, paresthesias, and a  stomping gait. The peripheral blood smear shows a megaloblastic picture. The lifecycle of the causative organism is shown below. Which of the following can be responsible for this deficiency?",
    "choices": [
      {
        "id": 1,
        "text": "Beef tapeworm"
      },
      {
        "id": 2,
        "text": "Pork tapeworm"
      },
      {
        "id": 3,
        "text": "Dwarf tapeworm"
      },
      {
        "id": 4,
        "text": "Broad tapeworm"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above clinical picture is suggestive of <strong>Vitamin B12 deficiency</strong> which can be caused by the&nbsp;<strong>broad or fish tapeworm</strong> -&nbsp;<em><strong>Diphyllobothrium</strong> </em><strong><em>latum</em>. </strong></p>\n<p><em>Diphyllobothrium latum</em><strong>&nbsp;</strong>infection usually&nbsp;causes vitamin B12 deficiency&nbsp;by absorbing large quantities of&nbsp;<strong>vitamin B12</strong>&nbsp;and interfering with the ileal absorption thereby making it&nbsp;unavailable to the host.</p>\n<p>The first intermediate host is a freshwater crustacean, while the second intermediate host is freshwater fish. The definitive hosts are man, dog, and cat.&nbsp;The infective form to humans is the third stage plerocercoid larvae. It possesses a rudimentary scolex.</p>\n<p>The adult worm lives inside the small intestine and lays operculated eggs. These freshly passed eggs contain an immature embryo surrounded by yolk granules. This hexacanth embryo with 6 hooklets inside the egg is called <strong>oncosphere</strong>.</p>\n<p>The pernicious anaemia caused by the infection is called <strong>bothriocephalus anaemia</strong>.</p>\n<p><strong>Treatment</strong> is praziquantel in a single dose of 10 mg/kg. In severe B12 deficiency, parenteral vitamin B12 should be given.&nbsp;</p>\n<p>Other options:</p>\n<p><strong>Beef tapeworm</strong> (option A) is <em><strong>Taenia saginata</strong> and </em><strong>pork tapeworm</strong> (option B) is&nbsp;<em><strong>Taenia solium</strong>. </em>Both of them live in the adult small intestine.&nbsp;Man is the definitive host for both species while cattle and pigs are the intermediate hosts for <em>T. saginata and T. solium</em> respectively.&nbsp;</p>\n<p>Manifestations include:</p>\n<ul>\n<li><strong>Intestinal taeniasis is </strong>characterised by vague abdominal discomfort, indigestion, nausea, diarrhoea and weight loss.&nbsp;</li>\n<li><strong>Cysticercosis </strong>in subcutaneous tissues (nodules), muscles (acute myositis), and brain (neurocysticercosis)</li>\n</ul>\n<p>The below image shows the life cycle of <em>T. saginata and T. solium</em></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/754f94ed60e94cb88431a49f537853ec.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/90870867fa7449ff9d49f9caed37570fx552x435.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/201a5240adca4787bc8d23a6fbc936ffx520x435.GIF"
    ]
  },
  {
    "text": "A child presents with chronic diarrhea,  weight loss, and fatigue. On examination, he was pale, with decreased height for age score. The life cycle of the causative organism is given in the image below. Which of the following is not a known complication of this disease?",
    "choices": [
      {
        "id": 1,
        "text": "Anemia"
      },
      {
        "id": 2,
        "text": "Focal seizures"
      },
      {
        "id": 3,
        "text": "Allergic reaction"
      },
      {
        "id": 4,
        "text": "Rectal prolapse"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The life cycle given above denoting adult worms in the large intestine with them having a slender anterior end and a 'whip-like' thick posterior end is suggestive of <strong><em>Trichuris trichiura</em> </strong>(whipworm). <strong>Focal seizures</strong> or cerebral involvement is not a known complication of trichuriasis.&nbsp;</p>\n<p>Trichuriasis is caused by <strong><em>T. trichiura</em> (whipworm)</strong>, which inhabits the <strong>cecum </strong>and<strong> ascending colon.</strong></p>\n<p>Clinical features include&nbsp;chronic dysentery, anemia, poor growth, and developmental defects.&nbsp;The disease may result either due to the mechanical effect of the worms or an <strong>allergic reaction</strong> to the parasite.</p>\n<p><strong>Trichuris trichiura</strong>&nbsp;causes <strong>rectal prolapse</strong> in children (characteristic feature) because the rectum loses its internal support as the worms bury their thin heads into the intestinal lining, loosening the elastic epithelium, and weakening the surrounding muscles; also, there is rectal edema because of the infection. All these factors finally lead to rectal prolapse.&nbsp;In&nbsp;<strong>heavy infection with <em>T. trichiura</em>, sigmoidoscopy</strong>&nbsp;may show&nbsp;<strong>white bodies of worms hanging from the&nbsp;</strong>inflamed<strong>&nbsp;mucosa</strong>, the so-called&nbsp;<strong>coconut cake rectum.&nbsp;</strong></p>\n<p>Other complications include&nbsp;dysentery, diarrhea, tenesmus, <strong>iron deficiency anemia</strong>, and <strong>poor growth</strong>. The poor growth is typically secondary to poor nutrition and consequently causes cognitive delay.</p>\n<p>Fecal smears show a&nbsp;<strong>barrel-shaped</strong>&nbsp;ovum of <em>T. trichiura</em>.&nbsp;The eggs of <em>T. trichiura</em> do not have a terminal spine. They are barrel-shaped and have mucus plugs at both ends. They get bile-stained and float in the saturated salt solution. An image showing the egg of trichuris is given below.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d7a0b00f117e45b0a2872778b213c6bb.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1775c7e02b73403b98d2c513dad7820fx720x720.JPEG"
    ]
  },
  {
    "text": "A 25-year-old man who recently visited a forest reserve in Karnataka presented with sudden onset of headache, myalgia, fever, and severe prostration. He was diagnosed to have Kyasanur Forest disease. Which of the following statements is incorrect about the disease?",
    "choices": [
      {
        "id": 1,
        "text": "It is caused by a virus of Flaviviridae family."
      },
      {
        "id": 2,
        "text": "It is a transmitted by Haemaphysalis spinigera."
      },
      {
        "id": 3,
        "text": "Dead monkeys serve as the amplifier of infection."
      },
      {
        "id": 4,
        "text": "The disease spreads on contact with an infected patient."
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The incorrect statement about Kyasanur Forest disease (<strong>KFD</strong>) is that the disease spreads on contact with an infected patient. <strong>No person-to-person</strong> transmission is described in KFD.&nbsp;</p>\n<p><strong>Kyasanur forest disease&nbsp;</strong>is an arboviral infection caused by Kyasanur forest disease virus (KFDV), a member of the virus family <strong><em>Flaviviridae</em>.</strong> It is transmitted by the bite of <strong>hard</strong> <strong>ticks</strong>, <strong><em>Haemaphysalis spinigera </em></strong>being the principal vector, which also acts as a reservoir. It was endemic to the forests of <strong>Karnataka&nbsp;</strong>but now has also been detected in neighboring states of <strong>Tamil Nadu</strong> and <strong>Kerala</strong>.</p>\n<p>Transmission to humans usually occurs after a <strong>tick bite</strong> or <strong>contact</strong> with an <strong>infected animal </strong>(sick or recently <strong>dead monkey</strong>). Monkeys act as amplifier hosts. Forest birds and small mammals are the <strong>reservoir hosts</strong>.</p>\n<p>The clinical features include constitutional symptoms like<strong> fever, headache</strong>, conjunctivitis, <strong>myalgia,</strong> hemorrhagic symptoms, and <strong>severe prostration.&nbsp;</strong>The diagnosis is established via PCR, virus isolation from blood, or enzyme-linked immunosorbent serologic assay.</p>\n<p>A <strong>killed KFD virus</strong> vaccine was used in a&nbsp;small field trial and appeared to provide some degree&nbsp;of protection.</p>\n<p>The ecological cycle of kyasanur forest disease is given below.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c8182bb41e4448b7bd74607975746991x792x612.JPEG"
    ]
  },
  {
    "text": "Identify the helminth from the given life cycle:",
    "choices": [
      {
        "id": 1,
        "text": "Wuchereria bancrofti"
      },
      {
        "id": 2,
        "text": "Onchocerca volvulus"
      },
      {
        "id": 3,
        "text": "Dracunculus medinensis"
      },
      {
        "id": 4,
        "text": "Loa Loa"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The life cycle depicted in the above image is of <strong><em>Dracunculus medinensis</em>&nbsp;</strong>(Guinea worm).</p>\n<p><strong>Humans </strong>are the<strong>&nbsp;definitive host</strong>. They get infected by drinking <strong>unfiltered water</strong> containing infected cyclops. Larvae come out once cyclops are killed in the stomach and<strong>&nbsp;penetrate the wall of the duodenum. </strong>They&nbsp;reach the retroperitoneal and subcutaneous connective tissues and develop into adults.</p>\n<p>The fertilized female worm grows and migrates within the connective tissues. It reaches a site where it is likely to come into contact with water like<strong>&nbsp;</strong>the<strong> leg</strong> (most common).&nbsp;Here, the gravid female worm <strong>secretes a toxin</strong> that causes a<strong> blister formation.</strong> The <strong>blister ruptures&nbsp;</strong>discharging a milky white fluid containing numerous<strong> L1 stage larvae.</strong></p>\n<p>The larvae survive for about a week in water. They are swallowed by the <strong>intermediate host- freshwater cyclops</strong>. The larvae penetrate the gut wall of the cyclops and develop into the <strong>infective third-stage larvae.&nbsp;</strong>The lifecycle continues when humans drink water containing infective cyclops.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/61ece0b170604239af9bf53bed6bf44a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a216d8690898429fb088610e372b05f2x513x435.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/42a78a5acdaa4061bb8ddf91ea8c6144x524x435.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/da94f1d7db5344f2ad8cdbf9301862cfx474x435.GIF"
    ]
  },
  {
    "text": "A young rice farmer presented with a high-grade fever, diarrhea, seizures, and vomiting. He is also found to have nuchal rigidity and signs of raised intracranial pressure. The physician suspects an illness transmitted by the mosquito shown below.  Which of the following statements is false?",
    "choices": [
      {
        "id": 1,
        "text": "Pigs are the amplifiers"
      },
      {
        "id": 2,
        "text": "Pond herons can act as hosts"
      },
      {
        "id": 3,
        "text": "Majorly transmitted by Culex species"
      },
      {
        "id": 4,
        "text": "Man acts as reservoir"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><span data-preserver-spaces=\"true\">The <strong>rice farmer</strong> presenting with features of\u00a0</span><strong><span data-preserver-spaces=\"true\">acute encephalitis</span></strong><span data-preserver-spaces=\"true\"> is likely to have</span><span data-preserver-spaces=\"true\">\u00a0</span><strong><span data-preserver-spaces=\"true\">Japanese encephalitis.</span></strong><span data-preserver-spaces=\"true\">\u00a0Man is the incidental <strong>dead-end host</strong>. </span></p>\n<p><span data-preserver-spaces=\"true\">The image shows the Culex mosquito. It can be identified by the presence of\u00a0<strong>unspotted</strong>\u00a0<strong>wings,</strong>\u00a0<strong>hunched back,</strong> and the <strong>absence of stripes</strong>.\u00a0 </span><span data-preserver-spaces=\"true\">The</span><strong><span data-preserver-spaces=\"true\">\u00a0Culex</span></strong><span data-preserver-spaces=\"true\">\u00a0mosquitoes are vectors or carriers for</span><strong><span data-preserver-spaces=\"true\">\u00a0Bancroftian filariasis, Japanese encephalitis, West Nile fever,\u00a0</span></strong>and<strong><span data-preserver-spaces=\"true\"> viral arthritis.\u00a0</span></strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b3e95077207c49a1a1b714053f66fc69.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/885c66c1b64a44709f03cbf1e38dc2bax1200x1451.JPEG"
    ]
  },
  {
    "text": "Which of the following stages of Entamoeba histolytica is considered as an infective form?",
    "choices": [
      {
        "id": 1,
        "text": "Trophozoite"
      },
      {
        "id": 2,
        "text": "Mature quadrinucleate cyst"
      },
      {
        "id": 3,
        "text": "Mature octanucleate cyst"
      },
      {
        "id": 4,
        "text": "Metacystic trophozoites"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Mature quadrinulceate</strong> <strong>cyst&nbsp;</strong>is considered as the&nbsp;<strong>infective form</strong>&nbsp;of&nbsp;<strong><em>Entamoeba histolytica</em></strong>. It is passed in feces and can remain viable under moist conditions for about <strong>10 days</strong>.</p>\n<p>The cysts are present only in the <strong>lumen</strong> of the colon and in <strong>formed feces</strong>. They initially contain a glycogen vacuole and chromatoid bodies (masses of ribonucleoprotein) with characteristic rounded ends. Nuclear division occurs within the cyst and results in a mature quadrinucleated cyst which has 4 nuclei. The chromatid bodies and glycogen vacuoles disappear.</p>\n<p>Other options:</p>\n<p>They include various life stages of <strong><em>Entamoeba histolytica</em></strong></p>\n<p><strong>Trophozoite:</strong></p>\n<ul>\n<li>The trophozoite is the vegetative or growing stage of the parasite.</li>\n<li>It is found only in <strong>tissues</strong></li>\n<li>The cytoplasm has two zones, a <strong>hyaline</strong> outer margin and a <strong>granular</strong> inner region that may contain <strong>red blood cells</strong> (pathognomic)</li>\n<li><strong>Pseudopodia</strong> are present which exhibit gliding motility</li>\n<li>Nucleus has a central karyosome with radiating fibrils called linin network giving a <strong>cartwheel</strong> <strong>appearance.</strong></li>\n</ul>\n<p><strong>Precystic stage:</strong></p>\n<ul>\n<li>This is formed when the trophozoid extrudes its food vacuoles and becomes round or oval, just before encystment.</li>\n<li>It has a large glycogen vacuole and 2 chromatid bars</li>\n<li>It secretes a refractile cyst wall to further become a cyst</li>\n</ul>\n<p><strong>Metacystic trophozoites:</strong></p>\n<ul>\n<li>This is formed after excystation of the mature cyst once it reaches the intestine.&nbsp;</li>\n<li>Initially, the cytoplasm gets detached from the cyst wall and there is a tear in the cyst wall, through which quadrinucleate amoeba is liberated. This stage is called the <strong>metacyst.</strong></li>\n<li>The nuclei in the metacyst immediately undergo division to form eight nuclei, which get surrounded by their own cytoplasm to become <strong>eight small amebulae</strong> or <strong>metacystic trophozoites.</strong></li>\n</ul>\n<p>The <strong>octanucleate cyst</strong> is seen in the case of <strong>Entamoeba coli</strong>, which is a <strong>non-pathogenic</strong> commensal amoeba.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a3aecb171c2a4d4caaf2b525d202fea7x435x548.GIF"
    ]
  },
  {
    "text": "A 15-year-old boy was brought with complaints of diarrhea and blood loss to the outpatient department. A stool examination showed  Ancylostoma dudoenale.  All of the given statements regarding Ancylostoma dudoenale are true except:",
    "choices": [
      {
        "id": 1,
        "text": "Eggs are shed in faeces of an infected individual"
      },
      {
        "id": 2,
        "text": "Man and soil are known reservoirs"
      },
      {
        "id": 3,
        "text": "It can enter the human body through penetration of skin"
      },
      {
        "id": 4,
        "text": "Immediate source of infection is soil"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given scenario of diarrhea, blood loss, and stool examination showing the presence of <em><strong>Ancylostoma dudoenale</strong></em> is suggestive of <strong>hookworm infection. Man</strong>&nbsp;is the&nbsp;<strong>only</strong> <strong>known</strong> <strong>reservoir</strong> of this condition.&nbsp;</p>\n<p>A <strong>reservoir</strong> is any person, animal, arthropod, plant, soil, or substance <strong>in which</strong> an <strong>infectious agent</strong>&nbsp;<strong>can live</strong>,&nbsp;<strong>multiply, </strong>and is <strong>transmissible</strong> to the susceptible host.&nbsp;</p>\n<p>The two main <strong>nematodes causing hookworm infection</strong> in humans are&nbsp; <em><strong>Ancylostoma dudoenale&nbsp;</strong></em>and <em><strong>Necator americanus</strong></em>.&nbsp;The affected individuals can <strong>present</strong> with <strong>blood loss</strong>, <strong>diarrhea,</strong> and <strong>iron deficiency anemia</strong>. The <strong>adult hookworms</strong> reside <strong>in</strong> the <strong>small intestine</strong> (mainly jejunum) and are <strong>attached to</strong> the <strong>villi</strong>. The <strong>female</strong> worm can<strong> lay</strong> thousands of <strong>eggs</strong> which are <strong>passed in feces</strong>.</p>\n<p>Larvae rapidly develop when these eggs land on warm, moist soil, and the egg hatches after 1 to 2 days. This <strong>soil</strong> <strong>contaminated</strong> with the infective larvae of this organism&nbsp;is the <strong>immediate</strong> <strong>source</strong> of <strong>infection</strong>. The <strong>feces</strong> containing the ova of the organisms are considered the <strong>infective material</strong>. The <strong>filariform larvae</strong> can <strong>enter</strong> the <strong>human body</strong> through <strong>penetration</strong> of skin or<strong> ingestion</strong> by mouth.&nbsp;</p>\n<p>The image below shows the lifecycle of <em>Ancylostoma duodenale:</em></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b12e267ed7cf43e5ab753876a30e1adax579x435.GIF"
    ]
  },
  {
    "text": "Man acts as an intermediate host for all of the following except_____",
    "choices": [
      {
        "id": 1,
        "text": "Plasmodium ovale"
      },
      {
        "id": 2,
        "text": "Toxoplasma gondii"
      },
      {
        "id": 3,
        "text": "Fasciola hepatica"
      },
      {
        "id": 4,
        "text": "Babesia microti"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Man</strong> is the <strong>definitive host</strong> of&nbsp;<strong><em>Fasciola hepatica</em>.</strong> Other definitive hosts are sheep, goats, and cattle. The <strong>first intermediate host</strong> is the <strong>snail</strong>. <strong>Aquatic plants</strong> are the <strong>second</strong> <strong>intermediate host.</strong></p>\n<p>Life cycle of Fasciola hepatica is given below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1f31ec40c2c6489797bdc61c341d0b5cx568x435.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad2230509a15440996b0d4f438102084x700x533.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/be470563ce1243c4b9bbfa77c58d45ddx457x600.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74b21929afce43e9bd48f730ba985cbcx544x435.PNG"
    ]
  },
  {
    "text": "A 4-year-old child with excoriation of anal skin was brought by his mother to the pediatric OPD. She states her son scratches his anal area frequently during nighttime. The life cycle of the causative organism is given below. Which of the following is not a feature of the egg of this organism?",
    "choices": [
      {
        "id": 1,
        "text": "Bile stained"
      },
      {
        "id": 2,
        "text": "Floats in saturated salt solution"
      },
      {
        "id": 3,
        "text": "Plano convex shape"
      },
      {
        "id": 4,
        "text": "Contains a tadpole-shaped coiled embryo"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong>\u00a0</strong>given clinical scenario of frequent <strong>anal</strong> area <strong>scratching</strong> during nighttime,\u00a0<strong>excoriation </strong>of the skin<strong> around the anus</strong>, and the given life cycle of humans acquiring infection by ingestion of embryonated eggs, which are released by the gravid female over the perianal skin are suggestive of <strong>pinworm</strong> or <em><strong>E</strong><strong>nterobius vermicularis</strong></em>\u00a0infection. The <strong>eggs</strong> of pinworms are\u00a0<strong>not bile-stained.</strong></p>\n<p>The pinworm<strong> eggs</strong> have a characteristic <strong>plano-convex shape</strong>. They are <strong>colorless</strong> and <strong>not bile-stained</strong>. They have a <strong>thick</strong>, <strong>double-layered</strong>,<strong> transparent eggshell</strong>. The eggs also <strong>float in</strong> a <strong>saturated salt solution</strong>. Inside lies a <strong>tadpole-shaped coiled embryo</strong>. The eggs are <strong>highly infectious,</strong> and reinfection should be prevented by regular washing of bed linens, towels, and clothing in hot water.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d26e24206046404c83b01ad524ae9a97.GIF"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/478b874205594cdd921c4e82bad2898cx720x480.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0b56e96444d34cb08faad1983497a5c6x600x936.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/449cb5b8e393492fb36af5857924043dx1279x1309.JPEG"
    ]
  },
  {
    "text": "The following image depicts the life cycle of:",
    "choices": [
      {
        "id": 1,
        "text": "Loa loa"
      },
      {
        "id": 2,
        "text": "Leishmania donovani"
      },
      {
        "id": 3,
        "text": "Wuchereria bancrofti"
      },
      {
        "id": 4,
        "text": "Onchocerca volvulus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The above image depicts the life cycle of <strong><em>Onchocerca volvulus</em>.</strong></p>\n<p>The life cycle of <em>Onchocerca volvulus</em> is completed partly in <strong>humans</strong>, the <strong>definitive host,</strong> and partly in female <strong>black flies</strong>, the <strong>intermediate host</strong>.</p>\n<p>During a blood meal, the female&nbsp;<strong>blackfly</strong>&nbsp;ingests the microfilariae from the skin and lymphatics of an infected person. It is within the vector that the microfilariae develop into first-stage larvae and subsequently into third-stage infective larvae.</p>\n<p>When the infected black fly bites another person, it introduces<strong> third-stage filarial larvae</strong><strong>&nbsp;</strong>into&nbsp;the skin of the human host.</p>\n<p>They penetrate into the bite wound and develop into adult worms in the subcutaneous tissues within&nbsp;<strong>subcutaneous&nbsp;nodules&nbsp;</strong>called <strong>onchocercomas</strong>&nbsp;or live freely in the tissues.</p>\n<p>The adult worm can live in the human host for about 15 years while the microfilariae for about a year.</p>\n<p>Other options:</p>\n<p>Option A: <em><strong>Loa loa</strong></em> completes its life cycle in humans, the definitive host and in mango flies/day biting flies of the genus Chrysops, which are the intermediate hosts/vectors. The microfilariae develop into third-stage larve in the vector. Its life cycle is shown in the image below:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9a127338803c46008880a38249a26ad0.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/030b45e6b2a34c7b957e70fe0ff55da3x474x435.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f1efcf3c703b4ccf80ffcbeb026d7196x581x435.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/08fce1448cc3487cbabbbd412d88ac3ax513x435.GIF"
    ]
  },
  {
    "text": "Identify the virus in the transmission cycle shown in the given image:",
    "choices": [
      {
        "id": 1,
        "text": "Nipah virus"
      },
      {
        "id": 2,
        "text": "Ebola virus"
      },
      {
        "id": 3,
        "text": "Japanese encephalitis virus"
      },
      {
        "id": 4,
        "text": "Zika virus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The transmission cycle of the <strong>Japanese encephalitis</strong> (JE)<strong> virus</strong> is shown in the image.&nbsp;</p>\n<p>Japanese encephalitis follows<strong> bird-arthropod-human </strong>transmission<strong>. Humans</strong>&nbsp;are the <strong>dead-end </strong>hosts,&nbsp;<strong>pigs</strong>&nbsp;are the&nbsp;<strong>amplifier </strong>hosts<strong>, </strong>and<strong>&nbsp;</strong>herons act as reservoir hosts.&nbsp;The disease is transmitted by the bite of <strong><em>Culex</em> mosquitoes</strong>, specifically <em>Culex tritaeniorhynchus</em> and&nbsp;<em>Culex vishnui</em>&nbsp;(common in India)</p>\n<div class=\"page\" title=\"Page 536\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Clinical features include high fever, headache, and vomiting. Signs of encephalitis such as convulsions, neck rigidity, and altered sensorium appear after 1-6 days. Measures like mosquito control, and locating piggeries away from houses can be done.</p>\n<div class=\"page\" title=\"Page 537\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Inactivated vero cell culture-derived <strong>SA-14-14-2</strong> vaccine is approved for use in India. JE vaccine is given in two doses- at&nbsp;<strong>9-12 months of age</strong>&nbsp;and at&nbsp;<strong>16-24 months</strong>&nbsp;of age in areas that are endemic to the disease, according to the <strong>National Immunization</strong> <strong>Schedule</strong>.&nbsp;</p>\n</div>\n</div>\n</div>\n<p>Other options:</p>\n<p>Option-A:<strong> Nipah virus </strong>is a&nbsp;zoonotic&nbsp;virus, which is transmitted from pigs to humans.&nbsp;<strong>Fruit bats</strong> are the natural hosts. It causes severe <strong>encephalitis</strong> with high mortality.&nbsp;</p>\n</div>\n</div>\n</div>\n<p>The image given below depicts the life cycle of the Nipah virus:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cd225f15e65f491ba2d32d1e12ae9258.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2a1283ae8d794dfab9ab1f1508cdf977x720x1440.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d37b0ead09c243da81b3beb53938c5d8x720x449.JPEG"
    ]
  },
  {
    "text": "A 38-year-old farmer is bitten by an insect whose life cycle is as portrayed below. He develops a characteristic eschar at the site of the bite, with regional lymphadenopathy and a maculopapular rash 2 weeks later. A positive serological diagnosis for this condition is made using agglutination with antigens from which of the following species?",
    "choices": [
      {
        "id": 1,
        "text": "Morganella morganii"
      },
      {
        "id": 2,
        "text": "Proteus vulgaris"
      },
      {
        "id": 3,
        "text": "Providencia stuartii"
      },
      {
        "id": 4,
        "text": "Proteus mirabilis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario showing characteristic <strong>eschar</strong> with lymphadenopathy and rash, along with the life cycle of a<strong> trombiculid mite </strong>(which acts as the<strong> vector</strong>), is suggestive of <strong>scrub typhus</strong>. It gives a positive<strong> Weil-Felix</strong> reaction with<strong> OX K</strong> agglutinins, which are derived from <strong><em>Proteus mirabilis</em></strong>.</p>\n<p><strong><span data-preserver-spaces=\"true\">Scrub typhus</span></strong>,<strong><span data-preserver-spaces=\"true\">\u00a0</span></strong><span data-preserver-spaces=\"true\">also known as chigger-borne typhus, is caused by\u00a0<em>Rickettsia</em> or<strong>\u00a0<em>Orientia tsutsugamushi</em></strong>. The vector is trombiculid mite. Humans are infected when they are bitten by the mite larvae known as\u00a0</span><strong><span data-preserver-spaces=\"true\">chiggers.\u00a0</span></strong><span data-preserver-spaces=\"true\">The incubation period is 1\u20133 weeks. The patient typically develops a characteristic<strong> eschar</strong> at the site of the mite bite, with\u00a0</span><strong><span data-preserver-spaces=\"true\">regional lymphadenopathy</span></strong><span data-preserver-spaces=\"true\">\u00a0and <strong>maculopapular rash</strong>.</span></p>\n<p>Weil-Felix reaction is a\u00a0<strong>heterophile agglutination reaction,</strong>\u00a0wherein the sera are tested for agglutinins to the O antigens of certain <em>Proteus</em> strains\u2014<em>Proteus vulgaris</em>\u00a0strains\u00a0<strong>OX19 and OX2 and <em>Proteus mirabilis</em>\u00a0strain OXK.\u00a0</strong>The basis of the test is sharing an alkali-stable carbohydrate antigen by some rickettsiae and some strains of <em>Proteus</em>.</p>\n<p><strong>OXK</strong>\u00a0is agglutinated\u00a0<strong>only </strong>in scrub typhus.<br /><br /></p>\n<table style=\"width: 349px;\">\n<tbody>\n<tr>\n<td style=\"width: 148px;\">\n<p><strong>DISEASE\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 </strong></p>\n</td>\n<td style=\"width: 67px;\">\n<p><strong>OX19</strong></p>\n</td>\n<td style=\"width: 53px;\">\n<p><strong>OX2</strong></p>\n</td>\n<td style=\"width: 49px;\">\n<p><strong>OXK</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 148px;\">\n<p>Epidemic typhus</p>\n</td>\n<td style=\"width: 67px;\">\n<p>+++</p>\n</td>\n<td style=\"width: 53px;\">\n<p>+</p>\n</td>\n<td style=\"width: 49px;\">\n<p>-</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 148px;\">\n<p>Endemic typhus</p>\n</td>\n<td style=\"width: 67px;\">\n<p>+++</p>\n</td>\n<td style=\"width: 53px;\">\n<p>+/-</p>\n</td>\n<td style=\"width: 49px;\">\n<p>-</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 148px;\">\n<p>RMSF</p>\n</td>\n<td style=\"width: 67px;\">\n<p>++</p>\n</td>\n<td style=\"width: 53px;\">\n<p>++</p>\n</td>\n<td style=\"width: 49px;\">\n<p>-</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 148px;\">\n<p><strong>Scrub typhus</strong></p>\n</td>\n<td style=\"width: 67px;\">\n<p>-</p>\n</td>\n<td style=\"width: 53px;\">\n<p>-</p>\n</td>\n<td style=\"width: 49px;\">\n<p><strong>+++</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 148px;\">\n<p>Rickettsialpox</p>\n</td>\n<td style=\"width: 67px;\">\n<p>-</p>\n</td>\n<td style=\"width: 53px;\">\n<p>-</p>\n</td>\n<td style=\"width: 49px;\">\n<p>-</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 148px;\">\n<p>Trench fever</p>\n</td>\n<td style=\"width: 67px;\">\n<p>-</p>\n</td>\n<td style=\"width: 53px;\">\n<p>-</p>\n</td>\n<td style=\"width: 49px;\">\n<p>-</p>\n</td>\n</tr>\n<tr>\n<td style=\"width: 148px;\">\n<p>Q fever</p>\n</td>\n<td style=\"width: 67px;\">\n<p>-</p>\n</td>\n<td style=\"width: 53px;\">\n<p>-</p>\n</td>\n<td style=\"width: 49px;\">\n<p>-</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/225fcb6b2233481d8c842cf279d3e1fe.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "At an outreach program for raising awareness and prevention of endemic diseases, the given life cycle is being used to educate the population. Identify the endemic disease and organism implicated.",
    "choices": [
      {
        "id": 1,
        "text": "Leptospira interrogans causing leptospirosis"
      },
      {
        "id": 2,
        "text": "Hanta virus causing hanta virus pulmonary syndrome"
      },
      {
        "id": 3,
        "text": "Yersinia pestis causing plague"
      },
      {
        "id": 4,
        "text": "Spirillum minus causing rat-bite fever"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The life cycle shown in the above image is suggestive of <strong>leptospirosis</strong>.\u00a0</p>\n<p>It is caused by contact with the <strong>urine</strong> or <strong>blood</strong> of an infected organism. It is a <strong>zoonotic disease,\u00a0</strong>with\u00a0<strong>rats</strong>\u00a0being the most well-known <strong>reservoirs.</strong>\u00a0</p>\n<p>Illness is classically <strong>biphasic</strong> after an incubation period of up to 1 month. The stages are:\u00a0</p>\n<ul>\n<li><strong>Acute leptospiremic</strong> phase- organism can be cultured from <strong>blood.</strong></li>\n<li><strong>Resolving immune</strong> phase- organism can be cultured from <strong>urine.</strong></li>\n</ul>\n<p>The stages may not be clinically distinguishable.</p>\n<p>Most cases are asymptomatic but a few may present with severe manifestations. Clinical features include:\u00a0</p>\n<ul>\n<li>High-grade fever</li>\n<li>Hepatic dysfunction\u00a0</li>\n<li>Renal impairment</li>\n<li>Hemorrhages- gastrointestinal, pulmonary (most common), petechiae and purpura</li>\n</ul>\n<p>The <strong>severe</strong> form is known as <strong>Weil's disease,</strong> with a triad of <strong>hemorrhage, jaundice,</strong> and <strong>acute kidney injury.</strong>\u00a0</p>\n<p>Treatment of choice is<strong> IV penicillin or IV ceftriaxone.\u00a0</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/733503dbe48f4fbbacabb5619148561c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/055259ff7bb24867aa03c1ec0bc8ca84x1280x1329.JPEG"
    ]
  },
  {
    "text": "A patient presents with a cough with rusty sputum and fever for the past few weeks. She gives a history of recent travel to Japan and the consumption of raw crabs.  A complete blood count reveals eosinophilia. All of the following are true about this condition, except ______.",
    "choices": [
      {
        "id": 1,
        "text": "It is a food-borne trematode infection."
      },
      {
        "id": 2,
        "text": "Eggs are coughed up in sputum."
      },
      {
        "id": 3,
        "text": "Embryonated eggs are the infective form."
      },
      {
        "id": 4,
        "text": "Praziquantel is the treatment of choice."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above clinical scenario is suggestive of&nbsp;infection with <strong><em>Paragonimus westermani</em> </strong>(lung fluke). All the given options are true about this condition, except that embryonated eggs are the infective form.</p>\n<p><strong>Metacercariae</strong> encysted in<strong> crab</strong> or<strong> crayfish</strong>&nbsp;is the <strong>infective form</strong>.</p>\n<p><em>P. westermani</em> is a <strong>trematode.</strong> Transmission to humans occurs by eating <strong>raw</strong> or <strong>undercooked crab</strong> or <strong>crayfish</strong> containing&nbsp;metacercariae.&nbsp;The metacercariae encyst in the human gut and young worms migrate to the lungs, where they become encapsulated in lung tissue.</p>\n<p>The patient complains of cough,&nbsp;chest pain, and hemoptysis.&nbsp;The <strong>viscous sputum</strong> is speckled with <strong>golden-brown</strong>&nbsp;<strong>eggs</strong>.</p>\n<p>Treatment:&nbsp;<strong>Praziquantel</strong> (25 mg/kg TDS for 1&ndash;2 days) is the drug of&nbsp;choice.</p>\n<p>The following image shows the life cycle of&nbsp;<em>P. westermani,</em> the oriental lung fluke.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8043867d918e4f309f7f2bf15d8c6494x519x435.GIF"
    ]
  },
  {
    "text": "A 7-year-old child is infected with the organism whose life cycle is as shown below and is diagnosed with visceral larva migrans. The causative organism is an example of which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Obligate parasite"
      },
      {
        "id": 2,
        "text": "Facultative parasite"
      },
      {
        "id": 3,
        "text": "Accidental parasite"
      },
      {
        "id": 4,
        "text": "Aberrant parasite"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The life cycle portrayed in the image is suggestive of<strong>&nbsp;Toxocara canis</strong> (dog roundworm) which is an example of an&nbsp;<strong>aberrant</strong> <strong>parasite</strong>. It is defined as a parasite&nbsp;that infects a host where they cannot develop further.</p>\n<p>Parasites can be classified as:</p>\n<ul>\n<li><strong>Ectoparasites -</strong> inhabit only the body surface of the host without penetrating the tissue. The term infestation is often used for parasitization. e.g., lice, ticks, and mites.</li>\n<li><strong>Endoparasite -</strong>&nbsp;lives within the body of the host and causes infection.</li>\n</ul>\n<p>Endoparasites are further classified as follows:</p>\n<ul>\n<li>Obligate parasite - cannot exist without a host. e.g., Toxoplasma gondii and Plasmodium.</li>\n<li>Facultative parasite - are either parasitic or free-living forms. e.g., Naegleria fowleri.</li>\n<li>Accidental parasite - parasite that infects an unusual host. e.g., Echinococcus granulosus infects man</li>\n<li>Aberrant/Wandering parasites - parasite that infects a host where they cannot develop further. e.g., Toxocara canis (dog roundworm) infecting humans.</li>\n</ul>\n<p><strong>Visceral Larva Migrans</strong> :</p>\n<ul>\n<li>It is a syndrome caused by nematodes that are normally parasitic for nonhuman host species</li>\n<li>In humans, these nematode larvae do not develop into adult worms, but, instead, migrate through host tissues and elicit eosinophilic inflammation</li>\n<li>Common causes:<br />\n<ul>\n<li>Toxocara canis (dog roundworm)- most common</li>\n<li>Taxocara cati (cat roundworm)</li>\n<li>Ascaris suum (pig ascaris)</li>\n<li>Angiosrrongylus cantonensis</li>\n<li>Gnathostoma spinigerum</li>\n<li>Anisakis simplex</li>\n<li>Baylisascaris procyonis</li>\n</ul>\n</li>\n<li>Fever, hepatomegaly, pneumonitis, hyperglobulinemia, and pica are the common findings.</li>\n<li>Patients may develop neurological disturbances (neural larva migrans) and endophthalmitis (ophthalmic larva migrans)</li>\n<li>Treatment :&nbsp;Diethylcarbamazine (DEC), 100 mg TDS for 3 weeks in an adult, kills the larva and arrests the disease.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/aec18aba58df47daa837df1317527703.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/51d9d69fa94a41b4a08f5555b48a07f4x1280x1080.JPEG"
    ]
  }
];
        let quizName = 'Life Cycles Mini Test - -Tmt';
        const quizFilename = 'life-cycles-mini-test-tmt-4f98e50a.html';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>