<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>09 Synapse And Junctional Transmission - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Physiology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">27</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A synapse is a junction between _______.",
    "choices": [
      {
        "id": 1,
        "text": "1 and 2"
      },
      {
        "id": 2,
        "text": "1, 2, 3"
      },
      {
        "id": 3,
        "text": "All 1, 2, 3, 4"
      },
      {
        "id": 4,
        "text": "1, 2, 4"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Impulses are transmitted from one nerve cell to another cell at <strong>junctions called&nbsp;synapse</strong>. These are the junctions where the axon or some other portion of one cell (the presynaptic cell) terminates on the <strong>dendrites, soma,</strong> or <strong>axon</strong> of another neuron or, in some cases, a <strong>muscle</strong> or <strong>gland cell</strong> (the postsynaptic cell).</p>\n<p>There are two major types of synapses:</p>\n<ul>\n<li>Chemical&nbsp;</li>\n<li>Electrical</li>\n</ul>\n<p>When a neuron terminates on a muscle , it is called a neuromuscular junction . This is an example of a chemical synapse .</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dea6820ad79548c3a92f86c4124fc5aax648x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fd2a41a779744f088e4e16067a1905fdx1280x1214.JPEG"
    ]
  },
  {
    "text": "All of the following are true regarding chemical synapses except_____",
    "choices": [
      {
        "id": 1,
        "text": "These are the most common type of synapses"
      },
      {
        "id": 2,
        "text": "Neurotransmitter is produced by the presynaptic neuron"
      },
      {
        "id": 3,
        "text": "Protoplasmic continuity between pre- and post- synaptic membrane ensures faster conduction"
      },
      {
        "id": 4,
        "text": "Conduction is always  orthodromic"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Chemical synapses</strong> are interneuronal junctions <strong>without protoplasmic continuity</strong>.&nbsp;</p>\n<p>Most of the synapses used for signal transmission in the central nervous system of the human being are chemical synapses.</p>\n<p>In these synapses, the first neuron <strong>(presynaptic neuron) secretes neurotransmitters</strong> at its nerve ending synapse. This transmitter, in turn, acts on receptor proteins in the membrane of the next neuron (post-synaptic neuron) to excite the neuron, inhibit it, or modify its sensitivity in some other way.&nbsp;</p>\n<p>As neurotransmitters are released only by the pre-synaptic neuron, the synaptic conduction in the CNS is <strong>only orthodromic (unidirectional).</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b31b37479bf44014a57c1541a1d21e65x644x600.PNG"
    ]
  },
  {
    "text": "In a typical chemical synaptic cleft, the extracellular distance between the presynaptic plasma membrane and the postsynaptic plasma membrane is approximately_____",
    "choices": [
      {
        "id": 1,
        "text": "2-4 nm"
      },
      {
        "id": 2,
        "text": "20-40 nm"
      },
      {
        "id": 3,
        "text": "200-400 nm"
      },
      {
        "id": 4,
        "text": "2-4 \u03bcm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In a typical chemical synaptic cleft, the extracellular distance between the presynaptic plasma membrane and the postsynaptic plasma membrane is approximately <strong>20-40nm</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7503ba7ba362406c8f8acc065b15ae5dx1280x1550.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad9b05705c0a42bda32241022d01eca0x1280x1530.JPEG"
    ]
  },
  {
    "text": "Which of the following is true regarding neurotransmitters?",
    "choices": [
      {
        "id": 1,
        "text": "All neurotransmitter are derived from amino acids"
      },
      {
        "id": 2,
        "text": "Nitric oxide is a neurotransmitter in the CNS"
      },
      {
        "id": 3,
        "text": "They do not act on ionotropic receptors"
      },
      {
        "id": 4,
        "text": "They are released on repolarization of the nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p2\">Nitric oxide is a neurotransmitter in the CNS.</p>\n<p>Neurotransmitters are the substances that mediate chemical signaling between neurons. They can be<strong> choline esters, biogenic amines, amino acids, and neuropeptides</strong>.</p>\n<p>Two main classes of chemical substances that serve as neurotransmitters:</p>\n<ul>\n<li>small-molecule neurotransmitter (acetylcholine)</li>\n<li>large molecule neurotransmitter (enkephalin)</li>\n</ul>\n<p>They can act on <strong>ionotropic receptors (ligand-gated ion channels) and/or metabotropic receptors </strong>on the postsynaptic membrane to produce a change in membrane potential to bring about their action.</p>\n<p><strong>Criteria for the substance to be neurotransmitter:</strong></p>\n<ul>\n<li style=\"font-weight: 400;\">the substance must be demonstrated to be present in the presynaptic terminal.</li>\n<li style=\"font-weight: 400;\">the cell must be able to synthesize the substance.</li>\n<li style=\"font-weight: 400;\">should be released on <strong>depolarization</strong> of the terminal.</li>\n<li style=\"font-weight: 400;\">there should be specific receptors for it on the postsynaptic membrane.</li>\n<li style=\"font-weight: 400;\">if the substance is applied exogenously to the postsynaptic membrane at physiologic concentration, the response of the postsynaptic cell must mimic the in vivo response.</li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not a monoamine neurotransmitter?",
    "choices": [
      {
        "id": 1,
        "text": "GABA"
      },
      {
        "id": 2,
        "text": "Norepinephrine"
      },
      {
        "id": 3,
        "text": "DOPA"
      },
      {
        "id": 4,
        "text": "Serotonin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>GABA is not a monoamine neurotransmitter. It is an amino acid.</p>\n<p>Biogenic amines are small, charged molecules that are synthesized from amino acids and contain an amino group (R&mdash;NH2). Amines known to act as neurotransmitters are <strong>dopamine, norepinephrine</strong> (noradrenaline), <strong>epinephrine</strong> (adrenaline), <strong>serotonin</strong> (5-hydroxytryptamine [5-HT]).</p>\n<p>Amino acids and their derived amines acting as neurotransmitters:</p>\n<ul>\n<li><strong>Tyrosine </strong>-&nbsp; catecholamines : dopamine, norepinephrine, and epinephrine .</li>\n<li><strong>Tryptophan&nbsp;</strong>- serotonin</li>\n<li><strong>Histidine</strong> -<strong>&nbsp;</strong>histamine</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true regarding metabotropic neurotransmitters?",
    "choices": [
      {
        "id": 1,
        "text": "They act through second messenger systems"
      },
      {
        "id": 2,
        "text": "They bind to cationic channels and increase influx of Na"
      },
      {
        "id": 3,
        "text": "They bind to anionic channels and increase influx of Cl"
      },
      {
        "id": 4,
        "text": "They inhibit the fusion of synaptic vesicle with the synaptic cleft"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<div class=\"page\" title=\"Page 558\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurotransmitter receptors that act through second messenger systems are called metabotropic receptors.</p>\n<div class=\"page\" title=\"Page 559\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurotransmitters bind to receptors on the post-synaptic membrane to activate ion channels in one of the two ways:</p>\n<ul>\n<li>by gating ion channels directly (<strong>ionotropic receptors</strong>).</li>\n<li>by activating a <strong>second messenger</strong> (<strong>metabotropic receptor</strong>) for a prolonged postsynaptic neu&shy;ronal excitation or inhibition. Most commonly activated is a G-protein coupled membrane receptor.</li>\n</ul>\n<p>The following four changes can occur usually after binding to a G-protein coupled receptor:</p>\n<div class=\"page\" title=\"Page 560\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Opening specific <strong>ion channels</strong> through the post-synaptic cell membrane.</li>\n<li>Activation of cyclic adenosine monophosphate (<strong>cAMP</strong>) or cyclic guanosine monophosphate (<strong>cGMP</strong>) in the neuronal cell.</li>\n<li>Activation of one or more <strong>intracellular enzymes.</strong>&nbsp;</li>\n<li>Activation of <strong>gene transcription</strong>. Activation of gene transcription is one of the most important effects of activation of the second messenger systems because gene transcription can cause formation of new proteins within the neuron, thereby changing its metabolic machinery or its structure.&nbsp;</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false regarding the neurotransmitter glutamate in the brain?",
    "choices": [
      {
        "id": 1,
        "text": "It is involved in excitatory neurotansmission"
      },
      {
        "id": 2,
        "text": "It is a minor neurotransmitter in the brain"
      },
      {
        "id": 3,
        "text": "It acts via both ionotropic and metabotropic receptors"
      },
      {
        "id": 4,
        "text": "Glycine binding to the NMDA receptor is essential for the receptor to respond to glutamate"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Glutamate is a <strong>major excitatory neurotransmitter</strong> responsible for ~75% excitatory neurotransmission in the CNS.</p>\n<p>Glutamate is the best-known example of excitatory amino acid neurotransmitters. It brings about its action via both ionotropic and metabotropic receptors.</p>\n<p>&nbsp;<strong>Glutamate Receptors :</strong></p>\n<table>\n<tbody>\n<tr>\n<td width=\"205\">\n<p><strong>Type</strong></p>\n</td>\n<td width=\"202\">\n<p><strong>Mechanism of Action</strong></p>\n</td>\n</tr>\n<tr>\n<td colspan=\"2\" width=\"407\">\n<p><strong>Ionotropic Glutamate Receptors</strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"205\">\n<p>AMPA, Kainate receptors</p>\n</td>\n<td width=\"202\">\n<p>Primarily permits influx of Na+ and efflux of K+ &rarr;EPSP (excitatory postsynaptic potential)</p>\n</td>\n</tr>\n<tr>\n<td width=\"205\">\n<p>NMDA receptors</p>\n</td>\n<td width=\"202\">\n<p>Permits &uarr; influx of Ca2+ along with Na+&nbsp;</p>\n<p>&rarr;EPSP (excitatory postsynaptic potential)</p>\n<p>(<strong>Glycine</strong> binding to the NMDA receptor is essential for the receptor to respond to glutamate)</p>\n</td>\n</tr>\n<tr>\n<td width=\"205\">\n<p><strong>Metabotropic Glutamate Receptor(mGluR)</strong></p>\n</td>\n<td width=\"202\">\n<p>Leads to either &uarr; in IP3/DAG or &darr;cAMP</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a well-known inhibitory brain neurotransmitter?",
    "choices": [
      {
        "id": 1,
        "text": "Glutamate"
      },
      {
        "id": 2,
        "text": "Acetylcholine"
      },
      {
        "id": 3,
        "text": "GABA"
      },
      {
        "id": 4,
        "text": "Glycine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>GABA (gamma-amino-butyric acid) is probably the best known <strong>inhibitory neurotransmitter</strong> in the brain, especially in the forebrain regions.</p>\n<p>GABA mediates both presynaptic and postsynaptic inhibition</p>\n<p><strong>GABA Receptors :</strong></p>\n<table>\n<tbody>\n<tr>\n<td>\n<p><strong>Type </strong></p>\n</td>\n<td>\n<p><strong>Mechanism of Action</strong></p>\n</td>\n</tr>\n<tr>\n<td>\n<p>GABA <sub>A </sub>and GABA <sub>C</sub></p>\n</td>\n<td>\n<p>Ionotropic receptors</p>\n<p>Activation &rarr;&uarr;Cl<sup>-</sup> influx into the neurons &rarr; IPSP (inhibitory postsynaptic potential)</p>\n<p>Benzodiazepines (diazepam), barbiturates and phenobarbital enhance/potentiate the effect of GABA <sub>A</sub> receptors (neuromodulation)</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>GABA <sub>B</sub></p>\n</td>\n<td>\n<p>Metabotropic receptors</p>\n<p>G-protein coupled receptors</p>\n<p>G<sub>i</sub>&rarr;inhibits adenylyl cyclase to open K<sup>+</sup> channels&nbsp;</p>\n<p>G<sub>0</sub>&rarr; inhibits or delays Ca<sup>2+</sup> influx</p>\n<p>Net effect=IPSP</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Other options :</p>\n<ul>\n<li><strong>Glutamate</strong> is a good example of an <strong>excitatory</strong> brain neurotransmitter.</li>\n<li><strong>Acetylcholine</strong> and <strong>glycine</strong> have been known to play <strong>either excitatory</strong> or <strong>inhibitory</strong> neurotransmitter roles depending on the particular brain circuits under study.</li>\n</ul>\n<p>Note:</p>\n<p>Glycine sometimes potentiates the excitatory action of glutamate at NMDA receptors. So, it might act as an excitatory neurotransmitter as well.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Correctly matched with its receptor is ______",
    "choices": [
      {
        "id": 1,
        "text": "Nicotinic \u2013 G-Protein Coupled Receptor"
      },
      {
        "id": 2,
        "text": "GABA-A \u2013 ionotropic"
      },
      {
        "id": 3,
        "text": "GABA-B - Ionotropic"
      },
      {
        "id": 4,
        "text": "Glycine \u2013 G-Protein Coupled Receptor"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>GABA <sub>A</sub>&nbsp;is an ionotropic receptor.</p>\n<p>GABA is the major inhibitory mediator both pre and postsynaptically in the brain.&nbsp;</p>\n<p><strong>GABA receptors :</strong></p>\n<table>\n<tbody>\n<tr>\n<td>\n<p><strong>Type </strong></p>\n</td>\n<td>\n<p><strong>Mechanism of Action</strong></p>\n</td>\n</tr>\n<tr>\n<td>\n<p>GABA <sub>A </sub>and GABA <sub>C</sub></p>\n</td>\n<td>\n<p>Ionotropic receptors</p>\n<p>Activation &rarr;&uarr;Cl<sup>-</sup> influx into the neurons &rarr; IPSP (inhibitory postsynaptic potential)</p>\n<p>Benzodiazepines (eg. Diazepam), barbiturates and phenobarbital enhance/potentiate the effect of GABA <sub>A</sub> receptors (neuromodulation)</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>GABA <sub>B</sub></p>\n</td>\n<td>\n<p>Metabotropic receptors</p>\n<p>G protein coupled receptors</p>\n<p>G<sub>i</sub>&rarr;inhibits adenylyl cyclase to open K<sup>+</sup> channels G</p>\n<p>G<sub>0</sub>&rarr; inhibits or delays Ca<sup>2+</sup> influx</p>\n<p>Net effect=IPSP</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which is not true about neuromodulators?",
    "choices": [
      {
        "id": 1,
        "text": "Modify the postsynaptic neuron\u2019s response to a specific neurotransmitter"
      },
      {
        "id": 2,
        "text": "May change the presynaptic neuron\u2019s release of a transmitter"
      },
      {
        "id": 3,
        "text": "May be released by the presynaptic neuron along with the neurotransmitter"
      },
      {
        "id": 4,
        "text": "Actions are faster than neurotransmitters"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Neuromodulators</strong> typically have actions that are <strong>slower</strong> than neurotransmitters.</p>\n<p>Neuromodulators are chemicals released by neurons that have little or no direct effects on their own but can modify the effects of neurotransmitters.</p>\n<p>They can modify the postsynaptic neuron&rsquo;s response to a neurotransmitter and they can change how much of a neurotransmitter the presynaptic neuron synthesizes or releases.</p>\n<p>Neuromodulators also can be released by the presynaptic neuron along with the neurotransmitter.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A medical student was doing research in a laboratory that studies the neuromuscular junction. Which of the following events at the junction are listed in correct sequential order?",
    "choices": [
      {
        "id": 1,
        "text": "Motor neuron action potential, acetylcholine release, Ca2+ entry at the endplate"
      },
      {
        "id": 2,
        "text": "Ca2+ entry into the motor nerve terminal, acetylcholine release, Na+ entry at the endplate"
      },
      {
        "id": 3,
        "text": "Ca2+ entry into the motor nerve terminal, Na+ entry at the endplate, motor neuron action potential"
      },
      {
        "id": 4,
        "text": "Na+ entry at the endplate, acetylcholine release, muscle fiber action potential"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Events Occurring at the Chemical Synapse:</strong></p>\n<div class=\"page\" title=\"Page 143\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p style=\"text-align: center;\">The <strong>action potential</strong> arriving at the end of the motor neuron increases the permeability of its endings to <strong>Ca2+</strong></p>\n<p style=\"text-align: center;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>&darr;</strong></p>\n<p style=\"text-align: center;\">Ca2+ enters the endings and triggers a marked increase in <strong>exocytosis</strong> of the acetylcholine-containing synaptic vesicles</p>\n<p style=\"text-align: center;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<strong> &darr;</strong></p>\n<p style=\"text-align: center;\">Binding of acetylcholine to <strong>nicotinic receptors</strong> increases the <strong>Na+ and K+ conductance</strong></p>\n<p style=\"text-align: center;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &darr;</p>\n<p style=\"text-align: center;\">Resultant influx of Na+ produces a local depolarizing potential, the <strong>endplate potential</strong></p>\n<p style=\"text-align: center;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &darr;</p>\n<p style=\"text-align: center;\">The current created by this local potential depolarizes the adjacent muscle membrane to its <strong>firing level</strong></p>\n<p style=\"text-align: center;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&darr;</p>\n<p style=\"text-align: center;\"><strong>Action potentials</strong> are generated on either side of the endplate and are conducted away from the endplate in both directions along the muscle fiber. This muscle action potential, in turn, initiates muscle contraction.</p>\n<p style=\"text-align: justify;\">Acetylcholine is then removed from the synaptic cleft by <strong>acetylcholinesterase,</strong> which is present in high concentration at the neuromuscular junction.</p>\n</div>\n</div>\n</div>\n<p class=\"p1\" style=\"text-align: center;\">&nbsp;</p>\n<p class=\"p3\">&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e35f3af5f4574d2b9fc2999d93196ed0x1117x1408.JPEG"
    ]
  },
  {
    "text": "Excitatory postsynaptic potential (EPSP) is due to the influx of ______.",
    "choices": [
      {
        "id": 1,
        "text": "Na+"
      },
      {
        "id": 2,
        "text": "K+"
      },
      {
        "id": 3,
        "text": "Mg2+"
      },
      {
        "id": 4,
        "text": "Cl-"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>As seen in the figure, following the discharge of the sensory neuron, there is positivity in the motor neuron signifying a EPSP.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/77499bd4de10407faf127e3a657a456ax761x568.PNG"
    ]
  },
  {
    "text": "Inhibitory Postsynaptic Potential (IPSP) is due to influx of ______",
    "choices": [
      {
        "id": 1,
        "text": "Na+"
      },
      {
        "id": 2,
        "text": "K+"
      },
      {
        "id": 3,
        "text": "Ca2+"
      },
      {
        "id": 4,
        "text": "Cl-"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Inhibitory Postsynaptic Potential (IPSP) is due to the influx of <strong>chloride ions (Cl-)</strong>.</p>\n<p>If, binding of a neurotransmitter causes the postsynaptic membrane to become more negative (<strong>hyperpolarized</strong>), it is called an inhibitory postsynaptic potential (IPSP) because hyperpolarization moves the membrane potential farther from the threshold and makes the cell less likely to reach an action potential.</p>\n<p><strong>IPSP may be due to :</strong></p>\n<ul>\n<li><strong>Increase in Cl- influx</strong>. This action causes diffusion of negatively charged chloride ions from outside the postsynaptic neuron to the inside, thereby carrying negative charges inward and increasing the negativity inside. This leads to hyperpolarization.</li>\n<li><strong>Increase in K+ efflux</strong>. This action causes positive ions to diffuse to the exterior, which causes increased negativity inside the neuron, which leads to hyperpolarization.</li>\n<li>Activation of receptor enzymes&nbsp;that increase the number of inhibitory synaptic receptors or decrease the number of excitatory receptors.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following effect in the motor neuron is due to:",
    "choices": [
      {
        "id": 1,
        "text": "Opening of chloride ion channels through the pre-synaptic neuronal membrane"
      },
      {
        "id": 2,
        "text": "Increase in conductance of potassium ions to the inside of the neuron"
      },
      {
        "id": 3,
        "text": "Activation of receptor enzymes that increase the number of inhibitory synaptic receptors"
      },
      {
        "id": 4,
        "text": "Increase in conductance of sodium ions inside the neuron"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Activation of receptor enzymes that increase the number of inhibitory synaptic receptors can cause the effect shown, namely, the <strong>generation of IPSP</strong>.</p>\n<p>In the figure given, there is an increased negativity in the motor neuron following the action potential in the interneuron. So, the synaptic potential is IPSP. This can be caused at the postsynaptic membrane due to <strong>Cl- influx</strong>, <strong>K+ efflux</strong> or<strong> activation of receptor enzymes</strong> that increase the number of inhibitory synaptic receptors or decrease the number of excitatory receptors.</p>\n<p>Other options:</p>\n<div class=\"page\" title=\"Page 560\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>Opening of chloride ion channels through the <strong>post-synaptic</strong>&nbsp;neuronal membrane.&nbsp;</li>\n<li>Increase in conductance of potassium ions to the <strong>outside</strong> of the postsynaptic neuron.</li>\n<li>Increase in conductance of sodium ions inside the neuron causes the generation of an <strong>EPSP</strong>.</li>\n</ul>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/aa137b0c0a4f421f959a7f77c596e6be.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Slow inhibitory postsynaptic potential (IPSP) is generated by all except _______",
    "choices": [
      {
        "id": 1,
        "text": "Cardiac muscle"
      },
      {
        "id": 2,
        "text": "Skeletal muscle"
      },
      {
        "id": 3,
        "text": "Smooth muscle"
      },
      {
        "id": 4,
        "text": "Autonomic ganglia"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Slow EPSPs and IPSPs are not generated by skeletal muscles.</p>\n<p>Slow excitatory postsynaptic potentials (EPSPs) and inhibitory postsynaptic potential (IPSPs) are seen in <strong>autonomic ganglia, cardiac, and smooth muscle, and cortical neurons.</strong></p>\n<p>EPSPs and IPSPs occur after a latency of 0.5ms while slow EPSPs and IPSPs occur after a latency of 100&ndash;500 ms and last for several seconds. The slow EPSPs are due to a decrease in <strong>K<sup>+</sup>&nbsp;efflux</strong>, and the slow IPSPs are due to an increase in&nbsp;K<sup>+</sup> efflux.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following physiologic processes is not correctly matched?",
    "choices": [
      {
        "id": 1,
        "text": "Presynaptic inhibition : Axo-axonal synapse"
      },
      {
        "id": 2,
        "text": "Postsynaptic inhibition: GABA produces IPSP"
      },
      {
        "id": 3,
        "text": "Presynaptic inhibition: GABA-B receptors decrease K+ conductance."
      },
      {
        "id": 4,
        "text": "Presynaptic inhibition: GABA-A receptors increase Cl\u2013 conductance."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>POST-SYNAPTIC INHIBITION</strong></p>\n<ul>\n<li>Postsynaptic inhibition occurs when an inhibitory transmitter such as <strong>glycine</strong> or <strong>GABA</strong> is released from a presynaptic nerve terminal onto the postsynaptic neuron to induce an <strong>IPSP</strong> in the postsynaptic neuron.</li>\n<li>In the figure shown below, an inhibitory transmitter such as GABA is released from the nerve terminals of an inhibitory interneuron (dark) that synapses on a postsynaptic neuron.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/67f7b518becc4edc83f0bb04253fc397x1280x1509.JPEG"
    ]
  },
  {
    "text": "Renshaw cell inhibition is ________",
    "choices": [
      {
        "id": 1,
        "text": "Feedback facilitation"
      },
      {
        "id": 2,
        "text": "Feedback inhibition"
      },
      {
        "id": 3,
        "text": "Feed forward inhibition"
      },
      {
        "id": 4,
        "text": "Indirect inhibition"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Renshaw cell inhibition is an example of feedback inhibition.</p>\n<p>The axon of a spinal motor neuron has a recurrent collateral that synapses on an inhibitory interneuron that terminates on the cell body of the<strong> same</strong> and other motor neurons. The inhibitory interneuron is called a <strong>Renshaw cell</strong> and its neurotransmitter is <strong>glycine.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4ca0a5177424438b82dbf2c5468e9a52x1280x1655.JPEG"
    ]
  },
  {
    "text": "Feedforward inhibition is seen in ________",
    "choices": [
      {
        "id": 1,
        "text": "Medulla"
      },
      {
        "id": 2,
        "text": "Pituitary gland"
      },
      {
        "id": 3,
        "text": "Cerebellum"
      },
      {
        "id": 4,
        "text": "Renshaw cell"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This arrangement is called feed-forward inhibition which presumably limits the duration of excitation produced by any given afferent volley.</p>\n<p><strong>Note</strong>:&nbsp;Renshaw cell carries out the negative feedback inhibition of a spinal motor neuron.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2eb1fc66b14d49cdb3ecf1a4b57b2bb0x1024x700.jpeg"
    ]
  },
  {
    "text": "Presynaptic facilitation is due to prolonged opening of_____",
    "choices": [
      {
        "id": 1,
        "text": "Na+ channels"
      },
      {
        "id": 2,
        "text": "K+ channels"
      },
      {
        "id": 3,
        "text": "Ca2+ channels"
      },
      {
        "id": 4,
        "text": "Cl- channels"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Presynaptic facilitation is due to prolonged opening of&nbsp;<strong>Ca<sup>2+</sup></strong> channels .</p>\n<p>In presynaptic facilitation, the <strong>serotonin</strong> released at the axoaxonal ending increases the intraneuronal cAMP levels&rarr; phosphorylation and consequent closure of K<sup>+</sup> channels &rarr; slowing of repolarization and prolonging the depolarization by prolonged opening of Ca<sup>2+</sup> channels</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e056fde68c2e40f2b0b977d01294a53ax1280x1337.JPEG"
    ]
  },
  {
    "text": "A person with myasthenia gravis notes increased muscle strength when he is treated with an acetylcholinesterase (AChE) inhibitor.  The basis for his improvement is due to the increase in _______",
    "choices": [
      {
        "id": 1,
        "text": "The amount of acetylcholine (ACh) released from motor nerves"
      },
      {
        "id": 2,
        "text": "The level of ACh at the muscle end plates"
      },
      {
        "id": 3,
        "text": "The number of ACh receptors on the motor end plates"
      },
      {
        "id": 4,
        "text": "Synthesis of norepinephrine in motor nerves"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Treatment with AChE inhibitors (e.g., neostigmine) <strong>prevents the degradation of ACh</strong> and prolongs the action of ACh at the muscle end plate.</p>\n<p><strong>Myasthenia gravis:</strong></p>\n<ul>\n<li>It is caused by the presence of antibodies to the ACh receptor.</li>\n<li>Is characterized by skeletal muscle weakness and fatigability resulting from a reduced number of ACh receptors on the muscle end plate.</li>\n<li>The size of the EPP (end plate potential) is reduced.</li>\n<li>Treatment with AChE inhibitors (e.g., neostigmine) prevents the degradation of ACh and prolongs the action of ACh at the muscle end plate, partially compensating for the reduced number of receptors.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old woman had an autonomic neuropathy that disrupted the sympathetic nerve supply to the pupillary dilator muscle of her right eye. While having her eyes examined, the ophthalmologist placed a sympathomimetic drug in both her eyes. The right eye became much more dilated than the left  eye. This suggests that:",
    "choices": [
      {
        "id": 1,
        "text": "The sympathetic nerve to the right eye had regenerated"
      },
      {
        "id": 2,
        "text": "The parasympathetic nerve supply to the right eye remained intact and compensated for the loss of the sympathetic nerve"
      },
      {
        "id": 3,
        "text": "Denervation supersensitivity had developed"
      },
      {
        "id": 4,
        "text": "The left eye also had nerve damage and so was not responding as expected"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Denervation supersensitivity</strong> develops in the muscle after the nerve supplying it is cut. Since the nerve to her right dilator pupillae is damaged, the right eye becomes excessively sensitive to the sympathomimetic drug. So, the right eye becomes much more dilated than the left.</p>\n<p><strong>Denervation Supersensitivity:</strong></p>\n<ul>\n<li>When the motor nerve to <strong>skeletal muscle</strong> is degenerated, the muscle gradually becomes extremely sensitive to acetylcholine. This is called denervation hypersensitivity or supersensitivity.</li>\n<li>Normally nicotinic receptors are located only in the vicinity of the motor endplate where the axon of the motor nerve terminates. When the motor nerve is severed, there is a <strong>marked proliferation of nicotinic receptors</strong> over a wide region of the neuromuscular junction.</li>\n<li>Denervation supersensitivity also occurs at <strong>autonomic junctions.</strong> Smooth muscle, unlike skeletal muscle, does not atrophy when denervated, but it becomes hyperresponsive to the chemical mediator that normally activates it.</li>\n<li>This hyperresponsiveness can be demonstrated by using pharmacologic tools rather than actual nerve section. Prolonged use of a drug such as reserpine can be used to deplete transmitter stores and prevent the target organ from being exposed to norepinephrine for an extended period. Once the drug usage is stopped, smooth muscle and cardiac muscle will be supersensitive to subsequent release of the neurotransmitter.</li>\n</ul>\n<p><strong>Option a</strong>) If the symapthetic nerve would have regenerated, both right and left eye would have been equally sensitive to the drug and so, would have dilated equally.</p>\n<p><strong>Option b</strong>) Parasympathetic nerves supply the spinchter pupillae muscle. So, if stimulated they would constrict the eye not dilate it. Also, the drug added was a sympathomimetic agent. So, parasympathetic nerves are not stimulated in the first place</p>\n<p><strong>Option d</strong>) If the left eye was damaged, it would also have denervation supersensitivity. Again, both eyes would dilate equally, but more than that of normal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following statements is not true about neurotransmitters?",
    "choices": [
      {
        "id": 1,
        "text": "They must be present at the pre-synaptic membrane"
      },
      {
        "id": 2,
        "text": "Neurons must be able to synthesize the substance"
      },
      {
        "id": 3,
        "text": "They are released on repolarization of the nerve"
      },
      {
        "id": 4,
        "text": "Specific receptors must be present on the post-synaptic membrane"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Neurotransmitters should be released on <strong>depolarization</strong> of the terminal.</p>\n<ul>\n<li>Neurotransmitters are the substances that mediate chemical signaling between neurons.</li>\n<li>The transmission of information at chemical synapses involves the release of neurotransmitter from a presynaptic cell, diffusion across the synaptic cleft, and binding of the neurotransmitter to specific receptors on the postsynaptic membrane to produce a change in membrane potential.</li>\n</ul>\n<p><strong>Criteria for the substance to be neurotransmitter</strong></p>\n<ul>\n<li>the substance must be demonstrated to be present in the presynaptic terminal</li>\n<li>the cell must be able to synthesize the substance.</li>\n<li>should be released on depolarization of the terminal.</li>\n<li>there should be specific receptors for it on the postsynaptic membrane.</li>\n<li>if the substance is applied exogenously to the postsynaptic membrane at physiologic concentration, the response of the postsynaptic cell must mimic the in vivo response</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Neurotransmitter can be degraded by all except_____",
    "choices": [
      {
        "id": 1,
        "text": "Can diffuse out of synaptic cleft"
      },
      {
        "id": 2,
        "text": "Enzymes inactivate it"
      },
      {
        "id": 3,
        "text": "Reuptake into glial cell"
      },
      {
        "id": 4,
        "text": "Autoreceptor"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"page\" title=\"Page 150\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The final steps in the process lead to termination of the actions of the neurotransmitter and include</p>\n<ul>\n<li>Reuptake into the nerve terminal or glial cell</li>\n<li>Enzymatic degradation.</li>\n<li>Diffusion away from the synaptic cleft</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following endogenous opioids is correctly matched with the receptor at which it has maximum potency?",
    "choices": [
      {
        "id": 1,
        "text": "Enkephalins - \u03b4 receptors"
      },
      {
        "id": 2,
        "text": "Dynorphins - \u03bc receptors"
      },
      {
        "id": 3,
        "text": "Endorphins - \u03ba receptors"
      },
      {
        "id": 4,
        "text": "Both B and C"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Enkephalins</strong> have maximum potency at <strong>&delta; receptors.</strong></p>\n<p><strong>Dynorphins</strong> have maximum potency at <strong>&kappa; receptors.</strong></p>\n<p><strong>Endorphins</strong> have maximum potency at <strong>&mu; receptors.</strong></p>\n<p><strong>Note: </strong>There is a difference of opinion among&nbsp;Goodman &amp; Gillman's textbook and Ganong&rsquo;s review of medical physiology(26th edition pg 151). According to&nbsp;Goodman &amp; Gillman's textbook above answer is correct.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following physiologic processes is not correctly paired with a structure?",
    "choices": [
      {
        "id": 1,
        "text": "Electrical transmission : gap junction"
      },
      {
        "id": 2,
        "text": "Negative feedback inhibition : Renshaw cell"
      },
      {
        "id": 3,
        "text": "Synaptic vesicle docking and fusion : presynaptic nerve terminal"
      },
      {
        "id": 4,
        "text": "Endplate potential : muscarinic cholinergic receptor"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<div class=\"page\" title=\"Page 143\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Endplate potential is generated via&nbsp;<strong>nicotinic</strong> <strong>cholinergic receptor.</strong></p>\n<p>The acetylcholine released from the motor neuron diffuses to nicotinic cholinergic (NM) receptors that are concentrated at the tops of the junctional folds of the membrane of the motor endplate.</p>\n<div class=\"page\" title=\"Page 143\">&nbsp;</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b3d26dadd99e4f16a56f1f18eea016cbx898x501.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f824254699e94a7bad9a532d759031b8x582x409.PNG"
    ]
  },
  {
    "text": "Which of the following electrophysiologic events is correctly paired with the change in ionic currents causing the event?",
    "choices": [
      {
        "id": 1,
        "text": "Fast inhibitory postsynaptic potentials (IPSPs) and closing of Cl\u2013 channels"
      },
      {
        "id": 2,
        "text": "Fast excitatory postsynaptic potentials (EPSPs) and an decrease in Ca2+ conductance"
      },
      {
        "id": 3,
        "text": "Endplate potential and an increase in Na+ conductance"
      },
      {
        "id": 4,
        "text": "Presynaptic inhibition and closure of voltage-gated K+ channels"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<div class=\"page\" title=\"Page 143\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Binding of acetylcholine to neuromuscular junction receptors increases the Na+ and K+ conductance, and the resultant influx of <strong>Na+</strong>&nbsp;produces a depolarizing potential, the <strong>endplate potential</strong>.</p>\n</div>\n</div>\n</div>\n<p><strong>IPSP may be due to</strong></p>\n<ul>\n<li>Opening of <strong>chloride ion channels</strong>&nbsp;through the postsynaptic neuronal membrane</li>\n<li>Increase in conductance of<strong> potassium ions </strong>out of the neuron.</li>\n<li>Activation of receptor enzymes&nbsp;that increase the number of inhibitory synaptic receptors or decrease the number of excitatory receptors.</li>\n</ul>\n<p><strong>EPSP may be due to</strong></p>\n<ul>\n<li>The<strong>&nbsp;opening</strong>&nbsp;of<strong>&nbsp;sodium channels</strong>&nbsp;to allow large numbers of positive electrical charges to flow to the interior of the postsynaptic cell.</li>\n<li><strong>Depressed</strong>&nbsp;conduction through<strong>&nbsp;chloride or potassium channels</strong>, or both.</li>\n<li>Various changes in the internal metabolism of the postsynaptic neuron to increase the number of excitatory membrane receptors or decrease the number of inhibitory membrane receptors.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "How is an electrical synapse different from a chemical synapse?",
    "choices": [
      {
        "id": 1,
        "text": "No cytoplasmic continuity between presynaptic and postsynaptic membrane"
      },
      {
        "id": 2,
        "text": "Direction of impulse is unidirectional"
      },
      {
        "id": 3,
        "text": "Connexons are involved in electrical synapse"
      },
      {
        "id": 4,
        "text": "Electrical synapse has more latent period than chemical synapse"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In <strong>electrical synapses</strong>, the cytoplasm of adjacent cells is directly connected by<strong> gap junctions (connexons)</strong> that allow free movement of ions from the interior of one cell to the interior of the next cell.</p>\n<p>The transmis&shy;sion in electrical synapses is<strong> bidirectional </strong>and there is<strong> no synaptic delay. </strong>Unlike chemical synapses, electrical synapse has<strong> cytoplasmic continuity.</strong></p>\n<p><strong>Note:&nbsp;</strong>&nbsp;</p>\n<p>Most of the synapses used for signal transmission in the central nervous system are chemical synapses.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = '09 Synapse And Junctional Transmission';
        let hierarchy = ["Marrow", "qBank", "Physiology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>