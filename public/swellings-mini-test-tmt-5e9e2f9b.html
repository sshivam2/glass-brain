<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swellings Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "During the examination of which of the following swellings would you expect to see transillumination?",
    "choices": [
      {
        "id": 1,
        "text": "1,4, 5"
      },
      {
        "id": 2,
        "text": "1,2,3,4"
      },
      {
        "id": 3,
        "text": "1,2,5"
      },
      {
        "id": 4,
        "text": "3,4,5"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Epididymal cyst, ranula, spermatocele,</strong>\u00a0and <strong>cystic hygroma</strong> show transillumination. Lipoma, due to its lipid content not allowing light to pass through, is not transilluminant.\u00a0</p>\n<p>Transillumination is a technique where a light source is used to shine light through a body part/ swelling to assess the characteristics of the tissue or fluid inside.\u00a0</p>\n<p>An<strong>\u00a0epididymal cyst</strong>\u00a0is a\u00a0<strong>multilocular</strong> cyst formed due to the cystic degeneration of the epididymis. Multiple cysts formed posterior to the epididymis can feel like a <strong>bunch of grapes on palpation</strong>. Due to the presence of\u00a0<strong>crystal clear fluid</strong>, an epididymal cyst brilliantly transilluminates and has a\u00a0<strong>Chinese lantern appearance</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3199100be6384a299ea693f1122b3373x904x484.PNG"
    ]
  },
  {
    "text": "A 65-year-old trumpet player presents with hoarseness of voice, cough, and neck swelling. The swelling increases in size on coughing and on performing Valsalva maneuver. CT neck is as follows. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "External Laryngocele"
      },
      {
        "id": 2,
        "text": "Mixed Laryngocele"
      },
      {
        "id": 3,
        "text": "Epiglottic cyst"
      },
      {
        "id": 4,
        "text": "Internal Laryngocele"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of hoarseness of voice, cough, neck swelling that increases in size on coughing/Valsalva maneuver and a gurgling sound heard on pressing the swelling are suggestive of\u00a0<strong>laryngocele. </strong>On CT the laryngocele extends <strong>both internally and externally, </strong>thus<strong> </strong>labelling<strong> </strong>this<strong> </strong>as<strong> </strong>the<strong> combined </strong>or<strong> mixed subtype.</strong></p>\n<p><strong>Laryngocele</strong> is an air-filled cystic swelling in the neck due to dilatation of the <strong>saccule.</strong> It is more commonly seen in <strong>trumpet players, glass-blowers, </strong>or <strong>weight lifters</strong> due to a raised transglottic air pressure in these people.\u00a0It can be classified into internal, external, or combined types of laryngocele.</p>\n<ul>\n<li><strong>Internal laryngocele</strong> is limited within the larynx and appears as distension of the false cord and aryepiglottic fold. CT below shows the presenc e of a right internal laryngocele.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/82bb399fa62f4a1782e6d78d0ead9715.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/af4d5d2005394f5f86498a1f795c57dfx512x561.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3fcf1aa2152f4eb8ac384c4bb03eb7c8x1280x1331.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/857cb49b2edb4e4fbf59056fde0b70dfx630x630.JPEG"
    ]
  },
  {
    "text": "A 5 year old boy is brought by his mother with a swelling on his head as shown below. Clinical examination revealed a 2x2  cm soft, fluctuant, non-tender, non-transilluminant, non-pulsatile swelling with absent central punctum. Palpation of the edge of the swelling yields to your finger. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Meningocele"
      },
      {
        "id": 2,
        "text": "Dermoid cyst"
      },
      {
        "id": 3,
        "text": "Lipoma"
      },
      {
        "id": 4,
        "text": "Sebaceous cyst"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient with a soft, fluctuant, non-tender, non-transilluminant, non-pulsatile swelling and an <strong>absent central punctum</strong> can be diagnosed as a case of <strong>dermoid cyst</strong>. The <strong>presence of a central punctum</strong> could tilt the diagnosis to a <strong>sebaceous cyst</strong>. Lipomas <strong>do not yield </strong>when pressure is applied to the <strong>edge</strong> of the swelling (slip sign <strong>positive</strong>).</p>\n<p>A dermoid cyst is a <strong>noncancerous</strong> skin abnormality that originates from the trapping of ectodermal components during embryonic closure characterized by the presence of stratified squamous epithelium. These tumours also exhibit mature skin appendages on their walls, and their lumens are packed with keratin and hair. Dermoid cysts are widely acknowledged as being congenital in nature; nonetheless, it is worth noting that not all instances of this condition are identified and diagnosed immediately after birth. Dermoid cysts predominantly manifest on the <strong>craniofacial</strong> region, with a substantial majority of 84% of these cysts being observed in this anatomical area.\u00a0</p>\n<p>Dermoid cysts present as firm <strong>painless</strong> subcutaneous nodules and are of 4 types:</p>\n<ul>\n<li><strong>Sequestration dermoid </strong>- sequestration of epithelium during embryological development</li>\n<li><strong>Tubulodermoid </strong>- accumulation of secretions from ectodermal tube/duct</li>\n<li><strong>Implantation dermoid</strong> - implantation of the epidermis due to trauma</li>\n<li><strong>Teratomatous dermoid</strong> - having all 3 germ layers (ecto, meso, and endoderm)</li>\n</ul>\n<p>Other options</p>\n<p>Option A: <strong>Meningoceles</strong> are uncommon at the location as shown in the image above. Meningocele also appears as soft to firm swellings which are <strong>transilluminant. </strong>The image\u00a0below shows the presence of a meningocele in the cervical area.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d90f9f920b67460d8421b43a1592a640.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/14de721caf7844cfa48c21d308e038f8x438x538.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c2deb2f545f4441aad9bef850e9299b0x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ec07fb0936a44a64a3a15d250e8fdebdx720x540.JPEG"
    ]
  },
  {
    "text": "A 3-year-old girl presents with swelling over her gluteal region as shown below. On each occasion when she is brought to the primary care physician, aspiration of the cyst results in the extraction of transparent fluid, with reappearance after a few weeks to months. Examination reveals a soft, compressible swelling that is brilliantly transilluminant. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Lipoma"
      },
      {
        "id": 2,
        "text": "Meningocele"
      },
      {
        "id": 3,
        "text": "Rhabdomyosarcoma"
      },
      {
        "id": 4,
        "text": "Meningomyelocele"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>This patient's swelling across her sacral area, along with repeated aspirates <strong>generating clear fluid </strong>and <strong>brilliant</strong> <strong>transillumination</strong>, is consistent with <strong>meningocele</strong>.\u00a0</p>\n<p><strong>Meningocele</strong> is the herniation of meninges through a weak spot of the spine when bone fusion has<strong> not taken place </strong>adequately. The swelling is enveloped by the pia mater and arachnoid mater, lacking a dural coating, and contains cerebrospinal fluid (CSF). It is <strong>most commonly</strong> found in the <strong>lumbosacral</strong> region with <strong>occipitocervical</strong> location being the <strong>second</strong> most commonest.</p>\n<table style=\"border-collapse: collapse; width: 41.2116%;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 28.6677%;\">\u00a0</td>\n<td style=\"width: 29.781%;\">Meningocele</td>\n<td style=\"width: 41.7491%;\">Meningomyelocele</td>\n</tr>\n<tr>\n<td style=\"width: 28.6677%;\">Consistency</td>\n<td style=\"width: 29.781%;\">Soft and cystic\u00a0</td>\n<td style=\"width: 41.7491%;\">Soft/ Firm</td>\n</tr>\n<tr>\n<td style=\"width: 28.6677%;\">Neurological deficit</td>\n<td style=\"width: 29.781%;\">Absent\u00a0</td>\n<td style=\"width: 41.7491%;\"><strong>Present</strong></td>\n</tr>\n<tr>\n<td style=\"width: 28.6677%;\">Transillumination test</td>\n<td style=\"width: 29.781%;\"><strong>Positive</strong></td>\n<td style=\"width: 41.7491%;\">Negative</td>\n</tr>\n<tr>\n<td style=\"width: 28.6677%;\">Prognosis after repair</td>\n<td style=\"width: 29.781%;\">Good\u00a0</td>\n<td style=\"width: 41.7491%;\">Not favourable</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/22054a294ded4b0d8a51033db5356cff.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/edcd997e3779469ca78d5bbd55823aadx300x242.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3bbed85cc7cc449fbd76ddbbbb2e06d3x500x254.JPEG"
    ]
  },
  {
    "text": "A 45-year-old comes to you with a swelling over her wrist as shown below. She does not complain of any pain or sudden increase in the size of the swelling. Examination reveals firm, fluctuant,transilluminant mass. What is the most likely diagnosis based on the aforementioned findings?",
    "choices": [
      {
        "id": 1,
        "text": "Implantation dermoid"
      },
      {
        "id": 2,
        "text": "Sebaceous cyst"
      },
      {
        "id": 3,
        "text": "Lipoma"
      },
      {
        "id": 4,
        "text": "Ganglion cyst"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient's cyst on the dorsum of the hand which is firm, fluctuant and transilluminant is suggestive of a diagnosis of <strong>ganglion cyst.\u00a0</strong></p>\n<p>A diagnosis of <strong>ganglion cyst </strong>was made because of its <strong>location </strong>(dorsum of the hand is very common)<strong> </strong>\u00a0and because lipoma, dermoid and sebaceous cyst are <strong>not transilluminant.</strong></p>\n<p><strong>Ganglion cyst </strong>is a swelling that might manifest in association with a tendon sheath, synovial sheath, or joint capsule. The substance contained within it is comprised of a <strong>transparent</strong>, <strong>gelatinous</strong> fluid. The precise aetiology of ganglion cyst formation remains uncertain; nevertheless, it is hypothesized that they originate from recurrent <strong>microtrauma</strong>, leading to<strong> mucinous degeneration of connective tissue</strong>. Soft tissue masses are frequently observed in the <strong>dorsum of the hand</strong> and wrist, making them the <strong>most prevalent</strong> in these regions. However, they are also frequently encountered in the knee and foot. While the majority of ganglion cysts <strong>do not exhibit symptoms</strong>, patients may experience discomfort, tenderness, and express unhappiness with the cyst's visual appearance. Both <strong>aspiration</strong> and <strong>surgical excision</strong> are viable options to be considered. It is imperative to ensure that patients are adequately educated about the<strong> potential for recurrence</strong>.\u00a0</p>\n<p>Other options:</p>\n<p>Option A: Prevalence of<strong> implantation dermoid</strong> is frequently observed in the digits of the hand (particularly among <strong>tailors</strong> and <strong>gardeners</strong>) <strong>following</strong> <strong>trauma</strong>. The occurrence of swelling is typically devoid of discomfort and is commonly noticed subsequent to small trauma, exhibiting a gradual progression primarily in the digits of the hands or feet. The observed lesion exhibits characteristics of smoothness, softness, <strong>mobility</strong>, tensile cystic structure, <strong>lack of transillumination</strong>, and frequent adherence to the skin. The lesion comprises of squamous epithelial cells, devoid of hair follicles, sweat glands, or sebaceous glands.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/aaccc9bb62d140d78f25815f901a4f2e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dd7c16d3cdf94c2a9989983d42475334x482x346.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2815f454124d47239161457f7537b039x720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e5192e79941f43619adc9b9452a9e0b2x800x600.JPEG"
    ]
  },
  {
    "text": "A 65-year-old woman presents to the OPD with complaints of inability to extend her 4th and 5th digits. Later, she noticed several painless nodules on her palms and her fingers becoming stiffer over time. On examination, the following findings were found. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Implantation dermoid"
      },
      {
        "id": 2,
        "text": "Dupuytren's contracture"
      },
      {
        "id": 3,
        "text": "Osler's nodes"
      },
      {
        "id": 4,
        "text": "Ganglion cyst"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical features and image suggest the diagnosis of <strong>Dupuytren's contracture</strong>.</p>\n<div class=\"page\" title=\"Page 463\">The main causes of this condition include:</div>\n<ul>\n<li><strong>trauma</strong>\u00a0of chronic\u00a0<strong>repetitive</strong>\u00a0nature</li>\n<li><strong>heredity (Autosomal dominant)</strong></li>\n<li>epileptics receiving <strong>phenytoin</strong> therapy</li>\n<li>associations with diabetes, epilepsy, smoking, alcoholic cirrhosis, AIDS, and pulmonary tuberculosis</li>\n<li>occupational causes such as\u00a0<strong>vibrations</strong>\u00a0of machines</li>\n</ul>\n<div class=\"page\" title=\"Page 463\">Dupuytren's contracture is a <strong>proliferating fibroplasia</strong> of the <strong>subcutaneous palmar tissue</strong>, forming nodules of cords along its ulnar border. It results in <strong>finger contractures</strong>, thinning of subcutaneous fat, pitting of skin and knuckle pads. It is more common in males than females. The prevalence increases with age, but onset at an early stage usually means aggressive disease.</div>\n<div class=\"page\" title=\"Page 463\">\u00a0</div>\n<div class=\"page\" title=\"Page 463\"><strong>Clinical features:</strong></div>\n<div class=\"page\" title=\"Page 463\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The patient complains of a <strong>nodular thickening</strong> in the palm or finger. The <strong>palm of the ring finger</strong> and the <strong>PIP of the little finger</strong> are the most commonly involved. Initially, the lesion is painless, later it may result in slight tenderness. Often both hands are involved. Gradually the nodules may thicken and contract, forming <strong>cords</strong>. If the subcutaneous cords extend into the fingers, they may produce <strong>flexion deformities</strong> at the MCP and PIP joints. Sometimes the dorsal knuckle pads are thickened, known as <strong>Garrod\u2019s pads.</strong></p>\n<p><strong>Treatment of Dupuytren Disease -\u00a0</strong></p>\n<table style=\"border-collapse: collapse; width: 42.9555%; height: 201.586px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 42.1832%; height: 22.3984px;\"><strong>Nonoperative</strong></td>\n<td style=\"width: 57.8168%; height: 22.3984px;\"><strong>Operative</strong></td>\n</tr>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 42.1832%; height: 44.7969px;\">External beam radiation</td>\n<td style=\"width: 57.8168%; height: 44.7969px;\">1.Subcutaneous fasciotomy</td>\n</tr>\n<tr style=\"height: 44.7969px;\">\n<td style=\"width: 42.1832%; height: 44.7969px;\">Steroid injection</td>\n<td style=\"width: 57.8168%; height: 44.7969px;\">2.Partial (selective) fasciectomy</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 42.1832%; height: 22.3984px;\">Collagenase</td>\n<td style=\"width: 57.8168%; height: 22.3984px;\">3.Complete fasciectomy</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 42.1832%; height: 22.3984px;\">\u00a0</td>\n<td style=\"width: 57.8168%; height: 22.3984px;\">4.Fasciectomy with skin grafting</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 42.1832%; height: 22.3984px;\">\u00a0</td>\n<td style=\"width: 57.8168%; height: 22.3984px;\">5.Staged external fixation</td>\n</tr>\n<tr style=\"height: 22.3984px;\">\n<td style=\"width: 42.1832%; height: 22.3984px;\">\u00a0</td>\n<td style=\"width: 57.8168%; height: 22.3984px;\">6.Arthrodesis</td>\n</tr>\n<tr>\n<td style=\"width: 42.1832%;\">\u00a0</td>\n<td style=\"width: 57.8168%;\">7.Amputation</td>\n</tr>\n</tbody>\n</table>\n<p><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Z-plasty is used for the </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">lengthening of linear scars</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">. It is best used in releasing simple contractures. The image below shows\u00a0</span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Z-plasty:</strong></p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/be4408f4fae2492aa6a25101df79c0c7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/76d610b7476641f084aea48dc91e5883x482x346.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2db5824b2b92461196a0396b6f26f37dx1280x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2922b415a7384a56830035fac6610156x720x881.JPEG"
    ]
  },
  {
    "text": "A 40-year-old tailor comes to you with swelling on the palm of his hand from an injury he sustained two years ago while sewing. The swelling is non-transilluminant with no pain, fever, or discharge associated with the swelling. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ganglion cyst"
      },
      {
        "id": 2,
        "text": "Sebaceous cyst"
      },
      {
        "id": 3,
        "text": "Lipoma"
      },
      {
        "id": 4,
        "text": "Implantation dermoid"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient's cyst on the <strong>palmar</strong> aspect of the hand with <strong>non-transilluminancy</strong> following trauma during sewing is suggestive of a diagnosis of <strong>implantation dermoid</strong>.</p>\n<p>A diagnosis of<strong> implantation dermoid </strong>was made because of an increased occurrence of the lesion<strong> following trauma</strong> (common among farmers, tailors) as well as its <strong>non-transluminant</strong> nature. <strong>Ganglion cysts </strong>are usually <strong>transilluminant</strong> which more <strong>commonly</strong> occur on the <strong>dorsum of the hand</strong>.</p>\n<p><strong>Implantation dermoid </strong>is frequently observed in the digits of the hand (particularly among tailors and gardeners) following trauma. The occurrence of swelling is typically devoid of discomfort and is commonly noticed <strong>subsequent to small trauma</strong>, exhibiting a gradual progression primarily in the digits of the hands or feet. The observed lesion exhibits characteristics of smoothness, softness, mobility, tensile cystic structure, <strong>lack of transillumination</strong>, and frequent adherence to the skin. The lesion comprises of squamous <strong>epithelial</strong> cells, devoid of hair follicles, <strong>sweat</strong> <strong>glands</strong>, or sebaceous glands.\u00a0</p>\n<p><strong>Complications</strong> of i<strong>mplantation dermoid</strong> include <strong>infection</strong>, cyst <strong>rupture</strong> as well as <strong>pressure effect</strong> over the digital nerves. Other close<strong> differentials</strong> of this swelling include lipoma and bursa. Treatment includes <strong>surgical excision</strong> of the dermoid with <strong>local anaesthesia</strong>.</p>\n<p>Other options</p>\n<p>Option A: <strong>Ganglion cyst</strong> is a swelling that might manifest in association with a tendon sheath, synovial sheath, or joint capsule. The substance contained within it is comprised of a transparent, gelatinous fluid. The precise aetiology of ganglion cyst formation remains uncertain; nevertheless, it is hypothesized that they originate from recurrent microtrauma, leading to <strong>mucinous degeneration of connective tissue.</strong> Soft tissue masses are frequently observed in the <strong>dorsum of the hand and wrist</strong>, making them the most prevalent in these regions.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/961cd9ff892a46c2af9e6e3408eea6a5.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3d21bde901a2471c8093084a031cca54x720x881.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2815f454124d47239161457f7537b039x720x540.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e5192e79941f43619adc9b9452a9e0b2x800x600.JPEG"
    ]
  },
  {
    "text": "A male patient presents with a diffuse swelling over the abdomen as shown in the image below. The swelling is warm,  pits on pressure and is associated with fever. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Erysipelas"
      },
      {
        "id": 2,
        "text": "Lipoma"
      },
      {
        "id": 3,
        "text": "Cellulitis"
      },
      {
        "id": 4,
        "text": "Mesenteric cyst"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient's lesion on the abdomen is <strong>poorly defined</strong> with associated <strong>warmth</strong>, <strong>fever</strong> and <strong>edema</strong> (pits on pressure) which is consistent with <strong>cellulitis</strong>.\u00a0</p>\n<p><strong>Cellulitis</strong> is a painful, diffuse infection of the dermis and the subcutaneous tissue. It is characterized by <strong>poorly demarcated </strong>areas of marked edema, dilated superficial capillaries, and extravasation of red blood cells and inflammatory cells into the dermis.\u00a0It is most commonly caused by beta-haemolytic Streptococci, Staphylococci, and Clostridium perfringens. The point of entry may be a traumatic or surgical wound.</p>\n<p><strong>Lower limbs</strong> are the <strong>commonest</strong> site of cellulitis and any wound, including tinea pedis or bacterial infection, is a possible site of entry. The <strong>face</strong> is the next common site of infection.</p>\n<p>Clinical features include:</p>\n<ul>\n<li>Constitutional symptoms like fever and malaise</li>\n<li>Local symptoms like erythema, heat, swelling, and tenderness</li>\n</ul>\n<p>Parenteral <strong>penicillin</strong> is the <strong>treatment of choice</strong>. Other regimens may include antistaphylococcal penicillins, cefazolin, ceftaroline, and ceftriaxone.</p>\n<table style=\"border-collapse: collapse; width: 60.1193%;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 50.0459%;\"><strong>Erysipelas</strong> (St.Anthony's fire)</td>\n<td style=\"width: 50.0459%; text-align: center;\"><strong>Cellulitis</strong></td>\n</tr>\n<tr>\n<td style=\"width: 50.0459%;\">Infection of superficial dermal lymphatics</td>\n<td style=\"width: 50.0459%;\">Suppurative inflammation involving the subcutaneous tissue</td>\n</tr>\n<tr>\n<td style=\"width: 50.0459%;\">Raised and sharply demarcated edge that spreads by peripheral extension</td>\n<td style=\"width: 50.0459%;\"><strong>Diffuse</strong>, ill-defined margins</td>\n</tr>\n<tr>\n<td style=\"width: 50.0459%;\">Blistering is common with superficial hemorrhage\u00a0</td>\n<td style=\"width: 50.0459%;\">Severe cellulitis may show bullae and progress to dermal necrosis</td>\n</tr>\n<tr>\n<td style=\"width: 50.0459%;\">Extends over the ear</td>\n<td style=\"width: 50.0459%;\"><strong>Does not extend over the ear</strong></td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d72b2e3385b547c2bbaadaf90500e923.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1a391a535aa64f6b929821794d5ac468x675x900.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/997e9e01fe254314b12a794630d6c59bx800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4c905c8c84974e78b40b7defd0179d03x1280x1930.JPEG"
    ]
  },
  {
    "text": "A 35-year-old man presents with a swelling on his finger as shown below. The swelling bleeds on touch and does not demonstrate any correlation with pain, regardless of exposure to cold stimuli. These clinical findings are most consistent with a diagnosis of?",
    "choices": [
      {
        "id": 1,
        "text": "Pyogenic granuloma"
      },
      {
        "id": 2,
        "text": "Glomus tumor"
      },
      {
        "id": 3,
        "text": "Implantation dermoid"
      },
      {
        "id": 4,
        "text": "Koenen tumor"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p style=\"text-align: justify;\">A <strong>painless</strong> swelling which has the <strong>tendency to bleed on touch</strong> without correlation to temperature is suggestive of a diagnosis of <strong>pyogenic granuloma.\u00a0Glomus tumors</strong> on the other hand exhibit an <strong>increase in pain in response to cold stimuli.\u00a0</strong></p>\n<p style=\"text-align: justify;\"><strong>Pyogenic granulomas\u00a0</strong>are <strong>capillary hemangiomas</strong> that appear as\u00a0<strong>red pedunculated lesions</strong> on the skin, gingival, or oral mucosa.\u00a0They are most commonly <strong>benign</strong>. They tend to grow rapidly, <strong>bleed easily</strong> and are often ulcerated. The term pyogenic granuloma is a <strong>misnomer</strong> as it <strong>neither</strong> contains <strong>pus</strong> <strong>nor</strong> is it a <strong>granulomatous</strong> lesion. The potential <strong>cause</strong> could be attributed to a <strong>minor traumatic event</strong>.</p>\n<p>Histologic image of pyogenic granuloma:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/00ccc945228c4b8493fb1375cbad768d.JPEG"
    ],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/131cbfaffd504949bc9c7c022032a242x259x194.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d154a8c05baf45b0b274868274e500b2x720x580.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a79eb9ab4f394f0d8cec58cdcfc284d6x482x346.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3dd828b274af499b8995ae45bfd21bc6x720x539.JPEG"
    ]
  },
  {
    "text": "A 35-year-old woman presents with a swelling as shown in the image which can be moved horizontally but not vertically. Also, fingers were raised but not separated when placed on the surface of the tumor. Based on the above clinical findings, what is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Neurofibroma"
      },
      {
        "id": 2,
        "text": "Lipoma"
      },
      {
        "id": 3,
        "text": "Laryngocele"
      },
      {
        "id": 4,
        "text": "Carotid body tumour"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>This patient with a tumour on the lateral side of her neck which does not permit vertical movement but<strong> only horizontal movement </strong>as well as <strong>transmitted</strong> <strong>pulsation</strong> is most likely a carotid body tumour.</p>\n<p>The <strong>pulsatile</strong> swellings, which originate from the arteries, include aneurysms and vascular growths like carotid body tumours. The pulsations of the swellings, which are located in close proximity to the artery and lie superficially to it, can be observed. The phenomenon referred to as transmitted pulsation is distinguished from expansile pulsation, which is generated by the artery walls. <strong>Expansile</strong> swellings would not only <strong>lift </strong>the finger but <strong>also</strong> <strong>separate</strong> the fingers whereas <strong>transmitted</strong> pulsations <strong>only</strong> <strong>lift</strong> the fingers but <strong>do not separate them.</strong></p>\n<p><strong>Carotid body tumour:</strong></p>\n<ul>\n<li>It arises from the chemoreceptor cells in the carotid body, hence called <strong>chemodectoma</strong>.</li>\n<li>Mostly presents after <strong>40 years</strong>.</li>\n<li>It is a very <strong>slow-growing tumour.</strong></li>\n</ul>\n<p><strong> Features:</strong></p>\n<ul>\n<li><strong> Painless swelling which is pulsatile</strong>.</li>\n<li><strong> Bruit</strong> can be heard with a stethoscope.</li>\n<li>It moves from <strong>side to side</strong> but not vertically.</li>\n<li>It may extend into the\u00a0parapharyngeal\u00a0space and present in the\u00a0oropharynx.</li>\n<li>Some tumours are functional and <strong>secrete catecholamines</strong>.</li>\n</ul>\n<p>Contrast-enhanced CT and MRI with gadolinium are diagnostic and also show the extent of the tumour. <strong>MRI angiography shows splaying of internal and external carotid arteries (Lyre\u2019s sign)</strong>. Serum\u00a0catecholamines\u00a0and urinary meta-nephrines\u00a0and\u00a0vanillyl\u00a0mandelic\u00a0acid (VMA) should be estimated.</p>\n<p>Fine-needle aspiration cytology (FNAC) or<strong> biopsy should not be done</strong> because of the\u00a0vascularity\u00a0of tumour.</p>\n<p><strong>MRI angiography</strong> below shows splaying of internal and external carotid arteries - <strong>Lyre\u2019s sign</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b84deb0fa2894033b79203df5a5b73a0.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7f03457e073c40ee96d464976a94d1cax720x518.PNG"
    ]
  },
  {
    "text": "An elderly man presents with bilateral lower limb swelling which has gradually progressed over the years to present size as shown in the image below. The patient lives in a highland tribal community that continues the practice of walking barefoot. Filarial antigen test is negative. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Filariasis"
      },
      {
        "id": 2,
        "text": "Milroy disease"
      },
      {
        "id": 3,
        "text": "Podoconiosis"
      },
      {
        "id": 4,
        "text": "Mycetoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This patient who walks barefoot and lives in a hilly area can be identified as a potential case of Podoconiosis based on a <strong>negative filarial antigen test</strong>.</p>\n<p><strong>Podoconiosis</strong> mainly affects people who <strong>do not maintain the hygiene of the foot</strong> and who stay in hilly regions close to <strong>volcanic</strong> sites which are rich in irritant <strong>red clay soil\u00a0</strong>which leads to absorption of the <strong>silica particles</strong> in the volcanic rock.</p>\n<p><strong>Podoconiosis</strong>, often known as \"<strong>dust in the feet</strong>,\" causes bilateral asymmetrical lower extremity edema. This tropical lymphedema resembles lymphatic filariasis. Podoconiosis, commonly known as <strong>endemic non-filarial elephantiasis </strong>or \"mossy foot,\" is a non-infectious ailment caused by prolonged barefoot contact with volcanic red clay soil, an irritant. The exact cause of this debilitating condition is unknown, however transdermal migration of <strong>silica and aluminium silicate microparticles</strong> may cause an abnormal inflammatory response. The particles are absorbed by lymphatic system macrophages, causing an inflammatory response that leads to fibrosis and channel obstruction.</p>\n<p>The disease progresses through <strong>prodromal</strong>, <strong>early</strong>, and <strong>late</strong> stages. Forefoot pruritus, burning in the foot and lower leg, fluctuating chills, and generalized arthralgia define the prodromal phase. The symptoms above may progress to forefoot swelling, splaying, and clear lymph fluid leakage. The epidermis forms hyperkeratotic papillomata that resemble moss or velvet, hence the name \"<strong>mossy foot</strong>\" in African vernacular. Acute episodes may include fever, rigors, and fast leg discomfort and edema. In the advanced stage, both lower legs may acquire hard, fibrotic edema, with one leg usually worse. Podoconiosis is more common in <strong>Ethiopia</strong> and widespread in tropical <strong>Africa</strong>, Central and South America, Indonesia and <strong>northwestern parts of India.\u00a0</strong></p>\n<p>Other options</p>\n<p>Option A:\u00a0<strong>Lymphatic filariasis</strong> is caused by Wuchereria bancrofti and Brugia malayi. Elephantiasis is a delayed sequel to repeated lymphangitis, obstruction, and lymphedema. Repeated leakage of lymph into tissues first results in lymphedema, then to elephantiasis. A <strong>negative filarial antigen test</strong> makes this <strong>diagnosis unlikely</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f2bf86d2852944598fbfd06a9d4518ff.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b309a7ff362c4178bd121c5ffc80b057x720x496.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b0ca6add51964e7e9a134ecc19a69148x720x614.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/385e8e988bd741cb8ecf4b9841a7c9f3x512x381.PNG"
    ]
  },
  {
    "text": "A 3-year-old child is brought to the pediatrician for the evaluation of a neck mass. On examination, a painless, soft, fluctuating mass is found on the posterior triangle of the neck, as shown in the image below. The slip sign is negative and the swelling is brilliantly transilluminant. Which of the following is not a treatment option for this child?",
    "choices": [
      {
        "id": 1,
        "text": "Sistrunk operation"
      },
      {
        "id": 2,
        "text": "Aspiration"
      },
      {
        "id": 3,
        "text": "Sclerosant injection"
      },
      {
        "id": 4,
        "text": "Excision"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above clinical scenario along with the image showing\u00a0<strong>mass</strong> in the posterior triangle of the neck which is <strong>fluctuant</strong> and <strong>brightly transilluminant</strong> is suggestive of\u00a0<strong>cystic hygroma</strong>. <strong>Sistrunk operation\u00a0</strong>is not a treatment option for cystic hygroma. It is the surgery done for <strong>a thyroglossal cyst </strong>and<strong> limb reduction surgeries</strong> in patients with<strong> lymphedema.</strong></p>\n<p><strong>Cystic hygroma/cavernous lymphangioma</strong>\u00a0is a lymph filled sac that results from the <strong>obstruction</strong> of the lymph vessels during their development.</p>\n<p>Clinically, it presents as a mass in the <strong>posterior triangle</strong> of the neck. The mass may be apparent at birth or may appear in early childhood due to the increased accumulation of lymph. On examination, it appears as a <strong>soft</strong>,<strong> fluctuating</strong>, and <strong>brilliantly transilluminant </strong>since the sac is filled with lymph.</p>\n<p>Complications of cystic hygroma include respiratory difficulty, secondary infection, and chylothorax.</p>\n<p>Management:</p>\n<ul>\n<li>Primarily, the treatment includes <strong>aspiration\u00a0</strong>(Option B) of the contents. Later once the sac or capsule gets thickened by fibrous tissue, it is excised.</li>\n<li><strong>Single</strong> cysts are treated with <strong>sclerosing therapy</strong> (Option C). Commonly used sclerosants include\u00a0OK\u2013 432 which is an inactive strain of group A <em>Streptococcus pyogenes</em>, pure ethanol, interferon \u03b1 2a, and doxycycline.</li>\n<li><strong>Multiple</strong> cysts are treated by complete <strong>excision</strong> of the cyst (Option D).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c0c4d339c0494f3b8ab3d19e07723993.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following swellings can move with deglutition?",
    "choices": [
      {
        "id": 1,
        "text": "1,3"
      },
      {
        "id": 2,
        "text": "1,2,3,4"
      },
      {
        "id": 3,
        "text": "Only 1"
      },
      {
        "id": 4,
        "text": "3,4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The swellings that move with deglutition include:</p>\n<ul>\n<li>Thyroglossal cyst</li>\n<li>Dermoid cyst (if <strong>attached</strong> to the <strong>hyoid</strong>)</li>\n<li>Pre or Paratracheal lymph node enlargement</li>\n<li>Subhyoid bursitis\u00a0</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 32-year-old male patient presented with a scrotal swelling. On examination, the testis is felt separate from the scrotal swelling and the swelling is brilliantly transilluminant, as shown in the image below. What is the probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Varicocele"
      },
      {
        "id": 2,
        "text": "Epididymal cyst"
      },
      {
        "id": 3,
        "text": "Spermatocele"
      },
      {
        "id": 4,
        "text": "Chylocele"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario of a <strong>transilluminant scrotal swelling</strong> palpated <strong>apart from normal testes</strong> is suggestive of an <strong>epididymal cyst</strong>.\u00a0</p>\n<p>An<strong> epididymal cyst</strong> is a <strong>multilocular</strong> cyst formed due to is the cystic degeneration of the epididymis. Multiple cysts formed posterior to the epididymis can feel like a <strong>bunch of grapes on palpation</strong>. Due to the presence of <strong>crystal clear fluid</strong>, an epididymal cyst brilliantly transilluminates and has a <strong>Chinese lantern appearance</strong>.</p>\n<p>The image shows the Chinese lantern appearance on transillumination:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/46722655457c465badbeeb27eadd0970.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3199100be6384a299ea693f1122b3373x904x484.PNG"
    ]
  },
  {
    "text": "A young boy who is a known case of Klinefelter's syndrome presents with a painless scrotal swelling and precocious puberty. After an initial ultrasound that revealed a testicular mass, surgical removal was done. The specimen was sent for histopathological analysis; the findings are shown in the image below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Leydig cell tumor"
      },
      {
        "id": 2,
        "text": "Sertoli cell tumor"
      },
      {
        "id": 3,
        "text": "Yolk-sac tumor"
      },
      {
        "id": 4,
        "text": "Seminoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical scenario with the biopsy findings points towards the <strong>diagnosis</strong> of a <strong>Leydig cell tumor.</strong></p>\n<p>Development of a <strong>painless testicular mass</strong> in a child with a history of <strong>Kleinfelter's</strong> syndrome and <strong>precocious puberty</strong> is suggestive of an androgen-secreting tumor\u00a0like <strong>Leydig cell tumor.</strong> The biopsy shows large polygonal cells with a round to oval nucleus and deeply acidophilic with granular cytoplasm. The cytoplasm also shows <strong>rod-shaped crystals</strong> referred to as <strong>\"crystalloids of Reinke\"</strong>\u00a0which confirms the diagnosis.</p>\n<p><strong>Leydig cell</strong> tumors are <strong>sex-cord stromal cell</strong> tumors of the testis. They predominantly <strong>secrete androgens</strong> and in some cases estrogen and corticosteroids as well. The most common presenting features in prepubertal children are painless testicular swelling and precocious puberty. Leydig-cell tumors are associated with:</p>\n<ul>\n<li><strong>Kleinfelter's syndrome</strong></li>\n<li>Cryptorchidism</li>\n<li>Hereditary leiomyomatosis</li>\n<li>Renal cell carcinoma syndrome caused by germline mutations in the enzyme fumarate hydratase.</li>\n</ul>\n<p>It appears as a homogenous golden-brown tumor, that is usually less than 5cm. On microscopy, round or polygonal cells with a round to oval nucleus and deeply acidophilic with granular cytoplasm are seen. In about 25% of the patients, the cytoplasm contains\u00a0crystalloids of Reinke as shown below:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d4d33f45a9364f9493b7c2f35daaba6a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0f5319c981314337b6820d454efbb6bbx1280x1065.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/dbcffb3d6905414d93ff73a276a30506x510x409.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b0f8f4eb75874f33a2350d137d983e6ax1280x948.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8db48763b9094bd58b36c4d8615ccb08x800x533.JPEG"
    ]
  },
  {
    "text": "While going through the case sheets of patients admitted to the surgery ward during your internship, you noticed thyroid FNAC of patient A and patient B were reported as Thy 2 and Thy 4 respectively based on the Royal College of Pathologists classification. How would you interpret these FNAC reports?",
    "choices": [
      {
        "id": 1,
        "text": "Thyroid swelling in patient A is non-diagnostic (cystic) and patient B's is suspicious of malignancy"
      },
      {
        "id": 2,
        "text": "Thyroid swelling in patient A is follicular and patient B's is malignant"
      },
      {
        "id": 3,
        "text": "Thyroid swelling in patient A is non-neoplastic and patient B's is follicular"
      },
      {
        "id": 4,
        "text": "Thyroid swelling in patient A is non-neoplastic and patient B's is suspicious of malignancy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Thy 2</strong>\u00a0in FNAC corresponds to\u00a0<strong>Non-neoplastic lesions\u00a0</strong>and\u00a0<strong>Thy 4\u00a0</strong>would correspond to\u00a0<strong>suspicion of malignancy.</strong></p>\n<p class=\"p1\">FNAC has excellent patient compliance. It is simple and quick to perform.\u00a0</p>\n<p>Classification of fine-needle aspiration cytology reports according to the<strong>\u00a0Royal College of Pathologists,</strong></p>\n<table>\n<tbody>\n<tr>\n<td><strong>Type</strong></td>\n<td><strong>Meaning</strong></td>\n</tr>\n<tr>\n<td><strong>Thy 1</strong></td>\n<td>Non diagnostic</td>\n</tr>\n<tr>\n<td><strong>Thy 1c</strong></td>\n<td>Non diagnostic cystic</td>\n</tr>\n<tr>\n<td><strong>Thy 2</strong></td>\n<td>Non neoplastic</td>\n</tr>\n<tr>\n<td><strong>Thy 3</strong></td>\n<td>Follicular</td>\n</tr>\n<tr>\n<td><strong>Thy 4 </strong></td>\n<td><strong>Suspicious of malignancy</strong></td>\n</tr>\n<tr>\n<td><strong>Thy 5</strong></td>\n<td>Malignancy\u00a0</td>\n</tr>\n</tbody>\n</table>\n<p>\u00a0</p>\n<p>Note: There are 3 major internationally accepted systems for reporting thyroid FNAC results namely the Bethesda system, Royal college of Pathologists and Italian classification. Recently, efforts have been made to create one standardised reporting system.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old man presented with painless swelling as shown below. On examination, the swelling is soft, cystic, and transillumination positive. Which of the following is false regarding the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "The swelling arises from remnants of 2nd branchial cleft"
      },
      {
        "id": 2,
        "text": "Situated deep to glossopharyngeal nerve"
      },
      {
        "id": 3,
        "text": "The cystic swelling is lined by squamous epithelium"
      },
      {
        "id": 4,
        "text": "FNAC from the swelling may show cholesterol crystals"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above clinical scenario is suggestive of the <strong>branchial</strong> <strong>cyst</strong>. It lies <strong>superficial</strong> to the&nbsp;<strong>hypoglossal</strong> and<strong> glossopharyngeal nerves</strong>&nbsp;but <strong>deep</strong> to the <strong>posterior belly</strong> of the <strong>digastric.</strong></p>\n<p>The branchial cyst <strong>arises</strong> from the<strong>&nbsp;remnants</strong>&nbsp;of the&nbsp;<strong>2nd branchial cleft.</strong>&nbsp;Normally, 2nd, 3rd, and 4th clefts disappear to form a smooth neck. A persistent second cleft is called&nbsp;<strong>cervical sinus </strong>(of His)&nbsp;which eventually gets sequestered to form a branchial cyst.</p>\n<div class=\"page\" title=\"Page 442\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Swelling in the neck beneath the&nbsp;<strong>anterior border</strong>&nbsp;of the&nbsp;<strong>upper third of the sternomastoid muscle</strong>. It is <strong>smooth, soft,</strong> <strong>fluctuant</strong>, and often&nbsp;<strong>transilluminate.&nbsp;</strong>Even though <strong>congenital</strong>, it is seen in <strong>late adolescents</strong> and <strong>early 3rd decade.</strong></p>\n<p>Histologically, it is lined by&nbsp;<strong>squamous epithelium.</strong>&nbsp;The cyst wall shows plenty of lymphoid tissue. It may get infected to form an abscess.</p>\n<p>FNAC shows&nbsp;<strong>cholesterol crystals</strong>&nbsp;which are derived from the sebaceous glands in the lining mucous membrane.</p>\n<p>Treatment is by&nbsp;<strong>complete excision</strong>, which is best undertaken when the lesion is quiescent.&nbsp;It passes superficial to the&nbsp;<strong>hypoglossal</strong> and<strong> glossopharyngeal nerves</strong>&nbsp;but deep to the posterior belly of the digastric. These structures and the&nbsp;<strong>spinal accessory</strong>&nbsp;nerve must be positively identified to avoid damage.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5b3457f518ca432ba9ab822671f8b020.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 23-year-old man presents to the OPD with odynophagia and swelling. He is diagnosed with Ludwig\u2019s angina. How might you describe the swelling?",
    "choices": [
      {
        "id": 1,
        "text": "Tender fluctuant swelling in the floor of mouth"
      },
      {
        "id": 2,
        "text": "Tender fluctuant swelling in the parotid region"
      },
      {
        "id": 3,
        "text": "Woody hard swelling in the floor of mouth"
      },
      {
        "id": 4,
        "text": "Woody hard swelling in the parotid region"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Ludwig's angina</strong> presents as a tender&nbsp;<strong>woody hard swelling</strong> on the <strong>floor of the mouth</strong>.</p>\n<p>There can be marked difficulty in swallowing (<strong>odynophagia</strong>) with varying degrees of trismus.&nbsp;The tongue is progressively pushed upwards and backward, <strong>threatening the airway</strong>.&nbsp;<strong>Laryngeal edema</strong> may also be present.</p>\n<p>Usually, there is <strong>cellulitis of the tissues</strong> rather than frank abscess. Incision and drainage show <strong>salted pork appearance</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old man presents with swelling in the lower part of the thigh.  During the night, he has severe pain in the region of the swelling, and the pain reduces after taking aspirin. The x-ray is shown below.  What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Ewing's  sarcoma"
      },
      {
        "id": 2,
        "text": "Chondroblastoma"
      },
      {
        "id": 3,
        "text": "Osteoid osteoma"
      },
      {
        "id": 4,
        "text": "Osteoblastoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above clinical scenario, along with the x-ray showing a<strong> peripheral sclerotic</strong> rim with <strong>central radiolucent nidus</strong>,\u00a0is suggestive of <strong>osteoid osteoma</strong>.</p>\n<p>Osteoid osteoma is a benign neoplasm, most often seen in men in the second to third decade of life. In most cases, the lesion appears in the lower extremities, commonly in the <strong>femur</strong> and tibia. A patient typically presents with <strong>pain</strong> that worsens at night and is\u00a0<strong>relieved by taking NSAIDs.</strong></p>\n<p>Radiography shows a sclerotic peripheral rim with central radiolucent nidus. <strong>CT</strong> scan can be used\u00a0to identify the nidus and\u00a0<strong>confirm</strong> the diagnosis.</p>\n<p>Anti-inflammatory medication can be used for long-term medical management. Percutaneous <strong>radiofrequency ablation</strong> can be used as an outpatient procedure.\u00a0Removal of the entire nidus can be done by curettage or en-bloc resection.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/84ace8e444af4d5da6aa9c85abe10fef.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e134b472ad0b479e929f5759ce8b8b04x1280x1999.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/172596dc183746c2935436dd1fc4393bx720x1363.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/baead221c760465ebd604286363f8d38x621x747.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2b72dbab767443d89f94c69dec3d02cex800x553.PNG"
    ]
  },
  {
    "text": "A 45-year-old female patient presents with a midline neck swelling that moves with deglutition. The histopathology image of the swelling is given below. Which of the following is incorrect about this condition?",
    "choices": [
      {
        "id": 1,
        "text": "It is associated with RET mutations"
      },
      {
        "id": 2,
        "text": "Foci of lymphatic invasion may be present"
      },
      {
        "id": 3,
        "text": "Associated with a history of exposure to ionising radiation"
      },
      {
        "id": 4,
        "text": "Metastatic calcification bodies are considered a hallmark microscopic feature"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical scenario and the image showing papillae lined by cells with overlapping nuclei and\u00a0<strong>Orphan Annie eye nuclei </strong>indicate a diagnosis of\u00a0<strong>papillary carcinoma of thyroid</strong><strong>\u00a0(PTC)</strong>. One of the microscopic hallmarks of PTC is <strong>psammoma bodies</strong>, which are an example of <strong>dystrophic calcification, </strong>not metastatic calcificaiton.</p>\n<p>Papillary carcinoma of thyroid (PTC)\u00a0presents as a painless nodule or mass in the neck or enlargement of cervical lymph nodes. It usually occurs in women between 25 to 50 years of age. PTC is the most common thyroid cancer <strong>associated with</strong> <strong>previous exposure to ionizing radiation</strong>. Conventional PTCs have translocations involving <strong>RET</strong> or NTRK, and point mutations involving <strong>BRAF</strong> gene.</p>\n<p>On microscopy, <strong>branching papillae</strong> with fibrovascular stalk covered with multiple layers of anaplastic cuboidal epithelial cells are seen. Because of fine dispersion of the chromatin, the <strong>nuclei appear optically clear</strong> and are referred to as <strong>ground-glass</strong> or <strong>Orphan Annie eye nuclei</strong>. <strong>Nuclear pseudoinclusions</strong>, which occur due to inward invagination of the nuclear membrane, may also be seen. The characteristic <strong>nuclear features</strong> of PTC <strong>can be used to make the diagnosis</strong> even if the classic papillary architecture is not seen. <strong>Dystrophic calcification</strong> in the form of <strong>psammoma bodies</strong> are often seen in the core of the papillae. <strong>Lymphatic invasion</strong> may frequently be <strong>present</strong>, but the involvement of blood vessels is rare.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/b9c0b861107745cf8ec2ddb234ace6f2.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3122232cc6bc48ccbfc50f0d35887190x671x599.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/24ee271294c64877a4f4ab8717cd11ffx1280x1042.JPEG"
    ]
  }
];
        let quizName = 'Swellings Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>