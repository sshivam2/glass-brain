<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tumors Mini Test - -Tmt - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2023-24
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Based on histopathological examination of benign breast tissue, which of the following has the lowest relative risk of invasive breast carcinoma?",
    "choices": [
      {
        "id": 1,
        "text": "Atypical hyperplasia"
      },
      {
        "id": 2,
        "text": "Florid hyperplasia"
      },
      {
        "id": 3,
        "text": "Papilloma with a fibrovascular core"
      },
      {
        "id": 4,
        "text": "Squamous metaplasia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Among the given options, <strong>Squamous metaplasia&nbsp;</strong>on&nbsp;histopathological examination of benign breast tissue has the<strong> lowest risk</strong> of <strong>developing invasive breast carcinoma.</strong></p>\n<p>According to the American College of Pathologists Consensus Statement, relative risk of invasive breast carcinoma based on pathological examination of benign breast tissue is as follows:</p>\n<p><strong>No increased risk :</strong></p>\n<ol>\n<li>Adenosis, sclerosing or florid</li>\n<li>Apocrine metaplasia</li>\n<li>Cysts, macro and/or micro</li>\n<li>Duct ectasia</li>\n<li>Fibroadenoma</li>\n<li>Fibrosis</li>\n<li>Hyperplasia</li>\n<li>Mastitis (inflammation)</li>\n<li>Periductal mastitis</li>\n<li>Squamous metaplasia</li>\n</ol>\n<p><strong>Slightly increased risk (1.5&ndash;2 times):</strong></p>\n<ul>\n<li>Hyperplasia, moderate or florid, solid or papillary (Option B)</li>\n<li>Papilloma with a fibrovascular core (Option C)</li>\n</ul>\n<p><strong>Moderately increased risk (5 times):</strong></p>\n<ul>\n<li>Atypical hyperplasia (ductal or lobular) (Option A)</li>\n</ul>\n<p><strong>Insufficient data to assign a risk:</strong></p>\n<ul>\n<li>Solitary papilloma of lactiferous sinus</li>\n<li>Radial scar lesion</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old female patient presents with dry eyes,  dry mouth, and difficulty in swallowing solid food. Examination reveals enlargement of parotid glands. Laboratory examination shows the presence of both SS-A and SS-B antibodies. The histopathological image of the salivary gland is given below. She is at high risk for developing  ______.",
    "choices": [
      {
        "id": 1,
        "text": "Adult T-cell leukemia"
      },
      {
        "id": 2,
        "text": "Mycosis fungoides"
      },
      {
        "id": 3,
        "text": "Marginal zone lymphoma"
      },
      {
        "id": 4,
        "text": "Sezary syndrome"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most likely diagnosis in a 55-year-old female patient with <strong>dry eyes, dry mouth</strong>, <strong>difficulty swallowing</strong> solid food, and the findings such as <strong>enlarged parotid</strong> gland, and antibodies <strong>positive</strong> for <strong>SS-A</strong> and<strong> SS-B</strong> is&nbsp;<strong>Sjogren's syndrome.&nbsp;</strong>The histopathology shows&nbsp;<strong>focal lymphoplasmacytic infiltration </strong>in the salivary gland. She is at high risk for the development of<strong> marginal zone lymphoma.</strong></p>\n<p><strong>Sj&ouml;gren's syndrome</strong>&nbsp;is a chronic disease wherein the lacrimal and salivary glands undergo immunologically-mediated destruction. This leads to the characteristic features of dry eyes (keratoconjunctivitis sicca) and dry mouth (xerostomia). It can manifest as primary or secondary. <strong>Primary</strong> is an isolated form known as <strong>sicca syndrome.</strong> It is characterized by decreased tears and saliva. The salivary glands and lacrimal glands get infiltrated with lymphocytes and undergo fibrosis. The <strong>secondary</strong> form is associated with other autoimmune disorders.&nbsp;</p>\n<p>Clinically, it is more common in<strong> women</strong> between <strong>50-60 years</strong>. They present with a blurring of vision, burning, itching of the eyes, difficulty swallowing solid foods, dryness of the buccal mucosa, and parotid gland enlargement.&nbsp;</p>\n<p>Antibodies directed against two ribonucleoprotein antigens -<strong>SS-A (Ro) and SS-B (La) </strong>are detected in almost all patients with Sjogren's syndrome.&nbsp;<strong>Rheumatoid factor</strong> is seen in about 75% of the patients.&nbsp;<strong>ANA&nbsp;</strong>is also often detected on immunofluorescence assay. A<strong> labial&nbsp;biopsy</strong> is useful and histology of salivary glands shows<strong> lymphocytic infiltration.&nbsp;</strong></p>\n<p>Patients are at high risk for the development of<strong> marginal zone lymphoma </strong>that&nbsp;arises in the presence of chronic lymphocytic inflammation.</p>\n<p>Other options -</p>\n<p>Option A:&nbsp;<strong>Adult T-Cell Leukemia/Lymphoma</strong> - It is observed in adults infected by human T-cell leukemia retrovirus type 1 (<strong>HTLV-1</strong>). It is characterized by skin lesions, generalized lymphadenopathy, hepatosplenomegaly, peripheral blood lymphocytosis, and hypercalcemia. Peripheral smear shows cells with multilobulated nuclei (&ldquo;<strong>cloverleaf</strong>&rdquo; or &ldquo;<strong>flower</strong>&rdquo; cells). It is a rapidly progressive disease that is fatal within months to 1 year.</p>\n<p>Option B:&nbsp;<strong>Mycosis fungoides</strong> is a&nbsp;<strong>cutaneous T-cell lymphoma</strong>. It is more common in middle-aged men and people with darker skin. MF may present as dermatitis or eczema for a few years before progressing to the classical presentation of&nbsp;<strong>patches</strong>&nbsp;and&nbsp;<strong>plaques</strong>&nbsp;as shown in the image above. The most common sites involved are the&nbsp;<strong>trunk, limbs, breasts, and buttocks</strong>. The lesions may present with pruritus or be asymptomatic. As it&nbsp;<strong>progresses</strong>, the patient may develop, ulceration and pain or even&nbsp;<strong>widespread erythroderma</strong>.&nbsp;</p>\n<p>Option C:&nbsp;<strong>Sezary syndrome</strong> is most often seen as a&nbsp;progression of mycosis fungoides.&nbsp;Sezary syndrome&nbsp;is defined by the following&nbsp;clinical <strong>triad</strong>:</p>\n<ul>\n<li>Erythroderma</li>\n<li>Peripheral lymphadenopathy</li>\n<li>Atypical circulating mononuclear cells</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/29e3adf3292540668d1bde9fb329a690.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient presented to the OPD with complaints of abdominal pain and diarrhea. On further evaluation, the patient was found to have cutaneous flushing, extensive wheeze, and tricuspid insufficiency. Contrast-enhanced MRI revealed the presence of endocardial fibrosis. Which of the following substances will be excreted excessively in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Vanillylmandelic acid"
      },
      {
        "id": 2,
        "text": "Imidazoleacetic acid"
      },
      {
        "id": 3,
        "text": "5-Hydroxy indole acetic acid"
      },
      {
        "id": 4,
        "text": "Choline"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>5-hydroxy indole acetic acid (5-HIAA)&nbsp;</strong>will be excreted excessively in the above given clinical scenario<strong>, </strong>as this&nbsp;is a case of <strong>carcinoid syndrome</strong>.</p>\n<p>Carcinoid syndrome&nbsp;is due to the&nbsp;<strong>excessive</strong>&nbsp;production of&nbsp;<strong>serotonin</strong>, a specialized&nbsp;<strong>product of tryptophan metabolism</strong>. This syndrome is characterized by cutaneous flushing, abdominal cramps, and diarrhea. The excess serotonin produced is then metabolized and excreted in urine as 5-HIAA.&nbsp;&nbsp;</p>\n<p class=\"redesignmargintopadded\">Note:</p>\n<p class=\"redesignmargintopadded\">5-HIAA testing is a 24-hour urine test that is <strong>specific to carcinoid tumors</strong>.&nbsp;This test is the most common biochemical test for carcinoid tumors associated with carcinoid syndrome.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Given below is the image showing an X-ray finding of a bone tumor. Which of the following is the true statement regarding this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Highly radiosensitive tumor"
      },
      {
        "id": 2,
        "text": "Highly radio resistant tumor"
      },
      {
        "id": 3,
        "text": "Metaphysis of distal femur is a common location"
      },
      {
        "id": 4,
        "text": "Diaphysis of humerus is the most common location"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows a lateral radiograph of the tibia demonstrating the <strong>lamellated periosteal reaction</strong> in the <strong>diaphysis&nbsp;</strong>suggestive of <strong>Ewing&rsquo;s sarcoma.&nbsp;</strong>The true statement regarding this condition is that it&nbsp;is a<strong> highly radiosensitive tumor</strong>.</p>\n<p>Ewing&nbsp;sarcoma<strong>&nbsp;</strong>is the <strong>2nd most common</strong>&nbsp;bone sarcoma in children. The majority of the patients affected are usually&nbsp;<strong>&lt;20 years</strong> of age. It has a slight <strong>male</strong> <strong>predominance</strong>.&nbsp;The majority of Ewing sarcomas have a balanced translocation between the EWSR1 gene on <strong>chromosome 22</strong> and the FLI1 gene on <strong>chromosome 11</strong>.&nbsp;</p>\n<p>It commonly involves the&nbsp;<strong>diaphysis</strong>&nbsp;of the <strong>long bones</strong> like the <strong>femur</strong>,<strong> tibia</strong>, fibula, humerus, and <strong>flat bones</strong> of the <strong>pelvis</strong>.</p>\n<p>Patients present with&nbsp;<strong>painful enlarging mass</strong>, fever, and anemia. The affected area is usually tender, swollen, and warm. Laboratory findings may show an elevated WBC count and erythrocyte sedimentation rate (ESR).&nbsp;</p>\n<p>A histopathological examination of Ewing sarcoma shows sheets of<strong> uniform, round blue cells </strong>arranged in<strong> Homer-Wright rosettes</strong> (shown in the image given below). Immunohistochemistry is usually&nbsp;positive for<strong> synaptophysin </strong>and<strong> mic-2.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/97780ce4e1da48d08dfa52b9d649c443.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1057042b2af84564b1ef726547539a08x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b53c61392a774b9088e8b14a831281bex720x553.PNG"
    ]
  },
  {
    "text": "An 18-year-old girl presents with an abdominal mass. After laparotomy, the mass demonstrates a cystic cavity filled with hair, sebaceous material, cartilage, bone, along with areas of necrosis and haemorrhage. On microscopic examination, varying amounts of the immature neuroepithelium,  cartilage,  bone,  muscle,  and other elements are seen. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Immature teratoma"
      },
      {
        "id": 2,
        "text": "Mature teratoma"
      },
      {
        "id": 3,
        "text": "Struma ovarii"
      },
      {
        "id": 4,
        "text": "Ovarian carcinoid"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above clinical scenario is consistent with immature teratoma.</p>\n<p><strong>Immature malignant teratomas:</strong></p>\n<ul>\n<li>The tumor is found chiefly in prepubertal adolescents and young women, the mean age being 18 years.</li>\n<li>The component tissues resemble embryonal and immature fetal tissue most, often consisting of <strong>primitive neuroepithelium </strong>on histological examination. On microscopic examination, there are varying amounts of the <strong>immature neuroepithelium</strong>, cartilage, bone, muscle, and other elements.</li>\n<li>The histologic grade of the tumor, based on the proportion of tissue containing immature neuroepithelium indicates risk for extra-ovarian spread.</li>\n<li>High-grade tumours confined to the ovaries are treated with prophylactic chemotherapy.</li>\n</ul>\n<p><strong>Mature (Benign) teratoma</strong>(Option B)<strong>:</strong></p>\n<ul>\n<li>Cystic teratomas are usually found in <strong>young women </strong>during the active reproductive years.\u00a0</li>\n<li>They are\u00a0bilateral in 10% to 15% of cases.</li>\n<li>They are unilocular cysts containing <strong>hair and sebaceous material </strong>sometimes\u00a0cartilage, bone, thyroid, and neural tissue.</li>\n<li>Microscopically, the cyst wall is composed of <strong>stratified squamous epithelium,</strong> with underlying sebaceous glands, hair shafts, and other skin adnexal structures.</li>\n<li>About <strong>1%</strong> of the dermoids undergo malignant transformation, most commonly to <strong>squamous cell carcinoma</strong>, but also to other cancers as well (e.g., thyroid carcinoma, melanoma).</li>\n</ul>\n<p><strong>Monodermal or specialized teratomas:</strong></p>\n<ul>\n<li><strong>Struma ovarii </strong>(Option C)<strong>\u00a0</strong>is composed entirely of<strong> mature thyroid tissue, </strong>which may be functional and cause hyperthyroidism.</li>\n<li><strong>Ovarian carcinoid\u00a0</strong>(Option D),<strong>\u00a0</strong>which presumably arises from intestinal tissue, may be functional and causes <strong>carcinoid syndrome </strong>in the absence of hepatic metastasis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 49-year-old male presents with recurrent episodes of watery diarrhea, dehydration, hypokalemia, and achlorhydria. Which of the following neuroendocrine tumors can be responsible for these symptoms?",
    "choices": [
      {
        "id": 1,
        "text": "Gastrinoma"
      },
      {
        "id": 2,
        "text": "Somatostatinoma"
      },
      {
        "id": 3,
        "text": "VIPoma"
      },
      {
        "id": 4,
        "text": "Glucagonoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario is suggestive of&nbsp;<strong>VIPoma</strong>.</p>\n<p><strong>Vasoactive intestinal peptide-secreting</strong> tumors (VIPomas) are neuroendocrine tumors that secrete excessive amounts of vasoactive intestinal peptide (VIP). The condition is known as&nbsp;Verner&ndash;Morrison syndrome or WDHA syndrome.</p>\n<p>WDHA stands for:</p>\n<ul>\n<li><strong>WD - W</strong>atery <strong>D</strong>iarrhea</li>\n<li><strong>H &ndash; H</strong>ypokalemia</li>\n<li><strong>A </strong>&ndash; <strong>A</strong>chlorhydria</li>\n</ul>\n<p>Diagnosis can be made by the demonstration of an <strong>elevated plasma VIP level</strong> and the history of <strong>large-volume diarrhoea</strong>.</p>\n<p>Treatment includes correction of&nbsp;dehydration, hypokalemia, and electrolyte losses with fluid and electrolyte replacement.&nbsp;Long-acting somatostatin analogues such as <strong>octreotide and lanreotide are the drug of choice.</strong></p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 35-year-old female patient had complaints of post-coital bleeding with leucorrhoea. An initial visual inspection with acetic acid showed an abnormal finding, which, when followed by a colposcopic guided biopsy of the cervix,  had the malignant cells occupying the lower 50% to 75% of the epithelial thickness. She wishes for conservative treatment, as she has not completed her family. Which of the following might be offered considering the future pregnancy?",
    "choices": [
      {
        "id": 1,
        "text": "Conization"
      },
      {
        "id": 2,
        "text": "Needle excision of the transformation zone"
      },
      {
        "id": 3,
        "text": "Loop electrosurgical excision procedure"
      },
      {
        "id": 4,
        "text": "Laser ablation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario and the histologic finding are suggestive of high-grade squamous intraepithelial lesion (HSIL/CIN II) of the cervix. An ideal procedure to be performed in this patient, anticipating the future pregnancy would be <strong>laser ablation.</strong></p>\n<p>This is because <strong>ablative techniques</strong> do<strong> not result in future pregnancy complications.</strong></p>\n<p>Techniques involving the excision of abnormal tissue such as</p>\n<ul>\n<li>Large Loop Excision of the Transformation Zone (LLETZ)</li>\n<li>Loop Electrosurgical Excision Procedure (LEEP)</li>\n<li>Needle Excision of the Transformation Zone (NETZ)</li>\n<li>Cold knife conization</li>\n<li>Laser conization</li>\n</ul>\n<p>result in the stenosis of the cervix, abortion, and premature labour. Hence avoid in female patients who desire for childbirth in the near future</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 62-year-old male presented with multiple slow-growing nodules on the scalp.  A biopsy was taken and the histopathological examination revealed a jigsaw puzzle architecture as shown below. What is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Basal cell carcinoma"
      },
      {
        "id": 2,
        "text": "Spiradenoma"
      },
      {
        "id": 3,
        "text": "Cylindroma"
      },
      {
        "id": 4,
        "text": "Merkel cell carcinoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The patient with multiple slow-growing nodules in the scalp and with a 'jigsaw puzzle' appearance on histopathology points toward the diagnosis of&nbsp;<strong>cylindromas.</strong></p>\n<p>Cylindroma is an <strong>appendage tumour</strong> with ductal (apocrine or eccrine) differentiation inherited in an <strong>autosomal dominant</strong>&nbsp;pattern due to mutation of the <strong>CYLD gene</strong>.&nbsp;</p>\n<p>Patients present with <strong>multiple</strong> smooth, <strong>firm,</strong> pink to red coloured nodules&nbsp;on the forehead and <strong>scalp</strong> which may or may not be pedunculated<strong>.&nbsp;</strong>Nodules can coalesce and produce a hatlike growth which gives the name,&nbsp;<strong>turban tumour</strong>.</p>\n<div class=\"page\" title=\"Page 1154\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Histopathology shows lobules of epithelial cells arranged in a <strong>jigsaw or mosaic pattern</strong>. Each lobule is composed of islands of<strong> basaloid cells&nbsp;</strong>in the periphery&nbsp;and a paler zone of cells in the centre.</p>\n<p>It is treated with&nbsp;<strong>wide excision</strong>&nbsp;and replacement of the area by a graft.</p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/baa1dca2d02e492795b9750e22851491.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/41b842977e1f4474aa9f7b33e9070a78x1279x1062.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74a54ffb6dcc4440bdf27f5d3d22d645x800x533.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cf880f8a99c94fa8b0ba0c8f1e33bb25x1280x1160.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1be73b41c47a4c7ea716be67886aea4ax800x1200.JPEG"
    ]
  },
  {
    "text": "A 45-year-old man visits the hospital with complaints of hip pain and back pain. X-ray shows the following findings. Biopsy from the lesions confirms the diagnosis of metastatic secondaries. Which of the following is a likely source of metastasis?",
    "choices": [
      {
        "id": 1,
        "text": "Prostate carcinoma"
      },
      {
        "id": 2,
        "text": "Lung carcinoma"
      },
      {
        "id": 3,
        "text": "Stomach carcinoma"
      },
      {
        "id": 4,
        "text": "Malignant melanoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The patient's x-ray findings and clinical features are suggestive of <strong>osteoblastic secondaries</strong>, which are predominantly seen in <strong>prostate carcinoma</strong>.</p>\n<p>Metastatic tumors are the most common form of skeletal malignancy, greatly outnumbering primary bone cancers.</p>\n<p>Skeletal metastases are typically <strong>multifocal</strong>. However, carcinomas of the kidney and thyroid may present with solitary lesions. Most <strong>metastases</strong> involve the <strong>axial skeleton</strong> (vertebral column, pelvis, ribs, skull, and sternum). The <strong>red marrow</strong> in these areas, with its rich capillary network and slow blood flow, facilitates the implantation and growth of the tumor cells.</p>\n<p>The radiographic appearance of metastases may be<strong> purely lytic</strong> (bone destroying), <strong>purely blastic</strong> (bone forming), or <strong>mixed</strong> lytic and blastic. Furthermore, some cancers are associated with predominantly one pattern or the other.</p>\n<p>For example, <strong>prostatic</strong> <strong>adenocarcinoma</strong> is predominantly <strong>blastic</strong>, whereas malignant melanoma and carcinomas of the kidney, lung, and gastrointestinal tract produce lytic lesions.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/33e9c32dd665420daff30ee490abc508.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old female patient has been diagnosed with an ovarian tumor. Histopathological examination of the tumor specimen is shown in the below image. This finding indicates which of the following tumors?",
    "choices": [
      {
        "id": 1,
        "text": "Dysgerminoma"
      },
      {
        "id": 2,
        "text": "Krukenberg tumor"
      },
      {
        "id": 3,
        "text": "Endodermal sinus tumor"
      },
      {
        "id": 4,
        "text": "Mucinous cystadenoma"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows <strong>signet ring cells</strong>\u00a0which are seen in\u00a0<strong>Kruckenberg tumors</strong>.</p>\n<p><strong>Krukenberg tumors</strong>\u00a0are secondary growth in the ovary and most often arise from primary carcinoma of the stomach (70%), large bowel (15%), and breast (6%).</p>\n<p>Features:</p>\n<ul>\n<li>Usually\u00a0<strong>bilateral</strong></li>\n<li>Have a\u00a0<strong>smooth surface</strong></li>\n<li>They retain the shape of the normal ovary.</li>\n<li>There is no tendency to form adhesions with neighboring viscera and they are freely movable in the pelvis.</li>\n<li>There is\u00a0<strong>no infiltration</strong>\u00a0through the capsule</li>\n<li>Have a waxy consistency</li>\n</ul>\n<p><strong>Histologically, numerous signet-ring cells</strong>\u00a0with pale cytoplasm are seen.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/83d85643a4eb42e68105493802b8564c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f6429d7a5d7d449b9d77b0a579847a6fx1280x960.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2d6cc0c1c2564531945ff59d27a24c9dx1280x853.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f9b3151ea9d5460a8ca852e2fe044d88x572x424.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f2937f305ebe4d73b112af33e606384ex512x384.PNG"
    ]
  },
  {
    "text": "Match the following features with their corresponding syndromes",
    "choices": [
      {
        "id": 1,
        "text": "A-3, B-4 ,C-1, D-2"
      },
      {
        "id": 2,
        "text": "A-2, B-4, C-3, D-1"
      },
      {
        "id": 3,
        "text": "A-4, B-1, C-3, D-2"
      },
      {
        "id": 4,
        "text": "A-1, B-2, C-4, D-3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The correct matched option is&nbsp;<strong>A-2, B-4, C-3,</strong> and<strong> D-1</strong>.</p>\n<p><strong>Multiple Endocrine Neoplasia</strong> (MEN) refers to a group of inherited syndromes including various benign and malignant tumors of endocrine glands. There are four types - MEN 1-4. They have an&nbsp;<strong>autosomal dominant</strong>&nbsp;pattern of inheritance and can also be sporadic.&nbsp;</p>\n<p>MEN&nbsp;<strong>1</strong>&nbsp;is a syndrome complex associated mainly with&nbsp;<strong>parathyroid adenoma, pancreatic tumors,</strong>&nbsp;and<strong>&nbsp;pituitary tumors.&nbsp;</strong></p>\n<p>MEN<strong>&nbsp;2A</strong>&nbsp;comprises mainly medullary thyroid carcinoma, pheochromocytoma, and&nbsp;<strong>parathyroid adenoma.&nbsp;</strong></p>\n<p>MEN<strong>&nbsp;2B/3</strong>&nbsp;consists of medullary thyroid carcinoma, pheochromocytoma, mucosal neuroma<strong>,&nbsp;</strong>marfanoid habitus, medullated corneal nerve fibres, and megacolon.</p>\n<p>MEN&nbsp;<strong>4</strong>&nbsp;is associated with parathyroid adenoma, pituitary adenoma, and&nbsp;<strong>reproductive organ tumors.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A  researcher focussing on genodermatology was studying the harmful effect of UV radiation on human skin. He observed that UV radiation leads to pyrimidine dimerization in DNA strands, preventing further replication by DNA  polymerase. Which of the following DNA repair mechanisms corrects this particular defect?",
    "choices": [
      {
        "id": 1,
        "text": "Nucleotide excision repair"
      },
      {
        "id": 2,
        "text": "Base excision repair"
      },
      {
        "id": 3,
        "text": "Mismatch repair"
      },
      {
        "id": 4,
        "text": "Homologous end joining repair"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The nucleotide excision repair mechanism corrects the dimer formation in DNA.</p>\n<p><strong>Xeroderma pigmentosum</strong> is an example of <strong>defective DNA nucleotide excision repair</strong>. There is an inability<span class=\"fontstyle0\">&nbsp;to <strong>repair DNA pyrimidine dimers</strong> caused by UV exposure.</span></p>\n<p><span class=\"fontstyle0\">The following image shows an eight-year-old girl with xeroderma pigmentosum. </span><span class=\"fontstyle0\">Frontal image of the face, showing large hyperkeratotic lesions with some induration suspicious of actinic keratosis and early squamous cell carcinoma. Also numerous hyper-pigmented lentigos and xerosis on the entire front of the face. Marked corneal scarring and injection are evident.</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/45da24c0d675418bab374f136ed7df8cx800x600.JPEG"
    ]
  },
  {
    "text": "Which of the following findings are seen in tumor lysis syndrome?",
    "choices": [
      {
        "id": 1,
        "text": "1, 2, 3 and 5"
      },
      {
        "id": 2,
        "text": "1, 2, 4 and 6"
      },
      {
        "id": 3,
        "text": "1, 2, 4 and 5"
      },
      {
        "id": 4,
        "text": "1, 3, 4 and 5"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The correct option is <strong>option C: 1, 2, 4, and 5.</strong>&nbsp;Hyperuricemia, hyperkalemia, hyperphosphatemia, and hypocalcemia occur in tumor lysis syndrome.</p>\n<p>Tumor lysis syndrome (TLS) is caused by the destruction of a large number of rapidly proliferating neoplastic cells.&nbsp;It most commonly occurs after the initiation of&nbsp;<strong>chemotherapy or radiotherapy</strong>.</p>\n<p>TLS is characterized by</p>\n<ul>\n<li><strong>Hyperuricemia</strong></li>\n<li><strong>Hyperkalemia</strong></li>\n<li><strong>Hyperphosphatemia</strong></li>\n<li><strong>Hypocalcemia&nbsp;</strong></li>\n<li>Acidosis</li>\n<li>Acute renal failure</li>\n</ul>\n<p>The management of TLS includes aggressive hydration along with <strong>allopurinol. Febuxostat&nbsp;</strong>a selective xanthine oxidase inhibitor, and <strong>rasburicase, </strong>a recombinant<strong> urate oxidase </strong>can be used to treat <strong>hyperuricemia.&nbsp;</strong>Hypocalcemia is not treated unless it is symptomatic, to avoid metastatic calcifications. Patients with renal impairment are managed with hemodialysis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 55-year-old man presented with lethargy, weight loss, and massive splenomegaly. Investigations revealed pancytopenia. A  hematological malignancy was suspected. A peripheral smear showed cells positive for tartrate-resistant acid phosphatase. Identify the correct CD marker and the cell of origin of this malignancy.",
    "choices": [
      {
        "id": 1,
        "text": "CD 5, Memory B cell"
      },
      {
        "id": 2,
        "text": "CD 25, Memory B cell"
      },
      {
        "id": 3,
        "text": "CD 20, Naive B cell"
      },
      {
        "id": 4,
        "text": "CD 3, Helper T cell"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Hematological malignancy with tartrate-resistant acid phosphatase-positive cells is most likely to be\u00a0<strong>hairy cell leukemia</strong>. The cell of origin of hairy cell leukemia is the<strong>\u00a0memory B cell.\u00a0</strong></p>\n<p>The markers expressed in hairy cell leukemia include the usual\u00a0<strong>B-cell markers- CD-19 and 20</strong>, and\u00a0specific markers such as<strong>\u00a0CD 11c, CD 25, CD103, </strong>and<strong> annexin A1.</strong></p>\n<p><strong>Hairy cell leukemia</strong> is a distinctive <strong>B cell neoplasm</strong>, that predominantly affects <strong>middle-aged males</strong>. <strong>Tartrate-resistant acid phosphatase</strong> is the cytochemical stain characteristically shown by leukemic hairy cells. These cells are called so because of the <strong>fine hair-like projections</strong> on their surface as shown below.</p>\n<p>On peripheral blood smear, hairy cells have round or <strong>reniform nuclei</strong> and moderate amounts of <strong>pale blue cytoplasm</strong> with thread or bleb-like extension.\u00a0In the bone marrow, these cells are usually trapped in a mesh of reticulin fibers and so it is difficult to aspirate and hence termed a <strong>dry tap.\u00a0</strong></p>\n<p>The classic hairy cells can be seen in the slide is shown below:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d601122fe2154bdd8983552e9ee4e286x640x479.JPEG"
    ]
  },
  {
    "text": "A patient who has been under treatment for chronic lymphocytic leukemia is noted to have a rapidly progressing mass involving the spleen. Histopathology of the mass shows large cell lymphocytes with a diffuse pattern of growth. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Kostmann syndrome"
      },
      {
        "id": 2,
        "text": "Mantle cell lymphoma"
      },
      {
        "id": 3,
        "text": "Richter syndrome"
      },
      {
        "id": 4,
        "text": "Burkitt lymphoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The history of a <strong>rapidly progressing tumor</strong> involving the <strong>spleen</strong> in a patient with <strong>chronic lymphocytic leukemia</strong> (CLL) and showing large cell lymphocytes on histopathology suggests a likely diagnosis of&nbsp;<strong>Richter syndrome</strong>.</p>\n<p>Richter syndrome refers to the <strong>transformation of CLL</strong> into a <strong>diffuse large B-cell lymphoma</strong> (DLBCL). There is a development of rapidly enlarging mass that involves a lymph node or spleen. It is an <strong>aggressive tumor</strong> and most patients with the syndrome survive less than a year.</p>\n<p>DLBCL is the<strong> most common</strong> type of <strong>non-Hodgkin lymphoma</strong> and is characteristically of <strong>large cell type</strong> and shows a <strong>diffuse pattern of growth</strong>. The most frequent pathological abnormality seen is <strong>dysregulation</strong> of <strong>BCL6</strong>.</p>\n<p>Mature B-cell tumors express <strong>CD19</strong> and <strong>CD20</strong> markers. Special subtypes of DLBCL include <strong>immunodeficiency-assosciated large B-cell lymphoma</strong> and <strong>primary effusion lymphoma</strong>.</p>\n<p>&nbsp;</p>\n<p>Other options:</p>\n<p>Option A:&nbsp;<strong>Kostmann syndrome </strong>is a form of&nbsp;<strong>congenital neutropenia&nbsp;</strong>caused by genetic mutation that leads to impaired granulocytic differentiation.&nbsp;</p>\n<p>Option B: <strong>Mantle cell lymphoma</strong> is a <strong>non-hodgkin lymphoma</strong> that presents at fifth or sixth decade and has male predominance. Clinically, there is painless lymphadenopathy and can involve spleen and gut. Morphologically, there is <strong>proliferation</strong> of <strong>small lymphocytes</strong> with <strong>irregular nuclear contours</strong>.</p>\n<p><span class=\"ghr-condition\">Option D:</span><strong><span class=\"ghr-condition\">&nbsp;Burkitt lymphoma&nbsp;</span></strong><span class=\"ghr-condition\">can include <strong>endemic</strong>, <strong>sporadic</strong>, and <strong>lymphoma</strong> asssociated with <strong>HIV</strong>. Almost all endemic Burkitt lymphomas are latently infected with <strong>EBV</strong>. Clinically, it presents as a <strong>mass</strong> involving the <strong>mandible</strong> or <strong>abdominal viscera</strong>. Histopathologically, the tumor has <strong>high mitotic index</strong> and contains multiple <strong>apoptotic cells</strong>. The nucelar remnants are phagocytosed by benign macrophages which give a characteristic <strong>starry sky appearance</strong>.&nbsp;</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "An elderly woman presented with complaints of discoloration on her face. An excisional biopsy was done, and histopathology findings are shown below. They stain positive for HMB - 45. Which of the following statements is incorrect regarding her condition?",
    "choices": [
      {
        "id": 1,
        "text": "Superficial spreading type is the most common variant"
      },
      {
        "id": 2,
        "text": "Mutation in the hedgehog signalling pathway"
      },
      {
        "id": 3,
        "text": "Mutation in receptor tyrosine kinase signalling pathway"
      },
      {
        "id": 4,
        "text": "Shows positive immunohistochemistry staining for S-100"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p class=\"p1\">The given history and histopathology showing <strong>dense intracytoplasmic brownish-black</strong> <strong>melanin pigment</strong> are suggestive of <strong>malignant melanoma</strong>. Mutations&nbsp;in the&nbsp;<strong>hedgehog signaling pathway</strong>&nbsp;are associated with <strong>basal cell carcinoma</strong> and not malignant melanoma.&nbsp;</p>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Malignant melanoma&nbsp;primarily arises from&nbsp;<strong>melanocytes</strong>&nbsp;at the epidermal-dermal junction but may also originate from mucosal surfaces of the&nbsp;<strong>oropharynx, nasopharynx, eyes, proximal esophagus, anorectal, </strong>and <strong>female genitalia</strong>. It includes<strong>&nbsp;a pigmented lesion</strong>&nbsp;that has enlarged, ulcerated, or bled. Amelanotic lesions appear as raised pink, purple, or flesh-colored skin papules. The diagnostic clue for melanoma is the&nbsp;<strong>ABCDE</strong>&nbsp;criteria.</p>\n<p>It consists of</p>\n<ul>\n<li><strong>A</strong>symmetry</li>\n<li><strong>B</strong>order irregularity</li>\n<li><strong>C</strong>olor variegation</li>\n<li><strong>D</strong>iameter of more than 6 mm&nbsp;</li>\n<li><strong>E</strong>volution or change</li>\n</ul>\n<p>The image below shows a case of malignant melanoma.</p>\n</div>\n</div>\n<div class=\"ng-star-inserted\">\n<div class=\"ng-star-inserted\">\n<div class=\"h-400-scroll mb-2 ng-star-inserted\"><img class=\"img-fluid hover-max\" src=\"https://dhmbxeygs57ff.cloudfront.net/uploads/506a8d63fc0d4accaa9d9ac8a0082518x720x963.JPEG\" width=\"192\" height=\"257\" /></div>\n</div>\n</div>\n<p class=\"p1\">Lentigo maligna, superficial spreading, acral lentiginous, and nodular are the variants of malignant melanoma<strong>. Superficial spreading melanoma</strong>&nbsp;is the&nbsp;<strong>most common</strong>&nbsp;variant (Option A) of malignant melanoma. It is more commonly seen on the&nbsp;<strong>trunk</strong>&nbsp;and&nbsp;<strong>proximal extremities</strong>. It usually arises from a&nbsp;<strong>pre-existing nevus</strong>&nbsp;after a chronic period of change in color and border.&nbsp;<strong>Mutations</strong>&nbsp;in&nbsp;<strong>cell cycle regulators</strong>,&nbsp;receptor&nbsp;<strong>tyrosine kinase</strong>&nbsp;signaling pathway (Option C), and those that&nbsp;<strong>activate telomerase</strong>&nbsp;are associated with&nbsp;<strong>melanomas</strong>.</p>\n<p>Markers for melanoma include:</p>\n<ul>\n<li><strong>S100&nbsp;</strong>(Option D)</li>\n<li>MELAN-A</li>\n<li>HMB (Human Melanoma Black)-45</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c2c32da7588c411a9fa43b6c29c36b89.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 51-year-old female patient, Mrs. Susheela presents to dermatology OPD with a rash as seen in the image below. On further inquiry, she reveals that she has unintentionally lost a lot of weight over the past few months. Medical history is significant for a recent diagnosis of type 2 diabetes mellitus for which she is being treated with T. Metformin 500mg. Which of the following is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Gastrinoma"
      },
      {
        "id": 2,
        "text": "Somatostatinoma"
      },
      {
        "id": 3,
        "text": "Glucagonoma"
      },
      {
        "id": 4,
        "text": "VIPoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The image given depicts <strong>n</strong><strong>ecrolytic migrating erythema.</strong>&nbsp;This along with the clinical presentation is strongly suggestive of a&nbsp;<strong>glucagonoma</strong>.<strong>&nbsp;</strong></p>\n<p><strong>Glucagonoma</strong>&nbsp;is a rare neuroendocrine tumor of the pancreas, a majority of which are malignant at the time of presentation. They are most commonly seen arising from the pancreatic tail.</p>\n<p>Clinically, the classic presentation of glucagonoma is with the &ldquo;<strong>4 D&rsquo;s</strong>&rdquo;-</p>\n<ul>\n<li><strong>Diabetes</strong></li>\n<li><strong>Dermatitis</strong>- A characteristic waxing and waning necrolytic migrating erythema is seen that usually appears before other symptoms.</li>\n<li><strong>Deep vein thrombosis&nbsp;</strong></li>\n<li><strong>Depression.</strong></li>\n</ul>\n<div class=\"page\" title=\"Page 655\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Diagnosis is established by estimating plasma glucagon levels. A level <strong>&gt;1000 pg/mL</strong> is considered<strong> diagnostic</strong> (normal plasma glucagon level is &lt;150 pg/mL). <strong>Hypoaminoacidemia</strong> is also a characteristic laboratory finding.&nbsp;</p>\n<div class=\"page\" title=\"Page 655\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Treatment</strong> may include long-acting <strong>somatostatin analogues</strong> like octreotide to alleviate some of the clinical symptoms such as dermatitis. Surgical resection may be attempted but is often unsuccessful due to extrapancreatic malignant spread at the time of diagnosis.&nbsp;</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/691b0d623dbf4c5689aa95a2e961225a.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 34-year-old male patient was suspected to have a seminoma of the testis. The mass was surgically removed and the specimen was sent for histopathological analysis. Which among the following findings is most likely to be seen microscopically?",
    "choices": [
      {
        "id": 1,
        "text": "Fried egg appearance of cells"
      },
      {
        "id": 2,
        "text": "Schiller Duval bodies"
      },
      {
        "id": 3,
        "text": "Crystalloids of Reinke"
      },
      {
        "id": 4,
        "text": "Derivatives of all three germ layers"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Microscopically, seminomas show a <strong>fried egg appearance of cells.\u00a0</strong>This refers to\u00a0cells with clear cytoplasm and a nucleus with a prominent nucleolus.</p>\n<p><strong>Seminoma\u00a0</strong>is the\u00a0<strong>most common </strong>type of germ cell tumor<strong> (around 50% of GCTs).</strong><strong>\u00a0</strong>It is the\u00a0testicular\u00a0equivalent<strong>\u00a0</strong>of an<strong>\u00a0ovarian dysgerminoma</strong><strong>.\u00a0</strong>Immunohistochemistry is positive for<strong><strong>\u00a0KIT, OCT3/4, </strong></strong>and\u00a0<strong>placental alkaline phosphatase (PLAP)</strong><strong>.</strong></p>\n<p>Patients usually present with painless testicular enlargement. Heaviness may be felt if the size is 2-3 times normal. Rarely, it may present with symptoms of metastatic disease.</p>\n<p><strong>The gross specimen\u00a0</strong>shows\u00a0a homogeneous, grey-white, lobulated cut surface, devoid of hemorrhage or necrosis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c53c7fb0e97e439690b7774de66a1be2x800x531.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/76b4e33f9e6e42edaad2c96c2199a2e3x800x533.JPEG"
    ]
  },
  {
    "text": "A 38-year-old woman presents with a headache for 8 months. MRI brain shows a right sub-frontal mass. The biopsy of the tumor specimen is given below. Which of the following statements are true regarding her condition?",
    "choices": [
      {
        "id": 1,
        "text": "These tumours express hormone receptors like progesterone receptors"
      },
      {
        "id": 2,
        "text": "They are most commonly associated with neurofibromatosis type 1"
      },
      {
        "id": 3,
        "text": "They are predominantly known to be malignant tumours"
      },
      {
        "id": 4,
        "text": "Histopathological examination shows fried egg appearance"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The clinical presentation of headache and histopathology showing the<strong> syncytial</strong> or&nbsp;<strong>whorled clusters of epithelial tumor cells </strong>is&nbsp;highly suggestive of <strong>meningioma</strong>. Meningiomas often express hormone receptors such as<strong>&nbsp;progesterone receptors.&nbsp;</strong></p>\n<p>Meningiomas are predominantly <strong>benign</strong> tumors (Option C), usually attached to the dura. They are predominantly seen in females and in patients with <strong>neurofibromatosis type 2 </strong>(Option B), which is an autosomal disorder associated with multiple meningiomas, schwannomas, and ependymomas.</p>\n<p>They arise from the&nbsp;<strong>meningothelial cells</strong> or <strong>arachnoid cap cells</strong>. The most common karyotypic abnormality is the loss of the long arm of <strong>chromosome 22</strong>.&nbsp;Meningiomas often express hormone receptors (eg: Progesterone), hence, they may grow rapidly in pregnancy.</p>\n<p>Meningiomas are rubbery, rounded, or bosselated dural masses. They compress the underlying brain tissue. They present with&nbsp;headaches, seizures, or focal neurological deficits.&nbsp;</p>\n<p>The tumor spreads in a sheet-like manner along the surface of the dura causing reactive<strong> hyperostotic changes</strong> in adjacent bones. They are mostly located in cerebral convexities. The lesions may be finely gritty due to numerous psammomatous calcifications.&nbsp;</p>\n<p>Grades of meningioma based on histologic subtypes by WHO are:</p>\n<p><strong>Grade I</strong> is the benign meningioma that has a relatively low risk of recurrence or aggressive growth. The histologic patterns are:</p>\n<ul>\n<li><strong>Meningothelial</strong>&nbsp;or <strong>syncytial</strong> (<strong>most common</strong>). They are clusters of epitheliod tumor cells that&nbsp;sit in tight groups without visible cell membranes as shown below.</li>\n<li>Fibroblastic</li>\n<li>Transitional</li>\n<li>Psammomatous</li>\n</ul>\n<p>The image below shows <strong>meningothelial</strong>&nbsp;or <strong>syncytial</strong>&nbsp;pattern:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1983c5861a8e4835868c006975728565.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ef4e13354e09468f872248861c6c3549x800x593.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6a5e4f9d444c4d4ea86e5861cb10c7a3x583x600.PNG"
    ]
  },
  {
    "text": "A 24-year-old female presents with a 2 cm thyroid nodule. A fine needle aspiration biopsy of the nodule revealed the findings given below in the image. Which of the following statements is incorrect regarding her condition?",
    "choices": [
      {
        "id": 1,
        "text": "They usually appear as cold masses on thyroid scan"
      },
      {
        "id": 2,
        "text": "BRAF gain-of-function mutation is commonly associated"
      },
      {
        "id": 3,
        "text": "Lateral aberrant thyroid is managed with modified radical neck dissection"
      },
      {
        "id": 4,
        "text": "It is a predominant thyroid cancer in iodine-deficient areas"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The biopsy specimen shows <strong>grooved </strong>and<strong> crowded nuclei</strong>, with a clear, <strong>ground-glass</strong> appearance (<strong>Orphan Annie eye nuclei</strong>), which is a diagnostic feature of <strong>Papillary thyroid carcinoma</strong>.\u00a0It is the most predominant thyroid cancer in\u00a0<strong>iodine-sufficient areas. </strong>The most\u00a0common thyroid malignancy in\u00a0<strong>iodine-deficient areas</strong> is <strong>follicular carcinoma.</strong></p>\n<p>Papillary thyroid carcinoma is the <strong>most common</strong> <strong>thyroid cancer</strong>. It is also the most predominant thyroid cancer in <strong>children</strong> and <strong>iodine-sufficient areas</strong>. <strong>Radiation</strong> <strong>exposure</strong> is an important <strong>risk factor</strong>.\u00a0</p>\n<p>Genetics:\u00a0\u00a0</p>\n<ul>\n<li><strong>BRAF</strong> gain-of-function mutation (<strong>V600E</strong> amino acid substitution) is commonly associated\u00a0(Option B)</li>\n<li><strong>RET/PTC rearrangements</strong></li>\n<li><strong>NTRK gene</strong> fusions</li>\n</ul>\n<p>The clinical features of\u00a0Papillary thyroid carcinoma are as follows:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">It is more common in<strong> females</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">The mean age of presentation is <strong>30-40 years</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Most patients are euthyroid, with painless swelling. <strong>Initial presentation</strong> may be with<strong> cervical lymphadenopathy</strong> due to lymph node metastases</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">These are usually <strong>multifocal</strong> (85% cases)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">They appear as <strong>cold</strong> masses on <strong>thyroid scan\u00a0</strong>(Option A)</li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Metastasis occurs via the <strong>lymphatic</strong> route</li>\n</ul>\n<p><strong>Skip metastasis</strong> from papillary thyroid carcinoma to the <strong>ipsilateral cervical lymph nodes</strong>, known as<strong> lateral</strong> <strong>aberrant thyroid</strong>, is managed with\u00a0<strong>modified radical neck dissection</strong>. (Option C)</p>\n<p>\u00a0Microscopic examination shows:</p>\n<ul>\n<li>Presence of branching papillae with fibrovascular stalk</li>\n<li>Nuclei are clear with <strong>chromatin margination</strong> (<strong>empty</strong> appearing), known as <strong>Orphan Annie eye nuclei</strong></li>\n<li>Presence of <strong>intranuclear inclusions</strong>. These are <strong>\u201cpseudo-inclusions\u201d</strong> due to invagination of cytoplasm</li>\n<li>Concentric calcified structures known as <strong>psammoma bodies</strong> are usually seen</li>\n</ul>\n<p>The <strong>nuclear features</strong> are <strong>diagnostic</strong> of papillary carcinoma, even in the absence of typical papillary architecture. The histopathology image of papillary thyroid carcinoma is shown below:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ce6c3d1cf8d6428280dba6ae41221267.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d19e0bb57c404b34823baf9f7e6fd2f5x1279x1159.JPEG"
    ]
  }
];
        let quizName = 'Tumors Mini Test - -Tmt';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2023-24"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>