<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ent St 2 (From Q-Bank) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2017 - 18
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Epiglottis develops from",
    "choices": [
      {
        "id": 1,
        "text": "3rd pharyngeal arch"
      },
      {
        "id": 2,
        "text": "4th pharyngeal arch"
      },
      {
        "id": 3,
        "text": "Hypobranchial eminence"
      },
      {
        "id": 4,
        "text": "4th pharyngeal pouch"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Epiglottis develops from the&nbsp;<strong>Hypobranchial eminence.</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Reinke\u2019s space is seen in",
    "choices": [
      {
        "id": 1,
        "text": "Glottis"
      },
      {
        "id": 2,
        "text": "Supraglottis"
      },
      {
        "id": 3,
        "text": "Subglottis"
      },
      {
        "id": 4,
        "text": "Paraglottic space"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Reinke&rsquo;s space </strong>is a <strong>potential space underneath the epithelium of vocal cords therefore the glottis.</strong></p>\n<p>It contains scanty subepithelial connective tissue.</p>\n<p>Oedema of this space is commonly seen in smokers and is called <strong>reinke&rsquo;s edema/ smoker&rsquo;s larynx.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Closure of glottis is by all except",
    "choices": [
      {
        "id": 1,
        "text": "Posterior cricoarytenoids"
      },
      {
        "id": 2,
        "text": "Lateral cricoarytenoids"
      },
      {
        "id": 3,
        "text": "Cricothyroid"
      },
      {
        "id": 4,
        "text": "Thyroarytenoids"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Posterior cricoarytenoid</strong> is the only <strong>abductor</strong> of the vocal cord. Hence it opens the glottis. All other muscles close the glottis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following is true regarding attachments of arytenoid except:",
    "choices": [
      {
        "id": 1,
        "text": "Base - cricoid"
      },
      {
        "id": 2,
        "text": "Vocal process- Vocal ligament"
      },
      {
        "id": 3,
        "text": "Apex- intrinsic muscles of larynx"
      },
      {
        "id": 4,
        "text": "Apex- corniculate cartilages"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The apex of the arytenoid supports the corniculate cartilages.</p>\n<p>The following are the attachments of the arytenoid:</p>\n<ul>\n<li><strong>Base - cricoid</strong></li>\n<li><strong>Vocal process- Vocal ligament</strong></li>\n<li><strong>Muscular process- intrinsic muscles of larynx</strong></li>\n<li><strong>Apex- corniculate cartilages</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Most common congenital cause of stridor is",
    "choices": [
      {
        "id": 1,
        "text": "Laryngeal web"
      },
      {
        "id": 2,
        "text": "Laryngomalacia"
      },
      {
        "id": 3,
        "text": "Laryngeal papilloma"
      },
      {
        "id": 4,
        "text": "Vocal cord palsy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Laryngomalacia (congenital laryngeal stridor). </strong></p>\n<ul>\n<li>It is the most common congenital abnormality of the larynx.</li>\n<li>It is characterized by excessive flaccidity of supraglottic larynx which is sucked in during inspiration producing stridor and sometimes cyanosis.</li>\n<li>On examination<strong>: OMEGA</strong> shaped epiglottis is seen.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged woman with chronic tonsillitis presented to the OPD with complaints of a gritty sensation in her throat. On palpation and probing, you confirm the sensation. What could be the possible diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Intratonsillar abscess"
      },
      {
        "id": 2,
        "text": "Tonsillolith"
      },
      {
        "id": 3,
        "text": "Tonsillar cyst"
      },
      {
        "id": 4,
        "text": "Lingual tonsil abscess"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>From the clinical scenario, the patient having chronic tonsillitis with a&nbsp;<strong>gritty sensation</strong> in the throat suggests a possible diagnosis of&nbsp;<strong>tonsilloliths.&nbsp;</strong></p>\n<p><strong>Tonsilloliths</strong>&nbsp;are complications of chronic tonsillitis and are mostly seen in adults. They are calcium and magnesium-rich <strong>calculi</strong> of the tonsils that occur due to the&nbsp;<strong>blocking of crypts</strong> and <strong>retention of debris</strong>. They give rise to a gritty sensation in the throat and can be confirmed with palpation or probing. They may enlarge and ulcerate through the tonsil. Tonsilloliths are treated by removal of stone or <strong>tonsillectomy</strong>.</p>\n<p>Other options:&nbsp;</p>\n<p>Option A:&nbsp;<strong>Intratonsillar abscess&nbsp;</strong>is a complication of acute tonsillitis where pus is accumulated in the tonsils. It presents with inflamed, <strong>tender tonsils</strong> with significant pain and dysphagia. They can be treated with antibiotics, drainage, or tonsillectomy at a later date.&nbsp;</p>\n<p>Option C:&nbsp;<strong>Tonsillar cyst</strong> is an <strong>asymptomatic</strong> <strong>yellowish swelling</strong> over the tonsil due to blockage of a tonsillar crypt. It is treated by incision and drainage.</p>\n<p>Option D:&nbsp;<strong>Lingual tonsil abscess&nbsp;</strong>is a severe complication of acute tonsillitis as it can cause laryngeal edema.&nbsp;Jugulodigastric nodes are commonly involved. Dysphagia, excessive salivation and painful tongue protrusion are some of the clinical findings seen in this condition.&nbsp;</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "1 yr old boy presents with biphasic stridor, barking cough and difficulty in breathing and fever. Image given below depicts his Xray findings. All of the following are true about this condition except_____________",
    "choices": [
      {
        "id": 1,
        "text": "Boys are more commonly affected"
      },
      {
        "id": 2,
        "text": "Most common in age group of 6 months to 3 years"
      },
      {
        "id": 3,
        "text": "Most common organism responsible is Parainfluenza virus"
      },
      {
        "id": 4,
        "text": "Condition predominantly involves supraglottis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The clinical picture of <strong>biphasic stridor</strong>, barking cough and difficulty in breathing, and fever in the child along with the <strong>steeple sign</strong> on x ray, is suggestive of <strong>croup or laryngotracheobronchitis</strong>. Biphasic stridor suggests <strong>subglottic involvement </strong>(not supraglottis).</p>\n<p><strong>Croup or laryngotracheobronchitis</strong> is an inflammatory condition of the larynx, trachea, and bronchi caused by the&nbsp;<strong>parainfluenza virus </strong>(Option D). It is characterized by the <strong>subglottic</strong> <strong>swelling</strong> of loose areolar tissue leading to respiratory obstruction and stridor. It commonly affects children between <strong>6 months and 3 years</strong> of age, more often male children. (Option A and B)</p>\n<p><strong>Laryngotracheobronchitis </strong>is characterized by a&nbsp;<strong>barking cough</strong>,&nbsp;<strong>hoarseness</strong>, and&nbsp;<strong>inspiratory stridor</strong>. Agitation and crying aggravate the symptoms and signs. A hoarse voice, coryza, normal to moderately inflamed pharynx, and a slightly increased respiratory rate can be revealed in the physical examination. The upper airway obstruction may progress and the child can present with an increased respiratory rate, nasal flaring; suprasternal, infrasternal, and intercostal retractions; and continuous stridor. <span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">On X-ray a </span><strong style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\">Steeple/Church top/pencil top sign</strong><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\"> (obstruction in subglottis) is seen.</span></p>\n<p><strong>Biphasic stridor&nbsp;</strong>is seen in lesions of the glottis, <strong>subglottis</strong>, and cervical trachea, e.g. laryngeal papillomas, vocal cord paralysis, and subglottic stenosis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8f0af3f76fba45528701fb9e9ddc65d2.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "All of  the following are seen in TB larynx except",
    "choices": [
      {
        "id": 1,
        "text": "Mamillated arytenoids"
      },
      {
        "id": 2,
        "text": "Mouse nibbled vocal cords"
      },
      {
        "id": 3,
        "text": "Turban epiglottis"
      },
      {
        "id": 4,
        "text": "Thumb  sign on X-Ray"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>TB larynx findings &ndash;</p>\n<ul>\n<li>Swelling in the interarytenoid region giving a <strong>mamillated appearance</strong>. Ulceration of vocal cord giving <strong>mouse-nibbled appearance.</strong></li>\n<li>Pseudoedema of the epiglottis &ldquo;<strong>turban epiglottis</strong>.&rdquo;&nbsp;</li>\n<li>&nbsp;Thumb sign seen on lat neck X-ray in <strong>epiglottitis.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Sensory supply of larynx below the level of vocal cord is",
    "choices": [
      {
        "id": 1,
        "text": "Recurrent laryngeal nerve"
      },
      {
        "id": 2,
        "text": "Internal laryngeal nerve"
      },
      {
        "id": 3,
        "text": "External laryngeal nerve"
      },
      {
        "id": 4,
        "text": "Inferior laryngeal nerve"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Above the vocal cords, larynx is supplied by internal laryngeal nerve&mdash;a branch of superior laryngeal, and below the vocal cords by <strong>recurrent laryngeal nerve.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Grisel syndrome is",
    "choices": [
      {
        "id": 1,
        "text": "Damage to upper incisors"
      },
      {
        "id": 2,
        "text": "TMJ dislocation"
      },
      {
        "id": 3,
        "text": "Paraspinal muscle spasm"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Grisel syndrome:</strong></p>\n<p>It is one of the <strong>complications of adenoidectomy</strong></p>\n<p>Patient complains of <strong>neck pain and develops torticollis</strong></p>\n<p>Mostly it is due to <strong>spasm of paraspinal muscles</strong>, but can be due to <strong>atlantoaxial dislocation</strong> requiring cervical collar and even traction.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Passavant\u2019s ridge is formed by",
    "choices": [
      {
        "id": 1,
        "text": "Stylopharyngeus"
      },
      {
        "id": 2,
        "text": "Palatopharyngeus"
      },
      {
        "id": 3,
        "text": "Salpingopharyngeus"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Passavant&rsquo;s Ridge</strong></p>\n<ul>\n<li>It is a <strong>mucosal ridge</strong> raised by fibres of <strong>palatopharyngeus.</strong></li>\n<li>It encircles the <strong>posterior and lateral walls of nasopharyngeal isthmus</strong>.</li>\n<li>Soft palate, during its contraction, makes firm contact with this ridge <strong>to</strong> <strong>cut off nasopharynx from the oropharynx</strong> during the deglutition or speech.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Frog face deformity is seen in",
    "choices": [
      {
        "id": 1,
        "text": "Adenoid hypertrophy"
      },
      {
        "id": 2,
        "text": "Retropharyngeal abscess"
      },
      {
        "id": 3,
        "text": "Nasopharyngeal carcinoma"
      },
      {
        "id": 4,
        "text": "Nasopharyngeal angiofibroma"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Nasopharyngeal Angiofibroma </strong></p>\n<ul>\n<li>It is a <strong>benign highly vascular tumor of adolescent boys</strong>.</li>\n<li>Locally invasive.</li>\n<li>It spreads to the orbits giving rise to <strong>proptosis and widening of the intercanthal distance</strong> leading to &ldquo;<strong>frog-face deformity.&rdquo;</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Trotter\u2019s triad is seen in",
    "choices": [
      {
        "id": 1,
        "text": "Angiofibroma"
      },
      {
        "id": 2,
        "text": "Nasopharyngeal carcinoma"
      },
      {
        "id": 3,
        "text": "Adenoid hypertrophy"
      },
      {
        "id": 4,
        "text": "Facial bone injury"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Nasopharyngeal cancer can cause:</p>\n<ul>\n<li>Conductive deafness (<strong>eustachian tube block</strong>)</li>\n<li>Ipsilateral temporoparietal/facial neuralgia (involvement of <strong>CN V</strong>) and</li>\n<li>Palatal paralysis (<strong>CN X</strong>)</li>\n</ul>\n<p>This is collectively called <strong>Trotter&rsquo;s triad</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Turbinate which articulates with ethmoid",
    "choices": [
      {
        "id": 1,
        "text": "Superior turbinate"
      },
      {
        "id": 2,
        "text": "Middle turbinate"
      },
      {
        "id": 3,
        "text": "Inferior turbinate"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<ul>\n<li>Inferior turbinate is a <strong>separate bone</strong> and <strong>articulates with ethmoid.</strong></li>\n<li>Middle and Superior turbinates (and Supreme) are <strong>part of ethmoid bone.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is not related to the middle meatus",
    "choices": [
      {
        "id": 1,
        "text": "Agger nasi"
      },
      {
        "id": 2,
        "text": "Maxillary sinus ostium"
      },
      {
        "id": 3,
        "text": "Fronto-nasal duct"
      },
      {
        "id": 4,
        "text": "Nasolacrimal duct"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Nasolacrimal duct </strong>opens into<strong> inferior meatus.</strong></p>\n<ul>\n<li><strong>Agger nasi -</strong>It is an elevation just anterior to the attachment of middle turbinate and meatus. When pneumatised and enlarged it encroaches on frontal recess area and causes mechanical obstruction to drainage of frontal sinus leading to sinusitis.</li>\n<li><strong>Maxillary sinus </strong>drains into the middle meatus. The ostium lies in the infundibulum.</li>\n<li>Anterosuperiorly, frontal sinus also opens into infundibulum through frontal recess or <strong>frontonasal duct.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Onodi cells and haller cells are in relation to",
    "choices": [
      {
        "id": 1,
        "text": "Optic nerve and roof of maxillary sinus"
      },
      {
        "id": 2,
        "text": "Optic nerve and frontal sinus"
      },
      {
        "id": 3,
        "text": "Optic nerve only"
      },
      {
        "id": 4,
        "text": "Optic chiasma and frontal sinus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Onodi cell</strong>&nbsp;is related to&nbsp;<strong>optic nerve</strong>&nbsp;and&nbsp;<strong>haller cell</strong>&nbsp;is related to<strong>&nbsp;maxillary sinus</strong>.</p>\n<p><strong>Onodi cell&nbsp;</strong>(sphenoethmoidal cell) is a&nbsp;<strong>posterior ethmoidal cell&nbsp;</strong>extending into sphenoid sinus. It is surgically important as the&nbsp;<strong>optic nerve&nbsp;</strong>and&nbsp;<strong>internal carotid artery&nbsp;</strong>may be related to its lateral wall.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cbcde2ae6acd47adb86de20cc696b591x578x599.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e02f5d965f824bea927eb0851c586794x377x379.JPEG"
    ]
  },
  {
    "text": "False about the following is",
    "choices": [
      {
        "id": 1,
        "text": "Also known as elephantiasis of nose"
      },
      {
        "id": 2,
        "text": "Seen in long standing cases of acne rosacea"
      },
      {
        "id": 3,
        "text": "It is premalignant"
      },
      {
        "id": 4,
        "text": "Hypertrophy of sebaceous gland"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This is an image of<strong> Rhinophyma or potato tumor or elephantiasis:</strong></p>\n<ul>\n<li>It is due to <strong>hypertrophy of sebaceous gland</strong>.</li>\n<li>Associated with long standing cases of <strong>acne rosacea</strong> in men past middle age.</li>\n<li>Mostly seen at <strong>tip of nose</strong> and causes <strong>unsightly appearance</strong> and obstruction to breathing and vision.</li>\n<li>Treatment: <strong>Excision with cauterization</strong> of base.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/73532dc6b6914164a3ae93142d1ec371.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Mikulicz cells and Russell bodies are characteristic of",
    "choices": [
      {
        "id": 1,
        "text": "Rhinoscleroma"
      },
      {
        "id": 2,
        "text": "Rhinosporidiosis"
      },
      {
        "id": 3,
        "text": "Lupus vulgaris"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Granulomatous Disease of nose</li>\n<li>Caused by Klebsiella rhinoscleromatis</li>\n<li>Biopsy shows infiltration of submucosa with plasma cells, lymphocytes, eosinophils<strong>, Mikulicz cells and Russell bodies</strong>. The latter two are <strong>diagnostic features of the disease.</strong>\n<ul>\n<li><strong>Mikulicz cells</strong> are large foam cells with a central nucleus and vacuolated cytoplasm <strong>containing causative bacilli</strong>.</li>\n<li><strong>Russell bodies</strong> are <strong>homogenous eosinophilic </strong><strong>inclusion bodies</strong> found in the plasma cells. They occur <strong>due to accumulation of immunoglobulins secreted by the plasma cells</strong>.</li>\n</ul>\n</li>\n<li>The <strong>causative organisms can be cultured </strong>from the biopsy material.</li>\n</ul>\n<p>Rhinoscleroma with Mikulicz cells and Russell bodies:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1256b14f2dd0431688bb1080aca5bfc4x512x384.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5c26561f10e04cddb76b508b9663b10ax432x285.PNG"
    ]
  },
  {
    "text": "Killian\u2019s incision is used in",
    "choices": [
      {
        "id": 1,
        "text": "Submucous resection"
      },
      {
        "id": 2,
        "text": "Septoplasty"
      },
      {
        "id": 3,
        "text": "Tympanoplasty"
      },
      {
        "id": 4,
        "text": "None of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Killian&rsquo;s incision : SMR</strong></p>\n<p><strong>Freer&rsquo;s incision: Septoplasty</strong></p>\n<p><strong>Killian&rsquo;s incision</strong> is used in submucous resection. It is given 1.25cm behind the columella at the mucocutaneous junction at the convex side of deflection.</p>\n<p><strong>Freer&rsquo;s hemitransfixation incision</strong> is used in septoplasty. It is given at the caudal end of the septum, usually on the concave side of the cartilage.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Bony septal perforation occurs in",
    "choices": [
      {
        "id": 1,
        "text": "Syphilis"
      },
      {
        "id": 2,
        "text": "Tuberculosis"
      },
      {
        "id": 3,
        "text": "Leprosy"
      },
      {
        "id": 4,
        "text": "Sarcoidosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Chronic granulomatous conditions like <strong>lupus, tuberculosis and leprosy cause perforation in the cartilaginous part.</strong></p>\n<p><strong>Bony perforation is only seen in syphilis.</strong></p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Tripod fracture is a fracture of",
    "choices": [
      {
        "id": 1,
        "text": "Nasal bone"
      },
      {
        "id": 2,
        "text": "Maxilla"
      },
      {
        "id": 3,
        "text": "Mandible"
      },
      {
        "id": 4,
        "text": "Zygoma"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Tripod fracture </strong>is a <strong>fracture of zygoma</strong>.</p>\n<p>Tripod fracture: After nasal bones, zygoma is the second most frequently fractured bone. Zygoma is separated at its three processes. Fracture line passes through <strong>zygomaticofrontal</strong> suture, orbital floor, <strong>infraorbital margin</strong> and foramen, anterior wall of maxillary sinus and the <strong>zygomaticotemporal suture</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cde0db13c8304f638a2f5f49f4f194acx673x645.JPEG"
    ]
  },
  {
    "text": "Samter\u2019s triad is related to",
    "choices": [
      {
        "id": 1,
        "text": "Ethmoidal polyp"
      },
      {
        "id": 2,
        "text": "Angiofibroma"
      },
      {
        "id": 3,
        "text": "Nasopharyngeal carcinoma"
      },
      {
        "id": 4,
        "text": "Nasal glioma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Samter&rsquo;s triad </strong>is associated with etiology of ethmoidal polyp. It consists of</p>\n<ul>\n<li><strong>nasal polypi</strong></li>\n<li><strong>asthma and</strong></li>\n<li><strong>aspirin intolerance</strong></li>\n</ul>\n<p><strong>Other etiological factors of ethmoidal polyp:</strong></p>\n<ul>\n<li>Chronic rhinosinusitis especially NARES- non allergic rhinitis with eosiniphilia syndrome.</li>\n<li>Asthma</li>\n<li>Aspirin intolerance &ndash; Samter&rsquo;s triad i.e. nasal polyp, asthma, aspirin intolerance.</li>\n<li>Cystic fibrosis</li>\n<li>Allergic fungal sinusitis</li>\n<li><strong>Kartagener syndrome - </strong>This consists of bronchiectasis, sinusitis, situs inversus and ciliary dyskinesis.</li>\n<li><strong>Young syndrome. </strong>It consists of sinopulmonary disease and azoospermia.</li>\n<li><strong>Churg&ndash;Strauss syndrome. </strong>Consists of asthma, fever, eosinophilia, vasculitis and granuloma.</li>\n<li><strong>Nasal mastocytosis</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Ringertz tumor is",
    "choices": [
      {
        "id": 1,
        "text": "Inverted papilloma"
      },
      {
        "id": 2,
        "text": "Basal cell carcinoma"
      },
      {
        "id": 3,
        "text": "Squamous cell carcinoma"
      },
      {
        "id": 4,
        "text": "Eisthesio neuroblastoma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<ul>\n<li>Inverted papilloma is also known as <strong>transitional cell papilloma or Ringertz tumour or Schneiderian papilloma.</strong></li>\n<li>It is a premalignant locally invasive disease with a<strong> tendency to grow inwards. </strong>Hence the name.</li>\n<li><strong>Basal cell carcinoma</strong> is also known as <strong>rodent ulcer</strong>.</li>\n<li><strong>Squamous cell carcinoma</strong> of nasal cavity arising from nasal septum is called <strong>nose picker&rsquo;s cancer.</strong></li>\n<li><strong>Esthesioneuroblastoma</strong> is also known as <strong>olfactory neuroblastoma or olfactory placode tumour</strong> as it arises from the olfactory epithelium in the upper third of nose.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A  male child presents with unilateral foul smelling blood-stained nasal discharge for 5 days. CT scan is as follows. Diagnosis is_________",
    "choices": [
      {
        "id": 1,
        "text": "Juvenile nasopharyngeal angiofirboma"
      },
      {
        "id": 2,
        "text": "Osteoma"
      },
      {
        "id": 3,
        "text": "Rhinolith"
      },
      {
        "id": 4,
        "text": "Meningoencephalocoele"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>This is a case of<strong> rhinolith</strong>. The <strong>first differential for a unilateral foul smelling discharge in children is a forgotten/unknown foreign body</strong>. Overtime this foreign body develops a reaction around it giving it a false envelop that calcifies and erodes surrounding structures causing bleeding and discharge.</p>\n<p>Other options:</p>\n<ul>\n<li>JNA is seen in adolescent boys and is a soft tissue mass in the nasopharynx.</li>\n<li>Meningoencephalocoele is a soft tissue mass entering the nose from the skull base.</li>\n<li>Osteoma is not commonly seen on the floor and would be in continuation with a normal bone.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/18a01790b35747989f088290dd67f5b4.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The following is useful in",
    "choices": [
      {
        "id": 1,
        "text": "Posterior rhinoscopy"
      },
      {
        "id": 2,
        "text": "Anterior rhinoscopy"
      },
      {
        "id": 3,
        "text": "Endoscopic rhinoscopy"
      },
      {
        "id": 4,
        "text": "Endoscopic sinus examination"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p style=\"padding-left: 30px;\">The above is a <strong>thudicum nasal speculum</strong>.</p>\n<p>It is used to part the ala so as to visualize the <strong>anterior part of the nasal cavity</strong>. Structures visualized on Anterior rhinoscopy are:</p>\n<ul>\n<li>Septum</li>\n<li>Lateral wall (Middle and inferior turbinate)</li>\n<li>Floor</li>\n</ul>\n<p>Posterior rhinoscopy is done using a St. Clair Thompson&rsquo;s Posterior rhinoscopy mirror through the oral cavity.</p>\n<p>Endoscopy is done using Endoscopes of varying angles.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/be9db4df5553463eac38ac9af4814042.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Invagination of which of the following structures will form the external auditory meatus?",
    "choices": [
      {
        "id": 1,
        "text": "First pharyngeal arch"
      },
      {
        "id": 2,
        "text": "First pharyngeal pouch"
      },
      {
        "id": 3,
        "text": "Second branchial cleft"
      },
      {
        "id": 4,
        "text": "Second branchial groove"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Invagination </strong>of the<strong> first&nbsp;pharyngeal arch&nbsp;</strong>gives rise to the <strong>external auditory meatus.</strong></p>\n<div class=\"page\" title=\"Page 375\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Previously, it was believed that the external auditory meatus develops from the first pharyngeal cleft. But recent studies suggest that the&nbsp;first&nbsp;pharyngeal arch gives rise to the external auditory meatus.</p>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the most common cause of otomycosis?",
    "choices": [
      {
        "id": 1,
        "text": "Mucor velutinosus"
      },
      {
        "id": 2,
        "text": "Candida albicans"
      },
      {
        "id": 3,
        "text": "Aspergillus fumigatus"
      },
      {
        "id": 4,
        "text": "Aspergillus niger"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Otomycosis</strong> is a fungal infection of the ear canal that often occurs due to <strong><em>Aspergillus niger</em></strong> <strong>(most common)</strong>, <em>Aspergillus fumigatus,</em> or <em>Candida albicans</em>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 20-year-old female patient presents with features of bilateral conductive hearing loss, not associated with tinnitus. The following image shows the otoscopic findings of her tympanic membranes. What is this sign called?",
    "choices": [
      {
        "id": 1,
        "text": "Rising sun sign"
      },
      {
        "id": 2,
        "text": "Schwartze sign"
      },
      {
        "id": 3,
        "text": "Setting sun sign"
      },
      {
        "id": 4,
        "text": "Cart wheel appearance"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The otoscopic picture of both the tympanic membranes shows the <strong>Schwartze sign</strong>. This finding along with the history of bilateral conductive deafness is seen in <strong>active otosclerosis.</strong></p>\n<p>A <strong>reddish hue</strong> may be seen on the promontory through the tympanic membrane (Schwartze sign). This is indicative of an <strong>active focus</strong> with increased vascularity<strong>.</strong>&nbsp;</p>\n<p>The tympanic membrane is quite <strong>normal and mobile.</strong></p>\n<p>Option A: Rising sun sign is seen in glomus tumor.</p>\n<p>Option C: Setting sun sign is an eye sign seen in hydrocephalus.</p>\n<p>Option D: Cartwheel appearance is seen in acute suppurative otitis media.<strong><br /></strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ac9e800ec5aa4d02a44635acb32ff5ad.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A middle-aged retropositive woman presented with complaints of hearing her own voice and breath sounds with ear fullness. She has lost significant weight in the past 6 months. What is the likely diagnosis in this case?",
    "choices": [
      {
        "id": 1,
        "text": "HIV-related psychosis"
      },
      {
        "id": 2,
        "text": "Superior canal dehiscence syndrome"
      },
      {
        "id": 3,
        "text": "Patulous eustachian tube"
      },
      {
        "id": 4,
        "text": "Blocked eustachian tube"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario describes <strong>autophony</strong> which is seen <strong>patulous eustachian tube</strong>.</p>\n<p>Autophony is a symptom where the patient <strong>hears his own voice</strong> and <strong>breath sounds</strong>.&nbsp;</p>\n<p>Patulous eustachian tube is usually idiopathic where the tube is abnormally patent. But it is also seen in <strong>rapid weight loss</strong>, pregnancy especially the third trimester and patients with multiple sclerosis.</p>\n<p>Treatment includes weight gain, administration of potassium iodide solution. In long-standing cases, specific treatment could include cauterization of tubes or insertion of the grommet.</p>\n<p>Option A: In HIV-related psychosis, there will be persecutory delusion, hallucination, and no ear fullness.</p>\n<p>Option B:&nbsp;The autophony of&nbsp;superior canal dehiscence syndrome usually involves hearing their own voice but <strong>not</strong> their <strong>breathing</strong> when compared with patients who have patulous eustachian tube.</p>\n<p>Option D: Patient with blocked eustachian tube does not present with autophony.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Ceruminous glands are modifications of which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Apocrine glands"
      },
      {
        "id": 2,
        "text": "Eccrine glands"
      },
      {
        "id": 3,
        "text": "Holocrine glands"
      },
      {
        "id": 4,
        "text": "Cytocrine glands"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Ceruminous</strong> glands are modified <strong>apocrine</strong> sweat glands.</p>\n<p>Ceruminous and sebaceous&nbsp;glands open into the space of the hair follicle in the external auditory canal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following conditions would you expect to observe the light-house effect?",
    "choices": [
      {
        "id": 1,
        "text": "Otosclerotic lesion"
      },
      {
        "id": 2,
        "text": "Acute mastoiditis"
      },
      {
        "id": 3,
        "text": "Intra-tympanic glomus tumor"
      },
      {
        "id": 4,
        "text": "Chronic suppurative otitis media"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>light-house</strong> effect is seen in&nbsp;<strong>acute</strong>&nbsp;<strong>mastoiditis,&nbsp;</strong>which&nbsp;is a complication of otitis media. This effect is described as a pulsatile mucopurulent or purulent discharge, coming through a central pin-hole perforation of pars tensa.&nbsp;This suggests a&nbsp;<strong>reservoir of infection</strong>&nbsp;in the mastoid and middle ear.</p>\n<p>Note: Otoscopic signs in intratympanic glomus tumors include:</p>\n<ul>\n<li><strong>Red reflex</strong> through an intact tympanic membrane</li>\n<li><strong>Pulsation sign</strong> or Brown sign -&nbsp;when ear canal pressure is raised with Siegel&rsquo;s speculum, the tumor pulsates vigorously and then blanches</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following attains adult size before birth?",
    "choices": [
      {
        "id": 1,
        "text": "Ear ossicles"
      },
      {
        "id": 2,
        "text": "Mastoid"
      },
      {
        "id": 3,
        "text": "Orbit"
      },
      {
        "id": 4,
        "text": "Cornea"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Ear ossicles</strong> attain <strong>adult size</strong> before birth.&nbsp;</p>\n<p>The development of the middle ear:</p>\n<ul>\n<li>The ossicles are full-sized cartilage models by 15 weeks of gestation.</li>\n<li>Endochondral ossification is complete by 25 weeks.</li>\n<li>The middle ear is adult-sized at birth.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the length of external auditory canal?",
    "choices": [
      {
        "id": 1,
        "text": "12mm"
      },
      {
        "id": 2,
        "text": "24mm"
      },
      {
        "id": 3,
        "text": "36mm"
      },
      {
        "id": 4,
        "text": "48mm"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The length of the external auditory canal is about <strong>24 mm</strong>.</p>\n<p>It extends from the bottom of the concha to the tympanic membrane. It has two parts:</p>\n<ul>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Outer cartilaginous part - <strong>8mm</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Inner bony part- <strong>16mm</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/626592dc49354939843ef6518ddb004cx1280x1460.JPEG"
    ]
  },
  {
    "text": "Recruitment is a feature of",
    "choices": [
      {
        "id": 1,
        "text": "Acoustic neuroma"
      },
      {
        "id": 2,
        "text": "Meniere\u2019s disease"
      },
      {
        "id": 3,
        "text": "ASOM"
      },
      {
        "id": 4,
        "text": "CSOM"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li>Recruitment phenomenon is seen in <strong>cochlear pathology like Meniere&rsquo;s disease.</strong></li>\n<li>This is the reason why patients with Meniere&rsquo;s have an intolerance to loud sound<strong>.</strong></li>\n<li>Acoustic neuroma is a retrocochlear pathology; ASOM and CSOM cause conductive hearing loss.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is false about the tympanic membrane?",
    "choices": [
      {
        "id": 1,
        "text": "0.2 mm thick"
      },
      {
        "id": 2,
        "text": "90 mm2 in area"
      },
      {
        "id": 3,
        "text": "Angle of 55 degree with horizontal"
      },
      {
        "id": 4,
        "text": "Inner surface is convex"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The tympanic membrane has a thickness of<strong> 0.1mm.</strong></p>\n<p>The dimensions of the tympanic membrane are</p>\n<ul>\n<li>Length: 9-10mm</li>\n<li>Width: 8-9mm</li>\n<li><strong>Area:</strong> <strong>90 mm<sup>2</sup></strong></li>\n<li>Subtends an angle of <strong>55&deg; with horizontal&nbsp;</strong></li>\n</ul>\n<p>The medial (inner) surface is convex and the&nbsp;<strong>lateral surface</strong>&nbsp;is<strong>&nbsp;concave.</strong>&nbsp;The <strong>most depressed part </strong>of its concavity is called<strong> the umbo,&nbsp;</strong>to which the<strong> tip of the malleus is attached.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/89397cccc22140ae96d077f584135d98x1280x1436.JPEG"
    ]
  },
  {
    "text": "Most common site of origin of acoustic neuroma is____",
    "choices": [
      {
        "id": 1,
        "text": "Cochlear nerve"
      },
      {
        "id": 2,
        "text": "Facial nerve"
      },
      {
        "id": 3,
        "text": "Vestibular nerve"
      },
      {
        "id": 4,
        "text": "Auricular nerve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Acoustic neuroma</strong> is a <strong>schwannoma</strong> more commonly arising from the <strong>superior and the inferior\u00a0</strong><strong>division of the vestibular nerve\u00a0</strong>(60\u201380 percent) in the medial <strong>internal auditory canal </strong>at the site of transition of central to peripheral myelin i.e. <strong>Obersteiner-Redlich zone.</strong></p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which part of middle ear is formed by tegmen tympani?",
    "choices": [
      {
        "id": 1,
        "text": "Floor of middle ear"
      },
      {
        "id": 2,
        "text": "Roof of middle ear"
      },
      {
        "id": 3,
        "text": "Lateral wall of middle ear"
      },
      {
        "id": 4,
        "text": "Medial wall of middle ear"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>tegmen tympani</strong> forms the <strong>roof</strong> of the middle ear.</p>\n<p>It separates the tympanic cavity from the <strong>middle cranial fossa</strong>.</p>\n<p>It also extends posteriorly to form the roof of the aditus and antrum as<strong>&nbsp;tegmen mastoidea</strong>.</p>\n<p>The following images shows the tegmen tympani and relations of middle ear:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0202339479194884a32494752c0447b3x1280x1357.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7148193cfc9049b19711da213500ca9ex1280x2092.JPEG"
    ]
  },
  {
    "text": "A child with hearing difficulty is diagnosed to have glue ear. Which of the following is not a possible sequela of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Middle ear atelectasis"
      },
      {
        "id": 2,
        "text": "Otosclerosis"
      },
      {
        "id": 3,
        "text": "Cholesteatoma"
      },
      {
        "id": 4,
        "text": "Tympanosclerosis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Otosclerosis </strong>is not a possible sequela of glue ear. Otosclerosis is a<strong> hereditary disease </strong>of the bone of the<strong> inner ear</strong>, which mostly affects the <strong>stapes footplate</strong> area<strong>. </strong>It is not related to other ear pathologies.</p>\n<p>The sequelae of long-standing glue ear include:</p>\n<ul>\n<li><strong>Atrophy</strong> of tympanic membrane (TM) and&nbsp;myringosclerosis<strong>&nbsp;</strong>(fibrosis of TM)</li>\n<li><strong>Atelectasis</strong> <strong>of middle ear</strong>&nbsp;- when the tympanic membrane gets retracted over the promontory</li>\n<li>Ossicular <strong>necrosis</strong></li>\n<li><strong>Tympanosclerosis</strong>&nbsp;- collagen deposits within the middle ear</li>\n<li>Retraction pockets in TM and <strong>cholesteatoma</strong></li>\n<li><strong>Cholesterol granulomas</strong> - due to stasis of secretions in the mastoid and middle ear</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following structures forms the promontory?",
    "choices": [
      {
        "id": 1,
        "text": "Basal turn of cochlea"
      },
      {
        "id": 2,
        "text": "Semicircular canal"
      },
      {
        "id": 3,
        "text": "Handle of malleus"
      },
      {
        "id": 4,
        "text": "Short process of incus"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The<strong> basal turn of the cochlea</strong> forms the <strong>promontory.</strong>&nbsp;</p>\n<p>The&nbsp;<strong>promontory</strong> is a bulge in the middle ear's&nbsp;<strong>medial wall,</strong> which&nbsp;is formed by the&nbsp;<strong>labyrinth</strong>.</p>\n<p>It gives 2 extensions:</p>\n<ul>\n<li><strong>Subiculum</strong> below to the round window.</li>\n<li><strong>Ponticulus</strong> to the posterior wall.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient has undergone a high-resolution CT of the temporal bone which confirmed a diagnosis of semicircular canal dehiscence syndrome. Which of the following will not be affected?",
    "choices": [
      {
        "id": 1,
        "text": "Posterior semicircular canal"
      },
      {
        "id": 2,
        "text": "Medial semicircular canal"
      },
      {
        "id": 3,
        "text": "Superior semicircular canal"
      },
      {
        "id": 4,
        "text": "Lateral semicircular canal"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The medial semicircular canal does not exist.</p>\n<p>The semicircular canals are part of the <strong>bony labyrinth</strong>.&nbsp;They house the semicircular ducts which are the end organs for angular momentum.</p>\n<p>They are 3 in number:</p>\n<ul>\n<li><strong>Superior</strong> also called anterior in the X-axis</li>\n<li><strong>Posterior</strong> in Y-axis</li>\n<li><strong>Lateral</strong> also called horizontal in Z-axis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b7b221dd7d19422fa8ca2234eff18a59x1280x2179.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eb0dfbfbbf0042959edf955504eeee7ex1280x1373.JPEG"
    ]
  },
  {
    "text": "The organ of Corti is situated over which membrane?",
    "choices": [
      {
        "id": 1,
        "text": "Basilar membrane"
      },
      {
        "id": 2,
        "text": "Reissner\u2019s membrane"
      },
      {
        "id": 3,
        "text": "Shrapnell\u2019s membrane"
      },
      {
        "id": 4,
        "text": "Stria vascularis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The organ of Corti is situated over the <strong>basilar membrane&nbsp;</strong>in scala media.</p>\n<p>The membranes of the cochlear duct:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/db6e073a0b4d4a96b07e576215ff74fex1280x1752.JPEG"
    ]
  },
  {
    "text": "Angular movements are sensed by",
    "choices": [
      {
        "id": 1,
        "text": "Utricle"
      },
      {
        "id": 2,
        "text": "Saccule"
      },
      {
        "id": 3,
        "text": "Semicircular canals"
      },
      {
        "id": 4,
        "text": "Cochlea"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Semicircular canals</strong> respond to <strong>angular acceleration and deceleration</strong>. The receptors are the cristae, located in the ampullated ends of the three semicircular ducts.</p>\n<p>Their utricle and saccule which contain macula, are stimulated by linear acceleration and deceleration or gravitational pull during the head tilts.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child with protruding ears is brought to the OPD by his worried parents. They opt for surgical correction of the defect due to cosmetic reasons. After what age would you proceed with the surgery?",
    "choices": [
      {
        "id": 1,
        "text": "3 months"
      },
      {
        "id": 2,
        "text": "6 months"
      },
      {
        "id": 3,
        "text": "3 years"
      },
      {
        "id": 4,
        "text": "6 years"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Protruding ears</strong> or bat ears can be <strong>corrected</strong>&nbsp;anytime <strong>after 6 years</strong> of age if cosmetic appearance demands. This is due to the fact that the pinna is completely developed and achieves adult configuration by the age of 6 years.</p>\n<p>Protruding ears are caused by a <strong>large concha</strong> with poorly developed antihelix and scapha.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f20339f38ecb4d8abf5e6dd67532b1c4x768x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ff6b455c69124977b95413a991c6cedax1280x1586.JPEG"
    ]
  },
  {
    "text": "What is the most common cause of hearing loss in children?",
    "choices": [
      {
        "id": 1,
        "text": "Acute Otitis Media"
      },
      {
        "id": 2,
        "text": "Otitis media with effusion"
      },
      {
        "id": 3,
        "text": "Chronic Suppurative Otitis Media"
      },
      {
        "id": 4,
        "text": "Prematurity"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Otitis media with effusion,&nbsp;</strong>or glue ear,<strong>&nbsp;</strong>is the <strong>most common</strong> cause of <strong>hearing loss</strong> in <strong>children.</strong></p>\n<p>Clinical features of glue ear include:</p>\n<ul>\n<li>Bilateral, painless, and fluctuating&nbsp;hearing loss. Conductive hearing loss not more than 40 dB is observed.</li>\n<li>Defective and delayed development of speech.</li>\n<li>Occasional mild earaches are present.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A first-year ENT postgraduate sees a child with permanent perforation of the tympanic membrane.  Which of the following is a feature of such perforation?",
    "choices": [
      {
        "id": 1,
        "text": "It is seen in acute suppurative otitis media"
      },
      {
        "id": 2,
        "text": "It is caused by necrotizing otitis externa"
      },
      {
        "id": 3,
        "text": "It has squamous epithelium at its edges"
      },
      {
        "id": 4,
        "text": "Medical management can be tried initially"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A permanent perforation is lined by <strong>squamous epithelium</strong> at its edges, hindering spontaneous healing.</p>\n<p>Features of a permanent perforation:</p>\n<ul>\n<li>Seen in chronic suppurative otitis media (CSOM)</li>\n<li>Is similar to an epithelial lined fistulous tract</li>\n<li>Cannot be medically managed, thus mandating surgery</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is true about the atticoantral type of chronic suppurative otitis media?",
    "choices": [
      {
        "id": 1,
        "text": "Most commonly involves the protympanum"
      },
      {
        "id": 2,
        "text": "Polyps are rarely present"
      },
      {
        "id": 3,
        "text": "The discharge is usually profuse"
      },
      {
        "id": 4,
        "text": "Involvement of Shrapnell's membrane is seen"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Atticoantral type</strong>&nbsp;also called unsafe or dangerous type involves perforation of&nbsp;<strong>Shrapnell's membrane</strong> or pars flaccida (attic perforation).&nbsp;</p>\n<p>The disease is often associated with a bone-eroding process such as <strong>cholesteatoma,</strong> granulations, or osteitis. The risk of complications is high in this variety.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a false statement regarding otosclerosis?",
    "choices": [
      {
        "id": 1,
        "text": "Females are affected twice as often as males."
      },
      {
        "id": 2,
        "text": "Stapedotomy should be avoided in children."
      },
      {
        "id": 3,
        "text": "HRCT shows double ring sign in stapedial otosclerosis."
      },
      {
        "id": 4,
        "text": "It may be associated with measles."
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>HRCT&nbsp;shows the <strong>double-ring sign&nbsp;</strong>in <strong>cochlear otosclerosis,</strong> not in the stapedial type.</p>\n<p>Otosclerosis affects <strong>females</strong> twice as often as males. But in India, otosclerosis seems to predominate in males.</p>\n<p>Stapedotomy is <strong>contraindicated in children</strong> because recurrent eustachian tube dysfunction is common in them. This can displace the prosthesis or cause acute otitis media.&nbsp;</p>\n<p><strong>Measles RNA</strong> has been found in otosclerotic foci implicating its possible role in pathogenesis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Glycerol test is done in",
    "choices": [
      {
        "id": 1,
        "text": "BPPV"
      },
      {
        "id": 2,
        "text": "Otosclerosis"
      },
      {
        "id": 3,
        "text": "Meniere\u2019s disease"
      },
      {
        "id": 4,
        "text": "ASOM"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Glycerol test</strong> is done in <strong>Meniere's disease.</strong></p>\n<p>Glycerol is a <strong>dehydrating agent</strong>. When given orally, it reduces endolymph pressure and thus causes an <strong>improvement in hearing</strong>. The test has a <strong>diagnostic and prognostic value</strong>. These days, glycerol test is combined with electrocochleography.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 3-year-old child was brought to the OPD with fever, earache, and poor feeding after an episode of URTI. You suspect this as acute suppurative otitis media due to an eustachian tube defect. Which is the most accurate test to detect this?",
    "choices": [
      {
        "id": 1,
        "text": "Valsalva maneuver"
      },
      {
        "id": 2,
        "text": "Toynbee maneuver"
      },
      {
        "id": 3,
        "text": "Tympanometry"
      },
      {
        "id": 4,
        "text": "Politzerisation"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Tympanometry</strong> is the most accurate&nbsp;<strong>test&nbsp;</strong>to assess <strong>eustachian tube (ET) dysfunction</strong>. It is an objective measure of ET function and does not rely on patient cooperation.</p>\n<p>In this test, the movement of TM is visualized to the variation in external canal pressure. The disadvantage is middle ear pathologies can overshadow ET function.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is the shortest and narrowest segment of the facial nerve?",
    "choices": [
      {
        "id": 1,
        "text": "Meatal segment"
      },
      {
        "id": 2,
        "text": "Labyrinthine segment"
      },
      {
        "id": 3,
        "text": "Tympanic segment"
      },
      {
        "id": 4,
        "text": "Mastoid segment"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>shortest and narrowest segment</strong> of the facial nerve is the <strong>labyrinthine segment&nbsp;</strong>(length 4.0 mm, diameter 0.61&ndash;0.68 mm).</p>\n<p>The labyrinthine segment is from the fundus of meatus to the geniculate ganglion where the nerve takes a turn posteriorly forming a genu. The nerve in the labyrinthine segment has the narrowest diameter&nbsp; and the bony canal in this segment is also the narrowest. Thus <strong>edema or inflammation</strong> can easily <strong>compress the nerve</strong> and cause paralysis.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/420f3175135e46929b2b19e6d9c4162bx1280x4080.JPEG"
    ]
  }
];
        let quizName = 'Ent St 2 (From Q-Bank)';
        const quizFilename = 'ent-st-2-from-q-bank-216de5ec.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2017 - 18"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>