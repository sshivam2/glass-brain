<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 002 (Image-Based) - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2023
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following arteries passes in close proximity to the area marked by the arrow in the given image?",
    "choices": [
      {
        "id": 1,
        "text": "Internal carotid artery"
      },
      {
        "id": 2,
        "text": "Middle meningeal artery"
      },
      {
        "id": 3,
        "text": "Anterior cerebral artery"
      },
      {
        "id": 4,
        "text": "Deep temporal artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The area marked by an arrow in the given image is&nbsp;<strong>p</strong><strong>terion&nbsp;</strong>and the artery that passes in close proximity&nbsp;to this area is the&nbsp;<strong>middle meningeal artery</strong>.</p>\n<p><strong>The pterion</strong> is an <strong>H shaped sutural junction</strong> between <strong>four bones of the skull:</strong></p>\n<ul>\n<li>Frontal bone</li>\n<li>Squamous part of the temporal bone</li>\n<li>Greater wing of the sphenoid bone</li>\n<li>Parietal bone.</li>\n</ul>\n<p>It is an important structure as it overlies the anterior branch of the <strong>middle meningeal artery</strong> and <strong>lateral fissure of the cerebral hemisphere</strong>. The bone in this area is thin and any injury to this area may lead to rupture of the middle meningeal artery leading to <strong>extradural hematoma.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/626d23b333a046029878fb2995d3c5fd.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/93b950527b9348b9ba405b1a9637e698x525x625.PNG"
    ]
  },
  {
    "text": "Phases of the ventricular muscle action potential are shown below. At which phase is the action potential most dependent on sodium permeability?",
    "choices": [
      {
        "id": 1,
        "text": "Phase 3"
      },
      {
        "id": 2,
        "text": "Phase 2"
      },
      {
        "id": 3,
        "text": "Phase 0"
      },
      {
        "id": 4,
        "text": "Phase 1"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The action potential is most dependant on sodium permeability in <strong>phase 0</strong>.&nbsp;</p>\n<p>Action potential of myocardium:</p>\n<ul>\n<li><strong>Phase 0:&nbsp;</strong><strong>Depolarisation: </strong>Influx of Na+ into myocyte.</li>\n<li><strong>Phase 1:&nbsp;<strong>Early repolarization</strong>: </strong>Efflux of&nbsp;K+ from myocyte.</li>\n<li><strong>Phase 2:&nbsp;</strong><strong>Plateau:&nbsp;</strong>Ca2+ enters myocardial cells via voltage regulated L-type Ca2+ channels.</li>\n<li><strong><strong>Phase 3: R</strong>epolarisation:&nbsp;</strong>Efflux of K+.</li>\n<li><strong><strong>Phase 4: R</strong>estoration of RMP:&nbsp;</strong>Restoration of Na+ and K+ by Na-K ATPase.&nbsp;</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8d055cf4cdd24a1da8e1b59cda473d27.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2daf166599b04752a5dbada64ed526e1x800x600.GIF"
    ]
  },
  {
    "text": "The girl seen in the image has had a history of severe sunburns after just a few minutes in the sun, severe freckling in the sun-exposed areas. The autosomal recessive condition responsible for this is due to:",
    "choices": [
      {
        "id": 1,
        "text": "Defective Nonhomologous End Joining Repair (NHEJ)"
      },
      {
        "id": 2,
        "text": "Defective DNA Nucleotide Excision Repair (NER)"
      },
      {
        "id": 3,
        "text": "Defective DNA Base Excision Repair (BER)"
      },
      {
        "id": 4,
        "text": "Defective DNA Mismatch Repair (MMR)"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows a girl with <strong>Xeroderma Pigmentosum</strong>. It is characterized by <strong>Defective Nucleotide Excision repair</strong> that is transmitted <strong>autosomal recessively</strong></p>\n<p><strong>Clinical Features:</strong></p>\n<p>Typical 3 stage Progression.</p>\n<p>Child is <strong>asymptomatic at birth.</strong> Diffuse erythema, scaling, and freckle like areas over the sun exposed regions of the body at around 6 months of age.</p>\n<p><strong>Poikiloderma</strong> is a characteristic feature of the&nbsp;<strong>second stage</strong>. Poikiloderma results in <strong>skin atrophy, telangiectasias</strong> with <strong>mottled hyperpigmentation and hypopigmentation.</strong></p>\n<p>In the <strong>third stage</strong> appearance of <strong>cutaneous malignancies</strong> like<strong> squamous cell carcinomas</strong>,<strong> malignant melanoma, basal cell carcinoma, and fibrosarcoma.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/896cfaf7a2ca44159b3531e096e8be44.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The peripheral blood smear picture of a patient with Acute Promyelocytic Leukaemia is given in the image. The cell indicated by the arrow is best described as:",
    "choices": [
      {
        "id": 1,
        "text": "Buttocks cell"
      },
      {
        "id": 2,
        "text": "Flaming promyelocyte"
      },
      {
        "id": 3,
        "text": "Faggot cell"
      },
      {
        "id": 4,
        "text": "Dusky promyelocyte"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given cell shows <strong>multiple Auer rods</strong> <strong>clustered together</strong> within a single cell resembling a bundle of sticks. Such cells have been termed as &ldquo;<strong>Faggot cells</strong>&rdquo; (faggot in French means <strong>bundle of sticks</strong>). &nbsp;<br />Acute Myeloid Leukemia (AML) is a tumour of hematopoietic progenitors caused by acquired oncogenic mutations that impede differentiation, leading to accumulation of immature myeloid blasts in the marrow. Acute Promyelocytic Leukemia (APML) belongs to <strong>FAB M3</strong> class.</p>\n<p>Numerous Auer rods which are azurophilic granules are present in bundles with individual progranulocytes. Primary granules are very prominent associated with very high incidence of DIC. They are <strong>myeloperoxidase (+)</strong>; cytogenetic abnormality seen in APML is <strong>t(15;17)(q22;q12).</strong> These AML cells express <strong>CD13</strong> &amp; <strong>CD 33</strong> antigens.</p>\n<p>Other options:</p>\n<ul>\n<li>The term <strong>flaming promyelocyte</strong> has been coined to describe cells that appear to be &ldquo;breaking apart&rdquo;, taking on a vibrant reddish-purple hue with the apparent liberation of granules into the surrounding cellular matrix.</li>\n<li>Promyelocytes containing fine granules appear &ldquo;<strong>dusky</strong>&rdquo; or &ldquo;<strong>hazy</strong>&rdquo; and are referred to as such.</li>\n<li>Buttocks cells are cells having a notched appearance that are found in certain malignancies such as,&nbsp;</li>\n</ul>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- <strong>Non Hodgkin's lymphoma</strong></p>\n<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Sezary syndrome</strong></p>\n<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Mycosis fungoides</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/52f99c5b61ab41ceb4d758fd889b5a2a.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The test kit shown in the image below works on the principle of:",
    "choices": [
      {
        "id": 1,
        "text": "ELISA"
      },
      {
        "id": 2,
        "text": "Immunochromatography"
      },
      {
        "id": 3,
        "text": "Immunofluroscence"
      },
      {
        "id": 4,
        "text": "Chemiluminiscence"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows a<strong> HbsAg card test kit</strong>&nbsp;which works on the principle of&nbsp;<strong>i</strong><strong>mmunochromatography.</strong></p>\n<div class=\"page\" title=\"Page 762\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The immunochromatographic membrane is used for antigen detection, while a nitrocellulose membrane is used to absorb the antigen from a specimen. A <strong>coloured reaction</strong> appears <strong>directly on the membrane</strong> with the sequential addition of conjugate followed by the substrate. In some cases, the antigen is captured by a bound antibody directed against the antigen. These assays have the advantage of being <strong>rapid</strong> and also frequently include a <strong>built-in internal control.</strong></p>\n</div>\n</div>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/060c3be6efa04f68855b8711fbd74681.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following hormones act through the receptor shown in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Insulin"
      },
      {
        "id": 2,
        "text": "Somatostatin"
      },
      {
        "id": 3,
        "text": "Cholecystokinin"
      },
      {
        "id": 4,
        "text": "Vasopressin (V1 receptor)"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The receptor in the given image uses <strong>tyrosine kinase</strong> signaling.<strong>&nbsp;Insulin&nbsp;</strong>acts through this receptor to exert its functions.</p>\n<p>Other hormones acting via tyrosine kinase signaling:&nbsp;</p>\n<ul>\n<li>Growth hormone</li>\n<li>Growth factors like VEGF, PDGF, FGF, NGF</li>\n<li>Prolactin</li>\n<li>Leptin</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/38f37ec2920f4dc9a6c5ce07af2e5c09.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the injury in the image below.",
    "choices": [
      {
        "id": 1,
        "text": "Abrasion"
      },
      {
        "id": 2,
        "text": "Laceration"
      },
      {
        "id": 3,
        "text": "Bruise"
      },
      {
        "id": 4,
        "text": "Imprint"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The given image shows abrasion.</p>\n<p>An abrasion is the most superficial of injuries and, in the most restrictive of definitions, is one that&nbsp;<strong>does not penetrate the full thickness of the epidermis</strong>.</p>\n<p>Thus the&nbsp;<strong>pure abrasion does not bleed</strong>, as blood vessels are confined to the dermis. Because of the corrugated nature of the dermal papillae, however, many abrasions enter the corium and bleeding commonly occurs.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/66bd2b5045c5450b9fe906f66cd7b2ef.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the lesion of vocal cord in the image given below :",
    "choices": [
      {
        "id": 1,
        "text": "Reinke\u2019s edema"
      },
      {
        "id": 2,
        "text": "Malignancy"
      },
      {
        "id": 3,
        "text": "Tracheomalacia"
      },
      {
        "id": 4,
        "text": "Laryngeal papilloma"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image depicts <strong>laryngeal papilloma.</strong></p>\n<p><strong>Laryngeal papillomatosis&nbsp;</strong>(juvenile papillomatosis)</p>\n<ul>\n<li>It is the&nbsp;<strong>most common benign neoplasm</strong>&nbsp;of the&nbsp;<strong>larynx</strong>&nbsp;in children.</li>\n<li>It is caused by&nbsp;<strong>HPV 6</strong>&nbsp;and<strong>&nbsp;11.&nbsp;</strong></li>\n<li>Involves&nbsp;<strong>supraglottic</strong>&nbsp;and<strong>&nbsp;glottic</strong>&nbsp;regions of larynx.</li>\n<li>Clinical features:\n<ul>\n<li>Age 3&ndash;5 years</li>\n<li>Hoarseness or aphonia</li>\n<li>Respiratory difficulty</li>\n</ul>\n</li>\n<li>Diagnosis is confirmed by direct laryngoscopy and biopsy.&nbsp;</li>\n<li>Treatment consists of&nbsp;<strong>microlaryngoscopy</strong>&nbsp;and&nbsp;<strong>CO2 laser Excision.</strong></li>\n</ul>\n<p><strong>Adult-onset</strong> laryngeal papillomatosis is less common and usually seen in <strong>males</strong> aged 30-50 years. It is less aggressive and involves the <strong>anterior part of the vocal cords</strong>. The treatment is the same as juvenile papillomatosis.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7b22713ae1e24f6bb71b6eaf57926367.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 50-year-old female complaining of irritation in her left eye has the following finding. Which of the following condition commonly causes this?",
    "choices": [
      {
        "id": 1,
        "text": "Polyarteritis nodosa"
      },
      {
        "id": 2,
        "text": "Wegener's granulomatosis"
      },
      {
        "id": 3,
        "text": "Rheumatoid arthritis"
      },
      {
        "id": 4,
        "text": "Giant cell arteritis"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical condition and the given image is suggestive of <strong>scleromalacia perforans.&nbsp;</strong>It is commonly associated with <strong>rheumatoid arthritis.</strong></p>\n<p>Scleromalacia perforans is a specific type of <strong>progressive scleral thinning</strong> without inflammation. It is typically seen in elderly women with <strong>longstanding rheumatoid arthritis.&nbsp;</strong>Despite the term 'scleromalacia perforans',<strong> perforation is extremely rare</strong> as the integrity is maintained by a thin layer of fibrous tissue.</p>\n<p>Overall,&nbsp;<strong>50% </strong>of cases of scleritis are associated with systemic diseases; the most common being connective tissue diseases. About<strong> 0.5%</strong> of patients suffering from <strong>seropositive rheumatoid arthritis</strong> develop scleritis.</p>\n<p><strong>Other associated collagen disorders</strong> are as follows:</p>\n<ul>\n<li>Wegener&rsquo;s granulomatosis</li>\n<li>Polyarteritis nodosa</li>\n<li>Systemic lupus erythematosus (SLE)</li>\n<li>Ankylosing spondylitis</li>\n<li>Relapsing polychondritis</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/de2cb058adce40b1b95cf1f8ee2c4fa1.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The following image represents",
    "choices": [
      {
        "id": 1,
        "text": "Rashtriya swasthya bima yojana"
      },
      {
        "id": 2,
        "text": "Mid day meal program"
      },
      {
        "id": 3,
        "text": "Integrated child development service"
      },
      {
        "id": 4,
        "text": "Mission indradhanush"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Option a</strong>: Rashtriya swasthya bima yojana</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e51a4bd0d45b4e2fb60937d8675959c8.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8b265cadb55a4e1e9509b90efb979b46x1280x1024.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f67e76e2054422ca21c608c4476a269x1280x1025.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/729c7fa0a3234595afa61b027e2f85a7x1280x1024.JPEG"
    ]
  },
  {
    "text": "The life cycle of which of the following is depicted in the image below?",
    "choices": [
      {
        "id": 1,
        "text": "Japanese encephalitis"
      },
      {
        "id": 2,
        "text": "Zika virus"
      },
      {
        "id": 3,
        "text": "Rabies"
      },
      {
        "id": 4,
        "text": "Nipah virus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The image given in question illustrates the life cycle of the <strong>Nipah virus</strong>, an <strong>RNA</strong> virus. <strong>Fruit bats</strong> serve as its <strong>natural host</strong>, and <strong>transmission</strong> occurs from<strong> bats and pigs to humans</strong>.</p>\n<p><strong>Nipah virus</strong> is an<strong> RNA </strong>virus from the family <strong>Paramyxoviridae</strong> and the genus <strong>Henipavirus</strong>. It is zoonotic, with<strong> fruit bats</strong> from the Pteropodidae family as its <strong>natural hosts.</strong> <strong>Transmission</strong> occurs from animals, such as <strong>bats and pigs, to humans</strong>, as well as between humans.Symptoms range from <strong>asymptomatic (subclinical) </strong>infection to acute respiratory illness and fatal encephalitis.</p>\n<p>Currently, <strong>no treatment or vaccine</strong> exists for humans or animals, and <strong>supportive care</strong> is the main form of treatment for those infected. Nipah virus is also listed among the WHO's Blueprint priority diseases.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/52cec573410e46088b9f6c72879f967e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the English epidemiologist in the picture below:",
    "choices": [
      {
        "id": 1,
        "text": "Alexander Fleming"
      },
      {
        "id": 2,
        "text": "James Lind"
      },
      {
        "id": 3,
        "text": "Edward Jenner"
      },
      {
        "id": 4,
        "text": "John Snow"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>John Snow</strong></p>\n<ul>\n<li>English epidemiologist; studied cholera and its association with polluted drinking water</li>\n<li>Father of (Modern) Epidemiology</li>\n<li>Often called as &lsquo;Greatest Doctor&rsquo;</li>\n<li>Calculated dose of ether and chloroform as surgical anesthesia</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/cf2d2c4d2df54237af0f882d6b63e0c5.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The flow-volume curve after spirometry in patient 1 is given below. The most likely diagnosis in this patient is ________",
    "choices": [
      {
        "id": 1,
        "text": "Endobronchial neoplasm"
      },
      {
        "id": 2,
        "text": "Bronchial asthma"
      },
      {
        "id": 3,
        "text": "Myasthenia gravis"
      },
      {
        "id": 4,
        "text": "Emphysema"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most likely diagnosis in patient 1 with restrictive pattern on flow-volume curve is <strong>Myasthenia gravis</strong>.</p>\n<p>The flow volume curve above (patient 1) shows <strong>decreased</strong> Total lung capacity, Vital capacity, Residual volume. Hence, the loop shifts towards the <strong>right</strong>. This is seen in restrictive lung disease.</p>\n<p>Myasthenia gravis presents with <strong>ventilatory restriction</strong> due to reduced respiratory muscle strength.</p>\n<p>Asthma, emphysema, endobronchial neoplasm present with <strong>obstructive flow pattern</strong>. The increased total lung capacity, vital capacity and residual volume will shift the flow volume loop to<strong> left</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ccd86066cb78461dba9931cd9c2b7e64.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f02036f4f60f48f886c712c78c0172b3x1280x1455.JPEG"
    ]
  },
  {
    "text": "A 50-year-old female presents with complaints of severe pain in her left great toe. The pain started since she woke up in the morning and severe to an extent that she is not able to stamp her foot on the ground. A local examination of her foot is given in the image below. Which of the following investigations is least useful in arriving at a diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Serum uric acid levels"
      },
      {
        "id": 2,
        "text": "Ultrasound of the involved joint"
      },
      {
        "id": 3,
        "text": "Needle aspiration of the synovial fluid"
      },
      {
        "id": 4,
        "text": "Clinical diagnosis is sufficient"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The symptoms and the clinical examination findings are suggestive of an acute attack of gout. <strong>Serum uric acid level is least useful</strong> in arriving at a diagnosis of gout.</p>\n<p>During an acute attack of gout, the inflammatory cytokines promote the excretion of uric acid and hence, its level can be normal or decreased at such instances. This limits the use of serum uric acid level for the diagnosis of gout.</p>\n<p>Even if the<strong> diagnosis</strong> of gout is clinically strong, it should <strong>ideally</strong> be <strong>confirmed by needle aspiration</strong> of the involved joint. The synovial fluid aspirated from the inflamed joints has the following features</p>\n<ul>\n<li>Needle shaped monosodium urate (MSU) crystals which appear brightly birefringent with negative elongation under polarised microscopy.</li>\n<li>The leukocyte counts are elevated from 2000 to 60,000/&mu;L and give a cloudy appearance of the aspirated fluid</li>\n</ul>\n<p><strong>Ultrasound</strong> may aid in the earlier diagnosis by showing a <strong>double contour sign</strong> overlying the articular cartilage.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/0af777b68c5a4a119864d08741dc6043.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 28-year-old woman presented to the clinic with the lesions shown below. Which of the following conditions is/are associated with this lesion?",
    "choices": [
      {
        "id": 1,
        "text": "1 and 5"
      },
      {
        "id": 2,
        "text": "2, 3 and 5"
      },
      {
        "id": 3,
        "text": "1, 3 and 4"
      },
      {
        "id": 4,
        "text": "1, 2 and 4"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The lesions shown in the image are <strong>spider naevi&nbsp;</strong>(nevus araneus). They are seen in:</p>\n<ul>\n<li>Estrogen excess states such as pregnancy and OCP use</li>\n<li>Chronic liver disease - especially alcoholic liver disease</li>\n<li>Thyrotoxicosis</li>\n</ul>\n<p>They are vascular lesions characterized by the<strong> tortuous dilatation of arterioles</strong> just underneath the skin. On applying and releasing pressure over the lesion they typically fill from the centre outward.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/38b8f75ddb9a4f43a5abb80c552b6e87.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient with acute hepatitis B has recovered from the infection. Identify the serological marker marked in the image:",
    "choices": [
      {
        "id": 1,
        "text": "Anti-Hbc Ab"
      },
      {
        "id": 2,
        "text": "Anti-Hbs Ab"
      },
      {
        "id": 3,
        "text": "Anti-Hbe Ab"
      },
      {
        "id": 4,
        "text": "HbsAg"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The serological marker marked in the image is <strong>anti-Hbc Ab antibody</strong>. It remains elevated for a long period after recovery from infection.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e69dad44e269478c9be195264d588d77.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/59d66670c07a481abcc0e406a52edd56x1280x1156.JPEG"
    ]
  },
  {
    "text": "Identify the incision for appendicectomy.",
    "choices": [
      {
        "id": 1,
        "text": "Gridiron incision"
      },
      {
        "id": 2,
        "text": "Lanz incision"
      },
      {
        "id": 3,
        "text": "Rutherford\u2013Morison incision"
      },
      {
        "id": 4,
        "text": "Rockey\u2013Davis incision"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<ul>\n<li><strong>Lanz incision</strong> is a transverse or skin crease incision for appendicitis,2 cm below the&nbsp; umbilicus, centred on the midclavicular&ndash;midinguinal line</li>\n<li><strong>Rockey&ndash;Davis incision :</strong>&nbsp;Transverse right lower quadrant incision.</li>\n<li><strong>Gridiron</strong>&nbsp;<strong>i</strong><strong>ncision :</strong>&nbsp;Oblique muscle <strong>splitting</strong> incision in the right lower quadrant. Also called as <strong>Mc Burney</strong> incision.</li>\n<li><strong>Rutherford&ndash;Morrison incision :&nbsp;</strong>oblique muscle <strong>cutting</strong> incision with its lower end over McBurney&rsquo;s point and <strong>extending obliquely upwards and laterally</strong> as necessary (shown on the left side in the image for the sake of clarity)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e8052fce4c554c2290df8f21e4cc88ef.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7fcf2d22eeb94e2686b24dca63e0784ex1200x1486.JPEG"
    ]
  },
  {
    "text": "A woman came with a 4 x 3 cm lump over the left breast. On examination, the breast appears as shown below. Ipsilateral supraclavicular lymph nodes are palpable with fixed axillary nodes on the right side. What is the most appropriate tumor staging?",
    "choices": [
      {
        "id": 1,
        "text": "T2 N2a M0"
      },
      {
        "id": 2,
        "text": "T4a N3c M0"
      },
      {
        "id": 3,
        "text": "T2 N3c M1"
      },
      {
        "id": 4,
        "text": "T4b N3c M1"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>TNM staging in the given scenario is <strong>T4b N3c M1.&nbsp;</strong></p>\n<ul>\n<li>Tumour of <strong>any size</strong> with overlying <strong>skin</strong> involvement (Peau d'orange appearance) -&nbsp;<strong>T4b</strong></li>\n<li>Ipsilateral <strong>supraclavicular</strong> lymph node involvement -&nbsp;<strong>N3c </strong></li>\n<li>Involvement of any <strong>contralateral lymph nodes</strong> indicates distant&nbsp;metastasis -&nbsp;<strong>M1</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f81155bd55224c2ea58dcabae9b4f2b2.PNG"
    ],
    "explanation_images": []
  },
  {
    "text": "The operating surgeon performed the following suture technique on the skin after appendicectomy surgery. This is called_______.",
    "choices": [
      {
        "id": 1,
        "text": "Mattress suture"
      },
      {
        "id": 2,
        "text": "Subcuticular suture"
      },
      {
        "id": 3,
        "text": "Continuous suture"
      },
      {
        "id": 4,
        "text": "Interrupted suture"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>This suture technique is called <strong>mattress suture</strong>. The type of mattress suture performed is horizontal mattress suture. It is performed by inserting a needle perpendicular to the incision and then crossing both the edge of the wound and moving horizontally and traverse once again both the edge of the wound and tie the knot.</p>\n<p>Other options :</p>\n<p>B) The subcuticular suture technique is performed by taking a bite alternatively on either side of the wound and gently pulling simultaneously until the end.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8bf2c7c741e749378449abbca6b767f7.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3836f85a2bd24e36b8751e3a585508d7x139x109.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4fe646c05cb849ac803cb8bf496e0090x230x179.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fa5b5695ff38436f8f15d165cc0ac81fx108x85.JPEG"
    ]
  },
  {
    "text": "Which type of anal fistula is seen in this image?",
    "choices": [
      {
        "id": 1,
        "text": "Intersphincteric"
      },
      {
        "id": 2,
        "text": "Trans-sphincteric"
      },
      {
        "id": 3,
        "text": "Supra-sphincteric"
      },
      {
        "id": 4,
        "text": "Extra-sphincteric"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>In the given image, the fistula traverses the internal sphincter and tracks down the space between the internal and external anal sphincters. Hence, it is an&nbsp;<strong>inter-sphincteric </strong>type of <strong>anal fistula</strong>. It&nbsp;is the <strong>most common</strong>&nbsp;anal fistula.</p>\n<p>A <strong>fistula-in-ano</strong> is an epithelial-lined tract connecting the anal canal to the perianal skin.&nbsp;Patients usually complain&nbsp;of intermittent purulent discharge and pain. Anal fistulas can be simplex or complex fistulas.</p>\n<ol>\n<li><strong>Simple fistulas</strong>-&nbsp;include a single tract, subcutaneous tract, and those that involve less than 30% of the external sphincter. They are easier to treat, and have lower chances of recurrence.&nbsp;</li>\n<li><strong>Complex fistulas</strong>-&nbsp;include fistulas involving more than 30% of the external sphincter, with multiple tracts, recurrent fistulas, and those associated with other predisposing factors, such as Crohn disease and radiation treatment.</li>\n</ol>\n<p>Fistulas can also be classified into<strong> high or low-lying fistulas</strong>, based on their location with respect to the<strong> puborectalis</strong> muscle.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ace926a8d7444e739fac8f6ce7972bc1.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7c958d0b754b4a288fade758c021b9abx1280x1323.JPEG"
    ]
  },
  {
    "text": "A pregnant woman presented to the clinic with the following fetal presentation. What is the likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Stargazer breech"
      },
      {
        "id": 2,
        "text": "Complete breech"
      },
      {
        "id": 3,
        "text": "Flexed breech"
      },
      {
        "id": 4,
        "text": "Frank breech"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p class=\"p1\">The given clinical scenario is suggestive of&nbsp;<strong>frank breech.</strong></p>\n<p>Breech presentation can be divided into the following:</p>\n<ul>\n<li><strong>Incomplete:</strong> Breech with extended legs, footling, knee presentation</li>\n<li><strong>Complete:</strong> Breech with flexed legs</li>\n</ul>\n<table style=\"height: 331px; width: 453.672px;\">\n<tbody>\n<tr style=\"height: 50px;\">\n<td style=\"width: 147px; height: 50px;\"><strong>Breech type</strong></td>\n<td style=\"width: 138px; height: 50px;\"><strong>Description</strong></td>\n<td style=\"width: 145.672px; height: 50px;\"><strong>Presenting part</strong></td>\n</tr>\n<tr style=\"height: 47.3906px;\">\n<td style=\"width: 147px; height: 47.3906px;\"><strong>Frank breech</strong><br />(with extended legs)</td>\n<td style=\"width: 138px; height: 47.3906px;\">Thighs flexed on the trunk,&nbsp;legs extended at the knee joint.</td>\n<td style=\"width: 145.672px; height: 47.3906px;\">Buttocks and genitalia</td>\n</tr>\n<tr style=\"height: 50px;\">\n<td style=\"width: 147px; height: 50px;\"><strong>Footling</strong></td>\n<td style=\"width: 138px; height: 50px;\">Both thighs and legs are partially extended</td>\n<td style=\"width: 145.672px; height: 50px;\">Foot&nbsp;</td>\n</tr>\n<tr style=\"height: 50px;\">\n<td style=\"width: 147px; height: 50px;\"><strong>Knee&nbsp;</strong></td>\n<td style=\"width: 138px; height: 50px;\">Thighs extended, Knee flexed</td>\n<td style=\"width: 145.672px; height: 50px;\">Knee</td>\n</tr>\n<tr style=\"height: 50px;\">\n<td style=\"width: 147px; height: 50px;\"><strong>Complete</strong>/flexed</td>\n<td style=\"width: 138px; height: 50px;\">Both thighs and legs are flexed.</td>\n<td style=\"width: 145.672px; height: 50px;\">Buttocks, genitalia, foot</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d1b2ba30f1034a8b8fad7d75ae53685c.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/46387b5e7474409e8d3263a576856a7cx1280x3531.JPEG"
    ]
  },
  {
    "text": "A 55 year old lady comes with abnormal uterine bleeding. Hysterectomy was performed and the following specimen was  retrieved. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Leiomyoma"
      },
      {
        "id": 2,
        "text": "Endometrial carcinoma"
      },
      {
        "id": 3,
        "text": "Endometrial polyp"
      },
      {
        "id": 4,
        "text": "Adenomyosis"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The specimen is of a Leiomyoma.</p>\n<p>The uterine body / corpus is enlarged and deformed. The cut surface shows multiple nodules, well-circumscribed, firm, white-greyish with a whorled appearance formed by the intersecting bundles of brown muscle fibers and white fibrous tissue. Leiomyomas can also present bleeding areas, cystic degeneration and calcifications. The uterine cavity is compressed.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5c312ff9533347e3a51d19663541f0ba.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Identify the contraceptive shown in the given image.",
    "choices": [
      {
        "id": 1,
        "text": "Male condom"
      },
      {
        "id": 2,
        "text": "Female condom"
      },
      {
        "id": 3,
        "text": "Diaphragm"
      },
      {
        "id": 4,
        "text": "Cervical cap"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given image shows a <strong>female condom</strong>. It consists of a pouch made of <strong>polyurethane</strong> which is 17 cm in length with flexible ring at each end. The<strong> inner ring</strong> at the closed end is <strong>smaller</strong> than the outer ring.</p>\n<p>The inner ring is inserted at the apex of the vagina and the outer ring remains outside. It&nbsp;covers the cervix, entire vagina, and external genitalia. Hence, it provides <strong>protection against HIV</strong> and <strong>STDs</strong>.&nbsp;It has a <strong>failure rate</strong> of <strong>5&ndash;15</strong> per 100 woman-years, which is higher than that of a male condom.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/70234c52a52d48558ceb40a892bb7614.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "An infant weighing 4 Kg at birth is shown in the image below. The affected cranial nerves are:",
    "choices": [
      {
        "id": 1,
        "text": "C5"
      },
      {
        "id": 2,
        "text": "C5 and C6"
      },
      {
        "id": 3,
        "text": "C6 and C7"
      },
      {
        "id": 4,
        "text": "C7, C8 and T1"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The infant has <strong>Erb's palsy</strong>, caused by injury to <strong>C5 and C6</strong> nerves.</p>\n<p>The characteristic position consists of adduction and internal rotation of the arm with pronation of the forearm. <strong>Brachial plexus injuries</strong> are common in big babies due to <strong>shoulder dystocia</strong> during birth.</p>\n<p><strong>Klumpke&rsquo;s paralysis</strong>&nbsp;(image below) is caused by injury to the <strong>C7, C8 and T1</strong> nerve roots. The baby lies with the forearm supinated and the elbow flexed.&nbsp;There may be a<strong> unilateral Horner&rsquo;s syndrome</strong>, characterized by<strong>&nbsp;</strong>ipsilateral ptosis and miosis (Horner syndrome) if the sympathetic fibers of the 1<sup>st</sup> thoracic root are also injured.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d80ef1ff3fa941b6842d0906ea5b34b2.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/69480ad63d914a81bd87c93acc463b05x1280x1954.JPEG"
    ]
  },
  {
    "text": "What is the procedure being performed?",
    "choices": [
      {
        "id": 1,
        "text": "Pus drainage in acute osteomyelitis"
      },
      {
        "id": 2,
        "text": "Drainage kept after joint surgery"
      },
      {
        "id": 3,
        "text": "Intraosseous fluid transfusion in shock"
      },
      {
        "id": 4,
        "text": "Fixed suction catheter"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above image shows&nbsp;<strong>intraosseous cannulation</strong> for fluid transfusion in the anterior proximal tibia.</p>\n<p>The marrow of long bones has a rich network of vessels that drain into a central venous canal, emissary veins, and ultimately the central circulation. So, the bone marrow functions as a <strong>non-collapsible</strong> venous access route.</p>\n<p>Intraosseous cannulation is recommended for patients in whom IV access proves difficult or unattainable within 1 min. (e.g., in&nbsp;<strong>cardiopulmonary arrest</strong>)</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/9b0897bbdf4147e4b20a7801091f87ea.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Match the following intracranial bleed:",
    "choices": [
      {
        "id": 1,
        "text": "A-i   B-ii    C-iii   D- iv"
      },
      {
        "id": 2,
        "text": "A -ii   B-iv   C-i    D-iii"
      },
      {
        "id": 3,
        "text": "A-iv   B-iii    C -ii    D-i"
      },
      {
        "id": 4,
        "text": "A -iv   B-ii   C-iii    D-i"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Epidural hematoma:</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/d659a49557e947f1962b9413f401081e.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1f1690155c0e4d0c8dea154ff9b88729x181x181.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2c92c6114a0643f0ab0741d215bffdb6x172x121.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/0cf55af2acdd4b3ca9c3eff50412a2b5x155x159.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6dd2003fbbde453b904c3c99eba4bd16x193x159.JPEG"
    ]
  },
  {
    "text": "A 40-year-old patient comes to the OPD with a history significant for a mood disorder. Her moods can be charted as done in the image given below. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Cyclothymia"
      },
      {
        "id": 2,
        "text": "Dysthymia"
      },
      {
        "id": 3,
        "text": "Rapid cycling disorder"
      },
      {
        "id": 4,
        "text": "Bipolar disorder"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p class=\"p1\">The given image showing 4 episodes of depression and 2 episodes of mania <strong>within 1 year,</strong> points towards a diagnosis of <strong>rapid cycling bipolar disorder</strong>.&nbsp;</p>\n<p class=\"p1\">It is diagnosed when the patient has 4 or more episodes of depression and/or mania or hypomania within one&nbsp;year. There must be less than 2 weeks of normalcy between the episodes or an immediate shift between the symptoms with no intervening normal mood.</p>\n<p>Risk factors:</p>\n<ul>\n<li>Female patients</li>\n<li>Hypothyroidism</li>\n<li>Alcoholism or substance abuse</li>\n<li>Antidepressants (if used without mood stabilizers)</li>\n<li>Cyclothymia</li>\n<li>Bipolar II disorder</li>\n</ul>\n<p>The <strong>drug of choice</strong> for rapid cycling disorder is <strong>valproate.&nbsp;</strong></p>\n<p>Note:&nbsp;If the phases of mania and depression <strong>alternate</strong> very rapidly in a matter of<strong> hours or days </strong>then&nbsp;the condition is known as <strong>ultra-rapid cycling disorder</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/8adcadbe0fe74cc6a4dcd742ceb98a73.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The most common complication of the following procedure is_____",
    "choices": [
      {
        "id": 1,
        "text": "Proptosis"
      },
      {
        "id": 2,
        "text": "Subconjunctival hemorrhage"
      },
      {
        "id": 3,
        "text": "Optic nerve damage"
      },
      {
        "id": 4,
        "text": "Retrobulbar hemorrhage"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li>The image shown above is the <strong>technique of retrobulbar block </strong>which is a regional anesthesia technique used in ophthalmic surgery which involves the injection of a local anesthetic into the extraocular muscle cone. The needle penetrates the lower lid at the junction and middle third of the orbit.</li>\n<li><strong>Complications of retrobulbar block include:</strong>\n<ul>\n<li>Retrobulbar hemorrhage (most common complication)</li>\n<li>Subconjunctival hemorrhage</li>\n<li>Proptosis</li>\n<li>Perforation of the globe</li>\n<li>Optic nerve atrophy</li>\n<li>Oculocardiac reflex</li>\n<li>Accidental intravascular injection of the local anesthetic</li>\n<li>Trigeminal nerve block</li>\n<li>Respiratory arrest</li>\n<li>Acute neurogenic pulmonary edema (rarely)</li>\n</ul>\n</li>\n<li><strong>Contraindications of retrobulbar block:</strong>\n<ul>\n<li>Bleeding disorders(because of the risk of retrobulbar hemorrhage)</li>\n<li>High myopia (if the axial length is greater than 25 mm, then sclera would be thin which could increase the risk of globe perforation)</li>\n</ul>\n</li>\n<li></li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f7c3abe55493461c9120d0b1222b5f95.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is your diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Mongolian spot"
      },
      {
        "id": 2,
        "text": "Naevus of Ito"
      },
      {
        "id": 3,
        "text": "Congenital melanocytic naevus"
      },
      {
        "id": 4,
        "text": "Becker's naevus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given image shows <strong>Becker's naevus</strong>.</p>\n<p>It is an <strong>epidermal melanocytic naevus</strong> with aggregation of melanocyte clusters in the epidermis. It is often <strong>hairy.</strong> The onset is around<strong> adolescence</strong> when there is an <strong>increased sensitivity to androgens</strong> especially in the distribution of outer arms, scapular area and chest.</p>\n<p>A triad of features can be seen:</p>\n<ol>\n<li>Hyperpigmentation</li>\n<li>Hypertrichosis</li>\n<li>Acne</li>\n</ol>\n<p>Option A:&nbsp;<strong>Mongolian spots&nbsp;</strong>are slate blue areas in the lumbosacral region that spontaneously regress before puberty.</p>\n<p>Option B:&nbsp;<strong>Naevus of Ito&nbsp;</strong>is unilateral hyperpigmentation in the acromioclavicular distribution. It is not known to have hypertrichosis or acne.</p>\n<p>Option C:&nbsp;<strong>Congenital melanocytic nevi</strong>&nbsp;are common moles that become raised and have a cerebriform appearance and can be hairy. They can occur anywhere.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/de40faf6f64e4e90b7d12b164e5de1d4.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The clinical application of the effect shown below is -",
    "choices": [
      {
        "id": 1,
        "text": "Imaging for abdominal pathology"
      },
      {
        "id": 2,
        "text": "Radiotherapy for CNS malignancies"
      },
      {
        "id": 3,
        "text": "Imaging for CNS pathology"
      },
      {
        "id": 4,
        "text": "Both B and C"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>Bragg peak effect</strong> is pronounced for protons.&nbsp;Proton therapy therefore allows to <strong>target tumors</strong> inside the body, precisely <strong>localize the radiation dosage</strong> and <strong>spare the patient&rsquo;s healthy cells</strong>, offering a much less invasive alternative to treat cancer.</p>\n<p><strong>Protons and the Bragg peak effect:</strong></p>\n<p>The Bragg curve plots the energy loss of ionizing radiation during its travel through matter.</p>\n<p>The proton is a heavy and charged particle that gradually loses its speed as it interacts with human tissue. It is easily controlled and delivers its maximum dose at a precise depth and can go as far as 32 cm. The proton is very fast when it enters the patient&rsquo;s body and deposits only a small dose on its way. The absorbed dose increases very gradually with greater depth and lower speed, suddenly rising to a peak when the proton is ultimately stopped. This is known as the Bragg peak. The behavior of the proton can be precisely determined and the beam can be directed so the Bragg peak occurs exactly within the tumor site. Immediately after this burst of energy, the proton completely stops to irradiate and the particles come to rest.&nbsp;</p>\n<p>Proton therapy therefore allows to <strong>target tumors</strong> <strong>inside the body,</strong> <strong>precisely localize the radiation dosage</strong> and <strong>spare the patient&rsquo;s healthy cells</strong>, offering a much less invasive alternative to treat cancer.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e64a2553bff0433e802fdc4734d24070.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/62c4f6d692354217afdc5a9e9ef3ce48x1280x901.JPEG"
    ]
  }
];
        let quizName = 'Fmge Mini Test - 002 (Image-Based)';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2023"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>