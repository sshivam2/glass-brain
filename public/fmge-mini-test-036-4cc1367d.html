<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fmge Mini Test - 036 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / FMGE Mini Test Series / 2022
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">30</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "A newly married woman was prescribed MALA-N at a primary health center. What is its composition?",
    "choices": [
      {
        "id": 1,
        "text": "Levonorgestrel and ethinyl estradiol"
      },
      {
        "id": 2,
        "text": "Nordesterol and ethinyl estradiol"
      },
      {
        "id": 3,
        "text": "Desogestrel and ethinyl estradiol"
      },
      {
        "id": 4,
        "text": "Norgestimate and ethinyl estradiol"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Mala-N</strong> is a combined oral contraceptive containing 0.15 mg&nbsp;<strong>levonorgestrel </strong>(LNG)&nbsp;and 0.03 mg <strong>ethinyl estradiol</strong>.</p>\n<p>It&nbsp;is supplied free of cost through all primary health centers, urban family welfare centers, etc.</p>\n<p>Each strip of Mala-N contains 21 hormonal tablets and 7 nonhormonal tablets (iron tablets).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 44-year-old male patient presents with a history of chronic fatigue. He has no significant past medical or surgical history and he is on a strict vegan diet. His peripheral smear is as shown below. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "G6PD deficiency"
      },
      {
        "id": 2,
        "text": "Sickle cell anemia"
      },
      {
        "id": 3,
        "text": "Megaloblastic anemia"
      },
      {
        "id": 4,
        "text": "Thalessemia"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The scenario along with the image is highly suggestive of <strong>megaloblastic anemia</strong>. In the given image, the peripheral smear shows <strong>cabot rings</strong> and <strong>basophilic stippling</strong>.</p>\n<p>Megaloblastic anemia is a type of macrocytic anemia with impaired nucleic acid metabolism. Nuclear maturation lags behind cytoplasmic maturation. The causes include</p>\n<ul>\n<li>Vitamin B12 deficiency</li>\n<li>Folate deficiency</li>\n<li>Drugs (Methotrexate)</li>\n</ul>\n<p>In this stem, the likely cause is <strong>vitamin B12 deficiency</strong> as the patient is a strict vegan.&nbsp;Vitamin B12 or cobalamin is a water-soluble vitamin that is derived from animal products such as red meat, dairy, and eggs. Other causes of B12 deficiency includes</p>\n<ul>\n<li>Malabsorption (Pernicious anemia)</li>\n<li>Total or partial gastrectomy</li>\n<li>Ileal resection</li>\n<li>Tropical sprue</li>\n</ul>\n<div class=\"ng-star-inserted\">\n<div class=\"table-responsive font-weight-light answer-scroll ng-star-inserted\">\n<p>Clinical features of cyanocobalamin and folate deficiency (megaloblastic anemia) include:</p>\n<ul>\n<li>Anorexia, weight loss, diarrhea, or constipation</li>\n<li>Oral manifestations:&nbsp;<strong>g</strong><strong>lossitis,</strong>&nbsp;angular cheilosis</li>\n<li>Mild fever in more severely anemic patients</li>\n<li><strong>Jaundice (unconjugated)</strong></li>\n<li>Reversible melanin&nbsp;<strong>skin hyperpigmentation</strong></li>\n<li>Bruising (thrombocytopenia) and infections (low leucocyte count)</li>\n<li>Complications in pregnancy: recurrent fetal loss and neural tube defects</li>\n<li>Cardiovascular disease: cerebrovascular, peripheral vascular, and coronary heart disease with deep vein thrombosis</li>\n<li>Neurologic manifestations: Bilateral peripheral neuropathy or degeneration of the posterior and pyramidal tracts of the spinal cord&nbsp;<strong>(SACDSC)</strong>. Seen in only B12 deficiency.</li>\n<li>Psychiatric disturbances</li>\n</ul>\n<p>The peripheral smear shows <strong>oval macrocytes</strong>, <strong>anisocytosis</strong>, and <strong>hypersegmented neutrophils</strong> (more than 5 nuclear lobes).</p>\n<p>Other features of ineffective erythropoiesis seen in megaloblastic anemias include:</p>\n<ul>\n<li><strong>Howell-Jolly bodies</strong>:&nbsp;<strong>Nuclear remnants</strong>&nbsp;within red cells that are usually single, round, dark purple-red in color, and peripheral in location.</li>\n</ul>\n</div>\n</div>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/27647de7b3614175a12464ac1c2569ac.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/07c01774063e49ef8ad67a7010ec2cbdx277x273.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4b720e1265ef4dc2a8c928c72e27fba3x900x613.JPEG"
    ]
  },
  {
    "text": "Water lily sign is seen in infection due to _____",
    "choices": [
      {
        "id": 1,
        "text": "T. solium"
      },
      {
        "id": 2,
        "text": "T. saginata"
      },
      {
        "id": 3,
        "text": "H. nana"
      },
      {
        "id": 4,
        "text": "E. granulosus"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Water lily sign is seen in hydatid cyst, an infection due to&nbsp;<strong>Echinococcus granulosus.</strong></p>\n<p>Hydatid Cyst is a zoonotic infection caused by the&nbsp;<strong>Echinococcus species&nbsp;</strong>(dog tapeworm). Dogs are the definitive hosts of E. granulosus. Sheep are the usual intermediate hosts, but humans are accidental intermediate hosts. Humans are end-stage hosts of the parasite since there is <strong>no human-to-human transmission.</strong></p>\n<p>The clinical presentation of a<strong>&nbsp;hydatid cyst</strong>&nbsp;is mainly <strong>asymptomatic</strong>&nbsp;until complications occur. The&nbsp;most common presenting symp&shy;toms&nbsp;are&nbsp;<strong>abdominal pain,</strong>&nbsp;dyspepsia, and vomiting. The&nbsp;most frequent sign&nbsp;is&nbsp;<strong>hepatomegaly.</strong></p>\n<p>The&nbsp;<strong>water-lily sign</strong>&nbsp;is seen in hydatid infections when there is&nbsp;<strong>detachment of the endocyst membrane, resulting</strong>&nbsp;in&nbsp;<strong>floating membranes within the pericyst</strong>&nbsp;that mimic the appearance of a water lily, on&nbsp;<strong>USG.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f74794bf4873408d9318fd2626fb09bdx1280x817.PNG"
    ]
  },
  {
    "text": "A patient with severe persistent asthma continues to have symptoms despite being on high-dose ICS-LABA therapy. Which of the following is a leukotriene receptor antagonist, appropriate as an add-on therapy for this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Dupilumab"
      },
      {
        "id": 2,
        "text": "Roflumilast"
      },
      {
        "id": 3,
        "text": "Zafirlukast"
      },
      {
        "id": 4,
        "text": "Zileuton"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"text-align: left;\"><strong>Zafirlukast</strong> can be&nbsp;used as<strong>&nbsp;an add-on therapy</strong> in this patient.</p>\n<p style=\"text-align: left;\"><strong>Zafirlukast </strong>and montelukast are <strong>leukotriene receptor antagonists</strong>. They are competitive antagonists of the cysLT1 receptors. These drugs act by:&nbsp;</p>\n<ul>\n<li style=\"text-align: left;\">Decreasing bronchoconstriction</li>\n<li style=\"text-align: left;\">Reducing airway mucus secretion</li>\n<li style=\"text-align: left;\">Decreasing vascular permeability and</li>\n<li style=\"text-align: left;\">Reducing eosinophil chemotaxis&nbsp;</li>\n</ul>\n<p>Leukotriene modifiers are less effective than inhaled corticosteroids (ICS) in controlling asthma. They are used as<strong> add-on therapy</strong> in some patients whose asthma is not controlled with low doses of ICS.</p>\n<p style=\"text-align: left;\">Option A: Dupilumab is an <strong>interleukin-4 receptor antagonist</strong> used in severe asthma.&nbsp;</p>\n<p style=\"text-align: left;\">Option B: Roflumilast is a<strong> PDE-4 selective inhibitor</strong> used in the treatment of COPD.</p>\n<p style=\"text-align: left;\">Option D: Zileuton is a<strong> lipoxygenase inhibitor</strong> that can be used in the treatment of asthma.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following is an electrolyte abnormality that is not observed in CRF (chronic renal failure)?",
    "choices": [
      {
        "id": 1,
        "text": "Hypokalemia"
      },
      {
        "id": 2,
        "text": "Hyperkalemia"
      },
      {
        "id": 3,
        "text": "Hypocalcemia"
      },
      {
        "id": 4,
        "text": "Hyperphosphatemia"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Hypokalemia</strong> is not commonly seen in <strong>chronic renal failure</strong>.</p>\n<p>Electrolyte abnormalities in chronic renal failure are:</p>\n<ul>\n<li>Hypocalcemia</li>\n<li>Hyperphosphatemia</li>\n<li>Hyperkalemia</li>\n<li>Hyperuricemia</li>\n<li>Hypermagnesemia</li>\n</ul>\n<p>*Note : <br /><strong>Hyponatremia</strong> and <strong>hypokalemia</strong> although not commonly seen in CKD patients can occur occasionally. Hypokalemia is not common in CKD and usually reflects markedly\u00a0reduced dietary potassium intake, especially in association with excessive diuretic therapy or concurrent GI losses.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Among the given women, the best candidate for the role of accredited social health activist (ASHA) is a 25\u201345-year-old woman who is ______.",
    "choices": [
      {
        "id": 1,
        "text": "Unmarried with education up to the 10th standard"
      },
      {
        "id": 2,
        "text": "Married with education up to the 5th standard"
      },
      {
        "id": 3,
        "text": "Unmarried with education up to the 5th standard"
      },
      {
        "id": 4,
        "text": "A widow with education up to the 10th standard"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The correct answer is option D, woman who is a <strong>widow&nbsp;</strong>with education up to the&nbsp;<strong>10th standard</strong>.</p>\n<p>An ASHA is&nbsp;a trained female community health activist and&nbsp;a <strong>resident woman</strong> of the<strong> village </strong>with<strong>&nbsp;</strong>a <strong>formal education </strong>of at least up to<strong> 8th grade.&nbsp;</strong>She should preferably be in the age group of <strong>25 </strong>to<strong> 45 years (married/divorced/widow)&nbsp;</strong>and<strong>&nbsp;</strong>have qualities such as good communication skills and leadership skills. The general norm of selection recommends having<strong>&nbsp;one ASHA</strong> for<strong> 1000 population</strong>,&nbsp;but in tribal, hilly, and desert areas, the norm could be relaxed to one ASHA per habitation.</p>\n<div class=\"page\" title=\"Page 1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>&nbsp;Roles of ASHA:</p>\n</div>\n</div>\n</div>\n<div class=\"page\" title=\"Page 1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<ul>\n<li>To create<strong> awareness </strong>and provide<strong> information</strong> to the community on determinants of<strong> health </strong>such as nutrition, basic sanitation, and hygienic practices</li>\n<li>To <strong>counsel women</strong> on <strong>birth preparedness</strong>, the importance of <strong>safe delivery</strong>, <strong>breast-feeding</strong> and complementary feeding, immunization, and contraception</li>\n<li>To counsel women on the <strong>prevention </strong>of common infections including reproductive tract infection/<strong>sexually transmitted infection</strong>&nbsp;</li>\n<li>To mobilize the community and help them in <strong>accessing</strong> health and <strong>health-related services.</strong></li>\n<li>To arrange and <strong>escort pregnant women </strong>and <strong>children</strong> requiring treatment/admission to the nearest pre-identified health facility</li>\n<li>To <strong>inform&nbsp;sub-center/primary health center</strong>&nbsp;about the <strong>births</strong> and <strong>deaths</strong> in her village and any unusual <strong>health problems</strong>/<strong>disease</strong> <strong>outbreaks</strong> in the community</li>\n<li>To <strong>promote</strong> the construction of household toilets under the&nbsp;<strong>total sanitation campaign</strong></li>\n</ul>\n</div>\n</div>\n</div>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A middle-aged male patient was brought to the casualty following a road traffic accident. On examination, bluish discoloration was present over the left 9th and 10th rib area. On asking the patient to take a deep breath, he winced due to pain in the left shoulder region.  Identify the most likely sign elicited here.",
    "choices": [
      {
        "id": 1,
        "text": "Courvoisier's sign"
      },
      {
        "id": 2,
        "text": "Cullen's sign"
      },
      {
        "id": 3,
        "text": "Ballance 's sign"
      },
      {
        "id": 4,
        "text": "Kehr's sign"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given&nbsp;clinical vignette mentions pain over the&nbsp;<strong>left shoulder</strong> tip on inspiration. This is known as&nbsp;<strong>Kehr's sign</strong>, seen in&nbsp;<strong>splenic trauma. </strong></p>\n<p>Blunt trauma to the spleen results in <strong>torsion</strong> of <strong>short gastric</strong> vessels in the gastrosplenic ligament leading to <strong>subphrenic hematoma</strong>.&nbsp;The irritation at the<strong> left hemidiaphragm</strong> by subphrenic hematoma leads to positive Kehr's sign.</p>\n<p>The initial investigation for abdominal injury in patients who are hemodynamically unstable is&nbsp;<strong>FAST</strong> (focused assessment with sonography in trauma) to explore for free fluid.</p>\n<p>In all hemodynamically stable patients,<strong> CT is the investigation of choice</strong> for identifying and characterizing splenic injuries.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following drugs does not cause hyperpigmentation as an adverse effect?",
    "choices": [
      {
        "id": 1,
        "text": "Amiodarone"
      },
      {
        "id": 2,
        "text": "Chloroquine"
      },
      {
        "id": 3,
        "text": "Minocycline"
      },
      {
        "id": 4,
        "text": "Beta-blockers"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Beta-blockers&nbsp;do not cause hyperpigmentation.</p>\n<p><strong>Drugs causing hyper melanosis</strong>:</p>\n<ul>\n<li>Amiodarone</li>\n<li>Tetracyclines</li>\n<li>Chloroquine</li>\n<li>Clofazimine</li>\n<li>Phenytoin</li>\n<li>Cytotoxic drugs like busulfan, cyclophosphamide, bleomycin, etc.</li>\n<li>Psychotropic drugs (e.g., trifluoperazine, imipramine)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient with Crohn's disease has multiple skip lesions in the intestine. Surgical resection of damaged areas is being planned. Removal of which part will cause steatorrhoea?",
    "choices": [
      {
        "id": 1,
        "text": "Duodenum"
      },
      {
        "id": 2,
        "text": "Jejunum"
      },
      {
        "id": 3,
        "text": "Ileum"
      },
      {
        "id": 4,
        "text": "Caecum"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Ileal resection</strong> may lead to <strong>steatorrhoea</strong>.</p>\n<p>The ileum is the only site of <strong>absorption</strong> of <strong>vitamin B<sub>12</sub></strong> and <strong>bile salts</strong>.&nbsp;Following resection of the ileum, the loss of bile salts increases and is not met by an increase in synthesis. Depletion of the bile salt pool results in <strong>fat malabsorption</strong>&nbsp;that presents with steatorrhea.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/b5943d19b9074d70b9551d54fe3e3846x1200x1616.JPEG"
    ]
  },
  {
    "text": "A young male patient with hereditary hemochromatosis has been started on weekly phlebotomy. All of the following features will improve with this treatment except:",
    "choices": [
      {
        "id": 1,
        "text": "Hepatomegaly"
      },
      {
        "id": 2,
        "text": "Skin pigmentation"
      },
      {
        "id": 3,
        "text": "Cardiac failure"
      },
      {
        "id": 4,
        "text": "Arthropathy"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In hemochromatosis, removal of excess iron through phlebotomy has<strong> no effect </strong>on<strong> arthropathy </strong>and<strong> hypogonadism</strong>.</p>\n<p><strong>Hemochromatosis</strong>&nbsp;is an&nbsp;<strong>autosomal recessive</strong>&nbsp;disease caused due to mutation in the HFE gene on chromosome 6, leading to&nbsp;<strong>excessive iron absorption.&nbsp;&nbsp;</strong>Iron overload leads to the accumulation of iron in parenchymal organs such as the&nbsp;<strong>liver</strong> and <strong>pancreas&nbsp;</strong>followed by<strong>&nbsp;</strong>the<strong>&nbsp;</strong>heart, joints, and endocrine organs.&nbsp;</p>\n<p>The manifestations of classic hemochromatosis include <strong>hepatomegaly</strong>, abdominal pain, abnormal <strong>skin pigmentation</strong> mainly in sun-exposed areas, defective glucose homeostasis or <strong>diabetes mellitus</strong>, cardiac dysfunction (arrhythmias, cardiomyopathy), and <strong>atypical arthritis</strong>. The testes may be small and <strong>atrophic</strong> resulting in reduced gonadotropin and testosterone levels.</p>\n<p>It is managed by weekly or twice weekly<strong>&nbsp;phlebotomy</strong>&nbsp;of 500 mL. Chelating agents like subcutaneous deferoxamine, oral deferasirox are effective.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In the following flowchart representing the natural history of disease, the duration between points A to B is called?",
    "choices": [
      {
        "id": 1,
        "text": "Lead time"
      },
      {
        "id": 2,
        "text": "Screening time"
      },
      {
        "id": 3,
        "text": "Generation time"
      },
      {
        "id": 4,
        "text": "Lag time"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The period between the first possible time of detection (point A) and the final critical point of diagnosis (point B) is&nbsp;called <strong>Screening&nbsp;time.</strong></p>\n<p><strong>Screening</strong>&nbsp;is the search for unrecognized diseases or defects in apparently healthy individuals by means of&nbsp;<strong>rapidly applicable</strong>&nbsp;tests or procedures. It must be done in conditions where there is a considerable&nbsp;<strong>time lag</strong>&nbsp;between the&nbsp;<strong>onset</strong>&nbsp;of the disease and the&nbsp;<strong>usual time</strong>&nbsp;of diagnosis (point C in the image).</p>\n<p>This ensures the success of any treatment in<strong>&nbsp;reversing</strong>&nbsp;the disease process.&nbsp;The&nbsp;<strong>final critical point</strong>&nbsp;(point B in the image) is the stage beyond which treatment would be&nbsp;<strong>unsuccessful</strong>&nbsp;or there would be&nbsp;<strong>permanent damage</strong>.</p>\n<p>The period between the first possible time of detection (point A) and the usual time of diagnosis (point C) is&nbsp;called <strong>lead time.</strong></p>\n<p><strong>Generation time</strong>&nbsp;is defined as the interval of time between the&nbsp;<strong>onset</strong>&nbsp;of infection by a host and the&nbsp;<strong>maximal infectivity</strong>&nbsp;of that host.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/f467c9949bbb4c54ad6e7e409473794b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ad179d8f1b6141cc891755f350b78ca9x1280x1020.JPEG"
    ]
  },
  {
    "text": "An elderly patient in the gynecology ward was diagnosed with urge incontinence. What is the etiology of this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Pelvic mass in pouch of Doughlas"
      },
      {
        "id": 2,
        "text": "Prolapse of anterior vaginal wall"
      },
      {
        "id": 3,
        "text": "Detrusor instability"
      },
      {
        "id": 4,
        "text": "Retroverted gravid uterus"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>A patient who suffers from <strong>urge incontinence suffers from detrusor instability</strong>.</p>\n<p>The patient experiences an <strong>involuntary escape of urine</strong> with an <strong>urge to urinate</strong>. It occurs due to <strong>detrusor muscle overactivity</strong> or <strong>detrusor instability</strong>. It is seen more commonly in old women with decreased bladder capacity, decreased sensation, and central nervous system (CNS) inhibition.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40-year-old woman presents with bilateral adnexal masses and ascites. Histopathological examination of the resected specimen shows sheets of mucin-producing signet-ring cells. The most likely diagnosis is:",
    "choices": [
      {
        "id": 1,
        "text": "Serous papillary carcinoma"
      },
      {
        "id": 2,
        "text": "Benign cystic teratoma"
      },
      {
        "id": 3,
        "text": "Krukenberg tumour"
      },
      {
        "id": 4,
        "text": "Dysgerminoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The most likely diagnosis with the above clinical interpretation is metastatic<strong> signet-ring</strong> carcinoma called <strong>Krukenberg tumor</strong>.</p>\n<p>Krukenberg tumor is a <strong>metastatic ovarian malignancy</strong> with the primary site is in the gastrointestinal tract or breast. It is often bilateral. Primary sites include the stomach (70%); carcinoma of the colon, appendix, and breast (mainly invasive lobular carcinoma). Numerous&nbsp;<strong>signet-ring cells</strong>&nbsp;are seen in the Krukenberg tumor. Signet ring cells are <strong>mucin-producing cells</strong> with the appearance of a signet ring often originating from the gastric mucosa.</p>\n<p>The image below shows&nbsp;<strong>signet-ring cells</strong>&nbsp;in the Kruckenberg tumor.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7e605fa5c72a4714b327f30427143619x1280x1161.JPEG"
    ]
  },
  {
    "text": "Active transport is mediated by which one of the following enzymes?",
    "choices": [
      {
        "id": 1,
        "text": "G-Protein"
      },
      {
        "id": 2,
        "text": "Na+-K+ ATPase"
      },
      {
        "id": 3,
        "text": "Carrier protein"
      },
      {
        "id": 4,
        "text": "Channel protein"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>In active transport, the energy is provided almost exclusively by the <strong>hydrolysis of ATP</strong>. Hence active transport is mediated by <strong>ATPases</strong> (eg. <strong>Na+-K+-ATPase</strong>), enzymes that catalyze the hydrolysis of ATP.</p>\n<table style=\"width: 319px;\">\n<tbody>\n<tr>\n<td style=\"width: 166px;\">PRIMARY ACTIVE TRANSPORT</td>\n<td style=\"width: 155px;\">SECONDARY ACTIVE TRANSPORT</td>\n</tr>\n<tr>\n<td style=\"width: 166px;\">Requires <strong>direct input of metabolic energy </strong>in the form of adenosine triphosphate <strong>(ATP) </strong>&nbsp;</td>\n<td style=\"width: 155px;\">The transport of two or more solutes is coupled and metabolic energy is provided&nbsp; <strong>indirectly</strong> from the Na<sup>+</sup> gradient that is maintained across cell membranes by Na<sup>+</sup>-K<sup>+</sup>-ATPase pump</td>\n</tr>\n<tr>\n<td style=\"width: 166px;\">\n<p>a) Na<sup>+</sup>-K<sup>+</sup>-ATPase or sodium potassium pump</p>\n<p>b) Ca<sup>2+</sup> -ATPase</p>\n<p>c) H<sup>+</sup>-ATPase or proton pump d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; H<sup>+</sup>-K<sup>+</sup>-ATPase</p>\n</td>\n<td style=\"width: 155px;\">\n<p>a) Na<sup>+</sup>- glucose cotransport (SGLT)</p>\n<p>b) Na<sup>+</sup>-Ca<sup>2+</sup> counter transport</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The device shown in the image given below is used in.",
    "choices": [
      {
        "id": 1,
        "text": "Tele therapy"
      },
      {
        "id": 2,
        "text": "Brachytherapy"
      },
      {
        "id": 3,
        "text": "Radioactive iodine therapy"
      },
      {
        "id": 4,
        "text": "Targeted therapy"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The device shown in the image is a<strong> remote afterloader</strong>. Remote afterloading is related to <strong>brachytherapy</strong>.</p>\n<p><strong>Brachytherapy</strong> is a method of treatment in which sealed radioactive sources are used to deliver <strong>radiation</strong> at a <strong>short distance</strong> by interstitial, intracavitary, or surface application.</p>\n<p>The following isotopes are used in brachytherapy:</p>\n<ul>\n<li><strong>I-125</strong> and<strong>&nbsp;</strong><strong>Iridium-192 -&nbsp;</strong>used in low dose rate (LDR) brachytherapy.&nbsp;</li>\n<li><strong>Cobalt-60</strong> - is used for high dose rate (HDR) brachytherapy.</li>\n</ul>\n<p>Afterloading is the process of placing the radioactive material into the target region. This is either done manually by the oncologist, or by using remote afterloading devices.</p>\n<p><strong>Remote afterloading</strong> devices enable us to<strong> eliminate direct contact</strong> with <strong>radioactive</strong> sources while administration. It provides protection from radiation exposure to healthcare professionals by securing the radiation source in a <strong>shielded safe manner</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6b3562d31f734145bf466fdba0bbc03c.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "While assessing the Apgar score of newborns, you would assess and score all of the following except:",
    "choices": [
      {
        "id": 1,
        "text": "Color"
      },
      {
        "id": 2,
        "text": "Heart rate"
      },
      {
        "id": 3,
        "text": "Respiratory rate"
      },
      {
        "id": 4,
        "text": "Muscle tone"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Respiratory effort, </strong>not<strong> rate</strong> is&nbsp;a component of the Apgar score.</p>\n<p>The Apgar score is an <strong>objective</strong> method of evaluating the <strong>newborn's condition</strong> using the 5 parameters explained below. It is performed at <strong>1 minute</strong> and <strong>5 minutes</strong> after birth. The components of the Apgar score are:</p>\n<ul>\n<li>Color (A, appearance)</li>\n<li>Heart rate (P, pulse)</li>\n<li>Response to a&nbsp;catheter in nostril (G, grimace)</li>\n<li>Muscle tone (A, activity)</li>\n<li>Respiratory effort&nbsp;(R)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young man was rushed to the casualty with multiple rib fractures. On examination, you notice a paradoxical movement of the chest, and the patient is diagnosed with respiratory failure. How would you manage him?",
    "choices": [
      {
        "id": 1,
        "text": "Chest tube drainage"
      },
      {
        "id": 2,
        "text": "Oxygen administration"
      },
      {
        "id": 3,
        "text": "Intermittent positive pressure ventilation"
      },
      {
        "id": 4,
        "text": "Internal operative fixation of the fractures segments"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given scenario is suggestive of <strong>flail chest with respiratory failure.</strong> Management of this condition is&nbsp;<strong>IPPV&nbsp;</strong>(intermittent positive pressure ventilation).</p>\n<p>A flail chest occurs when a segment of the chest wall does not have bony continuity with the rest of the thoracic cage.&nbsp;This condition results from blunt trauma associated with multiple rib fractures i.e.,&nbsp;<strong>2 adjacent ribs or</strong>&nbsp;<strong>3&nbsp;or more ribs fractured in two or more places</strong>.&nbsp;</p>\n<p>The blunt force required to disrupt the integrity of the thoracic cage typically produces an underlying<strong> pulmonary contusion </strong>as well.</p>\n<p>On<strong> inspiration,&nbsp;</strong>the <strong>loose segment </strong>of the chest wall is <strong>displaced inwards,&nbsp;</strong>and therefore, less air moves into the lungs. On <strong>expiration,</strong> the segment moves <strong>outwards</strong>. This is known as&nbsp;<strong>paradoxical respiration</strong>.</p>\n<p>The <strong>diagnosis</strong> is made&nbsp;<strong>clinically</strong>, not by radiography. To confirm, the paradoxical motion of a chest wall segment can be observed for several respiratory cycles and during coughing.</p>\n<p>Voluntary splinting as a result of pain, mechanically impaired chest wall movement, and the associated lung contusion are all causes of hypoxia and respiratory failure.&nbsp;The patient is also at high risk of developing a <strong>pneumothorax </strong>or <strong>hemothorax.</strong></p>\n<p>Treatment:</p>\n<ul>\n<li><strong>Chest strapping </strong>or splinting should be<strong> avoided.</strong></li>\n<li>Currently, treatment consists of <strong>oxygen administration</strong>, adequate<strong> analgesia </strong>(including opiates) or <strong>epidural</strong> analgesia,<strong>&nbsp;</strong>and <strong>physiotherapy.</strong></li>\n<li><strong>IPPV</strong> (Intermittent Positive Pressure Ventilation) is reserved for patients developing <strong>respiratory failure</strong> despite adequate analgesia and oxygen.</li>\n</ul>\n<p>Treatment algorithm of treatment of flail chest with respiratory failure:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/eb06c37ba5c841a889511b6eca3a0459x1280x1736.JPEG"
    ]
  },
  {
    "text": "Identify the structure marked as 'A' in the CT scan shown below:",
    "choices": [
      {
        "id": 1,
        "text": "Descending aorta"
      },
      {
        "id": 2,
        "text": "Ascending aorta"
      },
      {
        "id": 3,
        "text": "Superior vena cava"
      },
      {
        "id": 4,
        "text": "Right pulmonary artery"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The structure marked as 'A' in the CT thorax is the <strong>superior vena cava</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4b257029ccbe471c9b87ce6e5415832d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1274ffeca49b4fd89e7d0afb70831733x1280x1185.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/83cd5d2f7efe4c079c0e5b047d1932d4x1280x1185.JPEG"
    ]
  },
  {
    "text": "A 12-year-old boy presents with a gradually progressing swelling and pain for 6 months over the upper tibia. His radiographic image is shown below. The most likely diagnosis is:",
    "choices": [
      {
        "id": 1,
        "text": "Osteosarcoma"
      },
      {
        "id": 2,
        "text": "Osteoclastoma"
      },
      {
        "id": 3,
        "text": "Brodie's abscess"
      },
      {
        "id": 4,
        "text": "Ewing's sarcoma"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The given clinical scenario and the radiographic image findings are most suggestive of<strong> Brodie's abscess.</strong></p>\n<p>A Brodie abscess is a localized subacute osteomyelitis that occurs in the long bones of lower extremities in young patients.<strong>&nbsp;</strong></p>\n<p>All of the given conditions may present with a history of swelling and pain. However, the differentiating features of each of the given conditions are as follows:</p>\n<table style=\"height: 89px; width: 590px;\">\n<tbody>\n<tr>\n<td style=\"width: 96px;\"><strong>Condition</strong></td>\n<td style=\"width: 127px;\"><strong>Age group</strong></td>\n<td style=\"width: 234px;\"><strong>Radiographic findings</strong></td>\n</tr>\n<tr>\n<td style=\"width: 96px;\"><strong>Brodie's abscess</strong></td>\n<td style=\"width: 127px;\">\n<p>Children, adolescents</p>\n</td>\n<td style=\"width: 234px;\">Lytic lesion with dense sclerotic rim, minimal periosteal reaction</td>\n</tr>\n<tr>\n<td style=\"width: 96px;\"><strong>Osteosarcoma</strong></td>\n<td style=\"width: 127px;\">Children, adolescents and seventh decade</td>\n<td style=\"width: 234px;\">Periosteal reaction leading to sunray appearance and Codman triangle</td>\n</tr>\n<tr>\n<td style=\"width: 96px;\"><strong>Osteoclastoma</strong></td>\n<td style=\"width: 127px;\">20-40 years</td>\n<td style=\"width: 234px;\">Lytic lesion with thin sclerotic rim, minimal periosteal reaction</td>\n</tr>\n<tr>\n<td style=\"width: 96px;\"><strong>Ewing's sarcoma</strong></td>\n<td style=\"width: 127px;\">10-20 years</td>\n<td style=\"width: 234px;\">Periosteal reaction leading to onion peel appearance</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/6363f240433b487e8734fafba76097f9.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A 28-year-old man is brought to the emergency after being trapped in a landslide for 3-4 hours. He has multiple rib fractures, pneumothorax, hemothorax, and lab findings of elevated creatinine, creatine phosphokinase, hyperkalemia, metabolic acidosis, and hypocalcemia. What is the most likely diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Fat embolism"
      },
      {
        "id": 2,
        "text": "Crush syndrome"
      },
      {
        "id": 3,
        "text": "Hemorrhagic shock"
      },
      {
        "id": 4,
        "text": "Acute compartment syndrome"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The history of prolonged entrapment, clinical features, and laboratory findings are all suggestive of <strong>crush syndrome.</strong>\u00a0</p>\n<p>Crush syndrome can result when a <strong>limb is compressed</strong> for a prolonged period (e.g. getting crushed or entrapped in a vehicle or machinery) and after extended use of a <strong>pneumatic antishock garment</strong>. This results in hypoperfusion and <strong>myonecrosis</strong> in the crushed limb. When the limb is released from the compression, toxic metabolites get released to cause reperfusion injury.\u00a0</p>\n<p>Crush syndrome can result in a <strong>systemic reaction</strong> due to tissue necrosis. Free myoglobin can lead to <strong>acute tubular necrosis</strong> and <strong>renal failure</strong>. Myonecrosis can lead to <strong>metabolic acidosis</strong> with <strong>hyperkalemia</strong> and <strong>hypocalcemia</strong>. The procoagulants that escaped into the systemic circulation can produce <strong>systemic coagulopathy</strong>.\u00a0</p>\n<p>Clinical features:</p>\n<ul>\n<li>The affected limb is pulseless, red, and swollen</li>\n<li>In some cases, sensation and muscle power may be lost.</li>\n</ul>\n<p><strong>Management of crush syndrome</strong></p>\n<ul>\n<li>Encouraging high urine flow, along with alkalization of urine with sodium bicarbonate to prevent precipitation of myoglobin in the renal tubules.</li>\n<li>Renal hemofiltration if there is oliguria or renal failure.</li>\n<li>If compartment syndrome is confirmed, then fasciotomy is performed.</li>\n<li>Radical excision of necrosed muscle to avoid sepsis.</li>\n<li>Aggressive management of the open wound.</li>\n</ul>\n<p>Other options:</p>\n<p>Option A: <strong>Fat embolism</strong>\u00a0is the presence of fat globules in vital organs and peripheral circulation after a fracture of the long bone or other major trauma. It is usually seen 2-3 days following the injury. Clinical features include tachycardia, rise in temperature, breathlessness, and mild mental confusion.<strong>\u00a0</strong></p>\n<p>Option C: <strong>Hemorrhagic shock</strong> is the most common cause of shock in surgical or trauma patients. Here the patient presents with agitation, <strong>cold clammy extremities, hypotension, tachycardia, and weak peripheral pulses</strong>. Acidosis and elevated lactate levels may be seen due to hypoperfusion of tissues.</p>\n<p>Option D:<strong>\u00a0Acute compartment syndrome</strong>\u00a0refers to an elevation of the intracompartmental pressure (ICP) which increases the risk for tissue ischemia and necrosis. It can occur following fractures(commonly) or soft tissue injuries and is a<strong> localized condition involving the affected limb</strong>. The clinical features include <strong>pain, paraesthesia, pallor, paralysis, and pulselessness</strong>. The diagnosis is confirmed by measuring the intracompartmental pressures.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child hailing from China has been diagnosed with Keshan disease. The child is most likely suffering from deficiency of which of the following?",
    "choices": [
      {
        "id": 1,
        "text": "Thiamine"
      },
      {
        "id": 2,
        "text": "Selenium"
      },
      {
        "id": 3,
        "text": "Zinc"
      },
      {
        "id": 4,
        "text": "Copper"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Keshan disease</strong>&nbsp;is due to a&nbsp;deficiency of<strong> selenium</strong>.</p>\n<p>Selenium is an important trace element which is a part of the 21st amino acid <strong>Selenocysteine</strong>. There are many selenium-containing enzymes such as :</p>\n<ul>\n<li>Glutathione peroxidase</li>\n<li>De-iodinase</li>\n<li>Thioredoxin reductase</li>\n</ul>\n<p>Selenium is also an <strong>intracellular antioxidant</strong> which complements the role of Vitamin E. Dietary sources of selenium include seafood, muscle meat, and&nbsp;some cereals.</p>\n<p><strong>Keshan disease</strong>&nbsp;is&nbsp;<strong>endemic cardiomyopathy</strong>&nbsp;found in children and young women residing in regions of&nbsp;China&nbsp;where&nbsp;dietary intake of<strong> selenium is low</strong>. Mainly&nbsp;<strong>dilated cardiomyopathy</strong>&nbsp;is the characteristic feature, but it may also result in congestive cardiac failure, cardiomegaly, and fulminant cardiogenic shock. It is associated with&nbsp;<strong>tumorigenesis&nbsp;</strong>(increased risk of progression to metaplasia)&nbsp;and&nbsp;<strong>atherosclerosis</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Under McNaughten's rule, which of the following criteria is not valid to clear a mentally unsound person of all responsibility?",
    "choices": [
      {
        "id": 1,
        "text": "Evidence of psychiatric illness"
      },
      {
        "id": 2,
        "text": "Presence of uncontrollable impulse"
      },
      {
        "id": 3,
        "text": "Psychiatric illness while committing the crime"
      },
      {
        "id": 4,
        "text": "Inability to understand that the act is wrong"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The criterion of the\u00a0<strong>presence of uncontrollable impulse\u00a0</strong>is <strong>not</strong> included in <strong>McNaughten's rule</strong>. Therefore, it is not a valid criterion to clear a mentally unsound person of all criminal responsibility.</p>\n<p><strong>McNaughten's rule</strong> is followed by the British Courts of law to examine the liability of a mentally unsound person who has committed a crime.\u00a0<strong>Sec. 84 IPC (BNS Section 22) </strong>is the Indian adaptation of this rule.\u00a0</p>\n<p>McNaughten's rule forms the basis of the\u00a0<strong>legal test of insanity/the 'right or wrong' test.\u00a0</strong>It states that a mentally unsound person is cleared of all criminal responsibility for the crime committed if the following criteria are met:</p>\n<ul>\n<li>Presence of evidence of psychiatric illness.</li>\n<li>Existence of psychiatric illness at the time of the commission of the crime.</li>\n<li>Psychiatric illness is of such a degree that the person does not have the ability to understand the wrongness of the act, i.e., impaired intellectual ability.\u00a0</li>\n</ul>\n<p>McNaughten's rule decides a person's soundness of mind based on the presence or absence of intellectual ability. However, it fails to consider any impairments in the person's emotional state or the presence of any <strong>uncontrollable/ irresistible impulses\u00a0</strong>while committing the act.\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A young male patient who had witnessed a terrorist attack has been experiencing frequent intrusive flashbacks and nightmares about the incident. He avoids the places that remind him of it.  He is significantly distressed, has difficulty falling asleep, and frequently feels anxious for the last 6 months. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Adjustment disorder"
      },
      {
        "id": 2,
        "text": "Acute stress disorder"
      },
      {
        "id": 3,
        "text": "Persistent complex bereavement"
      },
      {
        "id": 4,
        "text": "Post traumatic stress disorder"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The given clinical scenario with re-experiences (flashbacks and nightmares), avoidance of the stimuli associated with the attacks, and hyperarousal (impaired sleep and anxiety) for <strong>more than one month</strong> are suggestive of <strong>post-traumatic stress disorder (PTSD).</strong></p>\n<p>PTSD is a psychiatric disorder characterized by increased stress and anxiety occurring after a stressful or traumatic event e.g., witnessing or being involved in violent accidents, crime, war, assault, kidnapping, natural disaster, life-threatening illness, physical or sexual abuse.&nbsp;</p>\n<div class=\"page\" title=\"Page 3312\">\n<div class=\"section\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>The <strong>predisposing factors</strong> for this condition include:</p>\n<ul>\n<li>Presence of childhood trauma</li>\n<li>Borderline, paranoid, dependent, or antisocial personality disorder traits</li>\n<li>Inadequate family or peer support system</li>\n<li>Female gender</li>\n<li>Genetic susceptibility to psychiatric illness</li>\n<li>Recent stressful life changes</li>\n<li>Recent excessive intake of alcohol</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<p>Symptoms of PTSD can be divided into four types:</p>\n<ul>\n<li><strong>Intrusion symptoms</strong></li>\n<li><strong>Hyperarousal</strong>&nbsp;</li>\n<li><strong>Avoidance symptoms: </strong>&nbsp;</li>\n<li><strong>Negative&nbsp;cognitions</strong> and mood associated with the traumatic event</li>\n</ul>\n<p>The <strong>duration</strong> of these symptoms should be<strong> &gt; 1 month</strong> to label it as PTSD.</p>\n<p>Psychotherapies found to be effective for PTSD include exposure therapy, trauma-focused cognitive-behavioral therapy, eye movement desensitization, and abreaction. SSRIs may be prescribed as first-line treatment.</p>\n<p>Other options:</p>\n<p>Option A: <strong>Adjustment disorder</strong> is an emotional response to stressful situations like financial issues, medical illnesses, or relation&shy;ship problems that develop <strong>within 3 months</strong> of the stressor. The stressor in adjustment disorder <strong>can be of any severity</strong>. In adjustment disorder, the individual does not experience intrusive symptoms like flashbacks and nightmares, hyperarousal symptoms, and avoidance symptoms.</p>\n<p>Option B: <strong>Acute stress disorder</strong> presents with the same symptoms as PTSD, but the symptoms usually occur immediately after the trauma and persist for a period of <strong>3</strong> <strong>days to upto 1 month</strong> after the trauma.</p>\n<p>Option C: <strong>Persistent complex bereavement disorder</strong> occurs after the death of a loved one. Since the death, for <strong>12 months or more</strong>, the individual may experience&nbsp;persistent yearning/longing for the deceased, intense sorrow, and emotional pain, preoccupation with the deceased, and&nbsp;the circumstances of the death.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Waldeyer\u2019s group of lymph nodes do not include",
    "choices": [
      {
        "id": 1,
        "text": "Tonsils"
      },
      {
        "id": 2,
        "text": "Submandibular lymph node"
      },
      {
        "id": 3,
        "text": "Lingual tonsils"
      },
      {
        "id": 4,
        "text": "Adenoids"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The submandibular group of lymph nodes is not included as a part of Waldeyer&rsquo;s ring.</p>\n<p>Scattered throughout the pharynx in its subepithelial layer is the lymphoid tissue which is aggregated at places to form masses, collectively called&nbsp;<strong>Waldeyer&rsquo;s ring</strong>.</p>\n<p>The masses are:</p>\n<ul>\n<li>Nasopharyngeal tonsil or the <strong>adenoids</strong></li>\n<li>Palatine tonsils or simply the <strong>tonsils</strong></li>\n<li><strong>Lingual tonsil</strong></li>\n<li>Tubal tonsils (in fossa of Rosenm&uuml;ller)</li>\n<li><strong>Lateral pharyngeal bands </strong></li>\n<li><strong>Nodules</strong> (in posterior pharyngeal wall)</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a56954bd132f4b6ca7235558b1fe7b06x1280x1254.JPEG"
    ]
  },
  {
    "text": "Which of the following is defined as loss of eyelashes?",
    "choices": [
      {
        "id": 1,
        "text": "Tylosis"
      },
      {
        "id": 2,
        "text": "Madarosis"
      },
      {
        "id": 3,
        "text": "Trichiasis"
      },
      {
        "id": 4,
        "text": "Distichiasis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Madarosis</strong> is the&nbsp;<strong>loss</strong> of <strong>eyelashes or eyebrows</strong>.</p>\n<ul>\n<li>Loss of <strong>eyebrows</strong> is seen in <strong>leprosy</strong> and <strong>myxedema</strong>.</li>\n<li>Loss of <strong>eyelashes</strong> is seen in <strong>chronic</strong> <strong>blepharitis.</strong></li>\n</ul>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d3c939b4b4e34b1aadee507efae30595x462x350.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c45b5e6ff8b94be8ab2ffb19a05a6315x483x572.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4e98883c42c44cdd92dabb3ce9d76c28x462x386.PNG"
    ]
  },
  {
    "text": "A specimen of the posterior surface of the larynx is kept in an anatomy practical exam and a structure is marked with red. What would be the action of the structure?",
    "choices": [
      {
        "id": 1,
        "text": "Adducts the vocal cords"
      },
      {
        "id": 2,
        "text": "Abducts the vocal cords"
      },
      {
        "id": 3,
        "text": "Tenses the vocal cords"
      },
      {
        "id": 4,
        "text": "Relaxes the vocal cords"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The above image shows the posterior view of the larynx and the marked muscle is&nbsp;the <strong>posterior cricoarytenoid</strong>.&nbsp;Its action is to <strong>abduct the vocal cords</strong> and <strong>open</strong> the glottis. The <strong>posterior cricoarytenoid muscle </strong>is identified by<strong>&nbsp;</strong>its origin from the <strong>posterior surface</strong> of the cricoid<strong>.</strong>&nbsp;</p>\n<p>The posterior cricoarytenoid muscle <strong>arises </strong>from the <strong>posterior surface of the cricoid lamina</strong> and is attached to the upper and posterior surfaces of the muscular processes of the ipsilateral arytenoids. It is innervated by a branch of the<strong> recurrent laryngeal nerve</strong>. They are <strong>active </strong>in the production of <strong>unvoiced sounds.</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/85574121651c472989c1bf0ea1fc3d29.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/648d8cf164504713b8fb9a45b04b96b1x800x600.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/887d5473925944c8b2515b313b2a572cx363x500.PNG"
    ]
  },
  {
    "text": "An air conditioner technician presents with diarrhea, high fever, chest pain, and dyspnea. Chest radiograph showed pleural effusion and patchy pulmonary infiltrates. What is the drug of choice for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Penicillin"
      },
      {
        "id": 2,
        "text": "Azithromycin"
      },
      {
        "id": 3,
        "text": "Streptomycin"
      },
      {
        "id": 4,
        "text": "Aztreonam"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The given clinical scenario and the image showing the presence of <strong>gram-negative bacilli&nbsp;</strong>point toward the diagnosis of <strong>legionnaire's disease.</strong>&nbsp;<strong>Macrolides</strong>&nbsp;such as <strong>Azithromycin</strong>&nbsp;is the drug of choice for this condition.</p>\n<p class=\"p1\">Legionnaire&rsquo;s disease&nbsp;is caused by&nbsp;<em><strong>Legionella pneumophila. </strong></em>They are found in lakes, streams, and other water bodies. Infection is mostly <strong>spread</strong> by <strong>inhalation</strong> of the bacteria from <strong>aerosols</strong> produced by <strong>contaminated air conditioners,</strong> humidifiers, nebulizers, etc.</p>\n<p>It is mostly <strong>asymptomatic</strong> under the age of <strong>55 years</strong>. Infection is usually severe in <strong>immunocompromised patients</strong>. It may present as a severe, rapidly progressive disease with <strong>high fever, chills, hypoxia, diarrhea,</strong> and <strong>delirium</strong>. On chest x-ray, <strong>patchy</strong>, often <strong>multilobar consolidation</strong> is seen. <strong>Pleural effusion</strong> may also occur.&nbsp;</p>\n<p>A milder form of a clinical syndrome known as <strong>P</strong><strong>ontiac fever,&nbsp;</strong>which is usually <strong>self-limiting</strong> and only has mild symptoms of fever, myalgia, and headache.</p>\n<p>Microscopy of the sputum samples shows numerous leucocytes without any organism. Gram staining of the sterile sites like pleural fluid and lung tissues show faint gram-negative bacilli. They require a counterstain of <strong>basic fuschin</strong> as <strong>safranin</strong> stains the bacteria very poorly. They are a group of <strong>fastidious</strong>, <strong>aerobic gram-negative</strong> bacteria. They can be grown on a <strong>buffered charcoal yeast extract (BCYE) agar</strong>.</p>\n<p>Diagnosis is established with the help of <strong>direct fluorescent antibody tests</strong> and <strong>BCYE culture specimens</strong>. Urine antigen tests and molecular assays may also be used.</p>\n<p>The below image shows the&nbsp;Direct Fluorescent Antibody Test.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/42499ea21b4548eaa2d90349c3ab1a9dx700x491.JPEG"
    ]
  },
  {
    "text": "Given below is the procedure done under  'Nalgonda technique'. What is the purpose of this technique?",
    "choices": [
      {
        "id": 1,
        "text": "Controlled super-chlorination of water"
      },
      {
        "id": 2,
        "text": "Defluoridation of water"
      },
      {
        "id": 3,
        "text": "Steeping pulses in hot water for toxin removal"
      },
      {
        "id": 4,
        "text": "Air floatation of grains to remove ergot"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong><span data-preserver-spaces=\"true\">Nalgonda</span></strong><span data-preserver-spaces=\"true\">&nbsp;technique is used for&nbsp;</span><strong><span data-preserver-spaces=\"true\">defluoridation of water</span></strong><span data-preserver-spaces=\"true\">&nbsp;which involves the addition of&nbsp;</span><strong><span data-preserver-spaces=\"true\">lime</span></strong><span data-preserver-spaces=\"true\">&nbsp;and&nbsp;</span><strong><span data-preserver-spaces=\"true\">alum</span></strong><span data-preserver-spaces=\"true\">&nbsp;followed by&nbsp;</span>flocculation, sedimentation,&nbsp;and&nbsp;filtration.</p>\n<p><strong><span data-preserver-spaces=\"true\">Fluorosis</span></strong><span data-preserver-spaces=\"true\">&nbsp;occurs when&nbsp;</span>drinking water&nbsp;contains&nbsp;excess&nbsp;amounts of&nbsp;fluorine,<span data-preserver-spaces=\"true\">&nbsp;in the range of&nbsp;</span><strong><span data-preserver-spaces=\"true\">3-5mg/L.</span></strong><span data-preserver-spaces=\"true\">&nbsp;It is&nbsp;</span>endemic<span data-preserver-spaces=\"true\">&nbsp;in parts of India- Andhra Pradesh (Nellore, Prakasam), Telangana(Nalgonda), Punjab, Haryana, Karnataka, Kerala, Tamil Nadu.&nbsp;</span></p>\n<p>Symptoms correspond to levels of fluoride intake:</p>\n<ul>\n<li><strong><span data-preserver-spaces=\"true\">Dental</span></strong><span data-preserver-spaces=\"true\">&nbsp;<strong>fluorosis:&nbsp;(</strong></span><strong>1<span data-preserver-spaces=\"true\">.5mg/L)</span></strong></li>\n<li><strong><span data-preserver-spaces=\"true\">Skeletal</span>&nbsp;fluorosis: (<span data-preserver-spaces=\"true\">3-6mg/L)&nbsp;</span></strong></li>\n<li><strong><span data-preserver-spaces=\"true\">Crippling</span></strong><span data-preserver-spaces=\"true\"><strong>&nbsp;fluorosis:</strong>&nbsp;(</span><strong><span data-preserver-spaces=\"true\">&gt;10mg/L)</span></strong></li>\n</ul>\n<p><strong><span data-preserver-spaces=\"true\">Genu valgum</span></strong><span data-preserver-spaces=\"true\">&nbsp;and&nbsp;</span>osteoporosis&nbsp;of the&nbsp;lower limb<span data-preserver-spaces=\"true\">&nbsp;are seen in a newer form of fluorosis in Tamil Nadu and Andhra Pradesh. It is seen in people consuming</span><strong><span data-preserver-spaces=\"true\">&nbsp;jawar (sorghum)</span></strong><span data-preserver-spaces=\"true\">, as it promotes&nbsp;</span>greater retention<span data-preserver-spaces=\"true\">&nbsp;of ingested fluoride.</span></p>\n<p><span data-preserver-spaces=\"true\">The given images show <strong>dental fluorosis</strong> and <strong>skeletal fluorosis</strong> (interosseous-membrane-calcification), respectively:</span></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a71c5b46917846739bb4dd20d45033bcx720x500.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/28925f0450404e1c848dedcb00d3bf93x720x1077.PNG"
    ]
  },
  {
    "text": "Analgesia produced by opioids is mediated by which receptor?",
    "choices": [
      {
        "id": 1,
        "text": "\u00b5"
      },
      {
        "id": 2,
        "text": "k"
      },
      {
        "id": 3,
        "text": "\u03b4"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Analgesia produced by opioids is mediated by&nbsp;<strong>&micro;, k</strong>,<strong> and &delta; receptors.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is Sims curette?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "3"
      },
      {
        "id": 3,
        "text": "4"
      },
      {
        "id": 4,
        "text": "5"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The instrument marked as 1 in the image is\u00a0<strong>Sims curette.</strong>\u00a0</p>\n<p>It is a\u00a0<strong>single-ended</strong>\u00a0uterine curette used for\u00a0<strong>dilatation and curettage</strong>.</p>\n<p>It is designed\u00a0to remove tough tissue from the lining of the uterus for biopsy or excision. The curette features a\u00a0<strong>sharp loop tip</strong>\u00a0to aid in the removal of uterine tissue.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/62dd61b75c284588b5f2f0edbb79d81e.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f43ef09913f84d1ea305f3ed8d18770ex720x585.JPEG"
    ]
  }
];
        let quizName = 'Fmge Mini Test - 036';
        const quizFilename = 'fmge-mini-test-036-4cc1367d.html';
        let hierarchy = ["Marrow", "FMGE Mini Test Series", "2022"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>