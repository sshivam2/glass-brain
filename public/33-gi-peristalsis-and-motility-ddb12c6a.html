<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>33 Gi Peristalsis And Motility - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / qBank / Physiology
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">25</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Slow waves are generated by:",
    "choices": [
      {
        "id": 1,
        "text": "Myenteric neurons"
      },
      {
        "id": 2,
        "text": "Smooth muscle cells"
      },
      {
        "id": 3,
        "text": "Interstitial cells of Cajal"
      },
      {
        "id": 4,
        "text": "Parasympathetic neurons"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>interstitial cells of Cajal</strong> undergo cyclic changes in membrane potential due to unique ion channels that peri&shy;odically open and produce inward (pacemaker) currents that generate <strong>slow-wave activity</strong>.</p>\n<p><strong>Interstitial cells of Cajal&nbsp;</strong>are the&nbsp;<strong>pacemaker cells</strong>&nbsp;of the&nbsp;<strong>GIT</strong>&nbsp;that initiate the&nbsp;<strong>basic electrical rhythm</strong>&nbsp;(BER). These&nbsp;are stellate mesenchymal pacemaker cells with smooth muscle-like features.</p>\n<p>In the stomach and the small intestine, these cells are located in the circular smooth muscle layer near the myenteric plexus. In the colon, they are at the submucosal border of the circular muscle layer.</p>\n<p>The slow waves usually do not by themselves cause muscle contraction in most parts of the gastrointestinal tract, except perhaps in the stomach<em>. </em>Instead, they mainly excite the appearance of intermittent spike potentials, and the spike potentials in turn actually excite the muscle contraction.</p>\n<p>Note<strong>:&nbsp;Gastrointestinal stromal tumors</strong>&nbsp;arise from the interstitial cells of Cajal.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Least frequency of slow waves is seen in:",
    "choices": [
      {
        "id": 1,
        "text": "Duodenum"
      },
      {
        "id": 2,
        "text": "Ileum"
      },
      {
        "id": 3,
        "text": "Jejunum"
      },
      {
        "id": 4,
        "text": "Stomach"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Muscle contraction can occur only when the motor stimulus is provided during the depolarisation part of the BER.</p>\n<p>Thus, BER does not cause muscle contraction by itself, but controls the rate and organization sites of the muscle contractions, as in <strong>coordination </strong>of the <strong>peristaltic activity</strong> and setting the <strong>rhythm</strong> of<strong> segmentation</strong>.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/3aedd333927b4607b4c6b1eca436466ex1020x730.JPEG"
    ]
  },
  {
    "text": "Slow waves are maximum in which part of the intestine?",
    "choices": [
      {
        "id": 1,
        "text": "Stomach"
      },
      {
        "id": 2,
        "text": "Ileum"
      },
      {
        "id": 3,
        "text": "Colon"
      },
      {
        "id": 4,
        "text": "Rectum"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Among the given options, the <strong>frequency</strong> of 'slow waves' is <strong>maximum</strong> in the <strong>ileum</strong> <strong>(8/min).</strong></p>\n<p>Normal intestinal motility is determined by two patterns of electrical activity - slow waves and spike potentials.</p>\n<p>Slow waves, also known as basic electrical rhythm are partial depolarizations of smooth muscle cells, spreading along the GIT. They originate from the interstitial cells of Cajal. The smooth muscles are in a hyperpolarized state, having a resting membrane potential of -50 to -60mV.</p>\n<p>These waves are not action potentials themselves and they do not cause any contractions. Slow waves raise the membrane potential by 5-15mV, bringing it closer to the threshold enabling spike potential (true action potential) to occur. Therefore, they set the basic rhythm of GIT.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "As a part of cranial nerves examination, swallowing reflex is performed on a patient. Which of the following is not involved in afferent limb of this reflex?",
    "choices": [
      {
        "id": 1,
        "text": "Trigeminal nerve"
      },
      {
        "id": 2,
        "text": "Facial nerve"
      },
      {
        "id": 3,
        "text": "Glossopharyngeal nerve"
      },
      {
        "id": 4,
        "text": "Vagus nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The<strong> facial nerve</strong> is a part of an&nbsp;<strong>efferent limb</strong> (and not afferent) of the <strong>swallowing reflex.</strong></p>\n<table style=\"height: 115px; width: 383px;\">\n<tbody>\n<tr style=\"height: 31.543px;\">\n<td style=\"width: 368px; text-align: center; height: 31.543px;\" colspan=\"2\"><strong>Swallowing/ deglutition reflex</strong></td>\n</tr>\n<tr style=\"height: 110px;\">\n<td style=\"width: 127.832px; height: 110px;\">Afferents</td>\n<td style=\"width: 240.168px; height: 110px;\">\n<p>Trigeminal&nbsp;nerve</p>\n<p>Glossopharyngeal nerve</p>\n<p>Vagus nerve</p>\n</td>\n</tr>\n<tr style=\"height: 78px;\">\n<td style=\"width: 127.832px; height: 78px;\">Centre</td>\n<td style=\"width: 240.168px; height: 78px;\">\n<p>Nucleus of the tractus solitarius</p>\n<p>Nucleus ambig&shy;uus</p>\n</td>\n</tr>\n<tr style=\"height: 110px;\">\n<td style=\"width: 127.832px; height: 110px;\">Efferents</td>\n<td style=\"width: 240.168px; height: 110px;\">\n<p>Trigeminal&nbsp;nerve</p>\n<p>Facial nerve</p>\n<p>Hypoglossal nerve</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Chyme is propelled forward in small intestine by_______",
    "choices": [
      {
        "id": 1,
        "text": "Segmentation"
      },
      {
        "id": 2,
        "text": "Haustration"
      },
      {
        "id": 3,
        "text": "MMC"
      },
      {
        "id": 4,
        "text": "Peristalsis"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Migrating motor complexes </strong>(MMC) are&nbsp;the&nbsp;peristaltic&nbsp;motor patterns that occur during fasting. They&nbsp;migrate from the stomach to the distal ileum.</p>\n<p><strong>Haustrations</strong> are the&nbsp;characteristic saclike segments seen in the&nbsp;large intestine.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9f3ecc080f694d3182bb00b059253c90x1021x711.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/5367114d796e413b9813ed79593d1329x1021x649.JPEG"
    ]
  },
  {
    "text": "Which of the following is the major initiating response for peristalsis?",
    "choices": [
      {
        "id": 1,
        "text": "Hormonal"
      },
      {
        "id": 2,
        "text": "Local stretching of gut"
      },
      {
        "id": 3,
        "text": "Neural"
      },
      {
        "id": 4,
        "text": "Gastric acid"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The <strong>major initiating response</strong> for peristalsis is<strong> local stretching </strong>of the <strong>gut.</strong></p>\n<p><strong>Peristalsis</strong> is a reflex response that is initiated when the gut wall is stretched by the contents of the lumen.&nbsp;It occurs in all parts of the gastrointestinal tract from the esophagus to the rectum.</p>\n<p>The stretch initiates a circular contraction behind the stimulus and an area of relaxation in front of it.&nbsp;The wave of contraction then moves in an oral-to-caudal direction. This propels the contents of the lumen forward at rates that vary from 2 to 25 cm/s.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/fc61cd98c5b14b2891c1c28976cfb22ax600x657.JPEG"
    ]
  },
  {
    "text": "Which of the following is seen in a patient on parasympathetic stimulation?",
    "choices": [
      {
        "id": 1,
        "text": "Sphincter closure of gall bladder"
      },
      {
        "id": 2,
        "text": "Increased peristalsis"
      },
      {
        "id": 3,
        "text": "Decreased GI motility"
      },
      {
        "id": 4,
        "text": "Decreased pancreatic secretion"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Parasympathetic stimulation</strong> results in <strong>increased peristalsis.</strong></p>\n<p>Generally, the stimulation of parasympathetic nerves (PNS) causes an increase in the activity of the entire enteric nervous system. This, in turn, enhances the activity of most gastrointestinal functions.</p>\n<p><strong>PNS stimulation</strong> causes:</p>\n<ul>\n<li>Contraction of smooth muscle in the wall</li>\n<li>Relaxation of sphincters</li>\n<li>&uarr; Salivary secretion</li>\n<li>&uarr; Gastric secretion</li>\n<li>&uarr; Pancreatic secretion</li>\n</ul>\n<p><strong>SNS</strong>&nbsp;<strong>stimulation</strong> causes:</p>\n<ul>\n<li>Relaxation of smooth muscle in the wall</li>\n<li>Contraction of sphincters</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which neurotransmitter is responsible for anterograde dilatation of the small intestine?",
    "choices": [
      {
        "id": 1,
        "text": "VIP"
      },
      {
        "id": 2,
        "text": "Acetylcholine"
      },
      {
        "id": 3,
        "text": "Substance P"
      },
      {
        "id": 4,
        "text": "Serotonin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Note: In achalasia cardia, there is decreased&nbsp;release of NO and VIP in the distal part of the esophagus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/cf32672ea3f64322b1101ef54476978bx600x657.JPEG"
    ]
  },
  {
    "text": "Which of the following neurotransmitters acts on the muscle, behind a bolus of food, in the process of peristalsis?",
    "choices": [
      {
        "id": 1,
        "text": "NO"
      },
      {
        "id": 2,
        "text": "VIP"
      },
      {
        "id": 3,
        "text": "Serotonin"
      },
      {
        "id": 4,
        "text": "Substance P"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Substance P</strong> and <strong>acetylcholine</strong> are released from neurons behind the bolus of food, causing <strong>smooth muscle contraction,</strong> which <strong>propels</strong> the <strong>food downwards.</strong></p>\n<p><strong>NO</strong> and<strong> VIP</strong> are released by neurons in the <strong>anterograde direction</strong> from the bolus which produces relaxation in front of the stimulus.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "All of the following stimulates gastric motility except:",
    "choices": [
      {
        "id": 1,
        "text": "Encephalin"
      },
      {
        "id": 2,
        "text": "Angiotensin"
      },
      {
        "id": 3,
        "text": "Substance P"
      },
      {
        "id": 4,
        "text": "Substance K"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Encephalin inhibits</strong> the <strong>motility</strong> of the <strong>stomach.</strong></p>\n<div class=\"page\" title=\"Page 1131\">\n<table><colgroup><col /><col /> </colgroup>\n<tbody>\n<tr>\n<td><strong>Function</strong></td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Source</strong></p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td colspan=\"2\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Stimulate secretion</strong></p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Gastrin</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>G-cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Histamine</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>ECL cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Acetylcholine</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Gastrin-releasing peptide</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones and mucosa</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Cholecystokinin (CCK)</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Duodenal endocrine cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Inhibit secretion</strong></p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Somatostatin</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>D-cells and neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Secretin</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Duodenal endocrine cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Enteroglucagon</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Small intestinal endocrine cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Prostaglandins</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Mucosa</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurotensin</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>GIP</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Duodenal and jejunal endocrine cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>PYY</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Small intestinal endocrine cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Stimulate motility</strong></p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Acetylcholine</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>5-HT</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Histamine</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>ECL cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Substance P</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Substance K</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Motilin</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Gastrin</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>G-cells</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Angiotensin</p>\n</div>\n</div>\n</td>\n<td>&nbsp;</td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"1\">\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p><strong>Inhibit motility</strong></p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Somatostatin</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>D-cells and neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>VIP</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Nitric oxide</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones and smooth muscle</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Noradrenaline</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Encephalin</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Dopamine</p>\n</div>\n</div>\n</td>\n<td>\n<div class=\"layoutArea\">\n<div class=\"column\">\n<p>Neurones</p>\n</div>\n</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p>ECL:&nbsp;enterochromaffin-like</p>\n</div>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Gastric emptying is mainly regulated by which of the following mechanisms?",
    "choices": [
      {
        "id": 1,
        "text": "Neural reflexes"
      },
      {
        "id": 2,
        "text": "Enteric reflexes"
      },
      {
        "id": 3,
        "text": "Local hormones in stomach"
      },
      {
        "id": 4,
        "text": "Local hormones in duodenum"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Gastric emptying</strong> is mainly <strong>regulated</strong> by <strong>enteric reflexes.</strong></p>\n<p>Regulation of gastric emptying is mainly by the&nbsp;<strong>inhibitory feedback</strong> signals from the duodenum that includes enterogastric reflex&nbsp;and <strong>hormonal feedback</strong> by cholecystokinin.</p>\n<p><strong>Enterogastric reflex:&nbsp;</strong>When food enters the duodenum, multiple nervous reflexes are initiated from the duodenal wall. They strongly inhibit the pyloric pump propulsive contractions&nbsp;and increase the tone of the pyloric sphincter.</p>\n<p>These reflexes are mediated by three routes:</p>\n<ul>\n<li>Directly from the duodenum to the stomach through the enteric nervous&nbsp;system in the gut wall (major role)</li>\n<li>Through inhibitory sympathetic nerve fibers to the stomach (minor role)</li>\n<li>Vagus nerves to the brain stem where they inhibit the normal excitatory signals transmitted to the stomach (minor role)</li>\n</ul>\n<p><strong>Hormonal feedback:&nbsp;</strong>Cholecystokinin is released from the mucosa of the jejunum in response to fatty substances in the chyme. This hormone acts as an inhibitor to block increased stomach motility caused by gastrin.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/8e820124b88f49fa9cff55d643e8ec63x1280x1681.JPEG"
    ]
  },
  {
    "text": "Which among the following increases gastric emptying?",
    "choices": [
      {
        "id": 1,
        "text": "Secretin"
      },
      {
        "id": 2,
        "text": "CCK"
      },
      {
        "id": 3,
        "text": "GIP"
      },
      {
        "id": 4,
        "text": "Distension of stomach"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The<strong> distension </strong>of the <strong>stomach increases</strong>&nbsp;<strong>gastric emptying.</strong></p>\n<p>Distension activates the mechanoreceptors that trigger long and short reflexes&nbsp;in the stomach. This increases the force of&nbsp;antral contraction and gastric emptying.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following does not delay gastric emptying?",
    "choices": [
      {
        "id": 1,
        "text": "Fat in duodenum"
      },
      {
        "id": 2,
        "text": "Acid in duodenum"
      },
      {
        "id": 3,
        "text": "Gastrin"
      },
      {
        "id": 4,
        "text": "Secretin"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Gastrin increases</strong>&nbsp;<strong>gastric emptying.</strong> It does&nbsp;not delay it.&nbsp;</p>\n<p>Gastrin has mild to moderate stimulatory effects on motor functions in the body of the stomach. Thus, gastrin likely promotes stomach emptying.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In which of the following reflexes, gastric emptying is delayed when acidic content enters the duodenum?",
    "choices": [
      {
        "id": 1,
        "text": "Gastrocolic"
      },
      {
        "id": 2,
        "text": "Enterocolic"
      },
      {
        "id": 3,
        "text": "Gastroileal"
      },
      {
        "id": 4,
        "text": "Enterogastric"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>In<strong>&nbsp;</strong>the<strong>&nbsp;enterogastric reflex,&nbsp;gastric emptying</strong> is <strong>delayed</strong> when <strong>acidic content</strong> enters the duodenum.</p>\n<p>When the food enters the duodenum, multiple reflexes are initiated from the duodenal wall which passes back to the stomach. These reflexes <strong>slow</strong> or <strong>stop</strong> the <strong>stomach emptying</strong> if the volume of the chyme in the duodenum becomes too much. These reflexes are called enterogastric reflexes.</p>\n<p>This reflex can be triggered&nbsp;due to the following reasons:</p>\n<ul>\n<li>Presence of irritants and <strong>acids</strong> in duodenal chyme (<strong>most sensitive</strong> factor)</li>\n<li>Distension of duodenum due to the presence of an excessive volume of chyme</li>\n<li>Rapid entry of hypertonic or hypotonic fluids into the duodenum</li>\n<li>Presence of breakdown products of protein digestion and sometimes fat</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Enterogastric inhibitory reflexes are stimulated by all of the following except:",
    "choices": [
      {
        "id": 1,
        "text": "Alkaline content of small intestine"
      },
      {
        "id": 2,
        "text": "Hyperosmolarity of chyme"
      },
      {
        "id": 3,
        "text": "Distension of duodenum"
      },
      {
        "id": 4,
        "text": "Duodenal mucosal irritation"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Enterogastric inhibitory reflexes</strong> are <strong>stimulated</strong> by&nbsp;<strong>acidic contents,</strong> not alkaline.</p>\n<p>The duodenal factors that can initiate enterogastric inhibitory reflexes (enterogastric reflexes) are:</p>\n<ul>\n<li>Distention of the duodenum</li>\n<li>Presence of any irritation of the duodenal mucosa</li>\n<li>Acidity of the duodenal chyme</li>\n<li>Osmolality of the chyme - either hypotonic or hypertonic fluid initiate enterogastric inhibitory reflexes.&nbsp;Thus, the flow of non-isotonic fluids into the small intestine is regulated. This&nbsp;prevents rapid changes in electrolyte concentrations in the extracellular fluid during the absorption of the intestinal contents.</li>\n<li>Presence of certain breakdown products in the chyme, especially proteins and to a lesser extent, of fats</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4f3ebdb4de144cd5a956a14e9c20a9b3x1280x1681.JPEG"
    ]
  },
  {
    "text": "A concerned mother brings her infant to the OPD for advice regarding nutrition. She says, soon after every meal, her kid defecates. What is the cause of colonic contraction in this situation?",
    "choices": [
      {
        "id": 1,
        "text": "Gastroileal reflex"
      },
      {
        "id": 2,
        "text": "Enterogastric reflex"
      },
      {
        "id": 3,
        "text": "Increased circulation of CCK"
      },
      {
        "id": 4,
        "text": "Gastrocolic reflex"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>cause</strong> of <strong>colonic contraction</strong> in the given situation is due to <strong>gastrocolic reflex.</strong></p>\n<p>Distension of the stomach by food initiates contractions of the rectum and frequently, a desire to defecate. This response is called the <strong>gastrocolic reflex</strong>. Because of this response, defecation after meals is common in children. This response&nbsp;may be amplified by the action of gastrin on the colon.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The following image shows which type of GI motility?",
    "choices": [
      {
        "id": 1,
        "text": "Peristalsis"
      },
      {
        "id": 2,
        "text": "Segmentation and mixing"
      },
      {
        "id": 3,
        "text": "Migrating motor complex"
      },
      {
        "id": 4,
        "text": "BER"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Option D: Basal Electrical Rhythm is fluctuation in the resting membrane potential of smooth muscle cells of the intestine as shown below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/45dff1b53e7c46898d72b982e08d6933.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4daa97d71f0046c4878b617156f80818x1021x711.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/60b60ee0e80d4bb59f043211ccc0409dx1021x649.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/71749de3d92741eb87e1af41e07b8472x1020x730.JPEG"
    ]
  },
  {
    "text": "Migrating motor complexes occurs at the rate of _______  and at an interval of  _________",
    "choices": [
      {
        "id": 1,
        "text": "90 cm/min, 5 min"
      },
      {
        "id": 2,
        "text": "5 cm/min, 100 min"
      },
      {
        "id": 3,
        "text": "90 cm/sec, 5 min"
      },
      {
        "id": 4,
        "text": "5 cm/sec, 100 min"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Note: Disorders of MMC have been associated with gastroparesis, intestinal pseudo-obstruction, and small intestinal bacterial overgrowth.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a794a58b73464386a576fcefc1d25892x1020x1131.JPEG"
    ]
  },
  {
    "text": "Which of the following is true about gastroduodenal motor activity?",
    "choices": [
      {
        "id": 1,
        "text": "Migrating motor complex/MMC in the fasting state lasts for 50 minutes"
      },
      {
        "id": 2,
        "text": "Duodenal slow waves are limited to the duodenum"
      },
      {
        "id": 3,
        "text": "From the duodenum, the MMC moves distally at 5-10 cm/min"
      },
      {
        "id": 4,
        "text": "The amplitude of contraction decreases to a minimum in phase III of MMC"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>From the duodenum, the migrating motor complex <strong>(MMC)</strong> moves distally at <strong>5\u201310 cm/min</strong>, reaching the terminal ileum after 1.5 hours.\u00a0</p>\n<p>In the\u00a0<strong>fasting state</strong>,\u00a0 there is a period of quiescence in the small bowel, lasting for approximately 40 minutes (phase I). This is followed by a series of waves, also lasting for about 40 minutes, propagating from the fundus of the stomach in a caudal direction at a rate of about 3 per minute (phase II).\u00a0</p>\n<p><strong>Duodenal slow waves</strong> are generated in the duodenum at a rate of about 10 per minute, which carry down the small bowel.</p>\n<p>The amplitude of these contractions increases to a <strong>maximum</strong> in phase III, which lasts for about 10 minutes. This<strong> 90-minute cycle</strong> of activity is then repeated.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d8ff1aa7edab482cb5a377e06322e4dbx1020x1131.JPEG"
    ]
  },
  {
    "text": "Which of the following does not increase small intestinal motility?",
    "choices": [
      {
        "id": 1,
        "text": "Secretin"
      },
      {
        "id": 2,
        "text": "Gastroenteric reflex"
      },
      {
        "id": 3,
        "text": "CCK"
      },
      {
        "id": 4,
        "text": "Serotonin"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Secretin inhibits small intestinal motility.</p>\n<p>Factors that <strong>increase</strong> the <strong>peristaltic activity</strong> of the small intestine:</p>\n<ul>\n<li><strong>Hormonal -&nbsp;</strong>gastrin, CCK, insulin, motilin, and serotonin.</li>\n<li><strong>Neural - </strong>d<span style=\"text-align: justify;\">uodenal distension by chyme, g</span><span style=\"text-align: justify;\">astroenteric reflexes, g</span><span style=\"text-align: justify;\">astroileal reflexes, p</span><span style=\"text-align: justify;\">arasympathetic (Ach) stimulation.</span></li>\n</ul>\n<p>Factors that <strong>decrease</strong> the&nbsp;<strong>peristaltic activity</strong> of the small intestine:</p>\n<ul>\n<li><strong>Hormonal -&nbsp;</strong>secretin and glucagon.</li>\n<li><strong>Neural -&nbsp;</strong>sympathetic stimulation.</li>\n</ul>\n<p><strong>Gastroileal reflex -&nbsp;</strong>On reaching the ileocecal valve, the chyme is sometimes blocked for several hours until the person eats another meal. At that time, a gastroileal reflex intensifies peristalsis in the ileum and forces the remaining chyme through the ileocecal valve into the cecum of the large intestine.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which part of the GIT has the longest transit time?",
    "choices": [
      {
        "id": 1,
        "text": "Stomach"
      },
      {
        "id": 2,
        "text": "Jejunum"
      },
      {
        "id": 3,
        "text": "Colon"
      },
      {
        "id": 4,
        "text": "Ileum"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>longest transit time</strong> is seen in the <strong>colon.</strong></p>\n<p>Average transit time:</p>\n<table>\n<tbody>\n<tr>\n<td width=\"191\">\n<p><strong>Segment</strong></p>\n</td>\n<td width=\"98\">\n<p><strong>Transit time</strong></p>\n</td>\n</tr>\n<tr>\n<td width=\"191\">\n<p>Esophagus</p>\n</td>\n<td width=\"98\">\n<p>2-3 seconds</p>\n</td>\n</tr>\n<tr>\n<td width=\"191\">\n<p>Stomach</p>\n</td>\n<td width=\"98\">\n<p>2-5 hours</p>\n</td>\n</tr>\n<tr>\n<td width=\"191\">\n<p>Small intestine</p>\n</td>\n<td width=\"98\">\n<p>3-6 hours</p>\n</td>\n</tr>\n<tr>\n<td width=\"191\">\n<p>Caecum</p>\n</td>\n<td width=\"98\">\n<p>4 hours</p>\n</td>\n</tr>\n<tr>\n<td width=\"191\">\n<p>First third of colon</p>\n</td>\n<td width=\"98\">\n<p>6 hours</p>\n</td>\n</tr>\n<tr>\n<td width=\"191\">\n<p>Second third of colon</p>\n</td>\n<td width=\"98\">\n<p>9 hours</p>\n</td>\n</tr>\n<tr>\n<td width=\"191\">\n<p>Sigmoid colon</p>\n</td>\n<td width=\"98\">\n<p>12 hours</p>\n</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The maximum motility of the colon is seen in which of the following part?",
    "choices": [
      {
        "id": 1,
        "text": "Ascending colon"
      },
      {
        "id": 2,
        "text": "Transverse colon"
      },
      {
        "id": 3,
        "text": "Descending colon"
      },
      {
        "id": 4,
        "text": "Sigmoid colon"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>maximum motility</strong> of the <strong>colon</strong> is seen in the <strong>sigmoid colon. </strong></p>\n<p>The rate of BER at sigmoid colon is&nbsp;6/min.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A patient is undergoing sigmoidoscopy as a part of his routine colon cancer screening. While doing the procedure, the rectum is inflated with gas. Which part of the intestine would you likely see increased peristalsis in this patient?",
    "choices": [
      {
        "id": 1,
        "text": "Whole colon"
      },
      {
        "id": 2,
        "text": "Proximal colon"
      },
      {
        "id": 3,
        "text": "Distal colon"
      },
      {
        "id": 4,
        "text": "Whole intestine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>While doing <strong>sigmoidoscopy</strong> if the <strong>rectum</strong> is inflated with <strong>gas, increased peristalsis</strong> is seen in the&nbsp;<strong>distal colon.</strong></p>\n<p>The distention of the&nbsp;rectal wall initiates <strong>afferent signals.</strong> These signals spread through&nbsp;the myenteric plexus to initiate peristaltic waves in the&nbsp;descending colon, sigmoid (distal colon), and rectum.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following controls the secretions of GIT?",
    "choices": [
      {
        "id": 1,
        "text": "Myenteric plexuses"
      },
      {
        "id": 2,
        "text": "Auerbach plexuses"
      },
      {
        "id": 3,
        "text": "Meissner plexuses"
      },
      {
        "id": 4,
        "text": "Extrinsic nerve"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Secretions</strong> of GIT are controlled by the&nbsp;<strong>Meissner plexus.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c379169dbf184c589732b632246e25f1x1280x1354.JPEG"
    ]
  },
  {
    "text": "You will feel the first urge to defecate when rectal pressure is increased to:",
    "choices": [
      {
        "id": 1,
        "text": "12 mmHg"
      },
      {
        "id": 2,
        "text": "14 mmHg"
      },
      {
        "id": 3,
        "text": "16 mmHg"
      },
      {
        "id": 4,
        "text": "18 mmHg"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The <strong>first urge</strong> to <strong>defecate</strong> occurs when <strong>rectal pressure</strong> is increased to&nbsp;<strong>18 mm Hg.</strong></p>\n<p>When this pressure reaches 55 mm Hg, the external and the internal sphinc&shy;ter relax, and there is reflex expulsion of the contents of the rectum.</p>\n<p><strong>Defecation reflex:</strong>&nbsp;Distension of the rectum and colon&nbsp;stimulates stretch receptors&nbsp;in the rectal wall. Then, the defecation reflexes travel from the colon and rectum to the&nbsp;spinal cord and back again to produce the powerful&nbsp;colonic, rectal, and abdominal contractions required&nbsp;for defecation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4fc7d050bac0479eb540f9e3d386108cx1280x1418.JPEG"
    ]
  }
];
        let quizName = '33 Gi Peristalsis And Motility';
        let hierarchy = ["Marrow", "qBank", "Physiology"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>