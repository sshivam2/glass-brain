<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Test 9- Image Based Only - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}


    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Mini Test Series / 2021-22
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">20</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "Which of the following structures does not pass through the foramen marked with the black arrow in the image given below?",
    "choices": [
      {
        "id": 1,
        "text": "Emissary veins"
      },
      {
        "id": 2,
        "text": "Middle meningeal artery"
      },
      {
        "id": 3,
        "text": "Lesser petrosal nerve"
      },
      {
        "id": 4,
        "text": "Accessory meningeal artery"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The foramen marked in the image is the <strong>foramen</strong> <strong>ovale</strong>. The <strong>middle meningeal artery</strong> does not pass through the foramen ovale. It passes through the <strong>foramen spinosum</strong>.</p>\n<p>The structures passing through the foramen ovale are:</p>\n<ul>\n<li><strong>Mandibular division </strong>of the<strong> trigeminal nerve</strong>&nbsp;</li>\n<li><strong>A</strong>ccessory meningeal artery</li>\n<li><strong>L</strong>esser petrosal nerve</li>\n<li><strong>E</strong>missary veins&nbsp;</li>\n</ul>\n<p>These structures can be remembered using the mnemonic 'MALE'. &nbsp;&nbsp;</p>\n<p>The structures passing through the<strong> foramen spinosum</strong> are:</p>\n<ul>\n<li>Middle meningeal artery</li>\n<li>Nervus spinosus (meningeal branch of mandibular nerve)</li>\n<li>Middle meningeal vein</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/65952b41331e4033bb7ffbc89531646b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c2b7083ef012475d9aebef2d54f11f8cx1280x1198.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/17218674842e4fa39be51de087788127x1279x1439.JPEG"
    ]
  },
  {
    "text": "A 40-year-old male patient who works with animal hides presents with a lesion covered by a black eschar on his arm. Microscopy of the pus sample revealed bacilli, as shown in the image below. Which of the following proteins is not associated with the toxin produced by this pathogen?",
    "choices": [
      {
        "id": 1,
        "text": "Lethal factor"
      },
      {
        "id": 2,
        "text": "Serum opacity factor"
      },
      {
        "id": 3,
        "text": "Edema factor"
      },
      {
        "id": 4,
        "text": "Protective antigen"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The clinical scenario and the image showing <strong>gram-positive bacilli</strong> with a characteristic <strong>bamboo stick appearance</strong> suggest<strong><em>&nbsp;B<strong>a</strong>cillus anthracis.&nbsp;</em>Serum opacity factor</strong> is not a protein associated with anthrax toxin.</p>\n<p><strong>Serum opacity factor</strong>&nbsp;is a lipoproteinase produced by some M types of <strong><em>Streptococcus pyogenes. </em></strong>It causes opacity&nbsp;when applied to agar gel containing horse or swine serum. It is used to determine the virulence of the organism.&nbsp;</p>\n<p><em>Bacillus anthracis</em> is a large, <strong>gram-positive</strong> bacillus. It causes zoonotic infections in humans. It is <strong>non-motile</strong> and capsulated with a characteristic <strong>polypeptide capsule</strong> made of d(-)glutamic acid.</p>\n<p>Virulence factors of <em>B. anthracis</em> include</p>\n<ul>\n<li>A<strong>&nbsp;polypeptide</strong> capsule that inhibits phagocytosis</li>\n<li><strong>Anthrax toxins,</strong>&nbsp;which are made of three proteins<br /><br />\n<table style=\"height: 110px; width: 521.589px;\">\n<tbody>\n<tr>\n<td style=\"width: 223px;\"><strong>1. Edema factor/Factor I</strong></td>\n<td style=\"width: 281.589px;\">An adenylate cyclase that causes tissue edema</td>\n</tr>\n<tr>\n<td style=\"width: 223px;\"><strong>2. Protective antigen/Factor II</strong></td>\n<td style=\"width: 281.589px;\">Binds to specific cell receptors and mediates entry of edema factor and lethal factor into the cell</td>\n</tr>\n<tr>\n<td style=\"width: 223px;\"><strong>3. Lethal factor/Factor III</strong></td>\n<td style=\"width: 281.589px;\">Causes tissue death</td>\n</tr>\n</tbody>\n</table>\n&nbsp;</li>\n</ul>\n<p>Clinical presentation of anthrax:</p>\n<ul>\n<li><strong>Cutaneous anthrax:</strong>&nbsp;It is seen in dock workers carrying loads of hides and skin of infected animals. Hence, it is also called&nbsp;<strong>hide porter's disease</strong>. At the site of entry of organism or spores, a papule develops in about 1&ndash;3 days. This develops into a vesicle that later breaks down into an ulcer with a black, central,<strong> necrotic eschar</strong> surrounded by edematous skin. The lesion is also called a <strong>malignant pustule</strong>. The majority of the patients recover spontaneously, but a few may succumb to septicemia or meningitis.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3552ec0b5b74475d8178e85efbd2a360.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/1bc9b110dbfe4dceae1034f25d799da8x1280x853.PNG"
    ]
  },
  {
    "text": "Which of the following diagnoses have the hematology findings given below?",
    "choices": [
      {
        "id": 1,
        "text": "Minamata disease"
      },
      {
        "id": 2,
        "text": "Saturnism"
      },
      {
        "id": 3,
        "text": "Chronic iron toxicity"
      },
      {
        "id": 4,
        "text": "Arsenic poisoning"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The findings present in the above hematology slide are <strong>basophilic stippling</strong> \u00a0(punctate basophilia) with <strong>Cabot\u2019s ring</strong> . They are features seen in<strong> chronic lead poisoning</strong> (also called plumbism or <strong>saturnism</strong>).</p>\n<p>Clinical features include:</p>\n<ul>\n<li><strong>A - </strong>Anemia with basophilic stippling</li>\n<li><strong>B - </strong>Burtonian line (blue stippled line on gums)</li>\n<li><strong>C - </strong>Constipation and colic (abdominal pain)</li>\n<li><strong>D - </strong>Drop (wrist and foot drop) due to neuropathy</li>\n<li><strong>E - </strong>Encephalopathy (Mostly seen in infants presenting with severe ataxia, vomiting, lethargy, stupor, convulsion, and coma)</li>\n<li><strong>F - </strong>Facial pallor -<strong>earliest sign</strong></li>\n</ul>\n<p><strong>Other Options:</strong></p>\n<ul>\n<li>Minamata disease: Chronic mercury poisoning can show anemia secondary to GI hemorrhage.</li>\n<li>Chronic iron toxicity: In severe cases, can present with leucocytosis and anemia (due to blood loss).</li>\n<li>Arsenic poisoning: Can induce microcytic hypochromic anemia or hemolytic anemia.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/3a5ccbea0b544020bfdcce23d842a66a.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A patient with productive cough, fever, and breathlessness was found to have decreased breath sounds and a dull note on percussion on the left side. His X-ray is given below. Sputum analysis revealed a diagnosis of bacterial pneumonia. Which of the following pleural fluid characteristics would best fit the diagnosis, according to Light's criteria?",
    "choices": [
      {
        "id": 1,
        "text": "Pleural fluid protein/ serum protein > 0.4"
      },
      {
        "id": 2,
        "text": "Pleural fluid LDH/ serum LDH > 0.6"
      },
      {
        "id": 3,
        "text": "Pleural fluid protein/ serum protein < 0.6"
      },
      {
        "id": 4,
        "text": "Pleural fluid LDH/ serum LDH < 0.4"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The pleural fluid characteristics in a patient with bacterial pneumonia would be <strong>pleural fluid LDH/serum LDH of &gt;0.6</strong>. The pleural effusion associated with <strong>bacterial pneumonia</strong> is <strong>exudative</strong> in nature.&nbsp;</p>\n<p><strong>Light&rsquo;s criteria</strong> can be used to differentiate between transudative and exudative pleural effusions. Exudative effusions will meet at least one of the following criteria:</p>\n<ol>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Pleural fluid protein/serum protein <strong>&gt;0.5</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Pleural fluid LDH/serum LDH&nbsp;<strong>&gt;0.6</strong></li>\n<li style=\"font-weight: 400;\" aria-level=\"1\">Pleural fluid LDH is&nbsp;<strong>more than two-thirds of the upper limit of normal</strong> for serum.&nbsp;</li>\n</ol>\n<p>Exudative effusions occur when there is a disruption in pleural fluid formation and drainage because of <strong>local factors.</strong></p>\n<p>Causes of exudative effusion include:</p>\n<ul>\n<li><strong>Bacterial pneumonia</strong></li>\n<li>Viral infections</li>\n<li>Pulmonary embolism</li>\n<li>Malignancy.&nbsp;</li>\n</ul>\n<p>Transudative effusions will not meet any of the above-mentioned criteria. They occur when there is a disruption in pleural fluid formation and drainage due to <strong>systemic factors</strong>.</p>\n<p>Causes of transudative effusion include:</p>\n<ul>\n<li>Cirrhosis of the liver</li>\n<li>Left ventricular failure</li>\n<li>Nephrotic syndrome</li>\n</ul>\n<p>Understanding the cause of a patient&rsquo;s pleural effusion can help us diagnose the condition and determine management.&nbsp;</p>\n<p>The other options are incorrect as they are not in line with Light&rsquo;s criteria for the diagnosis of an exudative effusion.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/18e7241e0eff495684388a2a3a0d6520.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Shown below is the pelvic ultrasound image of a 28-year-old female patient with a positive urine pregnancy test. She gave a history of recent treatment for infertility. Identify the classical radiological finding shown in her right adnexa.",
    "choices": [
      {
        "id": 1,
        "text": "Lambda sign"
      },
      {
        "id": 2,
        "text": "Bagel sign"
      },
      {
        "id": 3,
        "text": "Double decidual sac sign"
      },
      {
        "id": 4,
        "text": "T sign"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shows the <strong>bagel sign</strong>\u00a0seen in <strong>tubal</strong>\u00a0<strong>ectopic pregnancy</strong>.</p>\n<p>The bagel sign\u00a0is also known as the <strong>tubal ring sign</strong> or the <strong>blob sign.\u00a0</strong>It refers to the appearance of a gestational sac in the adnexa with a hyperechoic ring.\u00a0It is characteristic of tubal ectopic pregnancy.\u00a0This sign has a positive predictive value of 95% in ectopic pregnancy.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/5f133f0b11894882b3cdfea92a6e6c1d.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e5cd5f438bc94502bb0cc2a9cd5793fdx1280x1623.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/50f52dce5a294e5f947287f0c832c0d0x501x414.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/74999d716f844ebca19c4debd9f738e7x1000x864.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9c3f02ad21694d8d9363e0f7ff96a095x498x342.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/555254f97ce148aa9ef8d1090497b333x480x365.JPEG"
    ]
  },
  {
    "text": "Which of the following statements is true about the given dose-response curve:",
    "choices": [
      {
        "id": 1,
        "text": "Drug B is the most potent"
      },
      {
        "id": 2,
        "text": "Drug B is the most efficacious"
      },
      {
        "id": 3,
        "text": "Drug C is more efficacious than drug D"
      },
      {
        "id": 4,
        "text": "Drug B is more efficacious than drug A"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The more the <strong>curve</strong> is to the<strong> left</strong>, the <strong>more</strong> its <strong>potency</strong>. Hence <strong>drug B </strong>is the <strong>most potent&nbsp;</strong>on the given dose-response curve (DRC).</p>\n<p><strong>Potency</strong></p>\n<ul>\n<li>It is defined as the&nbsp;<strong>amount of drug&nbsp;</strong>needed<strong>&nbsp;to produce a given response.&nbsp;</strong></li>\n<li>A&nbsp;<strong>highly potent drug</strong>&nbsp;evokes a given&nbsp;<strong>response&nbsp;</strong>at<strong>&nbsp;low concentrations</strong>&nbsp;and vice-versa.</li>\n<li>The more the curve is on the<strong>&nbsp;left&nbsp;</strong>in a log dose-response curve (DRC)<strong>,&nbsp;</strong>the&nbsp;<strong>greater </strong>its<strong> potency.</strong></li>\n</ul>\n<p>Hence in the given DRC <strong>drug B</strong> is the <strong>most </strong>potent and <strong>drug D</strong> is the<strong> least</strong> potent.</p>\n<p><strong>Efficacy</strong></p>\n<ul>\n<li>It is defined as the<strong>&nbsp;maximum effect produced</strong>&nbsp;by the drug.</li>\n<li>It reflects the capacity of the drug to activate a receptor and produce the response.</li>\n<li>In the log dose-response curve, the&nbsp;<strong>perpendicular height</strong>&nbsp;represents the drug efficacy.</li>\n</ul>\n<p>Hence in the given DRC, <strong>drug B</strong> has the<strong> least efficacy </strong>(Option B and D)<strong>,</strong> and drugs<strong> A, C &amp; D </strong>are <strong>equally efficacious</strong>. (Option C)</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/913242098af8461ab3b4e2cc8b958321.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The brace shown in the given image is _____.",
    "choices": [
      {
        "id": 1,
        "text": "Boston brace"
      },
      {
        "id": 2,
        "text": "Milwaukee brace"
      },
      {
        "id": 3,
        "text": "Taylor brace"
      },
      {
        "id": 4,
        "text": "ASHE brace"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The brace shown in the image is the <strong>Milwaukee brace</strong>.</p>\n<p>The Milwaukee brace is an <strong>active corrective spinal orthosis</strong> primarily used in the <strong>ambulatory treatment</strong> of <strong>structural scoliosis</strong>. Designed as a <strong>cervico-thoracic-lumbar-sacral orthosis</strong> (CTLSO), the main objective of the Milwaukee brace is to <strong>delay </strong>or <strong>eliminate </strong>the<strong> need for surgery</strong>. However, in recent years, the use of the Milwaukee brace has declined due to the availability and convenience of modern braces. Nonetheless, it is still employed for scoliosis cases characterized by <strong>high thoracic and cervical spine curves</strong>.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/e62bedff691049c5814fa3feab9ce2fa.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/e9afc0c4ad2e4b06a44729dee539c316x1280x1280.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2b3438081dbe418fb173399e274c123bx720x720.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/7997bc8460f245c79ee6571e4bc9643bx1280x1262.JPEG"
    ]
  },
  {
    "text": "An 18-year-old male patient presented to the ENT department with the lesion shown in the image below. Apple jelly color of the infiltrate was noted on diascopy. Histopathological examination of the lesions revealed granulomas surrounded by multinucleate giant cells and epitheloid cells without caseation necrosis. Which organism is responsible for this condition?",
    "choices": [
      {
        "id": 1,
        "text": "Mycobacterium leprae"
      },
      {
        "id": 2,
        "text": "Klebsiella rhinoscleromatis"
      },
      {
        "id": 3,
        "text": "Mycobacterium tuberculosis"
      },
      {
        "id": 4,
        "text": "Rhinosporidium seeberi"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The above features are diagnostic of <strong>lupus vulgaris</strong>&nbsp;and the organism responsible is <strong><em>Mycobacterium tuberculosis.</em></strong></p>\n<p>Lupus vulgaris is a <strong>low-grade tuberculous</strong> infection affecting the skin over the nose and face. Brown, gelatinous nodules with&nbsp;<strong>apple jelly-colored</strong>&nbsp;infiltrate<strong>&nbsp;</strong>are typically seen on diascopy. Perforation of the cartilaginous septum may complicate the condition.</p>\n<p>Diagnosis is made by taking a biopsy of the lesion and performing a histopathological examination. As seen in other tuberculous lesions, <strong>granulomas </strong>with <strong>multinucleate giant cells</strong> and epithelioid cells can be found. Acanthosis and hyperkeratosis are also usually seen. However, <strong>caseation</strong> necrosis and acid-fast bacilli are usually <strong>not seen</strong>.</p>\n<p>Treatment is with a combination of anti-tubercular drugs usually for a period of 6 months.</p>\n<p>Other options:</p>\n<p>Option A- <em><strong>Mycobacterium leprae</strong> </em>causes leprosy which usually begins with excessive nasal discharge. The mucosa is initially red and congested, which eventually leads to crusting. Nodules on the septum may ulcerate, causing perforations. It can be diagnosed by histopathological examination of the nasal scrapings which show <strong>foamy histiocytes</strong> laden with acid-fast lepra bacilli, called <strong>lepra cells.&nbsp;</strong></p>\n<p>A patient with leprosy is shown below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1a924d3bc72940758670643d898f4cc4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/22301a6079cc45bbb29f1d3111bd2ee3x720x926.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/d8b0e9d828de44669e89fc108dc4c913x512x343.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9dfa25ffcf94451795200fb4cfdf7eecx512x399.PNG"
    ]
  },
  {
    "text": "Which of the following is incorrect regarding the needle shown below and the procedure it is used for?",
    "choices": [
      {
        "id": 1,
        "text": "It is used in obstetric anesthesia"
      },
      {
        "id": 2,
        "text": "It causes rapid onset of anesthesia within 1-2 minutes"
      },
      {
        "id": 3,
        "text": "It is used along with catheter for continuous infusions for pain management"
      },
      {
        "id": 4,
        "text": "The blunt tip needle prevents accidental dural puncture"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The image shown is the 18 G&nbsp;<strong>Tuohy needle,</strong>&nbsp;which is used in<strong> epidural anesthesia.</strong>&nbsp;It does <strong>not</strong> cause <strong>rapid onset</strong> of anesthesia<strong>, </strong>instead&nbsp;has a <strong>slower onset</strong> of action ranging from 10-20 minutes compared to spinal anesthesia which has a relatively faster onset of action.</p>\n<p><strong>Identification points:</strong></p>\n<ul>\n<li>It has a <strong>blunt, curved tip (Huber tip)</strong>&nbsp;that helps to <strong>prevent accidental dural puncture</strong>.</li>\n<li>The needle shaft is marked in <strong>1-cm intervals</strong> so that the depth of insertion can be identified.</li>\n</ul>\n<p>It is used in<strong> obstetric anesthesia</strong>, segmental blocks, and chronic pain management.</p>\n<p>Image below shows epidural anesthesia set with Touhy's needle and epidural catheter:</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/1a0fdcb1284845a2bd47a9104c6d9dc0.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ff6672d030d44312ae594220cddd9915x800x600.JPEG"
    ]
  },
  {
    "text": "The given image shows the progression from stage 1 to stage 3 of a dermatological disease in a female child. This disease is also associated with dental abnormalities, onychodystrophy, ocular, and neurological abnormalities. It is caused by mutations of the IKBKG gene. What is the inheritance pattern seen in this disease?",
    "choices": [
      {
        "id": 1,
        "text": "Autosomal dominant"
      },
      {
        "id": 2,
        "text": "X-linked recessive"
      },
      {
        "id": 3,
        "text": "X-linked dominant"
      },
      {
        "id": 4,
        "text": "Autosomal recessive"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The clinical images of stages 1 and 3 of the disease, along with <strong>dental abnormalities, onychodystrophy, ocular,</strong> and <strong>neurological abnormalities</strong> due to mutations in the <strong>IKBKG gene</strong> is suggestive of <strong>incontinentia pigmenti</strong>.<strong>\u00a0</strong>The pattern of inheritance\u00a0is an\u00a0<strong>X-linked dominant inheritance.</strong></p>\n<p>Incontentia pigmenti manifests as a\u00a0<strong>multisystemic ectodermal dysplasia</strong>\u00a0that is usually <strong>lethal in males</strong>. It presents in <strong>females</strong> with skin lesions, dental abnormalities, alopecia, onychodystrophy, ocular, and neurological findings. It is associated with defects in the <strong>IKBKG gene</strong>.\u00a0The lesions can be described in 4 distinct stages, which are:</p>\n<ul>\n<li>Stage 1 - Erythematous vesicular rash</li>\n<li>Stage 2 - Verrucous lesions</li>\n<li>Stage 3 - Hyperpigmented streaks and whorls\u00a0</li>\n<li>Stage 4 -\u00a0Atrophic linear streaks or patches\u00a0</li>\n</ul>\n<p>The images below show stage 1 lesions and stage 3 lesions along the lines of Blaschko respectively.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/31edc98594fb4c9ab5616be443ff6c6c.PNG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/13bf6e5ae06f4a53a08f7fa133ef478ex1225x2058.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9ce151a2dee6423483304b1e2fdaf5d9x1200x1654.JPEG"
    ]
  },
  {
    "text": "A 9-year-old boy who was treated with chemotherapy for a juvenile pilocytic astrocytoma of the optic chiasma presented with the following eye finding. What is the diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Von Recklinghausen disease"
      },
      {
        "id": 2,
        "text": "Von Hippel Lindau syndrome"
      },
      {
        "id": 3,
        "text": "Tuberous sclerosis"
      },
      {
        "id": 4,
        "text": "Sturge Weber syndrome"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The image above shows <strong>Lisch nodules</strong> of the iris, which is a sign suggestive of <strong>von Recklinghausen disease</strong> or <strong>neurofibromatosis type 1</strong>. Astrocytomas frequently occur with neurofibromatosis type I.</p>\n<p>Lisch nodules are hamartomas that appear as tiny nodular pigmented lesions which protrude above the surface of the iris.</p>\n<p>Ocular manifestations of neurofibromatosis type 1:</p>\n<ul>\n<li><strong>Eyelid plexiform neurofibroma</strong> gives a characteristic S-shaped deformity of the upper lid. It is texturally reminiscent of a \"bag of worms.\"</li>\n<li><strong>Optic nerve glioma</strong>, a pilocytic astrocytoma, typically occurs in young children.</li>\n<li>Bilateral <strong>Lisch nodules</strong></li>\n<li>Congenital ectropion uveae</li>\n<li>Prominent corneal nerves</li>\n<li>Congenital glaucoma</li>\n<li>Spheno-orbital encephalocele, due to dysplasia of the greater wing of the sphenoid</li>\n</ul>\n<p>The ocular manifestations of <strong>neurofibromatosis type 2 </strong>are <strong>p</strong><strong>osterior subcapsular cataracts </strong>and<strong>\u00a0</strong>hamartomas of the retinal pigment epithelium and retina.</p>\n<p>Other options:</p>\n<p>Option B- The ocular manifestations of<strong> Von Hippel\u2013Lindau syndrome\u00a0</strong>are\u00a0retinal <strong>hemangiomas\u00a0</strong>and optic nerve haemangiomas.</p>\n<p>Option C- The ocular manifestations of <strong>tuberous sclerosis\u00a0</strong>are a<span style=\"font-size: 14px;\">typical </span><span style=\"font-size: 14px;\">iris coloboma, <strong>i</strong></span><strong>ris hypopigmentation,</strong> and retinal astrocytoma.</p>\n<p>Option D- The ocular manifestations of <strong>Sturge\u2013Weber syndrome\u00a0</strong>are choroidal hemangioma, <strong>i</strong><strong>ris heterochromia, </strong>ipsilateral glaucoma.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/7c293b652239429b8a3fce33fd2f2e44.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "A test for reducing sugars is being performed on several urine samples. The reagent used for this test consists of all of the following, except ________.",
    "choices": [
      {
        "id": 1,
        "text": "Sodium carbonate"
      },
      {
        "id": 2,
        "text": "Sodium citrate"
      },
      {
        "id": 3,
        "text": "Sodium hydroxide"
      },
      {
        "id": 4,
        "text": "Copper sulphate"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The test being performed is\u00a0<strong>Benedict's test </strong>and Benedict's reagent contains all the above contents, except sodium hydroxide.</p>\n<p>Benedict\u2019s test is used to detect<strong> reducing sugars</strong>. It tests positive for all monosaccharides and<strong> </strong>most<strong> </strong>disaccharides <strong>except sucrose.</strong></p>\n<p>Composition of Benedict\u2019s reagent:</p>\n<ul>\n<li><strong>Copper sulfate-</strong> provides the source of cupric (Cu2+) ions</li>\n<li><strong>Sodium citrate-</strong> complexes with cupric (Cu2+) ions to prevent its deterioration to cuprous ions spontaneously</li>\n<li><strong>Sodium carbonate- </strong>provides an alkaline pH</li>\n</ul>\n<p><strong>Principle:</strong> All monosaccharides and reducing disaccharides contain a <strong>free functional</strong> <strong>aldehyde</strong> or <strong>ketone</strong> group. When heated in the presence of an alkali, they are converted<strong> </strong>to<strong> enediols</strong>, which <strong>reduce</strong> the<strong> cupric</strong> <strong>compounds</strong> <strong>(Cu<sup>2+</sup>)</strong> present in Benedict's reagent to<strong> </strong>an<strong> insoluble precipitate </strong>of<strong> red cuprous oxide (Cu<sub>2</sub>O).</strong></p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/c582f7247e034157ab13f93491b0d84a.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/2fd0524e3106488aa3579f38662cc803x1280x1957.JPEG"
    ]
  },
  {
    "text": "A 20-year-old male patient was brought to casualty in an unconscious state after a head injury. What is the name of the sign seen in this image?",
    "choices": [
      {
        "id": 1,
        "text": "Duret hemorrhage"
      },
      {
        "id": 2,
        "text": "Kernohan\u2019s phenomenon"
      },
      {
        "id": 3,
        "text": "Battle sign"
      },
      {
        "id": 4,
        "text": "Raccoon sign"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The sign seen in the image is the\u00a0<strong>battle sign</strong> i.e. a skull base fracture associated with <strong>bruising</strong> over the<strong> mastoid process.</strong></p>\n<p><strong>Skull base fractures</strong>\u00a0are associated with:</p>\n<ul>\n<li>CSF otorrhea or rhinorrhea</li>\n<li>Hemotympanum</li>\n<li>Tympanic membrane rupture</li>\n<li><strong>Battle sign: Bruising or ecchymosis behind the ear</strong></li>\n<li>7th and 8th cranial nerve palsies</li>\n</ul>\n<p>Other options:</p>\n<p>Option A<strong>-Duret hemorrhages\u00a0</strong>are delayed secondary <strong>brainstem hemorrhages</strong>. They occur in craniocerebral trauma victims with rapidly evolving descending transtentorial herniation. They are typically located in the ventral and paramedian aspects of the upper brainstem.</p>\n<p>Option B-\u00a0<strong>Kernohan phenomenon\u00a0</strong>is an imaging finding resulting from extensive midline shift due to mass effect, resulting in an <strong>indentation </strong>in the<strong> contralateral cerebral crus</strong> by the tentorium cerebelli.\u00a0</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/2f33030c142241beb70191214522fef4.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c9b4b5a40aa346cc9d03c56a466e1568x600x452.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/06c0d5740fe84bad911d73d7074b0478x1280x953.JPEG"
    ]
  },
  {
    "text": "Identify the instrument shown in the image and the site at which it is used for taking samples.",
    "choices": [
      {
        "id": 1,
        "text": "Ayre's spatula used at the squamocolumnar junction"
      },
      {
        "id": 2,
        "text": "Ayre's spatula used at the endocervix"
      },
      {
        "id": 3,
        "text": "Cytobrush used at the endocervix"
      },
      {
        "id": 4,
        "text": "Cytobrush used at the squamocolumnar junction"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The instrument in the given image is a\u00a0<strong>cytobrush</strong> which is used to take samples from the <strong>endocervix </strong>for<strong>\u00a0</strong>a<strong> Pap smear</strong>.\u00a0<strong>Ayre\u2019s spatula</strong> is used to take samples from\u00a0the <strong>squamocolumnar junction</strong>.</p>\n<p>The instruments used for a pap smear are summarized in the image below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ed1551c09eb04e89839305de3dee3e1b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/99726eb5aa7043c9bbf1fc7687c260e1x1280x4698.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9e86b6ffcf38479392619e6daa03fd1ax1280x4766.JPEG"
    ]
  },
  {
    "text": "A concerned mother rushes to the OPD with her 4-day-old infant and worriedly points to the rash that appears as shown below.  Microscopic examination of this lesion revealed neutrophils. You reassure her of its harmless, transient nature.  Which of the following is the most probable diagnosis?",
    "choices": [
      {
        "id": 1,
        "text": "Pustular melanosis"
      },
      {
        "id": 2,
        "text": "Mongolian spots"
      },
      {
        "id": 3,
        "text": "Erythema toxicum"
      },
      {
        "id": 4,
        "text": "Cutis marmorata"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above image showing multiple&nbsp;<strong>vesiculopustular lesions</strong> distributed over the arms of a newborn, with the presence of <strong>neutrophils</strong> on microscopic examination is suggestive of <strong>transient pustular melanosis</strong>.</p>\n<p>Transient pustular melanosis&nbsp;is a benign condition seen more commonly among African-American&nbsp;neonates than Caucasian&nbsp;neonates. They present at birth as a <strong>vesiculopustular eruption</strong> around the chin, neck, back, extremities, and palms or soles. The pustular phase lasts for <strong>2-3 days</strong> and no therapy is required. However, the subsequent hyperpigmented macules may last for up to 3 months.</p>\n<p>Samples from the lesion can be <strong>cultured and smears</strong> can be prepared. They<strong> contain neutrophils</strong>&nbsp;and will <strong>not contain bacteria</strong> or aggregates of eosinophils. This distinguishes these lesions from those of pyoderma and erythema toxicum respectively. More dangerous lesions like the vesicular eruptions of herpes simplex and staphylococcal skin infections need to be ruled out by appropriate testing.&nbsp;</p>\n<p>Other options:</p>\n<p>Option B -&nbsp;<strong>Mongolian spots&nbsp;</strong>are&nbsp;slate-blue, demarcated areas of <strong>pigmentation</strong> seen over the buttocks and back.&nbsp;This is also called <strong>dermal melanocytosis.</strong>&nbsp;</p>\n<p>Option C -&nbsp;<strong>Erythema toxicum&nbsp;</strong>is another transient condition characterized by&nbsp;small white papules on an<strong> erythematous base</strong>, which are usually present on the face, trunk,&nbsp;and extremities. They&nbsp;<strong>contain eosinophils</strong>&nbsp;and may persist for a week.</p>\n<p>Option D - <strong>Cutis marmorata</strong> is a transient <strong>lacy reticular vascular pattern</strong> of the skin caused due to exaggerated physiologic vasomotor response on exposure to low environmental temperature.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/4134141fe0cb492da1db3ff6986eb7c0.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "Which of the following retractors is usually used in a Caesarian section?",
    "choices": [
      {
        "id": 1,
        "text": "1"
      },
      {
        "id": 2,
        "text": "2"
      },
      {
        "id": 3,
        "text": "4"
      },
      {
        "id": 4,
        "text": "3"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The retractor usually used in a <strong>Cesarian section</strong> is image 2, which is\u00a0<strong>Doyen's retractor</strong>.</p>\n<p><strong>Doyen's retractor</strong>\u00a0is used to retract the abdominal wall as well as the bladder for proper exposure of the lower uterine segment during <strong>Cesarian</strong> sections. It is shown in the image below.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/680c6b866dee464d832408ddf009295b.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f78e5b965b3346c0b4170159ae06f61cx1279x1116.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6fa6f557589943d5980856b9fb36859fx1279x1022.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/14edbbd2fd764e13a28f2a6f1472a6ffx1279x745.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/03ea82932e434fbb9dda901ea7c24258x1280x1065.JPEG"
    ]
  },
  {
    "text": "According to the National Immunization Schedule, what is the dose of vitamin A that should be administered with the first dose of the vaccine shown in the image?",
    "choices": [
      {
        "id": 1,
        "text": "1.5 lakh IU"
      },
      {
        "id": 2,
        "text": "0.5 lakh IU"
      },
      {
        "id": 3,
        "text": "1 lakh IU"
      },
      {
        "id": 4,
        "text": "2 lakh IU"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>According to the national immunization schedule, <strong>1 lakh IU </strong>of <strong>vitamin A</strong> should be given orally along with the first dose of the <strong>measles-rubella</strong>\u00a0vaccine, which is shown in the image.</p>\n<p>The\u00a0first dose of the vaccine is given at <strong>9</strong>\u00a0<strong>months</strong> of age. It can be given up to a <strong>maximum age</strong> of <strong>5 years</strong>. It is given along with the measles vaccine as it <strong>enhances antibody production</strong> and confers sustained immunity against measles.</p>\n<p>Vitamin A deficiency arises mostly due to its inadequate amounts in the diet. It can present as\u00a0<strong>night blindness</strong>, conjunctival xerosis, Bitot's spots, and\u00a0<strong>keratomalacia</strong>. At later stages, it can lead to\u00a0<strong>xerophthalmia</strong>.</p>\n<p>The image below shows Bitot's spots.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ac16aa6a55e04dc38a32ab33356a2159.JPEG"
    ],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/c175e532a7f64b8ba5c826f56d20ec18x720x561.PNG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f4468d9d53ae44a1b1a8e4a3d9ac50a7x720x434.PNG"
    ]
  },
  {
    "text": "A 42-year-old male patient was brought to the emergency department after a road traffic accident. He underwent immediate amputation surgery of the left lower limb. The postoperative day 2 image is given below. What is the most likely change in peripheral vascular resistance following this surgery?",
    "choices": [
      {
        "id": 1,
        "text": "Peripheral vascular resistance increases"
      },
      {
        "id": 2,
        "text": "Peripheral vascular resistance decreases"
      },
      {
        "id": 3,
        "text": "Peripheral vascular resistance is the same"
      },
      {
        "id": 4,
        "text": "Peripheral vascular resistance cannot be calculated"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The above-given image shows a post-lower limb <strong>amputation</strong> and the <strong>peripheral vascular resistance increases</strong> after amputation.</p>\n<p>The brain, kidney, muscle, gastrointestinal, skin, and coronary circulations are arranged in parallel circuits. Each tissue contributes to the overall conductance of the systemic circulation. Blood flow through each tissue is a fraction of the cardiac output. It is determined by the resistance and the pressure gradient. Resistance is the reciprocal of conductance.</p>\n<p><strong>Amputation</strong> of a limb or surgical removal of an organ <strong>removes a parallel circuit</strong>. This <strong>reduces</strong> systemic <strong>conductance</strong>&nbsp;and therefore <strong>increases</strong> the <strong>total peripheral vascular resistance.</strong></p>\n<p>Vascular resistance refers to the hindrance to blood flow in vessels. It can be calculated from measurements of blood flow and the pressure difference between two points in a vessel. Blood vessels branch widely to form <strong>parallel circuits</strong> that supply blood to many organs and tissues of the body. This arrangement permits each tissue to regulate its own blood flow. The total resistance of blood flow is calculated as <strong>1/R<sub>total </sub>= 1/R<sub>1</sub> + 1/R<sub>2</sub> + 1/R<sub>3</sub></strong></p>\n<p>The<strong> total resistance</strong> of the <strong>parallel circuit</strong> will be <strong>much less</strong> <strong>than</strong> that of any <strong>individual blood vessel</strong>. An increase in the resistance of any blood vessel in the parallel circuit will increase the total vascular resistance.</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/deb5c6c7862f4029a60f7bafb72e333e.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "What is false about the condition, that is relieved by the technique shown in the picture?",
    "choices": [
      {
        "id": 1,
        "text": "Associated with carpopedal spasms"
      },
      {
        "id": 2,
        "text": "Leads to paresthesias and numbness"
      },
      {
        "id": 3,
        "text": "Symptoms are due to hypercapnia"
      },
      {
        "id": 4,
        "text": "Presence of a frequent sighing during history taking"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The technique shown in the above image is of '<strong>breathing in a bag' technique</strong>. It relieves <strong>hypocapnia</strong> in hyperventilation syndrome.</p>\n<p>Hyperventilation syndrome is a&nbsp;habit of <strong>hyperventilation</strong> due to stress or any emotional upheaval.</p>\n<p>Symptoms occur due to&nbsp;<strong>hypocapnia/hypocarbia</strong>&nbsp;due to carbon dioxide washout:</p>\n<ul>\n<li>Fatigue, dizziness, headache</li>\n<li>Chest pain, palpitations, sweating</li>\n<li>If severe - carpopedal spasms, paraesthesias, and loss of consciousness may occur. Acute hypocarbia causes respiratory alkalosis and reduced ionized calcium, resulting in <strong>hypocalcemic</strong> symptoms.</li>\n</ul>\n<p>The patient has a&nbsp;typical history of stress followed by symptoms and&nbsp;<strong>frequently 'sighs'</strong> during the interview.</p>\n<p>Treatment for <strong>hyperventilation-associated hypocapnia</strong> is breathing in a bag.&nbsp;The patient is told to breathe in and out of a bag so that they <strong>rebreathe the expired air</strong>. This <strong>increases</strong> the levels of arterial <strong>CO2</strong> and quickly reverts the symptoms.</p>",
    "explanation_video": "",
    "question_images": [
      "https://daily-rounds-staging.s3.amazonaws.com/uploads/7988364af7f14e14acc14b174ef089b2.JPEG"
    ],
    "explanation_images": []
  },
  {
    "text": "The image below shows the peripheral blood smear of an anemic patient showing characteristic findings. Which of the following options best explains the pathophysiology of the condition in which these findings are seen?",
    "choices": [
      {
        "id": 1,
        "text": "Defective globin synthesis"
      },
      {
        "id": 2,
        "text": "Impairment of DNA synthesis"
      },
      {
        "id": 3,
        "text": "Increased destruction of red blood cells"
      },
      {
        "id": 4,
        "text": "Reduced erythropoietin production"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The peripheral smear shows<strong>&nbsp;macro-ovalocytes </strong>and<strong> hypersegmented neutrophils </strong>which&nbsp;are suggestive of <strong>m</strong><strong>egaloblastic</strong> anemia. Among the given options,&nbsp;<strong>impairment of DNA synthesis</strong>&nbsp;best explains the pathophysiology of megaloblastic anemia.</p>\n<p>Megaloblastic anemia may be caused by<strong>&nbsp;</strong>vitamin B12 deficiency or folic acid deficiency.&nbsp;</p>\n<p>Cyanocobalamin (vitamin B12) and folic acid are co-factors required for DNA synthesis. Thus, in B12 deficiency there is impairment of DNA synthesis that leads to defective nuclear maturation, ineffective hematopoiesis, and distinctive morphologic changes. These include abnormally large erythroid precursors and red cells.&nbsp;</p>\n<p>Peripheral smears in megaloblastic anemia show<strong>&nbsp;hypersegmented neutrophils,</strong> with<strong> five or more </strong>nuclear lobules instead of the <strong>normal three to four.</strong></p>\n<p>&nbsp;<strong>Peripheral smear</strong>:</p>\n<ul>\n<li><strong>Macro-ovalocytes</strong></li>\n<li>Macrocytes may even appear hyperchromic, but the <strong>MCHC is not elevated</strong></li>\n<li><strong>The reticulocyte count is low</strong></li>\n<li>Occasional nucleated red cell progenitors &nbsp;</li>\n<li><strong>Hypersegmented neutrophils,</strong> with<strong> five or more </strong>nuclear lobules instead of the <strong>normal three to four.</strong></li>\n</ul>\n<p><strong>Marrow</strong>:</p>\n<ul>\n<li>Markedly&nbsp;<strong>hypercellular</strong>&nbsp;due to increased hematopoietic precursors.</li>\n<li>Fine nuclear chromatin pattern of immature precursors (<strong>megaloblasts</strong>)</li>\n<li>Granulocytic precursors also display dysmaturation in the form of&nbsp;<strong>giant metamyelocytes and band forms.</strong></li>\n<li>Megakaryocytes can be abnormally large and have bizarre, multilobate nuclei.</li>\n<li>The derangement in DNA synthesis causes most precursors to undergo apoptosis in the marrow (<strong>ineffective hematopoiesis) </strong>and leads to<strong> pancytopenia.</strong></li>\n</ul>\n<p>Option A- Defective <strong>globin</strong> synthesis causes <strong>thalassemias</strong>. The peripheral smear shows <strong>microcytic, hypochromic anemia,</strong> and nucleated red blood cells. Marked <strong>anisopoikilocytosis </strong>is seen.<strong> Target cells</strong> that have an accumulation of hemoglobin in the center are seen. <strong>Basophilic stippling</strong>, fragmented red cells, nucleated red cells, and mild reticulocytosis are also seen.</p>\n<p>Option C- <strong>Increased destruction</strong> of red blood cells causes <strong>hemolytic anemias</strong>. The peripheral smear findings vary depending on the cause.</p>\n<p>Option D- Anemia due to <strong>reduced erythropoietin</strong> production is seen in <strong>chronic inflammation</strong>. The peripheral smear shows either <strong>normocytic, normochromic</strong>&nbsp;anemia or <strong>microcytic, hypochromic</strong> anemia as in iron deficiency.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [
      "https://cdn1.dailyrounds.org/uploads/ade7e9c740d4420f94678619ab00c04f.JPEG"
    ],
    "explanation_images": []
  }
];
        let quizName = 'Mini Test 9- Image Based Only';
        let hierarchy = ["Marrow", "NEET PG Mini Test Series", "2021-22"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        const urlParams = new URLSearchParams(window.location.search);
        currentQuestionIndex = Math.min(parseInt(urlParams.get('startAt')) || 0, questionsData.length - 1);

        function goBack() {
            if (isQuizCompleted || confirm('Are you sure you want to leave the quiz? Your progress will be lost.')) {
                window.history.back();
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                setTimeout(processAnswer, 300);
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            setTimeout(showSolution, 1500);
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (!window.location.pathname.endsWith('custom_quiz.html')) {
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>