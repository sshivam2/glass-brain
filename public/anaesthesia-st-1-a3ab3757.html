<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anaesthesia St 1 - Brain And Scalpel</title>
    <link rel="preload" href="assets/background.jpg" as="image">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- HLS.js for M3U8 support -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        
/* Liquid Glass Morphism Universal Theme - Enhanced & Mobile-First */
:root {
  --glass-bg: rgba(0, 0, 0, 0.6);
  --glass-bg-light: rgba(255, 255, 255, 0.1);
  --glass-bg-medium: rgba(255, 255, 255, 0.15);
  --glass-bg-heavy: rgba(255, 255, 255, 0.2);
  --glass-border: rgba(255, 255, 255, 0.2);
  --glass-border-light: rgba(255, 255, 255, 0.1);
  --text-primary: rgba(255, 255, 255, 0.95);
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-tertiary: rgba(255, 255, 255, 0.5);
  --accent-blue: #60a5fa;
  --accent-purple: #a855f7;
  --accent-green: #34d399;
  --accent-orange: #fb923c;
  --accent-red: #f87171;
  --accent-yellow: #fbbf24;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: relative;
  overflow-x: hidden;
  color: var(--text-primary);
  background-color: #000;
}

/* iOS Background Fix */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  z-index: -2;
  background: url("assets/background.jpg") center center / cover no-repeat;
}

body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: -1;
}

/* Glass morphism components */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-light {
  background: var(--glass-bg-light);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border-light);
  border-radius: 12px;
}

.glass-medium {
  background: var(--glass-bg-medium);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
}

.glass-heavy {
  background: var(--glass-bg-heavy);
  backdrop-filter: blur(25px);
  -webkit-backdrop-filter: blur(25px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
}

.glass-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.glass-card:hover {
  transform: translateY(-8px);
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.glass-button {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(168, 85, 247, 0.8));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: white;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(96, 165, 250, 0.3);
  cursor: pointer;
  border: none;
}

.glass-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(96, 165, 250, 0.4);
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(168, 85, 247, 0.9));
}

.glass-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.glass-input {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.glass-input:focus {
  outline: none;
  border-color: var(--accent-blue);
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
}

.glass-input::placeholder {
  color: var(--text-tertiary);
}

/* Performance analysis styles */
.performance-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.score-circle {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.score-circle svg {
  transform: rotate(-90deg);
}

.score-circle .circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 8;
}

.score-circle .circle-progress {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  transition: stroke-dasharray 2s cubic-bezier(0.4, 0, 0.2, 1);
}

.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

/* Review question styles */
.review-question {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.review-question.correct {
  border-left: 4px solid #22c55e;
}

.review-question.incorrect {
  border-left: 4px solid #ef4444;
}

.review-question.not-attempted {
  border-left: 4px solid #6b7280;
}

/* Gradient backgrounds for accents */
.gradient-blue {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
}

.gradient-purple {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
}

.gradient-green {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
}

.gradient-orange {
  background: linear-gradient(135deg, var(--accent-orange), #f97316);
}

.gradient-red {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
}

.gradient-yellow {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
}

/* Navigation button styles */
.nav-btn-not-attempted {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.7);
}

.nav-btn-current {
  background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
}

.nav-btn-correct {
  background: linear-gradient(135deg, var(--accent-green), #10b981);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-incorrect {
  background: linear-gradient(135deg, var(--accent-red), #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-bookmarked {
  background: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-marked-review {
  background: linear-gradient(135deg, var(--accent-purple), #8b5cf6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

.nav-btn-answered {
  background: linear-gradient(135deg, #6b7280, #4b5563);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
}

/* Option button styles - REVISED FOR INLINE FEEDBACK */
.option-button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  width: 100%;
  text-align: left;
  padding: 1rem;
  border-radius: 12px;
  color: var(--text-primary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.option-button:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(96, 165, 250, 0.5);
  transform: translateX(8px);
}

.option-button.selected {
  background: linear-gradient(135deg, rgba(96, 165, 250, 0.3), rgba(59, 130, 246, 0.3));
  border-color: var(--accent-blue);
  transform: translateX(8px);
}

#optionsContainer.answered .option-button:hover {
    transform: translateX(0); /* Disable hover effect after answering */
}

#optionsContainer.answered .option-button {
    cursor: not-allowed;
    pointer-events: none;
}

#optionsContainer.answered .option-button:not(.correct):not(.incorrect) {
    opacity: 0.5;
}

.option-button.correct {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border-color: #22c55e;
    color: white;
    transform: translateX(0);
}

.option-button.incorrect {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: translateX(0);
}

.option-letter {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: var(--text-primary);
  flex-shrink: 0;
}

.option-button.selected .option-letter {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.option-button.correct .option-letter, .option-button.incorrect .option-letter {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
}

.option-text {
  flex: 1;
  font-size: 1rem;
  line-height: 1.5;
}

/* Stats bar responsive grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  align-items: center;
  justify-items: center;
}

@media (max-width: 768px) {
  .stats-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
 
  .stats-grid > div:nth-child(4),
  .stats-grid > div:nth-child(5) {
    grid-column: span 1;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
 
  .stats-grid > div:last-child {
    grid-column: span 2;
    justify-self: center;
  }
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(96, 165, 250, 0.3); }
  50% { box-shadow: 0 0 40px rgba(96, 165, 250, 0.6); }
}

@keyframes checkmark {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(180deg); }
  100% { transform: scale(1) rotate(360deg); }
}

@keyframes cross {
  0% { transform: scale(0) rotate(0deg); }
  50% { transform: scale(0.8) rotate(90deg); }
  100% { transform: scale(1) rotate(180deg); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-checkmark {
  animation: checkmark 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-cross {
  animation: cross 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* --- MOBILE RESPONSIVE STYLES --- */
.quiz-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

#mobile-nav-toggle {
    display: none; /* Hidden on desktop */
}

@media (min-width: 1024px) {
    .quiz-container {
        flex-direction: row;
        gap: 2rem;
    }
}

@media (max-width: 1023px) {
    .quiz-sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 10px 0px 30px rgba(0,0,0,0.5);
    }
    .quiz-sidebar.open {
        transform: translateX(0);
    }
    #mobile-nav-toggle {
        display: flex;
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 50;
    }
    .quiz-main-content {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .glass-card, .glass {
        border-radius: 16px;
    }
    h1 { font-size: 2.5rem; }
    #questionText { font-size: 1.125rem; }
    .controls-container {
        flex-direction: column;
        gap: 1rem;
    }
    .controls-container button {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <!-- Mode Selection Modal -->
    <div id="modeModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Choose Study Mode</h2>
            
            <div class="space-y-4">
                <button onclick="selectMode('study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Study Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Interactive learning with immediate feedback</p>
                        </div>
                        <div class="gradient-blue w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('test')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Test Mode</h3>
                            <p class="text-sm text-white text-opacity-70">Practice test with performance analysis at end</p>
                        </div>
                        <div class="gradient-purple w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_study')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Study</h3>
                            <p class="text-sm text-white text-opacity-70">Study with time pressure and immediate feedback</p>
                        </div>
                        <div class="gradient-green w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
                
                <button onclick="selectMode('timed_exam')" class="w-full text-left p-4 glass-light hover:bg-white hover:bg-opacity-10 transition-all duration-300 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold">Timed Exam</h3>
                            <p class="text-sm text-white text-opacity-70">Real exam simulation with strict timing</p>
                        </div>
                        <div class="gradient-red w-10 h-10 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performanceModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="glass-heavy p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-white">Performance Analysis</h2>
                <button onclick="closePerformanceModal()" class="glass-light p-2 rounded-lg text-white hover:bg-white hover:bg-opacity-20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Score Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="performance-card p-6 text-center">
                    <div class="score-circle mb-4">
                        <svg width="150" height="150" class="mx-auto">
                            <circle class="circle-bg" cx="75" cy="75" r="65"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="75" cy="75" r="65" stroke="#22c55e" stroke-dasharray="0 408"></circle>
                        </svg>
                        <div class="score-text">
                            <div class="text-3xl font-bold text-white" id="accuracyScore">0%</div>
                            <div class="text-sm text-white text-opacity-70">Accuracy</div>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Results Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Questions:</span>
                            <span class="text-white font-semibold" id="totalQuestionsResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-green-400">Correct:</span>
                            <span class="text-green-400 font-semibold" id="correctResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-red-400">Incorrect:</span>
                            <span class="text-red-400 font-semibold" id="incorrectResult">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Not Attempted:</span>
                            <span class="text-gray-400 font-semibold" id="notAttemptedResult">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="performance-card p-6">
                    <h3 class="text-lg font-bold text-white mb-4 text-center">Time Analysis</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Total Time:</span>
                            <span class="text-white font-semibold" id="totalTimeResult">0:00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-white text-opacity-70">Avg per Question:</span>
                            <span class="text-white font-semibold" id="avgTimeResult">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mb-8">
                <button onclick="reviewQuestions()" class="glass-button px-8 py-3 text-lg">
                    Review All Questions
                </button>
                <button onclick="retakeQuiz()" class="glass-light px-8 py-3 text-lg text-white hover:bg-white hover:bg-opacity-20">
                    Retake Quiz
                </button>
            </div>
            
            <!-- Question Review Section -->
            <div id="questionReviewSection" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6">Question Review</h3>
                <div id="reviewQuestionsContainer">
                    <!-- Review questions will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 mb-6">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="goBack()" class="glass-light px-4 py-2 text-white hover:bg-white hover:bg-opacity-20 transition-all duration-300 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                        </svg>
                        Back
                    </button>
                    <div id="quizHierarchy" class="text-sm text-white text-opacity-60">
                        Marrow / NEET PG Test Series Subject Wise / Year 2017 - 18
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="glass-light px-3 py-1 text-sm text-white">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">50</span>
                    </div>
                    
                    <!-- Timer -->
                    <div id="timerContainer" class="hidden gradient-red px-3 py-1 text-sm text-white font-bold animate-pulse-glow">
                        <span id="timeDisplay">2:00</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full h-1 bg-black bg-opacity-30 mb-6">
        <div id="progressBar" class="h-1 gradient-blue transition-all duration-500 ease-out" style="width: 0%"></div>
    </div>

    <!-- Stats Bar - Show only in study modes -->
    <div id="statsBar" class="glass-light mb-8">
        <div class="container mx-auto px-6 py-4">
            <div class="stats-grid">
                <div class="text-center">
                    <div class="text-lg font-bold text-green-400" id="correctCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Correct</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-red-400" id="incorrectCount">0</div>
                    <div class="text-xs text-white text-opacity-60">Incorrect</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-blue-400" id="totalAttempted">0</div>
                    <div class="text-xs text-white text-opacity-60">Attempted</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-purple-400" id="accuracy">0%</div>
                    <div class="text-xs text-white text-opacity-60">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-lg font-bold text-orange-400" id="timeSpent">0:00</div>
                    <div class="text-xs text-white text-opacity-60">Time</div>
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-container container mx-auto px-6">
        <!-- Question Navigation Sidebar -->
        <div id="quizSidebar" class="quiz-sidebar glass p-6 h-fit lg:sticky top-24">
            <h3 class="text-lg font-bold text-white mb-4">Question Navigator</h3>
            <div id="questionNav" class="grid grid-cols-5 gap-2 mb-6">
                <!-- Question numbers will be populated here -->
            </div>
            
            <div class="space-y-3 text-xs">
                <h4 class="text-sm font-medium text-white text-opacity-80 mb-3">Legend</h4>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-not-attempted rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Not Attempted</span>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-current rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Current</span>
                </div>
                <div id="studyModeLegend" class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-correct rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Correct</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-incorrect rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Incorrect</span>
                    </div>
                </div>
                <div id="testModeLegend" class="hidden space-y-2">
                    <div class="flex items-center">
                        <div class="w-6 h-6 nav-btn-answered rounded mr-2"></div>
                        <span class="text-white text-opacity-60">Answered</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-6 h-6 nav-btn-bookmarked rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Bookmarked</span>
                </div>
                <div id="testModeReviewLegend" class="hidden items-center">
                    <div class="w-6 h-6 nav-btn-marked-review rounded mr-2"></div>
                    <span class="text-white text-opacity-60">Marked for Review</span>
                </div>
            </div>
            
            <!-- Submit Quiz Button for test modes -->
            <div id="submitSection" class="hidden mt-6">
                <button onclick="submitQuiz()" class="glass-button w-full py-3 text-lg font-bold">
                    Submit Quiz
                </button>
            </div>
        </div>

        <!-- Main Quiz Interface -->
        <div class="quiz-main-content flex-1 max-w-4xl">
            <div class="glass-card p-4 md:p-8 lg:p-12 mb-8 relative">
                <!-- Question Text -->
                <div id="questionText" class="text-xl lg:text-2xl leading-relaxed text-white mb-8">
                    Loading question...
                </div>

                <!-- Question Media -->
                <div id="questionMedia" class="mb-8"></div>

                <!-- Options -->
                <div id="optionsContainer" class="space-y-3 mb-8">
                    <!-- Options will be inserted here -->
                </div>

                <!-- Solution Display (only for study modes) -->
                <div id="solutionContainer" class="hidden glass-light p-6 border-l-4 border-green-400">
                    <h3 class="text-lg font-bold text-green-400 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        Explanation
                    </h3>
                    <div id="solutionText" class="text-white text-opacity-90 leading-relaxed mb-4"></div>
                    <div id="solutionAudio" class="space-y-2 mt-4"></div>
                    <div id="solutionImages" class="space-y-4 mt-4"></div>
                    <div id="solutionVideo" class="hidden mt-4">
                        <video id="explanationVideoPlayer" class="w-full rounded-lg" controls>
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-container flex justify-between items-center mb-8">
                <button onclick="previousQuestion()" id="prevBtn" class="glass-button px-6 py-3 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Previous
                </button>
                
                <div class="flex justify-center flex-grow">
                    <button onclick="toggleBookmark()" id="bookmarkBtn" class="glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" id="bookmarkIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        <span id="bookmarkText">Bookmark</span>
                    </button>
                    
                    <button onclick="toggleMarkForReview()" id="markReviewBtn" class="hidden glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                           <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2H5zm0 2h10v12H5V4z" clip-rule="evenodd" />
                           <path d="M12.586 6.586a2 2 0 10-2.828 2.828l-3 3a2 2 0 102.828-2.828l3-3z" />
                        </svg>
                        <span id="markReviewText">Mark for Review</span>
                    </button>
                </div>
                
                <button onclick="nextQuestion()" class="glass-button px-6 py-3 flex items-center justify-center">
                    Next
                    <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

     <!-- Mobile Nav Toggle -->
    <button id="mobile-nav-toggle" onclick="toggleSidebar()" class="glass-button w-14 h-14 rounded-full items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>


    <script>
        let questionsData = [
  {
    "text": "The best circuit for controlled ventilation is:",
    "choices": [
      {
        "id": 1,
        "text": "Mapleson A"
      },
      {
        "id": 2,
        "text": "Mapleson C"
      },
      {
        "id": 3,
        "text": "Mapleson D"
      },
      {
        "id": 4,
        "text": "Mapleson E"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Mapleson circuit type D</strong> is the<strong> circuit of choice for controlled ventilation</strong> and <strong>it is the most commonly used circuit</strong>. This can also be used for spontaneous ventilation.</p>\n<p>In Mapleson circuits or<strong> semi-closed circuits</strong>, the exhaled gases from the patient are partly exhaled from the atmosphere and partly used by the patient.</p>\n<table style=\"width: 268px;\">\n<tbody>\n<tr>\n<td style=\"width: 95px;\"><strong>Mapleson Circuit type</strong>&nbsp;&nbsp;</td>\n<td style=\"width: 173px;\"><strong>Comments&nbsp;&nbsp;</strong></td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">Type A (Magill circuit)&nbsp;</td>\n<td style=\"width: 173px;\">Circuit of choice for spontaneous ventilation&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">Type B&nbsp;</td>\n<td style=\"width: 173px;\">It is a semi-closed circuit&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">Type C (Water's to and fro)&nbsp;</td>\n<td style=\"width: 173px;\">It is a coaxial system (fresh gas tube and exhaled gases are in same axis)&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">Type D (Bain circuit)&nbsp;</td>\n<td style=\"width: 173px;\">Circuit of choice for controlled ventilation. Most commonly used circuit .Can also be used for spontaneous ventilation&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">Type E (Ayre's&nbsp;T piece)&nbsp;</td>\n<td style=\"width: 173px;\">Circuit of 2nd&nbsp;choice in children&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 95px;\">Type F (Jackson-Rees circuit)&nbsp;</td>\n<td style=\"width: 173px;\">Circuit of choice in children&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The term \"balanced anaesthesia\" was coined by the same person who lobbied in 1939 to get anaesthesia recognized as a speciality by the American Medical Association. Who is this individual?",
    "choices": [
      {
        "id": 1,
        "text": "John Lundy"
      },
      {
        "id": 2,
        "text": "James Simpson"
      },
      {
        "id": 3,
        "text": "Edmund boyle"
      },
      {
        "id": 4,
        "text": "Oliver Wendell"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>John Lundy</strong> coined the term balanced anaesthesia in <strong>1926.</strong></p>\n<p>He was instrumental in the formation of the American Board of Anesthesiology and chaired the American Medical Association&rsquo;s Section on Anesthesiology for 17 years.</p>\n<p>Balanced anaesthesia&nbsp;involves the use of multiple anaesthetic agents and techniques to produce the different components of anaesthesia, i.e.:</p>\n<ul>\n<li>Analgesia</li>\n<li>Amnesia</li>\n<li>Muscle relaxation</li>\n<li>Abolition of autonomic reflexes</li>\n</ul>\n<p>Option B:<strong> James Young Simpson </strong>introduced chloroform</p>\n<p>Option C:<strong> Edmund Boyle&nbsp;</strong>invented the anaesthetic machine&nbsp;</p>\n<p>Option D:<strong> Oliver Wendell&nbsp;</strong>coined the term anaesthesia</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Anatomical dead space is increased by all except",
    "choices": [
      {
        "id": 1,
        "text": "Old age"
      },
      {
        "id": 2,
        "text": "Bronchoconstrictors"
      },
      {
        "id": 3,
        "text": "Increased lung volume"
      },
      {
        "id": 4,
        "text": "IPPV"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Anatomical dead space is increased by bronchodilators and it is decreased by bronchoconstriction.</p>\n<p>The main function of the respiratory system is gaseous exchange with pulmonary capillary bed(only the terminal part of airways). The <strong>space of respiratory system where gaseous exchange does not take place is dead space</strong>.</p>\n<ul>\n<li><strong>Anatomical dead space:</strong>&nbsp;gas in non-Respiratory airway i.e. nose, trachea, bronchial tree up to terminal bronchioles. Normally it is 30% of tidal volume or 150 mL.</li>\n<li><strong>Alveolar dead space:</strong> alveoli which are only ventilated but not perfused. It is 60-80 mL on standing and 0 mL on lying down (perfusion is equal in all parts of lung on lying down)</li>\n<li><strong>Physiological dead space </strong>= <strong>anatomical dead space + alveolar dead space</strong></li>\n</ul>\n<table style=\"width: 328px;\">\n<tbody>\n<tr>\n<td style=\"width: 76px;\"><strong>Anatomical dead space increased by&nbsp;</strong></td>\n<td style=\"width: 35px;\"><strong>Anatomical dead space decreased by</strong>&nbsp;</td>\n<td style=\"width: 215px;\"><strong>Alveolar dead space is increased by&nbsp;</strong></td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">Old age</td>\n<td style=\"width: 35px;\">Intubation&nbsp;&nbsp;</td>\n<td style=\"width: 215px;\">IPPV&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">Neck extension&nbsp;&nbsp;</td>\n<td style=\"width: 35px;\">Tracheostomy</td>\n<td style=\"width: 215px;\">PEEP&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">Jaw protrusion&nbsp;&nbsp;</td>\n<td style=\"width: 35px;\">Hyperventilation&nbsp;&nbsp;</td>\n<td style=\"width: 215px;\">General Anesthesia&nbsp;&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">Bronchodilators (atropine)&nbsp;</td>\n<td style=\"width: 35px;\">Neck flexion&nbsp;&nbsp;</td>\n<td style=\"width: 215px;\">Hypotension&nbsp;&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">Halothane&nbsp;&nbsp;</td>\n<td style=\"width: 35px;\">Bronchoconstrictors&nbsp;&nbsp;</td>\n<td style=\"width: 215px;\">Lung pathologies affecting diffusion (embolism, ILD)&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">Increased lung volume&nbsp;&nbsp;</td>\n<td style=\"width: 35px;\">Massive pleural effusion&nbsp;&nbsp;</td>\n<td style=\"width: 215px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">Anesthesia mask and circuits&nbsp;&nbsp;</td>\n<td style=\"width: 35px;\">&nbsp;</td>\n<td style=\"width: 215px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">IPPV&nbsp;</td>\n<td style=\"width: 35px;\">&nbsp;</td>\n<td style=\"width: 215px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 76px;\">PEEP&nbsp;</td>\n<td style=\"width: 35px;\">&nbsp;</td>\n<td style=\"width: 215px;\">&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Dissociative anaesthesia is characteristic of?",
    "choices": [
      {
        "id": 1,
        "text": "Nitrous oxide"
      },
      {
        "id": 2,
        "text": "Ketamine"
      },
      {
        "id": 3,
        "text": "Propofol"
      },
      {
        "id": 4,
        "text": "Thiopentone"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Ketamine&nbsp;causes Dissociative&nbsp;anaesthesia. The primary site of CNS action of ketamine seems to be the <strong>thalamoneocortical projection system</strong>.</p>\n<p><strong> Dissociative anaesthesia:</strong></p>\n<ul>\n<li>Ketamine functionally<strong> &ldquo;dissociates&rdquo; the thalamus from the limbic cortex</strong>.</li>\n</ul>\n<p>The drug selectively</p>\n<ul>\n<li><strong>Depresses</strong> parts of the <strong>cortex</strong> (especially association areas) and<strong> thalamus.</strong></li>\n<li><strong>Stimulates</strong> parts of the <strong>limbic system</strong>, including the hippocampus.</li>\n</ul>\n<p>This process creates what is termed a<strong> functional disorganization</strong> of nonspecific pathways in midbrain and thalamic areas.</p>\n<p>Clinically, this state of dissociative anesthesia may cause the patient to <strong>appear conscious but unable to process or respond to sensory input</strong>.</p>\n<p>Ketamine acts as a <strong>NMDA receptor antagonist</strong>.</p>\n<p><strong> Sites affected by Ketamine</strong> include those having high expression of NMDA receptor:</p>\n<ul>\n<li>Temporal cortex</li>\n<li>Hippocampus</li>\n<li>Basal ganglia</li>\n<li>Cerebellum</li>\n<li>Brainstem</li>\n</ul>\n<p>Ketamine<strong> prevents opioid-induced hyperalgesia</strong>.&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A child operated for bladder extrophy for renal failure. Anesthesia of choice is:",
    "choices": [
      {
        "id": 1,
        "text": "Atracurium"
      },
      {
        "id": 2,
        "text": "Rapacurium"
      },
      {
        "id": 3,
        "text": "Rocuronium"
      },
      {
        "id": 4,
        "text": "Vecuronium"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Always in <strong>renal or hepatic failure, </strong>the muscle relaxant of choice is <strong>atracurium</strong>.</p>\n<p>Dose: 0.5 mg/Kg. Duration of action: 15-20 min. t<sub>1/2</sub>: 20 min.</p>\n<p>It gets metabolized by <strong>Hoffman degradation</strong> in plasma (95%), ester hydrolysis (5%) and produces laudanosine which crosses BBB and may produce convulsions(Doubtful clinical significance).</p>\n<p>Atracurium <strong>releases histamine</strong>. Allergic reactions to Atracurium range from a pruritic rash to angioneurotic edema.</p>\n<p>It is a relaxant of choice in:</p>\n<ul>\n<li>Renal failure</li>\n<li>Hepatic failure</li>\n<li>Patients with atypical pseudocholinesterase</li>\n<li>Myasthenia gravis (1/10<sup>th</sup> of a normal dose)</li>\n<li>Small children</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Best indicator for potency of inhalational anaesthetic agent",
    "choices": [
      {
        "id": 1,
        "text": "Blood gas coefficient"
      },
      {
        "id": 2,
        "text": "Lipid solubility"
      },
      {
        "id": 3,
        "text": "Minimum Alveolar Concentration"
      },
      {
        "id": 4,
        "text": "Molecular weight"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Minimum Alveolar concentration</strong> is the best indicator of the potency of the inhalational anesthetic agent.</p>\n<p><strong> Definition:</strong></p>\n<ul>\n<li>It is the alveolar vapour phase concentration of an inhaled anesthetic agent that prevents movement in 50%of the patient in response to the standard noxious surgical incision.</li>\n<li>It <strong>mirrors Brain partial pressure</strong>.</li>\n<li>The absence of response to noxious stimuli is primarily mediated by the anaeshetic action on the spinal cord.</li>\n<li>MAC is expressed in terms of % of 1 atm.</li>\n</ul>\n<p><strong> Factors increasing MAC:</strong></p>\n<ul>\n<li>Young age</li>\n<li>Chronic alcohol abuse</li>\n<li>Hypernatremia</li>\n<li>Acute amphetamine, cocaine,&nbsp;and ephedrine abuse.</li>\n</ul>\n<p><strong> Factors that doesnot affect MAC include:</strong></p>\n<ul>\n<li>Gender</li>\n<li>Thyroid disorders</li>\n</ul>\n<p><strong> MAC value of anaesthetics:</strong></p>\n<ul>\n<li>Nitrous oxide- 104%</li>\n<li>Xenon- 73%</li>\n<li>Sevoflurane- 2.1%</li>\n<li>Enflurane- 1.68%</li>\n<li>Isoflurane- 1.15%</li>\n<li>Halothane- 0.74%</li>\n<li>Methoxyflurane- 0.16%</li>\n<li>Ether- 1.92%</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which blood component is associated with the maximum risk of bacterial contamination?",
    "choices": [
      {
        "id": 1,
        "text": "Packed red blood cells"
      },
      {
        "id": 2,
        "text": "Platelet concentrates"
      },
      {
        "id": 3,
        "text": "Fresh frozen plasma"
      },
      {
        "id": 4,
        "text": "Whole blood"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The blood component with a <strong>maximum risk </strong>of<strong> bacterial contamination</strong> is <strong>platelet concentrates</strong> as they are stored at room temperature of <strong>20&deg;C-24&deg;C</strong>. Hence, they are at maximum risk of bacterial overgrowth and consequent sepsis.</p>\n<p>With the incidence of 1 in 2000, any fever occurring within 6 hours of a platelet transfusion is likely to be sepsis from the use of stored platelets.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Sellick\u2019s maneuver is:",
    "choices": [
      {
        "id": 1,
        "text": "Cricoid pressure"
      },
      {
        "id": 2,
        "text": "Awake intubation"
      },
      {
        "id": 3,
        "text": "Monitoring PCWP"
      },
      {
        "id": 4,
        "text": "Vagal nerve block"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The <strong>Sellick maneuver is the eponym of Cricoid pressure</strong>.</p>\n<ul>\n<li>The&nbsp;Sellick&nbsp;maneuver consists of<strong> elevating the patient&rsquo;s chin</strong> (without displacing the cervical spine) and <strong>then pushing the cricoid cartilage posteriorly to close the esophagus</strong>.</li>\n<li>However, cricoids pressure may worsen the&nbsp;laryngoscopic&nbsp;grade of view in up to 30% of patients.</li>\n<li>Cricoid&nbsp;pressure reduces tidal volumes, increases peak&nbsp;inspiratory&nbsp;pressure or prevents ventilation.</li>\n<li>Cricoid&nbsp;pressure- the&nbsp;Sellick&nbsp;maneuver- has been recommended to be applied continuously during emergency airway management from the time the patient loses protective airway reflexes until&nbsp;endotracheal&nbsp;tube placement and cuff inflation are confirmed.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/9841c229eaf648de856b22a3a6de0887x512x316.PNG"
    ]
  },
  {
    "text": "Second gas effect is exerted by which of the following gas when co-administered with halothane?",
    "choices": [
      {
        "id": 1,
        "text": "Cyclopropane"
      },
      {
        "id": 2,
        "text": "Nitrous oxide"
      },
      {
        "id": 3,
        "text": "Nitrogen"
      },
      {
        "id": 4,
        "text": "Helium"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>The second gas effect is exerted by nitrous oxide when co-administered with halothane. </strong></p>\n<p>In the initial part of induction, diffusion gradient from alveoli to blood is high and larger quantity of anesthetic is entering blood. When inhaled concentration of anesthetic is high, it leads to removal of more gas from cylinder to alveoli.</p>\n<p>If another inhalation agent is being given at the same time, it will also be delivered to the lung from the cylinder. This is second gas effect and it is seen during induction.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Who was the first person to synthesize nitrous oxide?",
    "choices": [
      {
        "id": 1,
        "text": "Horace Wells"
      },
      {
        "id": 2,
        "text": "Joseph Priestley"
      },
      {
        "id": 3,
        "text": "Humphry Davy"
      },
      {
        "id": 4,
        "text": "William Morton"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Joseph Priestley</strong> first synthesized<strong> nitrous oxide </strong>in 1772.&nbsp;</p>\n<p>Joseph Priestley,<strong>&nbsp;</strong>an English chemist is well known for his experiments and observations on different kinds of air. He is most famously known for the discovery of \"<strong>dephlogisticated air</strong>,\" which was later named <strong>oxygen</strong> by Lavoisier.</p>\n<p><strong>Humphry Davy,</strong> in 1800, first noted the analgesic properties of nitrous oxide.&nbsp;</p>\n<p><strong>Horace Wells </strong>studied the&nbsp;analgesic properties of nitrous oxide and put into clinical use in 1844 for <strong>dental extraction</strong>&nbsp;but it was less potent than ether.</p>\n<p><strong>William Morton</strong>&nbsp;introduced ether anesthesia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are an intern posted for ICU duty, and you realise that the oxygen port is defective and not delivering the required oxygen for a patient. You rush to get an oxygen cylinder to attach to the oxygen mask of the patient . The color of oxygen cylinder that will help you identify it is",
    "choices": [
      {
        "id": 1,
        "text": "Black body with white shoulder"
      },
      {
        "id": 2,
        "text": "Blue body with white shoulder"
      },
      {
        "id": 3,
        "text": "Yellow"
      },
      {
        "id": 4,
        "text": "White"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>The color of an<strong>&nbsp;oxygen cylinder </strong>is<strong> black with white shoulder.</strong></p>\n<p><strong>Medical grade oxygen</strong> (99 to 99.5 %) is manufactured by distilling liquified air. It is stored in <strong>oxygen cylinders</strong> either in the form of <strong>compressed gas</strong> (at room temperature) or as<strong> liquid oxygen</strong> (at refrigeration temperature).&nbsp;</p>\n<p><strong>Gas cylinders</strong> are made from a steel alloy of molybdenum. Cylinders are available in different <strong>sizes</strong> from A to J :</p>\n<ul>\n<li>Size A is the smallest.</li>\n<li>Size H is the largest.</li>\n<li><strong>Size E</strong>&nbsp;is the cylinder&nbsp;<strong>most commonly used</strong>&nbsp;in anesthesia machines, for patient transport, and resuscitation, followed by Size D.&nbsp;</li>\n<li>Size J is commonly used for cylinder manifold systems for central supply.</li>\n</ul>\n<p>Cylinders of <strong>different gases</strong> have different color coding, PIN index, pressure and storage form. This is to prevent accidental misuse of gases and associated mortality. Below is an image of oxygen cylinder.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f3150abd690543efac90ff12cc5cfad9x800x600.JPEG"
    ]
  },
  {
    "text": "Total cerebral metabolic failure occurs at cerebral blood flow rate of:",
    "choices": [
      {
        "id": 1,
        "text": "<10 mL/ 100 g/ min"
      },
      {
        "id": 2,
        "text": "<15 mL/ 100 g/ min"
      },
      {
        "id": 3,
        "text": "15-20 mL/ 100 g/ min"
      },
      {
        "id": 4,
        "text": "25-30 mL/ 100 g/ min"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Flow rates</strong> below <strong>10 mL/ 100 g/ min leads to irreversible brain damage</strong>.</p>\n<p><strong> Cerebral</strong> Blood Flow<strong>:</strong></p>\n<ul>\n<li>Although total CBF averages 50&nbsp;mL/100 g/ min, <strong>flow in gray matter is about 80 mL/ 100 g/ min</strong>, whereas that in white matter is estimated to be 20&nbsp;mL/ 100 g/ min.</li>\n<li>Total CBF in adults averages <strong>750 mL/ min</strong> (15% to 20% of cardiac output).</li>\n</ul>\n<p><strong> Flow rates:</strong></p>\n<ul>\n<li>Below <strong>20-25 mL/100</strong> g/min- Cerebral impairment- <strong>slowing on the EEG</strong></li>\n<li>Between<strong> 15 and 20 mL/ 100 g/ min-</strong> produce a <strong>flat (isoelectric)EEG</strong></li>\n<li>Below <strong>10 mL/ 100 g/ min</strong>- <strong>irreversible brain damage</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "IV anesthetic used for day care surgery",
    "choices": [
      {
        "id": 1,
        "text": "Propofol"
      },
      {
        "id": 2,
        "text": "Ketamine"
      },
      {
        "id": 3,
        "text": "Thiopentone"
      },
      {
        "id": 4,
        "text": "Etomidate"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>IV Anesthetic of choice for day care surgery is propofol</strong> due to its smooth induction and rapid recovery. &nbsp;The antiemetic action is also beneficial.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a patient undergoing pulmonary artery catheterisation, which of the following would denote entry into the pulmonary artery?",
    "choices": [
      {
        "id": 1,
        "text": "Increase in systolic pressure"
      },
      {
        "id": 2,
        "text": "Decrease in systolic pressure"
      },
      {
        "id": 3,
        "text": "Increase in diastolic pressure"
      },
      {
        "id": 4,
        "text": "Decrease in diastolic pressure"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Entry into the pulmonary artery is indicated by an <strong>increase</strong> in<strong> diastolic pressure.</strong></p>\n<p>Pulmonary artery catheterization involves the use of<strong>\u00a0</strong>a<strong> Swan-Ganz catheter.</strong></p>\n<p>\u00a0</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the next line of management in a patient diagnosed with succinylcholine apnoea?",
    "choices": [
      {
        "id": 1,
        "text": "Increase the dose of succinylcholine"
      },
      {
        "id": 2,
        "text": "Administer neostigmine"
      },
      {
        "id": 3,
        "text": "Fresh frozen plasma transfusion"
      },
      {
        "id": 4,
        "text": "Continue mechanical ventilation"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p style=\"text-align: justify;\">The mainstay in the treatment of <strong>succinylcholine apnea</strong> due to atypical pseudocholinesterase is to&nbsp;<strong>continue mechanical ventilation </strong>until&nbsp;muscle function returns to normal by clinical signs.</p>\n<p style=\"text-align: justify;\">Option B: Administration of <strong>neostigmine</strong> is <strong>controversial</strong> as the effects may be transient, possibly followed by an intensified neuromuscular blockade.</p>\n<p style=\"text-align: justify;\">Option C: Fresh frozen plasma can augment the patient's endogenous plasma pseudocholinesterase activity but is not recommended because of the risk of iatrogenic viral infections.</p>\n<p style=\"text-align: justify;\">Note: If&nbsp;<strong>human plasma cholinesterase</strong>&nbsp;is available, it can be given to <strong>reverse neuromuscular blockade</strong>.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Anaesthetic agent that is contraindicated in pneumothorax?",
    "choices": [
      {
        "id": 1,
        "text": "Oxygen"
      },
      {
        "id": 2,
        "text": "Isoflurane"
      },
      {
        "id": 3,
        "text": "Nitrous oxide"
      },
      {
        "id": 4,
        "text": "Propofol"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Nitrous oxide</strong> is contraindicated in <strong>pneumothorax.</strong></p>\n<ul>\n<li>Although nitrous oxide is insoluble in comparison with other inhalation agents, it is 35 times more soluble than nitrogen in blood.</li>\n<li>Thus, <strong>it tends to diffuse into air-containing cavities more rapidly than nitrogen is absorbed by the bloodstream</strong>.</li>\n<li>Because nitrous oxide will diffuse into the cavity more rapidly than the air(principally&nbsp;nitrogen) diffuses out, the&nbsp;pneumothorax&nbsp;expands until it contains 100&nbsp;mL&nbsp;of air and 100&nbsp;mL&nbsp;of nitrous oxide.</li>\n<li>If the walls surrounding the cavity are rigid, <strong>pressure rises instead of volume</strong>.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "In a patient who is under anaesthesia, which is the most common method used to evaluate intraoperative awareness?",
    "choices": [
      {
        "id": 1,
        "text": "Capnography"
      },
      {
        "id": 2,
        "text": "EEG"
      },
      {
        "id": 3,
        "text": "Bispectral index"
      },
      {
        "id": 4,
        "text": "Transesophageal echocardiography"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>The <strong>bispectral index</strong> (BIS) is the most commonly used method, which helps to monitor the <strong>depth of anaesthesia </strong>and <strong>intraoperative awareness.</strong></p>\n<p>It processes the EEG and provides an index value between<strong> 0 and 100</strong> that indicates the patient&rsquo;s level of consciousness.</p>\n<p style=\"text-align: justify;\">BIS index range:&nbsp;</p>\n<ul>\n<li style=\"text-align: justify;\">100&ndash; Awake (Response to normal voice)</li>\n<li style=\"text-align: justify;\">65-85- Sedation</li>\n<li style=\"text-align: justify;\">40-65- General anaesthesia</li>\n<li style=\"text-align: justify;\">&lt; 40 - Cortical suppression</li>\n<li style=\"text-align: justify;\">0- Flatline EEG (Deep coma)</li>\n</ul>\n<p>Recommended range of BIS index values for anaesthesia- <strong>40-60.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is a shockable rhythm?",
    "choices": [
      {
        "id": 1,
        "text": "Ventricular fibrillation"
      },
      {
        "id": 2,
        "text": "Pulseless electrical activity"
      },
      {
        "id": 3,
        "text": "Asystole"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Shockable rhythms</strong> of cardiac arrest include:</p>\n<ul>\n<li>Pulseless ventricular tachycardia</li>\n<li>Ventricular fibrillation</li>\n</ul>\n<p><strong>Non-shockable rhythms</strong> of cardiac arrest include:</p>\n<ul>\n<li>Pulseless electrical activity (PEA)</li>\n<li>Asystole</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following inhalation agents is the best uterine relaxant?",
    "choices": [
      {
        "id": 1,
        "text": "Halothane"
      },
      {
        "id": 2,
        "text": "Isoflurane"
      },
      {
        "id": 3,
        "text": "Sevoflurane"
      },
      {
        "id": 4,
        "text": "Desflurane"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong> Halothane causes uterine relaxation</strong>.</p>\n<ul>\n<li>It is the agent of choice for assisting external or internal version during pregnancy.</li>\n<li><strong> Contraindicated during labour</strong> because Post Partum Hemorrhage (PPH) can occur.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Tracheostomy reduces anatomical dead space by:",
    "choices": [
      {
        "id": 1,
        "text": "Bypassing upper airway"
      },
      {
        "id": 2,
        "text": "Increasing the V/Q ratio"
      },
      {
        "id": 3,
        "text": "Increasing airflow resistance"
      },
      {
        "id": 4,
        "text": "All the above"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Tracheostomy&nbsp;decreases dead space by<strong> bypassing the upper airways</strong>.</p>\n<p>Tracheostomy&nbsp;also decreases the V/Q ratio.</p>\n<p>It also&nbsp;reduces airflow resistance.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "PIN index for Nitrous oxide is:",
    "choices": [
      {
        "id": 1,
        "text": "1, 5"
      },
      {
        "id": 2,
        "text": "2, 5"
      },
      {
        "id": 3,
        "text": "1, 6"
      },
      {
        "id": 4,
        "text": "3, 5"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The PIN Index for N<sub>2</sub>O is 3, 5.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following is least metabolized?",
    "choices": [
      {
        "id": 1,
        "text": "Desflurane"
      },
      {
        "id": 2,
        "text": "Enflurane"
      },
      {
        "id": 3,
        "text": "Isoflurane"
      },
      {
        "id": 4,
        "text": "Methoxyflurane"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>Only 0.02% of desflurane undergoes metabolism</strong>. <br /> <br /> <br /><strong>Metabolism of fluranes</strong>:</p>\n<p>Methoxyflurane 70% metabolized and desflurane &lt;0.02% is metabolised.<br /><br /></p>\n<table style=\"height: 244px;\" width=\"191\">\n<tbody>\n<tr>\n<td style=\"width: 106px;\">Anaesthetic&nbsp;agent&nbsp;</td>\n<td style=\"width: 69px;\">Metabolism&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 106px;\">Methoxyflurane&nbsp;</td>\n<td style=\"width: 69px;\">70%&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 106px;\">Halothane&nbsp;</td>\n<td style=\"width: 69px;\">25%&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 106px;\">Enflurane&nbsp;</td>\n<td style=\"width: 69px;\">2.5%&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 106px;\">Sevoflurane&nbsp;</td>\n<td style=\"width: 69px;\">5%&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 106px;\">Isoflurane&nbsp;</td>\n<td style=\"width: 69px;\">0.2%&nbsp;</td>\n</tr>\n<tr>\n<td style=\"width: 106px;\"><strong>Desflurane&nbsp;</strong></td>\n<td style=\"width: 69px;\"><strong>0.02%&nbsp;</strong></td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 40 year old man who met with an RTA came to the casualty with maxilofacial trauma. PR was 120 beats/min, BP was 100/70 mm Hg, SpO2 was 80% with oxygen. What would the immediate management be?",
    "choices": [
      {
        "id": 1,
        "text": "Nasotracheal intubation"
      },
      {
        "id": 2,
        "text": "Intravenous fluid"
      },
      {
        "id": 3,
        "text": "Orotracheal intubation"
      },
      {
        "id": 4,
        "text": "Tracheostomy"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Patients with severe maxillofacial trauma and with low SpO<sub>2</sub> with O<sub>2</sub> suggests severe airway compromise or obstruction. Hence to maintain airway competency, intubation is necessary and in the above case, the presence of facial trauma <strong>orotracheal intubation</strong> is ideal.</p>\n<p>Other options:</p>\n<p><strong> Option A:</strong>&nbsp;</p>\n<ul>\n<li>Nasotracheal intubation is contraindicated in the presence of facial trauma because if there is an undiscovered fracture at the base of the skull, the tube could be forced through it and into the brain.</li>\n</ul>\n<p><strong>Option B:</strong></p>\n<ul>\n<li>IV fluid in this scenario is not immediate management.</li>\n</ul>\n<p><strong> Option D:</strong></p>\n<ul>\n<li>With modern intubation techniques using fiberoptic assistance a tracheotomy is rarely necessary.</li>\n<li>Only in case of failed intubation, tracheostomy is done.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Composition of Ringer\u2019s lactate is?",
    "choices": [
      {
        "id": 1,
        "text": "Sodium- 130 mEq/ L, Potassium-4 mEq/ L, Lactate-28 mEq/ L, Chloride-109 mEq/ L, Calcium-3 mEq/ L"
      },
      {
        "id": 2,
        "text": "Sodium- 140 mEq/ L, Potassium-7 mEq/ L, Lactate-34 mEq/ L, Chloride-70 mEq/ L, Calcium-10 mEq/ L"
      },
      {
        "id": 3,
        "text": "Sodium-150 mEq/ L, Potassium-30 mEq/ L, Lactate-60 mEq/ L, Chloride- 40 mEq/ L,  Calcium 20 mEq/ L"
      },
      {
        "id": 4,
        "text": "Sodium-210 mEq/ L, Potassium-5 mEq/ L, Lactate-38 mEq/ L, Chloride-90 mEq/ L, Calcium- 5 mEq/ L"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p><strong>&nbsp;Ringer lactate solution:&nbsp;&nbsp;</strong></p>\n<table style=\"height: 107px; width: 506px;\">\n<tbody>\n<tr style=\"height: 19px;\">\n<td style=\"width: 49px; height: 19px;\">Ions&nbsp;</td>\n<td style=\"width: 72px; height: 19px;\">Sodium&nbsp;</td>\n<td style=\"width: 72px; height: 19px;\">Chloride&nbsp;</td>\n<td style=\"width: 68px; height: 19px;\">Potassium&nbsp;</td>\n<td style=\"width: 57px; height: 19px;\">Calcium&nbsp;</td>\n<td style=\"width: 64px; height: 19px;\">Lactate&nbsp;</td>\n<td style=\"width: 86px; height: 19px;\">Osmolality&nbsp;&nbsp;</td>\n</tr>\n<tr style=\"height: 23px;\">\n<td style=\"width: 49px; height: 23px;\">Ringer lactate&nbsp;&nbsp;</td>\n<td style=\"width: 72px; height: 23px;\">130&nbsp;mEq/ L&nbsp;</td>\n<td style=\"width: 72px; height: 23px;\">109&nbsp;mEq/ L&nbsp;</td>\n<td style=\"width: 68px; height: 23px;\">4&nbsp;mEq/ L&nbsp;</td>\n<td style=\"width: 57px; height: 23px;\">3&nbsp;mEq/ L&nbsp;</td>\n<td style=\"width: 64px; height: 23px;\">28&nbsp;mEq/ L&nbsp;</td>\n<td style=\"width: 86px; height: 23px;\">273 mOsm/ L&nbsp;</td>\n</tr>\n</tbody>\n</table>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Train of 4 is characteristically used in concern with:",
    "choices": [
      {
        "id": 1,
        "text": "Malignant hyperthermia"
      },
      {
        "id": 2,
        "text": "Non-depolarizing neuromuscular blockers"
      },
      {
        "id": 3,
        "text": "Mechanical ventilation"
      },
      {
        "id": 4,
        "text": "To check hemodynamic parameters"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The degree of neuromuscular blockade is monitored by applying electrical stimuli. A twitch is a single pulse that is delivered from every 10s (1-0.1Hz). Increasing block results in decreased evoked response to stimuli.</p>\n<p>Train of 4 denotes 4 successive 200 micro second stimuli over 2 seconds. The <strong>twitches in a train of 4 pattern progressively fade as relaxation increases</strong>. The ratio of response to 1<sup>st</sup> and 4<sup>th</sup> twitch is a sensitive indicator of non-depolarizing muscle paralysis.</p>\n<p>Disappearance of the 4<sup>th</sup> twitch represents a 75% block.</p>\n<p>Disappearance of the 3<sup>rd</sup> twitch represents an 80% block.</p>\n<p>Disappearance of the 2<sup>nd</sup> twitch represents a 90% block.</p>\n<p><strong> Clinical relaxation requires a 75-95% neuromuscular blockade.</strong></p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/c7605e38a2084ed381c89f76325d15d5x708x413.PNG"
    ]
  },
  {
    "text": "Which thermoregulatory mechanism is best preserved during anesthesia?",
    "choices": [
      {
        "id": 1,
        "text": "Shivering"
      },
      {
        "id": 2,
        "text": "Sweating"
      },
      {
        "id": 3,
        "text": "Vasoconstriction"
      },
      {
        "id": 4,
        "text": "Non shivering thermogenesis"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Sweating</strong> is the best preserved thermoregulatory mechanism during anesthesia.</p>\n<p>Option A and C: General anesthetics decrease the thresholds (triggering core temperatures) for vasoconstriction and shivering by 2&deg;C to 3&deg;C.</p>\n<p>Option D: Nonshivering thermogenesis does not occur in anesthetized patients.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 70 kg athlete was posted for surgery on her injured rotator cuff. She was administered a total of 640mg of succinylcholine by intermittent dosing. During recovery, she was unable to respire spontaneously and move her limbs. What is the most likely reason for this?",
    "choices": [
      {
        "id": 1,
        "text": "Muscular weakness due to fasciculation produced by succinylcholine"
      },
      {
        "id": 2,
        "text": "Undiagnosed muscular dystrophy and muscular weakness"
      },
      {
        "id": 3,
        "text": "Phase II blockade produced by succinyl choline"
      },
      {
        "id": 4,
        "text": "Pseudocholinesterase deficiency increasing action of succinylcholine"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p style=\"text-align: justify;\">The most likely reason which led to this scenario is<strong> phase II&nbsp;blockade </strong>produced by <strong>succinylcholine.</strong></p>\n<p style=\"text-align: justify;\">Phase II block is clinically seen with the dose <strong>&gt;5 mg/kg.&nbsp;</strong>It is&nbsp;seen with a&nbsp;single <strong>large</strong> dose, <strong>repeated</strong> doses, or a <strong>continuous</strong> infusion of <strong>Sch</strong> which can lead to <strong>desensitization</strong> of the receptors resulting in a <strong>prolonged</strong> neuromuscular <strong>blockade.</strong></p>\n<p style=\"text-align: justify;\">Causes of prolonged apnea include:</p>\n<ul style=\"text-align: justify;\">\n<li>Atypical/pseudocholinesterase deficiency - can result in apnea even with a normal dose of succinylcholine</li>\n<li>Altered response of endplate to depolarizing relaxant (myasthenia gravis)</li>\n<li>Accumulation of succinylcholine leading to phase II blockade</li>\n</ul>\n<p style=\"text-align: justify;\">Note: Although options A, B, and D can lead to prolonged apnea, in the above case scenario, the patient has received ~9 mg/kg of succinylcholine. Hence, the most probable diagnosis is phase II blockade leading to prolonged apnea.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Blood should not be salvaged for transfusion if it contains?",
    "choices": [
      {
        "id": 1,
        "text": "Leukemia"
      },
      {
        "id": 2,
        "text": "Sickle cell anemia"
      },
      {
        "id": 3,
        "text": "Hemophilia"
      },
      {
        "id": 4,
        "text": "Megaloblastic cells"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Contraindications to blood salvage and reinfusion <strong>include septic contamination of the wound and malignancy</strong>.</p>\n<p><strong> Blood salvage:</strong></p>\n<ul>\n<li>This technique is used widely during<strong> cardiac, major vascular, and orthopedic surgery</strong>.</li>\n<li>The shed blood is aspirated&nbsp;intraoperatively&nbsp;into a reservoir and <strong>mixed with heparin</strong>.</li>\n<li>After a sufficient amount of blood is collected, the <strong>red cells are concentrated</strong> and washed to remove debris and anticoagulant and then <strong>reinfused</strong> into the patient.</li>\n<li>The concentrates obtained usually have <strong>hematocrits of 50 &ndash;60%</strong>.</li>\n<li>To be used effectively, this technique requires blood losses greater than 1000&ndash;1500&nbsp;mL.</li>\n<li>Contraindications to blood salvage and reinfusion include septic contamination of the wound and malignancy.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which of the following may result in increase in End tidal carbon dioxide?",
    "choices": [
      {
        "id": 1,
        "text": "Malignant hyperthermia"
      },
      {
        "id": 2,
        "text": "Shivering"
      },
      {
        "id": 3,
        "text": "Hyperthyroidism"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Rise in ETCO<sub>2</sub> is seen in malignant hyperthermia, hyperthyroidism and shivering.</p>\n<p>Capnography is the continuous measurement of End Tidal CO<sub>2</sub>(ETCO2).Normal value is <strong>35-45 mmHg (4%-6%).</strong></p>\n<p><strong>Uses of capnography:</strong></p>\n<ul>\n<li>It is the confirmatory<strong> sign of correct intubation</strong> in trachea.</li>\n<li>Obstructions/ disconnections of endotracheal tube ETCO<sub>2</sub> will fall.</li>\n<li><strong> In malignant hyperthermia, ETCO<sub>2</sub> increases significantly</strong> (more than 100 mm Hg).</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/390ab3b27406476fb2c233983c39d0cax727x649.PNG"
    ]
  },
  {
    "text": "In the assessment of a patient\u2019s airway, which of the following cannot be used?",
    "choices": [
      {
        "id": 1,
        "text": "Mallampati classification"
      },
      {
        "id": 2,
        "text": "Cormack and Lehane grading"
      },
      {
        "id": 3,
        "text": "Wilson\u2019s scoring"
      },
      {
        "id": 4,
        "text": "BURP"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>BURP is <strong>not</strong> a method of assessment of airway.</p>\n<p><strong>BURP</strong> is a technique of external laryngeal manipulation of the airway during intubation for better <strong>visualization</strong> of the larynx. This involves <strong>B</strong>ackward, <strong>U</strong>pward, <strong>R</strong>ightward <strong>P</strong>ressure on thyroid cartilage.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/24e02ad19ab843289898e7b67f9ae831x510x325.GIF",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/a6f73de7a27844a1940d2bc2aa82d1aax1280x3999.JPEG",
      "https://dhmbxeygs57ff.cloudfront.net/uploads/6b7731ed4b024568803d8aa1b4f787acx1280x3099.JPEG"
    ]
  },
  {
    "text": "Which of the following is true about adrenaline in CPR?",
    "choices": [
      {
        "id": 1,
        "text": "Can be given intratracheally"
      },
      {
        "id": 2,
        "text": "Intracardiac route is better than IV"
      },
      {
        "id": 3,
        "text": "Converts coarse fibrillation into fine ones"
      },
      {
        "id": 4,
        "text": "The dose used is 2 ml containing 1 in 1000 concentration"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Intravenous Adrenaline is the drug of choice for CPR. However, adrenaline can be given <strong>intratracheally</strong> also. The concentration required for intratracheal administration is <strong>2-2.5 times</strong> more than required for the IV route.</p>\n<p>Option B: <strong>Intracardiac injection</strong> is not recommended as it can cause <strong>myocardial damage.</strong> Recommended routes for adrenaline are intravenous, intraosseous (children), and intra-tracheal.</p>\n<p>Option C: <strong>Adrenaline</strong> converts <strong>fine</strong> fibrillation <strong>to coarse fibrillation</strong> which then responds well to defibrillation.</p>\n<p>Option D: Adrenaline is available as a <strong>1 mL injection</strong> containing 1 mg of adrenaline in 1:1000 concentration. The dose used in cardiac arrest is 1mg of adrenaline every 3-5 minutes, usually given as 1ml in 1:1000 concentration or 10ml in 1:10,000 concentration (more preferred since in cardiac arrest peripheral circulation is absent; hence larger volume is required for the drug to reach the central circulation).</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Most potent bronchodilator among inhalational anaesthetic agents is?",
    "choices": [
      {
        "id": 1,
        "text": "Isoflurane"
      },
      {
        "id": 2,
        "text": "Halothane"
      },
      {
        "id": 3,
        "text": "Sevoflurane"
      },
      {
        "id": 4,
        "text": "Desflurane"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Halothane is considered a potent bronchodilator.</p>\n<p><strong> Respiratory effects of Halothane:</strong></p>\n<ul>\n<li>Halothane is considered a potent bronchodilator, as it often<strong> reverses asthma-induced bronchospasm</strong>.</li>\n<li>This action<strong> is not inhibited by &alpha;-adrenergic blocking agents</strong>.</li>\n<li>Halothane <strong>attenuates airway reflexes</strong> and relaxes bronchial smooth muscle by inhibiting&nbsp;intracellular calcium mobilization.</li>\n<li>Halothane also <strong>depresses clearance of mucus</strong> from the respiratory tract (mucociliary&nbsp;function), promoting postoperative hypoxia and&nbsp;atelectasis.</li>\n<li>Halothane <strong>limits the increase in minute ventilation</strong> that normally accompanies a rise in&nbsp;PaCo2<span style=\"font-size: xx-small;\">.</span></li>\n<li><strong>Hypoxic drive is severely depressed</strong> by even low concentrations of Halothane (0.1 MAC).</li>\n<li>Apnoeic&nbsp;threshold also rises.</li>\n</ul>\n<p><strong> Effects of inhalational agents:</strong></p>\n<ul>\n<li>All inhalational agents are <strong>bronchodilator maximum with the Halothane</strong>, hence inhalational agent of choice in bronchial asthma is Halothane.</li>\n<li>Inhalational agent cause <strong>respiratory depression to some extent, maximum is seen with Enflurane</strong>.</li>\n<li><strong>Maximum inhibition of respiration</strong> in relation to the ventilator response to the&nbsp;hypercarbia&nbsp;and hypoxia is seen with the Halothane only.</li>\n<li>All inhalational agents&nbsp;vaso-dilate the pulmonary vascular bed by <strong>blunting the Hypoxic Pulmonary Vasoconstriction Response (HPV Response)</strong> which is seen maximally with the Halothane.</li>\n<li><strong> Ketamine is the intravenous agent of choice in case of asthmatics.</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You notice your surgery chief informing the anesthesia junior resident to place the forearm of the patient in a supinated position so as to avoid a common peripheral nerve injury. Which nerve injury is he most likely concerned about?",
    "choices": [
      {
        "id": 1,
        "text": "Radial nerve"
      },
      {
        "id": 2,
        "text": "Ulnar nerve"
      },
      {
        "id": 3,
        "text": "Posterior interosseous nerve"
      },
      {
        "id": 4,
        "text": "Anterior interosseous nerve"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>The surgeon is concerned about injury to the <strong>u</strong><strong>lnar nerve</strong>&nbsp;which can be prevented by positioning the forearm in supination compared to pronation. The ulnar nerve is the <strong>most commonly injured peripheral nerve</strong> following anesthesia.</p>\n<p>Other commonly injured nerves include</p>\n<ul>\n<li>Peroneal nerve</li>\n<li>Brachial plexus</li>\n<li>Common peroneal nerve</li>\n<li>Sciatic nerves</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "What is the most common cause of cardiac arrest in children?",
    "choices": [
      {
        "id": 1,
        "text": "Ventricular fibrillation"
      },
      {
        "id": 2,
        "text": "Myocardial infarction"
      },
      {
        "id": 3,
        "text": "Asphyxia"
      },
      {
        "id": 4,
        "text": "Congenital heart disease"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>In children, the more common cause of cardiac arrest is <strong>asphyxia</strong> rather than ventricular fibrillation.</p>\n<p>Even though asphyxia is the more common cause, pediatric resuscitation starts with<strong> chest compressions </strong>rather than rescue breaths as in adults for simplicity in training.&nbsp;This is because the cycle of 30 chest compressions before rescue breathing <strong>delays ventilation</strong> for <strong>only 15 to 20 seconds</strong>.</p>\n<p>During cardiopulmonary resuscitation of infants and children, the ratio of chest compression to rescue breaths is <strong>30:2 </strong>for a<strong> single rescuer</strong> and <strong>15:2</strong> if <strong>2 or more rescuers</strong> are present.&nbsp;In adults, the ratio is<strong> 30:2</strong> irrespective of the number of rescuers.</p>\n<p>In infants and children, the depth of compression should be at least one-third of the anteroposterior diameter of the chest which is about 5 cm in children and 4 cm in infants.</p>\n<p>&nbsp;</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "PEEP used for all except:",
    "choices": [
      {
        "id": 1,
        "text": "Partial pressure of arterial oxygen"
      },
      {
        "id": 2,
        "text": "Pulmonary edema"
      },
      {
        "id": 3,
        "text": "Shunt fraction 10%"
      },
      {
        "id": 4,
        "text": "Aspiration pneumonia"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>PEEP is not used for aspirational pneumonia.</p>\n<p><strong>Positive End Expiratory Pressure (PEEP):</strong></p>\n<ul>\n<li>It is the<strong> positive pressure applied at the end of expiration during mechanical ventilation</strong>.</li>\n<li>So,<strong> PEEP is an</strong> <strong>adjunctive treatment that can be applied to all forms of mechanical ventilation</strong>.</li>\n</ul>\n<p>Indications of PEEP:</p>\n<ul>\n<li>Pulmonary edema PaO<sub>2</sub> less than 60 mmHg</li>\n<li>Shunt fraction 10%</li>\n<li>ARDS</li>\n<li>Cardiothoracic surgery</li>\n</ul>\n<p>Function of PEEP:</p>\n<ul>\n<li><strong>Increase FRC, </strong>tidal volume and lung compliance</li>\n<li>Correction of ventilation/perfusion abnormalities</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Induction agent that may cause adrenal cortex suppression is?",
    "choices": [
      {
        "id": 1,
        "text": "Ketamine"
      },
      {
        "id": 2,
        "text": "Propofol"
      },
      {
        "id": 3,
        "text": "Etomidate"
      },
      {
        "id": 4,
        "text": "Thiopentone"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Induction doses of etomidate transiently inhibit enzymes involved in cortisol and aldosterone synthesis causing <strong>adrenocortical suppression</strong>.</p>\n<p><strong>Etomidate:</strong></p>\n<ul>\n<li>It has a<strong> brief duration of action 4-8 minutes</strong>.</li>\n<li>It produces less cardiovascular and respiratory depression so agent of choice for<strong> cardiovascular surgeries</strong>.</li>\n<li><strong> Coronary perfusion pressure</strong> is maintained when used along with&nbsp;fentanyl.</li>\n<li>It tends to reduce the increased ICP so it is useful to maintain the cerebral perfusion pressure.</li>\n<li><strong> Highest incidence of Nausea and vomiting</strong> (30-40%) among the intravenous agents.</li>\n<li>Can also cause the hiccups and&nbsp;myoclonus.</li>\n<li>Superficial&nbsp;thrombophlebitis&nbsp;and pain on injection may occur.</li>\n<li>It can be reduced by using larger vein and injecting&nbsp;lignocaine&nbsp;before the use of the&nbsp;etomidate.</li>\n</ul>\n<p><strong>Specific endocrine effect: </strong></p>\n<ul>\n<li>Dose dependent <strong>reversible inhibition of enzyme 11 &beta;-hydroxylase</strong>&nbsp;and little effect on 17&nbsp;&alpha;-&nbsp;hydroxylase&nbsp;leading to increased accumulation of the precursors of 11deoxycortisol and 17&nbsp;hydroxy&nbsp;progesterone and decreased synthesis of adrenal corticoids.</li>\n<li><strong>ACTH secretion increases</strong> because of loss of feedback inhibition.</li>\n<li><strong> Vit C supplementation</strong> restores the&nbsp;cortisol&nbsp;levels back to normal after the use of the&nbsp;etomidate.</li>\n<li>Fentanyl&nbsp;increases the plasma level and prolongs&nbsp;the elimination half-life of&nbsp;etomidate.</li>\n<li>Opioids&nbsp;decrease the&nbsp;myoclonus&nbsp;characteristic of an&nbsp;etomidate&nbsp;induction.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "A 33-year-old lady with infertility is taken up for laparoscopic ovarian drilling in outpatient surgery. Mivacurium is administered under daycare anesthesia. Why is this drug preferred in this scenario?",
    "choices": [
      {
        "id": 1,
        "text": "Rapid absorption"
      },
      {
        "id": 2,
        "text": "Rapid hydrolysis"
      },
      {
        "id": 3,
        "text": "Rapid excretion"
      },
      {
        "id": 4,
        "text": "Rapid conjugation"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Mivacurium&nbsp;</strong>is preferred as it undergoes&nbsp;<strong>rapid hydrolysis</strong> by <strong>butyrylcholinesterase</strong>&nbsp;(plasma cholinesterase/ pseudocholinesterase).</p>\n<p>Mivacurium&nbsp;is a <strong>short-acting</strong> muscle relaxant preferred in day-care anesthesia.&nbsp;It has an <strong>onset</strong> of action within <strong>2-3 minutes</strong> and a <strong>duration</strong> of action of <strong>10-20 minutes</strong>.</p>\n<p>Patients with atypical pseudocholinesterase will have a prolonged duration of the block similar to succinylcholine administration.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "You are a certified BLS provider showing your junior how to perform bag and mask ventilation on a mannequin. While applying the face mask, where would you place the fifth digit of your hand?",
    "choices": [
      {
        "id": 1,
        "text": "Bridge of the nose"
      },
      {
        "id": 2,
        "text": "The mask device"
      },
      {
        "id": 3,
        "text": "Ramus of mandible"
      },
      {
        "id": 4,
        "text": "Angle of mandible"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>The fifth digit of the hand should be placed at the <strong>angle of mandible</strong> while holding a face mask.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/4d4a089781de4526bad5e8a55be3978ex1280x1063.JPEG"
    ]
  },
  {
    "text": "Local anaesthetic acts by",
    "choices": [
      {
        "id": 1,
        "text": "Mg++channel inhibition"
      },
      {
        "id": 2,
        "text": "Ca++ channel inhibition"
      },
      {
        "id": 3,
        "text": "Na+ channel inhibition"
      },
      {
        "id": 4,
        "text": "K+ channel inhibition"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong> Local anesthetics act by blocking Na+ channels</strong>. By doing so, they decrease the influx of Na+ channels during the upstroke of action potential.</p>\n<p>Normally, Na+ channel in axonal membrane has the following phases:</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/f4a334d394b24bd498a9b2c3d54da640x800x538.JPEG"
    ]
  },
  {
    "text": "Diffusion hypoxia is seen during",
    "choices": [
      {
        "id": 1,
        "text": "Induction of anaesthesia"
      },
      {
        "id": 2,
        "text": "Reversal of anaesthesia"
      },
      {
        "id": 3,
        "text": "Intubation"
      },
      {
        "id": 4,
        "text": "Perioperative period"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>Diffusion hypoxia occurs during<strong> recovery from anaesthesia</strong>.</p>\n<p><strong> Diffusion Hypoxia:</strong></p>\n<ul>\n<li>During recovery from&nbsp;anaesthesia&nbsp;Nitrous oxide having the low blood solubility<strong> rapidly diffuses into the alveoli and dilutes the alveolar air and partial pressure of oxygen in alveoli is reduced leading to hypoxia known as Diffusion hypoxia</strong>.</li>\n<li>It can&nbsp;be prevented by<strong> continuing 100% O<sub>2</sub> inhalation</strong> for a few minutes after discontinuing nitrous oxide.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Irradiation of granulocytes before transfusion reduces all of the following except",
    "choices": [
      {
        "id": 1,
        "text": "Graft versus host disease"
      },
      {
        "id": 2,
        "text": "Febrile reactions"
      },
      {
        "id": 3,
        "text": "Re-perfusion injury"
      },
      {
        "id": 4,
        "text": "Acute hemolytic reaction"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p>Irradiation of granulocytes before transfusion does not&nbsp;reduce <strong>acute hemolytic reaction</strong> as it is due to attack on the transfused donor&nbsp;RBCs by <strong>recipient's&nbsp;antibodies</strong> and complements.</p>\n<p>Similarly,&nbsp;the risk of <strong>bacterial contamination of platelets</strong>&nbsp;and<strong>&nbsp;transfusion-related acute lung injury </strong>(TRALI) has not decreased with leukoreduction.</p>\n<p>Irradiation of granulocytes or use of leukoreduced blood components has several <strong>advantages</strong> over the use of packed red blood cells:</p>\n<ul style=\"list-style-type: circle;\">\n<li>Decreased risk of <strong>graft versus host disease</strong>-which is due to engraftment of donor lymphocytes from the transfused blood products leading to an immune reaction against recipient tissues</li>\n<li>Reduces chances of <strong>febrile reactions</strong></li>\n<li>Decreases <strong>re-perfusion injury (myocardium; after heart by-pass)</strong></li>\n<li>Decreases transmission of <strong>cytomegalovirus</strong></li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Sodalime circuit is not used in circuit with?",
    "choices": [
      {
        "id": 1,
        "text": "Ether"
      },
      {
        "id": 2,
        "text": "Halothane"
      },
      {
        "id": 3,
        "text": "Trilene"
      },
      {
        "id": 4,
        "text": "Methoxyflurane"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p><strong>Sodalime with trilene forms Phosgene (pulmonotoxic gas)</strong>. So this combination is contraindicated.</p>\n<p><strong> Soda lime:</strong></p>\n<ul>\n<li>It is a mixture of 94% Ca(OH)<sub>2</sub>+ 5%&nbsp;NaOH&nbsp;as a catalyst+ 1% KOH.</li>\n<li>It should not be used with\n<ul>\n<li>Chloroform</li>\n<li>Trilene</li>\n<li>Sevoflurane</li>\n</ul>\n</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Preemptive anesthesia is",
    "choices": [
      {
        "id": 1,
        "text": "Introduction of an analgesic regimen before the onset of noxious stimuli"
      },
      {
        "id": 2,
        "text": "Formulated by crile"
      },
      {
        "id": 3,
        "text": "Administration of long-lasting analgesics before surgery"
      },
      {
        "id": 4,
        "text": "All of the above"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Preemptive Anesthesia:</strong></p>\n<ul>\n<li>Formulated by <strong>Crile.</strong></li>\n<li>Involves introduction of an analgesic regimen before the onset of noxious stimuli, with the goal of preventing sensitization of the nervous system to subsequent painful stimuli.</li>\n<li>Administration of <strong>long lasting analgesics before surgery</strong> will help avoid the establishment of a sensitized state and result in postoperative diminished pain.</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Beta waves on electroencephaloghram (EEG) signify __________ .",
    "choices": [
      {
        "id": 1,
        "text": "Light anesthesia"
      },
      {
        "id": 2,
        "text": "Profound hypothermia"
      },
      {
        "id": 3,
        "text": "Deep anesthesia"
      },
      {
        "id": 4,
        "text": "Anesthetic induced coma"
      }
    ],
    "correct_choice_id": 1,
    "solution": "<p>Beta waves on EEG signifies <strong>light anesthesia.</strong></p>\n<p>Beta waves on EEG are seen in <strong>awake state</strong> and during <strong>initial stages of inhalational anesthesia.</strong></p>\n<p><strong> Interpretation of an EEG:</strong></p>\n<ul>\n<li>&beta;-awake state\n<ul>\n<li>During inhalational anesthesia, initial beta activation is followed by slowing burst suppression and&nbsp;isoelectricity.</li>\n</ul>\n</li>\n<li>&alpha;-&beta;&nbsp;oscillations:&nbsp;Arousable&nbsp;state of sedation</li>\n<li>&alpha;,&theta;&nbsp;oscillations with &delta; dominance: Surgically anesthetized state</li>\n</ul>\n<p>(&alpha;- alpha,&nbsp;&beta;- beta,&nbsp;&delta;- delta,&nbsp;&theta;- theta)</p>\n<p><strong>Iso electric EEG </strong>is seen in&nbsp;</p>\n<ul>\n<li>Brief periods during normal maintenance of anesthesia</li>\n<li>Anesthetic induced coma</li>\n<li>Profound hypothermia</li>\n</ul>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Cis atracurium is preferred over atracurium due to advantage of?",
    "choices": [
      {
        "id": 1,
        "text": "Rapid onset"
      },
      {
        "id": 2,
        "text": "Short duration of action"
      },
      {
        "id": 3,
        "text": "No histamine release"
      },
      {
        "id": 4,
        "text": "Less cardio depressant"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>Cisatracurium&nbsp;is a stereoisomer of atracurium.&nbsp;<strong>Cisatracurium does not provoke histamine release and therefore preferred over atracurium.</strong></p>\n<p>As&nbsp;cisatracurium&nbsp;does not provoke histamine release, there is no bradycardia, hypotension and reflex tachycardia. Cisatracurium&nbsp;does not affect the heart rate or BP nor does it producess any autonomic effect.</p>\n<p><strong>Both&nbsp;atracurium&nbsp;and&nbsp;cisatracurium&nbsp;undergoes Hoffman Elimination</strong> and produces laudanosine as metabolite but&nbsp;cisatracurium&nbsp;produces less laudanosine than Atracurium, therefore causing less CNS toxicity than Atracurium.</p>\n<p><strong>Reversal of&nbsp;Atracurium&nbsp;or&nbsp;Cisatracurium&nbsp;by&nbsp;Neostigmine&nbsp;is not required</strong> because of&nbsp;spontanoeus&nbsp;non enzymatic degradation and hence both can be used in patients with Neostigmine hypersensitivity.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "Which among the following is true regarding \"Allen's test\"?",
    "choices": [
      {
        "id": 1,
        "text": "Used to confirm Ryle's tube position"
      },
      {
        "id": 2,
        "text": "Used to confirm tracheal intubation"
      },
      {
        "id": 3,
        "text": "Used to diagnose wrist dislocation"
      },
      {
        "id": 4,
        "text": "Used to assess adequacy of collateral blood flow"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<ul>\n<li><strong>Allen's Test</strong> \u202fis used to test the adequacy of collateral blood flow to hand especially mandatory before radial artery&nbsp;cannulation.</li>\n<li>It is performed by occluding the <strong>radial and ulnar arteries</strong> and asking the patient to make a tight fist so as to&nbsp;exsanguinate&nbsp;the palm.</li>\n<li>Then the patient is asked to open the hand and the occlusion over the&nbsp;ulnar&nbsp;artery is released.</li>\n<li>If the palm remains pale for more than 6-10 seconds, it indicates<strong> reduced ulnar collateral flow.</strong></li>\n<li>The other arteries which can be used for invasive blood pressure monitoring are&nbsp;ulnar, brachial,&nbsp;axillary, femoral arteries and less commonly&nbsp;dorsalis&nbsp;pedis, posterior&nbsp;tibial, and superficial temporal arteries.</li>\n</ul>\n<p>Fig: Allen's test</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://dhmbxeygs57ff.cloudfront.net/uploads/ae6872f10d104843822fccbee01ef634x1280x3351.JPEG"
    ]
  },
  {
    "text": "Smoking should preferably be stopped when before surgery?",
    "choices": [
      {
        "id": 1,
        "text": "1 week"
      },
      {
        "id": 2,
        "text": "2 weeks"
      },
      {
        "id": 3,
        "text": "4 weeks"
      },
      {
        "id": 4,
        "text": "6 weeks"
      }
    ],
    "correct_choice_id": 4,
    "solution": "<p><strong>Smoking should be completely stopped in 6 weeks before surgery</strong> because complete recovery of cilia activity takes place in 6 weeks. </p>\n<p>Smoking when stopped 1-2 weeks before will reduce sputum volume.</p>\n<p>Smoking when stopped 12 hours before helps decrease nicotine(helps improve cardiac activity) and decreases carbon monoxide ( decreases carboxyhemoglobin levels, shifting oxygen dissociation curve to the right and thereby improve O2 delivery to the tissues.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": [
      "https://cdn1.dailyrounds.org/uploads/2da6dcb673514e7f91c0effed25e4c8fx431x472.PNG"
    ]
  },
  {
    "text": "In a cardiac arrest patient, if intravenous access cannot be obtained, what is the next best way to administer epinephrine?",
    "choices": [
      {
        "id": 1,
        "text": "Endotracheal route"
      },
      {
        "id": 2,
        "text": "Intramuscular"
      },
      {
        "id": 3,
        "text": "Intraosseus"
      },
      {
        "id": 4,
        "text": "Wait till intravenous access is made"
      }
    ],
    "correct_choice_id": 3,
    "solution": "<p>American Heart Association recommends the <strong>intraosseous</strong>&nbsp;<strong>(IO)</strong> <strong>route</strong> as an alternative to an intravenous route in order to deliver drugs and fluids, especially in children.</p>\n<p>This is because<strong> intraosseous access </strong>can easily be made in<strong> 30-60 seconds </strong>and thus provide <strong>emergency vascular access</strong>. It involves placing a catheter into the marrow venous plexus and administering, crystalloids, colloids, drugs, and blood which leads to rapid and reliable absorption into the systemic circulation.</p>\n<p>Sites of choice: proximal tibia, distal femur, the distal end of radius, or ulna.</p>\n<p>The fluids are administered under pressure because of the resistance to fluid flow from the IO catheter into the IO space.&nbsp;The <strong>disadvantage</strong> with this route is the risk of <strong>osteomyelitis, compartment syndrome,</strong> bone marrow or <strong>fat embolism.</strong></p>\n<p>IO access is superior to the endotracheal route. The American Heart Association does not recommend an intramuscular route for cardiac resuscitation.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "EMLA contains__________",
    "choices": [
      {
        "id": 1,
        "text": "2.5% lignocaine and 5% prilocaine"
      },
      {
        "id": 2,
        "text": "2.5% lignocaine and 2.5% prilocaine"
      },
      {
        "id": 3,
        "text": "5% lignocaine and 2.5% prilocaine"
      },
      {
        "id": 4,
        "text": "5% lignocaine and 5% prilocaine"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p>EMLA is a mixture of 2.5% lignocaine and 2.5% prilocaine</p>\n<p><strong>Eutectic Mixture of Local&nbsp;Anesthetic(&nbsp;EMLA):</strong></p>\n<ul>\n<li>This is a unique topical preparation that can <strong>anaesthetize intact skin</strong>.</li>\n<li>It acts slowly and must be in contact with the skin for at least an hour.</li>\n</ul>\n<p><strong> It is used in:</strong></p>\n<ul>\n<li>Venepuncture&nbsp;especially in children</li>\n<li>Skin grafting</li>\n<li>Circumcision</li>\n</ul>\n<p>EMLA should not be used on mucocutaneous membrane or in very small children as Prilocaine when absorbed systemically causes methemoglobinemia.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  },
  {
    "text": "The agent which causes coronary steal phenomenon is?",
    "choices": [
      {
        "id": 1,
        "text": "Sevoflurane"
      },
      {
        "id": 2,
        "text": "Isoflurane"
      },
      {
        "id": 3,
        "text": "Haloflurane"
      },
      {
        "id": 4,
        "text": "Desflurane"
      }
    ],
    "correct_choice_id": 2,
    "solution": "<p><strong>Isoflurane</strong> causes <strong>coronary steal</strong> phenomenon.</p>\n<p>In coronary artery stenosis patients, Isoflurane causes coronary artery <strong>vasodilation in non-ischemic areas, </strong>thereby<strong> diverting the blood away from ischaemic zones, </strong>called as coronary steal phenomenon.</p>\n<p>It also reduces blood supply to the ischaemic zones.</p>\n<p>Isoflurane dilates coronary arteries, but not nearly as potently as nitroglycerin or adenosine.</p>",
    "explanation_video": "",
    "question_images": [],
    "explanation_images": []
  }
];
        let quizName = 'Anaesthesia St 1';
        const quizFilename = 'anaesthesia-st-1-a3ab3757.html';
        let hierarchy = ["Marrow", "NEET PG Test Series Subject Wise", "Year 2017 - 18"];
        
        // Handle Custom Quiz Loading
        if (window.location.pathname.endsWith('custom_quiz.html')) {
            const customData = JSON.parse(localStorage.getItem('customQuizData'));
            if (customData) {
                questionsData = customData.questions;
                quizName = customData.name;
                hierarchy = customData.hierarchy;
                document.title = quizName + ' - Brain And Scalpel';
                document.getElementById('totalQuestions').textContent = questionsData.length;
                document.getElementById('quizHierarchy').textContent = hierarchy.join(' > ');
            }
        }

        let currentQuestionIndex = 0;
        let selectedOption = null;
        let currentMode = 'study';
        let timer = null;
        let timeRemaining = 0;
        let questionStartTime = Date.now();
        let quizStartTime = Date.now();
        let isQuizCompleted = false;
        
        let questionStates = new Array(questionsData.length).fill(null).map(() => ({
            status: 'not_attempted',
            bookmarked: false,
            markedForReview: false,
            selectedAnswer: null,
            timeSpent: 0
        }));
        
        let stats = {
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalAttempted: 0,
            totalTime: 0,
            notAttempted: questionsData.length
        };

        // --- NEW: History Management ---
        function saveProgress() {
            if (isQuizCompleted) return; // Don't save after completion
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            userHistory[quizFilename] = {
                questionStates,
                stats,
                currentQuestionIndex,
                currentMode,
                status: 'incomplete',
                lastSeen: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }

        function loadProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const savedState = userHistory[quizFilename];
            if (savedState) {
                questionStates = savedState.questionStates;
                stats = savedState.stats;
                currentQuestionIndex = savedState.currentQuestionIndex;
                currentMode = savedState.currentMode;
                console.log('Progress loaded.');
                return true;
            }
            return false;
        }

        function clearProgress() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            if(userHistory[quizFilename]) {
                delete userHistory[quizFilename];
                localStorage.setItem('userHistory', JSON.stringify(userHistory));
                console.log('Previous progress cleared.');
            }
        }

        function markQuizAsCompleted() {
            const userHistory = JSON.parse(localStorage.getItem('userHistory')) || {};
            const totalQuestions = questionsData.length;
            const correct = stats.correctAnswers || 0;
            
            userHistory[quizFilename] = {
                score: correct,
                total: totalQuestions,
                status: 'completed',
                completedOn: new Date().toISOString()
            };
            localStorage.setItem('userHistory', JSON.stringify(userHistory));
        }
        // --- End of History Management ---

        const urlParams = new URLSearchParams(window.location.search);
        const startAt = parseInt(urlParams.get('startAt'));
        const resume = urlParams.get('resume') === 'true';

        function goBack() {
            if (!isQuizCompleted) saveProgress(); // Save progress before leaving
            window.location.href = document.referrer || 'index.html';
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeModal').style.display = 'none';
            initializeQuiz();
        }

        function initializeQuiz() {
            quizStartTime = Date.now();
            
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const markReviewBtn = document.getElementById('markReviewBtn');
            const testModeReviewLegend = document.getElementById('testModeReviewLegend');
            const isTestMode = currentMode === 'test' || currentMode === 'timed_exam';
            
            document.getElementById('statsBar').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('studyModeLegend').style.display = isTestMode ? 'none' : 'block';
            document.getElementById('testModeLegend').style.display = isTestMode ? 'block' : 'none';
            document.getElementById('submitSection').style.display = isTestMode ? 'block' : 'none';
            bookmarkBtn.style.display = isTestMode ? 'none' : 'flex';
            markReviewBtn.style.display = isTestMode ? 'flex' : 'none';
            testModeReviewLegend.style.display = isTestMode ? 'flex' : 'none';
            
            if (currentMode === 'timed_study' || currentMode === 'timed_exam') {
                document.getElementById('timerContainer').classList.remove('hidden');
            }
            
            if (!isNaN(startAt) && startAt >= 0 && startAt < questionsData.length) {
                currentQuestionIndex = startAt;
            }

            loadBookmarkedQuestions();
            generateQuestionNav();
            updateStats();
            displayQuestion();
        }

        function generateQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.createElement('button');
                btn.textContent = i + 1;
                btn.className = 'w-8 h-8 text-sm font-medium rounded transition-all duration-200';
                btn.onclick = () => jumpToQuestion(i);
                btn.id = `navBtn_${i}`;
                nav.appendChild(btn);
            }
            
            updateQuestionNav();
        }

        function updateQuestionNav() {
            for (let i = 0; i < questionsData.length; i++) {
                const btn = document.getElementById(`navBtn_${i}`);
                const state = questionStates[i];
                let className = '';
                
                if (i === currentQuestionIndex) {
                    className = 'nav-btn-current';
                } else if (state.bookmarked) {
                    className = 'nav-btn-bookmarked';
                } else if (state.markedForReview) {
                    className = 'nav-btn-marked-review';
                } else if (currentMode === 'study' || currentMode === 'timed_study') {
                    if (state.status === 'correct') className = 'nav-btn-correct';
                    else if (state.status === 'incorrect') className = 'nav-btn-incorrect';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                } else {
                    if (state.selectedAnswer !== null) className = 'nav-btn-answered';
                    else className = 'nav-btn-not-attempted hover:bg-white hover:bg-opacity-20';
                }
                btn.className = `w-8 h-8 text-sm font-medium rounded ${className}`;
            }
        }

        function jumpToQuestion(index) {
            if (index >= 0 && index < questionsData.length) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex = index;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function updateStats() {
            if (currentMode === 'study' || currentMode === 'timed_study') {
                document.getElementById('correctCount').textContent = stats.correctAnswers;
                document.getElementById('incorrectCount').textContent = stats.incorrectAnswers;
                document.getElementById('totalAttempted').textContent = stats.totalAttempted;
                
                const accuracy = stats.totalAttempted > 0 
                    ? Math.round((stats.correctAnswers / stats.totalAttempted) * 100)
                    : 0;
                document.getElementById('accuracy').textContent = accuracy + '%';
                
                stats.totalTime = questionStates.reduce((acc, state) => acc + state.timeSpent, 0);
                const timeSpent = Math.floor(stats.totalTime / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('timeSpent').textContent = 
                    minutes + ':' + seconds.toString().padStart(2, '0');
            }
        }

        function setupVideo(videoElement, url) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(videoElement);
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = url;
            }
        }

        function displayQuestion() {
            if (!questionsData || questionsData.length === 0) {
                document.getElementById('questionText').innerHTML = 'No questions available for this quiz.';
                return;
            };
            
            const question = questionsData[currentQuestionIndex];
            questionStartTime = Date.now();
            
            selectedOption = questionStates[currentQuestionIndex].selectedAnswer;
            
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            updateQuestionNav();
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            document.getElementById('solutionContainer').classList.add('hidden');
            
            document.getElementById('questionText').innerHTML = question.text || 'No question text available';
            
            let mediaHtml = '';
            if (question.question_audio) mediaHtml += `<div class="glass-light p-4 mb-4"><audio src="${question.question_audio}" controls class="w-full"></audio></div>`;
            if (question.question_video) mediaHtml += `<div class="glass-light p-4 mb-4"><video src="${question.question_video}" controls class="w-full rounded-lg"></video></div>`;
            if (question.question_images) {
                question.question_images.forEach(imgSrc => {
                    if (imgSrc) mediaHtml += `<div class="glass-light p-4 mb-4"><img src="${imgSrc}" alt="Question Image" class="w-full rounded-lg"></div>`;
                });
            }
            document.getElementById('questionMedia').innerHTML = mediaHtml;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('answered');
            
            if (question.choices && Array.isArray(question.choices)) {
                question.choices.forEach((choice, index) => {
                    const optionLetter = String.fromCharCode(65 + index);
                    const isSelected = selectedOption === index;
                    
                    const optionDiv = document.createElement('div');
                    optionDiv.innerHTML = `
                        <button type="button" class="option-button ${isSelected ? 'selected' : ''}" data-option-index="${index}">
                            <div class="option-letter">${optionLetter}</div>
                            <div class="option-text">${choice.text || 'Option ' + (index + 1)}</div>
                        </button>
                    `;
                    optionsContainer.appendChild(optionDiv);
                });
                
                optionsContainer.addEventListener('click', function(e) {
                    const optionButton = e.target.closest('.option-button');
                    if (optionButton) {
                        const optionIndex = parseInt(optionButton.getAttribute('data-option-index'));
                        selectOption(optionIndex);
                    }
                });
            }
            
            updateBookmarkButton();
            updateMarkReviewButton();

            if ((currentMode === 'timed_study' || currentMode === 'timed_exam') && !isQuizCompleted) {
                startTimer();
            }
        }

        function selectOption(index) {
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer.classList.contains('answered')) return;

            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                questionStartTime = Date.now();
            }
            
            selectedOption = index;
            questionStates[currentQuestionIndex].selectedAnswer = index;
            
            document.querySelectorAll('.option-button').forEach((btn, i) => {
                btn.classList.toggle('selected', i === index);
            });
            
            if (currentMode === 'study' || currentMode === 'timed_study') {
                processAnswer();
            } else {
                if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                    questionStates[currentQuestionIndex].status = 'answered';
                    stats.totalAttempted++;
                    stats.notAttempted--;
                }
                updateQuestionNav();
            }
            saveProgress(); // NEW: Save on answer selection
        }

        function processAnswer() {
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            
            if(selectedOption === null) return;

            const selectedChoice = question.choices[selectedOption];
            const isCorrect = selectedChoice.id === correctChoiceId;
            
            if (questionStates[currentQuestionIndex].status === 'not_attempted') {
                stats.totalAttempted++;
                stats.notAttempted--;
                if(isCorrect) stats.correctAnswers++; else stats.incorrectAnswers++;
            }
            questionStates[currentQuestionIndex].status = isCorrect ? 'correct' : 'incorrect';
            
            updateStats();
            showInlineFeedback(isCorrect);
            updateQuestionNav();
        }

        function showInlineFeedback(isCorrect) {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;

            const optionsContainer = document.getElementById('optionsContainer');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');
            const question = questionsData[currentQuestionIndex];
            const correctChoiceId = question.correct_choice_id;
            let correctOptionIndex = question.choices.findIndex(c => c.id === correctChoiceId);

            optionsContainer.classList.add('answered');

            optionButtons.forEach((btn, index) => {
                btn.classList.remove('selected');
                if (index === correctOptionIndex) btn.classList.add('correct');
                else if (index === selectedOption && !isCorrect) btn.classList.add('incorrect');
            });

            showSolution();
        }


        function showSolution() {
            if (currentMode !== 'study' && currentMode !== 'timed_study') return;
            
            const question = questionsData[currentQuestionIndex];
            document.getElementById('solutionText').innerHTML = question.solution || 'No solution provided';
            
            const videoContainer = document.getElementById('solutionVideo');
            const videoPlayer = document.getElementById('explanationVideoPlayer');
            const explanationVideo = question.explanation_video;
            
            if (explanationVideo) {
                videoContainer.classList.remove('hidden');
                if (explanationVideo.includes('.m3u8')) setupVideo(videoPlayer, explanationVideo);
                else videoPlayer.src = explanationVideo;
            } else {
                videoContainer.classList.add('hidden');
            }

            const audioContainer = document.getElementById('solutionAudio');
            audioContainer.innerHTML = '';
            if (question.explanation_audio_eng) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English Explanation:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
            }
            if (question.explanation_audio_hin) {
                audioContainer.innerHTML += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish Explanation:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;
            }
            
            const imagesContainer = document.getElementById('solutionImages');
            imagesContainer.innerHTML = '';
            if (question.explanation_images) {
                 question.explanation_images.forEach(imgSrc => {
                    if(imgSrc) imagesContainer.innerHTML += `<div class="mt-4"><img src="${imgSrc}" alt="Explanation Image" class="w-full rounded-lg"></div>`;
                });
            }

            document.getElementById('solutionContainer').classList.remove('hidden');
        }

        function submitQuiz() {
            if (timer) clearInterval(timer);
            if (!confirm('Are you sure you want to submit the quiz?')) return;
            
            isQuizCompleted = true;
            let correct = 0, incorrect = 0;
            const totalTime = Date.now() - quizStartTime;
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                if (state.selectedAnswer !== null) {
                    if (question.choices[state.selectedAnswer].id === question.correct_choice_id) {
                        correct++;
                        state.status = 'correct';
                    } else {
                        incorrect++;
                        state.status = 'incorrect';
                    }
                }
            });
            
            // Save performance data
            const performanceData = JSON.parse(localStorage.getItem('quizPerformanceData')) || [];
            performanceData.push({
                quizName: quizName,
                hierarchy: hierarchy,
                timestamp: Date.now(),
                totalTime: totalTime,
                stats: {
                    correct: correct,
                    incorrect: incorrect,
                    notAttempted: questionsData.length - (correct + incorrect)
                }
            });
            localStorage.setItem('quizPerformanceData', JSON.stringify(performanceData));

            stats.correctAnswers = correct; // Update global stats
            stats.incorrectAnswers = incorrect;
            markQuizAsCompleted(); // NEW: Mark quiz as complete in history
            showPerformanceAnalysis(correct, incorrect, questionsData.length - (correct + incorrect), totalTime);
        }

        function showPerformanceAnalysis(correct, incorrect, notAttempted, totalTime) {
            const modal = document.getElementById('performanceModal');
            const accuracy = (correct + incorrect) > 0 ? Math.round((correct / (correct + incorrect)) * 100) : 0;
            
            const circumference = 2 * Math.PI * 65;
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
            scoreCircle.style.strokeDashoffset = circumference - (accuracy / 100) * circumference;
            
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            document.getElementById('totalQuestionsResult').textContent = questionsData.length;
            document.getElementById('correctResult').textContent = correct;
            document.getElementById('incorrectResult').textContent = incorrect;
            document.getElementById('notAttemptedResult').textContent = notAttempted;
            
            const totalMinutes = Math.floor(totalTime / 60000);
            const totalSeconds = Math.floor((totalTime % 60000) / 1000);
            document.getElementById('totalTimeResult').textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            
            const avgTime = totalTime / questionsData.length;
            const avgMinutes = Math.floor(avgTime / 60000);
            const avgSeconds = Math.floor((avgTime % 60000) / 1000);
            document.getElementById('avgTimeResult').textContent = `${avgMinutes}:${avgSeconds.toString().padStart(2, '0')}`;
            
            modal.classList.remove('hidden');
        }

        function closePerformanceModal() { document.getElementById('performanceModal').classList.add('hidden'); }

        function reviewQuestions() {
            document.getElementById('questionReviewSection').classList.remove('hidden');
            const container = document.getElementById('reviewQuestionsContainer');
            container.innerHTML = '';
            
            questionsData.forEach((question, index) => {
                const state = questionStates[index];
                const correctChoiceId = question.correct_choice_id;
                
                let statusClass = 'not-attempted', statusText = 'Not Attempted';
                if (state.selectedAnswer !== null) {
                    const selectedChoice = question.choices[state.selectedAnswer];
                    if (selectedChoice.id === correctChoiceId) { statusClass = 'correct'; statusText = 'Correct'; }
                     else { statusClass = 'incorrect'; statusText = 'Incorrect'; }
                }
                
                const reviewDiv = document.createElement('div');
                reviewDiv.className = `review-question ${statusClass}`;
                
                let optionsHtml = (question.choices || []).map((choice, choiceIndex) => {
                    const isSelected = state.selectedAnswer === choiceIndex;
                    const isCorrect = choice.id === correctChoiceId;
                    let borderClass = 'border-gray-600';
                    if(isCorrect) borderClass = 'border-green-500';
                    else if(isSelected) borderClass = 'border-red-500';
                    
                    return `<div class="p-3 rounded-lg border ${borderClass}"><span class="font-bold mr-3">${String.fromCharCode(65 + choiceIndex)}</span><span>${choice.text}</span></div>`;
                }).join('');

                const videoHtml = question.explanation_video ? `<div class="mt-4"><video id="review-video-${index}" data-src="${question.explanation_video}" class="w-full rounded-lg" controls></video></div>` : '';
                
                let audioHtml = '';
                if(question.explanation_audio_eng) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">English:</p><audio src="${question.explanation_audio_eng}" controls class="w-full"></audio></div>`;
                if(question.explanation_audio_hin) audioHtml += `<div class="mt-2"><p class="text-sm text-white text-opacity-70 mb-1">Hinglish:</p><audio src="${question.explanation_audio_hin}" controls class="w-full"></audio></div>`;

                let imagesHtml = (question.explanation_images || []).map(src => src ? `<div class="mt-4"><img src="${src}" alt="Explanation Image" class="w-full rounded-lg"></div>` : '').join('');

                reviewDiv.innerHTML = `
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-bold text-white">Question ${index + 1}</h4>
                            <span class="text-sm px-3 py-1 rounded-full bg-${statusClass === 'correct' ? 'green' : statusClass === 'incorrect' ? 'red' : 'gray'}-600 text-white">${statusText}</span>
                        </div>
                        <div class="text-white mb-4">${question.text}</div>
                    </div>
                    <div class="space-y-2 mb-4">${optionsHtml}</div>
                    <div class="bg-green-900 bg-opacity-20 p-4 rounded-lg border border-green-700">
                        <h5 class="text-green-400 font-bold mb-2">Explanation:</h5>
                        <div class="text-white text-opacity-90">${question.solution || 'No solution available.'}</div>
                        ${videoHtml}
                        ${audioHtml}
                        ${imagesHtml}
                    </div>`;
                container.appendChild(reviewDiv);
            });
            initializeReviewVideos();
        }

        function initializeReviewVideos() {
            document.querySelectorAll('video[data-src]').forEach(videoEl => {
                const src = videoEl.dataset.src;
                if (src && src.includes('.m3u8')) {
                    setupVideo(videoEl, src);
                } else if (src) {
                    videoEl.src = src;
                }
            });
        }

        function retakeQuiz() {
            if (confirm('Are you sure you want to retake the quiz? This will reset all your answers.')) {
                if (window.location.pathname.endsWith('custom_quiz.html')) {
                    localStorage.removeItem('customQuizData');
                }
                clearProgress(); // NEW: Clear history on retake
                location.reload();
            }
        }

        function loadBookmarkedQuestions() {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            bookmarks.forEach(bookmark => {
                if (bookmark.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-'))) {
                    if (bookmark.questionIndex < questionsData.length) {
                        questionStates[bookmark.questionIndex].bookmarked = true;
                    }
                }
            });
        }

        function toggleBookmark() {
            const isBookmarked = !questionStates[currentQuestionIndex].bookmarked;
            questionStates[currentQuestionIndex].bookmarked = isBookmarked;
            
            let bookmarks = JSON.parse(localStorage.getItem('bookmarkedQuestions')) || [];
            
            if (isBookmarked) {
                const bookmarkData = {
                    quizName: quizName,
                    quizFile: window.location.pathname.split('/').pop(),
                    questionIndex: currentQuestionIndex,
                    question: questionsData[currentQuestionIndex],
                    hierarchy: hierarchy,
                    timestamp: Date.now()
                };
                bookmarks.push(bookmarkData);
            } else {
                bookmarks = bookmarks.filter(b => 
                    !(b.quizFile.includes(quizName.toLowerCase().replace(/ /g, '-')) && b.questionIndex === currentQuestionIndex)
                );
            }
            
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateQuestionNav();
        }

        function updateBookmarkButton() {
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkText');
            const isBookmarked = questionStates[currentQuestionIndex].bookmarked;
            
            btn.className = isBookmarked ? 'gradient-yellow px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-yellow-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isBookmarked ? 'Bookmarked' : 'Bookmark';
        }
        
        function toggleMarkForReview() {
            questionStates[currentQuestionIndex].markedForReview = !questionStates[currentQuestionIndex].markedForReview;
            updateMarkReviewButton();
            updateQuestionNav();
        }

        function updateMarkReviewButton() {
            const btn = document.getElementById('markReviewBtn');
            const text = document.getElementById('markReviewText');
            const isMarked = questionStates[currentQuestionIndex].markedForReview;
            
            btn.className = isMarked ? 'gradient-purple px-6 py-3 text-white transition-all duration-300 flex items-center' : 'glass-light px-6 py-3 text-white hover:bg-purple-500 hover:bg-opacity-20 transition-all duration-300 flex items-center';
            text.textContent = isMarked ? 'Marked' : 'Mark for Review';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (questionStartTime) {
                    questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
                }
                
                currentQuestionIndex--;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            }
        }

        function nextQuestion() {
            if (questionStartTime) {
                questionStates[currentQuestionIndex].timeSpent += Date.now() - questionStartTime;
            }
            
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                saveProgress(); // NEW: Save on navigation
            } else {
                if (currentMode === 'test' || currentMode === 'timed_exam') {
                    if (confirm('You have reached the end of the quiz. Would you like to submit your answers now?')) {
                        submitQuiz();
                    }
                } else {
                    if (confirm('You have completed all questions. Would you like to review from the beginning?')) {
                        currentQuestionIndex = 0;
                        displayQuestion();
                        saveProgress();
                    }
                }
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timeRemaining = 120; // 2 minutes per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    if (currentMode === 'timed_exam') {
                        submitQuiz();
                    } else {
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = 
                minutes + ':' + seconds.toString().padStart(2, '0');
        }

        function toggleSidebar() {
            document.getElementById('quizSidebar').classList.toggle('open');
        }

        document.addEventListener('DOMContentLoaded', () => {
             if (resume) {
                if (loadProgress()) {
                    document.getElementById('modeModal').style.display = 'none';
                    initializeQuiz(); // Resume directly into the saved mode and state
                } else {
                    // If resume fails (e.g., cleared history), start fresh
                    clearProgress();
                    document.getElementById('modeModal').style.display = 'flex';
                }
             } else if (!window.location.pathname.endsWith('custom_quiz.html')) {
                clearProgress(); // Clear old progress if not resuming
                document.getElementById('modeModal').style.display = 'flex';
             } else {
                initializeQuiz();
             }
        });
        
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('modeModal').style.display !== 'none') return;
            if (document.getElementById('performanceModal').classList.contains('hidden') === false) return;
            
            if (e.key >= '1' && e.key <= '4') {
                const optionIndex = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option-button');
                if (optionIndex < options.length) selectOption(optionIndex);
            } else if (e.key === 'ArrowLeft') {
                previousQuestion();
            } else if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextQuestion();
            } else if (e.key.toLowerCase() === 'b' && (currentMode === 'study' || currentMode === 'timed_study')) {
                toggleBookmark();
            } else if (e.key.toLowerCase() === 'm' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                toggleMarkForReview();
            } else if (e.key.toLowerCase() === 's' && (currentMode === 'test' || currentMode === 'timed_exam')) {
                submitQuiz();
            }
        });
    </script>
</body>
</html>